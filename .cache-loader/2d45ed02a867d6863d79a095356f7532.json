{"remainingRequest":"/home/travis/build/csrdelft/csrdelft.nl/node_modules/babel-loader/lib/index.js??ref--1-1!/home/travis/build/csrdelft/csrdelft.nl/node_modules/eslint-loader/index.js!/home/travis/build/csrdelft/csrdelft.nl/resources/assets/js/bibliotheek.js","dependencies":[{"path":"/home/travis/build/csrdelft/csrdelft.nl/resources/assets/js/bibliotheek.js","mtime":1545951909668},{"path":"/home/travis/build/csrdelft/csrdelft.nl/node_modules/cache-loader/dist/cjs.js","mtime":1545951596000},{"path":"/home/travis/build/csrdelft/csrdelft.nl/node_modules/babel-loader/lib/index.js","mtime":1545951596000},{"path":"/home/travis/build/csrdelft/csrdelft.nl/node_modules/eslint-loader/index.js","mtime":1545951596000}],"contextDependencies":[],"result":["'use strict';\n\nvar _jquery = require('jquery');\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _corejsTypeahead = require('corejs-typeahead');\n\nvar _corejsTypeahead2 = _interopRequireDefault(_corejsTypeahead);\n\nvar _context = require('./context');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n *\tBibliotheekjavascriptcode.\n */\n(0, _jquery2.default)(function ($) {\n\t/*********************************************\n  * Catalogus\n  *********************************************/\n\t//catalogus: tabellen naar zebra converteren.\n\t$('#boeken').find('tr:odd').addClass('odd');\n\n\tfunction getKolommen() {\n\t\tvar kolommen = void 0;\n\n\t\tif ($('#boekencatalogus').hasClass('lid')) {\n\t\t\tkolommen = { 'aoKolommen': [{ 'sType': 'html' }, // titel\n\t\t\t\t{ 'sType': 'html' }, // auteur\n\t\t\t\t{ 'sType': 'html' }, // rubriek\n\t\t\t\t{ 'sType': 'html', 'sWidth': '40px' }, { 'sType': 'html', 'sWidth': '125px', 'bVisible': false }, // eigenaar\n\t\t\t\t{ 'sType': 'html', 'sWidth': '125px', 'bVisible': false }, //uitgeleend aan\n\t\t\t\t{ 'sType': 'html', 'sWidth': '100px', 'bVisible': false // uitleendatum\n\t\t\t\t}] };\n\t\t} else {\n\t\t\tkolommen = { 'aoKolommen': [{ 'sType': 'html', 'sWidth': '400px' }, // titel\n\t\t\t\t{ 'sType': 'html' }, // auteur\n\t\t\t\t{ 'sType': 'html', 'sWidth': '300px' // rubriek\n\t\t\t\t}] };\n\t\t}\n\t\treturn kolommen.aoKolommen;\n\t}\n\n\t//catalogus: hippe sorteerbare tabel fixen.\n\tvar oTableCatalogus = $('#boekencatalogus').dataTable({\n\t\t'oLanguage': {\n\t\t\t'sZeroRecords': 'Geen boeken gevonden',\n\t\t\t'sInfoEmtpy': 'Geen boeken gevonden',\n\t\t\t'sSearch': 'Zoeken:',\n\t\t\toPaginate: {\n\t\t\t\t'sFirst': 'Eerste',\n\t\t\t\t'sPrevious': 'Vorige',\n\t\t\t\t'sNext': 'Volgende',\n\t\t\t\t'sLast': 'Laatste' }\n\t\t},\n\t\t//\"bProcessing\": true,\n\t\t'bServerSide': true,\n\t\t'sAjaxSource': '/bibliotheek/catalogusdata',\n\t\t'fnServerParams': function fnServerParams(aoData) {\n\t\t\taoData.push({ 'name': 'sEigenaarFilter', 'value': $('span.filter.actief').attr('id') });\n\t\t\taoData.push({ 'name': 'sView', 'value': $('input[name=boekstatus]').is(':checked') });\n\t\t},\n\t\t'iDisplayLength': 30,\n\t\t'bInfo': false,\n\t\t'bLengthChange': false,\n\t\t'bStateSave': true,\n\t\t'iCookieDuration': 60 * 15, // 15 min\n\t\t'fnStateSaveCallback': function fnStateSaveCallback(oSettings, sValue) {\n\t\t\tvar eigenaarFilter = $('span.filter.actief').attr('id'),\n\t\t\t    checked = $('input[name=boekstatus]').is(':checked');\n\t\t\tsValue += ',\"sEigenaarFilter\": \"' + eigenaarFilter + '\",\"sView\": ' + checked;\n\t\t\t(0, _context.initHoverIntents)();\n\t\t\treturn sValue;\n\t\t},\n\t\t'fnStateLoadCallback': function fnStateLoadCallback(oSettings) {\n\t\t\tvar oData = oSettings.aoData;\n\t\t\tvar aEigenaarfilters = ['alle', 'csr', 'leden', 'eigen', 'geleend'];\n\t\t\tif ($.inArray(oData.sEigenaarFilter, aEigenaarfilters) === -1) {\n\t\t\t\toData.sEigenaarFilter = 'csr';\n\t\t\t}\n\t\t\t$('span.filter').removeClass('actief').addClass('button');\n\t\t\t$('span.filter#' + oData.sEigenaarFilter).removeClass('button').addClass('actief');\n\n\t\t\t$('input[name=boekstatus]').attr('checked', oData.sView);\n\t\t\treturn true;\n\t\t},\n\t\t'aaSorting': [[0, 'asc']],\n\t\t'sPaginationType': 'full_numbers',\n\t\t'aoColumns': getKolommen()\n\t});\n\n\t//catalogus: update de tabel bij kiezen van een filteroptie\n\t$('span.filter').click(function () {\n\t\t//opmaak van knoppen aanpassen\n\t\t$('span.filter').removeClass('actief').addClass('button');\n\t\t$(this).removeClass('button').addClass('actief');\n\t\t//actie\n\t\toTableCatalogus.fnDraw(); // TODO: Gebruik datatables api\n\t});\n\n\t//catalogus: update de tabel als 'eigenaar&lener' wordt aangevinkt\n\t$('input#boekstatus').click(function () {\n\t\t/* Get the DataTables object again - this is not a recreation, just a get of the object */\n\t\tvar oTable = $('#boekencatalogus').dataTable();\n\n\t\tvar bVis = $('input[name=boekstatus]').is(':checked');\n\t\toTable.fnSetColumnVis(6, bVis, false); // TODO: fnSetColumnVis bestaat niet meer\n\t\toTable.fnSetColumnVis(5, bVis, false);\n\t\toTable.fnSetColumnVis(4, bVis, true);\n\t});\n\n\t/************************************************\n  * Boekpagina\n  ************************************************/\n\t// boekpagina: vult code-veld\n\t//voeg 'genereer'-knop toe aan codefield, die een biebcode geneert met waardes uit andere velden\n\tfunction biebCodeVakvuller() {\n\t\tvar codeveld = $('input[name=code]');\n\t\tvar codeknop = $('<a class=\"btn genereer\" title=\"Biebcode invullen\">Genereer</a>').mousedown(function (event) {\n\t\t\tevent.preventDefault();\n\t\t\tcodeveld.val($('select[name=categorie_id]').val() + '.' + $('input[name=auteur]').val().substring(0, 3).toLowerCase()).focus();\n\t\t});\n\t\tcodeveld.after(codeknop);\n\t}\n\tbiebCodeVakvuller();\n\n\t// boekpagina:\n\t//   Suggesties uit Google books.\n\t//   Kiezen van een suggestie plaatst in alle velden de juiste info.\n\tfunction getAuteur(datarow) {\n\t\treturn datarow.authors ? datarow.authors.join(', ') : '';\n\t}\n\tfunction getPublishedDate(datarow) {\n\t\treturn datarow.publishedDate ? datarow.publishedDate.substring(0, 4) : '';\n\t}\n\tfunction getIsbn(datarow) {\n\t\tvar isbn = '';\n\n\t\tif (datarow.industryIdentifiers && datarow.industryIdentifiers[1] && datarow.industryIdentifiers[1].type === 'ISBN_13') {\n\t\t\tisbn = datarow.industryIdentifiers[1].identifier;\n\t\t}\n\n\t\treturn isbn;\n\t}\n\tfunction getLanguage(datarow) {\n\t\tvar lang = {\n\t\t\tnl: 'Nederlands', en: 'Engels', fr: 'Frans',\n\t\t\tde: 'Duits', bg: 'Bulgaars', es: 'Spaans',\n\t\t\tcs: 'Tsjechisch', da: 'Deens', et: 'Ests',\n\t\t\tel: 'Grieks', ga: 'Iers', it: 'Italiaans',\n\t\t\tlv: 'Lets', lt: 'Litouws', hu: 'Hongaars',\n\t\t\tmt: 'Maltees', pl: 'Pools', pt: 'Portugees',\n\t\t\tro: 'Roemeens', sk: 'Slowaaks', sl: 'Sloveens',\n\t\t\tfi: 'Fins', sv: 'Zweeds'\n\t\t};\n\n\t\treturn lang[datarow.language] ? lang[datarow.language] : datarow.language;\n\t}\n\n\t//suggestiemenu configureren\n\tvar boekenSource = new _corejsTypeahead2.default({\n\t\tdatumTokenizer: _corejsTypeahead2.default.tokenizers.whitespace,\n\t\tqueryTokenizer: _corejsTypeahead2.default.tokenizers.whitespace,\n\t\tlimit: 25,\n\t\tremote: {\n\t\t\turl: 'https://www.googleapis.com/books/v1/volumes?q=%QUERY',\n\t\t\twildcard: '%QUERY',\n\t\t\tfilter: function filter(data) {\n\t\t\t\tvar rows = [];\n\t\t\t\tdata = data.items;\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\tvar datarow = data[i].volumeInfo;\n\t\t\t\t\tdatarow.index = i;\n\t\t\t\t\trows[i] = datarow;\n\t\t\t\t}\n\t\t\t\treturn rows;\n\t\t\t},\n\t\t\tajax: {\n\t\t\t\tdata: {\n\t\t\t\t\tfields: 'items(volumeInfo(authors,industryIdentifiers,language,pageCount,publishedDate,publisher,title))',\n\t\t\t\t\tkey: 'AIzaSyC7zu4-25xbizddFWuIbn107WTTPr37jos'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\tboekenSource.initialize();\n\t$('#boekzoeker').typeahead({\n\t\tautoselect: true,\n\t\thint: true,\n\t\thighlight: true,\n\t\tminLength: 7\n\t}, {\n\t\tname: 'boekenSource',\n\t\tdisplayKey: 'title',\n\t\tsource: boekenSource.ttAdapter(),\n\t\ttemplates: {\n\t\t\theader: '<h3>Boeken</h3>',\n\t\t\tsuggestion: function suggestion(row) {\n\t\t\t\tvar item = '<div style=\"margin: 5px 10px\" title=\"Titel: ' + row.title + ' | Auteur: ' + getAuteur(row) + ' | Pagina\\'s: ' + row.pageCount + ' | Taal: ' + getLanguage(row) + ' | ISBN: ' + getIsbn(row) + ' | Uitgeverij: ' + row.publisher + ' | Uitgavejaar: ' + getPublishedDate(row) + '\">';\n\t\t\t\titem += '<span class=\"dikgedrukt\">' + row.title + '</span><br /><span class=\"cursief\">' + getAuteur(row) + '</span>';\n\t\t\t\titem += '</div>';\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t}).keyup(function () {\n\t\tvar inputlen = $(this).val().length;\n\n\t\tif (inputlen > 0 && inputlen < 7) {\n\t\t\t$(this).css('background-color', '#ffcc96');\n\t\t} else {\n\t\t\t$(this).css('background-color', 'white');\n\t\t}\n\t}).on('typeahead:selected', function (event, row) {\n\t\t//gegevens in invulvelden plaatsen\n\t\tvar values = [{ key: 'titel', value: row.title }, { key: 'auteur', value: getAuteur(row) }, { key: 'paginas', value: row.pageCount }, { key: 'taal', value: getLanguage(row) }, { key: 'isbn', value: getIsbn(row) }, { key: 'uitgeverij', value: row.publisher }, { key: 'uitgavejaar', value: getPublishedDate(row) }];\n\t\tvalues.forEach(function (el) {\n\t\t\t$('input[name=' + el.key + ']').val(el.value);\n\t\t});\n\t});\n\n\t//boekpagina: autocomplete voor bewerkvelden uit C.S.R.-database.\n\t/* result = array(\n  *\t\tarray(data:array(..,..,..), value: \"string\", result:\"string\"),\n  * \t\tarray(... )\n  * )\n  * formatItem geneert html-items voor de suggestielijst, afstemmen op data-array\n  */\n\tvar bestaandeBoekenSource = new _corejsTypeahead2.default({\n\t\tdatumTokenizer: _corejsTypeahead2.default.tokenizers.whitespace,\n\t\tqueryTokenizer: _corejsTypeahead2.default.tokenizers.whitespace,\n\t\tlimit: 20,\n\t\tremote: {\n\t\t\turl: '/bibliotheek/autocomplete/titel?q=%QUERY',\n\t\t\twildcard: '%QUERY'\n\t\t}\n\t});\n\tbestaandeBoekenSource.initialize();\n\t$('form.Formulier input.TitelField').typeahead({\n\t\thint: true,\n\t\thighlight: true,\n\t\tminLength: 1\n\t}, {\n\t\tname: 'bestaandeBoekenSource',\n\t\tdisplayKey: 'value',\n\t\tsource: bestaandeBoekenSource.ttAdapter(),\n\t\ttemplates: {\n\t\t\theader: '<h3>Bestaande Boeken</h3>',\n\t\t\tsuggestion: function suggestion(row) {\n\t\t\t\treturn '<div style=\"margin: 5px 10px\">Ga naar: <a href=\"/bibliotheek/boek/' + row.data.id + '\" target=\"_blank\">' + row.data.titel + '</a></div>';\n\t\t\t}\n\t\t}\n\t}).on('typeahead:select', function (event, row) {\n\t\twindow.open('/bibliotheek/boek/' + row.data.id);\n\t});\n});",{"version":3,"sources":["resources/assets/js/bibliotheek.js"],"names":["$","find","addClass","getKolommen","kolommen","hasClass","aoKolommen","oTableCatalogus","dataTable","oPaginate","aoData","push","attr","is","oSettings","sValue","eigenaarFilter","checked","oData","aEigenaarfilters","inArray","sEigenaarFilter","removeClass","sView","click","fnDraw","oTable","bVis","fnSetColumnVis","biebCodeVakvuller","codeveld","codeknop","mousedown","event","preventDefault","val","substring","toLowerCase","focus","after","getAuteur","datarow","authors","join","getPublishedDate","publishedDate","getIsbn","isbn","industryIdentifiers","type","identifier","getLanguage","lang","nl","en","fr","de","bg","es","cs","da","et","el","ga","it","lv","lt","hu","mt","pl","pt","ro","sk","sl","fi","sv","language","boekenSource","Bloodhound","datumTokenizer","tokenizers","whitespace","queryTokenizer","limit","remote","url","wildcard","filter","data","rows","items","i","length","volumeInfo","index","ajax","fields","key","initialize","typeahead","autoselect","hint","highlight","minLength","name","displayKey","source","ttAdapter","templates","header","suggestion","row","item","title","pageCount","publisher","keyup","inputlen","css","on","values","value","forEach","bestaandeBoekenSource","id","titel","window","open"],"mappings":"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","file":"bibliotheek.js","sourceRoot":"/home/travis/build/csrdelft/csrdelft.nl","sourcesContent":["import $ from 'jquery';\nimport Bloodhound from 'corejs-typeahead';\n\nimport {initHoverIntents} from './context';\n\n/*\n *\tBibliotheekjavascriptcode.\n */\n$(function ($) {\n\t/*********************************************\n\t * Catalogus\n\t *********************************************/\n\t//catalogus: tabellen naar zebra converteren.\n\t$('#boeken').find('tr:odd').addClass('odd');\n\n    function getKolommen() {\n        let kolommen;\n\n        if ($('#boekencatalogus').hasClass('lid')) {\n            kolommen = {'aoKolommen': [\n                    {'sType': 'html'}, // titel\n                    {'sType': 'html'}, // auteur\n                    {'sType': 'html'}, // rubriek\n                    {'sType': 'html', 'sWidth': '40px'},\n                    {'sType': 'html', 'sWidth': '125px', 'bVisible': false}, // eigenaar\n                    {'sType': 'html', 'sWidth': '125px', 'bVisible': false}, //uitgeleend aan\n                    {'sType': 'html', 'sWidth': '100px', 'bVisible': false} // uitleendatum\n                ]};\n        } else {\n            kolommen = {'aoKolommen': [\n                    {'sType': 'html', 'sWidth': '400px'}, // titel\n                    {'sType': 'html'}, // auteur\n                    {'sType': 'html', 'sWidth': '300px'} // rubriek\n                ]};\n        }\n        return kolommen.aoKolommen;\n    }\n\n\t//catalogus: hippe sorteerbare tabel fixen.\n\tlet oTableCatalogus = $('#boekencatalogus').dataTable({\n\t\t'oLanguage': {\n\t\t\t'sZeroRecords': 'Geen boeken gevonden',\n\t\t\t'sInfoEmtpy': 'Geen boeken gevonden',\n\t\t\t'sSearch': 'Zoeken:',\n\t\t\toPaginate: {\n\t\t\t\t'sFirst': 'Eerste',\n\t\t\t\t'sPrevious': 'Vorige',\n\t\t\t\t'sNext': 'Volgende',\n\t\t\t\t'sLast': 'Laatste'}\n\t\t},\n\t\t//\"bProcessing\": true,\n\t\t'bServerSide': true,\n\t\t'sAjaxSource': '/bibliotheek/catalogusdata',\n\t\t'fnServerParams': (aoData) => {\n\t\t\taoData.push({'name': 'sEigenaarFilter', 'value': $('span.filter.actief').attr('id')});\n\t\t\taoData.push({'name': 'sView', 'value': $('input[name=boekstatus]').is(':checked')});\n\t\t},\n\t\t'iDisplayLength': 30,\n\t\t'bInfo': false,\n\t\t'bLengthChange': false,\n\t\t'bStateSave': true,\n\t\t'iCookieDuration': 60 * 15, // 15 min\n\t\t'fnStateSaveCallback': (oSettings, sValue) => {\n            let eigenaarFilter = $('span.filter.actief').attr('id'),\n                checked = $('input[name=boekstatus]').is(':checked');\n            sValue += `,\"sEigenaarFilter\": \"${eigenaarFilter}\",\"sView\": ${checked}`;\n\t\t\tinitHoverIntents();\n\t\t\treturn sValue;\n\t\t},\n\t\t'fnStateLoadCallback': (oSettings) => {\n\t\t\tlet oData = oSettings.aoData;\n\t\t\tlet aEigenaarfilters = ['alle', 'csr', 'leden', 'eigen', 'geleend'];\n\t\t\tif ($.inArray(oData.sEigenaarFilter, aEigenaarfilters) === -1) {\n\t\t\t\toData.sEigenaarFilter = 'csr';\n\t\t\t}\n\t\t\t$('span.filter').removeClass('actief').addClass('button');\n\t\t\t$('span.filter#' + oData.sEigenaarFilter).removeClass('button').addClass('actief');\n\n\t\t\t$('input[name=boekstatus]').attr('checked', oData.sView);\n\t\t\treturn true;\n\t\t},\n\t\t'aaSorting': [[0, 'asc']],\n\t\t'sPaginationType': 'full_numbers',\n\t\t'aoColumns': getKolommen()\n\t});\n\n\t//catalogus: update de tabel bij kiezen van een filteroptie\n\t$('span.filter').click(function () {\n\t\t//opmaak van knoppen aanpassen\n\t\t$('span.filter').removeClass('actief').addClass('button');\n\t\t$(this).removeClass('button').addClass('actief');\n\t\t//actie\n\t\toTableCatalogus.fnDraw(); // TODO: Gebruik datatables api\n\t});\n\n\t//catalogus: update de tabel als 'eigenaar&lener' wordt aangevinkt\n\t$('input#boekstatus').click(function () {\n\t\t/* Get the DataTables object again - this is not a recreation, just a get of the object */\n\t\tlet oTable = $('#boekencatalogus').dataTable();\n\n\t\tlet bVis = $('input[name=boekstatus]').is(':checked');\n\t\toTable.fnSetColumnVis(6, bVis, false); // TODO: fnSetColumnVis bestaat niet meer\n\t\toTable.fnSetColumnVis(5, bVis, false);\n\t\toTable.fnSetColumnVis(4, bVis, true);\n\t});\n\n\n\n\t/************************************************\n\t * Boekpagina\n\t ************************************************/\n\t// boekpagina: vult code-veld\n    //voeg 'genereer'-knop toe aan codefield, die een biebcode geneert met waardes uit andere velden\n    function biebCodeVakvuller() {\n        let codeveld = $('input[name=code]');\n        let codeknop = $('<a class=\"btn genereer\" title=\"Biebcode invullen\">Genereer</a>').mousedown(function (event) {\n            event.preventDefault();\n            codeveld.val(\n                $('select[name=categorie_id]').val() + '.' + $('input[name=auteur]').val().substring(0, 3).toLowerCase()\n            ).focus();\n        });\n        codeveld.after(codeknop);\n    }\n\tbiebCodeVakvuller();\n\n\t// boekpagina:\n\t//   Suggesties uit Google books.\n\t//   Kiezen van een suggestie plaatst in alle velden de juiste info.\n\tfunction getAuteur(datarow) {\n\t\treturn datarow.authors ? datarow.authors.join(', ') : '';\n\t}\n\tfunction getPublishedDate(datarow) {\n\t\treturn datarow.publishedDate ? datarow.publishedDate.substring(0, 4) : '';\n\t}\n\tfunction getIsbn(datarow) {\n\t\tlet isbn = '';\n\n\t\tif (datarow.industryIdentifiers && datarow.industryIdentifiers[1] && datarow.industryIdentifiers[1].type === 'ISBN_13') {\n\t\t\tisbn = datarow.industryIdentifiers[1].identifier;\n\t\t}\n\n\t\treturn isbn;\n\t}\n\tfunction getLanguage(datarow) {\n\t\tlet lang = {\n\t\t\tnl: 'Nederlands', en: 'Engels', fr: 'Frans',\n\t\t\tde: 'Duits', bg: 'Bulgaars', es: 'Spaans',\n\t\t\tcs: 'Tsjechisch', da: 'Deens', et: 'Ests',\n\t\t\tel: 'Grieks', ga: 'Iers', it: 'Italiaans',\n\t\t\tlv: 'Lets', lt: 'Litouws', hu: 'Hongaars',\n\t\t\tmt: 'Maltees', pl: 'Pools', pt: 'Portugees',\n\t\t\tro: 'Roemeens', sk: 'Slowaaks', sl: 'Sloveens',\n\t\t\tfi: 'Fins', sv: 'Zweeds'\n\t\t};\n\n\t\treturn lang[datarow.language] ? lang[datarow.language] : datarow.language;\n\t}\n\n\t//suggestiemenu configureren\n\tlet boekenSource = new Bloodhound({\n\t\tdatumTokenizer: Bloodhound.tokenizers.whitespace,\n\t\tqueryTokenizer: Bloodhound.tokenizers.whitespace,\n\t\tlimit: 25,\n\t\tremote: {\n\t\t\turl: 'https://www.googleapis.com/books/v1/volumes?q=%QUERY',\n\t\t\twildcard: '%QUERY',\n\t\t\tfilter: (data) => {\n\t\t\t\tlet rows = [];\n\t\t\t\tdata = data.items;\n\t\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\t\tlet datarow = data[i].volumeInfo;\n\t\t\t\t\tdatarow.index = i;\n\t\t\t\t\trows[i] = datarow;\n\t\t\t\t}\n\t\t\t\treturn rows;\n\t\t\t},\n\t\t\tajax: {\n\t\t\t\tdata: {\n\t\t\t\t\tfields: 'items(volumeInfo(authors,industryIdentifiers,language,pageCount,publishedDate,publisher,title))',\n\t\t\t\t\tkey: 'AIzaSyC7zu4-25xbizddFWuIbn107WTTPr37jos'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\tboekenSource.initialize();\n\t$('#boekzoeker').typeahead({\n\t\tautoselect: true,\n\t\thint: true,\n\t\thighlight: true,\n\t\tminLength: 7\n\t}, {\n\t\tname: 'boekenSource',\n\t\tdisplayKey: 'title',\n\t\tsource: boekenSource.ttAdapter(),\n\t\ttemplates: {\n\t\t\theader: '<h3>Boeken</h3>',\n\t\t\tsuggestion: (row) => {\n\t\t\t\tlet item = `<div style=\"margin: 5px 10px\" title=\"Titel: ${row.title} | Auteur: ${getAuteur(row)} | Pagina's: ${row.pageCount} | Taal: ${getLanguage(row)} | ISBN: ${getIsbn(row)} | Uitgeverij: ${row.publisher} | Uitgavejaar: ${getPublishedDate(row)}\">`;\n\t\t\t\titem += `<span class=\"dikgedrukt\">${row.title}</span><br /><span class=\"cursief\">${getAuteur(row)}</span>`;\n\t\t\t\titem += '</div>';\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t}).keyup(function () {\n\t\tlet inputlen = $(this).val().length;\n\n\t\tif (inputlen > 0 && inputlen < 7) {\n\t\t\t$(this).css('background-color', '#ffcc96');\n\t\t} else {\n\t\t\t$(this).css('background-color', 'white');\n\t\t}\n\t}).on('typeahead:selected', function(event, row) {\n\t\t//gegevens in invulvelden plaatsen\n\t\tlet values = [\n\t\t\t{key: 'titel', value: row.title},\n\t\t\t{key: 'auteur', value: getAuteur(row)},\n\t\t\t{key: 'paginas', value: row.pageCount},\n\t\t\t{key: 'taal', value: getLanguage(row)},\n\t\t\t{key: 'isbn', value: getIsbn(row)},\n\t\t\t{key: 'uitgeverij', value: row.publisher},\n\t\t\t{key: 'uitgavejaar', value: getPublishedDate(row)}\n\t\t];\n\t\tvalues.forEach(function(el) {\n\t\t\t$(`input[name=${el.key}]`).val(el.value);\n\t\t});\n\t});\n\n\t//boekpagina: autocomplete voor bewerkvelden uit C.S.R.-database.\n\t/* result = array(\n\t *\t\tarray(data:array(..,..,..), value: \"string\", result:\"string\"),\n\t * \t\tarray(... )\n\t * )\n\t * formatItem geneert html-items voor de suggestielijst, afstemmen op data-array\n\t */\n\tlet bestaandeBoekenSource = new Bloodhound({\n\t\tdatumTokenizer: Bloodhound.tokenizers.whitespace,\n\t\tqueryTokenizer: Bloodhound.tokenizers.whitespace,\n\t\tlimit: 20,\n\t\tremote: {\n\t\t\turl: '/bibliotheek/autocomplete/titel?q=%QUERY',\n\t\t\twildcard: '%QUERY'\n\t\t}\n\t});\n\tbestaandeBoekenSource.initialize();\n\t$('form.Formulier input.TitelField').typeahead({\n\t\thint: true,\n\t\thighlight: true,\n        minLength: 1\n    }, {\n\t\tname: 'bestaandeBoekenSource',\n\t\tdisplayKey: 'value',\n\t\tsource: bestaandeBoekenSource.ttAdapter(),\n\t\ttemplates: {\n\t\t\theader: '<h3>Bestaande Boeken</h3>',\n\t\t\tsuggestion: function (row) {\n\t\t\t\treturn `<div style=\"margin: 5px 10px\">Ga naar: <a href=\"/bibliotheek/boek/${row.data.id}\" target=\"_blank\">${row.data.titel}</a></div>`;\n\t\t\t}\n\t\t}\n\t}).on('typeahead:select', (event, row) => {\n\t\twindow.open(`/bibliotheek/boek/${row.data.id}`);\n\t});\n});\n\n"]}]}