{"version":3,"sources":["webpack:///./js/datatable/api.ts","webpack:///./js/datatable/render.ts","webpack:////home/travis/build/csrdelft/csrdelft.nl/.yarn/cache/moment-npm-2.27.0-0e670d438d-72d9a7d8db.zip/node_modules/moment/locale sync [/\\\\](nl(\\.js)"],"names":["isDataTableResponse","response","async","initDataTable","el","$el","settingsJson","data","search","ajax","lastUpdate","fnGetLastUpdate","dataSrc","fnAjaxUpdateCallback","columns","forEach","col","render","table","DataTable","dataTable","api","on","rows","selected","deselect","event","container","get","initOfflineDataTable","fnUpdateDataTable","tableId","row","$tr","UUID","length","remove","add","alert","draw","fnGetSelection","selection","each","uuid","this","attr","Error","push","getApiFromSettings","settings","fn","Api","$table","Number","fnSetLastUpdate","json","tableConfig","autoUpdate","timeout","parseInt","isNaN","setTimeout","post","url","$scroll","parent","hasClass","top","scrollTop","height","innerHeight","scrollHeight","window","animate","fnAutoScroll","replacePlaceholders","action","replacements","exec","i","replace","type","sort","export","display","bedrag","check","aanmeldFilter","aanmeldingen","aantal_aanmeldingen","aanmeld_limiet","totaalPrijs","prijs","datetime","date","format","substr","meta","cell","node","firstChild","dateTime","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","code","keys","Object","resolve","module","exports"],"mappings":"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","file":"js/datatable-api.e0b00dee4e57a26afdcf.chunk.js","sourcesContent":["import $ from 'jquery';\nimport { init } from '../ctx';\nimport { parseData } from '../lib/util';\nimport render from './render';\nexport function isDataTableResponse(response) {\n    const check = response;\n    return typeof response == 'object'\n        && \"lastUpdate\" in check\n        && \"autoUpdate\" in check\n        && \"data\" in check;\n}\nexport async function initDataTable(el) {\n    await import(/*webpackChunkName: \"bootstrap\"*/ './bootstrap');\n    const $el = $(el);\n    const settingsJson = $el.data('settings');\n    const search = $el.data('search');\n    // Zet de callback voor ajax\n    if (settingsJson.ajax) {\n        settingsJson.ajax.data.lastUpdate = fnGetLastUpdate($el);\n        settingsJson.ajax.dataSrc = fnAjaxUpdateCallback($el);\n    }\n    // Zet de render method op de columns\n    settingsJson.columns.forEach((col) => col.render = render[col.render]);\n    // Init DataTable\n    const table = $el.DataTable(settingsJson);\n    $el.dataTable().api().search(search);\n    table.on('page', () => table.rows({ selected: true }).deselect());\n    table.on('childRow.dt', (event, data) => init(data.container.get(0)));\n}\nexport async function initOfflineDataTable(el) {\n    await import(/*webpackChunkName: \"bootstrap\"*/ './bootstrap');\n    $(el).DataTable(parseData(el));\n}\n/****************************\n * Een paar functies om met datatables te\n * praten, laadt datatables zelf niet in.\n */\nexport function fnUpdateDataTable(tableId, response) {\n    const $table = $(tableId);\n    const table = $table.DataTable();\n    // update or remove existing rows or add new rows\n    response.data.forEach((row) => {\n        const $tr = $('tr[data-uuid=\"' + row.UUID + '\"]');\n        if ($tr.length === 1) {\n            if ('remove' in row) {\n                table.row($tr).remove();\n            }\n            else {\n                table.row($tr).data(row);\n                init($tr.get(0));\n            }\n        }\n        else if ($tr.length === 0) {\n            table.row.add(row);\n        }\n        else {\n            alert($tr.length);\n        }\n    });\n    table.draw(false);\n}\nexport function fnGetSelection(tableId) {\n    const selection = [];\n    $(tableId + ' tbody tr.selected').each(function () {\n        const uuid = $(this).attr('data-uuid');\n        if (!uuid) {\n            throw new Error(\"Tablerow heeft geen uuid\");\n        }\n        selection.push(uuid);\n    });\n    return selection;\n}\n// new Api(selector: Settings) is valide, maar wordt als type niet geaccepteerd, type lijkt niet uit te breiden.\n// https://datatables.net/reference/type/DataTables.Settings\nexport function getApiFromSettings(settings) {\n    return new $.fn.dataTable.Api(settings);\n}\n/**\n * Wordt gebruikt in gesprekken.\n *\n * @param {jQuery} $table\n */\nfunction fnAutoScroll($table) {\n    const $scroll = $table.parent();\n    if ($scroll.hasClass('dataTables_scrollBody')) {\n        const top = $scroll.scrollTop();\n        const height = $scroll.innerHeight();\n        if (!top || !height) {\n            throw new Error(\"$scroll heeft geen top of height\");\n        }\n        // autoscroll if already on bottom\n        if (top + height >= $scroll[0].scrollHeight - 20) {\n            // check before draw and scroll after\n            window.setTimeout(() => {\n                $scroll.animate({\n                    scrollTop: $scroll[0].scrollHeight,\n                }, 800);\n            }, 200);\n        }\n    }\n}\nexport const fnGetLastUpdate = ($table) => () => Number($table.data('lastupdate'));\nexport const fnSetLastUpdate = ($table) => (lastUpdate) => $table.data('lastupdate', lastUpdate);\n/**\n * Called after ajax load complete.\n *\n * @returns object\n * @param {jQuery} $table\n */\nexport const fnAjaxUpdateCallback = ($table) => (json) => {\n    fnSetLastUpdate($table)(json.lastUpdate);\n    const tableConfig = $table.DataTable();\n    if (json.autoUpdate) {\n        const timeout = parseInt(json.autoUpdate, 10);\n        if (!isNaN(timeout) && timeout < 600000) { // max 10 min\n            setTimeout(() => {\n                $.post(tableConfig.ajax.url(), {\n                    lastUpdate: fnGetLastUpdate($table),\n                }, (data) => {\n                    const tableId = $table.attr('id');\n                    if (!tableId) {\n                        throw new Error(\"Table heeft geen id\");\n                    }\n                    fnUpdateDataTable(tableId, data);\n                    fnAjaxUpdateCallback($table)(data);\n                });\n            }, timeout);\n        }\n    }\n    fnAutoScroll($table);\n    return json.data;\n};\nexport function replacePlaceholders(action, row) {\n    const replacements = /:(\\w+)/g.exec(action);\n    if (!replacements) {\n        return action;\n    }\n    for (let i = 1; i < replacements.length; i++) {\n        action = action.replace(':' + replacements[i], row[replacements[i]]);\n    }\n    return action;\n}\n","import moment from 'moment';\nimport { formatBedrag, formatFilesize } from '../lib/util';\nimport { getApiFromSettings } from './api';\n/**\n * Standaard gedefinieerde render functies.\n */\nexport default {\n    default(data, type) {\n        if (data === null || typeof data !== 'object') {\n            return data;\n        }\n        switch (type) {\n            case 'sort':\n                return data.sort;\n            case 'export':\n                return data.export;\n            default:\n                return data.display;\n        }\n    },\n    bedrag(data) {\n        return formatBedrag(data);\n    },\n    check(data) {\n        return '<span class=\"ico ' + (data ? 'tick' : 'cross') + '\"></span>';\n    },\n    aanmeldFilter(data) {\n        return data ? `<span class=\"ico group_key\" title=\"Aanmeld filter actief: '${data}'\"></span>` : '';\n    },\n    aanmeldingen(data, type, row) {\n        return row.aantal_aanmeldingen + ' (' + row.aanmeld_limiet + ')';\n    },\n    totaalPrijs(data, type, row) {\n        return formatBedrag(row.aantal_aanmeldingen * parseInt(row.prijs, 10));\n    },\n    datetime(date) {\n        if (Number(date) == date) {\n            return moment(date * 1000).format('YYYY-MM-DD HH:mm');\n        }\n        if (!date) {\n            return '';\n        }\n        if (date.substr(0, 5) === '<time') {\n            return date;\n        }\n        return moment(date).format('YYYY-MM-DD HH:mm');\n    },\n    timeago(data, type, row, meta) {\n        const api = getApiFromSettings(meta.settings);\n        const cell = api.cell(meta.row, meta.col).node().firstChild;\n        switch (type) {\n            case 'sort':\n            case 'export':\n                return cell.dateTime;\n            default:\n                return data;\n        }\n    },\n    filesize(data, type) {\n        switch (type) {\n            case 'sort':\n                return Number(data);\n            default:\n                return formatFilesize(data);\n        }\n    },\n};\n","var map = {\n\t\"./nl\": 76,\n\t\"./nl.js\": 76\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 91;"],"sourceRoot":""}