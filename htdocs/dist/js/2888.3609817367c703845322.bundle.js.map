{"version":3,"sources":["webpack:///../.yarn/cache/@remirror-core-helpers-npm-0.7.6-1f7dffc505-c2102ee07e.zip/node_modules/@remirror/core-helpers/lib/dist/core-helpers.esm.js","webpack:///../.yarn/cache/@remirror-core-utils-npm-0.8.0-e84b106689-e7458166eb.zip/node_modules/@remirror/core-utils/lib/dist/core-utils.esm.js","webpack:///../.yarn/cache/@remirror-core-constants-npm-0.7.4-e2e83cdeda-146dc30869.zip/node_modules/@remirror/core-constants/lib/dist/core-constants.esm.js","webpack:///../.yarn/__virtual__/prosemirror-suggest-virtual-2402e477b7/0/cache/prosemirror-suggest-npm-0.7.6-7b4e6bf185-aedcb074f0.zip/node_modules/prosemirror-suggest/lib/dist/prosemirror-suggest.esm.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/construct.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/createClass.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/objectWithoutProperties.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/typeof.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-64964a0fd1.zip/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///../.yarn/cache/corejs-typeahead-npm-1.3.1-6f321c4326-9bfc228675.zip/node_modules/corejs-typeahead/dist/typeahead.bundle.js","webpack:///../.yarn/cache/deepmerge-npm-4.2.2-112165ced2-a8c43a1ed8.zip/node_modules/deepmerge/dist/cjs.js","webpack:///../.yarn/cache/dom-walk-npm-0.1.2-7d20a1a8d8-19eb0ce9c6.zip/node_modules/dom-walk/index.js","webpack:///../.yarn/cache/escape-string-regexp-npm-2.0.0-aef69d2a25-9f8a2d5743.zip/node_modules/escape-string-regexp/index.js","webpack:///../.yarn/cache/fast-deep-equal-npm-2.0.1-9c01e08a62-b701835a87.zip/node_modules/fast-deep-equal/index.js","webpack:///../.yarn/cache/fast-memoize-npm-2.5.2-f42a7c6940-79fa759719.zip/node_modules/fast-memoize/src/index.js","webpack:///../.yarn/cache/get-video-id-npm-3.2.0-f5b3825084-456310afb7.zip/node_modules/get-video-id/dist/get-video-id.esm.js","webpack:///../.yarn/cache/is-extendable-npm-1.0.1-7095ad8b16-db07bc1e9d.zip/node_modules/is-extendable/index.js","webpack:///../.yarn/cache/is-plain-object-npm-2.0.4-da3265d804-2a401140cf.zip/node_modules/is-plain-object/index.js","webpack:///../.yarn/cache/isobject-npm-3.0.1-8145901fd2-db85c4c970.zip/node_modules/isobject/index.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/document.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/dom-comment.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/dom-element.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/dom-fragment.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/dom-text.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/event.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/event/add-event-listener.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/event/dispatch-event.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/event/remove-event-listener.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/index.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-da6437562e.zip/node_modules/min-document/serialize.js","webpack:///../.yarn/cache/object.omit-npm-3.0.0-272d141ea0-7444bcbd5e.zip/node_modules/object.omit/index.js","webpack:///../.yarn/cache/object.pick-npm-1.3.0-dad8eae8fb-77fb6eed57.zip/node_modules/object.pick/index.js","webpack:///../.yarn/cache/orderedmap-npm-1.1.1-dffd12a1bd-2b60551790.zip/node_modules/orderedmap/index.es.js","webpack:///../.yarn/cache/prosemirror-commands-npm-1.1.5-49682fd359-bac0ce8b1d.zip/node_modules/prosemirror-commands/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-dropcursor-npm-1.3.2-cbe5e39b8e-0e89f41cbf.zip/node_modules/prosemirror-dropcursor/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-view-npm-1.17.2-631af400b5-1d582a9eda.zip/node_modules/prosemirror-view/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-gapcursor-npm-1.1.5-4f4961ab8d-9b691e03f1.zip/node_modules/prosemirror-gapcursor/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-example-setup-npm-1.1.2-3f610530d1-1b642119cc.zip/node_modules/prosemirror-example-setup/dist/index.es.js","webpack:///../.yarn/cache/rope-sequence-npm-1.3.2-cc341e8423-4169421051.zip/node_modules/rope-sequence/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-history-npm-1.1.3-45c1c5e7a3-b89416c7f9.zip/node_modules/prosemirror-history/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-inputrules-npm-1.1.3-1006d2d553-25b51840e7.zip/node_modules/prosemirror-inputrules/dist/index.es.js","webpack:///../.yarn/cache/w3c-keyname-npm-2.2.4-8c6e5969c5-890180452b.zip/node_modules/w3c-keyname/index.es.js","webpack:///../.yarn/cache/prosemirror-keymap-npm-1.1.4-cc2478e236-a171ceb22d.zip/node_modules/prosemirror-keymap/dist/index.es.js","webpack:///../.yarn/cache/crelt-npm-1.0.5-6dad646a54-04a618c587.zip/node_modules/crelt/index.es.js","webpack:///../.yarn/cache/prosemirror-menu-npm-1.1.4-f1d0b04a6c-2c6f5cbf66.zip/node_modules/prosemirror-menu/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-model-npm-1.13.1-69d3c422e0-d091e83fc5.zip/node_modules/prosemirror-model/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-schema-list-npm-1.1.4-314796cf2a-b6b3a830c0.zip/node_modules/prosemirror-schema-list/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-state-npm-1.3.4-c4b4427e53-088748bca0.zip/node_modules/prosemirror-state/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-transform-npm-1.2.9-d6493b7767-52f818d3be.zip/node_modules/prosemirror-transform/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-view-npm-1.17.4-b9d748cddf-dec595c77d.zip/node_modules/prosemirror-view/dist/index.es.js"],"names":["TypeName","value","Object","prototype","toString","getObjectType","call","slice","isOfType","type","test","isObjectOfType","val","Number","isNaN","isNull","isRegExp","RegExp","noop","Date","Error","Array","isArray","isProsemirrorNode","isSelection","selectionEmpty","empty","isEditorState","selection","ownKeys$1","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","Side","findChildren","_ref2","node","predicate","descend","_ref","_ref$descend","result","descendants","child","pos","flatten","findNodeByPredicate","_ref3","params","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","_objectSpread$1","isText","isInline","isBlock","concat","MarkGroup","NodeGroup","ExtensionType","Tags","RemirrorClassName","ExitReason","ChangeReason","defaultHandler","DEFAULT_SUGGESTER","appendText","createCommand","ignoredClassName","undefined","ignoredTag","invalidPrefixCharacters","keyBindings","matchOffset","noDecorations","onChange","onCharacterEntry","onExit","startOfLine","suggestClassName","suggestTag","supportedCharacters","validPrefixCharacters","isValidMatch","match","queryText","full","suggester","escapeChar","_char","regexToString","regexOrString","getRegexPrefix","onlyStartOfLine","getRegexSupportedCharacters","createMatchWithReason","reason","findPosition","position","text","regexp","$pos","cursor","start","results","flags","includes","exec","lastIndex","prefix","matchPrefix","input","Math","max","index","from","end","to","min","matchLength","range","partial","matchText","findMatch","_ref4","_char2","name","createRegexFromSuggester","doc","textBetween","before","recheckMatch","_ref5","state","resolve","_unused","createInsertReason","_ref6","prev","next","nodeSize","exit","Removed","End","Split","InvalidSplit","runKeyBindings","bindings","_ref10","create","entries","reduce","_ref11","_ref12","method","transformKeyBindings","view","event","findReason","_ref13","compare","isJump","_ref7","updatedPrev","JumpForward","change","JumpBackward","findJumpReason","isEntry","Start","isExit","_ref9","SelectionOutside","MoveEnd","MoveStart","findExitReason","isChange","Text","isMove","Move","SelectionInside","SuggestState","suggesters","_this","this","removed","_this$handlerMatches","handlerMatches","map","exitParams","createReasonParams","changeParams","movedForwards","_ref$specific","specific","find","attrs","decoration","nodeName","ignored","add","spec","remove","decorationsToClear","names","setMarkRemoved","setRemovedTrue","addIgnored","clearIgnored","get","command","getCommand","createParams","tr","mapping","invalid","some","_ref14","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","_unused2","console","warn","err","findFromSuggesters","shouldIgnoreMatch","update","onViewUpdate","_ref8","newState","docChanged","selectionSet","transactionChanged","mapIgnoredDecorations","resetState","updateReasons","$from","_match$suggester","decorationsTag","suggestionClassName","suggestPluginKey","suggest","_len","_key","pluginState","_view","init","viewHandler","_","oldState","props","handleKeyDown","handleTextInput","decorations","module","exports","arr","len","arr2","arrayLikeToArray","instance","Constructor","TypeError","setPrototypeOf","isNativeReflectConstruct","_construct","Parent","args","Class","Reflect","construct","a","Function","bind","_defineProperties","descriptor","configurable","writable","protoProps","staticProps","obj","sham","Proxy","e","iter","_arr","_n","_d","_e","_s","_i","objectWithoutPropertiesLoose","excluded","sourceSymbolKeys","indexOf","propertyIsEnumerable","sourceKeys","_setPrototypeOf","o","p","__proto__","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arrayWithoutHoles","iterableToArray","nonIterableSpread","_typeof","constructor","minLen","n","root","a0","$","isMsie","navigator","userAgent","isBlankString","str","escapeRegExChars","replace","isString","isNumber","isFunction","isObject","isPlainObject","isUndefined","isElement","nodeType","isJQuery","toStr","s","proxy","each","collection","cb","reverseArgs","grep","every","mixin","extend","identity","x","clone","getIdGenerator","counter","templatify","template","String","defer","fn","setTimeout","debounce","func","wait","immediate","timeout","later","callNow","context","clearTimeout","throttle","previous","now","remaining","stringify","JSON","guid","_p8","random","substr","VERSION","tokenizers","nonword","whitespace","ngram","getObjTokenizer","split","tokens","word","char","tokenizer","k","LruCache","maxSize","reset","set","List","head","tail","Node","tailItem","list","size","hash","moveToFront","PersistentStorage","LOCAL_STORAGE","window","localStorage","setItem","removeItem","namespace","override","join","ttlKey","keyMatcher","ls","_noop","_prefix","_ttlKey","clear","isExpired","_safeSet","decode","getItem","ttl","encode","gatherMatchingKeys","getTime","parseJSON","Transport","pendingRequestsCount","pendingRequests","sharedCache","maxPendingRequests","cancelled","lastReq","_send","transport","_get","limiter","_cache","cache","setMaxPendingRequests","num","resetCache","_fingerprint","url","param","data","fingerprint","jqXhr","that","resp","fail","always","onDeckRequestArgs","cancel","SearchIndex","CHILDREN","IDS","datumTokenizer","queryTokenizer","error","identify","matchAnyQueryToken","bootstrap","datums","trie","datum","id","normalizeTokens","token","chars","ch","shift","newNode","ids","search","query","matches","getIntersection","unique","all","values","serialize","toLowerCase","array","seen","uniques","arrayA","arrayB","ai","bi","intersection","sort","lenArrayA","lenArrayB","Prefetch","prepare","transform","thumbprint","storage","cacheKey","protocol","_settings","dataType","store","location","fromCache","stored","fromNetwork","settings","onError","onResponse","Remote","indexResponse","cancelLastRequest","oParser","defaults","sorter","initialize","sufficient","indexRemote","local","prefetch","remote","parsePrefetch","parseRemote","callbackToDeferred","ajax","wildcard","rateLimitBy","rateLimitWait","toRemotePrepare","toLimiter","prepareByReplace","prepareByWildcard","identityPrepare","encodeURIComponent","deferred","Deferred","onSuccess","reject","old","Bloodhound","noConflict","__ttAdapter","withAsync","withoutAsync","sync","async","_loadPrefetch","serialized","promise","_initialize","initPromise","addLocalToIndex","force","processRemote","nonDuplicates","r","l","clearPrefetchCache","clearRemoteCache","ttAdapter","WWW","defaultClassNames","wrapper","hint","menu","dataset","suggestion","selectable","open","highlight","build","www","classes","css","buildCss","html","buildHtml","selectors","buildSelectors","c","v","display","top","left","borderColor","boxShadow","opacity","verticalAlign","backgroundColor","inputWithNoHint","zIndex","ltr","right","rtl","backgroundImage","EventBus","deprecationMap","el","$el","render","cursorchange","select","autocomplete","_trigger","$e","Event","trigger","isDefaultPrevented","deprecatedType","EventEmitter","splitter","nextTick","getNextTick","onSync","onAsync","off","on","types","bindContext","_callbacks","callbacks","syncFlush","asyncFlush","getFlush","flush","setImmediate","pattern","tagName","className","wordsOnly","caseSensitive","diacriticInsensitive","accented","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","regex","hightlightTextNode","textNode","patternNode","wrapperNode","createElement","splitText","appendChild","cloneNode","parentNode","replaceChild","traverse","childNode","TEXT_NODE_TYPE","childNodes","getRegex","accent_replacer","chr","toUpperCase","patterns","regexStr","escapedPatterns","escapedWord","document","Input","specialKeyCodeMap","$hint","$input","$menu","attr","role","queryWhenFocused","hasFocus","$overflowHelper","buildOverflowHelper","_checkLanguageDirection","setHint","getHint","clearHint","clearHintIfInvalid","_updateDescendent","9","27","37","39","13","38","40","normalizeQuery","_onBlur","resetInputValue","_onFocus","_onKeydown","keyName","which","keyCode","_managePreventDefault","_shouldTrigger","_onInput","_setQuery","getInputValue","preventDefault","withModifier","dir","silent","areEquivalent","hasDifferentWhitespace","areQueriesEquivalent","onBlur","onFocus","onKeydown","onInput","focus","blur","getLangDir","getQuery","setQuery","setInputValue","hasQueryChangedSinceLastFocus","valIsPrefixOfHint","hasOverflow","is","constraint","width","isCursorAtEnd","valueLength","selectionStart","createRange","moveStart","destroy","setAriaExpanded","visibility","whiteSpace","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","wordSpacing","letterSpacing","textIndent","textRendering","textTransform","insertAfter","b","altKey","ctrlKey","metaKey","shiftKey","Dataset","nameGenerator","templates","notFound","isValidName","limit","displayFn","getDisplayFn","displayKey","getTemplates","_resetLastSuggestion","addClass","extractData","_overwrite","suggestions","_renderSuggestions","pending","_renderPending","_renderNotFound","_empty","_append","$lastSuggestion","_appendSuggestions","$fragment","_getSuggestionsFragment","children","last","prepend","_getHeader","append","_getFooter","after","fragment","createDocumentFragment","_injectQuery","footer","header","_query","canceled","syncCalled","rendered","idx","abs","isEmpty","userSuggestionTemplate","suggestionTemplate","Menu","initializeDataset","oDataset","$node","first","appendTo","datasets","_onSelectableClick","currentTarget","_onRendered","toggleClass","_allDatasetsEmpty","_onCleared","_propagate","_getSelectables","_removeCursor","$selectable","getActiveSelectable","removeClass","_ensureVisible","elTop","elBottom","nodeScrollTop","nodeHeight","outerHeight","scrollTop","height","parseInt","onSelectableClick","setCursor","isOpen","hasClass","close","setLanguageDirection","selectableRelativeToCursor","delta","$selectables","$oldCursor","newIndex","eq","getSelectableData","getTopSelectable","isValidUpdate","updateDataset","clearDataset","destroyDataset","Status","options","padding","border","overflow","clip","cleared","words","DefaultMenu","_show","_hide","hide","Typeahead","onFocused","onBlurred","onEnterKeyed","onTabKeyed","onEscKeyed","onUpKeyed","onDownKeyed","onLeftKeyed","onRightKeyed","onQueryChanged","onWhitespaceChanged","eventBus","minLength","enabled","autoselect","active","activate","_hacks","_onSelectableClicked","_onAsyncRequested","_onAsyncCanceled","_onAsyncReceived","_onDatasetRendered","_onDatasetCleared","_onLangDirChanged","isActive","hasActive","activeElement","has","stopImmediatePropagation","_updateHint","cursorClass","_onFocused","_minLengthMet","_onBlurred","_onEnterKeyed","stopPropagation","_onTabKeyed","_onEscKeyed","_onUpKeyed","moveCursor","_onDownKeyed","_onLeftKeyed","_onRightKeyed","_onQueryChanged","_onWhitespaceChanged","_openIfActive","escapedQuery","isEnabled","enable","disable","deactivate","setVal","getVal","$candidate","datasetName","ctx","methods","ttEach","$els","typeahead","buildHintFromInput","removeData","getBackgroundStyles","prop","readonly","required","removeAttr","spellcheck","tabindex","prepInput","style","backgroundAttachment","backgroundClip","backgroundOrigin","backgroundPosition","backgroundRepeat","backgroundSize","revert","$wrapper","parent","detach","$elOrNull","classNames","attach","defaultHint","defaultMenu","MenuConstructor","d","wrap","t","success","newVal","isMergeableObject","isNonNullObject","stringValue","$$typeof","REACT_ELEMENT_TYPE","isReactElement","isSpecial","for","cloneUnlessOtherwiseSpecified","deepmerge","defaultArrayMerge","element","getKeys","symbol","getEnumerableOwnPropertySymbols","propertyIsOnObject","property","mergeObject","destination","hasOwnProperty","propertyIsUnsafe","customMerge","getMergeFunction","arrayMerge","sourceIsArray","deepmerge_1","nodes","ret","matchOperatorsRegex","string","keyList","hasProp","equal","arrA","arrB","dateA","dateB","regexpA","regexpB","monadic","serializer","arg","computedValue","variadic","assemble","strategy","strategyDefault","serializerDefault","ObjectWithoutPrototypeCache","cacheDefault","strategies","stripParameters","youtube","youtubeStr","shortcode","inlinev","parameterv","parameterwebp","embedreg","pop","attrreg","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_arrayLikeToArray","_unsupportedIterableToArray","_nonIterableRest","vimeo","vimeoStr","_str$split","_str$split3","vimeoPipe","vine","videopress","idRegex","microsoftStream","videoStr","getSrc","trim","metadata","service","decodeURIComponent","isObjectObject","ctor","prot","domWalk","Comment","DOMText","DOMElement","DocumentFragment","dispatchEvent","addEventListener","removeEventListener","Document","body","documentElement","proto","createTextNode","createElementNS","ns","createEvent","family","createComment","getElementById","getElementsByClassName","getElementsByTagName","contains","owner","nodeValue","ownerDocument","serializeNode","htmlns","namespaceURI","_attributes","removeChild","elem","needle","splice","insertBefore","setAttributeNS","localName","colonPosition","getAttributeNS","attributes","removeAttributeNS","hasAttributeNS","setAttribute","getAttribute","removeAttribute","hasAttribute","elems","nodeClasses","item","replaceData","current","substring","initEvent","bubbles","cancelable","listener","listeners","ev","handleEvent","voidElements","escapeText","strings","tagname","isProperty","attribute","properties","ds","datasetify","textContent","innerText","innerHTML","serializeElement","tuple","styles","stylify","res","OrderedMap","content","found","newKey","self","addToStart","addToEnd","addBefore","place","without","f","subtract","deleteSelection","dispatch","scrollIntoView","textblockAt","side","firstChild","lastChild","isTextblock","findCutBefore","isolating","depth","findCutAfter","childCount","joinUp","point","sel","nodeSel","setSelection","nodeBefore","joinDown","lift","ref","$to","blockRange","defaultBlockAt","edgeCount","edge","hasRequiredAttrs","exitCode","$head","$anchor","code","sameParent","above","indexAfter","contentMatchAt","canReplaceWith","replaceWith","createAndFill","splitBlock","parentOffset","atEnd","deflt","can","canReplace","setNodeMarkup","selectParentNode","same","sharedDepth","deleteBarrier","$cut","conn","nodeAfter","compatibleContent","delete","clearIncompatible","joinMaybeClear","canDelAfter","findWrapping","matchType","validEnd","copy","step","joinAt","selAfter","at","wrap$1","end$1","i$1","wrapIn","wrapping","setBlockType","applicable","nodesBetween","hasMarkup","toggleMark","markType","$cursor","ranges","loop","allowsMarkType","inlineContent","returned","markApplies","isInSet","storedMarks","marks","removeStoredMark","addStoredMark","ref$1","rangeHasMark","ref$2","$from$1","$to$1","removeMark","spaceStart","spaceEnd","addMark","chainCommands","commands","backspace","endOfTextblock","deleteRange","isAtom","del","pcBaseKeymap","insertText","insert","macBaseKeymap","baseKeymap","platform","os","dropCursor","editorView","DropCursorView","this$1","color","class","cursorPos","handlers","handler","dom","prevState","updateOverlay","rect","nodeRect","nodeDOM","getBoundingClientRect","bottom","coords","coordsAtPos","offsetParent","cssText","parentRect","getComputedStyle","pageXOffset","pageYOffset","scheduleRemoval","dragover","editable","posAtCoords","clientX","clientY","dragging","dragend","drop","dragleave","relatedTarget","ie_edge","ie_upto10","ie_11up","mac","ie","ie_version","documentMode","gecko","gecko_version","chrome","chrome_version","safari","vendor","ios","maxTouchPoints","android","webkit","webkit_version","domIndex","previousSibling","host","reusedRange","textRange","setEnd","setStart","isEquivalentPosition","targetNode","targetOff","scanFor","atomElements","hasBlockDesc","contentEditable","desc","cur","pmViewDesc","contentDOM","selectionCollapsed","domSel","collapsed","isCollapsed","rangeCount","getRangeAt","keyEvent","windowRect","clientWidth","clientHeight","getSide","clientRect","scrollRectIntoView","startDOM","scrollThreshold","someProp","scrollMargin","atTop","bounding","moveX","moveY","defaultView","scrollBy","startX","scrollLeft","startY","dX","dY","scrollStack","stack","restoreScrollStack","dTop","preventScrollSupported","findOffsetInNode","closest","coordsClosest","dxClosest","offset","rowBot","rowTop","childIndex","nextSibling","rects","getClientRects","dx","singleRect","inRect","findOffsetInText","elementFromPoint","box","startI","floor","j","assign","assign$1","caretPositionFromPoint","pos$1","offsetNode","caretRangeFromPoint","startContainer","startOffset","elt","draggable","targetKludge","box$1","outside","docView","nearestDesc","posBefore","posAfter","posFromDOM","posFromCaret","bias","posFromElement","inside","posAtStart","BIDI","domFromPos","supportEmptyRange","takeSide","flattenV","rectBefore","rectAfter","flattenH","before$1","after$1","target$1","y","withFlushedState","viewState","updateState","maybeRTL","cachedState","cachedDir","cachedResult","nearest","boxes","endOfTextblockVertical","atStart","getSelection","modify","oldRange","oldNode","focusNode","oldOff","focusOffset","oldBidiLevel","caretBidiLevel","domAfterPos","removeAllRanges","addRange","endOfTextblockHorizontal","ViewDesc","dirty","prototypeAccessors","beforePosition","posAtEnd","contentLost","domAtom","matchesWidget","matchesMark","matchesNode","matchesHack","parseRule","stopEvent","posBeforeChild","localPosFromDOM","domBefore","domAfter","desc$1","compareDocumentPosition","search$1","onlyNodes","getDesc","scan","descAt","parseRange","base","fromOffset","toOffset","childBase","emptyChildAt","j$1","RangeError","anchor","anchorDOM","headDOM","brKludge","anchorNode","anchorOffset","domSelExtended","collapse","DOMException","tmp","ignoreMutation","mutation","markDirty","startInside","endInside","markParentsDirty","level","nothing","WidgetViewDesc","widget","toDOM","raw","classList","prototypeAccessors$1","ignore","stop","ignoreSelection","CompositionViewDesc","textDOM","prototypeAccessors$2","mut","oldValue","MarkViewDesc","mark","inline","custom","nodeViews","contentElement","replaceNodes","NodeViewDesc","outerDeco","innerDeco","isLeaf","updateChildren","prototypeAccessors$3","descObj","applyOuterDeco","CustomNodeViewDesc","TextViewDesc","reparseInView","rule","preserveWhitespace","getContent","sameOuterDeco","composition","composing","localCompositionNode","updater","ViewTreeUpdater","deco","onWidget","onNode","locals","forChild","decoIndex","restNode","parentIndex","widgets","compareSide","child$1","i$2","cutAt","i$3","cut","iterDeco","insideNode","syncToMarks","placeWidget","findNodeMatch","updateNextNode","addNode","addTextblockHacks","destroyRest","changed","protectLocalComposition","renderDescs","oldCSS","listStyle","iosHacks","nearbyTextNode","textPos","frag","childStart","lastIndexOf","findTextInFragment","topNode","compositionNodes","sameMarkup","updateInner","updateOuterDeco","needsWrap","oldDOM","patchOuterDeco","computeOuterDeco","selectNode","deselectNode","docViewDesc","prototypeAccessors$4","skip","pmIsDeco","inParent","trackWrites","parentDOM","BRHackViewDesc","prototypeAccessors$5","descs","written","childDOM","rm","OuterDecoLevel","noDeco","outerDOM","prevComputed","curComputed","curDOM","patchAttributes","name$1","prevList","curList","m","removeProperty","lockedNode","lock","pre","reverse","preMatch","preMatched","preMatchOffset","replacement","selectionFromDOM","origin","inWidget","isOnEdge","selectionBetween","selectionToDOM","syncNodeSelection","hasSelection","domObserver","disconnectSelection","cursorWrapper","img","visible","disabled","selectCursorWrapper","resetEditableFrom","resetEditableTo","brokenSelectBetweenUneditable","temporarilyEditableNear","resetEditable","hideSelectionGuard","removeClassOnSelectionChange","setCurSelection","connectSelection","getPreMatch","destroyBetween","keep","maxKeep","spanning","markDesc","nextDOM","setEditable","wasDraggable","lastSelectedViewDesc","clearNodeSelection","moveSelectionBlock","$side","$start","selectHorizontally","mods","next$1","textOffset","nodePos","nodeLen","isIgnorable","skipIgnoredNodesLeft","moveNode","moveOffset","isBlockNode","setSelFocus","skipIgnoredNodesRight","selectVertically","beyond","stopNativeHorizontalDelete","nextNode","switchEditable","captureKeyDown","getMods","safariDownArrowBug","ruleFromNode","readDOMChange","typeOver","addedNodes","lastSelectionTime","lastSelectionOrigin","newSel","tr$1","setMeta","$before","shared","parse","from_","to_","lastKeyCode","startDoc","parser","schema","topMatch","topOpen","editableContent","findPositions","anchor$1","parseBetween","preferredPos","preferredSide","lastKeyCodeTime","findDiffStart","findDiffEnd","endA","endB","findDiff","lastIOSEnter","sel$1","resolveSelection","domChangeCount","nextSel","resolveNoCache","inlineChange","$newStart","$newEnd","skipClosingAndOpening","$next","looksLikeJoin","suppressSelectionUpdates","markChange","$from1","chFrom","chTo","marksAcross","curMarks","prevMarks","added","removeFromSet","addToSet","updated","isMarkChange","text$1","sel$2","ensureMarks","parsedSel","fromEnd","mayOpen","maybeChild","serializeForClipboard","openStart","openEnd","defaultAttrs","detachedDoc","serializeFragment","wrapMap","parseFromClipboard","plainText","$context","inCode","asText","parsed","block","metas","firstTag","readHTML","contextNode","querySelector","sliceData","parseSlice","addContext","closeRange","closeSlice","lastWrap","inLast","addToSibling","closeRight","wrapped","withWrappers","normalizeSiblings","sibling","inner","fill","fillBefore","thead","tbody","tfoot","caption","colgroup","col","td","th","_detachedDoc","implementation","createHTMLDocument","observeOptions","childList","characterData","characterDataOldValue","attributeOldValue","subtree","useCharData","SelectionState","DOMObserver","handleDOMChange","queue","flushingSoon","observer","MutationObserver","mutations","removedNodes","flushSoon","currentSelection","onCharData","prevValue","onSelectionChange","suppressingSelectionUpdates","forceFlush","observe","take","takeRecords","disconnect","ignoreSelectionChange","container","commonAncestorContainer","result$1","registerMutation","brs","cssChecked","checkCSS","attributeName","editHandlers","setSelectionOrigin","ensureListeners","currentHandlers","eventHandlers","runCustomHandler","defaultPrevented","eventCoords","runHandlerOnContext","propName","updateSelection","focused","handleSingleClick","selectedNode","selectAt","selectClickedNode","selectClickedLeaf","handleDoubleClick","handleTripleClick","defaultTripleClick","forceDOMFlush","endComposition","keydown","inOrNearComposition","lastIOSEnterFallbackTimeout","keyup","keypress","charCode","fromCharCode","selectNodeModifier","mousedown","flushed","lastClick","time","click","dy","isNear","mouseDown","MouseDown","targetPos","allowDefault","nodeAt","mightDrag","targetDesc","addAttr","setUneditable","up","move","timeStamp","compositionEndedAt","touchdown","contextmenu","timeoutComposition","scheduleComposeEnd","delay","composingTimeout","clearComposition","forceUpdate","compositionstart","compositionupdate","inclusive","markCursor","compositionend","brokenClipboardAPI","doPaste","singleNode","sliceSingleNode","replaceSelectionWith","replaceSelection","clipboardData","clearData","setData","selectNodeContents","captureCopy","paste","getData","capturePaste","Dragging","dragCopyModifier","dragstart","dataTransfer","dragenter","eventPos","$mouse","insertPos","isNode","beforeInsert","replaceRangeWith","replaceRange","maps","_from","_to","_newFrom","newTo","beforeinput","inputType","compareObjs","p$1","WidgetType","noSpec","span","oldOffset","mapResult","deleted","Decoration","valid","other","InlineType","inclusiveStart","inclusiveEnd","NodeType","findIndex","none","DecorationSet","buildTree","findInner","childOff","mapInner","newLocal","mapped","onRemove","oldChildren","oldStart","oldEnd","newStart","newEnd","dSize","mustRebuild","fromLocal","toLocal","childOffset","built","gather","mapAndGatherRemainingDecorations","from$1","byPos","mapChildren","addInner","baseOffset","takeSpansForNode","moveSpans","withoutNulls","removeInner","span$1","dec","localSet","DecorationGroup","removeOverlap","localsInner","members","spans","hasNulls","localStart","working","insertAhead","viewDecorations","sorted","EditorView","_props","_root","mount","mounted","getEditable","updateCursorWrapper","buildNodeViews","computeDocDeco","eventBelongsToView","initInput","pluginViews","updatePluginViews","contenteditable","handleDOMEvents","updateStateInner","setProps","plugins","reconfigured","redraw","updateSel","nA","nB","changedNodeViews","scroll","scrollToSelection","updateDoc","sel1","sel2","refDOM","refTop","newRefTop","oldScrollPos","overflowAnchor","innerHeight","localRect","storeScrollPos","forceSelUpdate","chromeKludge","destroyPluginViews","pluginView","plugin","prop$1","setActive","preventScroll","focusPreventScroll","cached","getPrototypeOf","domAtPos","posAtDOM","destroyInput","dispatchTransaction","GapCursor","Selection","near","toJSON","fromJSON","json","getBookmark","GapBookmark","closedBefore","closedAfter","allowGapCursor","defaultType","findFrom","mustMove","$cur","$cur$1","arrow","axis","dirStr","$found","handleClick","drawGapCursor","openPrompt","mouseOutside","domFields","fields","submitButton","cancelButton","form","title","field","buttons","innerWidth","submit","read","bad","validate","reportInvalid","clean","getValues","callback","elements","message","msg","offsetLeft","offsetWidth","offsetTop","Field","validateType","_value","TextField","placeholder","label","canInsert","cmdItem","cmd","passedOptions","run","markActive","markItem","wrapListItem","buildMenuItems","strong","toggleStrong","icon","em","toggleEm","toggleCode","link","toggleLink","href","image","insertImage","src","alt","bullet_list","wrapBulletList","ordered_list","wrapOrderedList","blockquote","wrapBlockQuote","paragraph","makeParagraph","code_block","makeCodeBlock","heading","horizontal_rule","hr","insertHorizontalRule","insertMenu","typeMenu","makeHead1","makeHead2","makeHead3","makeHead4","makeHead5","makeHead6","inlineMenu","blockMenu","fullMenu","buildKeymap","mapKeys","hard_break","br","list_item","buildInputRules","rules","order","orderedListRule","bulletListRule","codeBlockRule","maxLevel","headingRule","exampleSetup","createSelectionBetween","menuBar","floating","floatingMenu","menuContent","history","GOOD_LEAF_SIZE","RopeSequence","leafAppend","leafPrepend","appendInner","Append","sliceInner","getInner","forEachInner","forEachInvertedInner","Leaf","leftLen","Branch","items","eventCount","popEvent","preserveItems","remap","mapFrom","remapping","addAfter","Item","maybeStep","appendMap","addTransform","histOptions","newItems","oldItems","lastItem","steps","merged","invert","docs","merge","cutPoint","DEPTH_OVERFLOW","mirrorPos","mirrorOffset","addMaps","rebased","rebasedTransform","rebasedCount","rebasedItems","newUntil","iRebased","getMirror","newMaps","branch","emptyItemCount","compress","count","upto","events","getMap","newItem","HistoryState","undone","prevRanges","prevTime","rangesFor","mapRanges","histTransaction","redo","mustPreserveItems","historyKey","config","newHist","historyState","cachedPreserveItems","cachedPreserveItemsPlugins","historyPreserveItems","closeHistoryKey","newGroupDelay","hist","historyTr","getMeta","appended","newGroup","adjacent","isAdjacentTo","applyTransaction","undo","getState","InputRule","cutOff","inputRules","isInputRules","textBefore","undoInputRule","undoable","toUndo","emDash","ellipsis","smartQuotes","wrappingInputRule","getAttrs","joinPredicate","textblockTypeInputRule","8","10","12","16","17","18","20","32","33","34","35","36","44","45","46","59","61","91","92","106","107","108","109","110","111","144","145","160","161","162","163","164","165","173","186","187","188","189","190","191","192","219","220","221","222","229","48","49","50","51","52","53","54","55","56","57","brokenModifierNames","normalizeKeyName","ctrl","meta","parts","mod","modifiers","keymap","keydownHandler","normalize","baseName","isChar","direct","charCodeAt","fromCode","withShift","crelt","SVG","getIcon","path","hashPath","buildSVG","svg","prefix$1","MenuItem","translate","selected","setClass","lastMenuEvent","markMenuEvent","isMenuEvent","Dropdown","renderDropdownItems","updates","combineUpdates","something","listeningOnClose","expand","menuDOM","DropdownSubmenu","icons","bulletList","orderedList","joinUpItem","liftItem","selectParentNodeItem","undoItem","redoItem","wrapItem","blockTypeItem","cls","prefix$2","MenuBarView","spacer","maxHeight","widthForMaxHeight","separators","localUpdates","localNodes","update$1","needSep","hasContent","renderGrouped","contentUpdate","agent","isIOS","updateFloat","potentialScrollers","getAllWrapping","scrollFunc","updateScrollCursor","offsetHeight","minHeight","selRect","DOCUMENT_POSITION_FOLLOWING","selectionIsInverted","menuRect","scrollable","scrollHeight","findWrappingScrollable","scrollAncestor","editorRect","childA","childB","posA","posB","iA","iB","minSize","Fragment","nodeStart","blockSeparator","leafText","separated","withText","cutByIndex","otherPos","round","retIndex","curPos","toStringInner","nodeFromJSON","fromArray","joined","compareDeep","Mark","ReplaceError","placed","excludes","rank","sameSet","setFrom","Slice","removeRange","indexTo","offsetTo","insertInto","dist","replaceOuter","$along","extra","prepareSliceForReplace","replaceThreeWay","replaceTwoWay","checkJoin","main","sub","joinable","$after","$end","startIndex","endIndex","validContent","insertAt","removeBetween","maxOpen","openIsolating","n$1","ResolvedPos","resolveDepth","dOff","posAtIndex","pred","NodeRange","rem","resolveCached","resolveCache","resolveCachePos","resolveCacheSize","prototypeAccessors$1$1","emptyAttrs","startPos","includeParents","childAfter","childBefore","toDebugString","wrapMarks","contentMatch","matchFragment","one","two","allowsMarks","canAppend","check","markFromJSON","TextNode","ContentMatch","wrapCache","nodeTypes","stream","TokenStream","expr","parseExpr","nfa","labeled","explore","nullFrom","states","out","term","known","states$1","cmp","dfa","connect","compile","edges","exprs","loop$1","next$2","work","dead","checkForDeadEnds","compatible","toEnd","finished","tp","computed","computeWrapping","via","prototypeAccessors$1$2","parseExprSeq","eat","parseExprSubscript","typeName","type$1","groups","resolveName","parseExprAtom","parseExprRange","parseNum","attrName","hasDefault","default","computeAttrs","given","initAttrs","Attribute","tok","SyntaxError","group","markSet","atom","isRequired","createChecked","allowedMarks","topType","prototypeAccessors$1$3","MarkType","Schema","contentExprCache","contentExpr","markExpr","gatherMarks","prop$2","excl","topNodeType","wrappings","ok","mark$1","DOMParser","tags","tag","normalizeLists","ParseContext","addAll","finish","matchTag","matchesContext","matchStyle","schemaRules","priority","parseDOM","rules$1","fromSchema","domParser","blockTags","address","article","aside","canvas","dd","div","dl","fieldset","figcaption","figure","h1","h2","h3","h4","h5","h6","hgroup","li","noscript","ol","output","section","table","ul","ignoreTags","script","listTags","wsOptionsFor","NodeContext","pendingMarks","solid","activeMarks","stashMarks","popFromStashMark","applyPending","nextType","markMayApply","topContext","topOptions","needsBlock","prototypeAccessors$6","currentPos","selector","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","addDOM","addTextNode","readStyles","re","parseStyles","addPendingMark","addElement","removePendingMark","domNodeBefore","insertNode","findInText","findInside","matchAfter","ruleID","prevItem","normalizeList","closeParent","oldNeedsBlock","leafFallback","addElementByRule","consuming","continueAfter","enter","startIn","findAround","findAtPoint","findPlace","route","cx","enterInner","textblockFromContext","closeExtra","preserveWS","option","useRoot","minDepth","part","findSameMarkInSet","stashMark","DOMSerializer","gatherToDOM","markDOM","serializeMark","renderSpec","onContent","serializeNodeAndMarks","structure","xmlNS","space","space$1","innerContent","domSerializer","nodesFromSchema","marksFromSchema","olDOM","ulDOM","liDOM","listItem","defining","addListNodes","itemContent","listGroup","wrapInList","listType","doJoin","outerRange","$insert","wrappers","joinBefore","splitDepth","splitPos","doWrapInList","splitListItem","itemType","grandParent","keepItem","liftListItem","endOfList","liftToOuterList","indexBefore","liftOutOfList","sinkListItem","nestedBefore","classesById","SelectionRange","lastNode","lastParent","selectionToInsertionEnd","textOnly","TextSelection","findSelectionIn","AllSelection","jsonID","selectionClass","between","TextBookmark","dPos","NodeSelection","NodeBookmark","isSelectable","AllBookmark","startLen","Transaction","Transform","curSelection","curSelectionFor","storedMarksSet","isGeneric","scrolledIntoView","setStoredMarks","addStep","setTime","inheritMarks","FieldDesc","baseFields","_marks","_old","Configuration","pluginsByKey","EditorState","filterTransaction","rootTr","transactions","trs","applyInner","haveNew","appendTransaction","newInstance","applyListeners","$config","reconfigure","pluginFields","addApplyListener","removeApplyListener","bindProps","Plugin","createKey","PluginKey","factor16","pow","recoverIndex","MapResult","recover","StepMap","inverted","diff","recoverOffset","assoc","_map","simple","oldIndex","oldSize","newSize","touches","Mapping","mirror","TransformError","mirrors","setMirror","appendMapping","startSize","mirr","appendMappingInverted","totalSize","inverse","corr","mustOverride","failed","stepsByID","Step","_doc","_mapping","_other","stepType","stepClass","StepResult","fromReplace","ReplaceStep","contentBetween","slice$1","ReplaceAroundStep","gapFrom","gapTo","gap","inserted","canCut","liftTarget","innerRange","around","outer","findWrappingOutside","innerMatch","findWrappingInside","withAttrs","canSplit","typesAfter","innerType","index$1","rest","baseType","canJoin","joinPoint","dropPoint","pass","mapFragment","gapStart","gapEnd","splitting","d$1","splitting$1","canChangeType","startM","endM","typeAfter","AddMarkStep","oldSlice","RemoveMarkStep","fitsTrivially","removing","adding","newSet","matched","toRemove","found$1","parentType","delSteps","allowed","Fitter","fit","replaceStep","unplaced","frontier","dropFromFragment","addToFragment","contentAt","closeNodeStart","contentAfterFits","invalidMarks","closeFragment","oldOpen","newOpen","coveredDepths","findFittable","placeNodes","openMore","dropNode","moveInline","mustMoveInline","placedSize","sliceDepth","frontierDepth","inject","openAtEnd","closeFrontierNode","openFrontierNode","taken","openEndCount","findCloseLevel","dropInner","match$1","targetDepths","preferredTarget","unshift","preferredTargetIndex","leftNodes","preferredDepth","openDepth","targetDepth","startSteps","insertPoint","covered","offset$1"],"mappings":"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","file":"js/2888.3609817367c703845322.bundle.js","sourcesContent":["import _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _typeof from '@babel/runtime/helpers/typeof';\nimport deepmerge from 'deepmerge';\nimport fastDeepEqual from 'fast-deep-equal';\nimport fastMemoize from 'fast-memoize';\nimport nano from 'nanoid';\nimport objectOmit from 'object.omit';\nimport objectPick from 'object.pick';\nexport * from 'throttle-debounce';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/**\n * Type cast an argument. If no type is provided it will default to any.\n *\n * @param arg - the arg to typecast\n */\nvar Cast = function Cast(arg) {\n  return arg;\n};\n/**\n * Shorthand for casting a value to it's boolean equivalent.\n *\n * @param value - the value to transform into a boolean\n *\n * @public\n */\n\nvar bool = function bool(value) {\n  return !!value;\n};\n/**\n * A type name matcher for object types.\n *\n * @private\n */\n\nvar TypeName;\n/**\n * Alias of toString for non-dom environments.\n *\n * @private\n */\n\n(function (TypeName) {\n  TypeName[\"Object\"] = \"Object\";\n  TypeName[\"RegExp\"] = \"RegExp\";\n  TypeName[\"Date\"] = \"Date\";\n  TypeName[\"Promise\"] = \"Promise\";\n  TypeName[\"Error\"] = \"Error\";\n  TypeName[\"Map\"] = \"Map\";\n  TypeName[\"Set\"] = \"Set\";\n})(TypeName || (TypeName = {}));\n\nvar toString = Object.prototype.toString;\n/**\n * Retrieve the object type of a value via it's string reference. This is safer\n * than relying on instanceof checks which fail on cross-frame values.\n *\n * @param value - the object to inspect\n */\n\nvar getObjectType = function getObjectType(value) {\n  var objectName = toString.call(value).slice(8, -1);\n  return objectName;\n};\n/**\n * A helper for building type predicates\n *\n * @param type -  the name of the type to check for\n * @returns a predicate function for checking the value type\n */\n\n\nvar isOfType = function isOfType(type, test) {\n  return function (value) {\n    return _typeof(value) === type ? test ? test(value) : true : false;\n  };\n};\n/**\n * Get the object type of passed in value. This avoids the reliance on\n * `instanceof` checks which are subject to cross frame issues as outlined in\n * this link https://bit.ly/1Qds27W\n *\n * @param type - the name of the object type to check for\n *\n * @private\n */\n\n\nvar isObjectOfType = function isObjectOfType(type) {\n  return function (value) {\n    return getObjectType(value) === type;\n  };\n};\n/**\n * Check if an instance is the direct instance of the provided class.\n */\n\n\nvar isDirectInstanceOf = function isDirectInstanceOf(instance, Constructor) {\n  return Object.getPrototypeOf(instance) === Constructor.prototype;\n};\n/**\n * Predicate check that value is undefined\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isUndefined = isOfType('undefined');\n/**\n * Predicate check that value is a string\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isString = isOfType('string');\n/**\n * Predicate check that value is a number.\n *\n * Also by default doesn't include NaN as a valid number.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNumber = isOfType('number', function (val) {\n  return !Number.isNaN(val);\n});\n/**\n * Predicate check that value is a function\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isFunction = isOfType('function');\n/**\n * Predicate check that value is null\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNull = function isNull(value) {\n  return value === null;\n};\n/**\n * Predicate check that value is a class\n *\n * @deprecated Due to the current build process stripping out classes\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isClass = function isClass(value) {\n  return isFunction(value) && value.toString().startsWith('class ');\n};\n/**\n * Predicate check that value is boolean\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isBoolean = function isBoolean(value) {\n  return value === true || value === false;\n};\n/**\n * Predicate check that value is a symbol\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isSymbol = isOfType('symbol');\n/**\n * Helper function for Number.isInteger check allowing non numbers to be tested\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isInteger = function isInteger(value) {\n  return Number.isInteger(value);\n};\n/**\n * Helper function for Number.isSafeInteger allowing for unknown values to be\n * tested\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isSafeInteger = function isSafeInteger(value) {\n  return Number.isSafeInteger(value);\n};\n/**\n * Predicate check for whether passed in value is a plain object\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isPlainObject = function isPlainObject(value) {\n  if (getObjectType(value) !== TypeName.Object) {\n    return false;\n  }\n\n  var prototype = Object.getPrototypeOf(value);\n  return prototype === null || prototype === Object.getPrototypeOf({});\n};\n/**\n * Utility predicate check that value is either null or undefined\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNullOrUndefined = function isNullOrUndefined(value) {\n  return isNull(value) || isUndefined(value);\n};\n/**\n * Predicate check that value is an object\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isObject = function isObject(value) {\n  return !isNullOrUndefined(value) && (isFunction(value) || isOfType('object')(value));\n};\n/**\n * A shorthand method for creating instance of checks.\n */\n\nvar isInstanceOf = function isInstanceOf(Constructor) {\n  return function (value) {\n    return isObject(value) && value instanceof Constructor;\n  };\n};\n/**\n * Predicate check that value is a native promise\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNativePromise = function isNativePromise(value) {\n  return isObjectOfType(TypeName.Promise)(value);\n};\n/**\n * Check to see if a value has the built in promise API.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar hasPromiseAPI = function hasPromiseAPI(value) {\n  return !isNull(value) && isObject(value) && isFunction(value.then) && isFunction(value[\"catch\"]);\n};\n/**\n * Predicate check that value has the promise api implemented\n *\n * @param value - the value to check\n *\n * @public\n */\n\n\nvar isPromise = function isPromise(value) {\n  return isNativePromise(value) || hasPromiseAPI(value);\n};\n/**\n * Predicate check that value is a RegExp\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isRegExp = isObjectOfType(TypeName.RegExp);\n/**\n * Predicate check that value is a date\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isDate = isObjectOfType(TypeName.Date);\n/**\n * Predicate check that value is an error\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isError = isObjectOfType(TypeName.Error);\n/**\n * Predicate check that value is a `Map`\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isMap = function isMap(value) {\n  return isObjectOfType(TypeName.Map)(value);\n};\n/**\n * Predicate check that value is a `Set`\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isSet = function isSet(value) {\n  return isObjectOfType(TypeName.Set)(value);\n};\n/**\n * Predicate check that value is an empty object\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isEmptyObject = function isEmptyObject(value) {\n  return isObject(value) && !isMap(value) && !isSet(value) && Object.keys(value).length === 0;\n};\n/**\n * Alias the isArray method.\n */\n\nvar isArray = Array.isArray;\n/**\n * Predicate check that value is an empty array\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isEmptyArray = function isEmptyArray(value) {\n  return isArray(value) && value.length === 0;\n};\n/**\n * Capitalizes a string value.\n *\n * @param str - the string to capitalize.\n * @public\n */\n\nvar capitalize = function capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n};\n/**\n * Removes leading and trailing whitespace from a string.\n *\n * @param str - the string to trim\n *\n * @public\n */\n\nvar trim = function trim(str) {\n  return str.replace(/^ +| +$/g, '');\n};\n/**\n * Trim and conditionally capitalize string values.\n *\n * @param str - the string to format.\n *\n * @public\n */\n\nvar format = function format(str) {\n  str = trim(str);\n  return /^(?:webOS|i(?:OS|P))/.test(str) ? str : capitalize(str);\n};\n/**\n * Calls a function if defined and provides compile time type checking for the\n * passed in parameters.\n *\n * @param fn - the function to call if it exists\n * @param args - the rest of the parameters with types\n */\n\nvar callIfDefined = function callIfDefined(fn) {\n  if (isFunction(fn)) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    fn.apply(void 0, args);\n  }\n};\n/**\n * Finds all the regex matches for a string\n *\n * @param text - the text to check against\n * @param regexp - the regex (which should include a 'g' flag)\n *\n * @public\n */\n\nvar findMatches = function findMatches(text, regexp) {\n  var results = [];\n  var flags = regexp.flags;\n  var match;\n\n  if (!flags.includes('g')) {\n    regexp = new RegExp(regexp.source, \"g\".concat(flags));\n  }\n\n  do {\n    match = regexp.exec(text);\n\n    if (match) {\n      results.push(match);\n    }\n  } while (match);\n\n  regexp.lastIndex = 0;\n  return results;\n};\n/**\n * A utility function to clean up the Operating System name.\n *\n * @param os - the OS name to clean up.\n * @param pattern - a `RegExp` pattern matching the OS name.\n * @param label - a label for the OS.\n * @returns a cleaned up Operating System name\n *\n * @public\n */\n\nvar cleanupOS = function cleanupOS(os, pattern, label) {\n  if (pattern && label) {\n    os = os.replace(RegExp(pattern, 'i'), label);\n  }\n\n  var val = format(os.replace(/ ce$/i, ' CE').replace(/\\bhpw/i, 'web').replace(/\\bMacintosh\\b/, 'Mac OS').replace(/_PowerPC\\b/i, ' OS').replace(/\\b(OS X) [^ \\d]+/i, '$1').replace(/\\bMac (OS X)\\b/, '$1').replace(/\\/(\\d)/, ' $1').replace(/_/g, '.').replace(/(?: BePC|[ .]*fc[ \\d.]+)$/i, '').replace(/\\bx86\\.64\\b/gi, 'x86_64').replace(/\\b(Windows Phone) OS\\b/, '$1').replace(/\\b(Chrome OS \\w+) [\\d.]+\\b/, '$1').split(' on ')[0]);\n  return val;\n};\n/**\n * A utility function to check whether the current browser is running on the\n * android platform.\n * @public\n */\n\nvar isAndroidOS = function isAndroidOS() {\n  var ua = navigator.userAgent;\n  var match = RegExp('\\\\b' + 'Android' + '(?:/[\\\\d.]+|[ \\\\w.]*)', 'i').exec(ua);\n\n  if (!match) {\n    return false;\n  }\n\n  return cleanupOS(match[0], 'Android', 'Android').includes('Android');\n};\n/**\n * Generate a random float between min and max. If only one parameter is\n * provided minimum is set to 0.\n *\n * @param min - the minimum value\n * @param max - the maximum value\n *\n * @public\n */\n\nvar randomFloat = function randomFloat(min, max) {\n  if (!max) {\n    max = min;\n    min = 0.0;\n  }\n\n  return Math.random() * (max - min + 1) + min;\n};\n/**\n * Generate a random integer between min and max. If only one parameter is\n * provided minimum is set to 0.\n *\n * @param min - the minimum value\n * @param max - the maximum value\n *\n * @public\n */\n\nvar randomInt = function randomInt(min, max) {\n  return Math.floor(randomFloat(min, max));\n};\n/**\n * Converts a string, including strings in camelCase or snake_case, into Start\n * Case (a variant of Title Case where all words start with a capital letter),\n * it keeps original single quote and hyphen in the word.\n *\n *   'management_companies' to 'Management Companies' 'managementCompanies' to\n *   'Management Companies' `hell's kitchen` to `Hell's Kitchen` `co-op` to\n *   `Co-op`\n *\n * @param str - the string to examine\n */\n\nvar startCase = function startCase(str) {\n  return str.replace(/_/g, ' ').replace(/([a-z])([A-Z])/g, function (_, $1, $2) {\n    return \"\".concat($1, \" \").concat($2);\n  }).replace(/(\\s|^)(\\w)/g, function (_, $1, $2) {\n    return \"\".concat($1).concat($2.toUpperCase());\n  });\n};\nvar wordSeparators = /[\\s\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,\\-./:;<=>?@[\\]^_`{|}~]+/;\nvar capitals = /[A-Z\\u00C0-\\u00D6\\u00D9-\\u00DD]/g;\n/**\n * Returns the kebab cased form of a string.\n *\n * Taken from\n * https://github.com/angus-c/just/blob/master/packages/string-kebab-case/index.js\n * kebabCase('the quick brown fox'); // 'the-quick-brown-fox'\n * kebabCase('the-quick-brown-fox'); // 'the-quick-brown-fox'\n * kebabCase('the_quick_brown_fox'); // 'the-quick-brown-fox'\n * kebabCase('theQuickBrownFox'); // 'the-quick-brown-fox'\n * kebabCase('theQuickBrown Fox'); // 'the-quick-brown-fox'\n * kebabCase('thequickbrownfox'); // 'thequickbrownfox' kebabCase('the - quick *\n * brown# fox'); // 'the-quick-brown-fox' kebabCase('theQUICKBrownFox'); //\n * 'the-q-u-i-c-k-brown-fox'\n */\n\nvar kebabCase = function kebabCase(str) {\n  // replace capitals with space + lower case equivalent for later parsing\n  return str.replace(capitals, function (match) {\n    return \" \".concat(match.toLowerCase() || match);\n  }).trim().split(wordSeparators).join('-');\n};\n/**\n * This is required since it is not exported from `fastMemomize`\n *\n * @internalRemarks\n * TODO create a pull request to fix this.\n */\n\n/**\n * Alias for caching function calls\n */\nvar memoize = fastMemoize;\n\n/**\n * Generate a unique id\n *\n * @param params - the destructured params\n * @returns a unique string of specified length\n *\n * @public\n */\nvar uniqueId = function uniqueId() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    prefix: ''\n  },\n      _ref$prefix = _ref.prefix,\n      prefix = _ref$prefix === void 0 ? '' : _ref$prefix,\n      size = _ref.size;\n\n  return \"\".concat(prefix).concat(nano(size));\n};\n/**\n * Takes a number of elements from the provided array starting from the\n * zero-index\n *\n * @param arr - the array to take from\n * @param num - the number of items to take\n *\n * @public\n */\n\nvar take = function take(arr, num) {\n  num = Math.max(Math.min(0, num), num);\n  return arr.slice(0, num);\n};\n/**\n * Alias for picking properties from an object\n */\n\nvar pick = objectPick;\n/**\n * Alias for excluding properties from an object\n */\n\nvar omit = objectOmit;\nvar omitUndefined = function omitUndefined(object) {\n  return omit(object, function (value) {\n    return !isUndefined(value);\n  });\n};\n/**\n * Clones a plain object using object spread notation\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar clone = function clone(value) {\n  if (!isPlainObject(value)) {\n    throw new Error('An invalid value was passed into this clone utility. Expected a plain object');\n  }\n\n  return _objectSpread({}, value);\n};\n/**\n * Alias for fast deep equal\n */\n\nvar isEqual = fastDeepEqual;\n/**\n * Create a unique array in a non-mutating manner\n *\n * @param array - the array which will be reduced to its unique elements\n * @param fromStart - when set to true the duplicates will be removed from the\n * beginning of the array. This defaults to false.\n * @return a new array containing only unique elements (by reference)\n *\n * @public\n */\n\nvar uniqueArray = function uniqueArray(array) {\n  var fromStart = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var arr = fromStart ? _toConsumableArray(array).reverse() : array;\n  var set = new Set(arr);\n  return fromStart ? Array.from(set).reverse() : Array.from(set);\n};\n/**\n * Flattens an array\n *\n * @param array\n *\n * @public\n */\n\nvar flattenArray = function flattenArray(array) {\n  return array.reduce(function (a, b) {\n    return a.concat(Array.isArray(b) ? flattenArray(b) : b);\n  }, []);\n};\n/**\n * Sometimes doing nothing is the best policy.\n */\n\nvar noop = function noop() {};\n/**\n * Use this to completely overwrite an object when merging.\n *\n * ```ts\n * const source = { awesome: { a: 'a' } }\n * const target = { awesome: { b: 'b' } }\n * const result = deepMerge(source, target) // => { awesome: { a: 'a', b: 'b' } }\n *\n * const overwriteTarget = { awesome: Merge.overwrite({ b: 'b' }) }\n * const overwriteResult = deepMerge(source, overwriteTarget) // => { awesome: { b: 'b' } }\n * ```\n *\n */\n\nvar Merge =\n/*#__PURE__*/\nfunction () {\n  _createClass(Merge, null, [{\n    key: \"overwrite\",\n\n    /**\n     * Create an object that will completely replace the key when merging.\n     *\n     * @param [obj] - the object to replace the key with. When blank an empty\n     * object is used.\n     */\n    value: function overwrite() {\n      var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Object.create(null);\n      return new Merge(obj);\n    }\n    /**\n     * Sets the key to undefined thus fully deleting the key.\n     */\n\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      return undefined;\n    }\n    /**\n     * This can be used to mimic any object shape.\n     */\n\n  }]);\n\n  function Merge() {\n    var _this = this;\n\n    var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Object.create(null);\n\n    _classCallCheck(this, Merge);\n\n    Object.keys(obj).forEach(function (key) {\n      _this[key] = obj[key];\n    });\n  }\n\n  return Merge;\n}();\n/**\n * A deep merge which only merges plain objects and Arrays. It clones the object\n * before the merge so will not mutate any of the passed in values.\n *\n * To completely remove a key you can use the `Merge` helper class which\n * replaces it's key with a completely new object\n */\n\nvar deepMerge = function deepMerge() {\n  for (var _len2 = arguments.length, objects = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    objects[_key2] = arguments[_key2];\n  }\n\n  return deepmerge.all(objects, {\n    isMergeableObject: isPlainObject\n  });\n};\n\n/**\n * Clamps the value to the provided range.\n */\nvar clamp = function clamp(_ref2) {\n  var min = _ref2.min,\n      max = _ref2.max,\n      value = _ref2.value;\n  return value < min ? min : value > max ? max : value;\n};\n/**\n * Get the last element of the array.\n */\n\nvar last = function last(array) {\n  return array[array.length - 1];\n};\n/**\n * Sorts an array while retaining the original order when the compare method\n * identifies the items as equal.\n *\n * `Array.prototype.sort()` is unstable and so values that are the same will\n * jump around in a non deterministic manner. Here I'm using the index as a\n * fallback. If two elements have the same priority the element with the lower\n * index is placed first hence retaining the original order.\n *\n * @param array - the array to sort\n * @param compareFn - compare the two value arguments `a` and `b` - return 0 for\n *                  equal - return number > 0 for a > b - return number < 0 for\n *                  b > a\n */\n\nvar sort = function sort(array, compareFn) {\n  return _toConsumableArray(array).map(function (value, index) {\n    return {\n      value: value,\n      index: index\n    };\n  }).sort(function (a, b) {\n    return compareFn(a.value, b.value) || a.index - b.index;\n  }).map(function (_ref3) {\n    var value = _ref3.value;\n    return value;\n  });\n};\n/**\n * Get a property from an object or array by a string path or an array path.\n *\n * @param path - path to property\n * @param obj - object to retrieve property from\n */\n\nvar get = function get(path, obj, fallback) {\n  if (!path || !path.length) {\n    return isUndefined(obj) ? fallback : obj;\n  }\n\n  if (isString(path)) {\n    path = path.split('.');\n  }\n\n  for (var ii = 0, len = path.length; ii < len && obj; ++ii) {\n    if (!isPlainObject(obj) && !isArray(obj)) {\n      return fallback;\n    }\n\n    obj = obj[path[ii]];\n  }\n\n  return isUndefined(obj) ? fallback : obj;\n};\n/**\n * Create a unique array of objects from a getter function or a property list.\n *\n * @param array - the array to extract unique values from\n * @param getValue - a getter function or a string with the path to the item\n * that is being used as a a test for uniqueness.\n * @param fromStart - when true will remove duplicates from the start rather\n * than from the end\n *\n * ```ts\n * import { uniqueBy } from '@remirror/core-helpers';\n *\n * const values = uniqueBy([{ id: 'a', value: 'Awesome' }, { id: 'a', value: 'ignored' }], item => item.id);\n * log(values) // => [{id: 'a', value: 'Awesome'}]\n *\n * const byKey = uniqueBy([{ id: 'a', value: 'Awesome' }, { id: 'a', value: 'ignored' }], 'id')\n * // Same as above\n * ```\n */\n\nvar uniqueBy = function uniqueBy(array, getValue) {\n  var fromStart = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var unique = [];\n  var found = new Set();\n\n  var makeFn = function makeFn(val) {\n    return function (item) {\n      return get(val, item);\n    };\n  };\n\n  var getter = isFunction(getValue) ? getValue : makeFn(getValue);\n  var arr = fromStart ? _toConsumableArray(array).reverse() : array;\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var _item = _step.value;\n\n      var _value = getter(_item);\n\n      if (!found.has(_value)) {\n        found.add(_value);\n        unique.push(_item);\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return fromStart ? unique.reverse() : unique;\n};\n/**\n * A typesafe implementation of `Object.entries`\n *\n * Taken from\n * https://github.com/biggyspender/ts-entries/blob/master/src/ts-entries.ts\n */\n\nvar entries = function entries(obj) {\n  return Object.entries(obj);\n};\n/**\n * A typesafe implementation of `Object.keys`\n */\n\nvar keys = function keys(obj) {\n  return Object.keys(obj);\n};\n/**\n * A more lenient typed version of `Array.prototype.includes` which allow less\n * specific types to be checked.\n */\n\nvar includes = function includes(array, item, fromIndex) {\n  return array.includes(item, fromIndex);\n};\n/**\n * Create a range from start to end.\n *\n * If only start is provided it creates an array of the size provided. if start\n * and end are provided it creates an array who's first position is start and\n * final position is end. i.e. `length = (end - start) + 1`\n */\n\nvar range = function range(start, end) {\n  return !isNumber(end) ? Array.from({\n    length: Math.abs(start)\n  }, function (_, index) {\n    return (start < 0 ? -1 : 1) * index;\n  }) : start <= end ? Array.from({\n    length: end + 1 - start\n  }, function (_, index) {\n    return index + start;\n  }) : Array.from({\n    length: start + 1 - end\n  }, function (_, index) {\n    return -1 * index + start;\n  });\n};\n/**\n * Check that a number is within the minimum and maximum bounds of a set of\n * numbers.\n *\n * @param value - the number to test\n */\n\nvar within = function within(value) {\n  for (var _len3 = arguments.length, rest = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n    rest[_key3 - 1] = arguments[_key3];\n  }\n\n  var numbers = rest.filter(isNumber);\n  return value >= Math.min.apply(Math, _toConsumableArray(numbers)) && value <= Math.max.apply(Math, _toConsumableArray(numbers));\n};\n/**\n * Safe implementation of hasOwnProperty with typechecking.\n *\n * @remarks\n *\n * See {@link https://eslint.org/docs/rules/no-prototype-builtins}\n *\n * @param obj - the object to check\n * @param key - the property to check\n *\n * @typeParam GObj - the object type\n * @typeParam GProperty - the property which can be a string | number | symbol\n */\n\nvar hasOwnProperty = function hasOwnProperty(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n};\n\nexport { Cast, Merge, bool, callIfDefined, capitalize, clamp, cleanupOS, clone, deepMerge, entries, findMatches, flattenArray, format, get, hasOwnProperty, includes, isAndroidOS, isArray, isBoolean, isClass, isDate, isDirectInstanceOf, isEmptyArray, isEmptyObject, isEqual, isError, isFunction, isInstanceOf, isInteger, isMap, isNativePromise, isNull, isNullOrUndefined, isNumber, isObject, isPlainObject, isPromise, isRegExp, isSafeInteger, isSet, isString, isSymbol, isUndefined, kebabCase, keys, last, memoize, noop, omit, omitUndefined, pick, randomFloat, randomInt, range, sort, startCase, take, trim, uniqueArray, uniqueBy, uniqueId, within };\n//# sourceMappingURL=core-helpers.esm.js.map\n","import _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport { bool, isObject, isNullOrUndefined, isNumber, Cast, isString, isFunction, keys, findMatches } from '@remirror/core-helpers';\nimport { lift, wrapIn, setBlockType } from 'prosemirror-commands';\nimport { liftListItem, wrapInList } from 'prosemirror-schema-list';\nimport _construct from '@babel/runtime/helpers/construct';\nimport { EMPTY_PARAGRAPH_NODE } from '@remirror/core-constants';\nimport minDocument from 'min-document';\nimport { NodeType, MarkType, Node as Node$1, Schema, ResolvedPos, Fragment, DOMSerializer, DOMParser, Slice } from 'prosemirror-model';\nimport { EditorState, TextSelection, Selection, NodeSelection, Plugin } from 'prosemirror-state';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { isUndefined } from 'util';\nimport { InputRule } from 'prosemirror-inputrules';\n\n/// <reference types=\"node\" />\n/**\n * A object with flags identifying the current environment.\n *\n * @public\n */\n\nvar environment = {\n  /**\n   * Verifies that the environment has both a window and window.document\n   */\n  get isBrowser() {\n    return bool(typeof window !== 'undefined' && typeof window.document !== 'undefined' && window.navigator && window.navigator.userAgent);\n  },\n\n  /**\n   * Verifies that the environment is JSDOM\n   */\n  get isJSDOM() {\n    return environment.isBrowser && window.navigator.userAgent.includes('jsdom');\n  },\n\n  /**\n   * Verifies that the environment has a nodejs process and is therefore a node environment\n   */\n  get isNode() {\n    return typeof process !== 'undefined' && process.versions != null && process.versions.node != null;\n  },\n\n  /**\n   * True when running on macOS\n   */\n  get isMac() {\n    return environment.isBrowser && /Mac|iPod|iPhone|iPad/.test(navigator.platform);\n  },\n\n  /**\n   * Verify that this is an apple device either on the client or server.\n   */\n  get isApple() {\n    return environment.isNode ? process.platform === 'darwin' : environment.isBrowser ? /Mac|iPod|iPhone|iPad/.test(window.navigator.platform) : false;\n  },\n\n  /**\n   * True when running in DEVELOPMENT environment\n   */\n  get isDevelopment() {\n    return process.env.NODE_ENV === 'development';\n  },\n\n  /**\n   * True when running unit tests\n   */\n  get isTest() {\n    return process.env.NODE_ENV === 'test';\n  },\n\n  /**\n   * True when running in PRODUCTION environment\n   */\n  get isProduction() {\n    return process.env.NODE_ENV === 'production';\n  }\n\n};\n\n/**\n * Check to see if the passed value is a NodeType.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNodeType = function isNodeType(value) {\n  return isObject(value) && value instanceof NodeType;\n};\n/**\n * Check to see if the passed value is a MarkType.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isMarkType = function isMarkType(value) {\n  return isObject(value) && value instanceof MarkType;\n};\n/**\n * Checks to see if the passed value is a ProsemirrorNode\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isProsemirrorNode = function isProsemirrorNode(value) {\n  return isObject(value) && value instanceof Node$1;\n};\n/**\n * Checks to see if the passed value is a Prosemirror Editor State\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isEditorState = function isEditorState(value) {\n  return isObject(value) && value instanceof EditorState;\n};\n/**\n * Checks to see if the passed value is an instance of the editor schema\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isEditorSchema = function isEditorSchema(value) {\n  return isObject(value) && value instanceof Schema;\n};\n/**\n * Predicate checking whether the selection is a TextSelection\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isTextSelection = function isTextSelection(value) {\n  return isObject(value) && value instanceof TextSelection;\n};\n/**\n * Predicate checking whether the value is a Selection\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isSelection = function isSelection(value) {\n  return isObject(value) && value instanceof Selection;\n};\n/**\n * Predicate checking whether the value is a ResolvedPosition.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isResolvedPos = function isResolvedPos(value) {\n  return isObject(value) && value instanceof ResolvedPos;\n};\n/**\n * Predicate checking whether the selection is a NodeSelection\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNodeSelection = function isNodeSelection(value) {\n  return isObject(value) && value instanceof NodeSelection;\n};\n\n/**\n * Checks that a mark is active within the selected region, or the current selection point is within a\n * region with the mark active. Used by extensions to implement their active methods.\n *\n * @remarks\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param state - the editor state\n * @param type - the mark type\n *\n * @public\n */\nvar isMarkActive = function isMarkActive(_ref) {\n  var state = _ref.state,\n      type = _ref.type,\n      from = _ref.from,\n      to = _ref.to;\n  var selection = state.selection,\n      doc = state.doc,\n      storedMarks = state.storedMarks;\n  var $from = selection.$from,\n      empty = selection.empty;\n\n  if (from && to) {\n    try {\n      return Math.max(from, to) < doc.nodeSize && doc.rangeHasMark(from, to, type);\n    } catch (_unused) {\n      return false;\n    }\n  }\n\n  if (empty) {\n    return bool(type.isInSet(storedMarks !== null && storedMarks !== void 0 ? storedMarks : $from.marks()));\n  }\n\n  return doc.rangeHasMark(selection.from, selection.to, type);\n};\n/**\n * Check if the specified type (NodeType) can be inserted at the current selection point.\n *\n * @remarks\n *\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param state - the editor state\n * @param type - the node type\n *\n * @public\n */\n\nvar canInsertNode = function canInsertNode(state, type) {\n  var $from = state.selection.$from;\n\n  for (var depth = $from.depth; depth >= 0; depth--) {\n    var index = $from.index(depth);\n\n    try {\n      if ($from.node(depth).canReplaceWith(index, index, type)) {\n        return true;\n      }\n    } catch (_unused2) {\n      return false;\n    }\n  }\n\n  return false;\n};\n/**\n * Checks if a node looks like an empty document\n *\n * @param node - the prosemirror node\n *\n * @public\n */\n\nvar isDocNodeEmpty = function isDocNodeEmpty(node) {\n  var nodeChild = node.content.firstChild;\n\n  if (node.childCount !== 1 || !nodeChild) {\n    return false;\n  }\n\n  return nodeChild.type.isBlock && !nodeChild.childCount && nodeChild.nodeSize === 2 && (isNullOrUndefined(nodeChild.marks) || nodeChild.marks.length === 0);\n};\n/**\n * Checks if the current node a paragraph node and empty\n *\n * @param node - the prosemirror node\n *\n * @public\n */\n\nvar isEmptyParagraphNode = function isEmptyParagraphNode(node) {\n  return !isProsemirrorNode(node) || node.type.name === 'paragraph' && !node.textContent && !node.childCount;\n};\n/**\n * Retrieve the attributes for a mark.\n *\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param state - the editor state\n * @param type - the mark type\n */\n\nvar getMarkAttrs = function getMarkAttrs(state, type) {\n  var _state$selection = state.selection,\n      from = _state$selection.from,\n      to = _state$selection.to;\n  var marks = [];\n  state.doc.nodesBetween(from, to, function (node) {\n    marks = [].concat(_toConsumableArray(marks), _toConsumableArray(node.marks));\n  });\n  var mark = marks.find(function (markItem) {\n    return markItem.type.name === type.name;\n  });\n\n  if (mark) {\n    return mark.attrs;\n  }\n\n  return {};\n};\n/**\n * Retrieve the start and end position of a mark\n *\n * @remarks\n *\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param pmPosition - the resolved prosemirror position\n * @param type - the mark type\n */\n\nvar getMarkRange = function getMarkRange() {\n  var pmPosition = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n  if (!pmPosition || !type) {\n    return false;\n  }\n\n  var start = pmPosition.parent.childAfter(pmPosition.parentOffset);\n\n  if (!start.node) {\n    return false;\n  }\n\n  var mark = start.node.marks.find(function (_ref2) {\n    var markType = _ref2.type;\n    return markType === type;\n  });\n\n  if (!mark) {\n    return false;\n  }\n\n  var startIndex = pmPosition.index();\n  var startPos = pmPosition.start() + start.offset;\n\n  while (startIndex > 0 && mark.isInSet(pmPosition.parent.child(startIndex - 1).marks)) {\n    startIndex -= 1;\n    startPos -= pmPosition.parent.child(startIndex).nodeSize;\n  }\n\n  var endPos = startPos + start.node.nodeSize;\n  return {\n    from: startPos,\n    to: endPos\n  };\n};\n/**\n * Retrieves the text content from a slice\n *\n * @remarks\n * A utility that's useful for pulling text content from a slice which is usually created via `selection.content()`\n *\n * @param slice - the prosemirror slice\n *\n * @public\n */\n\nvar getTextContentFromSlice = function getTextContentFromSlice(slice) {\n  var node = slice.content.firstChild;\n  return node ? node.textContent : '';\n};\n/**\n * Takes an empty selection and expands it out to the nearest group not matching the excluded characters.\n *\n * @remarks\n *\n * Can be used to find the nearest selected word. See {@link getSelectedWord}\n *\n * @param state - the editor state\n * @param exclude - the regex pattern to exclude\n * @returns false if not a text selection or if no expansion available\n *\n * @public\n */\n\nvar getSelectedGroup = function getSelectedGroup(state, exclude) {\n  if (!isTextSelection(state.selection)) {\n    return false;\n  }\n\n  var _state$selection2 = state.selection,\n      from = _state$selection2.from,\n      to = _state$selection2.to;\n\n  var getChar = function getChar(start, end) {\n    return getTextContentFromSlice(TextSelection.create(state.doc, start, end).content());\n  };\n\n  for (var _char = getChar(from - 1, from); _char && !exclude.test(_char); from--, _char = getChar(from - 1, from)) {// Step backwards until reaching first excluded character or empty text content.\n  }\n\n  for (var _char2 = getChar(to, to + 1); _char2 && !exclude.test(_char2); to++, _char2 = getChar(to, to + 1)) {// Step forwards until reaching the first excluded character or empty text content\n  }\n\n  if (from === to) {\n    return false;\n  }\n\n  return {\n    from: from,\n    to: to\n  };\n};\n/**\n * Retrieves the nearest space separated word from the current selection.\n *\n * @remarks\n *\n * This always expands outward so that given:\n * `The tw<start>o words<end>`\n * The selection would become\n * `The <start>two words<end>`\n *\n * In other words it expands until it meets an invalid character.\n *\n * @param state - the editor state\n *\n * @public\n */\n\nvar getSelectedWord = function getSelectedWord(state) {\n  return getSelectedGroup(state, /[\\s\\0]/);\n};\n/**\n * Retrieve plugin state of specified type\n *\n * @param plugin - the plugin or plugin key\n * @param state - the editor state\n *\n * @public\n */\n\nvar getPluginState = function getPluginState(plugin, state) {\n  return plugin.getState(state);\n};\n/**\n * Retrieve plugin meta data of specified type\n *\n * @param key - the plugin key\n * @param tr - the transaction to retrieve from\n *\n * @public\n */\n\nvar getPluginMeta = function getPluginMeta(key, tr) {\n  return tr.getMeta(key);\n};\n/**\n * Set the plugin meta data\n *\n * @param key - the plugin key\n * @param tr - the transaction\n * @param data - the data to set\n *\n * @public\n */\n\nvar setPluginMeta = function setPluginMeta(key, tr, data) {\n  return tr.setMeta(key, data);\n};\n/**\n * Get matching string from a list or single value\n *\n * @remarks\n * Get attrs can be called with a direct match string or array of string matches.\n * This method should be used to retrieve the required string.\n *\n * The index of the matched array used defaults to 0 but can be updated via the second parameter.\n *\n * @param match - the match(es)\n * @param index - the zero-index point from which to start\n *\n * @public\n */\n\nvar getMatchString = function getMatchString(match) {\n  var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  return Array.isArray(match) ? match[index] : match;\n};\n/**\n * Checks whether the passed value is a valid dom node\n *\n * @param domNode - the dom node\n *\n * @public\n */\n\nvar isDOMNode = function isDOMNode(domNode) {\n  return isObject(Node) ? domNode instanceof Node : isObject(domNode) && isNumber(Cast(domNode).nodeType) && isString(Cast(domNode).nodeName);\n};\n/**\n * Checks for an element node like `<p>` or `<div>`.\n *\n * @param domNode - the dom node\n *\n * @public\n */\n\nvar isElementDOMNode = function isElementDOMNode(domNode) {\n  return isDOMNode(domNode) && domNode.nodeType === Node.ELEMENT_NODE;\n};\n/**\n * Finds the closest element which matches the passed selector\n *\n * @param domNode - the dom node\n * @param selector - the selector\n *\n * @public\n */\n\nvar closestElement = function closestElement(domNode, selector) {\n  if (!isElementDOMNode(domNode)) {\n    return null;\n  }\n\n  if (isNullOrUndefined(document.documentElement) || !document.documentElement.contains(domNode)) {\n    return null;\n  }\n\n  var matches = isFunction(domNode.matches) ? 'matches' : Cast('msMatchesSelector');\n\n  do {\n    var _domNode$parentElemen;\n\n    if (isFunction(domNode[matches]) && domNode[matches](selector)) {\n      return domNode;\n    }\n\n    domNode = (_domNode$parentElemen = domNode.parentElement) !== null && _domNode$parentElemen !== void 0 ? _domNode$parentElemen : domNode.parentNode;\n  } while (isElementDOMNode(domNode));\n\n  return null;\n};\n/**\n * Checks for a text node.\n *\n * @param domNode - the dom node\n *\n * @public\n */\n\nvar isTextDOMNode = function isTextDOMNode(domNode) {\n  return isDOMNode(domNode) && domNode.nodeType === Node.TEXT_NODE;\n};\nvar getOffsetParent = function getOffsetParent(_ref3) {\n  var view = _ref3.view,\n      element = _ref3.element;\n  return isNullOrUndefined(element) ? view.dom.offsetParent : element.offsetParent;\n};\n/**\n * Retrieve the line height from a an element\n *\n * @param params - the element params\n */\n\nvar getLineHeight = function getLineHeight(_ref4) {\n  var element = _ref4.element;\n  return parseFloat(window.getComputedStyle(element, undefined).lineHeight || '');\n};\n\n/**\n * Retrieve the absolute coordinates\n *\n * @remarks\n *\n * We need to translate the co-ordinates because `coordsAtPos` returns co-ordinates\n * relative to `window`. And, also need to adjust the cursor container height.\n * (0, 0)\n *\n * ```\n * +--------------------- [window] ---------------------+\n * |   (left, top) +-------- [Offset Parent] --------+  |\n * | {coordsAtPos} | [Cursor]   <- cursorHeight      |  |\n * |               | [FloatingToolbar]               |  |\n * ```\n *\n * @param params - see {@link AbsoluteCoordinatesParams}.\n */\nvar absoluteCoordinates = function absoluteCoordinates(_ref5) {\n  var view = _ref5.view,\n      element = _ref5.element,\n      position = _ref5.position,\n      _ref5$cursorHeight = _ref5.cursorHeight,\n      cursorHeight = _ref5$cursorHeight === void 0 ? getLineHeight({\n    element: element\n  }) : _ref5$cursorHeight;\n  var offsetParent = getOffsetParent({\n    view: view,\n    element: element\n  });\n  var box = offsetParent.getBoundingClientRect();\n  return {\n    left: position.left - box.left,\n    right: position.right - box.left,\n    top: position.top - (box.top - cursorHeight) + offsetParent.scrollTop,\n    bottom: box.height - (position.top - (box.top - cursorHeight) - offsetParent.scrollTop)\n  };\n};\n/**\n * Retrieve the nearest non-text node\n *\n * @param domNode - the dom node\n */\n\nvar getNearestNonTextNode = function getNearestNonTextNode(domNode) {\n  return isTextDOMNode(domNode) ? domNode.parentNode : domNode;\n};\n/**\n * Checks whether the cursor is at the end of the state.doc\n *\n * @param state - the editor state\n */\n\nvar atDocEnd = function atDocEnd(state) {\n  return state.doc.nodeSize - state.selection.$to.pos - 2 === state.selection.$to.depth;\n};\n/**\n * Checks whether the cursor is at the beginning of the state.doc\n *\n * @param state - the editor state\n */\n\nvar atDocStart = function atDocStart(state) {\n  return state.selection.$from.pos === state.selection.$from.depth;\n};\n/**\n * Get the start position of the parent of the current resolve position\n *\n * @param pmPosition - the resolved prosemirror position\n */\n\nvar startPositionOfParent = function startPositionOfParent(pmPosition) {\n  return pmPosition.start(pmPosition.depth);\n};\n/**\n * Get the end position of the parent of the current resolve position\n *\n * @param pmPosition - the resolved prosemirror position\n *\n * @public\n */\n\nvar endPositionOfParent = function endPositionOfParent(pmPosition) {\n  return pmPosition.end(pmPosition.depth) + 1;\n};\n/**\n * Retrieve the current position of the cursor\n *\n * @param selection - the editor selection\n * @returns a resolved position only when the selection is a text selection\n *\n * @public\n */\n\nvar getCursor = function getCursor(selection) {\n  return isTextSelection(selection) ? selection.$cursor : undefined;\n};\n/**\n * Checks to see whether a nodeMatch checker is a tuple\n *\n * @remarks\n * A node matcher can either be a string, a function a regex or a regex tuple. This check for the latter two.\n *\n * @param nodeMatch - the node match\n *\n * @public\n */\n\nvar isRegexTuple = function isRegexTuple(nodeMatch) {\n  return Array.isArray(nodeMatch) && nodeMatch.length > 0 && nodeMatch.length <= 2;\n};\n/**\n * Test the passed in regexp tuple\n *\n * @param tuple - a regex tuple\n * @param value - the string to test against\n *\n * @public\n */\n\n\nvar regexTest = function regexTest(tuple, value) {\n  var regex = _construct(RegExp, _toConsumableArray(tuple));\n\n  return regex.test(value);\n};\n/**\n * Checks to see whether the name of the passed node matches anything in the list provided.\n *\n * @param node - the prosemirror node\n * @param nodeMatches - the node matches array\n * @returns true if the node name is a match to any of the items in the nodeMatches array\n *\n * @public\n */\n\n\nvar nodeNameMatchesList = function nodeNameMatchesList(node, nodeMatches) {\n  var outcome = false;\n\n  if (!node) {\n    return outcome;\n  }\n\n  var name = node.type.name;\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = nodeMatches[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var checker = _step.value;\n      outcome = isRegexTuple(checker) ? regexTest(checker, name) : isFunction(checker) ? checker(name, node) : checker === name;\n\n      if (outcome) {\n        return outcome;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return outcome;\n};\n/**\n * Checks whether a Prosemirror node is the top level `doc` node\n *\n * @param node - the prosemirror node\n * @param schema - the prosemirror schema\n *\n * @public\n */\n\nvar isDocNode = function isDocNode(node, schema) {\n  return isProsemirrorNode(node) && (schema ? node.type === schema.nodes.doc : node.type.name === 'doc');\n};\n/**\n * Checks whether the passed in JSON is a valid object node\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isObjectNode = function isObjectNode(value) {\n  return isObject(value) && value.type === 'doc' && Array.isArray(value.content);\n};\n\nvar fallbackContent = function fallbackContent(_ref6) {\n  var fallback = _ref6.fallback,\n      schema = _ref6.schema;\n  return isProsemirrorNode(fallback) ? fallback : schema.nodeFromJSON(fallback);\n};\n/**\n * Creates a document node from the passed in content and schema.\n *\n * @param params - the destructured create document node params\n *\n * @public\n */\n\n\nvar createDocumentNode = function createDocumentNode(_ref7) {\n  var content = _ref7.content,\n      schema = _ref7.schema,\n      doc = _ref7.doc,\n      stringHandler = _ref7.stringHandler,\n      _ref7$fallback = _ref7.fallback,\n      fallback = _ref7$fallback === void 0 ? EMPTY_PARAGRAPH_NODE : _ref7$fallback;\n\n  if (isProsemirrorNode(content)) {\n    return content;\n  }\n\n  if (isObjectNode(content)) {\n    try {\n      return schema.nodeFromJSON(content);\n    } catch (e) {\n      console.error(e);\n      return fallbackContent({\n        fallback: fallback,\n        schema: schema\n      });\n    }\n  }\n\n  if (isString(content) && stringHandler) {\n    return stringHandler({\n      doc: doc,\n      content: content,\n      schema: schema\n    });\n  }\n\n  return fallbackContent({\n    fallback: fallback,\n    schema: schema\n  });\n};\n/**\n * Checks which environment should be used. Returns true when we are in the dom environment.\n *\n * @param forceEnvironment - force a specific environment to override the outcome\n */\n\nvar shouldUseDOMEnvironment = function shouldUseDOMEnvironment(forceEnvironment) {\n  return forceEnvironment === 'dom' || environment.isBrowser && !forceEnvironment;\n};\n/**\n * Retrieves the document based on the environment we are currently in.\n *\n * @param forceEnvironment - force a specific environment\n */\n\nvar getDocument = function getDocument(forceEnvironment) {\n  return shouldUseDOMEnvironment(forceEnvironment) ? document : minDocument;\n};\n\n/**\n * Convert a node into its DOM representative\n *\n * @param params - the from node params\n *\n * @public\n */\nvar toDOM = function toDOM(_ref8) {\n  var node = _ref8.node,\n      schema = _ref8.schema,\n      doc = _ref8.doc;\n  var fragment = isDocNode(node, schema) ? node.content : Fragment.from(node);\n  return DOMSerializer.fromSchema(schema).serializeFragment(fragment, {\n    document: doc\n  });\n};\n\n/**\n * Convert a prosemirror node into it's HTML contents\n *\n * @param params - the from node params\n *\n * @public\n */\nvar toHTML = function toHTML(_ref9) {\n  var node = _ref9.node,\n      schema = _ref9.schema,\n      _ref9$doc = _ref9.doc,\n      doc = _ref9$doc === void 0 ? getDocument() : _ref9$doc;\n  var element = doc.createElement('div');\n  element.appendChild(toDOM({\n    node: node,\n    schema: schema,\n    doc: doc\n  }));\n  return element.innerHTML;\n};\n\n/**\n * Convert a HTML string into Prosemirror node\n *\n * @param params - the from html params\n *\n * @public\n */\nvar fromHTML = function fromHTML(_ref10) {\n  var content = _ref10.content,\n      schema = _ref10.schema,\n      _ref10$doc = _ref10.doc,\n      doc = _ref10$doc === void 0 ? getDocument() : _ref10$doc;\n  var element = doc.createElement('div');\n  element.innerHTML = content.trim();\n  return DOMParser.fromSchema(schema).parse(element);\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n/* \"Borrowed\" from prosemirror-utils in order to avoid requirement of\n`@prosemirror-tables`*/\n\n/**\n * Checks if the type a given `node` equals to a given `nodeType`.\n */\nvar nodeEqualsType = function nodeEqualsType(_ref) {\n  var types = _ref.types,\n      node = _ref.node;\n  return node ? Array.isArray(types) && types.includes(node.type) || node.type === types : false;\n};\n/**\n * Creates a new transaction object from a given transaction\n *\n * @param tr - the prosemirror transaction\n *\n * @public\n */\n\nvar cloneTransaction = function cloneTransaction(tr) {\n  return Object.assign(Object.create(tr), tr).setTime(Date.now());\n};\n\n/**\n * Returns a `delete` transaction that removes a node at a given position with\n * the given `node`. `position` should point at the position immediately before\n * the node.\n *\n * @param position - the prosemirror position\n *\n * @public\n */\nvar removeNodeAtPosition = function removeNodeAtPosition(_ref2) {\n  var pos = _ref2.pos,\n      tr = _ref2.tr;\n  var node = tr.doc.nodeAt(pos);\n\n  if (!node) {\n    return tr;\n  }\n\n  return cloneTransaction(tr[\"delete\"](pos, pos + node.nodeSize));\n};\n/**\n * Returns DOM reference of a node at a given `position`.\n *\n * @remarks\n *\n * If the node type is of type `TEXT_NODE` it will return the reference of the\n * parent node.\n *\n * A simple use case\n *\n * ```ts\n * const element = findElementAtPosition($from.pos, view);\n * ```\n *\n * @param position - the prosemirror position\n * @param view - the editor view\n *\n * @public\n */\n\nvar findElementAtPosition = function findElementAtPosition(position, view) {\n  var dom = view.domAtPos(position);\n  var node = dom.node.childNodes[dom.offset];\n\n  if (isTextDOMNode(dom.node)) {\n    return dom.node.parentNode;\n  }\n\n  if (isNullOrUndefined(node) || isTextDOMNode(node)) {\n    return dom.node;\n  }\n\n  return node;\n};\n/**\n * Iterates over parent nodes, returning the closest node and its start position\n * that the `predicate` returns truthy for. `start` points to the start position\n * of the node, `pos` points directly before the node.\n *\n * ```ts\n * const predicate = node => node.type === schema.nodes.blockquote;\n * const parent = findParentNode({predicate, selection});\n * ```\n */\n\nvar findParentNode = function findParentNode(_ref3) {\n  var predicate = _ref3.predicate,\n      selection = _ref3.selection;\n  var $from = selection.$from;\n\n  for (var depth = $from.depth; depth > 0; depth--) {\n    var node = $from.node(depth);\n\n    if (predicate(node)) {\n      var pos = depth > 0 ? $from.before(depth) : 0;\n      var start = $from.start(depth);\n      var end = pos + node.nodeSize;\n      return {\n        pos: pos,\n        depth: depth,\n        node: node,\n        start: start,\n        end: end\n      };\n    }\n  }\n\n  return;\n};\n/**\n * Finds the node at the resolved position.\n *\n * @param $pos - the resolve position in the document\n */\n\nvar findNodeAtPosition = function findNodeAtPosition($pos) {\n  var depth = $pos.depth;\n  var pos = depth > 0 ? $pos.before(depth) : 0;\n  var node = $pos.node(depth);\n  var start = $pos.start(depth);\n  var end = pos + node.nodeSize;\n  return {\n    pos: pos,\n    start: start,\n    node: node,\n    end: end,\n    depth: depth\n  };\n};\n/**\n * Finds the node at the passed selection.\n */\n\nvar findNodeAtSelection = function findNodeAtSelection(selection) {\n  var parentNode = findParentNode({\n    predicate: function predicate() {\n      return true;\n    },\n    selection: selection\n  });\n\n  if (isUndefined(parentNode)) {\n    throw new Error('No parent node found for the selection provided.');\n  }\n\n  return parentNode;\n};\n/**\n * Finds the node at the end of the Prosemirror document.\n *\n * @param doc - the parent doc node of the editor which contains all the other\n * nodes.\n *\n * @deprecated use `doc.lastChild` instead\n */\n\nvar findNodeAtEndOfDoc = function findNodeAtEndOfDoc(doc) {\n  return findNodeAtPosition(Selection.atEnd(doc).$from);\n};\n/**\n * Finds the node at the start of the prosemirror.\n *\n * @param doc - the parent doc node of the editor which contains all the other\n * nodes.\n *\n * @deprecated use `doc.firstChild` instead\n */\n\nvar findNodeAtStartOfDoc = function findNodeAtStartOfDoc(doc) {\n  return findNodeAtPosition(Selection.atStart(doc).$from);\n};\n\n/**\n *  Iterates over parent nodes, returning closest node of a given `nodeType`.\n *  `start` points to the start position of the node, `pos` points directly\n *  before the node.\n *\n *  ```ts\n *  const parent = findParentNodeOfType({types: schema.nodes.paragraph, selection});\n *  ```\n */\nvar findParentNodeOfType = function findParentNodeOfType(_ref4) {\n  var types = _ref4.types,\n      selection = _ref4.selection;\n  return findParentNode({\n    predicate: function predicate(node) {\n      return nodeEqualsType({\n        types: types,\n        node: node\n      });\n    },\n    selection: selection\n  });\n};\n/**\n * Returns position of the previous node.\n *\n * ```ts\n * const pos = findPositionOfNodeBefore(tr.selection);\n * ```\n *\n * @param selection - the prosemirror selection\n */\n\nvar findPositionOfNodeBefore = function findPositionOfNodeBefore(value) {\n  var $pos = isResolvedPos(value) ? value : isSelection(value) ? value.$from : value.selection.$from;\n\n  if (isNullOrUndefined($pos)) {\n    throw new Error('Invalid value passed in.');\n  }\n\n  var nodeBefore = $pos.nodeBefore;\n  var selection = Selection.findFrom($pos, -1);\n\n  if (!selection || !nodeBefore) {\n    return;\n  }\n\n  var parent = findParentNodeOfType({\n    types: nodeBefore.type,\n    selection: selection\n  });\n  return parent ? parent : {\n    node: nodeBefore,\n    pos: selection.$from.pos,\n    end: selection.$from.end(),\n    depth: selection.$from.depth + 1,\n    start: selection.$from.start(selection.$from.depth + 1)\n  };\n};\n/**\n * Returns a new transaction that deletes previous node.\n *\n * ```ts\n * dispatch(\n *    removeNodeBefore(state.tr)\n * );\n * ```\n *\n * @param tr\n *\n * @public\n */\n\nvar removeNodeBefore = function removeNodeBefore(tr) {\n  var result = findPositionOfNodeBefore(tr.selection);\n\n  if (result) {\n    return removeNodeAtPosition({\n      pos: result.pos,\n      tr: tr\n    });\n  }\n\n  return tr;\n};\n\n/**\n * Returns a node of a given `nodeType` if it is selected. `start` points to the\n * start position of the node, `pos` points directly before the node.\n *\n * ```ts\n * const { extension, inlineExtension, bodiedExtension } = schema.nodes;\n *\n * const selectedNode = findSelectedNodeOfType({\n *   types: [extension, inlineExtension, bodiedExtension],\n *   selection,\n * });\n * ```\n */\nvar findSelectedNodeOfType = function findSelectedNodeOfType(_ref5) {\n  var types = _ref5.types,\n      selection = _ref5.selection;\n\n  if (isNodeSelection(selection)) {\n    var node = selection.node,\n        $from = selection.$from;\n\n    if (nodeEqualsType({\n      types: types,\n      node: node\n    })) {\n      return {\n        node: node,\n        pos: $from.pos,\n        depth: $from.depth,\n        start: $from.start(),\n        end: $from.pos + node.nodeSize\n      };\n    }\n  }\n\n  return undefined;\n};\n\n/**\n * Returns the position of the node after the current position, selection or state.\n *\n * ```ts\n * const pos = findPositionOfNodeBefore(tr.selection);\n * ```\n *\n * @param selection - the prosemirror selection\n */\nvar findPositionOfNodeAfter = function findPositionOfNodeAfter(value) {\n  var $pos = isResolvedPos(value) ? value : isSelection(value) ? value.$from : value.selection.$from;\n\n  if (isNullOrUndefined($pos)) {\n    throw new Error('Invalid value passed in.');\n  }\n\n  var nodeAfter = $pos.nodeAfter;\n  var selection = Selection.findFrom($pos, 1);\n\n  if (!selection || !nodeAfter) {\n    return;\n  }\n\n  var parent = findParentNodeOfType({\n    types: nodeAfter.type,\n    selection: selection\n  });\n  return parent ? parent : {\n    node: nodeAfter,\n    pos: selection.$from.pos,\n    end: selection.$from.end(),\n    depth: selection.$from.depth + 1,\n    start: selection.$from.start(selection.$from.depth + 1)\n  };\n};\n/**\n * Returns a new transaction that deletes the node after.\n *\n * ```ts\n * dispatch(\n *    removeNodeBefore(state.tr)\n * );\n * ```\n *\n * @param tr\n *\n * @public\n */\n\nvar removeNodeAfter = function removeNodeAfter(tr) {\n  var result = findPositionOfNodeAfter(tr.selection);\n\n  if (result) {\n    return removeNodeAtPosition({\n      pos: result.pos,\n      tr: tr\n    });\n  }\n\n  return tr;\n};\n/**\n * Checks whether the selection or state is currently empty.\n *\n * @param value - the current selection or state\n */\n\nvar selectionEmpty = function selectionEmpty(value) {\n  return isSelection(value) ? value.empty : isEditorState(value) ? value.selection.empty : true;\n};\n/**\n * Check to see if a transaction has changed either the document or the current\n * selection.\n *\n * @param params - the TransactionChangeParams object\n */\n\nvar transactionChanged = function transactionChanged(tr) {\n  return tr.docChanged || tr.selectionSet;\n};\n\n/**\n * Checks whether the node type passed in is active within the region. Used by\n * extensions to implement the `#active` method.\n *\n * To ignore attrs just leave the attrs object empty or undefined.\n *\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param params - the destructured node active parameters\n */\nvar isNodeActive = function isNodeActive(_ref6) {\n  var _findSelectedNodeOfTy;\n\n  var state = _ref6.state,\n      type = _ref6.type,\n      _ref6$attrs = _ref6.attrs,\n      attrs = _ref6$attrs === void 0 ? Object.create(null) : _ref6$attrs;\n  var selection = state.selection;\n\n  var predicate = function predicate(node) {\n    return node.type === type;\n  };\n\n  var parent = (_findSelectedNodeOfTy = findSelectedNodeOfType({\n    selection: selection,\n    types: type\n  })) !== null && _findSelectedNodeOfTy !== void 0 ? _findSelectedNodeOfTy : findParentNode({\n    predicate: predicate,\n    selection: selection\n  });\n\n  if (!Object.keys(attrs).length || !parent) {\n    return bool(parent);\n  }\n\n  return parent.node.hasMarkup(type, attrs);\n};\n\n/**\n * Converts a schema to a simple json compatible object.\n */\nvar schemaToJSON = function schemaToJSON(schema) {\n  var nodes = keys(schema.nodes).reduce(function (acc, key) {\n    var spec = schema.nodes[key].spec;\n    return _objectSpread({}, acc, _defineProperty({}, key, spec));\n  }, Object.create(null));\n  var marks = keys(schema.marks).reduce(function (acc, key) {\n    var spec = schema.marks[key].spec;\n    return _objectSpread({}, acc, _defineProperty({}, key, spec));\n  }, Object.create(null));\n  return {\n    nodes: nodes,\n    marks: marks\n  };\n};\n/**\n * Wraps the default {@link ProsemirrorCommandFunction} and makes it compatible with the default **remirror**\n * {@link CommandFunction} call signature.\n */\n\nvar convertCommand = function convertCommand(commandFunction) {\n  return function (_ref7) {\n    var state = _ref7.state,\n        dispatch = _ref7.dispatch,\n        view = _ref7.view;\n    return commandFunction(state, dispatch, view);\n  };\n};\n/**\n * Similar to the chainCommands from the `prosemirror-commands` library. Allows multiple commands to be\n * chained together and runs until one of them returns true.\n */\n\nvar chainCommands = function chainCommands() {\n  for (var _len = arguments.length, commands = new Array(_len), _key = 0; _key < _len; _key++) {\n    commands[_key] = arguments[_key];\n  }\n\n  return function (_ref8) {\n    var state = _ref8.state,\n        dispatch = _ref8.dispatch,\n        view = _ref8.view,\n        rest = _objectWithoutProperties(_ref8, [\"state\", \"dispatch\", \"view\"]);\n\n    for (var commandIndex = 0; commandIndex < commands.length; commandIndex++) {\n      if (commands[commandIndex](_objectSpread({\n        state: state,\n        dispatch: dispatch,\n        view: view\n      }, rest))) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n};\n/**\n * Chains together keybindings.\n *\n * @remarks\n *\n * When `next` hands over full control of the keybindings to the caller.\n */\n\nvar chainKeyBindingCommands = function chainKeyBindingCommands() {\n  for (var _len2 = arguments.length, commands = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    commands[_key2] = arguments[_key2];\n  }\n\n  return function (params) {\n    if (!commands.length) {\n      return false;\n    }\n\n    var command = commands[0],\n        rest = commands.slice(1);\n    var calledNext = false;\n\n    var createNext = function createNext() {\n      for (var _len3 = arguments.length, nextCommands = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        nextCommands[_key3] = arguments[_key3];\n      }\n\n      return function () {\n        if (!nextCommands.length) {\n          return false;\n        }\n\n        calledNext = true;\n        var nextRest = nextCommands.slice(1);\n        return chainKeyBindingCommands.apply(void 0, nextCommands)(_objectSpread({}, params, {\n          next: createNext.apply(void 0, _toConsumableArray(nextRest))\n        }));\n      };\n    };\n\n    var next = createNext.apply(void 0, _toConsumableArray(rest));\n    var status = command(_objectSpread({}, params, {\n      next: next\n    }));\n\n    if (calledNext || status) {\n      return status;\n    }\n\n    return next();\n  };\n};\n\n/**\n * Update the selection with the provided MarkType\n *\n * @param type - the type to update the mark to\n * @param attrs - attrs to use for the mark\n *\n * @public\n */\nvar updateMark = function updateMark(_ref) {\n  var type = _ref.type,\n      _ref$attrs = _ref.attrs,\n      attrs = _ref$attrs === void 0 ? Object.create(null) : _ref$attrs,\n      appendText = _ref.appendText,\n      range = _ref.range;\n  return function (state, dispatch) {\n    var selection = state.selection;\n    var tr = state.tr;\n\n    var _ref2 = range !== null && range !== void 0 ? range : selection,\n        from = _ref2.from,\n        to = _ref2.to;\n\n    tr.addMark(from, to, type.create(attrs));\n\n    if (appendText) {\n      tr.insertText(appendText);\n    }\n\n    if (dispatch) {\n      dispatch(tr);\n    }\n\n    return true;\n  };\n};\n/**\n * Toggle between wrapping an inactive node with the provided node type, and lifting it up into it's parent.\n *\n * @param type - the node type to toggle\n * @param attrs - the attrs to use for the node\n *\n * @public\n */\n\nvar toggleWrap = function toggleWrap(type, attrs) {\n  return function (state, dispatch) {\n    var isActive = isNodeActive({\n      state: state,\n      type: type\n    });\n\n    if (isActive) {\n      return lift(state, dispatch);\n    }\n\n    return wrapIn(type, attrs)(state, dispatch);\n  };\n};\n/**\n * Toggles a list item.\n *\n * @remarks\n * When the provided list wrapper is inactive (e.g. ul) then wrap the list with this type.\n * When it is active then remove the selected line from the list.\n *\n * @param type - the list node type\n * @param itemType - the list item type (must be in the schema)\n *\n * @public\n */\n\nvar toggleList = function toggleList(type, itemType) {\n  return function (state, dispatch) {\n    var schema = state.schema,\n        selection = state.selection;\n    var $from = selection.$from,\n        $to = selection.$to;\n    var range = $from.blockRange($to);\n\n    if (!range) {\n      return false;\n    }\n\n    function isList(node, schema) {\n      return node.type === schema.nodes.bulletList || node.type === schema.nodes.orderedList;\n    }\n\n    var parentList = findParentNode({\n      predicate: function predicate(node) {\n        return isList(node, schema);\n      },\n      selection: selection\n    });\n\n    if (range.depth >= 1 && parentList && range.depth - parentList.depth <= 1) {\n      if (parentList.node.type === type) {\n        return liftListItem(itemType)(state, dispatch);\n      }\n\n      if (isList(parentList.node, schema) && type.validContent(parentList.node.content)) {\n        var tr = state.tr;\n        tr.setNodeMarkup(parentList.pos, type);\n\n        if (dispatch) {\n          dispatch(tr);\n        }\n\n        return true;\n      }\n    }\n\n    return wrapInList(type)(state, dispatch);\n  };\n};\n\n/**\n * Toggle a block between the provided type and toggleType.\n *\n * @param params - the destructured params\n *\n * @public\n */\nvar toggleBlockItem = function toggleBlockItem(_ref3) {\n  var type = _ref3.type,\n      toggleType = _ref3.toggleType,\n      _ref3$attrs = _ref3.attrs,\n      attrs = _ref3$attrs === void 0 ? Object.create(null) : _ref3$attrs;\n  return function (state, dispatch) {\n    var isActive = isNodeActive({\n      state: state,\n      type: type,\n      attrs: attrs\n    });\n\n    if (isActive) {\n      return setBlockType(toggleType)(state, dispatch);\n    }\n\n    return setBlockType(type, attrs)(state, dispatch);\n  };\n};\n\n/**\n * A utility for calling option functions that may not exist\n */\nvar callMethod = function callMethod(_ref4, args) {\n  var fn = _ref4.fn,\n      defaultReturn = _ref4.defaultReturn;\n  return isFunction(fn) ? fn.apply(void 0, _toConsumableArray(args)) : defaultReturn;\n};\n/**\n * Taken from https://stackoverflow.com/a/4900484\n *\n * Check that the browser is chrome. Supports passing a minimum version to check that it is a greater than or equal version.\n */\n\n\nvar isChrome = function isChrome() {\n  var minVersion = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  var parsedAgent = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n  return parsedAgent ? parseInt(parsedAgent[2], 10) >= minVersion : false;\n};\n/**\n * Replaces text with an optional appended string at the end\n *\n * @param params - the destructured params\n *\n * @public\n */\n\n\nvar replaceText = function replaceText(_ref5) {\n  var range = _ref5.range,\n      type = _ref5.type,\n      _ref5$attrs = _ref5.attrs,\n      attrs = _ref5$attrs === void 0 ? Object.create(null) : _ref5$attrs,\n      _ref5$appendText = _ref5.appendText,\n      appendText = _ref5$appendText === void 0 ? '' : _ref5$appendText,\n      _ref5$content = _ref5.content,\n      content = _ref5$content === void 0 ? '' : _ref5$content,\n      startTransaction = _ref5.startTransaction,\n      endTransaction = _ref5.endTransaction;\n  return function (state, dispatch) {\n    var schema = state.schema,\n        selection = state.selection; // const { $from, $to } = selection;\n\n    var index = selection.$from.index();\n\n    var _ref6 = range !== null && range !== void 0 ? range : selection,\n        from = _ref6.from,\n        to = _ref6.to; // Run the pre transaction hook\n\n\n    var tr = callMethod({\n      fn: startTransaction,\n      defaultReturn: state.tr\n    }, [state.tr, state]);\n\n    if (isNodeType(type)) {\n      if (!selection.$from.parent.canReplaceWith(index, index, type)) {\n        return false;\n      }\n\n      tr.replaceWith(from, to, type.create(attrs, content ? schema.text(content) : undefined));\n    } else {\n      if (!content) {\n        throw new Error('`replaceText` cannot be called without content when using a mark type');\n      }\n\n      tr.replaceWith(from, to, schema.text(content, isMarkType(type) ? [type.create(attrs)] : undefined));\n    }\n    /** Only append the text if when text is provided. */\n\n\n    if (appendText) {\n      tr.insertText(appendText);\n    }\n\n    if (dispatch) {\n      if (isChrome(60)) {\n        var _document$getSelectio;\n\n        // A workaround for a chrome bug\n        // https://github.com/ProseMirror/prosemirror/issues/710#issuecomment-338047650\n        (_document$getSelectio = document.getSelection()) === null || _document$getSelectio === void 0 ? void 0 : _document$getSelectio.empty();\n      }\n\n      dispatch(callMethod({\n        fn: endTransaction,\n        defaultReturn: tr\n      }, [tr, state]));\n    }\n\n    return true;\n  };\n};\n\n/**\n * Removes a mark from the current selection or provided from to\n *\n * @param params - the destructured params\n *\n * @public\n */\nvar removeMark = function removeMark(_ref7) {\n  var type = _ref7.type,\n      _ref7$expand = _ref7.expand,\n      expand = _ref7$expand === void 0 ? false : _ref7$expand,\n      range = _ref7.range,\n      endTransaction = _ref7.endTransaction,\n      startTransaction = _ref7.startTransaction;\n  return function (state, dispatch) {\n    var selection = state.selection;\n    var tr = callMethod({\n      fn: startTransaction,\n      defaultReturn: state.tr\n    }, [state.tr, state]);\n\n    var _ref8 = range !== null && range !== void 0 ? range : selection,\n        from = _ref8.from,\n        to = _ref8.to;\n\n    if (expand) {\n      var _ref9 = range ? getMarkRange(state.doc.resolve(range.from), type) || isNumber(range.to) && getMarkRange(state.doc.resolve(range.to), type) || {\n        from: from,\n        to: to\n      } : selectionEmpty(state) ? getMarkRange(state.selection.$anchor, type) || {\n        from: from,\n        to: to\n      } : {\n        from: from,\n        to: to\n      };\n\n      from = _ref9.from;\n      to = _ref9.to;\n    }\n\n    tr.removeMark(from, isNumber(to) ? to : from, type);\n\n    if (dispatch) {\n      dispatch(callMethod({\n        fn: endTransaction,\n        defaultReturn: tr\n      }, [tr, state]));\n    }\n\n    return true;\n  };\n};\n/**\n * An empty (noop) command function.\n *\n * @remarks\n *\n * This is typically to represent the default _do nothing_ action.\n */\n\nvar emptyCommandFunction = function emptyCommandFunction() {\n  return false;\n};\n\n/**\n * Keycode for ALT key.\n */\n\nvar ALT = ['Alt', '⌥'];\n/**\n * Keycode for CTRL key.\n */\n\nvar CTRL = ['Control', '⌃'];\n/**\n * Keycode for COMMAND/META key.\n */\n\nvar COMMAND = ['Meta', '⌘'];\n/**\n * Keycode for SHIFT key.\n */\n\nvar SHIFT = ['Shift', '⇧'];\n/**\n * Keycode for the windows key\n */\n\nvar WINDOWS = ['Windows', '', '❖'];\n/**\n * Keycode and symbols for caps lock\n */\n\nvar CAPS_LOCK = ['CapsLock', '⇪', '⇪'];\n/**\n * Shorthand names for common modifier key combinations which should `just` work on Apple and PC.\n */\n\nvar Modifier = {\n  Primary: function Primary(isMac) {\n    return isMac ? [COMMAND[0]] : [CTRL[0]];\n  },\n  PrimaryShift: function PrimaryShift(isMac) {\n    return isMac ? [SHIFT[0], COMMAND[0]] : [CTRL[0], SHIFT[0]];\n  },\n  PrimaryAlt: function PrimaryAlt(isMac) {\n    return isMac ? [ALT[0], COMMAND[0]] : [CTRL[0], ALT[0]];\n  },\n  Secondary: function Secondary(isMac) {\n    return isMac ? [SHIFT[0], ALT[0], COMMAND[0]] : [CTRL[0], SHIFT[0], ALT[0]];\n  },\n  Access: function Access(isMac) {\n    return isMac ? [CTRL[0], ALT[0]] : [SHIFT[0], ALT[0]];\n  },\n  Ctrl: function Ctrl() {\n    return [CTRL[0]];\n  },\n  Alt: function Alt() {\n    return [ALT[0]];\n  },\n  CtrlShift: function CtrlShift() {\n    return [CTRL[0], SHIFT[0]];\n  },\n  Shift: function Shift() {\n    return [SHIFT[0]];\n  },\n  ShiftAlt: function ShiftAlt() {\n    return [SHIFT[0], ALT[0]];\n  }\n};\n/**\n * The cross platform modifier key combination names.\n */\n\n/**\n * Returns true if this is an apple environment either on the server or the client.\n */\nvar isApple = function isApple() {\n  return environment.isApple;\n};\n/**\n * Create a consistent cross platform modifier string pattern.\n *\n * This can be used with the pressKeyWithModifier.\n *\n * ```ts\n * mod('Primary', 'A')\n * // => 'Control-A' // on PC\n * // => 'Cmd-A' // on Mac\n * ```\n *\n * @param modifier - A named modifier which is consistent across platforms\n *                  e.g. 'Primary' refers to 'Meta' on a mac and 'Control' on a PC\n * @param key - the key to press with the modifier. e.g. `Space` | `Enter`\n * @param [isApple] - a method which returns true when this is an apple device.\n */\n\nvar mod = function mod(modifier, key) {\n  var isMacFn = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : isApple;\n\n  switch (modifier) {\n    case 'Primary':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'PrimaryShift':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'PrimaryAlt':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'Secondary':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'Access':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'Ctrl':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    case 'Alt':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    case 'CtrlShift':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    case 'Shift':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    case 'ShiftAlt':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    default:\n      throw new Error('Invalid modifier name passed in');\n  }\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/**\n * Flattens descendants of a given `node`.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const children = flatten(node);\n * ```\n */\nvar flatten = function flatten(_ref) {\n  var node = _ref.node,\n      _ref$descend = _ref.descend,\n      descend = _ref$descend === void 0 ? true : _ref$descend;\n\n  if (!isProsemirrorNode(node)) {\n    throw new Error('Invalid \"node\" parameter');\n  }\n\n  var result = [];\n  node.descendants(function (child, pos) {\n    result.push({\n      node: child,\n      pos: pos\n    });\n\n    if (!descend) {\n      return false;\n    }\n\n    return;\n  });\n  return result;\n};\n\n/**\n * Iterates over descendants of a given `node`, returning child nodes predicate returns truthy for.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const textNodes = findChildren(node, child => child.isText, false);\n * ```\n */\nvar findChildren = function findChildren(_ref2) {\n  var node = _ref2.node,\n      predicate = _ref2.predicate,\n      descend = _ref2.descend;\n\n  if (!node) {\n    throw new Error('Invalid \"node\" parameter');\n  } else if (!isFunction(predicate)) {\n    throw new Error('Invalid \"predicate\" parameter');\n  }\n\n  return flatten({\n    node: node,\n    descend: descend\n  }).filter(function (child) {\n    return predicate(child.node);\n  });\n};\n\nvar findNodeByPredicate = function findNodeByPredicate(_ref3) {\n  var predicate = _ref3.predicate;\n  return function (params) {\n    return findChildren(_objectSpread$1({}, params, {\n      predicate: predicate\n    }));\n  };\n};\n/**\n * Returns text nodes of a given `node`.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const textNodes = findTextNodes(node);\n * ```\n */\n\n\nvar findTextNodes = findNodeByPredicate({\n  predicate: function predicate(child) {\n    return child.isText;\n  }\n});\n/**\n * Returns inline nodes of a given `node`.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const inlineNodes = findInlineNodes(node);\n * ```\n */\n\nvar findInlineNodes = findNodeByPredicate({\n  predicate: function predicate(child) {\n    return child.isInline;\n  }\n});\n/**\n * Returns block descendants of a given `node`.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const blockNodes = findBlockNodes(node);\n * ```\n */\n\nvar findBlockNodes = findNodeByPredicate({\n  predicate: function predicate(child) {\n    return child.isBlock;\n  }\n});\n\n/**\n * Iterates over descendants of a given `node`, returning child nodes predicate returns truthy for.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const mergedCells = findChildrenByAttr(table, attrs => attrs.colspan === 2);\n * ```\n */\nvar findChildrenByAttr = function findChildrenByAttr(_ref4) {\n  var node = _ref4.node,\n      predicate = _ref4.predicate,\n      descend = _ref4.descend;\n  return findChildren({\n    node: node,\n    predicate: function (_predicate) {\n      function predicate(_x) {\n        return _predicate.apply(this, arguments);\n      }\n\n      predicate.toString = function () {\n        return _predicate.toString();\n      };\n\n      return predicate;\n    }(function (child) {\n      return predicate(child.attrs);\n    }),\n    descend: descend\n  });\n};\n\n/**\n * Iterates over descendants of a given `node`, returning child nodes of a given nodeType.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const cells = findChildrenByNode(table, schema.nodes.tableCell);\n * ```\n */\nvar findChildrenByNode = function findChildrenByNode(_ref5) {\n  var node = _ref5.node,\n      type = _ref5.type,\n      descend = _ref5.descend;\n  return findChildren({\n    node: node,\n    predicate: function predicate(child) {\n      return child.type === type;\n    },\n    descend: descend\n  });\n};\n\n/**\n * Iterates over descendants of a given `node`, returning child nodes that have a mark of a given markType.\n *\n * @remarks\n * It doesn't descend into a `node` when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const nodes = findChildrenByMark(state.doc, schema.marks.strong);\n * ```\n */\nvar findChildrenByMark = function findChildrenByMark(_ref6) {\n  var node = _ref6.node,\n      type = _ref6.type,\n      descend = _ref6.descend;\n  return findChildren({\n    node: node,\n    predicate: function predicate(child) {\n      return bool(type.isInSet(child.marks));\n    },\n    descend: descend\n  });\n};\n\n/**\n * Returns `true` if a given node contains nodes of a given `nodeType`\n *\n * @remarks\n * ```ts\n * if (contains(panel, schema.nodes.listItem)) {\n *\n * }\n * ```\n */\nvar contains = function contains(_ref7) {\n  var node = _ref7.node,\n      type = _ref7.type;\n  return findChildrenByNode({\n    node: node,\n    type: type\n  }).length > 0;\n};\n\n/**\n * Creates an input rule based on the provided regex for the provided mark type\n */\n\nvar markInputRule = function markInputRule(_ref) {\n  var regexp = _ref.regexp,\n      type = _ref.type,\n      getAttrs = _ref.getAttrs;\n  return new InputRule(regexp, function (state, match, start, end) {\n    var tr = state.tr;\n    var attrs = isFunction(getAttrs) ? getAttrs(match) : getAttrs;\n    var markEnd = end;\n\n    if (match[1]) {\n      var startSpaces = match[0].search(/\\S/);\n      var textStart = start + match[0].indexOf(match[1]);\n      var textEnd = textStart + match[1].length;\n\n      if (textEnd < end) {\n        tr[\"delete\"](textEnd, end);\n      }\n\n      if (textStart > start) {\n        tr[\"delete\"](start + startSpaces, textStart);\n      }\n\n      markEnd = start + startSpaces + match[1].length;\n    }\n\n    return tr.addMark(start, markEnd, type.create(attrs)) // Make sure not to continue with any ongoing marks\n    .removeStoredMark(type);\n  });\n};\n/**\n * Creates a paste rule based on the provided regex for the provided mark type\n */\n\nvar markPasteRule = function markPasteRule(_ref2) {\n  var regexp = _ref2.regexp,\n      type = _ref2.type,\n      getAttrs = _ref2.getAttrs;\n\n  var handler = function handler(fragment) {\n    var nodes = [];\n    fragment.forEach(function (child) {\n      if (child.isText) {\n        var _child$text;\n\n        var text = (_child$text = child.text) !== null && _child$text !== void 0 ? _child$text : '';\n        var pos = 0; // ? For some reason including the index param makes this work. I'm not sure why...?\n\n        findMatches(text, regexp).forEach(function (match, _) {\n          if (!match[1]) {\n            return;\n          }\n\n          var start = match.index;\n          var end = start + match[0].length;\n          var attrs = isFunction(getAttrs) ? getAttrs(match) : getAttrs;\n\n          if (start > 0) {\n            nodes.push(child.cut(pos, start));\n          }\n\n          nodes.push(child.cut(start, end).mark(type.create(attrs).addToSet(child.marks)));\n          pos = end;\n        });\n\n        if (text && pos < text.length) {\n          nodes.push(child.cut(pos));\n        }\n      } else {\n        nodes.push(child.copy(handler(child.content)));\n      }\n    });\n    return Fragment.fromArray(nodes);\n  };\n\n  return new Plugin({\n    props: {\n      transformPasted: function transformPasted(slice) {\n        return new Slice(handler(slice.content), slice.openStart, slice.openEnd);\n      }\n    }\n  });\n};\n/**\n * Creates an node input rule based on the provided regex for the provided node type\n */\n\nvar nodeInputRule = function nodeInputRule(_ref3) {\n  var regexp = _ref3.regexp,\n      type = _ref3.type,\n      getAttrs = _ref3.getAttrs,\n      _ref3$updateSelection = _ref3.updateSelection,\n      updateSelection = _ref3$updateSelection === void 0 ? false : _ref3$updateSelection;\n  return new InputRule(regexp, function (state, match, start, end) {\n    var attrs = isFunction(getAttrs) ? getAttrs(match) : getAttrs;\n    var tr = state.tr;\n    tr.replaceWith(start - 1, end, type.create(attrs));\n\n    if (updateSelection) {\n      var $pos = tr.doc.resolve(start);\n      tr.setSelection(new TextSelection($pos));\n    }\n\n    return tr;\n  });\n};\n/**\n * Creates an node input rule based on the provided regex for the provided node type\n */\n\nvar plainInputRule = function plainInputRule(_ref4) {\n  var regexp = _ref4.regexp,\n      transformMatch = _ref4.transformMatch,\n      _ref4$updateSelection = _ref4.updateSelection,\n      updateSelection = _ref4$updateSelection === void 0 ? false : _ref4$updateSelection;\n  return new InputRule(regexp, function (state, match, start, end) {\n    var value = transformMatch(match);\n\n    if (isNullOrUndefined(value)) {\n      return null;\n    }\n\n    var tr = state.tr;\n\n    if (value === '') {\n      tr[\"delete\"](start, end);\n    } else {\n      tr.replaceWith(start, end, state.schema.text(value));\n    }\n\n    if (updateSelection) {\n      var $pos = tr.doc.resolve(start);\n      tr.setSelection(new TextSelection($pos));\n    }\n\n    return tr;\n  });\n};\n\nexport { ALT, CAPS_LOCK, COMMAND, CTRL, Modifier, SHIFT, WINDOWS, absoluteCoordinates, atDocEnd, atDocStart, canInsertNode, chainCommands, chainKeyBindingCommands, cloneTransaction, closestElement, contains, convertCommand, createDocumentNode, emptyCommandFunction, endPositionOfParent, environment, findBlockNodes, findChildren, findChildrenByAttr, findChildrenByMark, findChildrenByNode, findElementAtPosition, findInlineNodes, findNodeAtEndOfDoc, findNodeAtPosition, findNodeAtSelection, findNodeAtStartOfDoc, findParentNode, findParentNodeOfType, findPositionOfNodeAfter, findPositionOfNodeBefore, findSelectedNodeOfType, findTextNodes, flatten, fromHTML, getCursor, getDocument, getLineHeight, getMarkAttrs, getMarkRange, getMatchString, getNearestNonTextNode, getOffsetParent, getPluginMeta, getPluginState, getSelectedGroup, getSelectedWord, getTextContentFromSlice, isApple, isDOMNode, isDocNode, isDocNodeEmpty, isEditorSchema, isEditorState, isElementDOMNode, isEmptyParagraphNode, isMarkActive, isMarkType, isNodeActive, isNodeSelection, isNodeType, isObjectNode, isProsemirrorNode, isResolvedPos, isSelection, isTextDOMNode, isTextSelection, markInputRule, markPasteRule, mod, nodeEqualsType, nodeInputRule, nodeNameMatchesList, plainInputRule, removeMark, removeNodeAfter, removeNodeAtPosition, removeNodeBefore, replaceText, schemaToJSON, selectionEmpty, setPluginMeta, shouldUseDOMEnvironment, startPositionOfParent, toDOM, toHTML, toggleBlockItem, toggleList, toggleWrap, transactionChanged, updateMark };\n//# sourceMappingURL=core-utils.esm.js.map\n","/**\n * The editor class name\n */\nvar EDITOR_CLASS_NAME = 'remirror-editor';\n/**\n * The editor class selector\n */\n\nvar EDITOR_CLASS_SELECTOR = \".\".concat(EDITOR_CLASS_NAME);\n/**\n * The css class added to a node that is selected.\n */\n\nvar SELECTED_NODE_CLASS_NAME = 'ProseMirror-selectednode';\n/**\n * The css selector for a selected node.\n */\n\nvar SELECTED_NODE_CLASS_SELECTOR = \".\".concat(SELECTED_NODE_CLASS_NAME);\n/**\n * Explanation from `@atlaskit` ProseMirror uses the Unicode Character 'OBJECT\n * REPLACEMENT CHARACTER' (U+FFFC) as text representation for leaf nodes, i.e.\n * nodes that don't have any content or text property (e.g. hardBreak, emoji,\n * mention, rule) It was introduced because of\n * https://github.com/ProseMirror/prosemirror/issues/262 This can be used in an\n * input rule regex to be able to include or exclude such nodes.\n */\n\nvar LEAF_NODE_REPLACING_CHARACTER = \"\\uFFFC\";\n/**\n * The null character.\n *\n * See {@link https://stackoverflow.com/a/6380172}\n */\n\nvar NULL_CHARACTER = '\\0';\n/**\n * A character useful for separating inline nodes.\n *\n * @remarks\n * Typically used in decorations as follows.\n *\n * ```ts\n * document.createTextNode(ZERO_WIDTH_SPACE_CHAR)\n * ```\n *\n * This produces the html entity '8203'\n */\n\nvar ZERO_WIDTH_SPACE_CHAR = \"\\u200B\";\n/**\n * Used to determine the side where a gap-cursor is drawn\n */\n\nvar Side;\n/**\n * A default empty object node. Useful for resetting the content of a\n * prosemirror document.\n */\n\n(function (Side) {\n  Side[\"LEFT\"] = \"left\";\n  Side[\"RIGHT\"] = \"right\";\n})(Side || (Side = {}));\n\nvar EMPTY_PARAGRAPH_NODE = {\n  type: 'doc',\n  content: [{\n    type: 'paragraph'\n  }]\n};\n/**\n * The default extension priority level\n */\n\nvar DEFAULT_EXTENSION_PRIORITY = 3;\n/**\n * Marks are categorized into different groups. One motivation for this was to\n * allow the `code` mark to exclude other marks, without needing to explicitly\n * name them. Explicit naming requires the named mark to exist in the schema.\n * This is undesirable because we want to construct different schemas that have\n * different sets of nodes/marks.\n */\n\nvar MarkGroup;\n\n(function (MarkGroup) {\n  MarkGroup[\"FontStyle\"] = \"fontStyle\";\n  MarkGroup[\"Link\"] = \"link\";\n  MarkGroup[\"Color\"] = \"color\";\n  MarkGroup[\"Alignment\"] = \"alignment\";\n  MarkGroup[\"Indentation\"] = \"indentation\";\n  MarkGroup[\"Behavior\"] = \"behavior\";\n  MarkGroup[\"Code\"] = \"code\";\n})(MarkGroup || (MarkGroup = {}));\n\nvar NodeGroup;\n/**\n * Defines the type of the extension.\n */\n\n(function (NodeGroup) {\n  NodeGroup[\"Inline\"] = \"inline\";\n  NodeGroup[\"Block\"] = \"block\";\n})(NodeGroup || (NodeGroup = {}));\n\nvar ExtensionType;\n/**\n * These are the default supported tag strings which help categorize different\n * behaviors that extensions can exhibit.\n *\n * @remarks\n *\n * Any extension can register itself with multiple such behaviors and these\n * categorizations can be used by other extensions when running commands and\n * updating the document.\n */\n\n(function (ExtensionType) {\n  ExtensionType[\"Node\"] = \"node\";\n  ExtensionType[\"Mark\"] = \"mark\";\n  ExtensionType[\"Plain\"] = \"plain\";\n})(ExtensionType || (ExtensionType = {}));\n\nvar Tags;\n/**\n * The toString return value for any created remirror class.\n */\n\n(function (Tags) {\n  Tags[\"LastNodeCompatible\"] = \"lastNodeCompatible\";\n  Tags[\"FormattingMark\"] = \"formattingMark\";\n  Tags[\"FormattingNode\"] = \"formattingNode\";\n  Tags[\"NodeCursor\"] = \"nodeCursor\";\n})(Tags || (Tags = {}));\n\nvar RemirrorClassName;\n\n(function (RemirrorClassName) {\n  RemirrorClassName[\"Extension\"] = \"$$RemirrorExtension\";\n})(RemirrorClassName || (RemirrorClassName = {}));\n\nexport { DEFAULT_EXTENSION_PRIORITY, EDITOR_CLASS_NAME, EDITOR_CLASS_SELECTOR, EMPTY_PARAGRAPH_NODE, ExtensionType, LEAF_NODE_REPLACING_CHARACTER, MarkGroup, NULL_CHARACTER, NodeGroup, RemirrorClassName, SELECTED_NODE_CLASS_NAME, SELECTED_NODE_CLASS_SELECTOR, Side, Tags, ZERO_WIDTH_SPACE_CHAR };\n//# sourceMappingURL=core-constants.esm.js.map\n","import { selectionEmpty, transactionChanged, getPluginState } from '@remirror/core-utils';\nimport { PluginKey, Plugin } from 'prosemirror-state';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { noop, bool, isString, isRegExp, findMatches, isUndefined } from '@remirror/core-helpers';\nimport { DecorationSet, Decoration } from 'prosemirror-view';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport { NULL_CHARACTER } from '@remirror/core-constants';\nimport { keydownHandler } from 'prosemirror-keymap';\nimport escapeStringRegex from 'escape-string-regexp';\n\nvar DEFAULT_SUGGEST_ACTIONS = {\n  command: noop,\n  create: noop,\n  remove: noop,\n  update: noop\n};\n\nvar defaultHandler = function defaultHandler() {\n  return false;\n};\n\nvar DEFAULT_SUGGESTER = {\n  appendText: '',\n  createCommand: function createCommand() {\n    return noop;\n  },\n  ignoredClassName: undefined,\n  ignoredTag: 'span',\n  invalidPrefixCharacters: undefined,\n  keyBindings: {},\n  matchOffset: 0,\n  noDecorations: false,\n  onChange: defaultHandler,\n  onCharacterEntry: defaultHandler,\n  onExit: defaultHandler,\n  startOfLine: false,\n  suggestClassName: 'suggest',\n  suggestTag: 'span',\n  supportedCharacters: /[\\w\\d_]+/,\n  validPrefixCharacters: /^[\\s\\0]?$/\n};\n/**\n * The potential reasons for an exit of a mention.\n */\n\nvar ExitReason;\n/**\n * The potential reason for changes\n */\n\n(function (ExitReason) {\n  ExitReason[\"End\"] = \"exit-end\";\n  ExitReason[\"Removed\"] = \"delete\";\n  ExitReason[\"Split\"] = \"exit-split\";\n  ExitReason[\"InvalidSplit\"] = \"invalid-exit-split\";\n  ExitReason[\"MoveEnd\"] = \"move-end\";\n  ExitReason[\"MoveStart\"] = \"move-start\";\n  ExitReason[\"JumpForward\"] = \"jump-forward-exit\";\n  ExitReason[\"JumpBackward\"] = \"jump-backward-exit\";\n  ExitReason[\"SelectionOutside\"] = \"selection-outside\";\n})(ExitReason || (ExitReason = {}));\n\nvar ChangeReason;\n\n(function (ChangeReason) {\n  ChangeReason[\"Start\"] = \"start\";\n  ChangeReason[\"Text\"] = \"change-character\";\n  ChangeReason[\"SelectionInside\"] = \"selection-inside\";\n  ChangeReason[\"Move\"] = \"move\";\n  ChangeReason[\"JumpBackward\"] = \"jump-backward-change\";\n  ChangeReason[\"JumpForward\"] = \"jump-forward-change\";\n})(ChangeReason || (ChangeReason = {}));\n\n/**\n * Is this a change in the current suggestion (added or deleted characters)?\n */\nvar isChange = function isChange(compare) {\n  return bool(compare.prev && compare.next && compare.prev.queryText.full !== compare.next.queryText.full);\n};\n/**\n * Has the cursor moved within the current suggestion (added or deleted\n * characters)?\n */\n\nvar isMove = function isMove(compare) {\n  return bool(compare.prev && compare.next && compare.prev.range.to !== compare.next.range.to);\n};\n/**\n * Are we entering a new suggestion?\n */\n\nvar isEntry = function isEntry(compare) {\n  return bool(!compare.prev && compare.next);\n};\n/**\n * Are we exiting a suggestion?\n */\n\nvar isExit = function isExit(compare) {\n  return bool(compare.prev && !compare.next);\n};\n/**\n * Is this a jump from one suggestion to another?\n */\n\nvar isJump = function isJump(compare) {\n  return bool(compare.prev && compare.next && compare.prev.range.from !== compare.next.range.from);\n};\n/**\n * Check that the passed in value is an ExitReason\n */\n\nvar isExitReason = function isExitReason(value) {\n  return isString(value) && Object.values(ExitReason).includes(value);\n};\nvar isChangeReason = function isChangeReason(value) {\n  return isString(value) && Object.values(ChangeReason).includes(value);\n};\n/**\n * Checks that the reason passed is a split reason. This typically means that we\n * should default to a partial update / creation of the mention.\n */\n\nvar isSplitReason = function isSplitReason(value) {\n  return value === ExitReason.Split;\n};\n/**\n * Checks that the reason was caused by a split at a point where there is no\n * query.\n */\n\nvar isInvalidSplitReason = function isInvalidSplitReason(value) {\n  return value === ExitReason.InvalidSplit;\n};\n/**\n * Checks that the reason was caused by a deletion.\n */\n\nvar isRemovedReason = function isRemovedReason(value) {\n  return value === ExitReason.Removed;\n};\n/**\n * Checks to see if this is a jump reason.\n */\n\nvar isJumpReason = function isJumpReason(map) {\n  return map.exit ? [ExitReason.JumpBackward, ExitReason.JumpForward].includes(map.exit.reason) : map.change ? [ChangeReason.JumpBackward, ChangeReason.JumpForward].includes(map.change.reason) : false;\n};\n/**\n * True when the match is currently active (i.e. it's query has a value)\n */\n\nvar isValidMatch = function isValidMatch(match) {\n  return bool(match && match.queryText.full.length >= match.suggester.matchOffset);\n};\n/**\n * True when the current selection is outside the match.\n */\n\nvar selectionOutsideMatch = function selectionOutsideMatch(_ref) {\n  var match = _ref.match,\n      selection = _ref.selection;\n  return match && (selection.from < match.range.from || selection.from > match.range.end);\n};\n\nvar escapeChar = function escapeChar(_char) {\n  return escapeStringRegex(_char);\n};\n/**\n * Convert a RegExp into a string\n *\n * @param regexOrString\n */\n\nvar regexToString = function regexToString(regexOrString) {\n  return isRegExp(regexOrString) ? regexOrString.source : regexOrString;\n};\n/**\n * Find regex prefix when depending on whether the mention only supports the\n * start of a line or not\n *\n * @param onlyStartOfLine\n */\n\nvar getRegexPrefix = function getRegexPrefix(onlyStartOfLine) {\n  return onlyStartOfLine ? '^' : '';\n};\n/**\n * Get the supported characters regex string.\n */\n\nvar getRegexSupportedCharacters = function getRegexSupportedCharacters(supportedCharacters, matchOffset) {\n  return \"(?:\".concat(regexToString(supportedCharacters), \"){\").concat(matchOffset, \",}\");\n};\n/**\n * Create a regex expression to evaluate matches directly from the suggester properties.\n */\n\n\nvar createRegexFromSuggester = function createRegexFromSuggester(_ref) {\n  var _char2 = _ref[\"char\"],\n      matchOffset = _ref.matchOffset,\n      startOfLine = _ref.startOfLine,\n      supportedCharacters = _ref.supportedCharacters;\n  var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'gm';\n  return new RegExp(\"\".concat(getRegexPrefix(startOfLine)).concat(escapeChar(_char2)).concat(getRegexSupportedCharacters(supportedCharacters, matchOffset)), flags);\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/**\n * Small utility method for creating a match with the reason property available.\n */\nvar createMatchWithReason = function createMatchWithReason(_ref) {\n  var match = _ref.match,\n      reason = _ref.reason;\n  return _objectSpread({}, match, {\n    reason: reason\n  });\n};\n/**\n * Checks to see if the text before the matching character is a valid prefix.\n *\n * @param prefix - the prefix to test\n * @param params - an object with the regex testing values\n */\n\n\nvar isPrefixValid = function isPrefixValid(prefix, _ref2) {\n  var invalidPrefixCharacters = _ref2.invalidPrefixCharacters,\n      validPrefixCharacters = _ref2.validPrefixCharacters;\n\n  if (!isUndefined(invalidPrefixCharacters)) {\n    var regex = new RegExp(regexToString(invalidPrefixCharacters));\n    return !regex.test(prefix);\n  }\n\n  {\n    var _regex = new RegExp(regexToString(validPrefixCharacters));\n\n    return _regex.test(prefix);\n  }\n};\n/**\n * Find the position of a mention for a given selection and character\n *\n * @param params\n */\n\n\nvar findPosition = function findPosition(_ref3) {\n  var text = _ref3.text,\n      regexp = _ref3.regexp,\n      $pos = _ref3.$pos,\n      _char = _ref3[\"char\"],\n      suggester = _ref3.suggester;\n  var position;\n  var cursor = $pos.pos; // The current cursor position\n\n  var start = $pos.start(); // The starting position for matches\n\n  findMatches(text, regexp).forEach(function (match) {\n    // Check the character before the current match to ensure it is not one of\n    // the supported characters\n    var matchPrefix = match.input.slice(Math.max(0, match.index - 1), match.index);\n\n    if (isPrefixValid(matchPrefix, suggester)) {\n      var from = match.index + start; // The absolute position of the match wrapper node\n\n      var end = from + match[0].length; // The position where the match ends\n\n      var to = Math.min(end, cursor); // The cursor position (or end position whichever is greater)\n\n      var matchLength = to - from; // The length of the current match\n      // If the $position is located within the matched substring, return that\n      // range\n\n      if (from < cursor && end >= cursor) {\n        position = {\n          range: {\n            from: from,\n            end: end,\n            to: to\n          },\n          queryText: {\n            partial: match[0].slice(_char.length, matchLength),\n            full: match[0].slice(_char.length)\n          },\n          matchText: {\n            partial: match[0].slice(0, matchLength),\n            full: match[0]\n          },\n          suggester: suggester\n        };\n      }\n    }\n  });\n  return position;\n};\n/**\n * Checks if any matches exist at the current selection for so that the\n * suggestions be activated or deactivated.\n */\n\n\nvar findMatch = function findMatch(_ref4) {\n  var $pos = _ref4.$pos,\n      suggester = _ref4.suggester;\n  var _char2 = suggester[\"char\"],\n      name = suggester.name,\n      startOfLine = suggester.startOfLine,\n      supportedCharacters = suggester.supportedCharacters,\n      matchOffset = suggester.matchOffset; // Create the regular expression to match the text against\n\n  var regexp = createRegexFromSuggester({\n    \"char\": _char2,\n    matchOffset: matchOffset,\n    startOfLine: startOfLine,\n    supportedCharacters: supportedCharacters\n  }); // All the text in the current node\n\n  var text = $pos.doc.textBetween($pos.before(), $pos.end(), NULL_CHARACTER, NULL_CHARACTER); // Find the position and return it\n\n  return findPosition({\n    suggester: suggester,\n    text: text,\n    regexp: regexp,\n    $pos: $pos,\n    \"char\": _char2,\n    name: name\n  });\n};\n/**\n * Checks the provided match and generates a new match. This is useful for\n * determining the kind of change that has happened.\n *\n * If the match still exists and it is different then it's likely a split has\n * occurred.\n */\n\n\nvar recheckMatch = function recheckMatch(_ref5) {\n  var state = _ref5.state,\n      match = _ref5.match;\n\n  try {\n    // Wrapped in try catch because it's possible for everything to be deleted\n    // and the doc.resolve will fail.\n    return findMatch({\n      $pos: state.doc.resolve(match.range.to),\n      suggester: match.suggester\n    });\n  } catch (_unused) {\n    return undefined;\n  }\n};\n/**\n * Check whether the insert action occurred at the end, in the middle or caused\n * the suggestion to be invalid.\n *\n * Prev refers to the original previous and next refers to the updated version\n * after the split\n */\n\n\nvar createInsertReason = function createInsertReason(_ref6) {\n  var prev = _ref6.prev,\n      next = _ref6.next,\n      state = _ref6.state;\n\n  // Has the text been removed? TODO how to tests for deletions mid document?\n  if (!next && prev.range.from >= state.doc.nodeSize) {\n    return {\n      exit: createMatchWithReason({\n        match: prev,\n        reason: ExitReason.Removed\n      })\n    };\n  } // Are we within an invalid split?\n\n\n  if (!next || !prev.queryText.partial) {\n    return {\n      exit: createMatchWithReason({\n        match: prev,\n        reason: ExitReason.InvalidSplit\n      })\n    };\n  } // Are we at the end position?\n\n\n  if (prev.range.end === next.range.to) {\n    return {\n      exit: createMatchWithReason({\n        match: next,\n        reason: ExitReason.End\n      })\n    };\n  } // Are we in the middle of the mention\n\n\n  if (prev.queryText.partial) {\n    return {\n      exit: createMatchWithReason({\n        match: next,\n        reason: ExitReason.Split\n      })\n    };\n  }\n\n  return {};\n};\n/**\n * Find the reason for the Jump\n */\n\n\nvar findJumpReason = function findJumpReason(_ref7) {\n  var prev = _ref7.prev,\n      next = _ref7.next,\n      state = _ref7.state;\n  var value = Object.create(null);\n  var updatedPrev = recheckMatch({\n    state: state,\n    match: prev\n  });\n\n  var _ref8 = updatedPrev && updatedPrev.queryText.full !== prev.queryText.full // has query changed\n  ? createInsertReason({\n    prev: prev,\n    next: updatedPrev,\n    state: state\n  }) : value,\n      exit = _ref8.exit;\n\n  var isJumpForward = prev.range.from < next.range.from;\n\n  if (isJumpForward) {\n    return {\n      exit: exit !== null && exit !== void 0 ? exit : createMatchWithReason({\n        match: prev,\n        reason: ExitReason.JumpForward\n      }),\n      change: createMatchWithReason({\n        match: next,\n        reason: ChangeReason.JumpForward\n      })\n    };\n  }\n\n  return {\n    exit: exit !== null && exit !== void 0 ? exit : createMatchWithReason({\n      match: prev,\n      reason: ExitReason.JumpBackward\n    }),\n    change: createMatchWithReason({\n      match: next,\n      reason: ChangeReason.JumpBackward\n    })\n  };\n};\n/**\n * Find the reason for the exit.\n *\n * This provides some context and helps sets up a helper command with sane\n * defaults.\n */\n\n\nvar findExitReason = function findExitReason(_ref9) {\n  var match = _ref9.match,\n      state = _ref9.state,\n      $pos = _ref9.$pos;\n  var selection = state.selection;\n  var updatedPrev = recheckMatch({\n    match: match,\n    state: state\n  }); // Exit created a split\n\n  if (!updatedPrev || updatedPrev.queryText.full !== match.queryText.full) {\n    return createInsertReason({\n      prev: match,\n      next: updatedPrev,\n      state: state\n    });\n  } // Exit caused by a selection\n\n\n  if (!selectionEmpty(state) && (selection.from <= match.range.from || selection.to >= match.range.end)) {\n    return {\n      exit: createMatchWithReason({\n        match: match,\n        reason: ExitReason.SelectionOutside\n      })\n    };\n  } // Exit happened at the end of previous suggestion\n\n\n  if ($pos.pos > match.range.end) {\n    return {\n      exit: createMatchWithReason({\n        match: match,\n        reason: ExitReason.MoveEnd\n      })\n    };\n  } // Exit happened at the start of previous suggestion\n\n\n  if ($pos.pos <= match.range.from) {\n    return {\n      exit: createMatchWithReason({\n        match: match,\n        reason: ExitReason.MoveStart\n      })\n    };\n  }\n\n  return {};\n};\n\n/**\n * Transforms the keybindings into an object that can be consumed by the\n * prosemirror keydownHandler method.\n */\nvar transformKeyBindings = function transformKeyBindings(_ref10) {\n  var bindings = _ref10.bindings,\n      params = _ref10.params;\n  var keys = Object.create(null);\n  return Object.entries(bindings).reduce(function (prev, _ref11) {\n    var _ref12 = _slicedToArray(_ref11, 2),\n        key = _ref12[0],\n        method = _ref12[1];\n\n    return _objectSpread({}, prev, _defineProperty({}, key, function () {\n      return bool(method(params));\n    }));\n  }, keys);\n};\n/**\n * Run the keyBindings when a key is pressed to perform actions.\n *\n * When return value is `true` no further actions should be taken for this key\n * event. When `false` the event will be passed up the chain to the next key\n * handler.\n *\n * This is useful for intercepting events.\n */\n\nvar runKeyBindings = function runKeyBindings(bindings, params) {\n  return keydownHandler(transformKeyBindings({\n    bindings: bindings,\n    params: params\n  }))(params.view, params.event);\n};\n\n/**\n * Creates an array of the actions taken based on the current prev and next\n * state field\n */\nvar findReason = function findReason(_ref13) {\n  var prev = _ref13.prev,\n      next = _ref13.next,\n      state = _ref13.state,\n      $pos = _ref13.$pos;\n  var value = Object.create(null);\n\n  if (!prev && !next) {\n    return value;\n  }\n\n  var compare = {\n    prev: prev,\n    next: next\n  }; // Check for a Jump\n\n  if (isJump(compare)) {\n    return findJumpReason({\n      prev: compare.prev,\n      next: compare.next,\n      state: state\n    });\n  } // Entered into a new suggestion\n\n\n  if (isEntry(compare)) {\n    return {\n      change: createMatchWithReason({\n        match: compare.next,\n        reason: ChangeReason.Start\n      })\n    };\n  } // Exited a suggestion\n\n\n  if (isExit(compare)) {\n    return findExitReason({\n      $pos: $pos,\n      match: compare.prev,\n      state: state\n    });\n  }\n\n  if (isChange(compare)) {\n    return {\n      change: createMatchWithReason({\n        match: compare.next,\n        reason: ChangeReason.Text\n      })\n    };\n  }\n\n  if (isMove(compare)) {\n    return {\n      change: createMatchWithReason({\n        match: compare.next,\n        reason: selectionEmpty(state) ? ChangeReason.Move : ChangeReason.SelectionInside\n      })\n    };\n  }\n\n  return value;\n};\n/**\n * Find a match for the provided matchers\n */\n\nvar findFromSuggesters = function findFromSuggesters(_ref14) {\n  var suggesters = _ref14.suggesters,\n      $pos = _ref14.$pos;\n  // Find the first match and break when done\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = suggesters[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var suggester = _step.value;\n\n      try {\n        var match = findMatch({\n          suggester: suggester,\n          $pos: $pos\n        });\n\n        if (match) {\n          return match;\n        }\n      } catch (_unused2) {\n        console.warn('Error while finding match.');\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return undefined;\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n/**\n * The suggestion state which manages the list of suggestions.\n */\n\nvar SuggestState =\n/*#__PURE__*/\nfunction () {\n  _createClass(SuggestState, [{\n    key: \"getCommand\",\n\n    /**\n     * The actions created by the extension.\n     */\n    value: function getCommand(match, reason) {\n      return match.suggester.createCommand({\n        match: match,\n        reason: reason,\n        view: this.view,\n        setMarkRemoved: this.setRemovedTrue,\n        addIgnored: this.addIgnored,\n        clearIgnored: this.clearIgnored\n      });\n    }\n    /**\n     * Returns the current active suggestion state field if one exists\n     */\n\n  }, {\n    key: \"match\",\n    get: function get() {\n      return this.next ? this.next : this.prev && this.handlerMatches.exit ? this.prev : undefined;\n    }\n    /**\n     * Create the state for the `prosemirror-suggest` plugin.\n     *\n     * @remarks\n     *\n     * Each suggester must provide a name value which is globally unique since it\n     * acts as the identifier.\n     *\n     * It is possible to register multiple suggesters with identical `char`\n     * properties. The matched suggester is based on the specificity of the\n     * `regex` and the order in which they are passed in. Earlier suggesters are\n     * prioritized.\n     */\n\n  }], [{\n    key: \"create\",\n\n    /**\n     * Create an instance of the SuggestState class.\n     */\n    value: function create(suggesters) {\n      return new SuggestState(suggesters);\n    }\n    /**\n     * The suggesters that have been registered for the suggestions plugin.\n     */\n\n  }]);\n\n  function SuggestState(suggesters) {\n    var _this = this;\n\n    _classCallCheck(this, SuggestState);\n\n    _defineProperty(this, \"handlerMatches\", Object.create(null));\n\n    _defineProperty(this, \"ignored\", DecorationSet.empty);\n\n    _defineProperty(this, \"removed\", false);\n\n    _defineProperty(this, \"setRemovedTrue\", function () {\n      _this.removed = true;\n    });\n\n    _defineProperty(this, \"onViewUpdate\", function () {\n      var match = _this.match,\n          _this$handlerMatches = _this.handlerMatches,\n          change = _this$handlerMatches.change,\n          exit = _this$handlerMatches.exit; // Cancel update when a suggestion isn't active\n\n      if (!change && !exit || !isValidMatch(match)) {\n        return;\n      } // Call Handlers\n      // When a jump happens run the action that involves the position that occurs\n      // later in the document. This is so that changes don't affect previous\n      // positions.\n\n\n      if (change && exit && isJumpReason({\n        change: change,\n        exit: exit\n      })) {\n        var exitParams = _this.createReasonParams(exit);\n\n        var changeParams = _this.createReasonParams(change);\n\n        var movedForwards = exit.range.from < change.range.from;\n        movedForwards ? change.suggester.onChange(changeParams) : exit.suggester.onExit(exitParams);\n        movedForwards ? exit.suggester.onExit(exitParams) : change.suggester.onChange(changeParams);\n        _this.removed = false;\n        return;\n      }\n\n      if (change) {\n        change.suggester.onChange(_this.createReasonParams(change));\n      }\n\n      if (exit) {\n        exit.suggester.onExit(_this.createReasonParams(exit));\n        _this.removed = false;\n\n        if (isInvalidSplitReason(exit.reason)) {\n          _this.handlerMatches = Object.create(null);\n        }\n      }\n    });\n\n    _defineProperty(this, \"addIgnored\", function (_ref) {\n      var from = _ref.from,\n          _char = _ref[\"char\"],\n          name = _ref.name,\n          _ref$specific = _ref.specific,\n          specific = _ref$specific === void 0 ? false : _ref$specific;\n      var to = from + _char.length;\n\n      var suggester = _this.suggesters.find(function (val) {\n        return val.name === name;\n      });\n\n      if (!suggester) {\n        throw new Error(\"No suggester exists for the name provided: \".concat(name));\n      }\n\n      var attrs = suggester.ignoredClassName ? {\n        \"class\": suggester.ignoredClassName\n      } : {};\n      var decoration = Decoration.inline(from, to, _objectSpread$1({\n        nodeName: suggester.ignoredTag\n      }, attrs), {\n        \"char\": _char,\n        name: name,\n        specific: specific\n      });\n      _this.ignored = _this.ignored.add(_this.view.state.doc, [decoration]);\n    });\n\n    _defineProperty(this, \"removeIgnored\", function (_ref2) {\n      var from = _ref2.from,\n          _char2 = _ref2[\"char\"],\n          name = _ref2.name;\n\n      var decorations = _this.ignored.find(from, from + _char2.length);\n\n      var decoration = decorations[0];\n\n      if (!bool(decoration) || decoration.spec.name !== name) {\n        return;\n      }\n\n      _this.ignored = _this.ignored.remove([decoration]);\n    });\n\n    _defineProperty(this, \"clearIgnored\", function (name) {\n      if (name) {\n        var decorations = _this.ignored.find();\n\n        var decorationsToClear = decorations.filter(function (_ref3) {\n          var spec = _ref3.spec;\n          return spec.name === name;\n        });\n        _this.ignored = _this.ignored.remove(decorationsToClear);\n      } else {\n        _this.ignored = DecorationSet.empty;\n      }\n    });\n\n    var names = [];\n    this.suggesters = suggesters.map(function (suggester) {\n      if (names.includes(suggester.name)) {\n        throw new Error(\"A suggester already exists with the name '\".concat(suggester.name, \"'. The name provided must be unique.\"));\n      }\n\n      names.push(suggester.name);\n      return _objectSpread$1({}, DEFAULT_SUGGESTER, {}, suggester);\n    });\n  }\n  /**\n   * Initialize the SuggestState with a view which is stored for use later.\n   */\n\n\n  _createClass(SuggestState, [{\n    key: \"init\",\n    value: function init(view) {\n      this.view = view;\n      return this;\n    }\n    /**\n     * Create the props which should be passed into each action handler\n     */\n\n  }, {\n    key: \"createParams\",\n    value: function createParams(match) {\n      return _objectSpread$1({\n        view: this.view,\n        addIgnored: this.addIgnored,\n        clearIgnored: this.clearIgnored,\n        command: this.getCommand(match)\n      }, match);\n    }\n    /**\n     * Create the prop to be passed into the `onChange` or `onExit` handler.\n     */\n\n  }, {\n    key: \"createReasonParams\",\n    value: function createReasonParams(match) {\n      return _objectSpread$1({}, this.createParams(match), {\n        command: this.getCommand(match, match.reason)\n      }, match);\n    }\n    /**\n     * Manages the view updates.\n     */\n\n  }, {\n    key: \"mapIgnoredDecorations\",\n\n    /**\n     * Update the current ignored decorations based on the latest changes to the\n     * prosemirror document.\n     */\n    value: function mapIgnoredDecorations(tr) {\n      // Map over and update the ignored decorations.\n      var ignored = this.ignored.map(tr.mapping, tr.doc);\n      var decorations = ignored.find(); // For suggesters with multiple characters it is possible for a `paste` or\n      // any edit action within the decoration to expand the ignored section. We check for\n      // that here and if the section size has changed it should be marked as\n      // invalid and removed from the ignored `DecorationSet`.\n\n      var invalid = decorations.filter(function (_ref4) {\n        var from = _ref4.from,\n            to = _ref4.to,\n            spec = _ref4.spec;\n\n        if (to - from !== spec[\"char\"].length) {\n          return true;\n        }\n\n        return false;\n      });\n      this.ignored = ignored.remove(invalid);\n    }\n    /**\n     * Ignores the match specified. Until the match is deleted no more `onChange`,\n     * `onExit` handlers will be triggered. It will be like the match doesn't\n     * exist.\n     *\n     * @remarks\n     *\n     * All we need to ignore is the match character. This means that any further\n     * matches from the activation character will be ignored.\n     */\n\n  }, {\n    key: \"shouldIgnoreMatch\",\n    value: function shouldIgnoreMatch(_ref5) {\n      var range = _ref5.range,\n          name = _ref5.suggester.name;\n      var decorations = this.ignored.find();\n      return decorations.some(function (_ref6) {\n        var spec = _ref6.spec,\n            from = _ref6.from;\n\n        if (from !== range.from) {\n          return false;\n        }\n\n        var shouldIgnore = spec.specific ? spec.name === name : true;\n        return shouldIgnore;\n      });\n    }\n    /**\n     * Reset the state.\n     */\n\n  }, {\n    key: \"resetState\",\n    value: function resetState() {\n      this.handlerMatches = Object.create(null);\n      this.next = undefined;\n      this.removed = false;\n    }\n    /**\n     * Update the next state value.\n     */\n\n  }, {\n    key: \"updateReasons\",\n    value: function updateReasons(_ref7) {\n      var $pos = _ref7.$pos,\n          state = _ref7.state;\n      var match = findFromSuggesters({\n        suggesters: this.suggesters,\n        $pos: $pos\n      });\n      this.next = match && this.shouldIgnoreMatch(match) ? undefined : match; // Store the matches with reasons\n\n      this.handlerMatches = findReason({\n        next: this.next,\n        prev: this.prev,\n        state: state,\n        $pos: $pos\n      });\n    }\n    /**\n     * Used to handle the view property of the plugin spec.\n     */\n\n  }, {\n    key: \"viewHandler\",\n    value: function viewHandler() {\n      return {\n        update: this.onViewUpdate\n      };\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return this.match;\n    }\n    /**\n     * Applies updates to the state to be used within the plugins apply method.\n     *\n     * @param - params\n     */\n\n  }, {\n    key: \"apply\",\n    value: function apply(_ref8) {\n      var tr = _ref8.tr,\n          newState = _ref8.newState;\n      var exit = this.handlerMatches.exit;\n\n      if (!transactionChanged(tr) && !this.removed) {\n        return this;\n      }\n\n      this.mapIgnoredDecorations(tr); // If the previous run was an exit reset the suggestion matches\n\n      if (exit) {\n        this.resetState();\n      }\n\n      this.prev = this.next; // Match against the current selection position\n\n      this.updateReasons({\n        $pos: tr.selection.$from,\n        state: newState\n      });\n      return this;\n    }\n    /**\n     * Manages the keyDown event within the plugin props\n     *\n     * @param event\n     */\n\n  }, {\n    key: \"handleKeyDown\",\n    value: function handleKeyDown(event) {\n      var match = this.match;\n\n      if (!isValidMatch(match)) {\n        return false;\n      }\n\n      var keyBindings = match.suggester.keyBindings;\n\n      var params = _objectSpread$1({\n        event: event,\n        setMarkRemoved: this.setRemovedTrue\n      }, this.createParams(match));\n\n      return runKeyBindings(keyBindings, params);\n    }\n    /**\n     * Handle any key presses of non supported characters\n     */\n\n  }, {\n    key: \"handleTextInput\",\n    value: function handleTextInput(_ref9) {\n      var text = _ref9.text,\n          from = _ref9.from,\n          to = _ref9.to;\n      var match = this.match;\n\n      if (!isValidMatch(match)) {\n        return false;\n      }\n\n      var onCharacterEntry = match.suggester.onCharacterEntry;\n      return onCharacterEntry(_objectSpread$1({}, this.createParams(match), {\n        from: from,\n        to: to,\n        text: text\n      }));\n    }\n    /**\n     * Handle the decorations which wrap the mention while it is active and not\n     * yet complete.\n     */\n\n  }, {\n    key: \"decorations\",\n    value: function decorations(state) {\n      var match = this.match;\n\n      if (!isValidMatch(match)) {\n        return this.ignored;\n      }\n\n      if (match.suggester.noDecorations) {\n        return this.ignored;\n      }\n\n      var range = match.range,\n          _match$suggester = match.suggester,\n          name = _match$suggester.name,\n          decorationsTag = _match$suggester.suggestTag,\n          suggestionClassName = _match$suggester.suggestClassName;\n      var from = range.from,\n          end = range.end;\n      return this.shouldIgnoreMatch(match) ? this.ignored : this.ignored.add(state.doc, [Decoration.inline(from, end, {\n        nodeName: decorationsTag,\n        \"class\": name ? \"\".concat(suggestionClassName, \" \").concat(suggestionClassName, \"-\").concat(name) : suggestionClassName\n      })]);\n    }\n  }]);\n\n  return SuggestState;\n}();\n\nvar suggestPluginKey = new PluginKey('suggest');\n/**\n * Get the state of the suggest plugin.\n *\n * @param state - the editor state.\n */\n\nvar getSuggestPluginState = function getSuggestPluginState(state) {\n  return getPluginState(suggestPluginKey, state);\n};\n/**\n * This creates a suggestion plugin with all the suggestions provided.\n *\n * @remarks\n *\n * In the following example we're creating an emoji suggestion plugin that\n * responds to the colon character with a query and presents a list of matching\n * emojis based on the query typed so far.\n *\n * ```ts\n * import { Suggester, suggest } from 'prosemirror-suggest';\n *\n * const maxResults = 10;\n * let selectedIndex = 0;\n * let emojiList: string[] = [];\n * let showSuggestions = false;\n *\n * const suggestEmojis: Suggester = {\n *   // By default decorations are used to highlight the currently matched\n *   // suggestion in the dom.\n *   // In this example we don't need decorations (in fact they cause problems when the\n *   // emoji string replaces the query text in the dom).\n *   noDecorations: true,\n *   char: ':', // The character to match against\n *   name: 'emoji-suggestion', // a unique name\n *   appendText: '', // Text to append to the created match\n *\n *   // Keybindings are similar to prosemirror keymaps with a few extra niceties.\n *   // The key identifier can also include modifiers (e.g.) `Cmd-Space: () => false`\n *   // Return true to prevent any further keyboard handlers from running.\n *   keyBindings: {\n *     ArrowUp: () => {\n *       selectedIndex = rotateSelectionBackwards(selectedIndex, emojiList.length);\n *     },\n *     ArrowDown: () => {\n *       selectedIndex = rotateSelectionForwards(selectedIndex, emojiList.length);\n *     },\n *     Enter: ({ command }) => {\n *       if (showSuggestions) {\n *         command(emojiList[selectedIndex]);\n *       }\n *     },\n *     Esc: () => {\n *       showSuggestions = false;\n *     },\n *   },\n *\n *   onChange: params => {\n *     const query = params.query.full;\n *     emojiList = sortEmojiMatches({ query, maxResults });\n *     selectedIndex = 0;\n *     showSuggestions = true;\n *   },\n *\n *   onExit: () => {\n *     showSuggestions = false;\n *     emojiList = [];\n *     selectedIndex = 0;\n *   },\n *\n *   // Create a  function that is passed into the change, exit and keybinding handlers.\n *   // This is useful when these handlers are called in a different part of the app.\n *   createCommand: ({ match, view }) => {\n *     return (emoji,skinVariation) => {\n *       if (!emoji) {\n *         throw new Error('An emoji is required when calling the emoji suggestions command');\n *       }\n *\n *       const tr = view.state.tr; const { from, end: to } = match.range;\n *       tr.insertText(emoji, from, to); view.dispatch(tr);\n *     };\n *   },\n * };\n *\n *  // Create the plugin with the above configuration. It also supports multiple plugins being added.\n * const suggestionPlugin = suggest(suggestEmojis);\n *\n *  // Include the plugin in the created editor state.\n * const state = EditorState.create({schema,\n *   plugins: [suggestionPlugin],\n * });\n * ```\n *\n * The priority of the suggestions is the order in which they are passed into\n * this function.\n *\n * - `const plugin = suggest(two, one, three)` - Here `two` will be checked\n *   first, then `one` and then `three`.\n *\n * Only one suggestion can match at any given time. The order and specificity of\n * the regex parameters help determines which suggestion will be active.\n *\n * @param suggesters - a list of suggesters in the order they should be\n * evaluated.\n */\n\nvar suggest = function suggest() {\n  for (var _len = arguments.length, suggesters = new Array(_len), _key = 0; _key < _len; _key++) {\n    suggesters[_key] = arguments[_key];\n  }\n\n  var pluginState = SuggestState.create(suggesters);\n  return new Plugin({\n    key: suggestPluginKey,\n    // Handle the plugin view\n    view: function view(_view) {\n      return pluginState.init(_view).viewHandler();\n    },\n    state: {\n      // Initialize the state\n      init: function init() {\n        return pluginState;\n      },\n      // Apply changes to the state\n      apply: function apply(tr, _, oldState, newState) {\n        return pluginState.apply({\n          tr: tr,\n          oldState: oldState,\n          newState: newState\n        });\n      }\n    },\n    props: {\n      // Call the keydown hook if suggestion is active.\n      handleKeyDown: function handleKeyDown(_, event) {\n        return pluginState.handleKeyDown(event);\n      },\n      // Defer to the pluginState handler\n      handleTextInput: function handleTextInput(_, from, to, text) {\n        return pluginState.handleTextInput({\n          text: text,\n          from: from,\n          to: to\n        });\n      },\n      // Sets up a decoration (styling options) on the currently active\n      // decoration\n      decorations: function decorations(state) {\n        return pluginState.decorations(state);\n      }\n    }\n  });\n};\n\nexport { ChangeReason, DEFAULT_SUGGESTER, DEFAULT_SUGGEST_ACTIONS, ExitReason, createRegexFromSuggester, escapeChar, getRegexPrefix, getSuggestPluginState, isChange, isChangeReason, isEntry, isExit, isExitReason, isInvalidSplitReason, isJump, isJumpReason, isMove, isRemovedReason, isSplitReason, isValidMatch, regexToString, selectionOutsideMatch, suggest };\n//# sourceMappingURL=prosemirror-suggest.esm.js.map\n","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeReflectConstruct = require(\"./isNativeReflectConstruct\");\n\nfunction _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    module.exports = _construct = Reflect.construct;\n  } else {\n    module.exports = _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nmodule.exports = _construct;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nmodule.exports = _isNativeReflectConstruct;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","/*!\n * typeahead.js 1.3.1\n * https://github.com/corejavascript/typeahead.js\n * Copyright 2013-2020 Twitter, Inc. and other contributors; Licensed MIT\n */\n\n\n(function(root, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define([ \"jquery\" ], function(a0) {\n            return root[\"Bloodhound\"] = factory(a0);\n        });\n    } else if (typeof module === \"object\" && module.exports) {\n        module.exports = factory(require(\"jquery\"));\n    } else {\n        root[\"Bloodhound\"] = factory(root[\"jQuery\"]);\n    }\n})(this, function($) {\n    var _ = function() {\n        \"use strict\";\n        return {\n            isMsie: function() {\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },\n            isBlankString: function(str) {\n                return !str || /^\\s*$/.test(str);\n            },\n            escapeRegExChars: function(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            },\n            isString: function(obj) {\n                return typeof obj === \"string\";\n            },\n            isNumber: function(obj) {\n                return typeof obj === \"number\";\n            },\n            isArray: $.isArray,\n            isFunction: $.isFunction,\n            isObject: $.isPlainObject,\n            isUndefined: function(obj) {\n                return typeof obj === \"undefined\";\n            },\n            isElement: function(obj) {\n                return !!(obj && obj.nodeType === 1);\n            },\n            isJQuery: function(obj) {\n                return obj instanceof $;\n            },\n            toStr: function toStr(s) {\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\n            },\n            bind: $.proxy,\n            each: function(collection, cb) {\n                $.each(collection, reverseArgs);\n                function reverseArgs(index, value) {\n                    return cb(value, index);\n                }\n            },\n            map: $.map,\n            filter: $.grep,\n            every: function(obj, test) {\n                var result = true;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (!(result = test.call(null, val, key, obj))) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            some: function(obj, test) {\n                var result = false;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (result = test.call(null, val, key, obj)) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            mixin: $.extend,\n            identity: function(x) {\n                return x;\n            },\n            clone: function(obj) {\n                return $.extend(true, {}, obj);\n            },\n            getIdGenerator: function() {\n                var counter = 0;\n                return function() {\n                    return counter++;\n                };\n            },\n            templatify: function templatify(obj) {\n                return $.isFunction(obj) ? obj : template;\n                function template() {\n                    return String(obj);\n                }\n            },\n            defer: function(fn) {\n                setTimeout(fn, 0);\n            },\n            debounce: function(func, wait, immediate) {\n                var timeout, result;\n                return function() {\n                    var context = this, args = arguments, later, callNow;\n                    later = function() {\n                        timeout = null;\n                        if (!immediate) {\n                            result = func.apply(context, args);\n                        }\n                    };\n                    callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) {\n                        result = func.apply(context, args);\n                    }\n                    return result;\n                };\n            },\n            throttle: function(func, wait) {\n                var context, args, timeout, result, previous, later;\n                previous = 0;\n                later = function() {\n                    previous = new Date();\n                    timeout = null;\n                    result = func.apply(context, args);\n                };\n                return function() {\n                    var now = new Date(), remaining = wait - (now - previous);\n                    context = this;\n                    args = arguments;\n                    if (remaining <= 0) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                        previous = now;\n                        result = func.apply(context, args);\n                    } else if (!timeout) {\n                        timeout = setTimeout(later, remaining);\n                    }\n                    return result;\n                };\n            },\n            stringify: function(val) {\n                return _.isString(val) ? val : JSON.stringify(val);\n            },\n            guid: function() {\n                function _p8(s) {\n                    var p = (Math.random().toString(16) + \"000000000\").substr(2, 8);\n                    return s ? \"-\" + p.substr(0, 4) + \"-\" + p.substr(4, 4) : p;\n                }\n                return \"tt-\" + _p8() + _p8(true) + _p8(true) + _p8();\n            },\n            noop: function() {}\n        };\n    }();\n    var VERSION = \"1.3.1\";\n    var tokenizers = function() {\n        \"use strict\";\n        return {\n            nonword: nonword,\n            whitespace: whitespace,\n            ngram: ngram,\n            obj: {\n                nonword: getObjTokenizer(nonword),\n                whitespace: getObjTokenizer(whitespace),\n                ngram: getObjTokenizer(ngram)\n            }\n        };\n        function whitespace(str) {\n            str = _.toStr(str);\n            return str ? str.split(/\\s+/) : [];\n        }\n        function nonword(str) {\n            str = _.toStr(str);\n            return str ? str.split(/\\W+/) : [];\n        }\n        function ngram(str) {\n            str = _.toStr(str);\n            var tokens = [], word = \"\";\n            _.each(str.split(\"\"), function(char) {\n                if (char.match(/\\s+/)) {\n                    word = \"\";\n                } else {\n                    tokens.push(word + char);\n                    word += char;\n                }\n            });\n            return tokens;\n        }\n        function getObjTokenizer(tokenizer) {\n            return function setKey(keys) {\n                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);\n                return function tokenize(o) {\n                    var tokens = [];\n                    _.each(keys, function(k) {\n                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));\n                    });\n                    return tokens;\n                };\n            };\n        }\n    }();\n    var LruCache = function() {\n        \"use strict\";\n        function LruCache(maxSize) {\n            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;\n            this.reset();\n            if (this.maxSize <= 0) {\n                this.set = this.get = $.noop;\n            }\n        }\n        _.mixin(LruCache.prototype, {\n            set: function set(key, val) {\n                var tailItem = this.list.tail, node;\n                if (this.size >= this.maxSize) {\n                    this.list.remove(tailItem);\n                    delete this.hash[tailItem.key];\n                    this.size--;\n                }\n                if (node = this.hash[key]) {\n                    node.val = val;\n                    this.list.moveToFront(node);\n                } else {\n                    node = new Node(key, val);\n                    this.list.add(node);\n                    this.hash[key] = node;\n                    this.size++;\n                }\n            },\n            get: function get(key) {\n                var node = this.hash[key];\n                if (node) {\n                    this.list.moveToFront(node);\n                    return node.val;\n                }\n            },\n            reset: function reset() {\n                this.size = 0;\n                this.hash = {};\n                this.list = new List();\n            }\n        });\n        function List() {\n            this.head = this.tail = null;\n        }\n        _.mixin(List.prototype, {\n            add: function add(node) {\n                if (this.head) {\n                    node.next = this.head;\n                    this.head.prev = node;\n                }\n                this.head = node;\n                this.tail = this.tail || node;\n            },\n            remove: function remove(node) {\n                node.prev ? node.prev.next = node.next : this.head = node.next;\n                node.next ? node.next.prev = node.prev : this.tail = node.prev;\n            },\n            moveToFront: function(node) {\n                this.remove(node);\n                this.add(node);\n            }\n        });\n        function Node(key, val) {\n            this.key = key;\n            this.val = val;\n            this.prev = this.next = null;\n        }\n        return LruCache;\n    }();\n    var PersistentStorage = function() {\n        \"use strict\";\n        var LOCAL_STORAGE;\n        try {\n            LOCAL_STORAGE = window.localStorage;\n            LOCAL_STORAGE.setItem(\"~~~\", \"!\");\n            LOCAL_STORAGE.removeItem(\"~~~\");\n        } catch (err) {\n            LOCAL_STORAGE = null;\n        }\n        function PersistentStorage(namespace, override) {\n            this.prefix = [ \"__\", namespace, \"__\" ].join(\"\");\n            this.ttlKey = \"__ttl__\";\n            this.keyMatcher = new RegExp(\"^\" + _.escapeRegExChars(this.prefix));\n            this.ls = override || LOCAL_STORAGE;\n            !this.ls && this._noop();\n        }\n        _.mixin(PersistentStorage.prototype, {\n            _prefix: function(key) {\n                return this.prefix + key;\n            },\n            _ttlKey: function(key) {\n                return this._prefix(key) + this.ttlKey;\n            },\n            _noop: function() {\n                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;\n            },\n            _safeSet: function(key, val) {\n                try {\n                    this.ls.setItem(key, val);\n                } catch (err) {\n                    if (err.name === \"QuotaExceededError\") {\n                        this.clear();\n                        this._noop();\n                    }\n                }\n            },\n            get: function(key) {\n                if (this.isExpired(key)) {\n                    this.remove(key);\n                }\n                return decode(this.ls.getItem(this._prefix(key)));\n            },\n            set: function(key, val, ttl) {\n                if (_.isNumber(ttl)) {\n                    this._safeSet(this._ttlKey(key), encode(now() + ttl));\n                } else {\n                    this.ls.removeItem(this._ttlKey(key));\n                }\n                return this._safeSet(this._prefix(key), encode(val));\n            },\n            remove: function(key) {\n                this.ls.removeItem(this._ttlKey(key));\n                this.ls.removeItem(this._prefix(key));\n                return this;\n            },\n            clear: function() {\n                var i, keys = gatherMatchingKeys(this.keyMatcher);\n                for (i = keys.length; i--; ) {\n                    this.remove(keys[i]);\n                }\n                return this;\n            },\n            isExpired: function(key) {\n                var ttl = decode(this.ls.getItem(this._ttlKey(key)));\n                return _.isNumber(ttl) && now() > ttl ? true : false;\n            }\n        });\n        return PersistentStorage;\n        function now() {\n            return new Date().getTime();\n        }\n        function encode(val) {\n            return JSON.stringify(_.isUndefined(val) ? null : val);\n        }\n        function decode(val) {\n            return $.parseJSON(val);\n        }\n        function gatherMatchingKeys(keyMatcher) {\n            var i, key, keys = [], len = LOCAL_STORAGE.length;\n            for (i = 0; i < len; i++) {\n                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {\n                    keys.push(key.replace(keyMatcher, \"\"));\n                }\n            }\n            return keys;\n        }\n    }();\n    var Transport = function() {\n        \"use strict\";\n        var pendingRequestsCount = 0, pendingRequests = {}, sharedCache = new LruCache(10);\n        function Transport(o) {\n            o = o || {};\n            this.maxPendingRequests = o.maxPendingRequests || 6;\n            this.cancelled = false;\n            this.lastReq = null;\n            this._send = o.transport;\n            this._get = o.limiter ? o.limiter(this._get) : this._get;\n            this._cache = o.cache === false ? new LruCache(0) : sharedCache;\n        }\n        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {\n            this.maxPendingRequests = num;\n        };\n        Transport.resetCache = function resetCache() {\n            sharedCache.reset();\n        };\n        _.mixin(Transport.prototype, {\n            _fingerprint: function fingerprint(o) {\n                o = o || {};\n                return o.url + o.type + $.param(o.data || {});\n            },\n            _get: function(o, cb) {\n                var that = this, fingerprint, jqXhr;\n                fingerprint = this._fingerprint(o);\n                if (this.cancelled || fingerprint !== this.lastReq) {\n                    return;\n                }\n                if (jqXhr = pendingRequests[fingerprint]) {\n                    jqXhr.done(done).fail(fail);\n                } else if (pendingRequestsCount < this.maxPendingRequests) {\n                    pendingRequestsCount++;\n                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);\n                } else {\n                    this.onDeckRequestArgs = [].slice.call(arguments, 0);\n                }\n                function done(resp) {\n                    cb(null, resp);\n                    that._cache.set(fingerprint, resp);\n                }\n                function fail() {\n                    cb(true);\n                }\n                function always() {\n                    pendingRequestsCount--;\n                    delete pendingRequests[fingerprint];\n                    if (that.onDeckRequestArgs) {\n                        that._get.apply(that, that.onDeckRequestArgs);\n                        that.onDeckRequestArgs = null;\n                    }\n                }\n            },\n            get: function(o, cb) {\n                var resp, fingerprint;\n                cb = cb || $.noop;\n                o = _.isString(o) ? {\n                    url: o\n                } : o || {};\n                fingerprint = this._fingerprint(o);\n                this.cancelled = false;\n                this.lastReq = fingerprint;\n                if (resp = this._cache.get(fingerprint)) {\n                    cb(null, resp);\n                } else {\n                    this._get(o, cb);\n                }\n            },\n            cancel: function() {\n                this.cancelled = true;\n            }\n        });\n        return Transport;\n    }();\n    var SearchIndex = window.SearchIndex = function() {\n        \"use strict\";\n        var CHILDREN = \"c\", IDS = \"i\";\n        function SearchIndex(o) {\n            o = o || {};\n            if (!o.datumTokenizer || !o.queryTokenizer) {\n                $.error(\"datumTokenizer and queryTokenizer are both required\");\n            }\n            this.identify = o.identify || _.stringify;\n            this.datumTokenizer = o.datumTokenizer;\n            this.queryTokenizer = o.queryTokenizer;\n            this.matchAnyQueryToken = o.matchAnyQueryToken;\n            this.reset();\n        }\n        _.mixin(SearchIndex.prototype, {\n            bootstrap: function bootstrap(o) {\n                this.datums = o.datums;\n                this.trie = o.trie;\n            },\n            add: function(data) {\n                var that = this;\n                data = _.isArray(data) ? data : [ data ];\n                _.each(data, function(datum) {\n                    var id, tokens;\n                    that.datums[id = that.identify(datum)] = datum;\n                    tokens = normalizeTokens(that.datumTokenizer(datum));\n                    _.each(tokens, function(token) {\n                        var node, chars, ch;\n                        node = that.trie;\n                        chars = token.split(\"\");\n                        while (ch = chars.shift()) {\n                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());\n                            node[IDS].push(id);\n                        }\n                    });\n                });\n            },\n            get: function get(ids) {\n                var that = this;\n                return _.map(ids, function(id) {\n                    return that.datums[id];\n                });\n            },\n            search: function search(query) {\n                var that = this, tokens, matches;\n                tokens = normalizeTokens(this.queryTokenizer(query));\n                _.each(tokens, function(token) {\n                    var node, chars, ch, ids;\n                    if (matches && matches.length === 0 && !that.matchAnyQueryToken) {\n                        return false;\n                    }\n                    node = that.trie;\n                    chars = token.split(\"\");\n                    while (node && (ch = chars.shift())) {\n                        node = node[CHILDREN][ch];\n                    }\n                    if (node && chars.length === 0) {\n                        ids = node[IDS].slice(0);\n                        matches = matches ? getIntersection(matches, ids) : ids;\n                    } else {\n                        if (!that.matchAnyQueryToken) {\n                            matches = [];\n                            return false;\n                        }\n                    }\n                });\n                return matches ? _.map(unique(matches), function(id) {\n                    return that.datums[id];\n                }) : [];\n            },\n            all: function all() {\n                var values = [];\n                for (var key in this.datums) {\n                    values.push(this.datums[key]);\n                }\n                return values;\n            },\n            reset: function reset() {\n                this.datums = {};\n                this.trie = newNode();\n            },\n            serialize: function serialize() {\n                return {\n                    datums: this.datums,\n                    trie: this.trie\n                };\n            }\n        });\n        return SearchIndex;\n        function normalizeTokens(tokens) {\n            tokens = _.filter(tokens, function(token) {\n                return !!token;\n            });\n            tokens = _.map(tokens, function(token) {\n                return token.toLowerCase();\n            });\n            return tokens;\n        }\n        function newNode() {\n            var node = {};\n            node[IDS] = [];\n            node[CHILDREN] = {};\n            return node;\n        }\n        function unique(array) {\n            var seen = {}, uniques = [];\n            for (var i = 0, len = array.length; i < len; i++) {\n                if (!seen[array[i]]) {\n                    seen[array[i]] = true;\n                    uniques.push(array[i]);\n                }\n            }\n            return uniques;\n        }\n        function getIntersection(arrayA, arrayB) {\n            var ai = 0, bi = 0, intersection = [];\n            arrayA = arrayA.sort();\n            arrayB = arrayB.sort();\n            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;\n            while (ai < lenArrayA && bi < lenArrayB) {\n                if (arrayA[ai] < arrayB[bi]) {\n                    ai++;\n                } else if (arrayA[ai] > arrayB[bi]) {\n                    bi++;\n                } else {\n                    intersection.push(arrayA[ai]);\n                    ai++;\n                    bi++;\n                }\n            }\n            return intersection;\n        }\n    }();\n    var Prefetch = function() {\n        \"use strict\";\n        var keys;\n        keys = {\n            data: \"data\",\n            protocol: \"protocol\",\n            thumbprint: \"thumbprint\"\n        };\n        function Prefetch(o) {\n            this.url = o.url;\n            this.ttl = o.ttl;\n            this.cache = o.cache;\n            this.prepare = o.prepare;\n            this.transform = o.transform;\n            this.transport = o.transport;\n            this.thumbprint = o.thumbprint;\n            this.storage = new PersistentStorage(o.cacheKey);\n        }\n        _.mixin(Prefetch.prototype, {\n            _settings: function settings() {\n                return {\n                    url: this.url,\n                    type: \"GET\",\n                    dataType: \"json\"\n                };\n            },\n            store: function store(data) {\n                if (!this.cache) {\n                    return;\n                }\n                this.storage.set(keys.data, data, this.ttl);\n                this.storage.set(keys.protocol, location.protocol, this.ttl);\n                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);\n            },\n            fromCache: function fromCache() {\n                var stored = {}, isExpired;\n                if (!this.cache) {\n                    return null;\n                }\n                stored.data = this.storage.get(keys.data);\n                stored.protocol = this.storage.get(keys.protocol);\n                stored.thumbprint = this.storage.get(keys.thumbprint);\n                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;\n                return stored.data && !isExpired ? stored.data : null;\n            },\n            fromNetwork: function(cb) {\n                var that = this, settings;\n                if (!cb) {\n                    return;\n                }\n                settings = this.prepare(this._settings());\n                this.transport(settings).fail(onError).done(onResponse);\n                function onError() {\n                    cb(true);\n                }\n                function onResponse(resp) {\n                    cb(null, that.transform(resp));\n                }\n            },\n            clear: function clear() {\n                this.storage.clear();\n                return this;\n            }\n        });\n        return Prefetch;\n    }();\n    var Remote = function() {\n        \"use strict\";\n        function Remote(o) {\n            this.url = o.url;\n            this.prepare = o.prepare;\n            this.transform = o.transform;\n            this.indexResponse = o.indexResponse;\n            this.transport = new Transport({\n                cache: o.cache,\n                limiter: o.limiter,\n                transport: o.transport,\n                maxPendingRequests: o.maxPendingRequests\n            });\n        }\n        _.mixin(Remote.prototype, {\n            _settings: function settings() {\n                return {\n                    url: this.url,\n                    type: \"GET\",\n                    dataType: \"json\"\n                };\n            },\n            get: function get(query, cb) {\n                var that = this, settings;\n                if (!cb) {\n                    return;\n                }\n                query = query || \"\";\n                settings = this.prepare(query, this._settings());\n                return this.transport.get(settings, onResponse);\n                function onResponse(err, resp) {\n                    err ? cb([]) : cb(that.transform(resp));\n                }\n            },\n            cancelLastRequest: function cancelLastRequest() {\n                this.transport.cancel();\n            }\n        });\n        return Remote;\n    }();\n    var oParser = function() {\n        \"use strict\";\n        return function parse(o) {\n            var defaults, sorter;\n            defaults = {\n                initialize: true,\n                identify: _.stringify,\n                datumTokenizer: null,\n                queryTokenizer: null,\n                matchAnyQueryToken: false,\n                sufficient: 5,\n                indexRemote: false,\n                sorter: null,\n                local: [],\n                prefetch: null,\n                remote: null\n            };\n            o = _.mixin(defaults, o || {});\n            !o.datumTokenizer && $.error(\"datumTokenizer is required\");\n            !o.queryTokenizer && $.error(\"queryTokenizer is required\");\n            sorter = o.sorter;\n            o.sorter = sorter ? function(x) {\n                return x.sort(sorter);\n            } : _.identity;\n            o.local = _.isFunction(o.local) ? o.local() : o.local;\n            o.prefetch = parsePrefetch(o.prefetch);\n            o.remote = parseRemote(o.remote);\n            return o;\n        };\n        function parsePrefetch(o) {\n            var defaults;\n            if (!o) {\n                return null;\n            }\n            defaults = {\n                url: null,\n                ttl: 24 * 60 * 60 * 1e3,\n                cache: true,\n                cacheKey: null,\n                thumbprint: \"\",\n                prepare: _.identity,\n                transform: _.identity,\n                transport: null\n            };\n            o = _.isString(o) ? {\n                url: o\n            } : o;\n            o = _.mixin(defaults, o);\n            !o.url && $.error(\"prefetch requires url to be set\");\n            o.transform = o.filter || o.transform;\n            o.cacheKey = o.cacheKey || o.url;\n            o.thumbprint = VERSION + o.thumbprint;\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\n            return o;\n        }\n        function parseRemote(o) {\n            var defaults;\n            if (!o) {\n                return;\n            }\n            defaults = {\n                url: null,\n                cache: true,\n                prepare: null,\n                replace: null,\n                wildcard: null,\n                limiter: null,\n                rateLimitBy: \"debounce\",\n                rateLimitWait: 300,\n                transform: _.identity,\n                transport: null\n            };\n            o = _.isString(o) ? {\n                url: o\n            } : o;\n            o = _.mixin(defaults, o);\n            !o.url && $.error(\"remote requires url to be set\");\n            o.transform = o.filter || o.transform;\n            o.prepare = toRemotePrepare(o);\n            o.limiter = toLimiter(o);\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\n            delete o.replace;\n            delete o.wildcard;\n            delete o.rateLimitBy;\n            delete o.rateLimitWait;\n            return o;\n        }\n        function toRemotePrepare(o) {\n            var prepare, replace, wildcard;\n            prepare = o.prepare;\n            replace = o.replace;\n            wildcard = o.wildcard;\n            if (prepare) {\n                return prepare;\n            }\n            if (replace) {\n                prepare = prepareByReplace;\n            } else if (o.wildcard) {\n                prepare = prepareByWildcard;\n            } else {\n                prepare = identityPrepare;\n            }\n            return prepare;\n            function prepareByReplace(query, settings) {\n                settings.url = replace(settings.url, query);\n                return settings;\n            }\n            function prepareByWildcard(query, settings) {\n                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));\n                return settings;\n            }\n            function identityPrepare(query, settings) {\n                return settings;\n            }\n        }\n        function toLimiter(o) {\n            var limiter, method, wait;\n            limiter = o.limiter;\n            method = o.rateLimitBy;\n            wait = o.rateLimitWait;\n            if (!limiter) {\n                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);\n            }\n            return limiter;\n            function debounce(wait) {\n                return function debounce(fn) {\n                    return _.debounce(fn, wait);\n                };\n            }\n            function throttle(wait) {\n                return function throttle(fn) {\n                    return _.throttle(fn, wait);\n                };\n            }\n        }\n        function callbackToDeferred(fn) {\n            return function wrapper(o) {\n                var deferred = $.Deferred();\n                fn(o, onSuccess, onError);\n                return deferred;\n                function onSuccess(resp) {\n                    _.defer(function() {\n                        deferred.resolve(resp);\n                    });\n                }\n                function onError(err) {\n                    _.defer(function() {\n                        deferred.reject(err);\n                    });\n                }\n            };\n        }\n    }();\n    var Bloodhound = function() {\n        \"use strict\";\n        var old;\n        old = window && window.Bloodhound;\n        function Bloodhound(o) {\n            o = oParser(o);\n            this.sorter = o.sorter;\n            this.identify = o.identify;\n            this.sufficient = o.sufficient;\n            this.indexRemote = o.indexRemote;\n            this.local = o.local;\n            this.remote = o.remote ? new Remote(o.remote) : null;\n            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;\n            this.index = new SearchIndex({\n                identify: this.identify,\n                datumTokenizer: o.datumTokenizer,\n                queryTokenizer: o.queryTokenizer\n            });\n            o.initialize !== false && this.initialize();\n        }\n        Bloodhound.noConflict = function noConflict() {\n            window && (window.Bloodhound = old);\n            return Bloodhound;\n        };\n        Bloodhound.tokenizers = tokenizers;\n        _.mixin(Bloodhound.prototype, {\n            __ttAdapter: function ttAdapter() {\n                var that = this;\n                return this.remote ? withAsync : withoutAsync;\n                function withAsync(query, sync, async) {\n                    return that.search(query, sync, async);\n                }\n                function withoutAsync(query, sync) {\n                    return that.search(query, sync);\n                }\n            },\n            _loadPrefetch: function loadPrefetch() {\n                var that = this, deferred, serialized;\n                deferred = $.Deferred();\n                if (!this.prefetch) {\n                    deferred.resolve();\n                } else if (serialized = this.prefetch.fromCache()) {\n                    this.index.bootstrap(serialized);\n                    deferred.resolve();\n                } else {\n                    this.prefetch.fromNetwork(done);\n                }\n                return deferred.promise();\n                function done(err, data) {\n                    if (err) {\n                        return deferred.reject();\n                    }\n                    that.add(data);\n                    that.prefetch.store(that.index.serialize());\n                    deferred.resolve();\n                }\n            },\n            _initialize: function initialize() {\n                var that = this, deferred;\n                this.clear();\n                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);\n                return this.initPromise;\n                function addLocalToIndex() {\n                    that.add(that.local);\n                }\n            },\n            initialize: function initialize(force) {\n                return !this.initPromise || force ? this._initialize() : this.initPromise;\n            },\n            add: function add(data) {\n                this.index.add(data);\n                return this;\n            },\n            get: function get(ids) {\n                ids = _.isArray(ids) ? ids : [].slice.call(arguments);\n                return this.index.get(ids);\n            },\n            search: function search(query, sync, async) {\n                var that = this, local;\n                sync = sync || _.noop;\n                async = async || _.noop;\n                local = this.sorter(this.index.search(query));\n                sync(this.remote ? local.slice() : local);\n                if (this.remote && local.length < this.sufficient) {\n                    this.remote.get(query, processRemote);\n                } else if (this.remote) {\n                    this.remote.cancelLastRequest();\n                }\n                return this;\n                function processRemote(remote) {\n                    var nonDuplicates = [];\n                    _.each(remote, function(r) {\n                        !_.some(local, function(l) {\n                            return that.identify(r) === that.identify(l);\n                        }) && nonDuplicates.push(r);\n                    });\n                    that.indexRemote && that.add(nonDuplicates);\n                    async(nonDuplicates);\n                }\n            },\n            all: function all() {\n                return this.index.all();\n            },\n            clear: function clear() {\n                this.index.reset();\n                return this;\n            },\n            clearPrefetchCache: function clearPrefetchCache() {\n                this.prefetch && this.prefetch.clear();\n                return this;\n            },\n            clearRemoteCache: function clearRemoteCache() {\n                Transport.resetCache();\n                return this;\n            },\n            ttAdapter: function ttAdapter() {\n                return this.__ttAdapter();\n            }\n        });\n        return Bloodhound;\n    }();\n    return Bloodhound;\n});\n\n(function(root, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define([ \"jquery\" ], function(a0) {\n            return factory(a0);\n        });\n    } else if (typeof module === \"object\" && module.exports) {\n        module.exports = factory(require(\"jquery\"));\n    } else {\n        factory(root[\"jQuery\"]);\n    }\n})(this, function($) {\n    var _ = function() {\n        \"use strict\";\n        return {\n            isMsie: function() {\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },\n            isBlankString: function(str) {\n                return !str || /^\\s*$/.test(str);\n            },\n            escapeRegExChars: function(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            },\n            isString: function(obj) {\n                return typeof obj === \"string\";\n            },\n            isNumber: function(obj) {\n                return typeof obj === \"number\";\n            },\n            isArray: $.isArray,\n            isFunction: $.isFunction,\n            isObject: $.isPlainObject,\n            isUndefined: function(obj) {\n                return typeof obj === \"undefined\";\n            },\n            isElement: function(obj) {\n                return !!(obj && obj.nodeType === 1);\n            },\n            isJQuery: function(obj) {\n                return obj instanceof $;\n            },\n            toStr: function toStr(s) {\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\n            },\n            bind: $.proxy,\n            each: function(collection, cb) {\n                $.each(collection, reverseArgs);\n                function reverseArgs(index, value) {\n                    return cb(value, index);\n                }\n            },\n            map: $.map,\n            filter: $.grep,\n            every: function(obj, test) {\n                var result = true;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (!(result = test.call(null, val, key, obj))) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            some: function(obj, test) {\n                var result = false;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (result = test.call(null, val, key, obj)) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            mixin: $.extend,\n            identity: function(x) {\n                return x;\n            },\n            clone: function(obj) {\n                return $.extend(true, {}, obj);\n            },\n            getIdGenerator: function() {\n                var counter = 0;\n                return function() {\n                    return counter++;\n                };\n            },\n            templatify: function templatify(obj) {\n                return $.isFunction(obj) ? obj : template;\n                function template() {\n                    return String(obj);\n                }\n            },\n            defer: function(fn) {\n                setTimeout(fn, 0);\n            },\n            debounce: function(func, wait, immediate) {\n                var timeout, result;\n                return function() {\n                    var context = this, args = arguments, later, callNow;\n                    later = function() {\n                        timeout = null;\n                        if (!immediate) {\n                            result = func.apply(context, args);\n                        }\n                    };\n                    callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) {\n                        result = func.apply(context, args);\n                    }\n                    return result;\n                };\n            },\n            throttle: function(func, wait) {\n                var context, args, timeout, result, previous, later;\n                previous = 0;\n                later = function() {\n                    previous = new Date();\n                    timeout = null;\n                    result = func.apply(context, args);\n                };\n                return function() {\n                    var now = new Date(), remaining = wait - (now - previous);\n                    context = this;\n                    args = arguments;\n                    if (remaining <= 0) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                        previous = now;\n                        result = func.apply(context, args);\n                    } else if (!timeout) {\n                        timeout = setTimeout(later, remaining);\n                    }\n                    return result;\n                };\n            },\n            stringify: function(val) {\n                return _.isString(val) ? val : JSON.stringify(val);\n            },\n            guid: function() {\n                function _p8(s) {\n                    var p = (Math.random().toString(16) + \"000000000\").substr(2, 8);\n                    return s ? \"-\" + p.substr(0, 4) + \"-\" + p.substr(4, 4) : p;\n                }\n                return \"tt-\" + _p8() + _p8(true) + _p8(true) + _p8();\n            },\n            noop: function() {}\n        };\n    }();\n    var WWW = function() {\n        \"use strict\";\n        var defaultClassNames = {\n            wrapper: \"twitter-typeahead\",\n            input: \"tt-input\",\n            hint: \"tt-hint\",\n            menu: \"tt-menu\",\n            dataset: \"tt-dataset\",\n            suggestion: \"tt-suggestion\",\n            selectable: \"tt-selectable\",\n            empty: \"tt-empty\",\n            open: \"tt-open\",\n            cursor: \"tt-cursor\",\n            highlight: \"tt-highlight\"\n        };\n        return build;\n        function build(o) {\n            var www, classes;\n            classes = _.mixin({}, defaultClassNames, o);\n            www = {\n                css: buildCss(),\n                classes: classes,\n                html: buildHtml(classes),\n                selectors: buildSelectors(classes)\n            };\n            return {\n                css: www.css,\n                html: www.html,\n                classes: www.classes,\n                selectors: www.selectors,\n                mixin: function(o) {\n                    _.mixin(o, www);\n                }\n            };\n        }\n        function buildHtml(c) {\n            return {\n                wrapper: '<span class=\"' + c.wrapper + '\"></span>',\n                menu: '<div role=\"listbox\" class=\"' + c.menu + '\"></div>'\n            };\n        }\n        function buildSelectors(classes) {\n            var selectors = {};\n            _.each(classes, function(v, k) {\n                selectors[k] = \".\" + v;\n            });\n            return selectors;\n        }\n        function buildCss() {\n            var css = {\n                wrapper: {\n                    position: \"relative\",\n                    display: \"inline-block\"\n                },\n                hint: {\n                    position: \"absolute\",\n                    top: \"0\",\n                    left: \"0\",\n                    borderColor: \"transparent\",\n                    boxShadow: \"none\",\n                    opacity: \"1\"\n                },\n                input: {\n                    position: \"relative\",\n                    verticalAlign: \"top\",\n                    backgroundColor: \"transparent\"\n                },\n                inputWithNoHint: {\n                    position: \"relative\",\n                    verticalAlign: \"top\"\n                },\n                menu: {\n                    position: \"absolute\",\n                    top: \"100%\",\n                    left: \"0\",\n                    zIndex: \"100\",\n                    display: \"none\"\n                },\n                ltr: {\n                    left: \"0\",\n                    right: \"auto\"\n                },\n                rtl: {\n                    left: \"auto\",\n                    right: \" 0\"\n                }\n            };\n            if (_.isMsie()) {\n                _.mixin(css.input, {\n                    backgroundImage: \"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)\"\n                });\n            }\n            return css;\n        }\n    }();\n    var EventBus = function() {\n        \"use strict\";\n        var namespace, deprecationMap;\n        namespace = \"typeahead:\";\n        deprecationMap = {\n            render: \"rendered\",\n            cursorchange: \"cursorchanged\",\n            select: \"selected\",\n            autocomplete: \"autocompleted\"\n        };\n        function EventBus(o) {\n            if (!o || !o.el) {\n                $.error(\"EventBus initialized without el\");\n            }\n            this.$el = $(o.el);\n        }\n        _.mixin(EventBus.prototype, {\n            _trigger: function(type, args) {\n                var $e = $.Event(namespace + type);\n                this.$el.trigger.call(this.$el, $e, args || []);\n                return $e;\n            },\n            before: function(type) {\n                var args, $e;\n                args = [].slice.call(arguments, 1);\n                $e = this._trigger(\"before\" + type, args);\n                return $e.isDefaultPrevented();\n            },\n            trigger: function(type) {\n                var deprecatedType;\n                this._trigger(type, [].slice.call(arguments, 1));\n                if (deprecatedType = deprecationMap[type]) {\n                    this._trigger(deprecatedType, [].slice.call(arguments, 1));\n                }\n            }\n        });\n        return EventBus;\n    }();\n    var EventEmitter = function() {\n        \"use strict\";\n        var splitter = /\\s+/, nextTick = getNextTick();\n        return {\n            onSync: onSync,\n            onAsync: onAsync,\n            off: off,\n            trigger: trigger\n        };\n        function on(method, types, cb, context) {\n            var type;\n            if (!cb) {\n                return this;\n            }\n            types = types.split(splitter);\n            cb = context ? bindContext(cb, context) : cb;\n            this._callbacks = this._callbacks || {};\n            while (type = types.shift()) {\n                this._callbacks[type] = this._callbacks[type] || {\n                    sync: [],\n                    async: []\n                };\n                this._callbacks[type][method].push(cb);\n            }\n            return this;\n        }\n        function onAsync(types, cb, context) {\n            return on.call(this, \"async\", types, cb, context);\n        }\n        function onSync(types, cb, context) {\n            return on.call(this, \"sync\", types, cb, context);\n        }\n        function off(types) {\n            var type;\n            if (!this._callbacks) {\n                return this;\n            }\n            types = types.split(splitter);\n            while (type = types.shift()) {\n                delete this._callbacks[type];\n            }\n            return this;\n        }\n        function trigger(types) {\n            var type, callbacks, args, syncFlush, asyncFlush;\n            if (!this._callbacks) {\n                return this;\n            }\n            types = types.split(splitter);\n            args = [].slice.call(arguments, 1);\n            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {\n                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));\n                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));\n                syncFlush() && nextTick(asyncFlush);\n            }\n            return this;\n        }\n        function getFlush(callbacks, context, args) {\n            return flush;\n            function flush() {\n                var cancelled;\n                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {\n                    cancelled = callbacks[i].apply(context, args) === false;\n                }\n                return !cancelled;\n            }\n        }\n        function getNextTick() {\n            var nextTickFn;\n            if (window.setImmediate) {\n                nextTickFn = function nextTickSetImmediate(fn) {\n                    setImmediate(function() {\n                        fn();\n                    });\n                };\n            } else {\n                nextTickFn = function nextTickSetTimeout(fn) {\n                    setTimeout(function() {\n                        fn();\n                    }, 0);\n                };\n            }\n            return nextTickFn;\n        }\n        function bindContext(fn, context) {\n            return fn.bind ? fn.bind(context) : function() {\n                fn.apply(context, [].slice.call(arguments, 0));\n            };\n        }\n    }();\n    var highlight = function(doc) {\n        \"use strict\";\n        var defaults = {\n            node: null,\n            pattern: null,\n            tagName: \"strong\",\n            className: null,\n            wordsOnly: false,\n            caseSensitive: false,\n            diacriticInsensitive: false\n        };\n        var accented = {\n            A: \"[AaªÀ-Åà-åĀ-ąǍǎȀ-ȃȦȧᴬᵃḀḁẚẠ-ảₐ℀℁℻⒜Ⓐⓐ㍱-㍴㎀-㎄㎈㎉㎩-㎯㏂㏊㏟㏿Ａａ]\",\n            B: \"[BbᴮᵇḂ-ḇℬ⒝Ⓑⓑ㍴㎅-㎇㏃㏈㏔㏝Ｂｂ]\",\n            C: \"[CcÇçĆ-čᶜ℀ℂ℃℅℆ℭⅭⅽ⒞Ⓒⓒ㍶㎈㎉㎝㎠㎤㏄-㏇Ｃｃ]\",\n            D: \"[DdĎďǄ-ǆǱ-ǳᴰᵈḊ-ḓⅅⅆⅮⅾ⒟Ⓓⓓ㋏㍲㍷-㍹㎗㎭-㎯㏅㏈Ｄｄ]\",\n            E: \"[EeÈ-Ëè-ëĒ-ěȄ-ȇȨȩᴱᵉḘ-ḛẸ-ẽₑ℡ℯℰⅇ⒠Ⓔⓔ㉐㋍㋎Ｅｅ]\",\n            F: \"[FfᶠḞḟ℉ℱ℻⒡Ⓕⓕ㎊-㎌㎙ﬀ-ﬄＦｆ]\",\n            G: \"[GgĜ-ģǦǧǴǵᴳᵍḠḡℊ⒢Ⓖⓖ㋌㋍㎇㎍-㎏㎓㎬㏆㏉㏒㏿Ｇｇ]\",\n            H: \"[HhĤĥȞȟʰᴴḢ-ḫẖℋ-ℎ⒣Ⓗⓗ㋌㍱㎐-㎔㏊㏋㏗Ｈｈ]\",\n            I: \"[IiÌ-Ïì-ïĨ-İĲĳǏǐȈ-ȋᴵᵢḬḭỈ-ịⁱℐℑℹⅈⅠ-ⅣⅥ-ⅨⅪⅫⅰ-ⅳⅵ-ⅸⅺⅻ⒤Ⓘⓘ㍺㏌㏕ﬁﬃＩｉ]\",\n            J: \"[JjĲ-ĵǇ-ǌǰʲᴶⅉ⒥ⒿⓙⱼＪｊ]\",\n            K: \"[KkĶķǨǩᴷᵏḰ-ḵK⒦Ⓚⓚ㎄㎅㎉㎏㎑㎘㎞㎢㎦㎪㎸㎾㏀㏆㏍-㏏Ｋｋ]\",\n            L: \"[LlĹ-ŀǇ-ǉˡᴸḶḷḺ-ḽℒℓ℡Ⅼⅼ⒧Ⓛⓛ㋏㎈㎉㏐-㏓㏕㏖㏿ﬂﬄＬｌ]\",\n            M: \"[MmᴹᵐḾ-ṃ℠™ℳⅯⅿ⒨Ⓜⓜ㍷-㍹㎃㎆㎎㎒㎖㎙-㎨㎫㎳㎷㎹㎽㎿㏁㏂㏎㏐㏔-㏖㏘㏙㏞㏟Ｍｍ]\",\n            N: \"[NnÑñŃ-ŉǊ-ǌǸǹᴺṄ-ṋⁿℕ№⒩Ⓝⓝ㎁㎋㎚㎱㎵㎻㏌㏑Ｎｎ]\",\n            O: \"[OoºÒ-Öò-öŌ-őƠơǑǒǪǫȌ-ȏȮȯᴼᵒỌ-ỏₒ℅№ℴ⒪Ⓞⓞ㍵㏇㏒㏖Ｏｏ]\",\n            P: \"[PpᴾᵖṔ-ṗℙ⒫Ⓟⓟ㉐㍱㍶㎀㎊㎩-㎬㎰㎴㎺㏋㏗-㏚Ｐｐ]\",\n            Q: \"[Qqℚ⒬Ⓠⓠ㏃Ｑｑ]\",\n            R: \"[RrŔ-řȐ-ȓʳᴿᵣṘ-ṛṞṟ₨ℛ-ℝ⒭Ⓡⓡ㋍㍴㎭-㎯㏚㏛Ｒｒ]\",\n            S: \"[SsŚ-šſȘșˢṠ-ṣ₨℁℠⒮Ⓢⓢ㎧㎨㎮-㎳㏛㏜ﬆＳｓ]\",\n            T: \"[TtŢ-ťȚțᵀᵗṪ-ṱẗ℡™⒯Ⓣⓣ㉐㋏㎔㏏ﬅﬆＴｔ]\",\n            U: \"[UuÙ-Üù-üŨ-ųƯưǓǔȔ-ȗᵁᵘᵤṲ-ṷỤ-ủ℆⒰Ⓤⓤ㍳㍺Ｕｕ]\",\n            V: \"[VvᵛᵥṼ-ṿⅣ-Ⅷⅳ-ⅷ⒱Ⓥⓥⱽ㋎㍵㎴-㎹㏜㏞Ｖｖ]\",\n            W: \"[WwŴŵʷᵂẀ-ẉẘ⒲Ⓦⓦ㎺-㎿㏝Ｗｗ]\",\n            X: \"[XxˣẊ-ẍₓ℻Ⅸ-Ⅻⅸ-ⅻ⒳Ⓧⓧ㏓Ｘｘ]\",\n            Y: \"[YyÝýÿŶ-ŸȲȳʸẎẏẙỲ-ỹ⒴Ⓨⓨ㏉Ｙｙ]\",\n            Z: \"[ZzŹ-žǱ-ǳᶻẐ-ẕℤℨ⒵Ⓩⓩ㎐-㎔Ｚｚ]\"\n        };\n        return function hightlight(o) {\n            var regex;\n            o = _.mixin({}, defaults, o);\n            if (!o.node || !o.pattern) {\n                return;\n            }\n            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];\n            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly, o.diacriticInsensitive);\n            traverse(o.node, hightlightTextNode);\n            function hightlightTextNode(textNode) {\n                var match, patternNode, wrapperNode;\n                if (match = regex.exec(textNode.data)) {\n                    wrapperNode = doc.createElement(o.tagName);\n                    o.className && (wrapperNode.className = o.className);\n                    patternNode = textNode.splitText(match.index);\n                    patternNode.splitText(match[0].length);\n                    wrapperNode.appendChild(patternNode.cloneNode(true));\n                    textNode.parentNode.replaceChild(wrapperNode, patternNode);\n                }\n                return !!match;\n            }\n            function traverse(el, hightlightTextNode) {\n                var childNode, TEXT_NODE_TYPE = 3;\n                for (var i = 0; i < el.childNodes.length; i++) {\n                    childNode = el.childNodes[i];\n                    if (childNode.nodeType === TEXT_NODE_TYPE) {\n                        i += hightlightTextNode(childNode) ? 1 : 0;\n                    } else {\n                        traverse(childNode, hightlightTextNode);\n                    }\n                }\n            }\n        };\n        function accent_replacer(chr) {\n            return accented[chr.toUpperCase()] || chr;\n        }\n        function getRegex(patterns, caseSensitive, wordsOnly, diacriticInsensitive) {\n            var escapedPatterns = [], regexStr;\n            for (var i = 0, len = patterns.length; i < len; i++) {\n                var escapedWord = _.escapeRegExChars(patterns[i]);\n                if (diacriticInsensitive) {\n                    escapedWord = escapedWord.replace(/\\S/g, accent_replacer);\n                }\n                escapedPatterns.push(escapedWord);\n            }\n            regexStr = wordsOnly ? \"\\\\b(\" + escapedPatterns.join(\"|\") + \")\\\\b\" : \"(\" + escapedPatterns.join(\"|\") + \")\";\n            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, \"i\");\n        }\n    }(window.document);\n    var Input = function() {\n        \"use strict\";\n        var specialKeyCodeMap;\n        specialKeyCodeMap = {\n            9: \"tab\",\n            27: \"esc\",\n            37: \"left\",\n            39: \"right\",\n            13: \"enter\",\n            38: \"up\",\n            40: \"down\"\n        };\n        function Input(o, www) {\n            var id;\n            o = o || {};\n            if (!o.input) {\n                $.error(\"input is missing\");\n            }\n            www.mixin(this);\n            this.$hint = $(o.hint);\n            this.$input = $(o.input);\n            this.$menu = $(o.menu);\n            id = this.$input.attr(\"id\") || _.guid();\n            this.$menu.attr(\"id\", id + \"_listbox\");\n            this.$hint.attr({\n                \"aria-hidden\": true\n            });\n            this.$input.attr({\n                \"aria-owns\": id + \"_listbox\",\n                role: \"combobox\",\n                \"aria-autocomplete\": \"list\",\n                \"aria-expanded\": false\n            });\n            this.query = this.$input.val();\n            this.queryWhenFocused = this.hasFocus() ? this.query : null;\n            this.$overflowHelper = buildOverflowHelper(this.$input);\n            this._checkLanguageDirection();\n            if (this.$hint.length === 0) {\n                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;\n            }\n            this.onSync(\"cursorchange\", this._updateDescendent);\n        }\n        Input.normalizeQuery = function(str) {\n            return _.toStr(str).replace(/^\\s*/g, \"\").replace(/\\s{2,}/g, \" \");\n        };\n        _.mixin(Input.prototype, EventEmitter, {\n            _onBlur: function onBlur() {\n                this.resetInputValue();\n                this.trigger(\"blurred\");\n            },\n            _onFocus: function onFocus() {\n                this.queryWhenFocused = this.query;\n                this.trigger(\"focused\");\n            },\n            _onKeydown: function onKeydown($e) {\n                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];\n                this._managePreventDefault(keyName, $e);\n                if (keyName && this._shouldTrigger(keyName, $e)) {\n                    this.trigger(keyName + \"Keyed\", $e);\n                }\n            },\n            _onInput: function onInput() {\n                this._setQuery(this.getInputValue());\n                this.clearHintIfInvalid();\n                this._checkLanguageDirection();\n            },\n            _managePreventDefault: function managePreventDefault(keyName, $e) {\n                var preventDefault;\n                switch (keyName) {\n                  case \"up\":\n                  case \"down\":\n                    preventDefault = !withModifier($e);\n                    break;\n\n                  default:\n                    preventDefault = false;\n                }\n                preventDefault && $e.preventDefault();\n            },\n            _shouldTrigger: function shouldTrigger(keyName, $e) {\n                var trigger;\n                switch (keyName) {\n                  case \"tab\":\n                    trigger = !withModifier($e);\n                    break;\n\n                  default:\n                    trigger = true;\n                }\n                return trigger;\n            },\n            _checkLanguageDirection: function checkLanguageDirection() {\n                var dir = (this.$input.css(\"direction\") || \"ltr\").toLowerCase();\n                if (this.dir !== dir) {\n                    this.dir = dir;\n                    this.$hint.attr(\"dir\", dir);\n                    this.trigger(\"langDirChanged\", dir);\n                }\n            },\n            _setQuery: function setQuery(val, silent) {\n                var areEquivalent, hasDifferentWhitespace;\n                areEquivalent = areQueriesEquivalent(val, this.query);\n                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;\n                this.query = val;\n                if (!silent && !areEquivalent) {\n                    this.trigger(\"queryChanged\", this.query);\n                } else if (!silent && hasDifferentWhitespace) {\n                    this.trigger(\"whitespaceChanged\", this.query);\n                }\n            },\n            _updateDescendent: function updateDescendent(event, id) {\n                this.$input.attr(\"aria-activedescendant\", id);\n            },\n            bind: function() {\n                var that = this, onBlur, onFocus, onKeydown, onInput;\n                onBlur = _.bind(this._onBlur, this);\n                onFocus = _.bind(this._onFocus, this);\n                onKeydown = _.bind(this._onKeydown, this);\n                onInput = _.bind(this._onInput, this);\n                this.$input.on(\"blur.tt\", onBlur).on(\"focus.tt\", onFocus).on(\"keydown.tt\", onKeydown);\n                if (!_.isMsie() || _.isMsie() > 9) {\n                    this.$input.on(\"input.tt\", onInput);\n                } else {\n                    this.$input.on(\"keydown.tt keypress.tt cut.tt paste.tt\", function($e) {\n                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {\n                            return;\n                        }\n                        _.defer(_.bind(that._onInput, that, $e));\n                    });\n                }\n                return this;\n            },\n            focus: function focus() {\n                this.$input.focus();\n            },\n            blur: function blur() {\n                this.$input.blur();\n            },\n            getLangDir: function getLangDir() {\n                return this.dir;\n            },\n            getQuery: function getQuery() {\n                return this.query || \"\";\n            },\n            setQuery: function setQuery(val, silent) {\n                this.setInputValue(val);\n                this._setQuery(val, silent);\n            },\n            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {\n                return this.query !== this.queryWhenFocused;\n            },\n            getInputValue: function getInputValue() {\n                return this.$input.val();\n            },\n            setInputValue: function setInputValue(value) {\n                this.$input.val(value);\n                this.clearHintIfInvalid();\n                this._checkLanguageDirection();\n            },\n            resetInputValue: function resetInputValue() {\n                this.setInputValue(this.query);\n            },\n            getHint: function getHint() {\n                return this.$hint.val();\n            },\n            setHint: function setHint(value) {\n                this.$hint.val(value);\n            },\n            clearHint: function clearHint() {\n                this.setHint(\"\");\n            },\n            clearHintIfInvalid: function clearHintIfInvalid() {\n                var val, hint, valIsPrefixOfHint, isValid;\n                val = this.getInputValue();\n                hint = this.getHint();\n                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;\n                isValid = val !== \"\" && valIsPrefixOfHint && !this.hasOverflow();\n                !isValid && this.clearHint();\n            },\n            hasFocus: function hasFocus() {\n                return this.$input.is(\":focus\");\n            },\n            hasOverflow: function hasOverflow() {\n                var constraint = this.$input.width() - 2;\n                this.$overflowHelper.text(this.getInputValue());\n                return this.$overflowHelper.width() >= constraint;\n            },\n            isCursorAtEnd: function() {\n                var valueLength, selectionStart, range;\n                valueLength = this.$input.val().length;\n                selectionStart = this.$input[0].selectionStart;\n                if (_.isNumber(selectionStart)) {\n                    return selectionStart === valueLength;\n                } else if (document.selection) {\n                    range = document.selection.createRange();\n                    range.moveStart(\"character\", -valueLength);\n                    return valueLength === range.text.length;\n                }\n                return true;\n            },\n            destroy: function destroy() {\n                this.$hint.off(\".tt\");\n                this.$input.off(\".tt\");\n                this.$overflowHelper.remove();\n                this.$hint = this.$input = this.$overflowHelper = $(\"<div>\");\n            },\n            setAriaExpanded: function setAriaExpanded(value) {\n                this.$input.attr(\"aria-expanded\", value);\n            }\n        });\n        return Input;\n        function buildOverflowHelper($input) {\n            return $('<pre aria-hidden=\"true\"></pre>').css({\n                position: \"absolute\",\n                visibility: \"hidden\",\n                whiteSpace: \"pre\",\n                fontFamily: $input.css(\"font-family\"),\n                fontSize: $input.css(\"font-size\"),\n                fontStyle: $input.css(\"font-style\"),\n                fontVariant: $input.css(\"font-variant\"),\n                fontWeight: $input.css(\"font-weight\"),\n                wordSpacing: $input.css(\"word-spacing\"),\n                letterSpacing: $input.css(\"letter-spacing\"),\n                textIndent: $input.css(\"text-indent\"),\n                textRendering: $input.css(\"text-rendering\"),\n                textTransform: $input.css(\"text-transform\")\n            }).insertAfter($input);\n        }\n        function areQueriesEquivalent(a, b) {\n            return Input.normalizeQuery(a) === Input.normalizeQuery(b);\n        }\n        function withModifier($e) {\n            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;\n        }\n    }();\n    var Dataset = function() {\n        \"use strict\";\n        var keys, nameGenerator;\n        keys = {\n            dataset: \"tt-selectable-dataset\",\n            val: \"tt-selectable-display\",\n            obj: \"tt-selectable-object\"\n        };\n        nameGenerator = _.getIdGenerator();\n        function Dataset(o, www) {\n            o = o || {};\n            o.templates = o.templates || {};\n            o.templates.notFound = o.templates.notFound || o.templates.empty;\n            if (!o.source) {\n                $.error(\"missing source\");\n            }\n            if (!o.node) {\n                $.error(\"missing node\");\n            }\n            if (o.name && !isValidName(o.name)) {\n                $.error(\"invalid dataset name: \" + o.name);\n            }\n            www.mixin(this);\n            this.highlight = !!o.highlight;\n            this.name = _.toStr(o.name || nameGenerator());\n            this.limit = o.limit || 5;\n            this.displayFn = getDisplayFn(o.display || o.displayKey);\n            this.templates = getTemplates(o.templates, this.displayFn);\n            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;\n            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;\n            this._resetLastSuggestion();\n            this.$el = $(o.node).attr(\"role\", \"presentation\").addClass(this.classes.dataset).addClass(this.classes.dataset + \"-\" + this.name);\n        }\n        Dataset.extractData = function extractData(el) {\n            var $el = $(el);\n            if ($el.data(keys.obj)) {\n                return {\n                    dataset: $el.data(keys.dataset) || \"\",\n                    val: $el.data(keys.val) || \"\",\n                    obj: $el.data(keys.obj) || null\n                };\n            }\n            return null;\n        };\n        _.mixin(Dataset.prototype, EventEmitter, {\n            _overwrite: function overwrite(query, suggestions) {\n                suggestions = suggestions || [];\n                if (suggestions.length) {\n                    this._renderSuggestions(query, suggestions);\n                } else if (this.async && this.templates.pending) {\n                    this._renderPending(query);\n                } else if (!this.async && this.templates.notFound) {\n                    this._renderNotFound(query);\n                } else {\n                    this._empty();\n                }\n                this.trigger(\"rendered\", suggestions, false, this.name);\n            },\n            _append: function append(query, suggestions) {\n                suggestions = suggestions || [];\n                if (suggestions.length && this.$lastSuggestion.length) {\n                    this._appendSuggestions(query, suggestions);\n                } else if (suggestions.length) {\n                    this._renderSuggestions(query, suggestions);\n                } else if (!this.$lastSuggestion.length && this.templates.notFound) {\n                    this._renderNotFound(query);\n                }\n                this.trigger(\"rendered\", suggestions, true, this.name);\n            },\n            _renderSuggestions: function renderSuggestions(query, suggestions) {\n                var $fragment;\n                $fragment = this._getSuggestionsFragment(query, suggestions);\n                this.$lastSuggestion = $fragment.children().last();\n                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));\n            },\n            _appendSuggestions: function appendSuggestions(query, suggestions) {\n                var $fragment, $lastSuggestion;\n                $fragment = this._getSuggestionsFragment(query, suggestions);\n                $lastSuggestion = $fragment.children().last();\n                this.$lastSuggestion.after($fragment);\n                this.$lastSuggestion = $lastSuggestion;\n            },\n            _renderPending: function renderPending(query) {\n                var template = this.templates.pending;\n                this._resetLastSuggestion();\n                template && this.$el.html(template({\n                    query: query,\n                    dataset: this.name\n                }));\n            },\n            _renderNotFound: function renderNotFound(query) {\n                var template = this.templates.notFound;\n                this._resetLastSuggestion();\n                template && this.$el.html(template({\n                    query: query,\n                    dataset: this.name\n                }));\n            },\n            _empty: function empty() {\n                this.$el.empty();\n                this._resetLastSuggestion();\n            },\n            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {\n                var that = this, fragment;\n                fragment = document.createDocumentFragment();\n                _.each(suggestions, function getSuggestionNode(suggestion) {\n                    var $el, context;\n                    context = that._injectQuery(query, suggestion);\n                    $el = $(that.templates.suggestion(context)).data(keys.dataset, that.name).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + \" \" + that.classes.selectable);\n                    fragment.appendChild($el[0]);\n                });\n                this.highlight && highlight({\n                    className: this.classes.highlight,\n                    node: fragment,\n                    pattern: query\n                });\n                return $(fragment);\n            },\n            _getFooter: function getFooter(query, suggestions) {\n                return this.templates.footer ? this.templates.footer({\n                    query: query,\n                    suggestions: suggestions,\n                    dataset: this.name\n                }) : null;\n            },\n            _getHeader: function getHeader(query, suggestions) {\n                return this.templates.header ? this.templates.header({\n                    query: query,\n                    suggestions: suggestions,\n                    dataset: this.name\n                }) : null;\n            },\n            _resetLastSuggestion: function resetLastSuggestion() {\n                this.$lastSuggestion = $();\n            },\n            _injectQuery: function injectQuery(query, obj) {\n                return _.isObject(obj) ? _.mixin({\n                    _query: query\n                }, obj) : obj;\n            },\n            update: function update(query) {\n                var that = this, canceled = false, syncCalled = false, rendered = 0;\n                this.cancel();\n                this.cancel = function cancel() {\n                    canceled = true;\n                    that.cancel = $.noop;\n                    that.async && that.trigger(\"asyncCanceled\", query, that.name);\n                };\n                this.source(query, sync, async);\n                !syncCalled && sync([]);\n                function sync(suggestions) {\n                    if (syncCalled) {\n                        return;\n                    }\n                    syncCalled = true;\n                    suggestions = (suggestions || []).slice(0, that.limit);\n                    rendered = suggestions.length;\n                    that._overwrite(query, suggestions);\n                    if (rendered < that.limit && that.async) {\n                        that.trigger(\"asyncRequested\", query, that.name);\n                    }\n                }\n                function async(suggestions) {\n                    suggestions = suggestions || [];\n                    if (!canceled && rendered < that.limit) {\n                        that.cancel = $.noop;\n                        var idx = Math.abs(rendered - that.limit);\n                        rendered += idx;\n                        that._append(query, suggestions.slice(0, idx));\n                        that.async && that.trigger(\"asyncReceived\", query, that.name);\n                    }\n                }\n            },\n            cancel: $.noop,\n            clear: function clear() {\n                this._empty();\n                this.cancel();\n                this.trigger(\"cleared\");\n            },\n            isEmpty: function isEmpty() {\n                return this.$el.is(\":empty\");\n            },\n            destroy: function destroy() {\n                this.$el = $(\"<div>\");\n            }\n        });\n        return Dataset;\n        function getDisplayFn(display) {\n            display = display || _.stringify;\n            return _.isFunction(display) ? display : displayFn;\n            function displayFn(obj) {\n                return obj[display];\n            }\n        }\n        function getTemplates(templates, displayFn) {\n            return {\n                notFound: templates.notFound && _.templatify(templates.notFound),\n                pending: templates.pending && _.templatify(templates.pending),\n                header: templates.header && _.templatify(templates.header),\n                footer: templates.footer && _.templatify(templates.footer),\n                suggestion: templates.suggestion ? userSuggestionTemplate : suggestionTemplate\n            };\n            function userSuggestionTemplate(context) {\n                var template = templates.suggestion;\n                return $(template(context)).attr(\"id\", _.guid());\n            }\n            function suggestionTemplate(context) {\n                return $('<div role=\"option\">').attr(\"id\", _.guid()).text(displayFn(context));\n            }\n        }\n        function isValidName(str) {\n            return /^[_a-zA-Z0-9-]+$/.test(str);\n        }\n    }();\n    var Menu = function() {\n        \"use strict\";\n        function Menu(o, www) {\n            var that = this;\n            o = o || {};\n            if (!o.node) {\n                $.error(\"node is required\");\n            }\n            www.mixin(this);\n            this.$node = $(o.node);\n            this.query = null;\n            this.datasets = _.map(o.datasets, initializeDataset);\n            function initializeDataset(oDataset) {\n                var node = that.$node.find(oDataset.node).first();\n                oDataset.node = node.length ? node : $(\"<div>\").appendTo(that.$node);\n                return new Dataset(oDataset, www);\n            }\n        }\n        _.mixin(Menu.prototype, EventEmitter, {\n            _onSelectableClick: function onSelectableClick($e) {\n                this.trigger(\"selectableClicked\", $($e.currentTarget));\n            },\n            _onRendered: function onRendered(type, dataset, suggestions, async) {\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\n                this.trigger(\"datasetRendered\", dataset, suggestions, async);\n            },\n            _onCleared: function onCleared() {\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\n                this.trigger(\"datasetCleared\");\n            },\n            _propagate: function propagate() {\n                this.trigger.apply(this, arguments);\n            },\n            _allDatasetsEmpty: function allDatasetsEmpty() {\n                return _.every(this.datasets, _.bind(function isDatasetEmpty(dataset) {\n                    var isEmpty = dataset.isEmpty();\n                    this.$node.attr(\"aria-expanded\", !isEmpty);\n                    return isEmpty;\n                }, this));\n            },\n            _getSelectables: function getSelectables() {\n                return this.$node.find(this.selectors.selectable);\n            },\n            _removeCursor: function _removeCursor() {\n                var $selectable = this.getActiveSelectable();\n                $selectable && $selectable.removeClass(this.classes.cursor);\n            },\n            _ensureVisible: function ensureVisible($el) {\n                var elTop, elBottom, nodeScrollTop, nodeHeight;\n                elTop = $el.position().top;\n                elBottom = elTop + $el.outerHeight(true);\n                nodeScrollTop = this.$node.scrollTop();\n                nodeHeight = this.$node.height() + parseInt(this.$node.css(\"paddingTop\"), 10) + parseInt(this.$node.css(\"paddingBottom\"), 10);\n                if (elTop < 0) {\n                    this.$node.scrollTop(nodeScrollTop + elTop);\n                } else if (nodeHeight < elBottom) {\n                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));\n                }\n            },\n            bind: function() {\n                var that = this, onSelectableClick;\n                onSelectableClick = _.bind(this._onSelectableClick, this);\n                this.$node.on(\"click.tt\", this.selectors.selectable, onSelectableClick);\n                this.$node.on(\"mouseover\", this.selectors.selectable, function() {\n                    that.setCursor($(this));\n                });\n                this.$node.on(\"mouseleave\", function() {\n                    that._removeCursor();\n                });\n                _.each(this.datasets, function(dataset) {\n                    dataset.onSync(\"asyncRequested\", that._propagate, that).onSync(\"asyncCanceled\", that._propagate, that).onSync(\"asyncReceived\", that._propagate, that).onSync(\"rendered\", that._onRendered, that).onSync(\"cleared\", that._onCleared, that);\n                });\n                return this;\n            },\n            isOpen: function isOpen() {\n                return this.$node.hasClass(this.classes.open);\n            },\n            open: function open() {\n                this.$node.scrollTop(0);\n                this.$node.addClass(this.classes.open);\n            },\n            close: function close() {\n                this.$node.attr(\"aria-expanded\", false);\n                this.$node.removeClass(this.classes.open);\n                this._removeCursor();\n            },\n            setLanguageDirection: function setLanguageDirection(dir) {\n                this.$node.attr(\"dir\", dir);\n            },\n            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {\n                var $selectables, $oldCursor, oldIndex, newIndex;\n                $oldCursor = this.getActiveSelectable();\n                $selectables = this._getSelectables();\n                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;\n                newIndex = oldIndex + delta;\n                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;\n                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;\n                return newIndex === -1 ? null : $selectables.eq(newIndex);\n            },\n            setCursor: function setCursor($selectable) {\n                this._removeCursor();\n                if ($selectable = $selectable && $selectable.first()) {\n                    $selectable.addClass(this.classes.cursor);\n                    this._ensureVisible($selectable);\n                }\n            },\n            getSelectableData: function getSelectableData($el) {\n                return $el && $el.length ? Dataset.extractData($el) : null;\n            },\n            getActiveSelectable: function getActiveSelectable() {\n                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();\n                return $selectable.length ? $selectable : null;\n            },\n            getTopSelectable: function getTopSelectable() {\n                var $selectable = this._getSelectables().first();\n                return $selectable.length ? $selectable : null;\n            },\n            update: function update(query) {\n                var isValidUpdate = query !== this.query;\n                if (isValidUpdate) {\n                    this.query = query;\n                    _.each(this.datasets, updateDataset);\n                }\n                return isValidUpdate;\n                function updateDataset(dataset) {\n                    dataset.update(query);\n                }\n            },\n            empty: function empty() {\n                _.each(this.datasets, clearDataset);\n                this.query = null;\n                this.$node.addClass(this.classes.empty);\n                function clearDataset(dataset) {\n                    dataset.clear();\n                }\n            },\n            destroy: function destroy() {\n                this.$node.off(\".tt\");\n                this.$node = $(\"<div>\");\n                _.each(this.datasets, destroyDataset);\n                function destroyDataset(dataset) {\n                    dataset.destroy();\n                }\n            }\n        });\n        return Menu;\n    }();\n    var Status = function() {\n        \"use strict\";\n        function Status(options) {\n            this.$el = $(\"<span></span>\", {\n                role: \"status\",\n                \"aria-live\": \"polite\"\n            }).css({\n                position: \"absolute\",\n                padding: \"0\",\n                border: \"0\",\n                height: \"1px\",\n                width: \"1px\",\n                \"margin-bottom\": \"-1px\",\n                \"margin-right\": \"-1px\",\n                overflow: \"hidden\",\n                clip: \"rect(0 0 0 0)\",\n                \"white-space\": \"nowrap\"\n            });\n            options.$input.after(this.$el);\n            _.each(options.menu.datasets, _.bind(function(dataset) {\n                if (dataset.onSync) {\n                    dataset.onSync(\"rendered\", _.bind(this.update, this));\n                    dataset.onSync(\"cleared\", _.bind(this.cleared, this));\n                }\n            }, this));\n        }\n        _.mixin(Status.prototype, {\n            update: function update(event, suggestions) {\n                var length = suggestions.length;\n                var words;\n                if (length === 1) {\n                    words = {\n                        result: \"result\",\n                        is: \"is\"\n                    };\n                } else {\n                    words = {\n                        result: \"results\",\n                        is: \"are\"\n                    };\n                }\n                this.$el.text(length + \" \" + words.result + \" \" + words.is + \" available, use up and down arrow keys to navigate.\");\n            },\n            cleared: function() {\n                this.$el.text(\"\");\n            }\n        });\n        return Status;\n    }();\n    var DefaultMenu = function() {\n        \"use strict\";\n        var s = Menu.prototype;\n        function DefaultMenu() {\n            Menu.apply(this, [].slice.call(arguments, 0));\n        }\n        _.mixin(DefaultMenu.prototype, Menu.prototype, {\n            open: function open() {\n                !this._allDatasetsEmpty() && this._show();\n                return s.open.apply(this, [].slice.call(arguments, 0));\n            },\n            close: function close() {\n                this._hide();\n                return s.close.apply(this, [].slice.call(arguments, 0));\n            },\n            _onRendered: function onRendered() {\n                if (this._allDatasetsEmpty()) {\n                    this._hide();\n                } else {\n                    this.isOpen() && this._show();\n                }\n                return s._onRendered.apply(this, [].slice.call(arguments, 0));\n            },\n            _onCleared: function onCleared() {\n                if (this._allDatasetsEmpty()) {\n                    this._hide();\n                } else {\n                    this.isOpen() && this._show();\n                }\n                return s._onCleared.apply(this, [].slice.call(arguments, 0));\n            },\n            setLanguageDirection: function setLanguageDirection(dir) {\n                this.$node.css(dir === \"ltr\" ? this.css.ltr : this.css.rtl);\n                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));\n            },\n            _hide: function hide() {\n                this.$node.hide();\n            },\n            _show: function show() {\n                this.$node.css(\"display\", \"block\");\n            }\n        });\n        return DefaultMenu;\n    }();\n    var Typeahead = function() {\n        \"use strict\";\n        function Typeahead(o, www) {\n            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;\n            o = o || {};\n            if (!o.input) {\n                $.error(\"missing input\");\n            }\n            if (!o.menu) {\n                $.error(\"missing menu\");\n            }\n            if (!o.eventBus) {\n                $.error(\"missing event bus\");\n            }\n            www.mixin(this);\n            this.eventBus = o.eventBus;\n            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;\n            this.input = o.input;\n            this.menu = o.menu;\n            this.enabled = true;\n            this.autoselect = !!o.autoselect;\n            this.active = false;\n            this.input.hasFocus() && this.activate();\n            this.dir = this.input.getLangDir();\n            this._hacks();\n            this.menu.bind().onSync(\"selectableClicked\", this._onSelectableClicked, this).onSync(\"asyncRequested\", this._onAsyncRequested, this).onSync(\"asyncCanceled\", this._onAsyncCanceled, this).onSync(\"asyncReceived\", this._onAsyncReceived, this).onSync(\"datasetRendered\", this._onDatasetRendered, this).onSync(\"datasetCleared\", this._onDatasetCleared, this);\n            onFocused = c(this, \"activate\", \"open\", \"_onFocused\");\n            onBlurred = c(this, \"deactivate\", \"_onBlurred\");\n            onEnterKeyed = c(this, \"isActive\", \"isOpen\", \"_onEnterKeyed\");\n            onTabKeyed = c(this, \"isActive\", \"isOpen\", \"_onTabKeyed\");\n            onEscKeyed = c(this, \"isActive\", \"_onEscKeyed\");\n            onUpKeyed = c(this, \"isActive\", \"open\", \"_onUpKeyed\");\n            onDownKeyed = c(this, \"isActive\", \"open\", \"_onDownKeyed\");\n            onLeftKeyed = c(this, \"isActive\", \"isOpen\", \"_onLeftKeyed\");\n            onRightKeyed = c(this, \"isActive\", \"isOpen\", \"_onRightKeyed\");\n            onQueryChanged = c(this, \"_openIfActive\", \"_onQueryChanged\");\n            onWhitespaceChanged = c(this, \"_openIfActive\", \"_onWhitespaceChanged\");\n            this.input.bind().onSync(\"focused\", onFocused, this).onSync(\"blurred\", onBlurred, this).onSync(\"enterKeyed\", onEnterKeyed, this).onSync(\"tabKeyed\", onTabKeyed, this).onSync(\"escKeyed\", onEscKeyed, this).onSync(\"upKeyed\", onUpKeyed, this).onSync(\"downKeyed\", onDownKeyed, this).onSync(\"leftKeyed\", onLeftKeyed, this).onSync(\"rightKeyed\", onRightKeyed, this).onSync(\"queryChanged\", onQueryChanged, this).onSync(\"whitespaceChanged\", onWhitespaceChanged, this).onSync(\"langDirChanged\", this._onLangDirChanged, this);\n        }\n        _.mixin(Typeahead.prototype, {\n            _hacks: function hacks() {\n                var $input, $menu;\n                $input = this.input.$input || $(\"<div>\");\n                $menu = this.menu.$node || $(\"<div>\");\n                $input.on(\"blur.tt\", function($e) {\n                    var active, isActive, hasActive;\n                    active = document.activeElement;\n                    isActive = $menu.is(active);\n                    hasActive = $menu.has(active).length > 0;\n                    if (_.isMsie() && (isActive || hasActive)) {\n                        $e.preventDefault();\n                        $e.stopImmediatePropagation();\n                        _.defer(function() {\n                            $input.focus();\n                        });\n                    }\n                });\n                $menu.on(\"mousedown.tt\", function($e) {\n                    $e.preventDefault();\n                });\n            },\n            _onSelectableClicked: function onSelectableClicked(type, $el) {\n                this.select($el);\n            },\n            _onDatasetCleared: function onDatasetCleared() {\n                this._updateHint();\n            },\n            _onDatasetRendered: function onDatasetRendered(type, suggestions, async, dataset) {\n                this._updateHint();\n                if (this.autoselect) {\n                    var cursorClass = this.selectors.cursor.substr(1);\n                    this.menu.$node.find(this.selectors.suggestion).first().addClass(cursorClass);\n                }\n                this.eventBus.trigger(\"render\", suggestions, async, dataset);\n            },\n            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {\n                this.eventBus.trigger(\"asyncrequest\", query, dataset);\n            },\n            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {\n                this.eventBus.trigger(\"asynccancel\", query, dataset);\n            },\n            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {\n                this.eventBus.trigger(\"asyncreceive\", query, dataset);\n            },\n            _onFocused: function onFocused() {\n                this._minLengthMet() && this.menu.update(this.input.getQuery());\n            },\n            _onBlurred: function onBlurred() {\n                if (this.input.hasQueryChangedSinceLastFocus()) {\n                    this.eventBus.trigger(\"change\", this.input.getQuery());\n                }\n            },\n            _onEnterKeyed: function onEnterKeyed(type, $e) {\n                var $selectable;\n                if ($selectable = this.menu.getActiveSelectable()) {\n                    if (this.select($selectable)) {\n                        $e.preventDefault();\n                        $e.stopPropagation();\n                    }\n                } else if (this.autoselect) {\n                    if (this.select(this.menu.getTopSelectable())) {\n                        $e.preventDefault();\n                        $e.stopPropagation();\n                    }\n                }\n            },\n            _onTabKeyed: function onTabKeyed(type, $e) {\n                var $selectable;\n                if ($selectable = this.menu.getActiveSelectable()) {\n                    this.select($selectable) && $e.preventDefault();\n                } else if (this.autoselect) {\n                    if ($selectable = this.menu.getTopSelectable()) {\n                        this.autocomplete($selectable) && $e.preventDefault();\n                    }\n                }\n            },\n            _onEscKeyed: function onEscKeyed() {\n                this.close();\n            },\n            _onUpKeyed: function onUpKeyed() {\n                this.moveCursor(-1);\n            },\n            _onDownKeyed: function onDownKeyed() {\n                this.moveCursor(+1);\n            },\n            _onLeftKeyed: function onLeftKeyed() {\n                if (this.dir === \"rtl\" && this.input.isCursorAtEnd()) {\n                    this.autocomplete(this.menu.getActiveSelectable() || this.menu.getTopSelectable());\n                }\n            },\n            _onRightKeyed: function onRightKeyed() {\n                if (this.dir === \"ltr\" && this.input.isCursorAtEnd()) {\n                    this.autocomplete(this.menu.getActiveSelectable() || this.menu.getTopSelectable());\n                }\n            },\n            _onQueryChanged: function onQueryChanged(e, query) {\n                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();\n            },\n            _onWhitespaceChanged: function onWhitespaceChanged() {\n                this._updateHint();\n            },\n            _onLangDirChanged: function onLangDirChanged(e, dir) {\n                if (this.dir !== dir) {\n                    this.dir = dir;\n                    this.menu.setLanguageDirection(dir);\n                }\n            },\n            _openIfActive: function openIfActive() {\n                this.isActive() && this.open();\n            },\n            _minLengthMet: function minLengthMet(query) {\n                query = _.isString(query) ? query : this.input.getQuery() || \"\";\n                return query.length >= this.minLength;\n            },\n            _updateHint: function updateHint() {\n                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;\n                $selectable = this.menu.getTopSelectable();\n                data = this.menu.getSelectableData($selectable);\n                val = this.input.getInputValue();\n                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {\n                    query = Input.normalizeQuery(val);\n                    escapedQuery = _.escapeRegExChars(query);\n                    frontMatchRegEx = new RegExp(\"^(?:\" + escapedQuery + \")(.+$)\", \"i\");\n                    match = frontMatchRegEx.exec(data.val);\n                    match && this.input.setHint(val + match[1]);\n                } else {\n                    this.input.clearHint();\n                }\n            },\n            isEnabled: function isEnabled() {\n                return this.enabled;\n            },\n            enable: function enable() {\n                this.enabled = true;\n            },\n            disable: function disable() {\n                this.enabled = false;\n            },\n            isActive: function isActive() {\n                return this.active;\n            },\n            activate: function activate() {\n                if (this.isActive()) {\n                    return true;\n                } else if (!this.isEnabled() || this.eventBus.before(\"active\")) {\n                    return false;\n                } else {\n                    this.active = true;\n                    this.eventBus.trigger(\"active\");\n                    return true;\n                }\n            },\n            deactivate: function deactivate() {\n                if (!this.isActive()) {\n                    return true;\n                } else if (this.eventBus.before(\"idle\")) {\n                    return false;\n                } else {\n                    this.active = false;\n                    this.close();\n                    this.eventBus.trigger(\"idle\");\n                    return true;\n                }\n            },\n            isOpen: function isOpen() {\n                return this.menu.isOpen();\n            },\n            open: function open() {\n                if (!this.isOpen() && !this.eventBus.before(\"open\")) {\n                    this.input.setAriaExpanded(true);\n                    this.menu.open();\n                    this._updateHint();\n                    this.eventBus.trigger(\"open\");\n                }\n                return this.isOpen();\n            },\n            close: function close() {\n                if (this.isOpen() && !this.eventBus.before(\"close\")) {\n                    this.input.setAriaExpanded(false);\n                    this.menu.close();\n                    this.input.clearHint();\n                    this.input.resetInputValue();\n                    this.eventBus.trigger(\"close\");\n                }\n                return !this.isOpen();\n            },\n            setVal: function setVal(val) {\n                this.input.setQuery(_.toStr(val));\n            },\n            getVal: function getVal() {\n                return this.input.getQuery();\n            },\n            select: function select($selectable) {\n                var data = this.menu.getSelectableData($selectable);\n                if (data && !this.eventBus.before(\"select\", data.obj, data.dataset)) {\n                    this.input.setQuery(data.val, true);\n                    this.eventBus.trigger(\"select\", data.obj, data.dataset);\n                    this.close();\n                    return true;\n                }\n                return false;\n            },\n            autocomplete: function autocomplete($selectable) {\n                var query, data, isValid;\n                query = this.input.getQuery();\n                data = this.menu.getSelectableData($selectable);\n                isValid = data && query !== data.val;\n                if (isValid && !this.eventBus.before(\"autocomplete\", data.obj, data.dataset)) {\n                    this.input.setQuery(data.val);\n                    this.eventBus.trigger(\"autocomplete\", data.obj, data.dataset);\n                    return true;\n                }\n                return false;\n            },\n            moveCursor: function moveCursor(delta) {\n                var query, $candidate, data, suggestion, datasetName, cancelMove, id;\n                query = this.input.getQuery();\n                $candidate = this.menu.selectableRelativeToCursor(delta);\n                data = this.menu.getSelectableData($candidate);\n                suggestion = data ? data.obj : null;\n                datasetName = data ? data.dataset : null;\n                id = $candidate ? $candidate.attr(\"id\") : null;\n                this.input.trigger(\"cursorchange\", id);\n                cancelMove = this._minLengthMet() && this.menu.update(query);\n                if (!cancelMove && !this.eventBus.before(\"cursorchange\", suggestion, datasetName)) {\n                    this.menu.setCursor($candidate);\n                    if (data) {\n                        if (typeof data.val === \"string\") {\n                            this.input.setInputValue(data.val);\n                        }\n                    } else {\n                        this.input.resetInputValue();\n                        this._updateHint();\n                    }\n                    this.eventBus.trigger(\"cursorchange\", suggestion, datasetName);\n                    return true;\n                }\n                return false;\n            },\n            destroy: function destroy() {\n                this.input.destroy();\n                this.menu.destroy();\n            }\n        });\n        return Typeahead;\n        function c(ctx) {\n            var methods = [].slice.call(arguments, 1);\n            return function() {\n                var args = [].slice.call(arguments);\n                _.each(methods, function(method) {\n                    return ctx[method].apply(ctx, args);\n                });\n            };\n        }\n    }();\n    (function() {\n        \"use strict\";\n        var old, keys, methods;\n        old = $.fn.typeahead;\n        keys = {\n            www: \"tt-www\",\n            attrs: \"tt-attrs\",\n            typeahead: \"tt-typeahead\"\n        };\n        methods = {\n            initialize: function initialize(o, datasets) {\n                var www;\n                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);\n                o = o || {};\n                www = WWW(o.classNames);\n                return this.each(attach);\n                function attach() {\n                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, status, typeahead, MenuConstructor;\n                    _.each(datasets, function(d) {\n                        d.highlight = !!o.highlight;\n                    });\n                    $input = $(this);\n                    $wrapper = $(www.html.wrapper);\n                    $hint = $elOrNull(o.hint);\n                    $menu = $elOrNull(o.menu);\n                    defaultHint = o.hint !== false && !$hint;\n                    defaultMenu = o.menu !== false && !$menu;\n                    defaultHint && ($hint = buildHintFromInput($input, www));\n                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));\n                    $hint && $hint.val(\"\");\n                    $input = prepInput($input, www);\n                    if (defaultHint || defaultMenu) {\n                        $wrapper.css(www.css.wrapper);\n                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);\n                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);\n                    }\n                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;\n                    eventBus = new EventBus({\n                        el: $input\n                    });\n                    input = new Input({\n                        hint: $hint,\n                        input: $input,\n                        menu: $menu\n                    }, www);\n                    menu = new MenuConstructor({\n                        node: $menu,\n                        datasets: datasets\n                    }, www);\n                    status = new Status({\n                        $input: $input,\n                        menu: menu\n                    });\n                    typeahead = new Typeahead({\n                        input: input,\n                        menu: menu,\n                        eventBus: eventBus,\n                        minLength: o.minLength,\n                        autoselect: o.autoselect\n                    }, www);\n                    $input.data(keys.www, www);\n                    $input.data(keys.typeahead, typeahead);\n                }\n            },\n            isEnabled: function isEnabled() {\n                var enabled;\n                ttEach(this.first(), function(t) {\n                    enabled = t.isEnabled();\n                });\n                return enabled;\n            },\n            enable: function enable() {\n                ttEach(this, function(t) {\n                    t.enable();\n                });\n                return this;\n            },\n            disable: function disable() {\n                ttEach(this, function(t) {\n                    t.disable();\n                });\n                return this;\n            },\n            isActive: function isActive() {\n                var active;\n                ttEach(this.first(), function(t) {\n                    active = t.isActive();\n                });\n                return active;\n            },\n            activate: function activate() {\n                ttEach(this, function(t) {\n                    t.activate();\n                });\n                return this;\n            },\n            deactivate: function deactivate() {\n                ttEach(this, function(t) {\n                    t.deactivate();\n                });\n                return this;\n            },\n            isOpen: function isOpen() {\n                var open;\n                ttEach(this.first(), function(t) {\n                    open = t.isOpen();\n                });\n                return open;\n            },\n            open: function open() {\n                ttEach(this, function(t) {\n                    t.open();\n                });\n                return this;\n            },\n            close: function close() {\n                ttEach(this, function(t) {\n                    t.close();\n                });\n                return this;\n            },\n            select: function select(el) {\n                var success = false, $el = $(el);\n                ttEach(this.first(), function(t) {\n                    success = t.select($el);\n                });\n                return success;\n            },\n            autocomplete: function autocomplete(el) {\n                var success = false, $el = $(el);\n                ttEach(this.first(), function(t) {\n                    success = t.autocomplete($el);\n                });\n                return success;\n            },\n            moveCursor: function moveCursoe(delta) {\n                var success = false;\n                ttEach(this.first(), function(t) {\n                    success = t.moveCursor(delta);\n                });\n                return success;\n            },\n            val: function val(newVal) {\n                var query;\n                if (!arguments.length) {\n                    ttEach(this.first(), function(t) {\n                        query = t.getVal();\n                    });\n                    return query;\n                } else {\n                    ttEach(this, function(t) {\n                        t.setVal(_.toStr(newVal));\n                    });\n                    return this;\n                }\n            },\n            destroy: function destroy() {\n                ttEach(this, function(typeahead, $input) {\n                    revert($input);\n                    typeahead.destroy();\n                });\n                return this;\n            }\n        };\n        $.fn.typeahead = function(method) {\n            if (methods[method]) {\n                return methods[method].apply(this, [].slice.call(arguments, 1));\n            } else {\n                return methods.initialize.apply(this, arguments);\n            }\n        };\n        $.fn.typeahead.noConflict = function noConflict() {\n            $.fn.typeahead = old;\n            return this;\n        };\n        function ttEach($els, fn) {\n            $els.each(function() {\n                var $input = $(this), typeahead;\n                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);\n            });\n        }\n        function buildHintFromInput($input, www) {\n            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop({\n                readonly: true,\n                required: false\n            }).removeAttr(\"id name placeholder\").removeClass(\"required\").attr({\n                spellcheck: \"false\",\n                tabindex: -1\n            });\n        }\n        function prepInput($input, www) {\n            $input.data(keys.attrs, {\n                dir: $input.attr(\"dir\"),\n                autocomplete: $input.attr(\"autocomplete\"),\n                spellcheck: $input.attr(\"spellcheck\"),\n                style: $input.attr(\"style\")\n            });\n            $input.addClass(www.classes.input).attr({\n                spellcheck: false\n            });\n            try {\n                !$input.attr(\"dir\") && $input.attr(\"dir\", \"auto\");\n            } catch (e) {}\n            return $input;\n        }\n        function getBackgroundStyles($el) {\n            return {\n                backgroundAttachment: $el.css(\"background-attachment\"),\n                backgroundClip: $el.css(\"background-clip\"),\n                backgroundColor: $el.css(\"background-color\"),\n                backgroundImage: $el.css(\"background-image\"),\n                backgroundOrigin: $el.css(\"background-origin\"),\n                backgroundPosition: $el.css(\"background-position\"),\n                backgroundRepeat: $el.css(\"background-repeat\"),\n                backgroundSize: $el.css(\"background-size\")\n            };\n        }\n        function revert($input) {\n            var www, $wrapper;\n            www = $input.data(keys.www);\n            $wrapper = $input.parent().filter(www.selectors.wrapper);\n            _.each($input.data(keys.attrs), function(val, key) {\n                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);\n            });\n            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);\n            if ($wrapper.length) {\n                $input.detach().insertAfter($wrapper);\n                $wrapper.remove();\n            }\n        }\n        function $elOrNull(obj) {\n            var isValid, $el;\n            isValid = _.isJQuery(obj) || _.isElement(obj);\n            $el = isValid ? $(obj).first() : [];\n            return $el.length ? $el : null;\n        }\n    })();\n});","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction propertyIsOnObject(object, property) {\n\ttry {\n\t\treturn property in object\n\t} catch(_) {\n\t\treturn false\n\t}\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\treturn propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,\n\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","var slice = Array.prototype.slice\n\nmodule.exports = iterativelyWalk\n\nfunction iterativelyWalk(nodes, cb) {\n    if (!('length' in nodes)) {\n        nodes = [nodes]\n    }\n    \n    nodes = slice.call(nodes)\n\n    while(nodes.length) {\n        var node = nodes.shift(),\n            ret = cb(node)\n\n        if (ret) {\n            return ret\n        }\n\n        if (node.childNodes && node.childNodes.length) {\n            nodes = slice.call(node.childNodes).concat(nodes)\n        }\n    }\n}\n","'use strict';\n\nconst matchOperatorsRegex = /[|\\\\{}()[\\]^$+*?.-]/g;\n\nmodule.exports = string => {\n\tif (typeof string !== 'string') {\n\t\tthrow new TypeError('Expected a string');\n\t}\n\n\treturn string.replace(matchOperatorsRegex, '\\\\$&');\n};\n","'use strict';\n\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nvar hasProp = Object.prototype.hasOwnProperty;\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    var arrA = isArray(a)\n      , arrB = isArray(b)\n      , i\n      , length\n      , key;\n\n    if (arrA && arrB) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n    if (arrA != arrB) return false;\n\n    var dateA = a instanceof Date\n      , dateB = b instanceof Date;\n    if (dateA != dateB) return false;\n    if (dateA && dateB) return a.getTime() == b.getTime();\n\n    var regexpA = a instanceof RegExp\n      , regexpB = b instanceof RegExp;\n    if (regexpA != regexpB) return false;\n    if (regexpA && regexpB) return a.toString() == b.toString();\n\n    var keys = keyList(a);\n    length = keys.length;\n\n    if (length !== keyList(b).length)\n      return false;\n\n    for (i = length; i-- !== 0;)\n      if (!hasProp.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  return a!==a && b!==b;\n};\n","//\n// Main\n//\n\nfunction memoize (fn, options) {\n  var cache = options && options.cache\n    ? options.cache\n    : cacheDefault\n\n  var serializer = options && options.serializer\n    ? options.serializer\n    : serializerDefault\n\n  var strategy = options && options.strategy\n    ? options.strategy\n    : strategyDefault\n\n  return strategy(fn, {\n    cache: cache,\n    serializer: serializer\n  })\n}\n\n//\n// Strategy\n//\n\nfunction isPrimitive (value) {\n  return value == null || typeof value === 'number' || typeof value === 'boolean' // || typeof value === \"string\" 'unsafe' primitive for our needs\n}\n\nfunction monadic (fn, cache, serializer, arg) {\n  var cacheKey = isPrimitive(arg) ? arg : serializer(arg)\n\n  var computedValue = cache.get(cacheKey)\n  if (typeof computedValue === 'undefined') {\n    computedValue = fn.call(this, arg)\n    cache.set(cacheKey, computedValue)\n  }\n\n  return computedValue\n}\n\nfunction variadic (fn, cache, serializer) {\n  var args = Array.prototype.slice.call(arguments, 3)\n  var cacheKey = serializer(args)\n\n  var computedValue = cache.get(cacheKey)\n  if (typeof computedValue === 'undefined') {\n    computedValue = fn.apply(this, args)\n    cache.set(cacheKey, computedValue)\n  }\n\n  return computedValue\n}\n\nfunction assemble (fn, context, strategy, cache, serialize) {\n  return strategy.bind(\n    context,\n    fn,\n    cache,\n    serialize\n  )\n}\n\nfunction strategyDefault (fn, options) {\n  var strategy = fn.length === 1 ? monadic : variadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\nfunction strategyVariadic (fn, options) {\n  var strategy = variadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\nfunction strategyMonadic (fn, options) {\n  var strategy = monadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\n//\n// Serializer\n//\n\nfunction serializerDefault () {\n  return JSON.stringify(arguments)\n}\n\n//\n// Cache\n//\n\nfunction ObjectWithoutPrototypeCache () {\n  this.cache = Object.create(null)\n}\n\nObjectWithoutPrototypeCache.prototype.has = function (key) {\n  return (key in this.cache)\n}\n\nObjectWithoutPrototypeCache.prototype.get = function (key) {\n  return this.cache[key]\n}\n\nObjectWithoutPrototypeCache.prototype.set = function (key, value) {\n  this.cache[key] = value\n}\n\nvar cacheDefault = {\n  create: function create () {\n    return new ObjectWithoutPrototypeCache()\n  }\n}\n\n//\n// API\n//\n\nmodule.exports = memoize\nmodule.exports.strategies = {\n  variadic: strategyVariadic,\n  monadic: strategyMonadic\n}\n","var getSrc = function (input) {\n\tif (typeof input !== 'string') {\n\t\tthrow new TypeError('get-src expected a string');\n\t}\n\tvar re = /src=\"(.*?)\"/gm;\n\tvar url = re.exec(input);\n\n\tif (url && url.length >= 2) {\n\t\treturn url[1];\n\t}\n};\n\n/**\n * Strip away any parameters following `?` or `/` or '&'\n * @param str\n * @returns {String}\n */\nfunction stripParameters(str) {\n  // Split parameters or split folder separator\n  if (str.indexOf('?') > -1) {\n    return str.split('?')[0];\n  }\n\n  if (str.indexOf('/') > -1) {\n    return str.split('/')[0];\n  }\n\n  if (str.indexOf('&') > -1) {\n    return str.split('&')[0];\n  }\n\n  return str;\n}\n\n/**\n * Get the Youtube Video id.\n * @param {string} youtubeStr - the url from which you want to extract the id\n * @returns {string|undefined}\n */\n\nfunction youtube(youtubeStr) {\n  var str = youtubeStr; // remove time hash at the end of the string\n\n  str = str.replace(/#t=.*$/, ''); // shortcode\n\n  var shortcode = /youtube:\\/\\/|https?:\\/\\/youtu\\.be\\/|http:\\/\\/y2u\\.be\\//g;\n\n  if (shortcode.test(str)) {\n    var shortcodeid = str.split(shortcode)[1];\n    return stripParameters(shortcodeid);\n  } // /v/ or /vi/\n\n\n  var inlinev = /\\/v\\/|\\/vi\\//g;\n\n  if (inlinev.test(str)) {\n    var inlineid = str.split(inlinev)[1];\n    return stripParameters(inlineid);\n  } // v= or vi=\n\n\n  var parameterv = /v=|vi=/g;\n\n  if (parameterv.test(str)) {\n    var arr = str.split(parameterv);\n    return stripParameters(arr[1].split('&')[0]);\n  } // v= or vi=\n\n\n  var parameterwebp = /\\/an_webp\\//g;\n\n  if (parameterwebp.test(str)) {\n    var webp = str.split(parameterwebp)[1];\n    return stripParameters(webp);\n  } // embed\n\n\n  var embedreg = /\\/embed\\//g;\n\n  if (embedreg.test(str)) {\n    var embedid = str.split(embedreg)[1];\n    return stripParameters(embedid);\n  } // ignore /user/username pattern\n\n\n  var usernamereg = /\\/user\\/([a-zA-Z0-9]*)$/g;\n\n  if (usernamereg.test(str)) {\n    return undefined;\n  } // user\n\n\n  var userreg = /\\/user\\/(?!.*videos)/g;\n\n  if (userreg.test(str)) {\n    var elements = str.split('/');\n    return stripParameters(elements.pop());\n  } // attribution_link\n\n\n  var attrreg = /\\/attribution_link\\?.*v%3D([^%&]*)(%26|&|$)/;\n\n  if (attrreg.test(str)) {\n    return stripParameters(str.match(attrreg)[1]);\n  }\n\n  return undefined;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\n/**\n * Get the vimeo id.\n * @param {string} vimeoStr - the url from which you want to extract the id\n * @returns {string|undefined}\n */\nfunction vimeo(vimeoStr) {\n  var str = vimeoStr;\n\n  if (str.indexOf('#') > -1) {\n    var _str$split = str.split('#');\n\n    var _str$split2 = _slicedToArray(_str$split, 1);\n\n    str = _str$split2[0];\n  }\n\n  if (str.indexOf('?') > -1 && str.indexOf('clip_id=') === -1) {\n    var _str$split3 = str.split('?');\n\n    var _str$split4 = _slicedToArray(_str$split3, 1);\n\n    str = _str$split4[0];\n  }\n\n  var id;\n  var arr;\n  var primary = /https?:\\/\\/vimeo\\.com\\/([0-9]+)/;\n  var matches = primary.exec(str);\n\n  if (matches && matches[1]) {\n    return matches[1];\n  }\n\n  var vimeoPipe = ['https?://player.vimeo.com/video/[0-9]+$', 'https?://vimeo.com/channels', 'groups', 'album'].join('|');\n  var vimeoRegex = new RegExp(vimeoPipe, 'gim');\n\n  if (vimeoRegex.test(str)) {\n    arr = str.split('/');\n\n    if (arr && arr.length) {\n      id = arr.pop();\n    }\n  } else if (/clip_id=/gim.test(str)) {\n    arr = str.split('clip_id=');\n\n    if (arr && arr.length) {\n      var _arr$1$split = arr[1].split('&');\n\n      var _arr$1$split2 = _slicedToArray(_arr$1$split, 1);\n\n      id = _arr$1$split2[0];\n    }\n  }\n\n  return id;\n}\n\n/**\n * Get the vine id.\n * @param {string} str - the url from which you want to extract the id\n * @returns {string|undefined}\n */\nfunction vine(str) {\n  var regex = /https:\\/\\/vine\\.co\\/v\\/([a-zA-Z0-9]*)\\/?/;\n  var matches = regex.exec(str);\n  return matches && matches[1];\n}\n\n/**\n * Get the VideoPress id.\n * @param {string} str - the url from which you want to extract the id\n * @returns {string|undefined}\n */\nfunction videopress(str) {\n  var idRegex;\n\n  if (str.indexOf('embed') > -1) {\n    idRegex = /embed\\/(\\w{8})/;\n    return str.match(idRegex)[1];\n  }\n\n  idRegex = /\\/v\\/(\\w{8})/;\n  var match = str.match(idRegex);\n\n  if (match && match.length > 0) {\n    return str.match(idRegex)[1];\n  }\n\n  return undefined;\n}\n\n/**\n * Get the Microsoft Stream id.\n * @param {string} str - the url from which you want to extract the id\n * @returns {string|undefined}\n */\nfunction microsoftStream(str) {\n  var regex = str.indexOf('embed') > -1 ? /https:\\/\\/web\\.microsoftstream\\.com\\/embed\\/video\\/([a-zA-Z0-9-]*)\\/?/ : /https:\\/\\/web\\.microsoftstream\\.com\\/video\\/([a-zA-Z0-9-]*)\\/?/;\n  var matches = regex.exec(str);\n  return matches && matches[1];\n}\n\n/**\n * Get the id and service from a video url.\n * @param {String} videoStr - the url from which you want to extract the id\n * @returns {Object}\n */\n\nfunction getVideoId(videoStr) {\n  if (typeof videoStr !== 'string') {\n    throw new TypeError('get-video-id expects a string');\n  }\n\n  var str = videoStr;\n\n  if (/<iframe/gi.test(str)) {\n    str = getSrc(str);\n  } // remove surrounding whitespaces or linefeeds\n\n\n  str = str.trim(); // remove the '-nocookie' flag from youtube urls\n\n  str = str.replace('-nocookie', ''); // remove any leading `www.`\n\n  str = str.replace('/www.', '/');\n  var metadata = {\n    id: null,\n    service: null\n  }; // Try to handle google redirection uri\n\n  if (/\\/\\/google/.test(str)) {\n    // Find the redirection uri\n    var matches = str.match(/url=([^&]+)&/); // Decode the found uri and replace current url string - continue with final link\n\n    if (matches) {\n      // JavaScript can get encoded URI\n      str = decodeURIComponent(matches[1]);\n    }\n  }\n\n  if (/youtube|youtu\\.be|y2u\\.be|i.ytimg\\./.test(str)) {\n    metadata = {\n      id: youtube(str),\n      service: 'youtube'\n    };\n  } else if (/vimeo/.test(str)) {\n    metadata = {\n      id: vimeo(str),\n      service: 'vimeo'\n    };\n  } else if (/vine/.test(str)) {\n    metadata = {\n      id: vine(str),\n      service: 'vine'\n    };\n  } else if (/videopress/.test(str)) {\n    metadata = {\n      id: videopress(str),\n      service: 'videopress'\n    };\n  } else if (/microsoftstream/.test(str)) {\n    metadata = {\n      id: microsoftStream(str),\n      service: 'microsoftstream'\n    };\n  }\n\n  return metadata;\n}\n\nexport default getVideoId;\n//# sourceMappingURL=get-video-id.esm.js.map\n","/*!\n * is-extendable <https://github.com/jonschlinkert/is-extendable>\n *\n * Copyright (c) 2015-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isPlainObject = require('is-plain-object');\n\nmodule.exports = function isExtendable(val) {\n  return isPlainObject(val) || typeof val === 'function' || Array.isArray(val);\n};\n","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isObject = require('isobject');\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nmodule.exports = function isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObjectObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n};\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n","var domWalk = require(\"dom-walk\")\n\nvar Comment = require(\"./dom-comment.js\")\nvar DOMText = require(\"./dom-text.js\")\nvar DOMElement = require(\"./dom-element.js\")\nvar DocumentFragment = require(\"./dom-fragment.js\")\nvar Event = require(\"./event.js\")\nvar dispatchEvent = require(\"./event/dispatch-event.js\")\nvar addEventListener = require(\"./event/add-event-listener.js\")\nvar removeEventListener = require(\"./event/remove-event-listener.js\")\n\nmodule.exports = Document;\n\nfunction Document() {\n    if (!(this instanceof Document)) {\n        return new Document();\n    }\n\n    this.head = this.createElement(\"head\")\n    this.body = this.createElement(\"body\")\n    this.documentElement = this.createElement(\"html\")\n    this.documentElement.appendChild(this.head)\n    this.documentElement.appendChild(this.body)\n    this.childNodes = [this.documentElement]\n    this.nodeType = 9\n}\n\nvar proto = Document.prototype;\nproto.createTextNode = function createTextNode(value) {\n    return new DOMText(value, this)\n}\n\nproto.createElementNS = function createElementNS(namespace, tagName) {\n    var ns = namespace === null ? null : String(namespace)\n    return new DOMElement(tagName, this, ns)\n}\n\nproto.createElement = function createElement(tagName) {\n    return new DOMElement(tagName, this)\n}\n\nproto.createDocumentFragment = function createDocumentFragment() {\n    return new DocumentFragment(this)\n}\n\nproto.createEvent = function createEvent(family) {\n    return new Event(family)\n}\n\nproto.createComment = function createComment(data) {\n    return new Comment(data, this)\n}\n\nproto.getElementById = function getElementById(id) {\n    id = String(id)\n\n    var result = domWalk(this.childNodes, function (node) {\n        if (String(node.id) === id) {\n            return node\n        }\n    })\n\n    return result || null\n}\n\nproto.getElementsByClassName = DOMElement.prototype.getElementsByClassName\nproto.getElementsByTagName = DOMElement.prototype.getElementsByTagName\nproto.contains = DOMElement.prototype.contains\n\nproto.removeEventListener = removeEventListener\nproto.addEventListener = addEventListener\nproto.dispatchEvent = dispatchEvent\n","module.exports = Comment\n\nfunction Comment(data, owner) {\n    if (!(this instanceof Comment)) {\n        return new Comment(data, owner)\n    }\n\n    this.data = data\n    this.nodeValue = data\n    this.length = data.length\n    this.ownerDocument = owner || null\n}\n\nComment.prototype.nodeType = 8\nComment.prototype.nodeName = \"#comment\"\n\nComment.prototype.toString = function _Comment_toString() {\n    return \"[object Comment]\"\n}\n","var domWalk = require(\"dom-walk\")\nvar dispatchEvent = require(\"./event/dispatch-event.js\")\nvar addEventListener = require(\"./event/add-event-listener.js\")\nvar removeEventListener = require(\"./event/remove-event-listener.js\")\nvar serializeNode = require(\"./serialize.js\")\n\nvar htmlns = \"http://www.w3.org/1999/xhtml\"\n\nmodule.exports = DOMElement\n\nfunction DOMElement(tagName, owner, namespace) {\n    if (!(this instanceof DOMElement)) {\n        return new DOMElement(tagName)\n    }\n\n    var ns = namespace === undefined ? htmlns : (namespace || null)\n\n    this.tagName = ns === htmlns ? String(tagName).toUpperCase() : tagName\n    this.nodeName = this.tagName\n    this.className = \"\"\n    this.dataset = {}\n    this.childNodes = []\n    this.parentNode = null\n    this.style = {}\n    this.ownerDocument = owner || null\n    this.namespaceURI = ns\n    this._attributes = {}\n\n    if (this.tagName === 'INPUT') {\n      this.type = 'text'\n    }\n}\n\nDOMElement.prototype.type = \"DOMElement\"\nDOMElement.prototype.nodeType = 1\n\nDOMElement.prototype.appendChild = function _Element_appendChild(child) {\n    if (child.parentNode) {\n        child.parentNode.removeChild(child)\n    }\n\n    this.childNodes.push(child)\n    child.parentNode = this\n\n    return child\n}\n\nDOMElement.prototype.replaceChild =\n    function _Element_replaceChild(elem, needle) {\n        // TODO: Throw NotFoundError if needle.parentNode !== this\n\n        if (elem.parentNode) {\n            elem.parentNode.removeChild(elem)\n        }\n\n        var index = this.childNodes.indexOf(needle)\n\n        needle.parentNode = null\n        this.childNodes[index] = elem\n        elem.parentNode = this\n\n        return needle\n    }\n\nDOMElement.prototype.removeChild = function _Element_removeChild(elem) {\n    // TODO: Throw NotFoundError if elem.parentNode !== this\n\n    var index = this.childNodes.indexOf(elem)\n    this.childNodes.splice(index, 1)\n\n    elem.parentNode = null\n    return elem\n}\n\nDOMElement.prototype.insertBefore =\n    function _Element_insertBefore(elem, needle) {\n        // TODO: Throw NotFoundError if referenceElement is a dom node\n        // and parentNode !== this\n\n        if (elem.parentNode) {\n            elem.parentNode.removeChild(elem)\n        }\n\n        var index = needle === null || needle === undefined ?\n            -1 :\n            this.childNodes.indexOf(needle)\n\n        if (index > -1) {\n            this.childNodes.splice(index, 0, elem)\n        } else {\n            this.childNodes.push(elem)\n        }\n\n        elem.parentNode = this\n        return elem\n    }\n\nDOMElement.prototype.setAttributeNS =\n    function _Element_setAttributeNS(namespace, name, value) {\n        var prefix = null\n        var localName = name\n        var colonPosition = name.indexOf(\":\")\n        if (colonPosition > -1) {\n            prefix = name.substr(0, colonPosition)\n            localName = name.substr(colonPosition + 1)\n        }\n        if (this.tagName === 'INPUT' && name === 'type') {\n          this.type = value;\n        }\n        else {\n          var attributes = this._attributes[namespace] || (this._attributes[namespace] = {})\n          attributes[localName] = {value: value, prefix: prefix}\n        }\n    }\n\nDOMElement.prototype.getAttributeNS =\n    function _Element_getAttributeNS(namespace, name) {\n        var attributes = this._attributes[namespace];\n        var value = attributes && attributes[name] && attributes[name].value\n        if (this.tagName === 'INPUT' && name === 'type') {\n          return this.type;\n        }\n        if (typeof value !== \"string\") {\n            return null\n        }\n        return value\n    }\n\nDOMElement.prototype.removeAttributeNS =\n    function _Element_removeAttributeNS(namespace, name) {\n        var attributes = this._attributes[namespace];\n        if (attributes) {\n            delete attributes[name]\n        }\n    }\n\nDOMElement.prototype.hasAttributeNS =\n    function _Element_hasAttributeNS(namespace, name) {\n        var attributes = this._attributes[namespace]\n        return !!attributes && name in attributes;\n    }\n\nDOMElement.prototype.setAttribute = function _Element_setAttribute(name, value) {\n    return this.setAttributeNS(null, name, value)\n}\n\nDOMElement.prototype.getAttribute = function _Element_getAttribute(name) {\n    return this.getAttributeNS(null, name)\n}\n\nDOMElement.prototype.removeAttribute = function _Element_removeAttribute(name) {\n    return this.removeAttributeNS(null, name)\n}\n\nDOMElement.prototype.hasAttribute = function _Element_hasAttribute(name) {\n    return this.hasAttributeNS(null, name)\n}\n\nDOMElement.prototype.removeEventListener = removeEventListener\nDOMElement.prototype.addEventListener = addEventListener\nDOMElement.prototype.dispatchEvent = dispatchEvent\n\n// Un-implemented\nDOMElement.prototype.focus = function _Element_focus() {\n    return void 0\n}\n\nDOMElement.prototype.toString = function _Element_toString() {\n    return serializeNode(this)\n}\n\nDOMElement.prototype.getElementsByClassName = function _Element_getElementsByClassName(classNames) {\n    var classes = classNames.split(\" \");\n    var elems = []\n\n    domWalk(this, function (node) {\n        if (node.nodeType === 1) {\n            var nodeClassName = node.className || \"\"\n            var nodeClasses = nodeClassName.split(\" \")\n\n            if (classes.every(function (item) {\n                return nodeClasses.indexOf(item) !== -1\n            })) {\n                elems.push(node)\n            }\n        }\n    })\n\n    return elems\n}\n\nDOMElement.prototype.getElementsByTagName = function _Element_getElementsByTagName(tagName) {\n    tagName = tagName.toLowerCase()\n    var elems = []\n\n    domWalk(this.childNodes, function (node) {\n        if (node.nodeType === 1 && (tagName === '*' || node.tagName.toLowerCase() === tagName)) {\n            elems.push(node)\n        }\n    })\n\n    return elems\n}\n\nDOMElement.prototype.contains = function _Element_contains(element) {\n    return domWalk(this, function (node) {\n        return element === node\n    }) || false\n}\n","var DOMElement = require(\"./dom-element.js\")\n\nmodule.exports = DocumentFragment\n\nfunction DocumentFragment(owner) {\n    if (!(this instanceof DocumentFragment)) {\n        return new DocumentFragment()\n    }\n\n    this.childNodes = []\n    this.parentNode = null\n    this.ownerDocument = owner || null\n}\n\nDocumentFragment.prototype.type = \"DocumentFragment\"\nDocumentFragment.prototype.nodeType = 11\nDocumentFragment.prototype.nodeName = \"#document-fragment\"\n\nDocumentFragment.prototype.appendChild  = DOMElement.prototype.appendChild\nDocumentFragment.prototype.replaceChild = DOMElement.prototype.replaceChild\nDocumentFragment.prototype.removeChild  = DOMElement.prototype.removeChild\n\nDocumentFragment.prototype.toString =\n    function _DocumentFragment_toString() {\n        return this.childNodes.map(function (node) {\n            return String(node)\n        }).join(\"\")\n    }\n","module.exports = DOMText\n\nfunction DOMText(value, owner) {\n    if (!(this instanceof DOMText)) {\n        return new DOMText(value)\n    }\n\n    this.data = value || \"\"\n    this.length = this.data.length\n    this.ownerDocument = owner || null\n}\n\nDOMText.prototype.type = \"DOMTextNode\"\nDOMText.prototype.nodeType = 3\nDOMText.prototype.nodeName = \"#text\"\n\nDOMText.prototype.toString = function _Text_toString() {\n    return this.data\n}\n\nDOMText.prototype.replaceData = function replaceData(index, length, value) {\n    var current = this.data\n    var left = current.substring(0, index)\n    var right = current.substring(index + length, current.length)\n    this.data = left + value + right\n    this.length = this.data.length\n}\n","module.exports = Event\n\nfunction Event(family) {}\n\nEvent.prototype.initEvent = function _Event_initEvent(type, bubbles, cancelable) {\n    this.type = type\n    this.bubbles = bubbles\n    this.cancelable = cancelable\n}\n\nEvent.prototype.preventDefault = function _Event_preventDefault() {\n    \n}\n","module.exports = addEventListener\n\nfunction addEventListener(type, listener) {\n    var elem = this\n\n    if (!elem.listeners) {\n        elem.listeners = {}\n    }\n\n    if (!elem.listeners[type]) {\n        elem.listeners[type] = []\n    }\n\n    if (elem.listeners[type].indexOf(listener) === -1) {\n        elem.listeners[type].push(listener)\n    }\n}\n","module.exports = dispatchEvent\n\nfunction dispatchEvent(ev) {\n    var elem = this\n    var type = ev.type\n\n    if (!ev.target) {\n        ev.target = elem\n    }\n\n    if (!elem.listeners) {\n        elem.listeners = {}\n    }\n\n    var listeners = elem.listeners[type]\n\n    if (listeners) {\n        return listeners.forEach(function (listener) {\n            ev.currentTarget = elem\n            if (typeof listener === 'function') {\n                listener(ev)\n            } else {\n                listener.handleEvent(ev)\n            }\n        })\n    }\n\n    if (elem.parentNode) {\n        elem.parentNode.dispatchEvent(ev)\n    }\n}\n","module.exports = removeEventListener\n\nfunction removeEventListener(type, listener) {\n    var elem = this\n\n    if (!elem.listeners) {\n        return\n    }\n\n    if (!elem.listeners[type]) {\n        return\n    }\n\n    var list = elem.listeners[type]\n    var index = list.indexOf(listener)\n    if (index !== -1) {\n        list.splice(index, 1)\n    }\n}\n","var Document = require('./document.js');\n\nmodule.exports = new Document();\n","module.exports = serializeNode\n\nvar voidElements = [\"area\",\"base\",\"br\",\"col\",\"embed\",\"hr\",\"img\",\"input\",\"keygen\",\"link\",\"menuitem\",\"meta\",\"param\",\"source\",\"track\",\"wbr\"];\n\nfunction serializeNode(node) {\n    switch (node.nodeType) {\n        case 3:\n            return escapeText(node.data)\n        case 8:\n            return \"<!--\" + node.data + \"-->\"\n        default:\n            return serializeElement(node)\n    }\n}\n\nfunction serializeElement(elem) {\n    var strings = []\n\n    var tagname = elem.tagName\n\n    if (elem.namespaceURI === \"http://www.w3.org/1999/xhtml\") {\n        tagname = tagname.toLowerCase()\n    }\n\n    strings.push(\"<\" + tagname + properties(elem) + datasetify(elem))\n\n    if (voidElements.indexOf(tagname) > -1) {\n        strings.push(\" />\")\n    } else {\n        strings.push(\">\")\n\n        if (elem.childNodes.length) {\n            strings.push.apply(strings, elem.childNodes.map(serializeNode))\n        } else if (elem.textContent || elem.innerText) {\n            strings.push(escapeText(elem.textContent || elem.innerText))\n        } else if (elem.innerHTML) {\n            strings.push(elem.innerHTML)\n        }\n\n        strings.push(\"</\" + tagname + \">\")\n    }\n\n    return strings.join(\"\")\n}\n\nfunction isProperty(elem, key) {\n    var type = typeof elem[key]\n\n    if (key === \"style\" && Object.keys(elem.style).length > 0) {\n      return true\n    }\n\n    return elem.hasOwnProperty(key) &&\n        (type === \"string\" || type === \"boolean\" || type === \"number\") &&\n        key !== \"nodeName\" && key !== \"className\" && key !== \"tagName\" &&\n        key !== \"textContent\" && key !== \"innerText\" && key !== \"namespaceURI\" &&  key !== \"innerHTML\"\n}\n\nfunction stylify(styles) {\n    if (typeof styles === 'string') return styles\n    var attr = \"\"\n    Object.keys(styles).forEach(function (key) {\n        var value = styles[key]\n        key = key.replace(/[A-Z]/g, function(c) {\n            return \"-\" + c.toLowerCase();\n        })\n        attr += key + \":\" + value + \";\"\n    })\n    return attr\n}\n\nfunction datasetify(elem) {\n    var ds = elem.dataset\n    var props = []\n\n    for (var key in ds) {\n        props.push({ name: \"data-\" + key, value: ds[key] })\n    }\n\n    return props.length ? stringify(props) : \"\"\n}\n\nfunction stringify(list) {\n    var attributes = []\n    list.forEach(function (tuple) {\n        var name = tuple.name\n        var value = tuple.value\n\n        if (name === \"style\") {\n            value = stylify(value)\n        }\n\n        attributes.push(name + \"=\" + \"\\\"\" + escapeAttributeValue(value) + \"\\\"\")\n    })\n\n    return attributes.length ? \" \" + attributes.join(\" \") : \"\"\n}\n\nfunction properties(elem) {\n    var props = []\n    for (var key in elem) {\n        if (isProperty(elem, key)) {\n            props.push({ name: key, value: elem[key] })\n        }\n    }\n\n    for (var ns in elem._attributes) {\n      for (var attribute in elem._attributes[ns]) {\n        var prop = elem._attributes[ns][attribute]\n        var name = (prop.prefix ? prop.prefix + \":\" : \"\") + attribute\n        props.push({ name: name, value: prop.value })\n      }\n    }\n\n    if (elem.className) {\n        props.push({ name: \"class\", value: elem.className })\n    }\n\n    return props.length ? stringify(props) : \"\"\n}\n\nfunction escapeText(s) {\n    var str = '';\n\n    if (typeof(s) === 'string') { \n        str = s; \n    } else if (s) {\n        str = s.toString();\n    }\n\n    return str\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n}\n\nfunction escapeAttributeValue(str) {\n    return escapeText(str).replace(/\"/g, \"&quot;\")\n}\n","/*!\n * object.omit <https://github.com/jonschlinkert/object.omit>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isObject = require('is-extendable');\n\nmodule.exports = function omit(obj, props, fn) {\n  if (!isObject(obj)) return {};\n\n  if (typeof props === 'function') {\n    fn = props;\n    props = [];\n  }\n\n  if (typeof props === 'string') {\n    props = [props];\n  }\n\n  var isFunction = typeof fn === 'function';\n  var keys = Object.keys(obj);\n  var res = {};\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var val = obj[key];\n\n    if (!props || (props.indexOf(key) === -1 && (!isFunction || fn(val, key, obj)))) {\n      res[key] = val;\n    }\n  }\n  return res;\n};\n","/*!\n * object.pick <https://github.com/jonschlinkert/object.pick>\n *\n * Copyright (c) 2014-2015 Jon Schlinkert, contributors.\n * Licensed under the MIT License\n */\n\n'use strict';\n\nvar isObject = require('isobject');\n\nmodule.exports = function pick(obj, keys) {\n  if (!isObject(obj) && typeof obj !== 'function') {\n    return {};\n  }\n\n  var res = {};\n  if (typeof keys === 'string') {\n    if (keys in obj) {\n      res[keys] = obj[keys];\n    }\n    return res;\n  }\n\n  var len = keys.length;\n  var idx = -1;\n\n  while (++idx < len) {\n    var key = keys[idx];\n    if (key in obj) {\n      res[key] = obj[key];\n    }\n  }\n  return res;\n};\n","// ::- Persistent data structure representing an ordered mapping from\n// strings to values, with some convenient update methods.\nfunction OrderedMap(content) {\n  this.content = content;\n}\n\nOrderedMap.prototype = {\n  constructor: OrderedMap,\n\n  find: function(key) {\n    for (var i = 0; i < this.content.length; i += 2)\n      if (this.content[i] === key) return i\n    return -1\n  },\n\n  // :: (string) → ?any\n  // Retrieve the value stored under `key`, or return undefined when\n  // no such key exists.\n  get: function(key) {\n    var found = this.find(key);\n    return found == -1 ? undefined : this.content[found + 1]\n  },\n\n  // :: (string, any, ?string) → OrderedMap\n  // Create a new map by replacing the value of `key` with a new\n  // value, or adding a binding to the end of the map. If `newKey` is\n  // given, the key of the binding will be replaced with that key.\n  update: function(key, value, newKey) {\n    var self = newKey && newKey != key ? this.remove(newKey) : this;\n    var found = self.find(key), content = self.content.slice();\n    if (found == -1) {\n      content.push(newKey || key, value);\n    } else {\n      content[found + 1] = value;\n      if (newKey) content[found] = newKey;\n    }\n    return new OrderedMap(content)\n  },\n\n  // :: (string) → OrderedMap\n  // Return a map with the given key removed, if it existed.\n  remove: function(key) {\n    var found = this.find(key);\n    if (found == -1) return this\n    var content = this.content.slice();\n    content.splice(found, 2);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, any) → OrderedMap\n  // Add a new key to the start of the map.\n  addToStart: function(key, value) {\n    return new OrderedMap([key, value].concat(this.remove(key).content))\n  },\n\n  // :: (string, any) → OrderedMap\n  // Add a new key to the end of the map.\n  addToEnd: function(key, value) {\n    var content = this.remove(key).content.slice();\n    content.push(key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, string, any) → OrderedMap\n  // Add a key after the given key. If `place` is not found, the new\n  // key is added to the end.\n  addBefore: function(place, key, value) {\n    var without = this.remove(key), content = without.content.slice();\n    var found = without.find(place);\n    content.splice(found == -1 ? content.length : found, 0, key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: ((key: string, value: any))\n  // Call the given function for each key/value pair in the map, in\n  // order.\n  forEach: function(f) {\n    for (var i = 0; i < this.content.length; i += 2)\n      f(this.content[i], this.content[i + 1]);\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a new map by prepending the keys in this map that don't\n  // appear in `map` before the keys in `map`.\n  prepend: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(map.content.concat(this.subtract(map).content))\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a new map by appending the keys in this map that don't\n  // appear in `map` after the keys in `map`.\n  append: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(this.subtract(map).content.concat(map.content))\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a map containing all the keys in this map that don't\n  // appear in `map`.\n  subtract: function(map) {\n    var result = this;\n    map = OrderedMap.from(map);\n    for (var i = 0; i < map.content.length; i += 2)\n      result = result.remove(map.content[i]);\n    return result\n  },\n\n  // :: number\n  // The amount of keys in this map.\n  get size() {\n    return this.content.length >> 1\n  }\n};\n\n// :: (?union<Object, OrderedMap>) → OrderedMap\n// Return a map with the given content. If null, create an empty\n// map. If given an ordered map, return that map itself. If given an\n// object, create a map from the object's properties.\nOrderedMap.from = function(value) {\n  if (value instanceof OrderedMap) return value\n  var content = [];\n  if (value) for (var prop in value) content.push(prop, value[prop]);\n  return new OrderedMap(content)\n};\n\nvar orderedmap = OrderedMap;\n\nexport default orderedmap;\n","import { liftTarget, canJoin, joinPoint, canSplit, ReplaceAroundStep, findWrapping } from 'prosemirror-transform';\nimport { Fragment, Slice } from 'prosemirror-model';\nimport { NodeSelection, Selection, TextSelection, AllSelection } from 'prosemirror-state';\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Delete the selection, if there is one.\nfunction deleteSelection(state, dispatch) {\n  if (state.selection.empty) { return false }\n  if (dispatch) { dispatch(state.tr.deleteSelection().scrollIntoView()); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// If the selection is empty and at the start of a textblock, try to\n// reduce the distance between that block and the one before it—if\n// there's a block directly before it that can be joined, join them.\n// If not, try to move the selected block closer to the next one in\n// the document structure by lifting it out of its parent or moving it\n// into a parent of the previous block. Will use the view for accurate\n// (bidi-aware) start-of-textblock detection if given.\nfunction joinBackward(state, dispatch, view) {\n  var ref = state.selection;\n  var $cursor = ref.$cursor;\n  if (!$cursor || (view ? !view.endOfTextblock(\"backward\", state)\n                        : $cursor.parentOffset > 0))\n    { return false }\n\n  var $cut = findCutBefore($cursor);\n\n  // If there is no node before this, try to lift\n  if (!$cut) {\n    var range = $cursor.blockRange(), target = range && liftTarget(range);\n    if (target == null) { return false }\n    if (dispatch) { dispatch(state.tr.lift(range, target).scrollIntoView()); }\n    return true\n  }\n\n  var before = $cut.nodeBefore;\n  // Apply the joining algorithm\n  if (!before.type.spec.isolating && deleteBarrier(state, $cut, dispatch))\n    { return true }\n\n  // If the node below has no content and the node above is\n  // selectable, delete the node below and select the one above.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(before, \"end\") || NodeSelection.isSelectable(before))) {\n    if (dispatch) {\n      var tr = state.tr.deleteRange($cursor.before(), $cursor.after());\n      tr.setSelection(textblockAt(before, \"end\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos, -1)), -1)\n                      : NodeSelection.create(tr.doc, $cut.pos - before.nodeSize));\n      dispatch(tr.scrollIntoView());\n    }\n    return true\n  }\n\n  // If the node before is an atom, delete it\n  if (before.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) { dispatch(state.tr.delete($cut.pos - before.nodeSize, $cut.pos).scrollIntoView()); }\n    return true\n  }\n\n  return false\n}\n\nfunction textblockAt(node, side) {\n  for (; node; node = (side == \"start\" ? node.firstChild : node.lastChild))\n    { if (node.isTextblock) { return true } }\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// When the selection is empty and at the start of a textblock, select\n// the node before that textblock, if possible. This is intended to be\n// bound to keys like backspace, after\n// [`joinBackward`](#commands.joinBackward) or other deleting\n// commands, as a fall-back behavior when the schema doesn't allow\n// deletion at the selected point.\nfunction selectNodeBackward(state, dispatch, view) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  var empty = ref.empty;\n  var $cut = $head;\n  if (!empty) { return false }\n\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"backward\", state) : $head.parentOffset > 0) { return false }\n    $cut = findCutBefore($head);\n  }\n  var node = $cut && $cut.nodeBefore;\n  if (!node || !NodeSelection.isSelectable(node)) { return false }\n  if (dispatch)\n    { dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos - node.nodeSize)).scrollIntoView()); }\n  return true\n}\n\nfunction findCutBefore($pos) {\n  if (!$pos.parent.type.spec.isolating) { for (var i = $pos.depth - 1; i >= 0; i--) {\n    if ($pos.index(i) > 0) { return $pos.doc.resolve($pos.before(i + 1)) }\n    if ($pos.node(i).type.spec.isolating) { break }\n  } }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// If the selection is empty and the cursor is at the end of a\n// textblock, try to reduce or remove the boundary between that block\n// and the one after it, either by joining them or by moving the other\n// block closer to this one in the tree structure. Will use the view\n// for accurate start-of-textblock detection if given.\nfunction joinForward(state, dispatch, view) {\n  var ref = state.selection;\n  var $cursor = ref.$cursor;\n  if (!$cursor || (view ? !view.endOfTextblock(\"forward\", state)\n                        : $cursor.parentOffset < $cursor.parent.content.size))\n    { return false }\n\n  var $cut = findCutAfter($cursor);\n\n  // If there is no node after this, there's nothing to do\n  if (!$cut) { return false }\n\n  var after = $cut.nodeAfter;\n  // Try the joining algorithm\n  if (deleteBarrier(state, $cut, dispatch)) { return true }\n\n  // If the node above has no content and the node below is\n  // selectable, delete the node above and select the one below.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(after, \"start\") || NodeSelection.isSelectable(after))) {\n    if (dispatch) {\n      var tr = state.tr.deleteRange($cursor.before(), $cursor.after());\n      tr.setSelection(textblockAt(after, \"start\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos)), 1)\n                      : NodeSelection.create(tr.doc, tr.mapping.map($cut.pos)));\n      dispatch(tr.scrollIntoView());\n    }\n    return true\n  }\n\n  // If the next node is an atom, delete it\n  if (after.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) { dispatch(state.tr.delete($cut.pos, $cut.pos + after.nodeSize).scrollIntoView()); }\n    return true\n  }\n\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// When the selection is empty and at the end of a textblock, select\n// the node coming after that textblock, if possible. This is intended\n// to be bound to keys like delete, after\n// [`joinForward`](#commands.joinForward) and similar deleting\n// commands, to provide a fall-back behavior when the schema doesn't\n// allow deletion at the selected point.\nfunction selectNodeForward(state, dispatch, view) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  var empty = ref.empty;\n  var $cut = $head;\n  if (!empty) { return false }\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"forward\", state) : $head.parentOffset < $head.parent.content.size)\n      { return false }\n    $cut = findCutAfter($head);\n  }\n  var node = $cut && $cut.nodeAfter;\n  if (!node || !NodeSelection.isSelectable(node)) { return false }\n  if (dispatch)\n    { dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos)).scrollIntoView()); }\n  return true\n}\n\nfunction findCutAfter($pos) {\n  if (!$pos.parent.type.spec.isolating) { for (var i = $pos.depth - 1; i >= 0; i--) {\n    var parent = $pos.node(i);\n    if ($pos.index(i) + 1 < parent.childCount) { return $pos.doc.resolve($pos.after(i + 1)) }\n    if (parent.type.spec.isolating) { break }\n  } }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Join the selected block or, if there is a text selection, the\n// closest ancestor block of the selection that can be joined, with\n// the sibling above it.\nfunction joinUp(state, dispatch) {\n  var sel = state.selection, nodeSel = sel instanceof NodeSelection, point;\n  if (nodeSel) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.from)) { return false }\n    point = sel.from;\n  } else {\n    point = joinPoint(state.doc, sel.from, -1);\n    if (point == null) { return false }\n  }\n  if (dispatch) {\n    var tr = state.tr.join(point);\n    if (nodeSel) { tr.setSelection(NodeSelection.create(tr.doc, point - state.doc.resolve(point).nodeBefore.nodeSize)); }\n    dispatch(tr.scrollIntoView());\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Join the selected block, or the closest ancestor of the selection\n// that can be joined, with the sibling after it.\nfunction joinDown(state, dispatch) {\n  var sel = state.selection, point;\n  if (sel instanceof NodeSelection) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.to)) { return false }\n    point = sel.to;\n  } else {\n    point = joinPoint(state.doc, sel.to, 1);\n    if (point == null) { return false }\n  }\n  if (dispatch)\n    { dispatch(state.tr.join(point).scrollIntoView()); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Lift the selected block, or the closest ancestor block of the\n// selection that can be lifted, out of its parent node.\nfunction lift(state, dispatch) {\n  var ref = state.selection;\n  var $from = ref.$from;\n  var $to = ref.$to;\n  var range = $from.blockRange($to), target = range && liftTarget(range);\n  if (target == null) { return false }\n  if (dispatch) { dispatch(state.tr.lift(range, target).scrollIntoView()); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If the selection is in a node whose type has a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, replace the\n// selection with a newline character.\nfunction newlineInCode(state, dispatch) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) { return false }\n  if (dispatch) { dispatch(state.tr.insertText(\"\\n\").scrollIntoView()); }\n  return true\n}\n\nfunction defaultBlockAt(match) {\n  for (var i = 0; i < match.edgeCount; i++) {\n    var ref = match.edge(i);\n    var type = ref.type;\n    if (type.isTextblock && !type.hasRequiredAttrs()) { return type }\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// When the selection is in a node with a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, create a\n// default block after the code block, and move the cursor there.\nfunction exitCode(state, dispatch) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) { return false }\n  var above = $head.node(-1), after = $head.indexAfter(-1), type = defaultBlockAt(above.contentMatchAt(after));\n  if (!above.canReplaceWith(after, after, type)) { return false }\n  if (dispatch) {\n    var pos = $head.after(), tr = state.tr.replaceWith(pos, pos, type.createAndFill());\n    tr.setSelection(Selection.near(tr.doc.resolve(pos), 1));\n    dispatch(tr.scrollIntoView());\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If a block node is selected, create an empty paragraph before (if\n// it is its parent's first child) or after it.\nfunction createParagraphNear(state, dispatch) {\n  var ref = state.selection;\n  var $from = ref.$from;\n  var $to = ref.$to;\n  if ($from.parent.inlineContent || $to.parent.inlineContent) { return false }\n  var type = defaultBlockAt($from.parent.contentMatchAt($to.indexAfter()));\n  if (!type || !type.isTextblock) { return false }\n  if (dispatch) {\n    var side = (!$from.parentOffset && $to.index() < $to.parent.childCount ? $from : $to).pos;\n    var tr = state.tr.insert(side, type.createAndFill());\n    tr.setSelection(TextSelection.create(tr.doc, side + 1));\n    dispatch(tr.scrollIntoView());\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If the cursor is in an empty textblock that can be lifted, lift the\n// block.\nfunction liftEmptyBlock(state, dispatch) {\n  var ref = state.selection;\n  var $cursor = ref.$cursor;\n  if (!$cursor || $cursor.parent.content.size) { return false }\n  if ($cursor.depth > 1 && $cursor.after() != $cursor.end(-1)) {\n    var before = $cursor.before();\n    if (canSplit(state.doc, before)) {\n      if (dispatch) { dispatch(state.tr.split(before).scrollIntoView()); }\n      return true\n    }\n  }\n  var range = $cursor.blockRange(), target = range && liftTarget(range);\n  if (target == null) { return false }\n  if (dispatch) { dispatch(state.tr.lift(range, target).scrollIntoView()); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Split the parent block of the selection. If the selection is a text\n// selection, also delete its content.\nfunction splitBlock(state, dispatch) {\n  var ref = state.selection;\n  var $from = ref.$from;\n  var $to = ref.$to;\n  if (state.selection instanceof NodeSelection && state.selection.node.isBlock) {\n    if (!$from.parentOffset || !canSplit(state.doc, $from.pos)) { return false }\n    if (dispatch) { dispatch(state.tr.split($from.pos).scrollIntoView()); }\n    return true\n  }\n\n  if (!$from.parent.isBlock) { return false }\n\n  if (dispatch) {\n    var atEnd = $to.parentOffset == $to.parent.content.size;\n    var tr = state.tr;\n    if (state.selection instanceof TextSelection) { tr.deleteSelection(); }\n    var deflt = $from.depth == 0 ? null : defaultBlockAt($from.node(-1).contentMatchAt($from.indexAfter(-1)));\n    var types = atEnd && deflt ? [{type: deflt}] : null;\n    var can = canSplit(tr.doc, tr.mapping.map($from.pos), 1, types);\n    if (!types && !can && canSplit(tr.doc, tr.mapping.map($from.pos), 1, deflt && [{type: deflt}])) {\n      types = [{type: deflt}];\n      can = true;\n    }\n    if (can) {\n      tr.split(tr.mapping.map($from.pos), 1, types);\n      if (!atEnd && !$from.parentOffset && $from.parent.type != deflt &&\n          $from.node(-1).canReplace($from.index(-1), $from.indexAfter(-1), Fragment.from([deflt.create(), $from.parent])))\n        { tr.setNodeMarkup(tr.mapping.map($from.before()), deflt); }\n    }\n    dispatch(tr.scrollIntoView());\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Acts like [`splitBlock`](#commands.splitBlock), but without\n// resetting the set of active marks at the cursor.\nfunction splitBlockKeepMarks(state, dispatch) {\n  return splitBlock(state, dispatch && (function (tr) {\n    var marks = state.storedMarks || (state.selection.$to.parentOffset && state.selection.$from.marks());\n    if (marks) { tr.ensureMarks(marks); }\n    dispatch(tr);\n  }))\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Move the selection to the node wrapping the current selection, if\n// any. (Will not select the document node.)\nfunction selectParentNode(state, dispatch) {\n  var ref = state.selection;\n  var $from = ref.$from;\n  var to = ref.to;\n  var pos;\n  var same = $from.sharedDepth(to);\n  if (same == 0) { return false }\n  pos = $from.before(same);\n  if (dispatch) { dispatch(state.tr.setSelection(NodeSelection.create(state.doc, pos))); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Select the whole document.\nfunction selectAll(state, dispatch) {\n  if (dispatch) { dispatch(state.tr.setSelection(new AllSelection(state.doc))); }\n  return true\n}\n\nfunction joinMaybeClear(state, $pos, dispatch) {\n  var before = $pos.nodeBefore, after = $pos.nodeAfter, index = $pos.index();\n  if (!before || !after || !before.type.compatibleContent(after.type)) { return false }\n  if (!before.content.size && $pos.parent.canReplace(index - 1, index)) {\n    if (dispatch) { dispatch(state.tr.delete($pos.pos - before.nodeSize, $pos.pos).scrollIntoView()); }\n    return true\n  }\n  if (!$pos.parent.canReplace(index, index + 1) || !(after.isTextblock || canJoin(state.doc, $pos.pos)))\n    { return false }\n  if (dispatch)\n    { dispatch(state.tr\n             .clearIncompatible($pos.pos, before.type, before.contentMatchAt(before.childCount))\n             .join($pos.pos)\n             .scrollIntoView()); }\n  return true\n}\n\nfunction deleteBarrier(state, $cut, dispatch) {\n  var before = $cut.nodeBefore, after = $cut.nodeAfter, conn, match;\n  if (before.type.spec.isolating || after.type.spec.isolating) { return false }\n  if (joinMaybeClear(state, $cut, dispatch)) { return true }\n\n  var canDelAfter = $cut.parent.canReplace($cut.index(), $cut.index() + 1);\n  if (canDelAfter &&\n      (conn = (match = before.contentMatchAt(before.childCount)).findWrapping(after.type)) &&\n      match.matchType(conn[0] || after.type).validEnd) {\n    if (dispatch) {\n      var end = $cut.pos + after.nodeSize, wrap = Fragment.empty;\n      for (var i = conn.length - 1; i >= 0; i--)\n        { wrap = Fragment.from(conn[i].create(null, wrap)); }\n      wrap = Fragment.from(before.copy(wrap));\n      var tr = state.tr.step(new ReplaceAroundStep($cut.pos - 1, end, $cut.pos, end, new Slice(wrap, 1, 0), conn.length, true));\n      var joinAt = end + 2 * conn.length;\n      if (canJoin(tr.doc, joinAt)) { tr.join(joinAt); }\n      dispatch(tr.scrollIntoView());\n    }\n    return true\n  }\n\n  var selAfter = Selection.findFrom($cut, 1);\n  var range = selAfter && selAfter.$from.blockRange(selAfter.$to), target = range && liftTarget(range);\n  if (target != null && target >= $cut.depth) {\n    if (dispatch) { dispatch(state.tr.lift(range, target).scrollIntoView()); }\n    return true\n  }\n\n  if (canDelAfter && after.isTextblock && textblockAt(before, \"end\")) {\n    var at = before, wrap$1 = [];\n    for (;;) {\n      wrap$1.push(at);\n      if (at.isTextblock) { break }\n      at = at.lastChild;\n    }\n    if (at.canReplace(at.childCount, at.childCount, after.content)) {\n      if (dispatch) {\n        var end$1 = Fragment.empty;\n        for (var i$1 = wrap$1.length - 1; i$1 >= 0; i$1--) { end$1 = Fragment.from(wrap$1[i$1].copy(end$1)); }\n        var tr$1 = state.tr.step(new ReplaceAroundStep($cut.pos - wrap$1.length, $cut.pos + after.nodeSize,\n                                                     $cut.pos + 1, $cut.pos + after.nodeSize - 1,\n                                                     new Slice(end$1, wrap$1.length, 0), 0, true));\n        dispatch(tr$1.scrollIntoView());\n      }\n      return true\n    }\n  }\n\n  return false\n}\n\n// Parameterized commands\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Wrap the selection in a node of the given type with the given\n// attributes.\nfunction wrapIn(nodeType, attrs) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var range = $from.blockRange($to), wrapping = range && findWrapping(range, nodeType, attrs);\n    if (!wrapping) { return false }\n    if (dispatch) { dispatch(state.tr.wrap(range, wrapping).scrollIntoView()); }\n    return true\n  }\n}\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Returns a command that tries to set the selected textblocks to the\n// given node type with the given attributes.\nfunction setBlockType(nodeType, attrs) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var from = ref.from;\n    var to = ref.to;\n    var applicable = false;\n    state.doc.nodesBetween(from, to, function (node, pos) {\n      if (applicable) { return false }\n      if (!node.isTextblock || node.hasMarkup(nodeType, attrs)) { return }\n      if (node.type == nodeType) {\n        applicable = true;\n      } else {\n        var $pos = state.doc.resolve(pos), index = $pos.index();\n        applicable = $pos.parent.canReplaceWith(index, index + 1, nodeType);\n      }\n    });\n    if (!applicable) { return false }\n    if (dispatch) { dispatch(state.tr.setBlockType(from, to, nodeType, attrs).scrollIntoView()); }\n    return true\n  }\n}\n\nfunction markApplies(doc, ranges, type) {\n  var loop = function ( i ) {\n    var ref = ranges[i];\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var can = $from.depth == 0 ? doc.type.allowsMarkType(type) : false;\n    doc.nodesBetween($from.pos, $to.pos, function (node) {\n      if (can) { return false }\n      can = node.inlineContent && node.type.allowsMarkType(type);\n    });\n    if (can) { return { v: true } }\n  };\n\n  for (var i = 0; i < ranges.length; i++) {\n    var returned = loop( i );\n\n    if ( returned ) return returned.v;\n  }\n  return false\n}\n\n// :: (MarkType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command function that toggles the given mark with the\n// given attributes. Will return `false` when the current selection\n// doesn't support that mark. This will remove the mark if any marks\n// of that type exist in the selection, or add it otherwise. If the\n// selection is empty, this applies to the [stored\n// marks](#state.EditorState.storedMarks) instead of a range of the\n// document.\nfunction toggleMark(markType, attrs) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var empty = ref.empty;\n    var $cursor = ref.$cursor;\n    var ranges = ref.ranges;\n    if ((empty && !$cursor) || !markApplies(state.doc, ranges, markType)) { return false }\n    if (dispatch) {\n      if ($cursor) {\n        if (markType.isInSet(state.storedMarks || $cursor.marks()))\n          { dispatch(state.tr.removeStoredMark(markType)); }\n        else\n          { dispatch(state.tr.addStoredMark(markType.create(attrs))); }\n      } else {\n        var has = false, tr = state.tr;\n        for (var i = 0; !has && i < ranges.length; i++) {\n          var ref$1 = ranges[i];\n          var $from = ref$1.$from;\n          var $to = ref$1.$to;\n          has = state.doc.rangeHasMark($from.pos, $to.pos, markType);\n        }\n        for (var i$1 = 0; i$1 < ranges.length; i$1++) {\n          var ref$2 = ranges[i$1];\n          var $from$1 = ref$2.$from;\n          var $to$1 = ref$2.$to;\n          if (has) {\n            tr.removeMark($from$1.pos, $to$1.pos, markType);\n          } else {\n            var from = $from$1.pos, to = $to$1.pos, start = $from$1.nodeAfter, end = $to$1.nodeBefore;\n            var spaceStart = start && start.isText ? /^\\s*/.exec(start.text)[0].length : 0;\n            var spaceEnd = end && end.isText ? /\\s*$/.exec(end.text)[0].length : 0;\n            if (from + spaceStart < to) { from += spaceStart; to -= spaceEnd; }\n            tr.addMark(from, to, markType.create(attrs));\n          }\n        }\n        dispatch(tr.scrollIntoView());\n      }\n    }\n    return true\n  }\n}\n\nfunction wrapDispatchForJoin(dispatch, isJoinable) {\n  return function (tr) {\n    if (!tr.isGeneric) { return dispatch(tr) }\n\n    var ranges = [];\n    for (var i = 0; i < tr.mapping.maps.length; i++) {\n      var map = tr.mapping.maps[i];\n      for (var j = 0; j < ranges.length; j++)\n        { ranges[j] = map.map(ranges[j]); }\n      map.forEach(function (_s, _e, from, to) { return ranges.push(from, to); });\n    }\n\n    // Figure out which joinable points exist inside those ranges,\n    // by checking all node boundaries in their parent nodes.\n    var joinable = [];\n    for (var i$1 = 0; i$1 < ranges.length; i$1 += 2) {\n      var from = ranges[i$1], to = ranges[i$1 + 1];\n      var $from = tr.doc.resolve(from), depth = $from.sharedDepth(to), parent = $from.node(depth);\n      for (var index = $from.indexAfter(depth), pos = $from.after(depth + 1); pos <= to; ++index) {\n        var after = parent.maybeChild(index);\n        if (!after) { break }\n        if (index && joinable.indexOf(pos) == -1) {\n          var before = parent.child(index - 1);\n          if (before.type == after.type && isJoinable(before, after))\n            { joinable.push(pos); }\n        }\n        pos += after.nodeSize;\n      }\n    }\n    // Join the joinable points\n    joinable.sort(function (a, b) { return a - b; });\n    for (var i$2 = joinable.length - 1; i$2 >= 0; i$2--) {\n      if (canJoin(tr.doc, joinable[i$2])) { tr.join(joinable[i$2]); }\n    }\n    dispatch(tr);\n  }\n}\n\n// :: ((state: EditorState, ?(tr: Transaction)) → bool, union<(before: Node, after: Node) → bool, [string]>) → (state: EditorState, ?(tr: Transaction)) → bool\n// Wrap a command so that, when it produces a transform that causes\n// two joinable nodes to end up next to each other, those are joined.\n// Nodes are considered joinable when they are of the same type and\n// when the `isJoinable` predicate returns true for them or, if an\n// array of strings was passed, if their node type name is in that\n// array.\nfunction autoJoin(command, isJoinable) {\n  if (Array.isArray(isJoinable)) {\n    var types = isJoinable;\n    isJoinable = function (node) { return types.indexOf(node.type.name) > -1; };\n  }\n  return function (state, dispatch) { return command(state, dispatch && wrapDispatchForJoin(dispatch, isJoinable)); }\n}\n\n// :: (...[(EditorState, ?(tr: Transaction), ?EditorView) → bool]) → (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// Combine a number of command functions into a single function (which\n// calls them one by one until one returns true).\nfunction chainCommands() {\n  var commands = [], len = arguments.length;\n  while ( len-- ) commands[ len ] = arguments[ len ];\n\n  return function(state, dispatch, view) {\n    for (var i = 0; i < commands.length; i++)\n      { if (commands[i](state, dispatch, view)) { return true } }\n    return false\n  }\n}\n\nvar backspace = chainCommands(deleteSelection, joinBackward, selectNodeBackward);\nvar del = chainCommands(deleteSelection, joinForward, selectNodeForward);\n\n// :: Object\n// A basic keymap containing bindings not specific to any schema.\n// Binds the following keys (when multiple commands are listed, they\n// are chained with [`chainCommands`](#commands.chainCommands)):\n//\n// * **Enter** to `newlineInCode`, `createParagraphNear`, `liftEmptyBlock`, `splitBlock`\n// * **Mod-Enter** to `exitCode`\n// * **Backspace** and **Mod-Backspace** to `deleteSelection`, `joinBackward`, `selectNodeBackward`\n// * **Delete** and **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-a** to `selectAll`\nvar pcBaseKeymap = {\n  \"Enter\": chainCommands(newlineInCode, createParagraphNear, liftEmptyBlock, splitBlock),\n  \"Mod-Enter\": exitCode,\n  \"Backspace\": backspace,\n  \"Mod-Backspace\": backspace,\n  \"Delete\": del,\n  \"Mod-Delete\": del,\n  \"Mod-a\": selectAll\n};\n\n// :: Object\n// A copy of `pcBaseKeymap` that also binds **Ctrl-h** like Backspace,\n// **Ctrl-d** like Delete, **Alt-Backspace** like Ctrl-Backspace, and\n// **Ctrl-Alt-Backspace**, **Alt-Delete**, and **Alt-d** like\n// Ctrl-Delete.\nvar macBaseKeymap = {\n  \"Ctrl-h\": pcBaseKeymap[\"Backspace\"],\n  \"Alt-Backspace\": pcBaseKeymap[\"Mod-Backspace\"],\n  \"Ctrl-d\": pcBaseKeymap[\"Delete\"],\n  \"Ctrl-Alt-Backspace\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-Delete\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-d\": pcBaseKeymap[\"Mod-Delete\"]\n};\nfor (var key in pcBaseKeymap) { macBaseKeymap[key] = pcBaseKeymap[key]; }\n\n// declare global: os, navigator\nvar mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform)\n          : typeof os != \"undefined\" ? os.platform() == \"darwin\" : false;\n\n// :: Object\n// Depending on the detected platform, this will hold\n// [`pcBasekeymap`](#commands.pcBaseKeymap) or\n// [`macBaseKeymap`](#commands.macBaseKeymap).\nvar baseKeymap = mac ? macBaseKeymap : pcBaseKeymap;\n\nexport { autoJoin, baseKeymap, chainCommands, createParagraphNear, deleteSelection, exitCode, joinBackward, joinDown, joinForward, joinUp, lift, liftEmptyBlock, macBaseKeymap, newlineInCode, pcBaseKeymap, selectAll, selectNodeBackward, selectNodeForward, selectParentNode, setBlockType, splitBlock, splitBlockKeepMarks, toggleMark, wrapIn };\n//# sourceMappingURL=index.es.js.map\n","import { Plugin } from 'prosemirror-state';\nimport { dropPoint } from 'prosemirror-transform';\n\n// :: (options: ?Object) → Plugin\n// Create a plugin that, when added to a ProseMirror instance,\n// causes a decoration to show up at the drop position when something\n// is dragged over the editor.\n//\n//   options::- These options are supported:\n//\n//     color:: ?string\n//     The color of the cursor. Defaults to `black`.\n//\n//     width:: ?number\n//     The precise width of the cursor in pixels. Defaults to 1.\n//\n//     class:: ?string\n//     A CSS class name to add to the cursor element.\nfunction dropCursor(options) {\n  if ( options === void 0 ) options = {};\n\n  return new Plugin({\n    view: function view(editorView) { return new DropCursorView(editorView, options) }\n  })\n}\n\nvar DropCursorView = function DropCursorView(editorView, options) {\n  var this$1 = this;\n\n  this.editorView = editorView;\n  this.width = options.width || 1;\n  this.color = options.color || \"black\";\n  this.class = options.class;\n  this.cursorPos = null;\n  this.element = null;\n  this.timeout = null;\n\n  this.handlers = [\"dragover\", \"dragend\", \"drop\", \"dragleave\"].map(function (name) {\n    var handler = function (e) { return this$1[name](e); };\n    editorView.dom.addEventListener(name, handler);\n    return {name: name, handler: handler}\n  });\n};\n\nDropCursorView.prototype.destroy = function destroy () {\n    var this$1 = this;\n\n  this.handlers.forEach(function (ref) {\n      var name = ref.name;\n      var handler = ref.handler;\n\n      return this$1.editorView.dom.removeEventListener(name, handler);\n    });\n};\n\nDropCursorView.prototype.update = function update (editorView, prevState) {\n  if (this.cursorPos != null && prevState.doc != editorView.state.doc) { this.updateOverlay(); }\n};\n\nDropCursorView.prototype.setCursor = function setCursor (pos) {\n  if (pos == this.cursorPos) { return }\n  this.cursorPos = pos;\n  if (pos == null) {\n    this.element.parentNode.removeChild(this.element);\n    this.element = null;\n  } else {\n    this.updateOverlay();\n  }\n};\n\nDropCursorView.prototype.updateOverlay = function updateOverlay () {\n  var $pos = this.editorView.state.doc.resolve(this.cursorPos), rect;\n  if (!$pos.parent.inlineContent) {\n    var before = $pos.nodeBefore, after = $pos.nodeAfter;\n    if (before || after) {\n      var nodeRect = this.editorView.nodeDOM(this.cursorPos - (before ?before.nodeSize : 0)).getBoundingClientRect();\n      var top = before ? nodeRect.bottom : nodeRect.top;\n      if (before && after)\n        { top = (top + this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top) / 2; }\n      rect = {left: nodeRect.left, right: nodeRect.right, top: top - this.width / 2, bottom: top + this.width / 2};\n    }\n  }\n  if (!rect) {\n    var coords = this.editorView.coordsAtPos(this.cursorPos);\n    rect = {left: coords.left - this.width / 2, right: coords.left + this.width / 2, top: coords.top, bottom: coords.bottom};\n  }\n\n  var parent = this.editorView.dom.offsetParent;\n  if (!this.element) {\n    this.element = parent.appendChild(document.createElement(\"div\"));\n    if (this.class) { this.element.className = this.class; }\n    this.element.style.cssText = \"position: absolute; z-index: 50; pointer-events: none; background-color: \" + this.color;\n  }\n  var parentRect = !parent || parent == document.body && getComputedStyle(parent).position == \"static\"\n      ? {left: -pageXOffset, top: -pageYOffset} : parent.getBoundingClientRect();\n  this.element.style.left = (rect.left - parentRect.left) + \"px\";\n  this.element.style.top = (rect.top - parentRect.top) + \"px\";\n  this.element.style.width = (rect.right - rect.left) + \"px\";\n  this.element.style.height = (rect.bottom - rect.top) + \"px\";\n};\n\nDropCursorView.prototype.scheduleRemoval = function scheduleRemoval (timeout) {\n    var this$1 = this;\n\n  clearTimeout(this.timeout);\n  this.timeout = setTimeout(function () { return this$1.setCursor(null); }, timeout);\n};\n\nDropCursorView.prototype.dragover = function dragover (event) {\n  if (!this.editorView.editable) { return }\n  var pos = this.editorView.posAtCoords({left: event.clientX, top: event.clientY});\n  if (pos) {\n    var target = pos.pos;\n    if (this.editorView.dragging && this.editorView.dragging.slice) {\n      target = dropPoint(this.editorView.state.doc, target, this.editorView.dragging.slice);\n      if (target == null) { target = pos.pos; }\n    }\n    this.setCursor(target);\n    this.scheduleRemoval(5000);\n  }\n};\n\nDropCursorView.prototype.dragend = function dragend () {\n  this.scheduleRemoval(20);\n};\n\nDropCursorView.prototype.drop = function drop () {\n  this.scheduleRemoval(20);\n};\n\nDropCursorView.prototype.dragleave = function dragleave (event) {\n  if (event.target == this.editorView.dom || !this.editorView.dom.contains(event.relatedTarget))\n    { this.setCursor(null); }\n};\n\nexport { dropCursor };\n//# sourceMappingURL=index.es.js.map\n","import { TextSelection, NodeSelection, Selection } from 'prosemirror-state';\nimport { DOMSerializer, Fragment, Mark, DOMParser, Slice } from 'prosemirror-model';\nimport { dropPoint } from 'prosemirror-transform';\n\nvar result = {};\n\nif (typeof navigator != \"undefined\" && typeof document != \"undefined\") {\n  var ie_edge = /Edge\\/(\\d+)/.exec(navigator.userAgent);\n  var ie_upto10 = /MSIE \\d/.test(navigator.userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent);\n\n  result.mac = /Mac/.test(navigator.platform);\n  var ie = result.ie = !!(ie_upto10 || ie_11up || ie_edge);\n  result.ie_version = ie_upto10 ? document.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : null;\n  result.gecko = !ie && /gecko\\/(\\d+)/i.test(navigator.userAgent);\n  result.gecko_version = result.gecko && +(/Firefox\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n  var chrome = !ie && /Chrome\\/(\\d+)/.exec(navigator.userAgent);\n  result.chrome = !!chrome;\n  result.chrome_version = chrome && +chrome[1];\n  // Is true for both iOS and iPadOS for convenience\n  result.safari = !ie && /Apple Computer/.test(navigator.vendor);\n  result.ios = result.safari && (/Mobile\\/\\w+/.test(navigator.userAgent) || navigator.maxTouchPoints > 2);\n  result.android = /Android \\d/.test(navigator.userAgent);\n  result.webkit = \"webkitFontSmoothing\" in document.documentElement.style;\n  result.webkit_version = result.webkit && +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n}\n\nvar domIndex = function(node) {\n  for (var index = 0;; index++) {\n    node = node.previousSibling;\n    if (!node) { return index }\n  }\n};\n\nvar parentNode = function(node) {\n  var parent = node.parentNode;\n  return parent && parent.nodeType == 11 ? parent.host : parent\n};\n\nvar reusedRange = null;\n\n// Note that this will always return the same range, because DOM range\n// objects are every expensive, and keep slowing down subsequent DOM\n// updates, for some reason.\nvar textRange = function(node, from, to) {\n  var range = reusedRange || (reusedRange = document.createRange());\n  range.setEnd(node, to == null ? node.nodeValue.length : to);\n  range.setStart(node, from || 0);\n  return range\n};\n\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nvar isEquivalentPosition = function(node, off, targetNode, targetOff) {\n  return targetNode && (scanFor(node, off, targetNode, targetOff, -1) ||\n                        scanFor(node, off, targetNode, targetOff, 1))\n};\n\nvar atomElements = /^(img|br|input|textarea|hr)$/i;\n\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n  for (;;) {\n    if (node == targetNode && off == targetOff) { return true }\n    if (off == (dir < 0 ? 0 : nodeSize(node))) {\n      var parent = node.parentNode;\n      if (parent.nodeType != 1 || hasBlockDesc(node) || atomElements.test(node.nodeName) || node.contentEditable == \"false\")\n        { return false }\n      off = domIndex(node) + (dir < 0 ? 0 : 1);\n      node = parent;\n    } else if (node.nodeType == 1) {\n      node = node.childNodes[off + (dir < 0 ? -1 : 0)];\n      if (node.contentEditable == \"false\") { return false }\n      off = dir < 0 ? nodeSize(node) : 0;\n    } else {\n      return false\n    }\n  }\n}\n\nfunction nodeSize(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isOnEdge(node, offset, parent) {\n  for (var atStart = offset == 0, atEnd = offset == nodeSize(node); atStart || atEnd;) {\n    if (node == parent) { return true }\n    var index = domIndex(node);\n    node = node.parentNode;\n    if (!node) { return false }\n    atStart = atStart && index == 0;\n    atEnd = atEnd && index == nodeSize(node);\n  }\n}\n\nfunction hasBlockDesc(dom) {\n  var desc;\n  for (var cur = dom; cur; cur = cur.parentNode) { if (desc = cur.pmViewDesc) { break } }\n  return desc && desc.node && desc.node.isBlock && (desc.dom == dom || desc.contentDOM == dom)\n}\n\n// Work around Chrome issue https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n// (isCollapsed inappropriately returns true in shadow dom)\nvar selectionCollapsed = function(domSel) {\n  var collapsed = domSel.isCollapsed;\n  if (collapsed && result.chrome && domSel.rangeCount && !domSel.getRangeAt(0).collapsed)\n    { collapsed = false; }\n  return collapsed\n};\n\nfunction keyEvent(keyCode, key) {\n  var event = document.createEvent(\"Event\");\n  event.initEvent(\"keydown\", true, true);\n  event.keyCode = keyCode;\n  event.key = event.code = key;\n  return event\n}\n\nfunction windowRect(doc) {\n  return {left: 0, right: doc.documentElement.clientWidth,\n          top: 0, bottom: doc.documentElement.clientHeight}\n}\n\nfunction getSide(value, side) {\n  return typeof value == \"number\" ? value : value[side]\n}\n\nfunction clientRect(node) {\n  var rect = node.getBoundingClientRect();\n  // Make sure scrollbar width isn't included in the rectangle\n  return {left: rect.left, right: rect.left + node.clientWidth,\n          top: rect.top, bottom: rect.top + node.clientHeight}\n}\n\nfunction scrollRectIntoView(view, rect, startDOM) {\n  var scrollThreshold = view.someProp(\"scrollThreshold\") || 0, scrollMargin = view.someProp(\"scrollMargin\") || 5;\n  var doc = view.dom.ownerDocument;\n  for (var parent = startDOM || view.dom;; parent = parentNode(parent)) {\n    if (!parent) { break }\n    if (parent.nodeType != 1) { continue }\n    var atTop = parent == doc.body || parent.nodeType != 1;\n    var bounding = atTop ? windowRect(doc) : clientRect(parent);\n    var moveX = 0, moveY = 0;\n    if (rect.top < bounding.top + getSide(scrollThreshold, \"top\"))\n      { moveY = -(bounding.top - rect.top + getSide(scrollMargin, \"top\")); }\n    else if (rect.bottom > bounding.bottom - getSide(scrollThreshold, \"bottom\"))\n      { moveY = rect.bottom - bounding.bottom + getSide(scrollMargin, \"bottom\"); }\n    if (rect.left < bounding.left + getSide(scrollThreshold, \"left\"))\n      { moveX = -(bounding.left - rect.left + getSide(scrollMargin, \"left\")); }\n    else if (rect.right > bounding.right - getSide(scrollThreshold, \"right\"))\n      { moveX = rect.right - bounding.right + getSide(scrollMargin, \"right\"); }\n    if (moveX || moveY) {\n      if (atTop) {\n        doc.defaultView.scrollBy(moveX, moveY);\n      } else {\n        var startX = parent.scrollLeft, startY = parent.scrollTop;\n        if (moveY) { parent.scrollTop += moveY; }\n        if (moveX) { parent.scrollLeft += moveX; }\n        var dX = parent.scrollLeft - startX, dY = parent.scrollTop - startY;\n        rect = {left: rect.left - dX, top: rect.top - dY, right: rect.right - dX, bottom: rect.bottom - dY};\n      }\n    }\n    if (atTop) { break }\n  }\n}\n\n// Store the scroll position of the editor's parent nodes, along with\n// the top position of an element near the top of the editor, which\n// will be used to make sure the visible viewport remains stable even\n// when the size of the content above changes.\nfunction storeScrollPos(view) {\n  var rect = view.dom.getBoundingClientRect(), startY = Math.max(0, rect.top);\n  var refDOM, refTop;\n  for (var x = (rect.left + rect.right) / 2, y = startY + 1;\n       y < Math.min(innerHeight, rect.bottom); y += 5) {\n    var dom = view.root.elementFromPoint(x, y);\n    if (dom == view.dom || !view.dom.contains(dom)) { continue }\n    var localRect = dom.getBoundingClientRect();\n    if (localRect.top >= startY - 20) {\n      refDOM = dom;\n      refTop = localRect.top;\n      break\n    }\n  }\n  return {refDOM: refDOM, refTop: refTop, stack: scrollStack(view.dom)}\n}\n\nfunction scrollStack(dom) {\n  var stack = [], doc = dom.ownerDocument;\n  for (; dom; dom = parentNode(dom)) {\n    stack.push({dom: dom, top: dom.scrollTop, left: dom.scrollLeft});\n    if (dom == doc) { break }\n  }\n  return stack\n}\n\n// Reset the scroll position of the editor's parent nodes to that what\n// it was before, when storeScrollPos was called.\nfunction resetScrollPos(ref) {\n  var refDOM = ref.refDOM;\n  var refTop = ref.refTop;\n  var stack = ref.stack;\n\n  var newRefTop = refDOM ? refDOM.getBoundingClientRect().top : 0;\n  restoreScrollStack(stack, newRefTop == 0 ? 0 : newRefTop - refTop);\n}\n\nfunction restoreScrollStack(stack, dTop) {\n  for (var i = 0; i < stack.length; i++) {\n    var ref = stack[i];\n    var dom = ref.dom;\n    var top = ref.top;\n    var left = ref.left;\n    if (dom.scrollTop != top + dTop) { dom.scrollTop = top + dTop; }\n    if (dom.scrollLeft != left) { dom.scrollLeft = left; }\n  }\n}\n\nvar preventScrollSupported = null;\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nfunction focusPreventScroll(dom) {\n  if (dom.setActive) { return dom.setActive() } // in IE\n  if (preventScrollSupported) { return dom.focus(preventScrollSupported) }\n\n  var stored = scrollStack(dom);\n  dom.focus(preventScrollSupported == null ? {\n    get preventScroll() {\n      preventScrollSupported = {preventScroll: true};\n      return true\n    }\n  } : undefined);\n  if (!preventScrollSupported) {\n    preventScrollSupported = false;\n    restoreScrollStack(stored, 0);\n  }\n}\n\nfunction findOffsetInNode(node, coords) {\n  var closest, dxClosest = 2e8, coordsClosest, offset = 0;\n  var rowBot = coords.top, rowTop = coords.top;\n  for (var child = node.firstChild, childIndex = 0; child; child = child.nextSibling, childIndex++) {\n    var rects = (void 0);\n    if (child.nodeType == 1) { rects = child.getClientRects(); }\n    else if (child.nodeType == 3) { rects = textRange(child).getClientRects(); }\n    else { continue }\n\n    for (var i = 0; i < rects.length; i++) {\n      var rect = rects[i];\n      if (rect.top <= rowBot && rect.bottom >= rowTop) {\n        rowBot = Math.max(rect.bottom, rowBot);\n        rowTop = Math.min(rect.top, rowTop);\n        var dx = rect.left > coords.left ? rect.left - coords.left\n            : rect.right < coords.left ? coords.left - rect.right : 0;\n        if (dx < dxClosest) {\n          closest = child;\n          dxClosest = dx;\n          coordsClosest = dx && closest.nodeType == 3 ? {left: rect.right < coords.left ? rect.right : rect.left, top: coords.top} : coords;\n          if (child.nodeType == 1 && dx)\n            { offset = childIndex + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0); }\n          continue\n        }\n      }\n      if (!closest && (coords.left >= rect.right && coords.top >= rect.top ||\n                       coords.left >= rect.left && coords.top >= rect.bottom))\n        { offset = childIndex + 1; }\n    }\n  }\n  if (closest && closest.nodeType == 3) { return findOffsetInText(closest, coordsClosest) }\n  if (!closest || (dxClosest && closest.nodeType == 1)) { return {node: node, offset: offset} }\n  return findOffsetInNode(closest, coordsClosest)\n}\n\nfunction findOffsetInText(node, coords) {\n  var len = node.nodeValue.length;\n  var range = document.createRange();\n  for (var i = 0; i < len; i++) {\n    range.setEnd(node, i + 1);\n    range.setStart(node, i);\n    var rect = singleRect(range, 1);\n    if (rect.top == rect.bottom) { continue }\n    if (inRect(coords, rect))\n      { return {node: node, offset: i + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)} }\n  }\n  return {node: node, offset: 0}\n}\n\nfunction inRect(coords, rect) {\n  return coords.left >= rect.left - 1 && coords.left <= rect.right + 1&&\n    coords.top >= rect.top - 1 && coords.top <= rect.bottom + 1\n}\n\nfunction targetKludge(dom, coords) {\n  var parent = dom.parentNode;\n  if (parent && /^li$/i.test(parent.nodeName) && coords.left < dom.getBoundingClientRect().left)\n    { return parent }\n  return dom\n}\n\nfunction posFromElement(view, elt, coords) {\n  var ref = findOffsetInNode(elt, coords);\n  var node = ref.node;\n  var offset = ref.offset;\n  var bias = -1;\n  if (node.nodeType == 1 && !node.firstChild) {\n    var rect = node.getBoundingClientRect();\n    bias = rect.left != rect.right && coords.left > (rect.left + rect.right) / 2 ? 1 : -1;\n  }\n  return view.docView.posFromDOM(node, offset, bias)\n}\n\nfunction posFromCaret(view, node, offset, coords) {\n  // Browser (in caretPosition/RangeFromPoint) will agressively\n  // normalize towards nearby inline nodes. Since we are interested in\n  // positions between block nodes too, we first walk up the hierarchy\n  // of nodes to see if there are block nodes that the coordinates\n  // fall outside of. If so, we take the position before/after that\n  // block. If not, we call `posFromDOM` on the raw node/offset.\n  var outside = -1;\n  for (var cur = node;;) {\n    if (cur == view.dom) { break }\n    var desc = view.docView.nearestDesc(cur, true);\n    if (!desc) { return null }\n    if (desc.node.isBlock && desc.parent) {\n      var rect = desc.dom.getBoundingClientRect();\n      if (rect.left > coords.left || rect.top > coords.top) { outside = desc.posBefore; }\n      else if (rect.right < coords.left || rect.bottom < coords.top) { outside = desc.posAfter; }\n      else { break }\n    }\n    cur = desc.dom.parentNode;\n  }\n  return outside > -1 ? outside : view.docView.posFromDOM(node, offset)\n}\n\nfunction elementFromPoint(element, coords, box) {\n  var len = element.childNodes.length;\n  if (len && box.top < box.bottom) {\n    for (var startI = Math.max(0, Math.min(len - 1, Math.floor(len * (coords.top - box.top) / (box.bottom - box.top)) - 2)), i = startI;;) {\n      var child = element.childNodes[i];\n      if (child.nodeType == 1) {\n        var rects = child.getClientRects();\n        for (var j = 0; j < rects.length; j++) {\n          var rect = rects[j];\n          if (inRect(coords, rect)) { return elementFromPoint(child, coords, rect) }\n        }\n      }\n      if ((i = (i + 1) % len) == startI) { break }\n    }\n  }\n  return element\n}\n\n// Given an x,y position on the editor, get the position in the document.\nfunction posAtCoords(view, coords) {\n  var assign, assign$1;\n\n  var root = view.root, node, offset;\n  if (root.caretPositionFromPoint) {\n    try { // Firefox throws for this call in hard-to-predict circumstances (#994)\n      var pos$1 = root.caretPositionFromPoint(coords.left, coords.top);\n      if (pos$1) { ((assign = pos$1, node = assign.offsetNode, offset = assign.offset)); }\n    } catch (_) {}\n  }\n  if (!node && root.caretRangeFromPoint) {\n    var range = root.caretRangeFromPoint(coords.left, coords.top);\n    if (range) { ((assign$1 = range, node = assign$1.startContainer, offset = assign$1.startOffset)); }\n  }\n\n  var elt = root.elementFromPoint(coords.left, coords.top + 1), pos;\n  if (!elt || !view.dom.contains(elt.nodeType != 1 ? elt.parentNode : elt)) {\n    var box = view.dom.getBoundingClientRect();\n    if (!inRect(coords, box)) { return null }\n    elt = elementFromPoint(view.dom, coords, box);\n    if (!elt) { return null }\n  }\n  // Safari's caretRangeFromPoint returns nonsense when on a draggable element\n  if (result.safari && elt.draggable) { node = offset = null; }\n  elt = targetKludge(elt, coords);\n  if (node) {\n    if (result.gecko && node.nodeType == 1) {\n      // Firefox will sometimes return offsets into <input> nodes, which\n      // have no actual children, from caretPositionFromPoint (#953)\n      offset = Math.min(offset, node.childNodes.length);\n      // It'll also move the returned position before image nodes,\n      // even if those are behind it.\n      if (offset < node.childNodes.length) {\n        var next = node.childNodes[offset], box$1;\n        if (next.nodeName == \"IMG\" && (box$1 = next.getBoundingClientRect()).right <= coords.left &&\n            box$1.bottom > coords.top)\n          { offset++; }\n      }\n    }\n    // Suspiciously specific kludge to work around caret*FromPoint\n    // never returning a position at the end of the document\n    if (node == view.dom && offset == node.childNodes.length - 1 && node.lastChild.nodeType == 1 &&\n        coords.top > node.lastChild.getBoundingClientRect().bottom)\n      { pos = view.state.doc.content.size; }\n    // Ignore positions directly after a BR, since caret*FromPoint\n    // 'round up' positions that would be more accurately placed\n    // before the BR node.\n    else if (offset == 0 || node.nodeType != 1 || node.childNodes[offset - 1].nodeName != \"BR\")\n      { pos = posFromCaret(view, node, offset, coords); }\n  }\n  if (pos == null) { pos = posFromElement(view, elt, coords); }\n\n  var desc = view.docView.nearestDesc(elt, true);\n  return {pos: pos, inside: desc ? desc.posAtStart - desc.border : -1}\n}\n\nfunction singleRect(object, bias) {\n  var rects = object.getClientRects();\n  return !rects.length ? object.getBoundingClientRect() : rects[bias < 0 ? 0 : rects.length - 1]\n}\n\nvar BIDI = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n\n// : (EditorView, number, number) → {left: number, top: number, right: number, bottom: number}\n// Given a position in the document model, get a bounding box of the\n// character at that position, relative to the window.\nfunction coordsAtPos(view, pos, side) {\n  var ref = view.docView.domFromPos(pos, side < 0 ? -1 : 1);\n  var node = ref.node;\n  var offset = ref.offset;\n\n  var supportEmptyRange = result.webkit || result.gecko;\n  if (node.nodeType == 3) {\n    // These browsers support querying empty text ranges. Prefer that in\n    // bidi context or when at the end of a node.\n    if (supportEmptyRange && (BIDI.test(node.nodeValue) || (side < 0 ? !offset : offset == node.nodeValue.length))) {\n      var rect = singleRect(textRange(node, offset, offset), side);\n      // Firefox returns bad results (the position before the space)\n      // when querying a position directly after line-broken\n      // whitespace. Detect this situation and and kludge around it\n      if (result.gecko && offset && /\\s/.test(node.nodeValue[offset - 1]) && offset < node.nodeValue.length) {\n        var rectBefore = singleRect(textRange(node, offset - 1, offset - 1), -1);\n        if (rectBefore.top == rect.top) {\n          var rectAfter = singleRect(textRange(node, offset, offset + 1), -1);\n          if (rectAfter.top != rect.top)\n            { return flattenV(rectAfter, rectAfter.left < rectBefore.left) }\n        }\n      }\n      return rect\n    } else {\n      var from = offset, to = offset, takeSide = side < 0 ? 1 : -1;\n      if (side < 0 && !offset) { to++; takeSide = -1; }\n      else if (side >= 0 && offset == node.nodeValue.length) { from--; takeSide = 1; }\n      else if (side < 0) { from--; }\n      else { to ++; }\n      return flattenV(singleRect(textRange(node, from, to), takeSide), takeSide < 0)\n    }\n  }\n\n  // Return a horizontal line in block context\n  if (!view.state.doc.resolve(pos).parent.inlineContent) {\n    if (offset && (side < 0 || offset == nodeSize(node))) {\n      var before = node.childNodes[offset - 1];\n      if (before.nodeType == 1) { return flattenH(before.getBoundingClientRect(), false) }\n    }\n    if (offset < nodeSize(node)) {\n      var after = node.childNodes[offset];\n      if (after.nodeType == 1) { return flattenH(after.getBoundingClientRect(), true) }\n    }\n    return flattenH(node.getBoundingClientRect(), side >= 0)\n  }\n\n  // Inline, not in text node (this is not Bidi-safe)\n  if (offset && (side < 0 || offset == nodeSize(node))) {\n    var before$1 = node.childNodes[offset - 1];\n    var target = before$1.nodeType == 3 ? textRange(before$1, nodeSize(before$1) - (supportEmptyRange ? 0 : 1))\n        // BR nodes tend to only return the rectangle before them.\n        // Only use them if they are the last element in their parent\n        : before$1.nodeType == 1 && (before$1.nodeName != \"BR\" || !before$1.nextSibling) ? before$1 : null;\n    if (target) { return flattenV(singleRect(target, 1), false) }\n  }\n  if (offset < nodeSize(node)) {\n    var after$1 = node.childNodes[offset];\n    var target$1 = after$1.nodeType == 3 ? textRange(after$1, 0, (supportEmptyRange ? 0 : 1))\n        : after$1.nodeType == 1 ? after$1 : null;\n    if (target$1) { return flattenV(singleRect(target$1, -1), true) }\n  }\n  // All else failed, just try to get a rectangle for the target node\n  return flattenV(singleRect(node.nodeType == 3 ? textRange(node) : node, -side), side >= 0)\n}\n\nfunction flattenV(rect, left) {\n  if (rect.width == 0) { return rect }\n  var x = left ? rect.left : rect.right;\n  return {top: rect.top, bottom: rect.bottom, left: x, right: x}\n}\n\nfunction flattenH(rect, top) {\n  if (rect.height == 0) { return rect }\n  var y = top ? rect.top : rect.bottom;\n  return {top: y, bottom: y, left: rect.left, right: rect.right}\n}\n\nfunction withFlushedState(view, state, f) {\n  var viewState = view.state, active = view.root.activeElement;\n  if (viewState != state) { view.updateState(state); }\n  if (active != view.dom) { view.focus(); }\n  try {\n    return f()\n  } finally {\n    if (viewState != state) { view.updateState(viewState); }\n    if (active != view.dom && active) { active.focus(); }\n  }\n}\n\n// : (EditorView, number, number)\n// Whether vertical position motion in a given direction\n// from a position would leave a text block.\nfunction endOfTextblockVertical(view, state, dir) {\n  var sel = state.selection;\n  var $pos = dir == \"up\" ? sel.$from : sel.$to;\n  return withFlushedState(view, state, function () {\n    var ref = view.docView.domFromPos($pos.pos, dir == \"up\" ? -1 : 1);\n    var dom = ref.node;\n    for (;;) {\n      var nearest = view.docView.nearestDesc(dom, true);\n      if (!nearest) { break }\n      if (nearest.node.isBlock) { dom = nearest.dom; break }\n      dom = nearest.dom.parentNode;\n    }\n    var coords = coordsAtPos(view, $pos.pos, 1);\n    for (var child = dom.firstChild; child; child = child.nextSibling) {\n      var boxes = (void 0);\n      if (child.nodeType == 1) { boxes = child.getClientRects(); }\n      else if (child.nodeType == 3) { boxes = textRange(child, 0, child.nodeValue.length).getClientRects(); }\n      else { continue }\n      for (var i = 0; i < boxes.length; i++) {\n        var box = boxes[i];\n        if (box.bottom > box.top && (dir == \"up\" ? box.bottom < coords.top + 1 : box.top > coords.bottom - 1))\n          { return false }\n      }\n    }\n    return true\n  })\n}\n\nvar maybeRTL = /[\\u0590-\\u08ac]/;\n\nfunction endOfTextblockHorizontal(view, state, dir) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  if (!$head.parent.isTextblock) { return false }\n  var offset = $head.parentOffset, atStart = !offset, atEnd = offset == $head.parent.content.size;\n  var sel = getSelection();\n  // If the textblock is all LTR, or the browser doesn't support\n  // Selection.modify (Edge), fall back to a primitive approach\n  if (!maybeRTL.test($head.parent.textContent) || !sel.modify)\n    { return dir == \"left\" || dir == \"backward\" ? atStart : atEnd }\n\n  return withFlushedState(view, state, function () {\n    // This is a huge hack, but appears to be the best we can\n    // currently do: use `Selection.modify` to move the selection by\n    // one character, and see if that moves the cursor out of the\n    // textblock (or doesn't move it at all, when at the start/end of\n    // the document).\n    var oldRange = sel.getRangeAt(0), oldNode = sel.focusNode, oldOff = sel.focusOffset;\n    var oldBidiLevel = sel.caretBidiLevel; // Only for Firefox\n    sel.modify(\"move\", dir, \"character\");\n    var parentDOM = $head.depth ? view.docView.domAfterPos($head.before()) : view.dom;\n    var result = !parentDOM.contains(sel.focusNode.nodeType == 1 ? sel.focusNode : sel.focusNode.parentNode) ||\n        (oldNode == sel.focusNode && oldOff == sel.focusOffset);\n    // Restore the previous selection\n    sel.removeAllRanges();\n    sel.addRange(oldRange);\n    if (oldBidiLevel != null) { sel.caretBidiLevel = oldBidiLevel; }\n    return result\n  })\n}\n\nvar cachedState = null, cachedDir = null, cachedResult = false;\nfunction endOfTextblock(view, state, dir) {\n  if (cachedState == state && cachedDir == dir) { return cachedResult }\n  cachedState = state; cachedDir = dir;\n  return cachedResult = dir == \"up\" || dir == \"down\"\n    ? endOfTextblockVertical(view, state, dir)\n    : endOfTextblockHorizontal(view, state, dir)\n}\n\n// NodeView:: interface\n//\n// By default, document nodes are rendered using the result of the\n// [`toDOM`](#model.NodeSpec.toDOM) method of their spec, and managed\n// entirely by the editor. For some use cases, such as embedded\n// node-specific editing interfaces, you want more control over\n// the behavior of a node's in-editor representation, and need to\n// [define](#view.EditorProps.nodeViews) a custom node view.\n//\n// Mark views only support `dom` and `contentDOM`, and don't support\n// any of the node view methods.\n//\n// Objects returned as node views must conform to this interface.\n//\n//   dom:: ?dom.Node\n//   The outer DOM node that represents the document node. When not\n//   given, the default strategy is used to create a DOM node.\n//\n//   contentDOM:: ?dom.Node\n//   The DOM node that should hold the node's content. Only meaningful\n//   if the node view also defines a `dom` property and if its node\n//   type is not a leaf node type. When this is present, ProseMirror\n//   will take care of rendering the node's children into it. When it\n//   is not present, the node view itself is responsible for rendering\n//   (or deciding not to render) its child nodes.\n//\n//   update:: ?(node: Node, decorations: [Decoration]) → bool\n//   When given, this will be called when the view is updating itself.\n//   It will be given a node (possibly of a different type), and an\n//   array of active decorations (which are automatically drawn, and\n//   the node view may ignore if it isn't interested in them), and\n//   should return true if it was able to update to that node, and\n//   false otherwise. If the node view has a `contentDOM` property (or\n//   no `dom` property), updating its child nodes will be handled by\n//   ProseMirror.\n//\n//   selectNode:: ?()\n//   Can be used to override the way the node's selected status (as a\n//   node selection) is displayed.\n//\n//   deselectNode:: ?()\n//   When defining a `selectNode` method, you should also provide a\n//   `deselectNode` method to remove the effect again.\n//\n//   setSelection:: ?(anchor: number, head: number, root: dom.Document)\n//   This will be called to handle setting the selection inside the\n//   node. The `anchor` and `head` positions are relative to the start\n//   of the node. By default, a DOM selection will be created between\n//   the DOM positions corresponding to those positions, but if you\n//   override it you can do something else.\n//\n//   stopEvent:: ?(event: dom.Event) → bool\n//   Can be used to prevent the editor view from trying to handle some\n//   or all DOM events that bubble up from the node view. Events for\n//   which this returns true are not handled by the editor.\n//\n//   ignoreMutation:: ?(dom.MutationRecord) → bool\n//   Called when a DOM\n//   [mutation](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)\n//   or a selection change happens within the view. When the change is\n//   a selection change, the record will have a `type` property of\n//   `\"selection\"` (which doesn't occur for native mutation records).\n//   Return false if the editor should re-read the selection or\n//   re-parse the range around the mutation, true if it can safely be\n//   ignored.\n//\n//   destroy:: ?()\n//   Called when the node view is removed from the editor or the whole\n//   editor is destroyed.\n\n// View descriptions are data structures that describe the DOM that is\n// used to represent the editor's content. They are used for:\n//\n// - Incremental redrawing when the document changes\n//\n// - Figuring out what part of the document a given DOM position\n//   corresponds to\n//\n// - Wiring in custom implementations of the editing interface for a\n//   given node\n//\n// They form a doubly-linked mutable tree, starting at `view.docView`.\n\nvar NOT_DIRTY = 0, CHILD_DIRTY = 1, CONTENT_DIRTY = 2, NODE_DIRTY = 3;\n\n// Superclass for the various kinds of descriptions. Defines their\n// basic structure and shared methods.\nvar ViewDesc = function ViewDesc(parent, children, dom, contentDOM) {\n  this.parent = parent;\n  this.children = children;\n  this.dom = dom;\n  // An expando property on the DOM node provides a link back to its\n  // description.\n  dom.pmViewDesc = this;\n  // This is the node that holds the child views. It may be null for\n  // descs that don't have children.\n  this.contentDOM = contentDOM;\n  this.dirty = NOT_DIRTY;\n};\n\nvar prototypeAccessors = { beforePosition: { configurable: true },size: { configurable: true },border: { configurable: true },posBefore: { configurable: true },posAtStart: { configurable: true },posAfter: { configurable: true },posAtEnd: { configurable: true },contentLost: { configurable: true },domAtom: { configurable: true } };\n\n// Used to check whether a given description corresponds to a\n// widget/mark/node.\nViewDesc.prototype.matchesWidget = function matchesWidget () { return false };\nViewDesc.prototype.matchesMark = function matchesMark () { return false };\nViewDesc.prototype.matchesNode = function matchesNode () { return false };\nViewDesc.prototype.matchesHack = function matchesHack () { return false };\n\nprototypeAccessors.beforePosition.get = function () { return false };\n\n// : () → ?ParseRule\n// When parsing in-editor content (in domchange.js), we allow\n// descriptions to determine the parse rules that should be used to\n// parse them.\nViewDesc.prototype.parseRule = function parseRule () { return null };\n\n// : (dom.Event) → bool\n// Used by the editor's event handler to ignore events that come\n// from certain descs.\nViewDesc.prototype.stopEvent = function stopEvent () { return false };\n\n// The size of the content represented by this desc.\nprototypeAccessors.size.get = function () {\n  var size = 0;\n  for (var i = 0; i < this.children.length; i++) { size += this.children[i].size; }\n  return size\n};\n\n// For block nodes, this represents the space taken up by their\n// start/end tokens.\nprototypeAccessors.border.get = function () { return 0 };\n\nViewDesc.prototype.destroy = function destroy () {\n  this.parent = null;\n  if (this.dom.pmViewDesc == this) { this.dom.pmViewDesc = null; }\n  for (var i = 0; i < this.children.length; i++)\n    { this.children[i].destroy(); }\n};\n\nViewDesc.prototype.posBeforeChild = function posBeforeChild (child) {\n  for (var i = 0, pos = this.posAtStart; i < this.children.length; i++) {\n    var cur = this.children[i];\n    if (cur == child) { return pos }\n    pos += cur.size;\n  }\n};\n\nprototypeAccessors.posBefore.get = function () {\n  return this.parent.posBeforeChild(this)\n};\n\nprototypeAccessors.posAtStart.get = function () {\n  return this.parent ? this.parent.posBeforeChild(this) + this.border : 0\n};\n\nprototypeAccessors.posAfter.get = function () {\n  return this.posBefore + this.size\n};\n\nprototypeAccessors.posAtEnd.get = function () {\n  return this.posAtStart + this.size - 2 * this.border\n};\n\n// : (dom.Node, number, ?number) → number\nViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n  // If the DOM position is in the content, use the child desc after\n  // it to figure out a position.\n  if (this.contentDOM && this.contentDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode)) {\n    if (bias < 0) {\n      var domBefore, desc;\n      if (dom == this.contentDOM) {\n        domBefore = dom.childNodes[offset - 1];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domBefore = dom.previousSibling;\n      }\n      while (domBefore && !((desc = domBefore.pmViewDesc) && desc.parent == this)) { domBefore = domBefore.previousSibling; }\n      return domBefore ? this.posBeforeChild(desc) + desc.size : this.posAtStart\n    } else {\n      var domAfter, desc$1;\n      if (dom == this.contentDOM) {\n        domAfter = dom.childNodes[offset];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domAfter = dom.nextSibling;\n      }\n      while (domAfter && !((desc$1 = domAfter.pmViewDesc) && desc$1.parent == this)) { domAfter = domAfter.nextSibling; }\n      return domAfter ? this.posBeforeChild(desc$1) : this.posAtEnd\n    }\n  }\n  // Otherwise, use various heuristics, falling back on the bias\n  // parameter, to determine whether to return the position at the\n  // start or at the end of this view desc.\n  var atEnd;\n  if (this.contentDOM && this.contentDOM != this.dom && this.dom.contains(this.contentDOM)) {\n    atEnd = dom.compareDocumentPosition(this.contentDOM) & 2;\n  } else if (this.dom.firstChild) {\n    if (offset == 0) { for (var search = dom;; search = search.parentNode) {\n      if (search == this.dom) { atEnd = false; break }\n      if (search.parentNode.firstChild != search) { break }\n    } }\n    if (atEnd == null && offset == dom.childNodes.length) { for (var search$1 = dom;; search$1 = search$1.parentNode) {\n      if (search$1 == this.dom) { atEnd = true; break }\n      if (search$1.parentNode.lastChild != search$1) { break }\n    } }\n  }\n  return (atEnd == null ? bias > 0 : atEnd) ? this.posAtEnd : this.posAtStart\n};\n\n// Scan up the dom finding the first desc that is a descendant of\n// this one.\nViewDesc.prototype.nearestDesc = function nearestDesc (dom, onlyNodes) {\n  for (var first = true, cur = dom; cur; cur = cur.parentNode) {\n    var desc = this.getDesc(cur);\n    if (desc && (!onlyNodes || desc.node)) {\n      // If dom is outside of this desc's nodeDOM, don't count it.\n      if (first && desc.nodeDOM &&\n          !(desc.nodeDOM.nodeType == 1 ? desc.nodeDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode) : desc.nodeDOM == dom))\n        { first = false; }\n      else\n        { return desc }\n    }\n  }\n};\n\nViewDesc.prototype.getDesc = function getDesc (dom) {\n  var desc = dom.pmViewDesc;\n  for (var cur = desc; cur; cur = cur.parent) { if (cur == this) { return desc } }\n};\n\nViewDesc.prototype.posFromDOM = function posFromDOM (dom, offset, bias) {\n  for (var scan = dom; scan; scan = scan.parentNode) {\n    var desc = this.getDesc(scan);\n    if (desc) { return desc.localPosFromDOM(dom, offset, bias) }\n  }\n  return -1\n};\n\n// : (number) → ?NodeViewDesc\n// Find the desc for the node after the given pos, if any. (When a\n// parent node overrode rendering, there might not be one.)\nViewDesc.prototype.descAt = function descAt (pos) {\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == pos && end != offset) {\n      while (!child.border && child.children.length) { child = child.children[0]; }\n      return child\n    }\n    if (pos < end) { return child.descAt(pos - offset - child.border) }\n    offset = end;\n  }\n};\n\n// : (number, number) → {node: dom.Node, offset: number}\nViewDesc.prototype.domFromPos = function domFromPos (pos, side) {\n  if (!this.contentDOM) { return {node: this.dom, offset: 0} }\n  for (var offset = 0, i = 0, first = true;; i++, first = false) {\n    // Skip removed or always-before children\n    while (i < this.children.length && (this.children[i].beforePosition ||\n                                        this.children[i].dom.parentNode != this.contentDOM))\n      { offset += this.children[i++].size; }\n    var child = i == this.children.length ? null : this.children[i];\n    if (offset == pos && (side == 0 || !child || child.border || (side < 0 && first)) ||\n        child && child.domAtom && pos < offset + child.size) { return {\n      node: this.contentDOM,\n      offset: child ? domIndex(child.dom) : this.contentDOM.childNodes.length\n    } }\n    if (!child) { throw new Error(\"Invalid position \" + pos) }\n    var end = offset + child.size;\n    if (!child.domAtom && (side < 0 && !child.border ? end >= pos : end > pos))\n      { return child.domFromPos(pos - offset - child.border, side) }\n    offset = end;\n  }\n};\n\n// Used to find a DOM range in a single parent for a given changed\n// range.\nViewDesc.prototype.parseRange = function parseRange (from, to, base) {\n    if ( base === void 0 ) base = 0;\n\n  if (this.children.length == 0)\n    { return {node: this.contentDOM, from: from, to: to, fromOffset: 0, toOffset: this.contentDOM.childNodes.length} }\n\n  var fromOffset = -1, toOffset = -1;\n  for (var offset = base, i = 0;; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (fromOffset == -1 && from <= end) {\n      var childBase = offset + child.border;\n      // FIXME maybe descend mark views to parse a narrower range?\n      if (from >= childBase && to <= end - child.border && child.node &&\n          child.contentDOM && this.contentDOM.contains(child.contentDOM))\n        { return child.parseRange(from, to, childBase) }\n\n      from = offset;\n      for (var j = i; j > 0; j--) {\n        var prev = this.children[j - 1];\n        if (prev.size && prev.dom.parentNode == this.contentDOM && !prev.emptyChildAt(1)) {\n          fromOffset = domIndex(prev.dom) + 1;\n          break\n        }\n        from -= prev.size;\n      }\n      if (fromOffset == -1) { fromOffset = 0; }\n    }\n    if (fromOffset > -1 && (end > to || i == this.children.length - 1)) {\n      to = end;\n      for (var j$1 = i + 1; j$1 < this.children.length; j$1++) {\n        var next = this.children[j$1];\n        if (next.size && next.dom.parentNode == this.contentDOM && !next.emptyChildAt(-1)) {\n          toOffset = domIndex(next.dom);\n          break\n        }\n        to += next.size;\n      }\n      if (toOffset == -1) { toOffset = this.contentDOM.childNodes.length; }\n      break\n    }\n    offset = end;\n  }\n  return {node: this.contentDOM, from: from, to: to, fromOffset: fromOffset, toOffset: toOffset}\n};\n\nViewDesc.prototype.emptyChildAt = function emptyChildAt (side) {\n  if (this.border || !this.contentDOM || !this.children.length) { return false }\n  var child = this.children[side < 0 ? 0 : this.children.length - 1];\n  return child.size == 0 || child.emptyChildAt(side)\n};\n\n// : (number) → dom.Node\nViewDesc.prototype.domAfterPos = function domAfterPos (pos) {\n  var ref = this.domFromPos(pos, 0);\n    var node = ref.node;\n    var offset = ref.offset;\n  if (node.nodeType != 1 || offset == node.childNodes.length)\n    { throw new RangeError(\"No node after pos \" + pos) }\n  return node.childNodes[offset]\n};\n\n// : (number, number, dom.Document)\n// View descs are responsible for setting any selection that falls\n// entirely inside of them, so that custom implementations can do\n// custom things with the selection. Note that this falls apart when\n// a selection starts in such a node and ends in another, in which\n// case we just use whatever domFromPos produces as a best effort.\nViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n  // If the selection falls entirely in a child, give it to that child\n  var from = Math.min(anchor, head), to = Math.max(anchor, head);\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (from > offset && to < end)\n      { return child.setSelection(anchor - offset - child.border, head - offset - child.border, root, force) }\n    offset = end;\n  }\n\n  var anchorDOM = this.domFromPos(anchor, anchor ? -1 : 1);\n  var headDOM = head == anchor ? anchorDOM : this.domFromPos(head, head ? -1 : 1);\n  var domSel = root.getSelection();\n\n  var brKludge = false;\n  // On Firefox, using Selection.collapse to put the cursor after a\n  // BR node for some reason doesn't always work (#1073). On Safari,\n  // the cursor sometimes inexplicable visually lags behind its\n  // reported position in such situations (#1092).\n  if ((result.gecko || result.safari) && anchor == head) {\n    if (anchorDOM.node.nodeType == 3) {\n      brKludge = anchorDOM.offset && anchorDOM.node.nodeValue[anchorDOM.offset - 1] == \"\\n\";\n    } else {\n      var prev = anchorDOM.node.childNodes[anchorDOM.offset - 1];\n      brKludge = prev && (prev.nodeName == \"BR\" || prev.contentEditable == \"false\");\n    }\n  }\n\n  if (!(force || brKludge && result.safari) &&\n      isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset) &&\n      isEquivalentPosition(headDOM.node, headDOM.offset, domSel.focusNode, domSel.focusOffset))\n    { return }\n\n  // Selection.extend can be used to create an 'inverted' selection\n  // (one where the focus is before the anchor), but not all\n  // browsers support it yet.\n  var domSelExtended = false;\n  if ((domSel.extend || anchor == head) && !brKludge) {\n    domSel.collapse(anchorDOM.node, anchorDOM.offset);\n    try {\n      if (anchor != head) { domSel.extend(headDOM.node, headDOM.offset); }\n      domSelExtended = true;\n    } catch (err) {\n      // In some cases with Chrome the selection is empty after calling\n      // collapse, even when it should be valid. This appears to be a bug, but\n      // it is difficult to isolate. If this happens fallback to the old path\n      // without using extend.\n      if (!(err instanceof DOMException)) { throw err }\n      // declare global: DOMException\n    }\n  }\n  if (!domSelExtended) {\n    if (anchor > head) { var tmp = anchorDOM; anchorDOM = headDOM; headDOM = tmp; }\n    var range = document.createRange();\n    range.setEnd(headDOM.node, headDOM.offset);\n    range.setStart(anchorDOM.node, anchorDOM.offset);\n    domSel.removeAllRanges();\n    domSel.addRange(range);\n  }\n};\n\n// : (dom.MutationRecord) → bool\nViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n  return !this.contentDOM && mutation.type != \"selection\"\n};\n\nprototypeAccessors.contentLost.get = function () {\n  return this.contentDOM && this.contentDOM != this.dom && !this.dom.contains(this.contentDOM)\n};\n\n// Remove a subtree of the element tree that has been touched\n// by a DOM change, so that the next update will redraw it.\nViewDesc.prototype.markDirty = function markDirty (from, to) {\n  for (var offset = 0, i = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == end ? from <= end && to >= offset : from < end && to > offset) {\n      var startInside = offset + child.border, endInside = end - child.border;\n      if (from >= startInside && to <= endInside) {\n        this.dirty = from == offset || to == end ? CONTENT_DIRTY : CHILD_DIRTY;\n        if (from == startInside && to == endInside &&\n            (child.contentLost || child.dom.parentNode != this.contentDOM)) { child.dirty = NODE_DIRTY; }\n        else { child.markDirty(from - startInside, to - startInside); }\n        return\n      } else {\n        child.dirty = NODE_DIRTY;\n      }\n    }\n    offset = end;\n  }\n  this.dirty = CONTENT_DIRTY;\n};\n\nViewDesc.prototype.markParentsDirty = function markParentsDirty () {\n  var level = 1;\n  for (var node = this.parent; node; node = node.parent, level++) {\n    var dirty = level == 1 ? CONTENT_DIRTY : CHILD_DIRTY;\n    if (node.dirty < dirty) { node.dirty = dirty; }\n  }\n};\n\nprototypeAccessors.domAtom.get = function () { return false };\n\nObject.defineProperties( ViewDesc.prototype, prototypeAccessors );\n\n// Reused array to avoid allocating fresh arrays for things that will\n// stay empty anyway.\nvar nothing = [];\n\n// A widget desc represents a widget decoration, which is a DOM node\n// drawn between the document nodes.\nvar WidgetViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function WidgetViewDesc(parent, widget, view, pos) {\n    var self, dom = widget.type.toDOM;\n    if (typeof dom == \"function\") { dom = dom(view, function () {\n      if (!self) { return pos }\n      if (self.parent) { return self.parent.posBeforeChild(self) }\n    }); }\n    if (!widget.type.spec.raw) {\n      if (dom.nodeType != 1) {\n        var wrap = document.createElement(\"span\");\n        wrap.appendChild(dom);\n        dom = wrap;\n      }\n      dom.contentEditable = false;\n      dom.classList.add(\"ProseMirror-widget\");\n    }\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.widget = widget;\n    self = this;\n  }\n\n  if ( ViewDesc ) WidgetViewDesc.__proto__ = ViewDesc;\n  WidgetViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  WidgetViewDesc.prototype.constructor = WidgetViewDesc;\n\n  var prototypeAccessors$1 = { beforePosition: { configurable: true },domAtom: { configurable: true } };\n\n  prototypeAccessors$1.beforePosition.get = function () {\n    return this.widget.type.side < 0\n  };\n\n  WidgetViewDesc.prototype.matchesWidget = function matchesWidget (widget) {\n    return this.dirty == NOT_DIRTY && widget.type.eq(this.widget.type)\n  };\n\n  WidgetViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n\n  WidgetViewDesc.prototype.stopEvent = function stopEvent (event) {\n    var stop = this.widget.spec.stopEvent;\n    return stop ? stop(event) : false\n  };\n\n  WidgetViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"selection\" || this.widget.spec.ignoreSelection\n  };\n\n  prototypeAccessors$1.domAtom.get = function () { return true };\n\n  Object.defineProperties( WidgetViewDesc.prototype, prototypeAccessors$1 );\n\n  return WidgetViewDesc;\n}(ViewDesc));\n\nvar CompositionViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function CompositionViewDesc(parent, dom, textDOM, text) {\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.textDOM = textDOM;\n    this.text = text;\n  }\n\n  if ( ViewDesc ) CompositionViewDesc.__proto__ = ViewDesc;\n  CompositionViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  CompositionViewDesc.prototype.constructor = CompositionViewDesc;\n\n  var prototypeAccessors$2 = { size: { configurable: true } };\n\n  prototypeAccessors$2.size.get = function () { return this.text.length };\n\n  CompositionViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset) {\n    if (dom != this.textDOM) { return this.posAtStart + (offset ? this.size : 0) }\n    return this.posAtStart + offset\n  };\n\n  CompositionViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.textDOM, offset: pos}\n  };\n\n  CompositionViewDesc.prototype.ignoreMutation = function ignoreMutation (mut) {\n    return mut.type === 'characterData' && mut.target.nodeValue == mut.oldValue\n   };\n\n  Object.defineProperties( CompositionViewDesc.prototype, prototypeAccessors$2 );\n\n  return CompositionViewDesc;\n}(ViewDesc));\n\n// A mark desc represents a mark. May have multiple children,\n// depending on how the mark is split. Note that marks are drawn using\n// a fixed nesting order, for simplicity and predictability, so in\n// some cases they will be split more often than would appear\n// necessary.\nvar MarkViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function MarkViewDesc(parent, mark, dom, contentDOM) {\n    ViewDesc.call(this, parent, [], dom, contentDOM);\n    this.mark = mark;\n  }\n\n  if ( ViewDesc ) MarkViewDesc.__proto__ = ViewDesc;\n  MarkViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  MarkViewDesc.prototype.constructor = MarkViewDesc;\n\n  MarkViewDesc.create = function create (parent, mark, inline, view) {\n    var custom = view.nodeViews[mark.type.name];\n    var spec = custom && custom(mark, view, inline);\n    if (!spec || !spec.dom)\n      { spec = DOMSerializer.renderSpec(document, mark.type.spec.toDOM(mark, inline)); }\n    return new MarkViewDesc(parent, mark, spec.dom, spec.contentDOM || spec.dom)\n  };\n\n  MarkViewDesc.prototype.parseRule = function parseRule () { return {mark: this.mark.type.name, attrs: this.mark.attrs, contentElement: this.contentDOM} };\n\n  MarkViewDesc.prototype.matchesMark = function matchesMark (mark) { return this.dirty != NODE_DIRTY && this.mark.eq(mark) };\n\n  MarkViewDesc.prototype.markDirty = function markDirty (from, to) {\n    ViewDesc.prototype.markDirty.call(this, from, to);\n    // Move dirty info to nearest node view\n    if (this.dirty != NOT_DIRTY) {\n      var parent = this.parent;\n      while (!parent.node) { parent = parent.parent; }\n      if (parent.dirty < this.dirty) { parent.dirty = this.dirty; }\n      this.dirty = NOT_DIRTY;\n    }\n  };\n\n  MarkViewDesc.prototype.slice = function slice (from, to, view) {\n    var copy = MarkViewDesc.create(this.parent, this.mark, true, view);\n    var nodes = this.children, size = this.size;\n    if (to < size) { nodes = replaceNodes(nodes, to, size, view); }\n    if (from > 0) { nodes = replaceNodes(nodes, 0, from, view); }\n    for (var i = 0; i < nodes.length; i++) { nodes[i].parent = copy; }\n    copy.children = nodes;\n    return copy\n  };\n\n  return MarkViewDesc;\n}(ViewDesc));\n\n// Node view descs are the main, most common type of view desc, and\n// correspond to an actual node in the document. Unlike mark descs,\n// they populate their child array themselves.\nvar NodeViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos) {\n    ViewDesc.call(this, parent, node.isLeaf ? nothing : [], dom, contentDOM);\n    this.nodeDOM = nodeDOM;\n    this.node = node;\n    this.outerDeco = outerDeco;\n    this.innerDeco = innerDeco;\n    if (contentDOM) { this.updateChildren(view, pos); }\n  }\n\n  if ( ViewDesc ) NodeViewDesc.__proto__ = ViewDesc;\n  NodeViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  NodeViewDesc.prototype.constructor = NodeViewDesc;\n\n  var prototypeAccessors$3 = { size: { configurable: true },border: { configurable: true },domAtom: { configurable: true } };\n\n  // By default, a node is rendered using the `toDOM` method from the\n  // node type spec. But client code can use the `nodeViews` spec to\n  // supply a custom node view, which can influence various aspects of\n  // the way the node works.\n  //\n  // (Using subclassing for this was intentionally decided against,\n  // since it'd require exposing a whole slew of finnicky\n  // implementation details to the user code that they probably will\n  // never need.)\n  NodeViewDesc.create = function create (parent, node, outerDeco, innerDeco, view, pos) {\n    var assign;\n\n    var custom = view.nodeViews[node.type.name], descObj;\n    var spec = custom && custom(node, view, function () {\n      // (This is a function that allows the custom view to find its\n      // own position)\n      if (!descObj) { return pos }\n      if (descObj.parent) { return descObj.parent.posBeforeChild(descObj) }\n    }, outerDeco);\n\n    var dom = spec && spec.dom, contentDOM = spec && spec.contentDOM;\n    if (node.isText) {\n      if (!dom) { dom = document.createTextNode(node.text); }\n      else if (dom.nodeType != 3) { throw new RangeError(\"Text must be rendered as a DOM text node\") }\n    } else if (!dom) {\n((assign = DOMSerializer.renderSpec(document, node.type.spec.toDOM(node)), dom = assign.dom, contentDOM = assign.contentDOM));\n    }\n    if (!contentDOM && !node.isText && dom.nodeName != \"BR\") { // Chrome gets confused by <br contenteditable=false>\n      if (!dom.hasAttribute(\"contenteditable\")) { dom.contentEditable = false; }\n      if (node.type.spec.draggable) { dom.draggable = true; }\n    }\n\n    var nodeDOM = dom;\n    dom = applyOuterDeco(dom, outerDeco, node);\n\n    if (spec)\n      { return descObj = new CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM,\n                                              spec, view, pos + 1) }\n    else if (node.isText)\n      { return new TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) }\n    else\n      { return new NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos + 1) }\n  };\n\n  NodeViewDesc.prototype.parseRule = function parseRule () {\n    var this$1 = this;\n\n    // Experimental kludge to allow opt-in re-parsing of nodes\n    if (this.node.type.spec.reparseInView) { return null }\n    // FIXME the assumption that this can always return the current\n    // attrs means that if the user somehow manages to change the\n    // attrs in the dom, that won't be picked up. Not entirely sure\n    // whether this is a problem\n    var rule = {node: this.node.type.name, attrs: this.node.attrs};\n    if (this.node.type.spec.code) { rule.preserveWhitespace = \"full\"; }\n    if (this.contentDOM && !this.contentLost) { rule.contentElement = this.contentDOM; }\n    else { rule.getContent = function () { return this$1.contentDOM ? Fragment.empty : this$1.node.content; }; }\n    return rule\n  };\n\n  NodeViewDesc.prototype.matchesNode = function matchesNode (node, outerDeco, innerDeco) {\n    return this.dirty == NOT_DIRTY && node.eq(this.node) &&\n      sameOuterDeco(outerDeco, this.outerDeco) && innerDeco.eq(this.innerDeco)\n  };\n\n  prototypeAccessors$3.size.get = function () { return this.node.nodeSize };\n\n  prototypeAccessors$3.border.get = function () { return this.node.isLeaf ? 0 : 1 };\n\n  // Syncs `this.children` to match `this.node.content` and the local\n  // decorations, possibly introducing nesting for marks. Then, in a\n  // separate step, syncs the DOM inside `this.contentDOM` to\n  // `this.children`.\n  NodeViewDesc.prototype.updateChildren = function updateChildren (view, pos) {\n    var this$1 = this;\n\n    var inline = this.node.inlineContent, off = pos;\n    var composition = inline && view.composing && this.localCompositionNode(view, pos);\n    var updater = new ViewTreeUpdater(this, composition && composition.node);\n    iterDeco(this.node, this.innerDeco, function (widget, i, insideNode) {\n      if (widget.spec.marks)\n        { updater.syncToMarks(widget.spec.marks, inline, view); }\n      else if (widget.type.side >= 0 && !insideNode)\n        { updater.syncToMarks(i == this$1.node.childCount ? Mark.none : this$1.node.child(i).marks, inline, view); }\n      // If the next node is a desc matching this widget, reuse it,\n      // otherwise insert the widget as a new view desc.\n      updater.placeWidget(widget, view, off);\n    }, function (child, outerDeco, innerDeco, i) {\n      // Make sure the wrapping mark descs match the node's marks.\n      updater.syncToMarks(child.marks, inline, view);\n      // Either find an existing desc that exactly matches this node,\n      // and drop the descs before it.\n      updater.findNodeMatch(child, outerDeco, innerDeco, i) ||\n        // Or try updating the next desc to reflect this node.\n        updater.updateNextNode(child, outerDeco, innerDeco, view, i) ||\n        // Or just add it as a new desc.\n        updater.addNode(child, outerDeco, innerDeco, view, off);\n      off += child.nodeSize;\n    });\n    // Drop all remaining descs after the current position.\n    updater.syncToMarks(nothing, inline, view);\n    if (this.node.isTextblock) { updater.addTextblockHacks(); }\n    updater.destroyRest();\n\n    // Sync the DOM if anything changed\n    if (updater.changed || this.dirty == CONTENT_DIRTY) {\n      // May have to protect focused DOM from being changed if a composition is active\n      if (composition) { this.protectLocalComposition(view, composition); }\n      renderDescs(this.contentDOM, this.children, view);\n      if (result.ios) { iosHacks(this.dom); }\n    }\n  };\n\n  NodeViewDesc.prototype.localCompositionNode = function localCompositionNode (view, pos) {\n    // Only do something if both the selection and a focused text node\n    // are inside of this node, and the node isn't already part of a\n    // view that's a child of this view\n    var ref = view.state.selection;\n    var from = ref.from;\n    var to = ref.to;\n    if (!(view.state.selection instanceof TextSelection) || from < pos || to > pos + this.node.content.size) { return }\n    var sel = view.root.getSelection();\n    var textNode = nearbyTextNode(sel.focusNode, sel.focusOffset);\n    if (!textNode || !this.dom.contains(textNode.parentNode)) { return }\n\n    // Find the text in the focused node in the node, stop if it's not\n    // there (may have been modified through other means, in which\n    // case it should overwritten)\n    var text = textNode.nodeValue;\n    var textPos = findTextInFragment(this.node.content, text, from - pos, to - pos);\n\n    return textPos < 0 ? null : {node: textNode, pos: textPos, text: text}\n  };\n\n  NodeViewDesc.prototype.protectLocalComposition = function protectLocalComposition (view, ref) {\n    var node = ref.node;\n    var pos = ref.pos;\n    var text = ref.text;\n\n    // The node is already part of a local view desc, leave it there\n    if (this.getDesc(node)) { return }\n\n    // Create a composition view for the orphaned nodes\n    var topNode = node;\n    for (;; topNode = topNode.parentNode) {\n      if (topNode.parentNode == this.contentDOM) { break }\n      while (topNode.previousSibling) { topNode.parentNode.removeChild(topNode.previousSibling); }\n      while (topNode.nextSibling) { topNode.parentNode.removeChild(topNode.nextSibling); }\n      if (topNode.pmViewDesc) { topNode.pmViewDesc = null; }\n    }\n    var desc = new CompositionViewDesc(this, topNode, node, text);\n    view.compositionNodes.push(desc);\n\n    // Patch up this.children to contain the composition view\n    this.children = replaceNodes(this.children, pos, pos + text.length, view, desc);\n  };\n\n  // : (Node, [Decoration], DecorationSet, EditorView) → bool\n  // If this desc be updated to match the given node decoration,\n  // do so and return true.\n  NodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateInner(node, outerDeco, innerDeco, view);\n    return true\n  };\n\n  NodeViewDesc.prototype.updateInner = function updateInner (node, outerDeco, innerDeco, view) {\n    this.updateOuterDeco(outerDeco);\n    this.node = node;\n    this.innerDeco = innerDeco;\n    if (this.contentDOM) { this.updateChildren(view, this.posAtStart); }\n    this.dirty = NOT_DIRTY;\n  };\n\n  NodeViewDesc.prototype.updateOuterDeco = function updateOuterDeco (outerDeco) {\n    if (sameOuterDeco(outerDeco, this.outerDeco)) { return }\n    var needsWrap = this.nodeDOM.nodeType != 1;\n    var oldDOM = this.dom;\n    this.dom = patchOuterDeco(this.dom, this.nodeDOM,\n                              computeOuterDeco(this.outerDeco, this.node, needsWrap),\n                              computeOuterDeco(outerDeco, this.node, needsWrap));\n    if (this.dom != oldDOM) {\n      oldDOM.pmViewDesc = null;\n      this.dom.pmViewDesc = this;\n    }\n    this.outerDeco = outerDeco;\n  };\n\n  // Mark this node as being the selected node.\n  NodeViewDesc.prototype.selectNode = function selectNode () {\n    this.nodeDOM.classList.add(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.draggable = true; }\n  };\n\n  // Remove selected node marking from this node.\n  NodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.nodeDOM.classList.remove(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.removeAttribute(\"draggable\"); }\n  };\n\n  prototypeAccessors$3.domAtom.get = function () { return this.node.isAtom };\n\n  Object.defineProperties( NodeViewDesc.prototype, prototypeAccessors$3 );\n\n  return NodeViewDesc;\n}(ViewDesc));\n\n// Create a view desc for the top-level document node, to be exported\n// and used by the view class.\nfunction docViewDesc(doc, outerDeco, innerDeco, dom, view) {\n  applyOuterDeco(dom, outerDeco, doc);\n  return new NodeViewDesc(null, doc, outerDeco, innerDeco, dom, dom, dom, view, 0)\n}\n\nvar TextViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, null, nodeDOM, view);\n  }\n\n  if ( NodeViewDesc ) TextViewDesc.__proto__ = NodeViewDesc;\n  TextViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  TextViewDesc.prototype.constructor = TextViewDesc;\n\n  var prototypeAccessors$4 = { domAtom: { configurable: true } };\n\n  TextViewDesc.prototype.parseRule = function parseRule () {\n    var skip = this.nodeDOM.parentNode;\n    while (skip && skip != this.dom && !skip.pmIsDeco) { skip = skip.parentNode; }\n    return {skip: skip || true}\n  };\n\n  TextViewDesc.prototype.update = function update (node, outerDeco, _, view) {\n    if (this.dirty == NODE_DIRTY || (this.dirty != NOT_DIRTY && !this.inParent()) ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateOuterDeco(outerDeco);\n    if ((this.dirty != NOT_DIRTY || node.text != this.node.text) && node.text != this.nodeDOM.nodeValue) {\n      this.nodeDOM.nodeValue = node.text;\n      if (view.trackWrites == this.nodeDOM) { view.trackWrites = null; }\n    }\n    this.node = node;\n    this.dirty = NOT_DIRTY;\n    return true\n  };\n\n  TextViewDesc.prototype.inParent = function inParent () {\n    var parentDOM = this.parent.contentDOM;\n    for (var n = this.nodeDOM; n; n = n.parentNode) { if (n == parentDOM) { return true } }\n    return false\n  };\n\n  TextViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.nodeDOM, offset: pos}\n  };\n\n  TextViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n    if (dom == this.nodeDOM) { return this.posAtStart + Math.min(offset, this.node.text.length) }\n    return NodeViewDesc.prototype.localPosFromDOM.call(this, dom, offset, bias)\n  };\n\n  TextViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"characterData\" && mutation.type != \"selection\"\n  };\n\n  TextViewDesc.prototype.slice = function slice (from, to, view) {\n    var node = this.node.cut(from, to), dom = document.createTextNode(node.text);\n    return new TextViewDesc(this.parent, node, this.outerDeco, this.innerDeco, dom, dom, view)\n  };\n\n  prototypeAccessors$4.domAtom.get = function () { return false };\n\n  Object.defineProperties( TextViewDesc.prototype, prototypeAccessors$4 );\n\n  return TextViewDesc;\n}(NodeViewDesc));\n\n// A dummy desc used to tag trailing BR or span nodes created to work\n// around contentEditable terribleness.\nvar BRHackViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function BRHackViewDesc () {\n    ViewDesc.apply(this, arguments);\n  }\n\n  if ( ViewDesc ) BRHackViewDesc.__proto__ = ViewDesc;\n  BRHackViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  BRHackViewDesc.prototype.constructor = BRHackViewDesc;\n\n  var prototypeAccessors$5 = { domAtom: { configurable: true } };\n\n  BRHackViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n  BRHackViewDesc.prototype.matchesHack = function matchesHack () { return this.dirty == NOT_DIRTY };\n  prototypeAccessors$5.domAtom.get = function () { return true };\n\n  Object.defineProperties( BRHackViewDesc.prototype, prototypeAccessors$5 );\n\n  return BRHackViewDesc;\n}(ViewDesc));\n\n// A separate subclass is used for customized node views, so that the\n// extra checks only have to be made for nodes that are actually\n// customized.\nvar CustomNodeViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, spec, view, pos) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos);\n    this.spec = spec;\n  }\n\n  if ( NodeViewDesc ) CustomNodeViewDesc.__proto__ = NodeViewDesc;\n  CustomNodeViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  CustomNodeViewDesc.prototype.constructor = CustomNodeViewDesc;\n\n  // A custom `update` method gets to decide whether the update goes\n  // through. If it does, and there's a `contentDOM` node, our logic\n  // updates the children.\n  CustomNodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY) { return false }\n    if (this.spec.update) {\n      var result = this.spec.update(node, outerDeco);\n      if (result) { this.updateInner(node, outerDeco, innerDeco, view); }\n      return result\n    } else if (!this.contentDOM && !node.isLeaf) {\n      return false\n    } else {\n      return NodeViewDesc.prototype.update.call(this, node, outerDeco, innerDeco, view)\n    }\n  };\n\n  CustomNodeViewDesc.prototype.selectNode = function selectNode () {\n    this.spec.selectNode ? this.spec.selectNode() : NodeViewDesc.prototype.selectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.spec.deselectNode ? this.spec.deselectNode() : NodeViewDesc.prototype.deselectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n    this.spec.setSelection ? this.spec.setSelection(anchor, head, root)\n      : NodeViewDesc.prototype.setSelection.call(this, anchor, head, root, force);\n  };\n\n  CustomNodeViewDesc.prototype.destroy = function destroy () {\n    if (this.spec.destroy) { this.spec.destroy(); }\n    NodeViewDesc.prototype.destroy.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.stopEvent = function stopEvent (event) {\n    return this.spec.stopEvent ? this.spec.stopEvent(event) : false\n  };\n\n  CustomNodeViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return this.spec.ignoreMutation ? this.spec.ignoreMutation(mutation) : NodeViewDesc.prototype.ignoreMutation.call(this, mutation)\n  };\n\n  return CustomNodeViewDesc;\n}(NodeViewDesc));\n\n// : (dom.Node, [ViewDesc])\n// Sync the content of the given DOM node with the nodes associated\n// with the given array of view descs, recursing into mark descs\n// because this should sync the subtree for a whole node at a time.\nfunction renderDescs(parentDOM, descs, view) {\n  var dom = parentDOM.firstChild, written = false;\n  for (var i = 0; i < descs.length; i++) {\n    var desc = descs[i], childDOM = desc.dom;\n    if (childDOM.parentNode == parentDOM) {\n      while (childDOM != dom) { dom = rm(dom); written = true; }\n      dom = dom.nextSibling;\n    } else {\n      written = true;\n      parentDOM.insertBefore(childDOM, dom);\n    }\n    if (desc instanceof MarkViewDesc) {\n      var pos = dom ? dom.previousSibling : parentDOM.lastChild;\n      renderDescs(desc.contentDOM, desc.children, view);\n      dom = pos ? pos.nextSibling : parentDOM.firstChild;\n    }\n  }\n  while (dom) { dom = rm(dom); written = true; }\n  if (written && view.trackWrites == parentDOM) { view.trackWrites = null; }\n}\n\nfunction OuterDecoLevel(nodeName) {\n  if (nodeName) { this.nodeName = nodeName; }\n}\nOuterDecoLevel.prototype = Object.create(null);\n\nvar noDeco = [new OuterDecoLevel];\n\nfunction computeOuterDeco(outerDeco, node, needsWrap) {\n  if (outerDeco.length == 0) { return noDeco }\n\n  var top = needsWrap ? noDeco[0] : new OuterDecoLevel, result = [top];\n\n  for (var i = 0; i < outerDeco.length; i++) {\n    var attrs = outerDeco[i].type.attrs;\n    if (!attrs) { continue }\n    if (attrs.nodeName)\n      { result.push(top = new OuterDecoLevel(attrs.nodeName)); }\n\n    for (var name in attrs) {\n      var val = attrs[name];\n      if (val == null) { continue }\n      if (needsWrap && result.length == 1)\n        { result.push(top = new OuterDecoLevel(node.isInline ? \"span\" : \"div\")); }\n      if (name == \"class\") { top.class = (top.class ? top.class + \" \" : \"\") + val; }\n      else if (name == \"style\") { top.style = (top.style ? top.style + \";\" : \"\") + val; }\n      else if (name != \"nodeName\") { top[name] = val; }\n    }\n  }\n\n  return result\n}\n\nfunction patchOuterDeco(outerDOM, nodeDOM, prevComputed, curComputed) {\n  // Shortcut for trivial case\n  if (prevComputed == noDeco && curComputed == noDeco) { return nodeDOM }\n\n  var curDOM = nodeDOM;\n  for (var i = 0; i < curComputed.length; i++) {\n    var deco = curComputed[i], prev = prevComputed[i];\n    if (i) {\n      var parent = (void 0);\n      if (prev && prev.nodeName == deco.nodeName && curDOM != outerDOM &&\n          (parent = curDOM.parentNode) && parent.tagName.toLowerCase() == deco.nodeName) {\n        curDOM = parent;\n      } else {\n        parent = document.createElement(deco.nodeName);\n        parent.pmIsDeco = true;\n        parent.appendChild(curDOM);\n        prev = noDeco[0];\n        curDOM = parent;\n      }\n    }\n    patchAttributes(curDOM, prev || noDeco[0], deco);\n  }\n  return curDOM\n}\n\nfunction patchAttributes(dom, prev, cur) {\n  for (var name in prev)\n    { if (name != \"class\" && name != \"style\" && name != \"nodeName\" && !(name in cur))\n      { dom.removeAttribute(name); } }\n  for (var name$1 in cur)\n    { if (name$1 != \"class\" && name$1 != \"style\" && name$1 != \"nodeName\" && cur[name$1] != prev[name$1])\n      { dom.setAttribute(name$1, cur[name$1]); } }\n  if (prev.class != cur.class) {\n    var prevList = prev.class ? prev.class.split(\" \") : nothing;\n    var curList = cur.class ? cur.class.split(\" \") : nothing;\n    for (var i = 0; i < prevList.length; i++) { if (curList.indexOf(prevList[i]) == -1)\n      { dom.classList.remove(prevList[i]); } }\n    for (var i$1 = 0; i$1 < curList.length; i$1++) { if (prevList.indexOf(curList[i$1]) == -1)\n      { dom.classList.add(curList[i$1]); } }\n  }\n  if (prev.style != cur.style) {\n    if (prev.style) {\n      var prop = /\\s*([\\w\\-\\xa1-\\uffff]+)\\s*:(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|\\(.*?\\)|[^;])*/g, m;\n      while (m = prop.exec(prev.style))\n        { dom.style.removeProperty(m[1]); }\n    }\n    if (cur.style)\n      { dom.style.cssText += cur.style; }\n  }\n}\n\nfunction applyOuterDeco(dom, deco, node) {\n  return patchOuterDeco(dom, dom, noDeco, computeOuterDeco(deco, node, dom.nodeType != 1))\n}\n\n// : ([Decoration], [Decoration]) → bool\nfunction sameOuterDeco(a, b) {\n  if (a.length != b.length) { return false }\n  for (var i = 0; i < a.length; i++) { if (!a[i].type.eq(b[i].type)) { return false } }\n  return true\n}\n\n// Remove a DOM node and return its next sibling.\nfunction rm(dom) {\n  var next = dom.nextSibling;\n  dom.parentNode.removeChild(dom);\n  return next\n}\n\n// Helper class for incrementally updating a tree of mark descs and\n// the widget and node descs inside of them.\nvar ViewTreeUpdater = function ViewTreeUpdater(top, lockedNode) {\n  this.top = top;\n  this.lock = lockedNode;\n  // Index into `this.top`'s child array, represents the current\n  // update position.\n  this.index = 0;\n  // When entering a mark, the current top and index are pushed\n  // onto this.\n  this.stack = [];\n  // Tracks whether anything was changed\n  this.changed = false;\n\n  var pre = preMatch(top.node.content, top.children);\n  this.preMatched = pre.nodes;\n  this.preMatchOffset = pre.offset;\n};\n\nViewTreeUpdater.prototype.getPreMatch = function getPreMatch (index) {\n  return index >= this.preMatchOffset ? this.preMatched[index - this.preMatchOffset] : null\n};\n\n// Destroy and remove the children between the given indices in\n// `this.top`.\nViewTreeUpdater.prototype.destroyBetween = function destroyBetween (start, end) {\n  if (start == end) { return }\n  for (var i = start; i < end; i++) { this.top.children[i].destroy(); }\n  this.top.children.splice(start, end - start);\n  this.changed = true;\n};\n\n// Destroy all remaining children in `this.top`.\nViewTreeUpdater.prototype.destroyRest = function destroyRest () {\n  this.destroyBetween(this.index, this.top.children.length);\n};\n\n// : ([Mark], EditorView)\n// Sync the current stack of mark descs with the given array of\n// marks, reusing existing mark descs when possible.\nViewTreeUpdater.prototype.syncToMarks = function syncToMarks (marks, inline, view) {\n  var keep = 0, depth = this.stack.length >> 1;\n  var maxKeep = Math.min(depth, marks.length);\n  while (keep < maxKeep &&\n         (keep == depth - 1 ? this.top : this.stack[(keep + 1) << 1]).matchesMark(marks[keep]) && marks[keep].type.spec.spanning !== false)\n    { keep++; }\n\n  while (keep < depth) {\n    this.destroyRest();\n    this.top.dirty = NOT_DIRTY;\n    this.index = this.stack.pop();\n    this.top = this.stack.pop();\n    depth--;\n  }\n  while (depth < marks.length) {\n    this.stack.push(this.top, this.index + 1);\n    var found = -1;\n    for (var i = this.index; i < Math.min(this.index + 3, this.top.children.length); i++) {\n      if (this.top.children[i].matchesMark(marks[depth])) { found = i; break }\n    }\n    if (found > -1) {\n      if (found > this.index) {\n        this.changed = true;\n        this.destroyBetween(this.index, found);\n      }\n      this.top = this.top.children[this.index];\n    } else {\n      var markDesc = MarkViewDesc.create(this.top, marks[depth], inline, view);\n      this.top.children.splice(this.index, 0, markDesc);\n      this.top = markDesc;\n      this.changed = true;\n    }\n    this.index = 0;\n    depth++;\n  }\n};\n\n// : (Node, [Decoration], DecorationSet) → bool\n// Try to find a node desc matching the given data. Skip over it and\n// return true when successful.\nViewTreeUpdater.prototype.findNodeMatch = function findNodeMatch (node, outerDeco, innerDeco, index) {\n  var found = -1, preMatch = index < 0 ? undefined : this.getPreMatch(index), children = this.top.children;\n  if (preMatch && preMatch.matchesNode(node, outerDeco, innerDeco)) {\n    found = children.indexOf(preMatch);\n  } else {\n    for (var i = this.index, e = Math.min(children.length, i + 5); i < e; i++) {\n      var child = children[i];\n      if (child.matchesNode(node, outerDeco, innerDeco) && this.preMatched.indexOf(child) < 0) {\n        found = i;\n        break\n      }\n    }\n  }\n  if (found < 0) { return false }\n  this.destroyBetween(this.index, found);\n  this.index++;\n  return true\n};\n\n// : (Node, [Decoration], DecorationSet, EditorView, Fragment, number) → bool\n// Try to update the next node, if any, to the given data. Checks\n// pre-matches to avoid overwriting nodes that could still be used.\nViewTreeUpdater.prototype.updateNextNode = function updateNextNode (node, outerDeco, innerDeco, view, index) {\n  for (var i = this.index; i < this.top.children.length; i++) {\n    var next = this.top.children[i];\n    if (next instanceof NodeViewDesc) {\n      var preMatch = this.preMatched.indexOf(next);\n      if (preMatch > -1 && preMatch + this.preMatchOffset != index) { return false }\n      var nextDOM = next.dom;\n\n      // Can't update if nextDOM is or contains this.lock, except if\n      // it's a text node whose content already matches the new text\n      // and whose decorations match the new ones.\n      var locked = this.lock && (nextDOM == this.lock || nextDOM.nodeType == 1 && nextDOM.contains(this.lock.parentNode)) &&\n          !(node.isText && next.node && next.node.isText && next.nodeDOM.nodeValue == node.text &&\n            next.dirty != NODE_DIRTY && sameOuterDeco(outerDeco, next.outerDeco));\n      if (!locked && next.update(node, outerDeco, innerDeco, view)) {\n        this.destroyBetween(this.index, i);\n        if (next.dom != nextDOM) { this.changed = true; }\n        this.index++;\n        return true\n      }\n      break\n    }\n  }\n  return false\n};\n\n// : (Node, [Decoration], DecorationSet, EditorView)\n// Insert the node as a newly created node desc.\nViewTreeUpdater.prototype.addNode = function addNode (node, outerDeco, innerDeco, view, pos) {\n  this.top.children.splice(this.index++, 0, NodeViewDesc.create(this.top, node, outerDeco, innerDeco, view, pos));\n  this.changed = true;\n};\n\nViewTreeUpdater.prototype.placeWidget = function placeWidget (widget, view, pos) {\n  var next = this.index < this.top.children.length ? this.top.children[this.index] : null;\n  if (next && next.matchesWidget(widget) && (widget == next.widget || !next.widget.type.toDOM.parentNode)) {\n    this.index++;\n  } else {\n    var desc = new WidgetViewDesc(this.top, widget, view, pos);\n    this.top.children.splice(this.index++, 0, desc);\n    this.changed = true;\n  }\n};\n\n// Make sure a textblock looks and behaves correctly in\n// contentEditable.\nViewTreeUpdater.prototype.addTextblockHacks = function addTextblockHacks () {\n  var lastChild = this.top.children[this.index - 1];\n  while (lastChild instanceof MarkViewDesc) { lastChild = lastChild.children[lastChild.children.length - 1]; }\n\n  if (!lastChild || // Empty textblock\n      !(lastChild instanceof TextViewDesc) ||\n      /\\n$/.test(lastChild.node.text)) {\n    if (this.index < this.top.children.length && this.top.children[this.index].matchesHack()) {\n      this.index++;\n    } else {\n      var dom = document.createElement(\"br\");\n      this.top.children.splice(this.index++, 0, new BRHackViewDesc(this.top, nothing, dom, null));\n      this.changed = true;\n    }\n  }\n};\n\n// : (Fragment, [ViewDesc]) → [ViewDesc]\n// Iterate from the end of the fragment and array of descs to find\n// directly matching ones, in order to avoid overeagerly reusing\n// those for other nodes. Returns an array whose positions correspond\n// to node positions in the fragment, and whose elements are either\n// descs matched to the child at that index, or empty.\nfunction preMatch(frag, descs) {\n  var result = [], end = frag.childCount;\n  for (var i = descs.length - 1; end > 0 && i >= 0; i--) {\n    var desc = descs[i], node = desc.node;\n    if (!node) { continue }\n    if (node != frag.child(end - 1)) { break }\n    result.push(desc);\n    --end;\n  }\n  return {nodes: result.reverse(), offset: end}\n}\n\nfunction compareSide(a, b) { return a.type.side - b.type.side }\n\n// : (ViewDesc, DecorationSet, (Decoration, number), (Node, [Decoration], DecorationSet, number))\n// This function abstracts iterating over the nodes and decorations in\n// a fragment. Calls `onNode` for each node, with its local and child\n// decorations. Splits text nodes when there is a decoration starting\n// or ending inside of them. Calls `onWidget` for each widget.\nfunction iterDeco(parent, deco, onWidget, onNode) {\n  var locals = deco.locals(parent), offset = 0;\n  // Simple, cheap variant for when there are no local decorations\n  if (locals.length == 0) {\n    for (var i = 0; i < parent.childCount; i++) {\n      var child = parent.child(i);\n      onNode(child, locals, deco.forChild(offset, child), i);\n      offset += child.nodeSize;\n    }\n    return\n  }\n\n  var decoIndex = 0, active = [], restNode = null;\n  for (var parentIndex = 0;;) {\n    if (decoIndex < locals.length && locals[decoIndex].to == offset) {\n      var widget = locals[decoIndex++], widgets = (void 0);\n      while (decoIndex < locals.length && locals[decoIndex].to == offset)\n        { (widgets || (widgets = [widget])).push(locals[decoIndex++]); }\n      if (widgets) {\n        widgets.sort(compareSide);\n        for (var i$1 = 0; i$1 < widgets.length; i$1++) { onWidget(widgets[i$1], parentIndex, !!restNode); }\n      } else {\n        onWidget(widget, parentIndex, !!restNode);\n      }\n    }\n\n    var child$1 = (void 0), index = (void 0);\n    if (restNode) {\n      index = -1;\n      child$1 = restNode;\n      restNode = null;\n    } else if (parentIndex < parent.childCount) {\n      index = parentIndex;\n      child$1 = parent.child(parentIndex++);\n    } else {\n      break\n    }\n\n    for (var i$2 = 0; i$2 < active.length; i$2++) { if (active[i$2].to <= offset) { active.splice(i$2--, 1); } }\n    while (decoIndex < locals.length && locals[decoIndex].from <= offset && locals[decoIndex].to > offset)\n      { active.push(locals[decoIndex++]); }\n\n    var end = offset + child$1.nodeSize;\n    if (child$1.isText) {\n      var cutAt = end;\n      if (decoIndex < locals.length && locals[decoIndex].from < cutAt) { cutAt = locals[decoIndex].from; }\n      for (var i$3 = 0; i$3 < active.length; i$3++) { if (active[i$3].to < cutAt) { cutAt = active[i$3].to; } }\n      if (cutAt < end) {\n        restNode = child$1.cut(cutAt - offset);\n        child$1 = child$1.cut(0, cutAt - offset);\n        end = cutAt;\n        index = -1;\n      }\n    }\n\n    var outerDeco = !active.length ? nothing\n        : child$1.isInline && !child$1.isLeaf ? active.filter(function (d) { return !d.inline; })\n        : active.slice();\n    onNode(child$1, outerDeco, deco.forChild(offset, child$1), index);\n    offset = end;\n  }\n}\n\n// List markers in Mobile Safari will mysteriously disappear\n// sometimes. This works around that.\nfunction iosHacks(dom) {\n  if (dom.nodeName == \"UL\" || dom.nodeName == \"OL\") {\n    var oldCSS = dom.style.cssText;\n    dom.style.cssText = oldCSS + \"; list-style: square !important\";\n    window.getComputedStyle(dom).listStyle;\n    dom.style.cssText = oldCSS;\n  }\n}\n\nfunction nearbyTextNode(node, offset) {\n  for (;;) {\n    if (node.nodeType == 3) { return node }\n    if (node.nodeType == 1 && offset > 0) {\n      if (node.childNodes.length > offset && node.childNodes[offset].nodeType == 3)\n        { return node.childNodes[offset] }\n      node = node.childNodes[offset - 1];\n      offset = nodeSize(node);\n    } else if (node.nodeType == 1 && offset < node.childNodes.length) {\n      node = node.childNodes[offset];\n      offset = 0;\n    } else {\n      return null\n    }\n  }\n}\n\n// Find a piece of text in an inline fragment, overlapping from-to\nfunction findTextInFragment(frag, text, from, to) {\n  for (var i = 0, pos = 0; i < frag.childCount && pos <= to;) {\n    var child = frag.child(i++), childStart = pos;\n    pos += child.nodeSize;\n    if (!child.isText) { continue }\n    var str = child.text;\n    while (i < frag.childCount) {\n      var next = frag.child(i++);\n      pos += next.nodeSize;\n      if (!next.isText) { break }\n      str += next.text;\n    }\n    if (pos >= from) {\n      var found = str.lastIndexOf(text, to - childStart);\n      if (found >= 0 && found + text.length + childStart >= from)\n        { return childStart + found }\n    }\n  }\n  return -1\n}\n\n// Replace range from-to in an array of view descs with replacement\n// (may be null to just delete). This goes very much against the grain\n// of the rest of this code, which tends to create nodes with the\n// right shape in one go, rather than messing with them after\n// creation, but is necessary in the composition hack.\nfunction replaceNodes(nodes, from, to, view, replacement) {\n  var result = [];\n  for (var i = 0, off = 0; i < nodes.length; i++) {\n    var child = nodes[i], start = off, end = off += child.size;\n    if (start >= to || end <= from) {\n      result.push(child);\n    } else {\n      if (start < from) { result.push(child.slice(0, from - start, view)); }\n      if (replacement) {\n        result.push(replacement);\n        replacement = null;\n      }\n      if (end > to) { result.push(child.slice(to - start, child.size, view)); }\n    }\n  }\n  return result\n}\n\nfunction selectionFromDOM(view, origin) {\n  var domSel = view.root.getSelection(), doc = view.state.doc;\n  if (!domSel.focusNode) { return null }\n  var nearestDesc = view.docView.nearestDesc(domSel.focusNode), inWidget = nearestDesc && nearestDesc.size == 0;\n  var head = view.docView.posFromDOM(domSel.focusNode, domSel.focusOffset);\n  if (head < 0) { return null }\n  var $head = doc.resolve(head), $anchor, selection;\n  if (selectionCollapsed(domSel)) {\n    $anchor = $head;\n    while (nearestDesc && !nearestDesc.node) { nearestDesc = nearestDesc.parent; }\n    if (nearestDesc && nearestDesc.node.isAtom && NodeSelection.isSelectable(nearestDesc.node) && nearestDesc.parent\n        && !(nearestDesc.node.isInline && isOnEdge(domSel.focusNode, domSel.focusOffset, nearestDesc.dom))) {\n      var pos = nearestDesc.posBefore;\n      selection = new NodeSelection(head == pos ? $head : doc.resolve(pos));\n    }\n  } else {\n    var anchor = view.docView.posFromDOM(domSel.anchorNode, domSel.anchorOffset);\n    if (anchor < 0) { return null }\n    $anchor = doc.resolve(anchor);\n  }\n\n  if (!selection) {\n    var bias = origin == \"pointer\" || (view.state.selection.head < $head.pos && !inWidget) ? 1 : -1;\n    selection = selectionBetween(view, $anchor, $head, bias);\n  }\n  return selection\n}\n\nfunction selectionToDOM(view, force) {\n  var sel = view.state.selection;\n  syncNodeSelection(view, sel);\n\n  if (view.editable ? !view.hasFocus() :\n      !(hasSelection(view) && document.activeElement && document.activeElement.contains(view.dom))) { return }\n\n  view.domObserver.disconnectSelection();\n\n  if (view.cursorWrapper) {\n    selectCursorWrapper(view);\n  } else {\n    var anchor = sel.anchor;\n    var head = sel.head;\n    var resetEditableFrom, resetEditableTo;\n    if (brokenSelectBetweenUneditable && !(sel instanceof TextSelection)) {\n      if (!sel.$from.parent.inlineContent)\n        { resetEditableFrom = temporarilyEditableNear(view, sel.from); }\n      if (!sel.empty && !sel.$from.parent.inlineContent)\n        { resetEditableTo = temporarilyEditableNear(view, sel.to); }\n    }\n    view.docView.setSelection(anchor, head, view.root, force);\n    if (brokenSelectBetweenUneditable) {\n      if (resetEditableFrom) { resetEditable(resetEditableFrom); }\n      if (resetEditableTo) { resetEditable(resetEditableTo); }\n    }\n    if (sel.visible) {\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    } else {\n      view.dom.classList.add(\"ProseMirror-hideselection\");\n      if (\"onselectionchange\" in document) { removeClassOnSelectionChange(view); }\n    }\n  }\n\n  view.domObserver.setCurSelection();\n  view.domObserver.connectSelection();\n}\n\n// Kludge to work around Webkit not allowing a selection to start/end\n// between non-editable block nodes. We briefly make something\n// editable, set the selection, then set it uneditable again.\n\nvar brokenSelectBetweenUneditable = result.safari || result.chrome && result.chrome_version < 63;\n\nfunction temporarilyEditableNear(view, pos) {\n  var ref = view.docView.domFromPos(pos, 0);\n  var node = ref.node;\n  var offset = ref.offset;\n  var after = offset < node.childNodes.length ? node.childNodes[offset] : null;\n  var before = offset ? node.childNodes[offset - 1] : null;\n  if (result.safari && after && after.contentEditable == \"false\") { return setEditable(after) }\n  if ((!after || after.contentEditable == \"false\") && (!before || before.contentEditable == \"false\")) {\n    if (after) { return setEditable(after) }\n    else if (before) { return setEditable(before) }\n  }\n}\n\nfunction setEditable(element) {\n  element.contentEditable = \"true\";\n  if (result.safari && element.draggable) { element.draggable = false; element.wasDraggable = true; }\n  return element\n}\n\nfunction resetEditable(element) {\n  element.contentEditable = \"false\";\n  if (element.wasDraggable) { element.draggable = true; element.wasDraggable = null; }\n}\n\nfunction removeClassOnSelectionChange(view) {\n  var doc = view.dom.ownerDocument;\n  doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n  var domSel = view.root.getSelection();\n  var node = domSel.anchorNode, offset = domSel.anchorOffset;\n  doc.addEventListener(\"selectionchange\", view.hideSelectionGuard = function () {\n    if (domSel.anchorNode != node || domSel.anchorOffset != offset) {\n      doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    }\n  });\n}\n\nfunction selectCursorWrapper(view) {\n  var domSel = view.root.getSelection(), range = document.createRange();\n  var node = view.cursorWrapper.dom, img = node.nodeName == \"IMG\";\n  if (img) { range.setEnd(node.parentNode, domIndex(node) + 1); }\n  else { range.setEnd(node, 0); }\n  range.collapse(false);\n  domSel.removeAllRanges();\n  domSel.addRange(range);\n  // Kludge to kill 'control selection' in IE11 when selecting an\n  // invisible cursor wrapper, since that would result in those weird\n  // resize handles and a selection that considers the absolutely\n  // positioned wrapper, rather than the root editable node, the\n  // focused element.\n  if (!img && !view.state.selection.visible && result.ie && result.ie_version <= 11) {\n    node.disabled = true;\n    node.disabled = false;\n  }\n}\n\nfunction syncNodeSelection(view, sel) {\n  if (sel instanceof NodeSelection) {\n    var desc = view.docView.descAt(sel.from);\n    if (desc != view.lastSelectedViewDesc) {\n      clearNodeSelection(view);\n      if (desc) { desc.selectNode(); }\n      view.lastSelectedViewDesc = desc;\n    }\n  } else {\n    clearNodeSelection(view);\n  }\n}\n\n// Clear all DOM statefulness of the last node selection.\nfunction clearNodeSelection(view) {\n  if (view.lastSelectedViewDesc) {\n    if (view.lastSelectedViewDesc.parent)\n      { view.lastSelectedViewDesc.deselectNode(); }\n    view.lastSelectedViewDesc = null;\n  }\n}\n\nfunction selectionBetween(view, $anchor, $head, bias) {\n  return view.someProp(\"createSelectionBetween\", function (f) { return f(view, $anchor, $head); })\n    || TextSelection.between($anchor, $head, bias)\n}\n\nfunction hasFocusAndSelection(view) {\n  if (view.editable && view.root.activeElement != view.dom) { return false }\n  return hasSelection(view)\n}\n\nfunction hasSelection(view) {\n  var sel = view.root.getSelection();\n  if (!sel.anchorNode) { return false }\n  try {\n    // Firefox will raise 'permission denied' errors when accessing\n    // properties of `sel.anchorNode` when it's in a generated CSS\n    // element.\n    return view.dom.contains(sel.anchorNode.nodeType == 3 ? sel.anchorNode.parentNode : sel.anchorNode) &&\n      (view.editable || view.dom.contains(sel.focusNode.nodeType == 3 ? sel.focusNode.parentNode : sel.focusNode))\n  } catch(_) {\n    return false\n  }\n}\n\nfunction anchorInRightPlace(view) {\n  var anchorDOM = view.docView.domFromPos(view.state.selection.anchor, 0);\n  var domSel = view.root.getSelection();\n  return isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset)\n}\n\nfunction moveSelectionBlock(state, dir) {\n  var ref = state.selection;\n  var $anchor = ref.$anchor;\n  var $head = ref.$head;\n  var $side = dir > 0 ? $anchor.max($head) : $anchor.min($head);\n  var $start = !$side.parent.inlineContent ? $side : $side.depth ? state.doc.resolve(dir > 0 ? $side.after() : $side.before()) : null;\n  return $start && Selection.findFrom($start, dir)\n}\n\nfunction apply(view, sel) {\n  view.dispatch(view.state.tr.setSelection(sel).scrollIntoView());\n  return true\n}\n\nfunction selectHorizontally(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection) {\n    if (!sel.empty || mods.indexOf(\"s\") > -1) {\n      return false\n    } else if (view.endOfTextblock(dir > 0 ? \"right\" : \"left\")) {\n      var next = moveSelectionBlock(view.state, dir);\n      if (next && (next instanceof NodeSelection)) { return apply(view, next) }\n      return false\n    } else if (!(result.mac && mods.indexOf(\"m\") > -1)) {\n      var $head = sel.$head, node = $head.textOffset ? null : dir < 0 ? $head.nodeBefore : $head.nodeAfter, desc;\n      if (!node || node.isText) { return false }\n      var nodePos = dir < 0 ? $head.pos - node.nodeSize : $head.pos;\n      if (!(node.isAtom || (desc = view.docView.descAt(nodePos)) && !desc.contentDOM)) { return false }\n      if (NodeSelection.isSelectable(node)) {\n        return apply(view, new NodeSelection(dir < 0 ? view.state.doc.resolve($head.pos - node.nodeSize) : $head))\n      } else if (result.webkit) {\n        // Chrome and Safari will introduce extra pointless cursor\n        // positions around inline uneditable nodes, so we have to\n        // take over and move the cursor past them (#937)\n        return apply(view, new TextSelection(view.state.doc.resolve(dir < 0 ? nodePos : nodePos + node.nodeSize)))\n      } else {\n        return false\n      }\n    }\n  } else if (sel instanceof NodeSelection && sel.node.isInline) {\n    return apply(view, new TextSelection(dir > 0 ? sel.$to : sel.$from))\n  } else {\n    var next$1 = moveSelectionBlock(view.state, dir);\n    if (next$1) { return apply(view, next$1) }\n    return false\n  }\n}\n\nfunction nodeLen(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isIgnorable(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.size == 0 && (dom.nextSibling || dom.nodeName != \"BR\")\n}\n\n// Make sure the cursor isn't directly after one or more ignored\n// nodes, which will confuse the browser's cursor motion logic.\nfunction skipIgnoredNodesLeft(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var moveNode, moveOffset, force = false;\n  // Gecko will do odd things when the selection is directly in front\n  // of a non-editable node, so in that case, move it into the next\n  // node if possible. Issue prosemirror/prosemirror#832.\n  if (result.gecko && node.nodeType == 1 && offset < nodeLen(node) && isIgnorable(node.childNodes[offset])) { force = true; }\n  for (;;) {\n    if (offset > 0) {\n      if (node.nodeType != 1) {\n        break\n      } else {\n        var before = node.childNodes[offset - 1];\n        if (isIgnorable(before)) {\n          moveNode = node;\n          moveOffset = --offset;\n        } else if (before.nodeType == 3) {\n          node = before;\n          offset = node.nodeValue.length;\n        } else { break }\n      }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var prev = node.previousSibling;\n      while (prev && isIgnorable(prev)) {\n        moveNode = node.parentNode;\n        moveOffset = domIndex(prev);\n        prev = prev.previousSibling;\n      }\n      if (!prev) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = 0;\n      } else {\n        node = prev;\n        offset = nodeLen(node);\n      }\n    }\n  }\n  if (force) { setSelFocus(view, sel, node, offset); }\n  else if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\n// Make sure the cursor isn't directly before one or more ignored\n// nodes.\nfunction skipIgnoredNodesRight(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var len = nodeLen(node);\n  var moveNode, moveOffset;\n  for (;;) {\n    if (offset < len) {\n      if (node.nodeType != 1) { break }\n      var after = node.childNodes[offset];\n      if (isIgnorable(after)) {\n        moveNode = node;\n        moveOffset = ++offset;\n      }\n      else { break }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var next = node.nextSibling;\n      while (next && isIgnorable(next)) {\n        moveNode = next.parentNode;\n        moveOffset = domIndex(next) + 1;\n        next = next.nextSibling;\n      }\n      if (!next) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = len = 0;\n      } else {\n        node = next;\n        offset = 0;\n        len = nodeLen(node);\n      }\n    }\n  }\n  if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\nfunction isBlockNode(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.node && desc.node.isBlock\n}\n\nfunction setSelFocus(view, sel, node, offset) {\n  if (selectionCollapsed(sel)) {\n    var range = document.createRange();\n    range.setEnd(node, offset);\n    range.setStart(node, offset);\n    sel.removeAllRanges();\n    sel.addRange(range);\n  } else if (sel.extend) {\n    sel.extend(node, offset);\n  }\n  view.domObserver.setCurSelection();\n  var state = view.state;\n  // If no state update ends up happening, reset the selection.\n  setTimeout(function () {\n    if (view.state == state) { selectionToDOM(view); }\n  }, 50);\n}\n\n// : (EditorState, number)\n// Check whether vertical selection motion would involve node\n// selections. If so, apply it (if not, the result is left to the\n// browser)\nfunction selectVertically(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection && !sel.empty || mods.indexOf(\"s\") > -1) { return false }\n  if (result.mac && mods.indexOf(\"m\") > -1) { return false }\n  var $from = sel.$from;\n  var $to = sel.$to;\n\n  if (!$from.parent.inlineContent || view.endOfTextblock(dir < 0 ? \"up\" : \"down\")) {\n    var next = moveSelectionBlock(view.state, dir);\n    if (next && (next instanceof NodeSelection))\n      { return apply(view, next) }\n  }\n  if (!$from.parent.inlineContent) {\n    var beyond = Selection.findFrom(dir < 0 ? $from : $to, dir);\n    return beyond ? apply(view, beyond) : true\n  }\n  return false\n}\n\nfunction stopNativeHorizontalDelete(view, dir) {\n  if (!(view.state.selection instanceof TextSelection)) { return true }\n  var ref = view.state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  var empty = ref.empty;\n  if (!$head.sameParent($anchor)) { return true }\n  if (!empty) { return false }\n  if (view.endOfTextblock(dir > 0 ? \"forward\" : \"backward\")) { return true }\n  var nextNode = !$head.textOffset && (dir < 0 ? $head.nodeBefore : $head.nodeAfter);\n  if (nextNode && !nextNode.isText) {\n    var tr = view.state.tr;\n    if (dir < 0) { tr.delete($head.pos - nextNode.nodeSize, $head.pos); }\n    else { tr.delete($head.pos, $head.pos + nextNode.nodeSize); }\n    view.dispatch(tr);\n    return true\n  }\n  return false\n}\n\nfunction switchEditable(view, node, state) {\n  view.domObserver.stop();\n  node.contentEditable = state;\n  view.domObserver.start();\n}\n\n// Issue #867 / #1090 / https://bugs.chromium.org/p/chromium/issues/detail?id=903821\n// In which Safari (and at some point in the past, Chrome) does really\n// wrong things when the down arrow is pressed when the cursor is\n// directly at the start of a textblock and has an uneditable node\n// after it\nfunction safariDownArrowBug(view) {\n  if (!result.safari || view.state.selection.$head.parentOffset > 0) { return }\n  var ref = view.root.getSelection();\n  var focusNode = ref.focusNode;\n  var focusOffset = ref.focusOffset;\n  if (focusNode && focusNode.nodeType == 1 && focusOffset == 0 &&\n      focusNode.firstChild && focusNode.firstChild.contentEditable == \"false\") {\n    var child = focusNode.firstChild;\n    switchEditable(view, child, true);\n    setTimeout(function () { return switchEditable(view, child, false); }, 20);\n  }\n}\n\n// A backdrop key mapping used to make sure we always suppress keys\n// that have a dangerous default effect, even if the commands they are\n// bound to return false, and to make sure that cursor-motion keys\n// find a cursor (as opposed to a node selection) when pressed. For\n// cursor-motion keys, the code in the handlers also takes care of\n// block selections.\n\nfunction getMods(event) {\n  var result = \"\";\n  if (event.ctrlKey) { result += \"c\"; }\n  if (event.metaKey) { result += \"m\"; }\n  if (event.altKey) { result += \"a\"; }\n  if (event.shiftKey) { result += \"s\"; }\n  return result\n}\n\nfunction captureKeyDown(view, event) {\n  var code = event.keyCode, mods = getMods(event);\n  if (code == 8 || (result.mac && code == 72 && mods == \"c\")) { // Backspace, Ctrl-h on Mac\n    return stopNativeHorizontalDelete(view, -1) || skipIgnoredNodesLeft(view)\n  } else if (code == 46 || (result.mac && code == 68 && mods == \"c\")) { // Delete, Ctrl-d on Mac\n    return stopNativeHorizontalDelete(view, 1) || skipIgnoredNodesRight(view)\n  } else if (code == 13 || code == 27) { // Enter, Esc\n    return true\n  } else if (code == 37) { // Left arrow\n    return selectHorizontally(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 39) { // Right arrow\n    return selectHorizontally(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (code == 38) { // Up arrow\n    return selectVertically(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 40) { // Down arrow\n    return safariDownArrowBug(view) || selectVertically(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (mods == (result.mac ? \"m\" : \"c\") &&\n             (code == 66 || code == 73 || code == 89 || code == 90)) { // Mod-[biyz]\n    return true\n  }\n  return false\n}\n\n// Note that all referencing and parsing is done with the\n// start-of-operation selection and document, since that's the one\n// that the DOM represents. If any changes came in in the meantime,\n// the modification is mapped over those before it is applied, in\n// readDOMChange.\n\nfunction parseBetween(view, from_, to_) {\n  var ref = view.docView.parseRange(from_, to_);\n  var parent = ref.node;\n  var fromOffset = ref.fromOffset;\n  var toOffset = ref.toOffset;\n  var from = ref.from;\n  var to = ref.to;\n\n  var domSel = view.root.getSelection(), find = null, anchor = domSel.anchorNode;\n  if (anchor && view.dom.contains(anchor.nodeType == 1 ? anchor : anchor.parentNode)) {\n    find = [{node: anchor, offset: domSel.anchorOffset}];\n    if (!selectionCollapsed(domSel))\n      { find.push({node: domSel.focusNode, offset: domSel.focusOffset}); }\n  }\n  // Work around issue in Chrome where backspacing sometimes replaces\n  // the deleted content with a random BR node (issues #799, #831)\n  if (result.chrome && view.lastKeyCode === 8) {\n    for (var off = toOffset; off > fromOffset; off--) {\n      var node = parent.childNodes[off - 1], desc = node.pmViewDesc;\n      if (node.nodeType == \"BR\" && !desc) { toOffset = off; break }\n      if (!desc || desc.size) { break }\n    }\n  }\n  var startDoc = view.state.doc;\n  var parser = view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n  var $from = startDoc.resolve(from);\n\n  var sel = null, doc = parser.parse(parent, {\n    topNode: $from.parent,\n    topMatch: $from.parent.contentMatchAt($from.index()),\n    topOpen: true,\n    from: fromOffset,\n    to: toOffset,\n    preserveWhitespace: $from.parent.type.spec.code ? \"full\" : true,\n    editableContent: true,\n    findPositions: find,\n    ruleFromNode: ruleFromNode,\n    context: $from\n  });\n  if (find && find[0].pos != null) {\n    var anchor$1 = find[0].pos, head = find[1] && find[1].pos;\n    if (head == null) { head = anchor$1; }\n    sel = {anchor: anchor$1 + from, head: head + from};\n  }\n  return {doc: doc, sel: sel, from: from, to: to}\n}\n\nfunction ruleFromNode(dom) {\n  var desc = dom.pmViewDesc;\n  if (desc) {\n    return desc.parseRule()\n  } else if (dom.nodeName == \"BR\" && dom.parentNode) {\n    // Safari replaces the list item or table cell with a BR\n    // directly in the list node (?!) if you delete the last\n    // character in a list item or table cell (#708, #862)\n    if (result.safari && /^(ul|ol)$/i.test(dom.parentNode.nodeName)) {\n      var skip = document.createElement(\"div\");\n      skip.appendChild(document.createElement(\"li\"));\n      return {skip: skip}\n    } else if (dom.parentNode.lastChild == dom || result.safari && /^(tr|table)$/i.test(dom.parentNode.nodeName)) {\n      return {ignore: true}\n    }\n  } else if (dom.nodeName == \"IMG\" && dom.getAttribute(\"mark-placeholder\")) {\n    return {ignore: true}\n  }\n}\n\nfunction readDOMChange(view, from, to, typeOver, addedNodes) {\n  if (from < 0) {\n    var origin = view.lastSelectionTime > Date.now() - 50 ? view.lastSelectionOrigin : null;\n    var newSel = selectionFromDOM(view, origin);\n    if (newSel && !view.state.selection.eq(newSel)) {\n      var tr$1 = view.state.tr.setSelection(newSel);\n      if (origin == \"pointer\") { tr$1.setMeta(\"pointer\", true); }\n      else if (origin == \"key\") { tr$1.scrollIntoView(); }\n      view.dispatch(tr$1);\n    }\n    return\n  }\n\n  var $before = view.state.doc.resolve(from);\n  var shared = $before.sharedDepth(to);\n  from = $before.before(shared + 1);\n  to = view.state.doc.resolve(to).after(shared + 1);\n\n  var sel = view.state.selection;\n  var parse = parseBetween(view, from, to);\n  // Chrome sometimes leaves the cursor before the inserted text when\n  // composing after a cursor wrapper. This moves it forward.\n  if (result.chrome && view.cursorWrapper && parse.sel && parse.sel.anchor == view.cursorWrapper.deco.from) {\n    var text = view.cursorWrapper.deco.type.toDOM.nextSibling;\n    var size = text && text.nodeValue ? text.nodeValue.length : 1;\n    parse.sel = {anchor: parse.sel.anchor + size, head: parse.sel.anchor + size};\n  }\n\n  var doc = view.state.doc, compare = doc.slice(parse.from, parse.to);\n  var preferredPos, preferredSide;\n  // Prefer anchoring to end when Backspace is pressed\n  if (view.lastKeyCode === 8 && Date.now() - 100 < view.lastKeyCodeTime) {\n    preferredPos = view.state.selection.to;\n    preferredSide = \"end\";\n  } else {\n    preferredPos = view.state.selection.from;\n    preferredSide = \"start\";\n  }\n  view.lastKeyCode = null;\n\n  var change = findDiff(compare.content, parse.doc.content, parse.from, preferredPos, preferredSide);\n  if (!change) {\n    if (typeOver && sel instanceof TextSelection && !sel.empty && sel.$head.sameParent(sel.$anchor) &&\n        !view.composing && !(parse.sel && parse.sel.anchor != parse.sel.head)) {\n      change = {start: sel.from, endA: sel.to, endB: sel.to};\n    } else if (result.ios && view.lastIOSEnter > Date.now() - 225 &&\n               addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }) &&\n               view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n      view.lastIOSEnter = 0;\n      return\n    } else {\n      if (parse.sel) {\n        var sel$1 = resolveSelection(view, view.state.doc, parse.sel);\n        if (sel$1 && !sel$1.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel$1)); }\n      }\n      return\n    }\n  }\n  view.domChangeCount++;\n  // Handle the case where overwriting a selection by typing matches\n  // the start or end of the selected content, creating a change\n  // that's smaller than what was actually overwritten.\n  if (view.state.selection.from < view.state.selection.to &&\n      change.start == change.endB &&\n      view.state.selection instanceof TextSelection) {\n    if (change.start > view.state.selection.from && change.start <= view.state.selection.from + 2) {\n      change.start = view.state.selection.from;\n    } else if (change.endA < view.state.selection.to && change.endA >= view.state.selection.to - 2) {\n      change.endB += (view.state.selection.to - change.endA);\n      change.endA = view.state.selection.to;\n    }\n  }\n\n  // IE11 will insert a non-breaking space _ahead_ of the space after\n  // the cursor space when adding a space before another space. When\n  // that happened, adjust the change to cover the space instead.\n  if (result.ie && result.ie_version <= 11 && change.endB == change.start + 1 &&\n      change.endA == change.start && change.start > parse.from &&\n      parse.doc.textBetween(change.start - parse.from - 1, change.start - parse.from + 1) == \" \\u00a0\") {\n    change.start--;\n    change.endA--;\n    change.endB--;\n  }\n\n  var $from = parse.doc.resolveNoCache(change.start - parse.from);\n  var $to = parse.doc.resolveNoCache(change.endB - parse.from);\n  var inlineChange = $from.sameParent($to) && $from.parent.inlineContent;\n  var nextSel;\n  // If this looks like the effect of pressing Enter (or was recorded\n  // as being an iOS enter press), just dispatch an Enter key instead.\n  if (((result.ios && view.lastIOSEnter > Date.now() - 225 &&\n        (!inlineChange || addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }))) ||\n       (!inlineChange && $from.pos < parse.doc.content.size &&\n        (nextSel = Selection.findFrom(parse.doc.resolve($from.pos + 1), 1, true)) &&\n        nextSel.head == $to.pos)) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n    view.lastIOSEnter = 0;\n    return\n  }\n  // Same for backspace\n  if (view.state.selection.anchor > change.start &&\n      looksLikeJoin(doc, change.start, change.endA, $from, $to) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) {\n    if (result.android && result.chrome) { view.domObserver.suppressSelectionUpdates(); } // #820\n    return\n  }\n\n  // This tries to detect Android virtual keyboard\n  // enter-and-pick-suggestion action. That sometimes (see issue\n  // #1059) first fires a DOM mutation, before moving the selection to\n  // the newly created block. And then, because ProseMirror cleans up\n  // the DOM selection, it gives up moving the selection entirely,\n  // leaving the cursor in the wrong place. When that happens, we drop\n  // the new paragraph from the initial change, and fire a simulated\n  // enter key afterwards.\n  if (result.android && !inlineChange && $from.start() != $to.start() && $to.parentOffset == 0 && $from.depth == $to.depth &&\n      parse.sel && parse.sel.anchor == parse.sel.head && parse.sel.head == change.endA) {\n    change.endB -= 2;\n    $to = parse.doc.resolveNoCache(change.endB - parse.from);\n    setTimeout(function () {\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n    }, 20);\n  }\n\n  var chFrom = change.start, chTo = change.endA;\n\n  var tr, storedMarks, markChange, $from1;\n  if (inlineChange) {\n    if ($from.pos == $to.pos) { // Deletion\n      // IE11 sometimes weirdly moves the DOM selection around after\n      // backspacing out the first element in a textblock\n      if (result.ie && result.ie_version <= 11 && $from.parentOffset == 0) {\n        view.domObserver.suppressSelectionUpdates();\n        setTimeout(function () { return selectionToDOM(view); }, 20);\n      }\n      tr = view.state.tr.delete(chFrom, chTo);\n      storedMarks = doc.resolve(change.start).marksAcross(doc.resolve(change.endA));\n    } else if ( // Adding or removing a mark\n      change.endA == change.endB && ($from1 = doc.resolve(change.start)) &&\n      (markChange = isMarkChange($from.parent.content.cut($from.parentOffset, $to.parentOffset),\n                                 $from1.parent.content.cut($from1.parentOffset, change.endA - $from1.start())))\n    ) {\n      tr = view.state.tr;\n      if (markChange.type == \"add\") { tr.addMark(chFrom, chTo, markChange.mark); }\n      else { tr.removeMark(chFrom, chTo, markChange.mark); }\n    } else if ($from.parent.child($from.index()).isText && $from.index() == $to.index() - ($to.textOffset ? 0 : 1)) {\n      // Both positions in the same text node -- simply insert text\n      var text$1 = $from.parent.textBetween($from.parentOffset, $to.parentOffset);\n      if (view.someProp(\"handleTextInput\", function (f) { return f(view, chFrom, chTo, text$1); })) { return }\n      tr = view.state.tr.insertText(text$1, chFrom, chTo);\n    }\n  }\n\n  if (!tr)\n    { tr = view.state.tr.replace(chFrom, chTo, parse.doc.slice(change.start - parse.from, change.endB - parse.from)); }\n  if (parse.sel) {\n    var sel$2 = resolveSelection(view, tr.doc, parse.sel);\n    // Chrome Android will sometimes, during composition, report the\n    // selection in the wrong place. If it looks like that is\n    // happening, don't update the selection.\n    // Edge just doesn't move the cursor forward when you start typing\n    // in an empty block or between br nodes.\n    if (sel$2 && !(result.chrome && result.android && view.composing && sel$2.empty &&\n                   (sel$2.head == chFrom || sel$2.head == tr.mapping.map(chTo) - 1) ||\n                 result.ie && sel$2.empty && sel$2.head == chFrom))\n      { tr.setSelection(sel$2); }\n  }\n  if (storedMarks) { tr.ensureMarks(storedMarks); }\n  view.dispatch(tr.scrollIntoView());\n}\n\nfunction resolveSelection(view, doc, parsedSel) {\n  if (Math.max(parsedSel.anchor, parsedSel.head) > doc.content.size) { return null }\n  return selectionBetween(view, doc.resolve(parsedSel.anchor), doc.resolve(parsedSel.head))\n}\n\n// : (Fragment, Fragment) → ?{mark: Mark, type: string}\n// Given two same-length, non-empty fragments of inline content,\n// determine whether the first could be created from the second by\n// removing or adding a single mark type.\nfunction isMarkChange(cur, prev) {\n  var curMarks = cur.firstChild.marks, prevMarks = prev.firstChild.marks;\n  var added = curMarks, removed = prevMarks, type, mark, update;\n  for (var i = 0; i < prevMarks.length; i++) { added = prevMarks[i].removeFromSet(added); }\n  for (var i$1 = 0; i$1 < curMarks.length; i$1++) { removed = curMarks[i$1].removeFromSet(removed); }\n  if (added.length == 1 && removed.length == 0) {\n    mark = added[0];\n    type = \"add\";\n    update = function (node) { return node.mark(mark.addToSet(node.marks)); };\n  } else if (added.length == 0 && removed.length == 1) {\n    mark = removed[0];\n    type = \"remove\";\n    update = function (node) { return node.mark(mark.removeFromSet(node.marks)); };\n  } else {\n    return null\n  }\n  var updated = [];\n  for (var i$2 = 0; i$2 < prev.childCount; i$2++) { updated.push(update(prev.child(i$2))); }\n  if (Fragment.from(updated).eq(cur)) { return {mark: mark, type: type} }\n}\n\nfunction looksLikeJoin(old, start, end, $newStart, $newEnd) {\n  if (!$newStart.parent.isTextblock ||\n      // The content must have shrunk\n      end - start <= $newEnd.pos - $newStart.pos ||\n      // newEnd must point directly at or after the end of the block that newStart points into\n      skipClosingAndOpening($newStart, true, false) < $newEnd.pos)\n    { return false }\n\n  var $start = old.resolve(start);\n  // Start must be at the end of a block\n  if ($start.parentOffset < $start.parent.content.size || !$start.parent.isTextblock)\n    { return false }\n  var $next = old.resolve(skipClosingAndOpening($start, true, true));\n  // The next textblock must start before end and end near it\n  if (!$next.parent.isTextblock || $next.pos > end ||\n      skipClosingAndOpening($next, true, false) < end)\n    { return false }\n\n  // The fragments after the join point must match\n  return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)\n}\n\nfunction skipClosingAndOpening($pos, fromEnd, mayOpen) {\n  var depth = $pos.depth, end = fromEnd ? $pos.end() : $pos.pos;\n  while (depth > 0 && (fromEnd || $pos.indexAfter(depth) == $pos.node(depth).childCount)) {\n    depth--;\n    end++;\n    fromEnd = false;\n  }\n  if (mayOpen) {\n    var next = $pos.node(depth).maybeChild($pos.indexAfter(depth));\n    while (next && !next.isLeaf) {\n      next = next.firstChild;\n      end++;\n    }\n  }\n  return end\n}\n\nfunction findDiff(a, b, pos, preferredPos, preferredSide) {\n  var start = a.findDiffStart(b, pos);\n  if (start == null) { return null }\n  var ref = a.findDiffEnd(b, pos + a.size, pos + b.size);\n  var endA = ref.a;\n  var endB = ref.b;\n  if (preferredSide == \"end\") {\n    var adjust = Math.max(0, start - Math.min(endA, endB));\n    preferredPos -= endA + adjust - start;\n  }\n  if (endA < start && a.size < b.size) {\n    var move = preferredPos <= start && preferredPos >= endA ? start - preferredPos : 0;\n    start -= move;\n    endB = start + (endB - endA);\n    endA = start;\n  } else if (endB < start) {\n    var move$1 = preferredPos <= start && preferredPos >= endB ? start - preferredPos : 0;\n    start -= move$1;\n    endA = start + (endA - endB);\n    endB = start;\n  }\n  return {start: start, endA: endA, endB: endB}\n}\n\nfunction serializeForClipboard(view, slice) {\n  var context = [];\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  while (openStart > 1 && openEnd > 1 && content.childCount == 1 && content.firstChild.childCount == 1) {\n    openStart--;\n    openEnd--;\n    var node = content.firstChild;\n    context.push(node.type.name, node.attrs != node.type.defaultAttrs ? node.attrs : null);\n    content = node.content;\n  }\n\n  var serializer = view.someProp(\"clipboardSerializer\") || DOMSerializer.fromSchema(view.state.schema);\n  var doc = detachedDoc(), wrap = doc.createElement(\"div\");\n  wrap.appendChild(serializer.serializeFragment(content, {document: doc}));\n\n  var firstChild = wrap.firstChild, needsWrap;\n  while (firstChild && firstChild.nodeType == 1 && (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])) {\n    for (var i = needsWrap.length - 1; i >= 0; i--) {\n      var wrapper = doc.createElement(needsWrap[i]);\n      while (wrap.firstChild) { wrapper.appendChild(wrap.firstChild); }\n      wrap.appendChild(wrapper);\n    }\n    firstChild = wrap.firstChild;\n  }\n\n  if (firstChild && firstChild.nodeType == 1)\n    { firstChild.setAttribute(\"data-pm-slice\", (openStart + \" \" + openEnd + \" \" + (JSON.stringify(context)))); }\n\n  var text = view.someProp(\"clipboardTextSerializer\", function (f) { return f(slice); }) ||\n      slice.content.textBetween(0, slice.content.size, \"\\n\\n\");\n\n  return {dom: wrap, text: text}\n}\n\n// : (EditorView, string, string, ?bool, ResolvedPos) → ?Slice\n// Read a slice of content from the clipboard (or drop data).\nfunction parseFromClipboard(view, text, html, plainText, $context) {\n  var dom, inCode = $context.parent.type.spec.code, slice;\n  if (!html && !text) { return null }\n  var asText = text && (plainText || inCode || !html);\n  if (asText) {\n    view.someProp(\"transformPastedText\", function (f) { text = f(text, inCode || plainText); });\n    if (inCode) { return new Slice(Fragment.from(view.state.schema.text(text)), 0, 0) }\n    var parsed = view.someProp(\"clipboardTextParser\", function (f) { return f(text, $context, plainText); });\n    if (parsed) {\n      slice = parsed;\n    } else {\n      dom = document.createElement(\"div\");\n      text.trim().split(/(?:\\r\\n?|\\n)+/).forEach(function (block) {\n        dom.appendChild(document.createElement(\"p\")).textContent = block;\n      });\n    }\n  } else {\n    view.someProp(\"transformPastedHTML\", function (f) { html = f(html); });\n    dom = readHTML(html);\n  }\n\n  var contextNode = dom && dom.querySelector(\"[data-pm-slice]\");\n  var sliceData = contextNode && /^(\\d+) (\\d+) (.*)/.exec(contextNode.getAttribute(\"data-pm-slice\"));\n  if (!slice) {\n    var parser = view.someProp(\"clipboardParser\") || view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n    slice = parser.parseSlice(dom, {preserveWhitespace: !!(asText || sliceData), context: $context});\n  }\n  if (sliceData)\n    { slice = addContext(closeSlice(slice, +sliceData[1], +sliceData[2]), sliceData[3]); }\n  else // HTML wasn't created by ProseMirror. Make sure top-level siblings are coherent\n    { slice = Slice.maxOpen(normalizeSiblings(slice.content, $context), false); }\n\n  view.someProp(\"transformPasted\", function (f) { slice = f(slice); });\n  return slice\n}\n\n// Takes a slice parsed with parseSlice, which means there hasn't been\n// any content-expression checking done on the top nodes, tries to\n// find a parent node in the current context that might fit the nodes,\n// and if successful, rebuilds the slice so that it fits into that parent.\n//\n// This addresses the problem that Transform.replace expects a\n// coherent slice, and will fail to place a set of siblings that don't\n// fit anywhere in the schema.\nfunction normalizeSiblings(fragment, $context) {\n  if (fragment.childCount < 2) { return fragment }\n  var loop = function ( d ) {\n    var parent = $context.node(d);\n    var match = parent.contentMatchAt($context.index(d));\n    var lastWrap = (void 0), result = [];\n    fragment.forEach(function (node) {\n      if (!result) { return }\n      var wrap = match.findWrapping(node.type), inLast;\n      if (!wrap) { return result = null }\n      if (inLast = result.length && lastWrap.length && addToSibling(wrap, lastWrap, node, result[result.length - 1], 0)) {\n        result[result.length - 1] = inLast;\n      } else {\n        if (result.length) { result[result.length - 1] = closeRight(result[result.length - 1], lastWrap.length); }\n        var wrapped = withWrappers(node, wrap);\n        result.push(wrapped);\n        match = match.matchType(wrapped.type, wrapped.attrs);\n        lastWrap = wrap;\n      }\n    });\n    if (result) { return { v: Fragment.from(result) } }\n  };\n\n  for (var d = $context.depth; d >= 0; d--) {\n    var returned = loop( d );\n\n    if ( returned ) return returned.v;\n  }\n  return fragment\n}\n\nfunction withWrappers(node, wrap, from) {\n  if ( from === void 0 ) from = 0;\n\n  for (var i = wrap.length - 1; i >= from; i--)\n    { node = wrap[i].create(null, Fragment.from(node)); }\n  return node\n}\n\n// Used to group adjacent nodes wrapped in similar parents by\n// normalizeSiblings into the same parent node\nfunction addToSibling(wrap, lastWrap, node, sibling, depth) {\n  if (depth < wrap.length && depth < lastWrap.length && wrap[depth] == lastWrap[depth]) {\n    var inner = addToSibling(wrap, lastWrap, node, sibling.lastChild, depth + 1);\n    if (inner) { return sibling.copy(sibling.content.replaceChild(sibling.childCount - 1, inner)) }\n    var match = sibling.contentMatchAt(sibling.childCount);\n    if (match.matchType(depth == wrap.length - 1 ? node.type : wrap[depth + 1]))\n      { return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node, wrap, depth + 1)))) }\n  }\n}\n\nfunction closeRight(node, depth) {\n  if (depth == 0) { return node }\n  var fragment = node.content.replaceChild(node.childCount - 1, closeRight(node.lastChild, depth - 1));\n  var fill = node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true);\n  return node.copy(fragment.append(fill))\n}\n\nfunction closeRange(fragment, side, from, to, depth, openEnd) {\n  var node = side < 0 ? fragment.firstChild : fragment.lastChild, inner = node.content;\n  if (depth < to - 1) { inner = closeRange(inner, side, from, to, depth + 1, openEnd); }\n  if (depth >= from)\n    { inner = side < 0 ? node.contentMatchAt(0).fillBefore(inner, fragment.childCount > 1 || openEnd <= depth).append(inner)\n      : inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true)); }\n  return fragment.replaceChild(side < 0 ? 0 : fragment.childCount - 1, node.copy(inner))\n}\n\nfunction closeSlice(slice, openStart, openEnd) {\n  if (openStart < slice.openStart)\n    { slice = new Slice(closeRange(slice.content, -1, openStart, slice.openStart, 0, slice.openEnd), openStart, slice.openEnd); }\n  if (openEnd < slice.openEnd)\n    { slice = new Slice(closeRange(slice.content, 1, openEnd, slice.openEnd, 0, 0), slice.openStart, openEnd); }\n  return slice\n}\n\n// Trick from jQuery -- some elements must be wrapped in other\n// elements for innerHTML to work. I.e. if you do `div.innerHTML =\n// \"<td>..</td>\"` the table cells are ignored.\nvar wrapMap = {\n  thead: [\"table\"],\n  tbody: [\"table\"],\n  tfoot: [\"table\"],\n  caption: [\"table\"],\n  colgroup: [\"table\"],\n  col: [\"table\", \"colgroup\"],\n  tr: [\"table\", \"tbody\"],\n  td: [\"table\", \"tbody\", \"tr\"],\n  th: [\"table\", \"tbody\", \"tr\"]\n};\n\nvar _detachedDoc = null;\nfunction detachedDoc() {\n  return _detachedDoc || (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n}\n\nfunction readHTML(html) {\n  var metas = /(\\s*<meta [^>]*>)*/.exec(html);\n  if (metas) { html = html.slice(metas[0].length); }\n  var elt = detachedDoc().createElement(\"div\");\n  var firstTag = /(?:<meta [^>]*>)*<([a-z][^>\\s]+)/i.exec(html), wrap, depth = 0;\n  if (wrap = firstTag && wrapMap[firstTag[1].toLowerCase()]) {\n    html = wrap.map(function (n) { return \"<\" + n + \">\"; }).join(\"\") + html + wrap.map(function (n) { return \"</\" + n + \">\"; }).reverse().join(\"\");\n    depth = wrap.length;\n  }\n  elt.innerHTML = html;\n  for (var i = 0; i < depth; i++) { elt = elt.firstChild; }\n  return elt\n}\n\nfunction addContext(slice, context) {\n  if (!slice.size) { return slice }\n  var schema = slice.content.firstChild.type.schema, array;\n  try { array = JSON.parse(context); }\n  catch(e) { return slice }\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  for (var i = array.length - 2; i >= 0; i -= 2) {\n    var type = schema.nodes[array[i]];\n    if (!type || type.hasRequiredAttrs()) { break }\n    content = Fragment.from(type.create(array[i + 1], content));\n    openStart++; openEnd++;\n  }\n  return new Slice(content, openStart, openEnd)\n}\n\nvar observeOptions = {\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  attributes: true,\n  attributeOldValue: true,\n  subtree: true\n};\n// IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\nvar useCharData = result.ie && result.ie_version <= 11;\n\nvar SelectionState = function SelectionState() {\n  this.anchorNode = this.anchorOffset = this.focusNode = this.focusOffset = null;\n};\n\nSelectionState.prototype.set = function set (sel) {\n  this.anchorNode = sel.anchorNode; this.anchorOffset = sel.anchorOffset;\n  this.focusNode = sel.focusNode; this.focusOffset = sel.focusOffset;\n};\n\nSelectionState.prototype.eq = function eq (sel) {\n  return sel.anchorNode == this.anchorNode && sel.anchorOffset == this.anchorOffset &&\n    sel.focusNode == this.focusNode && sel.focusOffset == this.focusOffset\n};\n\nvar DOMObserver = function DOMObserver(view, handleDOMChange) {\n  var this$1 = this;\n\n  this.view = view;\n  this.handleDOMChange = handleDOMChange;\n  this.queue = [];\n  this.flushingSoon = -1;\n  this.observer = window.MutationObserver &&\n    new window.MutationObserver(function (mutations) {\n      for (var i = 0; i < mutations.length; i++) { this$1.queue.push(mutations[i]); }\n      // IE11 will sometimes (on backspacing out a single character\n      // text node after a BR node) call the observer callback\n      // before actually updating the DOM, which will cause\n      // ProseMirror to miss the change (see #930)\n      if (result.ie && result.ie_version <= 11 && mutations.some(\n        function (m) { return m.type == \"childList\" && m.removedNodes.length ||\n             m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length; }))\n        { this$1.flushSoon(); }\n      else\n        { this$1.flush(); }\n    });\n  this.currentSelection = new SelectionState;\n  if (useCharData) {\n    this.onCharData = function (e) {\n      this$1.queue.push({target: e.target, type: \"characterData\", oldValue: e.prevValue});\n      this$1.flushSoon();\n    };\n  }\n  this.onSelectionChange = this.onSelectionChange.bind(this);\n  this.suppressingSelectionUpdates = false;\n};\n\nDOMObserver.prototype.flushSoon = function flushSoon () {\n    var this$1 = this;\n\n  if (this.flushingSoon < 0)\n    { this.flushingSoon = window.setTimeout(function () { this$1.flushingSoon = -1; this$1.flush(); }, 20); }\n};\n\nDOMObserver.prototype.forceFlush = function forceFlush () {\n  if (this.flushingSoon > -1) {\n    window.clearTimeout(this.flushingSoon);\n    this.flushingSoon = -1;\n    this.flush();\n  }\n};\n\nDOMObserver.prototype.start = function start () {\n  if (this.observer)\n    { this.observer.observe(this.view.dom, observeOptions); }\n  if (useCharData)\n    { this.view.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.connectSelection();\n};\n\nDOMObserver.prototype.stop = function stop () {\n    var this$1 = this;\n\n  if (this.observer) {\n    var take = this.observer.takeRecords();\n    if (take.length) {\n      for (var i = 0; i < take.length; i++) { this.queue.push(take[i]); }\n      window.setTimeout(function () { return this$1.flush(); }, 20);\n    }\n    this.observer.disconnect();\n  }\n  if (useCharData) { this.view.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.disconnectSelection();\n};\n\nDOMObserver.prototype.connectSelection = function connectSelection () {\n  this.view.dom.ownerDocument.addEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.disconnectSelection = function disconnectSelection () {\n  this.view.dom.ownerDocument.removeEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.suppressSelectionUpdates = function suppressSelectionUpdates () {\n    var this$1 = this;\n\n  this.suppressingSelectionUpdates = true;\n  setTimeout(function () { return this$1.suppressingSelectionUpdates = false; }, 50);\n};\n\nDOMObserver.prototype.onSelectionChange = function onSelectionChange () {\n  if (!hasFocusAndSelection(this.view)) { return }\n  if (this.suppressingSelectionUpdates) { return selectionToDOM(this.view) }\n  // Deletions on IE11 fire their events in the wrong order, giving\n  // us a selection change event before the DOM changes are\n  // reported.\n  if (result.ie && result.ie_version <= 11 && !this.view.state.selection.empty) {\n    var sel = this.view.root.getSelection();\n    // Selection.isCollapsed isn't reliable on IE\n    if (sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n      { return this.flushSoon() }\n  }\n  this.flush();\n};\n\nDOMObserver.prototype.setCurSelection = function setCurSelection () {\n  this.currentSelection.set(this.view.root.getSelection());\n};\n\nDOMObserver.prototype.ignoreSelectionChange = function ignoreSelectionChange (sel) {\n  if (sel.rangeCount == 0) { return true }\n  var container = sel.getRangeAt(0).commonAncestorContainer;\n  var desc = this.view.docView.nearestDesc(container);\n  if (desc && desc.ignoreMutation({type: \"selection\", target: container.nodeType == 3 ? container.parentNode : container})) {\n    this.setCurSelection();\n    return true\n  }\n};\n\nDOMObserver.prototype.flush = function flush () {\n  if (!this.view.docView || this.flushingSoon > -1) { return }\n  var mutations = this.observer ? this.observer.takeRecords() : [];\n  if (this.queue.length) {\n    mutations = this.queue.concat(mutations);\n    this.queue.length = 0;\n  }\n\n  var sel = this.view.root.getSelection();\n  var newSel = !this.suppressingSelectionUpdates && !this.currentSelection.eq(sel) && hasSelection(this.view) && !this.ignoreSelectionChange(sel);\n\n  var from = -1, to = -1, typeOver = false, added = [];\n  if (this.view.editable) {\n    for (var i = 0; i < mutations.length; i++) {\n      var result$1 = this.registerMutation(mutations[i], added);\n      if (result$1) {\n        from = from < 0 ? result$1.from : Math.min(result$1.from, from);\n        to = to < 0 ? result$1.to : Math.max(result$1.to, to);\n        if (result$1.typeOver) { typeOver = true; }\n      }\n    }\n  }\n\n  if (result.gecko && added.length > 1) {\n    var brs = added.filter(function (n) { return n.nodeName == \"BR\"; });\n    if (brs.length == 2) {\n      var a = brs[0];\n        var b = brs[1];\n      if (a.parentNode && a.parentNode.parentNode == b.parentNode) { b.remove(); }\n      else { a.remove(); }\n    }\n  }\n\n  if (from > -1 || newSel) {\n    if (from > -1) {\n      this.view.docView.markDirty(from, to);\n      checkCSS(this.view);\n    }\n    this.handleDOMChange(from, to, typeOver, added);\n    if (this.view.docView.dirty) { this.view.updateState(this.view.state); }\n    else if (!this.currentSelection.eq(sel)) { selectionToDOM(this.view); }\n  }\n};\n\nDOMObserver.prototype.registerMutation = function registerMutation (mut, added) {\n  // Ignore mutations inside nodes that were already noted as inserted\n  if (added.indexOf(mut.target) > -1) { return null }\n  var desc = this.view.docView.nearestDesc(mut.target);\n  if (mut.type == \"attributes\" &&\n      (desc == this.view.docView || mut.attributeName == \"contenteditable\" ||\n       // Firefox sometimes fires spurious events for null/empty styles\n       (mut.attributeName == \"style\" && !mut.oldValue && !mut.target.getAttribute(\"style\"))))\n    { return null }\n  if (!desc || desc.ignoreMutation(mut)) { return null }\n\n  if (mut.type == \"childList\") {\n    var prev = mut.previousSibling, next = mut.nextSibling;\n    if (result.ie && result.ie_version <= 11 && mut.addedNodes.length) {\n      // IE11 gives us incorrect next/prev siblings for some\n      // insertions, so if there are added nodes, recompute those\n      for (var i = 0; i < mut.addedNodes.length; i++) {\n        var ref = mut.addedNodes[i];\n          var previousSibling = ref.previousSibling;\n          var nextSibling = ref.nextSibling;\n        if (!previousSibling || Array.prototype.indexOf.call(mut.addedNodes, previousSibling) < 0) { prev = previousSibling; }\n        if (!nextSibling || Array.prototype.indexOf.call(mut.addedNodes, nextSibling) < 0) { next = nextSibling; }\n      }\n    }\n    var fromOffset = prev && prev.parentNode == mut.target\n        ? domIndex(prev) + 1 : 0;\n    var from = desc.localPosFromDOM(mut.target, fromOffset, -1);\n    var toOffset = next && next.parentNode == mut.target\n        ? domIndex(next) : mut.target.childNodes.length;\n    for (var i$1 = 0; i$1 < mut.addedNodes.length; i$1++) { added.push(mut.addedNodes[i$1]); }\n    var to = desc.localPosFromDOM(mut.target, toOffset, 1);\n    return {from: from, to: to}\n  } else if (mut.type == \"attributes\") {\n    return {from: desc.posAtStart - desc.border, to: desc.posAtEnd + desc.border}\n  } else { // \"characterData\"\n    return {\n      from: desc.posAtStart,\n      to: desc.posAtEnd,\n      // An event was generated for a text change that didn't change\n      // any text. Mark the dom change to fall back to assuming the\n      // selection was typed over with an identical value if it can't\n      // find another change.\n      typeOver: mut.target.nodeValue == mut.oldValue\n    }\n  }\n};\n\nvar cssChecked = false;\n\nfunction checkCSS(view) {\n  if (cssChecked) { return }\n  cssChecked = true;\n  if (getComputedStyle(view.dom).whiteSpace == \"normal\")\n    { console[\"warn\"](\"ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.\"); }\n}\n\n// A collection of DOM events that occur within the editor, and callback functions\n// to invoke when the event fires.\nvar handlers = {}, editHandlers = {};\n\nfunction initInput(view) {\n  view.shiftKey = false;\n  view.mouseDown = null;\n  view.lastKeyCode = null;\n  view.lastKeyCodeTime = 0;\n  view.lastClick = {time: 0, x: 0, y: 0, type: \"\"};\n  view.lastSelectionOrigin = null;\n  view.lastSelectionTime = 0;\n\n  view.lastIOSEnter = 0;\n  view.lastIOSEnterFallbackTimeout = null;\n\n  view.composing = false;\n  view.composingTimeout = null;\n  view.compositionNodes = [];\n  view.compositionEndedAt = -2e8;\n\n  view.domObserver = new DOMObserver(view, function (from, to, typeOver, added) { return readDOMChange(view, from, to, typeOver, added); });\n  view.domObserver.start();\n  // Used by hacks like the beforeinput handler to check whether anything happened in the DOM\n  view.domChangeCount = 0;\n\n  view.eventHandlers = Object.create(null);\n  var loop = function ( event ) {\n    var handler = handlers[event];\n    view.dom.addEventListener(event, view.eventHandlers[event] = function (event) {\n      if (eventBelongsToView(view, event) && !runCustomHandler(view, event) &&\n          (view.editable || !(event.type in editHandlers)))\n        { handler(view, event); }\n    });\n  };\n\n  for (var event in handlers) loop( event );\n  // On Safari, for reasons beyond my understanding, adding an input\n  // event handler makes an issue where the composition vanishes when\n  // you press enter go away.\n  if (result.safari) { view.dom.addEventListener(\"input\", function () { return null; }); }\n\n  ensureListeners(view);\n}\n\nfunction setSelectionOrigin(view, origin) {\n  view.lastSelectionOrigin = origin;\n  view.lastSelectionTime = Date.now();\n}\n\nfunction destroyInput(view) {\n  view.domObserver.stop();\n  for (var type in view.eventHandlers)\n    { view.dom.removeEventListener(type, view.eventHandlers[type]); }\n  clearTimeout(view.composingTimeout);\n  clearTimeout(view.lastIOSEnterFallbackTimeout);\n}\n\nfunction ensureListeners(view) {\n  view.someProp(\"handleDOMEvents\", function (currentHandlers) {\n    for (var type in currentHandlers) { if (!view.eventHandlers[type])\n      { view.dom.addEventListener(type, view.eventHandlers[type] = function (event) { return runCustomHandler(view, event); }); } }\n  });\n}\n\nfunction runCustomHandler(view, event) {\n  return view.someProp(\"handleDOMEvents\", function (handlers) {\n    var handler = handlers[event.type];\n    return handler ? handler(view, event) || event.defaultPrevented : false\n  })\n}\n\nfunction eventBelongsToView(view, event) {\n  if (!event.bubbles) { return true }\n  if (event.defaultPrevented) { return false }\n  for (var node = event.target; node != view.dom; node = node.parentNode)\n    { if (!node || node.nodeType == 11 ||\n        (node.pmViewDesc && node.pmViewDesc.stopEvent(event)))\n      { return false } }\n  return true\n}\n\nfunction dispatchEvent(view, event) {\n  if (!runCustomHandler(view, event) && handlers[event.type] &&\n      (view.editable || !(event.type in editHandlers)))\n    { handlers[event.type](view, event); }\n}\n\neditHandlers.keydown = function (view, event) {\n  view.shiftKey = event.keyCode == 16 || event.shiftKey;\n  if (inOrNearComposition(view, event)) { return }\n  view.domObserver.forceFlush();\n  view.lastKeyCode = event.keyCode;\n  view.lastKeyCodeTime = Date.now();\n  // On iOS, if we preventDefault enter key presses, the virtual\n  // keyboard gets confused. So the hack here is to set a flag that\n  // makes the DOM change code recognize that what just happens should\n  // be replaced by whatever the Enter key handlers do.\n  if (result.ios && event.keyCode == 13 && !event.ctrlKey && !event.altKey && !event.metaKey) {\n    var now = Date.now();\n    view.lastIOSEnter = now;\n    view.lastIOSEnterFallbackTimeout = setTimeout(function () {\n      if (view.lastIOSEnter == now) {\n        view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n        view.lastIOSEnter = 0;\n      }\n    }, 200);\n  } else if (view.someProp(\"handleKeyDown\", function (f) { return f(view, event); }) || captureKeyDown(view, event)) {\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(view, \"key\");\n  }\n};\n\neditHandlers.keyup = function (view, e) {\n  if (e.keyCode == 16) { view.shiftKey = false; }\n};\n\neditHandlers.keypress = function (view, event) {\n  if (inOrNearComposition(view, event) || !event.charCode ||\n      event.ctrlKey && !event.altKey || result.mac && event.metaKey) { return }\n\n  if (view.someProp(\"handleKeyPress\", function (f) { return f(view, event); })) {\n    event.preventDefault();\n    return\n  }\n\n  var sel = view.state.selection;\n  if (!(sel instanceof TextSelection) || !sel.$from.sameParent(sel.$to)) {\n    var text = String.fromCharCode(event.charCode);\n    if (!view.someProp(\"handleTextInput\", function (f) { return f(view, sel.$from.pos, sel.$to.pos, text); }))\n      { view.dispatch(view.state.tr.insertText(text).scrollIntoView()); }\n    event.preventDefault();\n  }\n};\n\nfunction eventCoords(event) { return {left: event.clientX, top: event.clientY} }\n\nfunction isNear(event, click) {\n  var dx = click.x - event.clientX, dy = click.y - event.clientY;\n  return dx * dx + dy * dy < 100\n}\n\nfunction runHandlerOnContext(view, propName, pos, inside, event) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside);\n  var loop = function ( i ) {\n    if (view.someProp(propName, function (f) { return i > $pos.depth ? f(view, pos, $pos.nodeAfter, $pos.before(i), event, true)\n                                                    : f(view, pos, $pos.node(i), $pos.before(i), event, false); }))\n      { return { v: true } }\n  };\n\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var returned = loop( i );\n\n    if ( returned ) return returned.v;\n  }\n  return false\n}\n\nfunction updateSelection(view, selection, origin) {\n  if (!view.focused) { view.focus(); }\n  var tr = view.state.tr.setSelection(selection);\n  if (origin == \"pointer\") { tr.setMeta(\"pointer\", true); }\n  view.dispatch(tr);\n}\n\nfunction selectClickedLeaf(view, inside) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside), node = $pos.nodeAfter;\n  if (node && node.isAtom && NodeSelection.isSelectable(node)) {\n    updateSelection(view, new NodeSelection($pos), \"pointer\");\n    return true\n  }\n  return false\n}\n\nfunction selectClickedNode(view, inside) {\n  if (inside == -1) { return false }\n  var sel = view.state.selection, selectedNode, selectAt;\n  if (sel instanceof NodeSelection) { selectedNode = sel.node; }\n\n  var $pos = view.state.doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    if (NodeSelection.isSelectable(node)) {\n      if (selectedNode && sel.$from.depth > 0 &&\n          i >= sel.$from.depth && $pos.before(sel.$from.depth + 1) == sel.$from.pos)\n        { selectAt = $pos.before(sel.$from.depth); }\n      else\n        { selectAt = $pos.before(i); }\n      break\n    }\n  }\n\n  if (selectAt != null) {\n    updateSelection(view, NodeSelection.create(view.state.doc, selectAt), \"pointer\");\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction handleSingleClick(view, pos, inside, event, selectNode) {\n  return runHandlerOnContext(view, \"handleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleClick\", function (f) { return f(view, pos, event); }) ||\n    (selectNode ? selectClickedNode(view, inside) : selectClickedLeaf(view, inside))\n}\n\nfunction handleDoubleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleDoubleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleDoubleClick\", function (f) { return f(view, pos, event); })\n}\n\nfunction handleTripleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleTripleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleTripleClick\", function (f) { return f(view, pos, event); }) ||\n    defaultTripleClick(view, inside)\n}\n\nfunction defaultTripleClick(view, inside) {\n  var doc = view.state.doc;\n  if (inside == -1) {\n    if (doc.inlineContent) {\n      updateSelection(view, TextSelection.create(doc, 0, doc.content.size), \"pointer\");\n      return true\n    }\n    return false\n  }\n\n  var $pos = doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    var nodePos = $pos.before(i);\n    if (node.inlineContent)\n      { updateSelection(view, TextSelection.create(doc, nodePos + 1, nodePos + 1 + node.content.size), \"pointer\"); }\n    else if (NodeSelection.isSelectable(node))\n      { updateSelection(view, NodeSelection.create(doc, nodePos), \"pointer\"); }\n    else\n      { continue }\n    return true\n  }\n}\n\nfunction forceDOMFlush(view) {\n  return endComposition(view)\n}\n\nvar selectNodeModifier = result.mac ? \"metaKey\" : \"ctrlKey\";\n\nhandlers.mousedown = function (view, event) {\n  view.shiftKey = event.shiftKey;\n  var flushed = forceDOMFlush(view);\n  var now = Date.now(), type = \"singleClick\";\n  if (now - view.lastClick.time < 500 && isNear(event, view.lastClick) && !event[selectNodeModifier]) {\n    if (view.lastClick.type == \"singleClick\") { type = \"doubleClick\"; }\n    else if (view.lastClick.type == \"doubleClick\") { type = \"tripleClick\"; }\n  }\n  view.lastClick = {time: now, x: event.clientX, y: event.clientY, type: type};\n\n  var pos = view.posAtCoords(eventCoords(event));\n  if (!pos) { return }\n\n  if (type == \"singleClick\")\n    { view.mouseDown = new MouseDown(view, pos, event, flushed); }\n  else if ((type == \"doubleClick\" ? handleDoubleClick : handleTripleClick)(view, pos.pos, pos.inside, event))\n    { event.preventDefault(); }\n  else\n    { setSelectionOrigin(view, \"pointer\"); }\n};\n\nvar MouseDown = function MouseDown(view, pos, event, flushed) {\n  var this$1 = this;\n\n  this.view = view;\n  this.startDoc = view.state.doc;\n  this.pos = pos;\n  this.event = event;\n  this.flushed = flushed;\n  this.selectNode = event[selectNodeModifier];\n  this.allowDefault = event.shiftKey;\n\n  var targetNode, targetPos;\n  if (pos.inside > -1) {\n    targetNode = view.state.doc.nodeAt(pos.inside);\n    targetPos = pos.inside;\n  } else {\n    var $pos = view.state.doc.resolve(pos.pos);\n    targetNode = $pos.parent;\n    targetPos = $pos.depth ? $pos.before() : 0;\n  }\n\n  this.mightDrag = null;\n\n  var target = flushed ? null : event.target;\n  var targetDesc = target ? view.docView.nearestDesc(target, true) : null;\n  this.target = targetDesc ? targetDesc.dom : null;\n\n  if (targetNode.type.spec.draggable && targetNode.type.spec.selectable !== false ||\n      view.state.selection instanceof NodeSelection && targetPos == view.state.selection.from)\n    { this.mightDrag = {node: targetNode,\n                      pos: targetPos,\n                      addAttr: this.target && !this.target.draggable,\n                      setUneditable: this.target && result.gecko && !this.target.hasAttribute(\"contentEditable\")}; }\n\n  if (this.target && this.mightDrag && (this.mightDrag.addAttr || this.mightDrag.setUneditable)) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.draggable = true; }\n    if (this.mightDrag.setUneditable)\n      { setTimeout(function () { return this$1.target.setAttribute(\"contentEditable\", \"false\"); }, 20); }\n    this.view.domObserver.start();\n  }\n\n  view.root.addEventListener(\"mouseup\", this.up = this.up.bind(this));\n  view.root.addEventListener(\"mousemove\", this.move = this.move.bind(this));\n  setSelectionOrigin(view, \"pointer\");\n};\n\nMouseDown.prototype.done = function done () {\n  this.view.root.removeEventListener(\"mouseup\", this.up);\n  this.view.root.removeEventListener(\"mousemove\", this.move);\n  if (this.mightDrag && this.target) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.removeAttribute(\"draggable\"); }\n    if (this.mightDrag.setUneditable) { this.target.removeAttribute(\"contentEditable\"); }\n    this.view.domObserver.start();\n  }\n  this.view.mouseDown = null;\n};\n\nMouseDown.prototype.up = function up (event) {\n  this.done();\n\n  if (!this.view.dom.contains(event.target.nodeType == 3 ? event.target.parentNode : event.target))\n    { return }\n\n  var pos = this.pos;\n  if (this.view.state.doc != this.startDoc) { pos = this.view.posAtCoords(eventCoords(event)); }\n\n  if (this.allowDefault || !pos) {\n    setSelectionOrigin(this.view, \"pointer\");\n  } else if (handleSingleClick(this.view, pos.pos, pos.inside, event, this.selectNode)) {\n    event.preventDefault();\n  } else if (this.flushed ||\n             // Safari ignores clicks on draggable elements\n             (result.safari && this.mightDrag && !this.mightDrag.node.isAtom) ||\n             // Chrome will sometimes treat a node selection as a\n             // cursor, but still report that the node is selected\n             // when asked through getSelection. You'll then get a\n             // situation where clicking at the point where that\n             // (hidden) cursor is doesn't change the selection, and\n             // thus doesn't get a reaction from ProseMirror. This\n             // works around that.\n             (result.chrome && !(this.view.state.selection instanceof TextSelection) &&\n              (pos.pos == this.view.state.selection.from || pos.pos == this.view.state.selection.to))) {\n    updateSelection(this.view, Selection.near(this.view.state.doc.resolve(pos.pos)), \"pointer\");\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(this.view, \"pointer\");\n  }\n};\n\nMouseDown.prototype.move = function move (event) {\n  if (!this.allowDefault && (Math.abs(this.event.x - event.clientX) > 4 ||\n                             Math.abs(this.event.y - event.clientY) > 4))\n    { this.allowDefault = true; }\n  setSelectionOrigin(this.view, \"pointer\");\n};\n\nhandlers.touchdown = function (view) {\n  forceDOMFlush(view);\n  setSelectionOrigin(view, \"pointer\");\n};\n\nhandlers.contextmenu = function (view) { return forceDOMFlush(view); };\n\nfunction inOrNearComposition(view, event) {\n  if (view.composing) { return true }\n  // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n  // On Japanese input method editors (IMEs), the Enter key is used to confirm character\n  // selection. On Safari, when Enter is pressed, compositionend and keydown events are\n  // emitted. The keydown event triggers newline insertion, which we don't want.\n  // This method returns true if the keydown event should be ignored.\n  // We only ignore it once, as pressing Enter a second time *should* insert a newline.\n  // Furthermore, the keydown event timestamp must be close to the compositionEndedAt timestamp.\n  // This guards against the case where compositionend is triggered without the keyboard\n  // (e.g. character confirmation may be done with the mouse), and keydown is triggered\n  // afterwards- we wouldn't want to ignore the keydown event in this case.\n  if (result.safari && Math.abs(event.timeStamp - view.compositionEndedAt) < 500) {\n    view.compositionEndedAt = -2e8;\n    return true\n  }\n  return false\n}\n\n// Drop active composition after 5 seconds of inactivity on Android\nvar timeoutComposition = result.android ? 5000 : -1;\n\neditHandlers.compositionstart = editHandlers.compositionupdate = function (view) {\n  if (!view.composing) {\n    view.domObserver.flush();\n    var state = view.state;\n    var $pos = state.selection.$from;\n    if (state.selection.empty &&\n        (state.storedMarks ||\n         (!$pos.textOffset && $pos.parentOffset && $pos.nodeBefore.marks.some(function (m) { return m.type.spec.inclusive === false; })))) {\n      // Need to wrap the cursor in mark nodes different from the ones in the DOM context\n      view.markCursor = view.state.storedMarks || $pos.marks();\n      endComposition(view, true);\n      view.markCursor = null;\n    } else {\n      endComposition(view);\n      // In firefox, if the cursor is after but outside a marked node,\n      // the inserted text won't inherit the marks. So this moves it\n      // inside if necessary.\n      if (result.gecko && state.selection.empty && $pos.parentOffset && !$pos.textOffset && $pos.nodeBefore.marks.length) {\n        var sel = view.root.getSelection();\n        for (var node = sel.focusNode, offset = sel.focusOffset; node && node.nodeType == 1 && offset != 0;) {\n          var before = offset < 0 ? node.lastChild : node.childNodes[offset - 1];\n          if (!before) { break }\n          if (before.nodeType == 3) {\n            sel.collapse(before, before.nodeValue.length);\n            break\n          } else {\n            node = before;\n            offset = -1;\n          }\n        }\n      }\n    }\n    view.composing = true;\n  }\n  scheduleComposeEnd(view, timeoutComposition);\n};\n\neditHandlers.compositionend = function (view, event) {\n  if (view.composing) {\n    view.composing = false;\n    view.compositionEndedAt = event.timeStamp;\n    scheduleComposeEnd(view, 20);\n  }\n};\n\nfunction scheduleComposeEnd(view, delay) {\n  clearTimeout(view.composingTimeout);\n  if (delay > -1) { view.composingTimeout = setTimeout(function () { return endComposition(view); }, delay); }\n}\n\nfunction clearComposition(view) {\n  view.composing = false;\n  while (view.compositionNodes.length > 0) { view.compositionNodes.pop().markParentsDirty(); }\n}\n\nfunction endComposition(view, forceUpdate) {\n  view.domObserver.forceFlush();\n  clearComposition(view);\n  if (forceUpdate || view.docView.dirty) {\n    var sel = selectionFromDOM(view);\n    if (sel && !sel.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel)); }\n    else { view.updateState(view.state); }\n    return true\n  }\n  return false\n}\n\nfunction captureCopy(view, dom) {\n  // The extra wrapper is somehow necessary on IE/Edge to prevent the\n  // content from being mangled when it is put onto the clipboard\n  if (!view.dom.parentNode) { return }\n  var wrap = view.dom.parentNode.appendChild(document.createElement(\"div\"));\n  wrap.appendChild(dom);\n  wrap.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  var sel = getSelection(), range = document.createRange();\n  range.selectNodeContents(dom);\n  // Done because IE will fire a selectionchange moving the selection\n  // to its start when removeAllRanges is called and the editor still\n  // has focus (which will mess up the editor's selection state).\n  view.dom.blur();\n  sel.removeAllRanges();\n  sel.addRange(range);\n  setTimeout(function () {\n    if (wrap.parentNode) { wrap.parentNode.removeChild(wrap); }\n    view.focus();\n  }, 50);\n}\n\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard API—all the objects and methods are\n// there, they just don't work, and they are hard to test.\nvar brokenClipboardAPI = (result.ie && result.ie_version < 15) ||\n      (result.ios && result.webkit_version < 604);\n\nhandlers.copy = editHandlers.cut = function (view, e) {\n  var sel = view.state.selection, cut = e.type == \"cut\";\n  if (sel.empty) { return }\n\n  // IE and Edge's clipboard interface is completely broken\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  var slice = sel.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  if (data) {\n    e.preventDefault();\n    data.clearData();\n    data.setData(\"text/html\", dom.innerHTML);\n    data.setData(\"text/plain\", text);\n  } else {\n    captureCopy(view, dom);\n  }\n  if (cut) { view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta(\"uiEvent\", \"cut\")); }\n};\n\nfunction sliceSingleNode(slice) {\n  return slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1 ? slice.content.firstChild : null\n}\n\nfunction capturePaste(view, e) {\n  if (!view.dom.parentNode) { return }\n  var plainText = view.shiftKey || view.state.selection.$from.parent.type.spec.code;\n  var target = view.dom.parentNode.appendChild(document.createElement(plainText ? \"textarea\" : \"div\"));\n  if (!plainText) { target.contentEditable = \"true\"; }\n  target.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  target.focus();\n  setTimeout(function () {\n    view.focus();\n    if (target.parentNode) { target.parentNode.removeChild(target); }\n    if (plainText) { doPaste(view, target.value, null, e); }\n    else { doPaste(view, target.textContent, target.innerHTML, e); }\n  }, 50);\n}\n\nfunction doPaste(view, text, html, e) {\n  var slice = parseFromClipboard(view, text, html, view.shiftKey, view.state.selection.$from);\n  if (view.someProp(\"handlePaste\", function (f) { return f(view, e, slice || Slice.empty); })) { return true }\n  if (!slice) { return false }\n\n  var singleNode = sliceSingleNode(slice);\n  var tr = singleNode ? view.state.tr.replaceSelectionWith(singleNode, view.shiftKey) : view.state.tr.replaceSelection(slice);\n  view.dispatch(tr.scrollIntoView().setMeta(\"paste\", true).setMeta(\"uiEvent\", \"paste\"));\n  return true\n}\n\neditHandlers.paste = function (view, e) {\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  if (data && doPaste(view, data.getData(\"text/plain\"), data.getData(\"text/html\"), e)) { e.preventDefault(); }\n  else { capturePaste(view, e); }\n};\n\nvar Dragging = function Dragging(slice, move) {\n  this.slice = slice;\n  this.move = move;\n};\n\nvar dragCopyModifier = result.mac ? \"altKey\" : \"ctrlKey\";\n\nhandlers.dragstart = function (view, e) {\n  var mouseDown = view.mouseDown;\n  if (mouseDown) { mouseDown.done(); }\n  if (!e.dataTransfer) { return }\n\n  var sel = view.state.selection;\n  var pos = sel.empty ? null : view.posAtCoords(eventCoords(e));\n  if (pos && pos.pos >= sel.from && pos.pos <= (sel instanceof NodeSelection ? sel.to - 1: sel.to)) ; else if (mouseDown && mouseDown.mightDrag) {\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, mouseDown.mightDrag.pos)));\n  } else if (e.target && e.target.nodeType == 1) {\n    var desc = view.docView.nearestDesc(e.target, true);\n    if (!desc || !desc.node.type.spec.draggable || desc == view.docView) { return }\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, desc.posBefore)));\n  }\n  var slice = view.state.selection.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  e.dataTransfer.clearData();\n  e.dataTransfer.setData(brokenClipboardAPI ? \"Text\" : \"text/html\", dom.innerHTML);\n  if (!brokenClipboardAPI) { e.dataTransfer.setData(\"text/plain\", text); }\n  view.dragging = new Dragging(slice, !e[dragCopyModifier]);\n};\n\nhandlers.dragend = function (view) {\n  var dragging = view.dragging;\n  window.setTimeout(function () {\n    if (view.dragging == dragging)  { view.dragging = null; }\n  }, 50);\n};\n\neditHandlers.dragover = editHandlers.dragenter = function (_, e) { return e.preventDefault(); };\n\neditHandlers.drop = function (view, e) {\n  var dragging = view.dragging;\n  view.dragging = null;\n\n  if (!e.dataTransfer) { return }\n\n  var eventPos = view.posAtCoords(eventCoords(e));\n  if (!eventPos) { return }\n  var $mouse = view.state.doc.resolve(eventPos.pos);\n  if (!$mouse) { return }\n  var slice = dragging && dragging.slice ||\n      parseFromClipboard(view, e.dataTransfer.getData(brokenClipboardAPI ? \"Text\" : \"text/plain\"),\n                         brokenClipboardAPI ? null : e.dataTransfer.getData(\"text/html\"), false, $mouse);\n  var move = dragging && !e[dragCopyModifier];\n  if (view.someProp(\"handleDrop\", function (f) { return f(view, e, slice || Slice.empty, move); })) {\n    e.preventDefault();\n    return\n  }\n  if (!slice) { return }\n\n  e.preventDefault();\n  var insertPos = slice ? dropPoint(view.state.doc, $mouse.pos, slice) : $mouse.pos;\n  if (insertPos == null) { insertPos = $mouse.pos; }\n\n  var tr = view.state.tr;\n  if (move) { tr.deleteSelection(); }\n\n  var pos = tr.mapping.map(insertPos);\n  var isNode = slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1;\n  var beforeInsert = tr.doc;\n  if (isNode)\n    { tr.replaceRangeWith(pos, pos, slice.content.firstChild); }\n  else\n    { tr.replaceRange(pos, pos, slice); }\n  if (tr.doc.eq(beforeInsert)) { return }\n\n  var $pos = tr.doc.resolve(pos);\n  if (isNode && NodeSelection.isSelectable(slice.content.firstChild) &&\n      $pos.nodeAfter && $pos.nodeAfter.sameMarkup(slice.content.firstChild)) {\n    tr.setSelection(new NodeSelection($pos));\n  } else {\n    var end = tr.mapping.map(insertPos);\n    tr.mapping.maps[tr.mapping.maps.length - 1].forEach(function (_from, _to, _newFrom, newTo) { return end = newTo; });\n    tr.setSelection(selectionBetween(view, $pos, tr.doc.resolve(end)));\n  }\n  view.focus();\n  view.dispatch(tr.setMeta(\"uiEvent\", \"drop\"));\n};\n\nhandlers.focus = function (view) {\n  if (!view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.add(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.focused = true;\n    setTimeout(function () {\n      if (view.docView && view.hasFocus() && !view.domObserver.currentSelection.eq(view.root.getSelection()))\n        { selectionToDOM(view); }\n    }, 20);\n  }\n};\n\nhandlers.blur = function (view) {\n  if (view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.remove(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.domObserver.currentSelection.set({});\n    view.focused = false;\n  }\n};\n\nhandlers.beforeinput = function (view, event) {\n  // We should probably do more with beforeinput events, but support\n  // is so spotty that I'm still waiting to see where they are going.\n\n  // Very specific hack to deal with backspace sometimes failing on\n  // Chrome Android when after an uneditable node.\n  if (result.chrome && result.android && event.inputType == \"deleteContentBackward\") {\n    var domChangeCount = view.domChangeCount;\n    setTimeout(function () {\n      if (view.domChangeCount != domChangeCount) { return } // Event already had some effect\n      // This bug tends to close the virtual keyboard, so we refocus\n      view.dom.blur();\n      view.focus();\n      if (view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) { return }\n      var ref = view.state.selection;\n      var $cursor = ref.$cursor;\n      // Crude approximation of backspace behavior when no command handled it\n      if ($cursor && $cursor.pos > 0) { view.dispatch(view.state.tr.delete($cursor.pos - 1, $cursor.pos).scrollIntoView()); }\n    }, 50);\n  }\n};\n\n// Make sure all handlers get registered\nfor (var prop in editHandlers) { handlers[prop] = editHandlers[prop]; }\n\nfunction compareObjs(a, b) {\n  if (a == b) { return true }\n  for (var p in a) { if (a[p] !== b[p]) { return false } }\n  for (var p$1 in b) { if (!(p$1 in a)) { return false } }\n  return true\n}\n\nvar WidgetType = function WidgetType(toDOM, spec) {\n  this.spec = spec || noSpec;\n  this.side = this.spec.side || 0;\n  this.toDOM = toDOM;\n};\n\nWidgetType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var ref = mapping.mapResult(span.from + oldOffset, this.side < 0 ? -1 : 1);\n    var pos = ref.pos;\n    var deleted = ref.deleted;\n  return deleted ? null : new Decoration(pos - offset, pos - offset, this)\n};\n\nWidgetType.prototype.valid = function valid () { return true };\n\nWidgetType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof WidgetType &&\n     (this.spec.key && this.spec.key == other.spec.key ||\n      this.toDOM == other.toDOM && compareObjs(this.spec, other.spec)))\n};\n\nvar InlineType = function InlineType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nInlineType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.map(span.from + oldOffset, this.spec.inclusiveStart ? -1 : 1) - offset;\n  var to = mapping.map(span.to + oldOffset, this.spec.inclusiveEnd ? 1 : -1) - offset;\n  return from >= to ? null : new Decoration(from, to, this)\n};\n\nInlineType.prototype.valid = function valid (_, span) { return span.from < span.to };\n\nInlineType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof InlineType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\nInlineType.is = function is (span) { return span.type instanceof InlineType };\n\nvar NodeType = function NodeType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nNodeType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.mapResult(span.from + oldOffset, 1);\n  if (from.deleted) { return null }\n  var to = mapping.mapResult(span.to + oldOffset, -1);\n  if (to.deleted || to.pos <= from.pos) { return null }\n  return new Decoration(from.pos - offset, to.pos - offset, this)\n};\n\nNodeType.prototype.valid = function valid (node, span) {\n  var ref = node.content.findIndex(span.from);\n    var index = ref.index;\n    var offset = ref.offset;\n  return offset == span.from && offset + node.child(index).nodeSize == span.to\n};\n\nNodeType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof NodeType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\n// ::- Decoration objects can be provided to the view through the\n// [`decorations` prop](#view.EditorProps.decorations). They come in\n// several variants—see the static members of this class for details.\nvar Decoration = function Decoration(from, to, type) {\n  // :: number\n  // The start position of the decoration.\n  this.from = from;\n  // :: number\n  // The end position. Will be the same as `from` for [widget\n  // decorations](#view.Decoration^widget).\n  this.to = to;\n  this.type = type;\n};\n\nvar prototypeAccessors$1 = { spec: { configurable: true },inline: { configurable: true } };\n\nDecoration.prototype.copy = function copy (from, to) {\n  return new Decoration(from, to, this.type)\n};\n\nDecoration.prototype.eq = function eq (other, offset) {\n    if ( offset === void 0 ) offset = 0;\n\n  return this.type.eq(other.type) && this.from + offset == other.from && this.to + offset == other.to\n};\n\nDecoration.prototype.map = function map (mapping, offset, oldOffset) {\n  return this.type.map(mapping, this, offset, oldOffset)\n};\n\n// :: (number, union<(view: EditorView, getPos: () → number) → dom.Node, dom.Node>, ?Object) → Decoration\n// Creates a widget decoration, which is a DOM node that's shown in\n// the document at the given position. It is recommended that you\n// delay rendering the widget by passing a function that will be\n// called when the widget is actually drawn in a view, but you can\n// also directly pass a DOM node. `getPos` can be used to find the\n// widget's current document position.\n//\n// spec::- These options are supported:\n//\n//   side:: ?number\n//   Controls which side of the document position this widget is\n//   associated with. When negative, it is drawn before a cursor\n//   at its position, and content inserted at that position ends\n//   up after the widget. When zero (the default) or positive, the\n//   widget is drawn after the cursor and content inserted there\n//   ends up before the widget.\n//\n//   When there are multiple widgets at a given position, their\n//   `side` values determine the order in which they appear. Those\n//   with lower values appear first. The ordering of widgets with\n//   the same `side` value is unspecified.\n//\n//   When `marks` is null, `side` also determines the marks that\n//   the widget is wrapped in—those of the node before when\n//   negative, those of the node after when positive.\n//\n//   marks:: ?[Mark]\n//   The precise set of marks to draw around the widget.\n//\n//   stopEvent:: ?(event: dom.Event) → bool\n//   Can be used to control which DOM events, when they bubble out\n//   of this widget, the editor view should ignore.\n//\n//   ignoreSelection:: ?bool\n//   When set (defaults to false), selection changes inside the\n//   widget are ignored, and don't cause ProseMirror to try and\n//   re-sync the selection with its selection state.\n//\n//   key:: ?string\n//   When comparing decorations of this type (in order to decide\n//   whether it needs to be redrawn), ProseMirror will by default\n//   compare the widget DOM node by identity. If you pass a key,\n//   that key will be compared instead, which can be useful when\n//   you generate decorations on the fly and don't want to store\n//   and reuse DOM nodes. Make sure that any widgets with the same\n//   key are interchangeable—if widgets differ in, for example,\n//   the behavior of some event handler, they should get\n//   different keys.\nDecoration.widget = function widget (pos, toDOM, spec) {\n  return new Decoration(pos, pos, new WidgetType(toDOM, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object) → Decoration\n// Creates an inline decoration, which adds the given attributes to\n// each inline node between `from` and `to`.\n//\n// spec::- These options are recognized:\n//\n//   inclusiveStart:: ?bool\n//   Determines how the left side of the decoration is\n//   [mapped](#transform.Position_Mapping) when content is\n//   inserted directly at that position. By default, the decoration\n//   won't include the new content, but you can set this to `true`\n//   to make it inclusive.\n//\n//   inclusiveEnd:: ?bool\n//   Determines how the right side of the decoration is mapped.\n//   See\n//   [`inclusiveStart`](#view.Decoration^inline^spec.inclusiveStart).\nDecoration.inline = function inline (from, to, attrs, spec) {\n  return new Decoration(from, to, new InlineType(attrs, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object) → Decoration\n// Creates a node decoration. `from` and `to` should point precisely\n// before and after a node in the document. That node, and only that\n// node, will receive the given attributes.\n//\n// spec::-\n//\n// Optional information to store with the decoration. It\n// is also used when comparing decorators for equality.\nDecoration.node = function node (from, to, attrs, spec) {\n  return new Decoration(from, to, new NodeType(attrs, spec))\n};\n\n// :: Object\n// The spec provided when creating this decoration. Can be useful\n// if you've stored extra information in that object.\nprototypeAccessors$1.spec.get = function () { return this.type.spec };\n\nprototypeAccessors$1.inline.get = function () { return this.type instanceof InlineType };\n\nObject.defineProperties( Decoration.prototype, prototypeAccessors$1 );\n\n// DecorationAttrs:: interface\n// A set of attributes to add to a decorated node. Most properties\n// simply directly correspond to DOM attributes of the same name,\n// which will be set to the property's value. These are exceptions:\n//\n//   class:: ?string\n//   A CSS class name or a space-separated set of class names to be\n//   _added_ to the classes that the node already had.\n//\n//   style:: ?string\n//   A string of CSS to be _added_ to the node's existing `style` property.\n//\n//   nodeName:: ?string\n//   When non-null, the target node is wrapped in a DOM element of\n//   this type (and the other attributes are applied to this element).\n\nvar none = [], noSpec = {};\n\n// ::- A collection of [decorations](#view.Decoration), organized in\n// such a way that the drawing algorithm can efficiently use and\n// compare them. This is a persistent data structure—it is not\n// modified, updates create a new value.\nvar DecorationSet = function DecorationSet(local, children) {\n  this.local = local && local.length ? local : none;\n  this.children = children && children.length ? children : none;\n};\n\n// :: (Node, [Decoration]) → DecorationSet\n// Create a set of decorations, using the structure of the given\n// document.\nDecorationSet.create = function create (doc, decorations) {\n  return decorations.length ? buildTree(decorations, doc, 0, noSpec) : empty\n};\n\n// :: (?number, ?number, ?(spec: Object) → bool) → [Decoration]\n// Find all decorations in this set which touch the given range\n// (including decorations that start or end directly at the\n// boundaries) and match the given predicate on their spec. When\n// `start` and `end` are omitted, all decorations in the set are\n// considered. When `predicate` isn't given, all decorations are\n// assumed to match.\nDecorationSet.prototype.find = function find (start, end, predicate) {\n  var result = [];\n  this.findInner(start == null ? 0 : start, end == null ? 1e9 : end, result, 0, predicate);\n  return result\n};\n\nDecorationSet.prototype.findInner = function findInner (start, end, result, offset, predicate) {\n  for (var i = 0; i < this.local.length; i++) {\n    var span = this.local[i];\n    if (span.from <= end && span.to >= start && (!predicate || predicate(span.spec)))\n      { result.push(span.copy(span.from + offset, span.to + offset)); }\n  }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3) {\n    if (this.children[i$1] < end && this.children[i$1 + 1] > start) {\n      var childOff = this.children[i$1] + 1;\n      this.children[i$1 + 2].findInner(start - childOff, end - childOff, result, offset + childOff, predicate);\n    }\n  }\n};\n\n// :: (Mapping, Node, ?Object) → DecorationSet\n// Map the set of decorations in response to a change in the\n// document.\n//\n// options::- An optional set of options.\n//\n//   onRemove:: ?(decorationSpec: Object)\n//   When given, this function will be called for each decoration\n//   that gets dropped as a result of the mapping, passing the\n//   spec of that decoration.\nDecorationSet.prototype.map = function map (mapping, doc, options) {\n  if (this == empty || mapping.maps.length == 0) { return this }\n  return this.mapInner(mapping, doc, 0, 0, options || noSpec)\n};\n\nDecorationSet.prototype.mapInner = function mapInner (mapping, node, offset, oldOffset, options) {\n  var newLocal;\n  for (var i = 0; i < this.local.length; i++) {\n    var mapped = this.local[i].map(mapping, offset, oldOffset);\n    if (mapped && mapped.type.valid(node, mapped)) { (newLocal || (newLocal = [])).push(mapped); }\n    else if (options.onRemove) { options.onRemove(this.local[i].spec); }\n  }\n\n  if (this.children.length)\n    { return mapChildren(this.children, newLocal, mapping, node, offset, oldOffset, options) }\n  else\n    { return newLocal ? new DecorationSet(newLocal.sort(byPos)) : empty }\n};\n\n// :: (Node, [Decoration]) → DecorationSet\n// Add the given array of decorations to the ones in the set,\n// producing a new set. Needs access to the current document to\n// create the appropriate tree structure.\nDecorationSet.prototype.add = function add (doc, decorations) {\n  if (!decorations.length) { return this }\n  if (this == empty) { return DecorationSet.create(doc, decorations) }\n  return this.addInner(doc, decorations, 0)\n};\n\nDecorationSet.prototype.addInner = function addInner (doc, decorations, offset) {\n    var this$1 = this;\n\n  var children, childIndex = 0;\n  doc.forEach(function (childNode, childOffset) {\n    var baseOffset = childOffset + offset, found;\n    if (!(found = takeSpansForNode(decorations, childNode, baseOffset))) { return }\n\n    if (!children) { children = this$1.children.slice(); }\n    while (childIndex < children.length && children[childIndex] < childOffset) { childIndex += 3; }\n    if (children[childIndex] == childOffset)\n      { children[childIndex + 2] = children[childIndex + 2].addInner(childNode, found, baseOffset + 1); }\n    else\n      { children.splice(childIndex, 0, childOffset, childOffset + childNode.nodeSize, buildTree(found, childNode, baseOffset + 1, noSpec)); }\n    childIndex += 3;\n  });\n\n  var local = moveSpans(childIndex ? withoutNulls(decorations) : decorations, -offset);\n  return new DecorationSet(local.length ? this.local.concat(local).sort(byPos) : this.local,\n                           children || this.children)\n};\n\n// :: ([Decoration]) → DecorationSet\n// Create a new set that contains the decorations in this set, minus\n// the ones in the given array.\nDecorationSet.prototype.remove = function remove (decorations) {\n  if (decorations.length == 0 || this == empty) { return this }\n  return this.removeInner(decorations, 0)\n};\n\nDecorationSet.prototype.removeInner = function removeInner (decorations, offset) {\n  var children = this.children, local = this.local;\n  for (var i = 0; i < children.length; i += 3) {\n    var found = (void 0), from = children[i] + offset, to = children[i + 1] + offset;\n    for (var j = 0, span = (void 0); j < decorations.length; j++) { if (span = decorations[j]) {\n      if (span.from > from && span.to < to) {\n        decorations[j] = null\n        ;(found || (found = [])).push(span);\n      }\n    } }\n    if (!found) { continue }\n    if (children == this.children) { children = this.children.slice(); }\n    var removed = children[i + 2].removeInner(found, from + 1);\n    if (removed != empty) {\n      children[i + 2] = removed;\n    } else {\n      children.splice(i, 3);\n      i -= 3;\n    }\n  }\n  if (local.length) { for (var i$1 = 0, span$1 = (void 0); i$1 < decorations.length; i$1++) { if (span$1 = decorations[i$1]) {\n    for (var j$1 = 0; j$1 < local.length; j$1++) { if (local[j$1].eq(span$1, offset)) {\n      if (local == this.local) { local = this.local.slice(); }\n      local.splice(j$1--, 1);\n    } }\n  } } }\n  if (children == this.children && local == this.local) { return this }\n  return local.length || children.length ? new DecorationSet(local, children) : empty\n};\n\nDecorationSet.prototype.forChild = function forChild (offset, node) {\n  if (this == empty) { return this }\n  if (node.isLeaf) { return DecorationSet.empty }\n\n  var child, local;\n  for (var i = 0; i < this.children.length; i += 3) { if (this.children[i] >= offset) {\n    if (this.children[i] == offset) { child = this.children[i + 2]; }\n    break\n  } }\n  var start = offset + 1, end = start + node.content.size;\n  for (var i$1 = 0; i$1 < this.local.length; i$1++) {\n    var dec = this.local[i$1];\n    if (dec.from < end && dec.to > start && (dec.type instanceof InlineType)) {\n      var from = Math.max(start, dec.from) - start, to = Math.min(end, dec.to) - start;\n      if (from < to) { (local || (local = [])).push(dec.copy(from, to)); }\n    }\n  }\n  if (local) {\n    var localSet = new DecorationSet(local.sort(byPos));\n    return child ? new DecorationGroup([localSet, child]) : localSet\n  }\n  return child || empty\n};\n\nDecorationSet.prototype.eq = function eq (other) {\n  if (this == other) { return true }\n  if (!(other instanceof DecorationSet) ||\n      this.local.length != other.local.length ||\n      this.children.length != other.children.length) { return false }\n  for (var i = 0; i < this.local.length; i++)\n    { if (!this.local[i].eq(other.local[i])) { return false } }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3)\n    { if (this.children[i$1] != other.children[i$1] ||\n        this.children[i$1 + 1] != other.children[i$1 + 1] ||\n        !this.children[i$1 + 2].eq(other.children[i$1 + 2])) { return false } }\n  return true\n};\n\nDecorationSet.prototype.locals = function locals (node) {\n  return removeOverlap(this.localsInner(node))\n};\n\nDecorationSet.prototype.localsInner = function localsInner (node) {\n  if (this == empty) { return none }\n  if (node.inlineContent || !this.local.some(InlineType.is)) { return this.local }\n  var result = [];\n  for (var i = 0; i < this.local.length; i++) {\n    if (!(this.local[i].type instanceof InlineType))\n      { result.push(this.local[i]); }\n  }\n  return result\n};\n\nvar empty = new DecorationSet();\n\n// :: DecorationSet\n// The empty set of decorations.\nDecorationSet.empty = empty;\n\nDecorationSet.removeOverlap = removeOverlap;\n\n// :- An abstraction that allows the code dealing with decorations to\n// treat multiple DecorationSet objects as if it were a single object\n// with (a subset of) the same interface.\nvar DecorationGroup = function DecorationGroup(members) {\n  this.members = members;\n};\n\nDecorationGroup.prototype.forChild = function forChild (offset, child) {\n  if (child.isLeaf) { return DecorationSet.empty }\n  var found = [];\n  for (var i = 0; i < this.members.length; i++) {\n    var result = this.members[i].forChild(offset, child);\n    if (result == empty) { continue }\n    if (result instanceof DecorationGroup) { found = found.concat(result.members); }\n    else { found.push(result); }\n  }\n  return DecorationGroup.from(found)\n};\n\nDecorationGroup.prototype.eq = function eq (other) {\n  if (!(other instanceof DecorationGroup) ||\n      other.members.length != this.members.length) { return false }\n  for (var i = 0; i < this.members.length; i++)\n    { if (!this.members[i].eq(other.members[i])) { return false } }\n  return true\n};\n\nDecorationGroup.prototype.locals = function locals (node) {\n  var result, sorted = true;\n  for (var i = 0; i < this.members.length; i++) {\n    var locals = this.members[i].localsInner(node);\n    if (!locals.length) { continue }\n    if (!result) {\n      result = locals;\n    } else {\n      if (sorted) {\n        result = result.slice();\n        sorted = false;\n      }\n      for (var j = 0; j < locals.length; j++) { result.push(locals[j]); }\n    }\n  }\n  return result ? removeOverlap(sorted ? result : result.sort(byPos)) : none\n};\n\n// : ([DecorationSet]) → union<DecorationSet, DecorationGroup>\n// Create a group for the given array of decoration sets, or return\n// a single set when possible.\nDecorationGroup.from = function from (members) {\n  switch (members.length) {\n    case 0: return empty\n    case 1: return members[0]\n    default: return new DecorationGroup(members)\n  }\n};\n\nfunction mapChildren(oldChildren, newLocal, mapping, node, offset, oldOffset, options) {\n  var children = oldChildren.slice();\n\n  // Mark the children that are directly touched by changes, and\n  // move those that are after the changes.\n  var shift = function (oldStart, oldEnd, newStart, newEnd) {\n    for (var i = 0; i < children.length; i += 3) {\n      var end = children[i + 1], dSize = (void 0);\n      if (end == -1 || oldStart > end + oldOffset) { continue }\n      if (oldEnd >= children[i] + oldOffset) {\n        children[i + 1] = -1;\n      } else if (newStart >= offset && (dSize = (newEnd - newStart) - (oldEnd - oldStart))) {\n        children[i] += dSize;\n        children[i + 1] += dSize;\n      }\n    }\n  };\n  for (var i = 0; i < mapping.maps.length; i++) { mapping.maps[i].forEach(shift); }\n\n  // Find the child nodes that still correspond to a single node,\n  // recursively call mapInner on them and update their positions.\n  var mustRebuild = false;\n  for (var i$1 = 0; i$1 < children.length; i$1 += 3) { if (children[i$1 + 1] == -1) { // Touched nodes\n    var from = mapping.map(oldChildren[i$1] + oldOffset), fromLocal = from - offset;\n    if (fromLocal < 0 || fromLocal >= node.content.size) {\n      mustRebuild = true;\n      continue\n    }\n    // Must read oldChildren because children was tagged with -1\n    var to = mapping.map(oldChildren[i$1 + 1] + oldOffset, -1), toLocal = to - offset;\n    var ref = node.content.findIndex(fromLocal);\n    var index = ref.index;\n    var childOffset = ref.offset;\n    var childNode = node.maybeChild(index);\n    if (childNode && childOffset == fromLocal && childOffset + childNode.nodeSize == toLocal) {\n      var mapped = children[i$1 + 2].mapInner(mapping, childNode, from + 1, oldChildren[i$1] + oldOffset + 1, options);\n      if (mapped != empty) {\n        children[i$1] = fromLocal;\n        children[i$1 + 1] = toLocal;\n        children[i$1 + 2] = mapped;\n      } else {\n        children[i$1 + 1] = -2;\n        mustRebuild = true;\n      }\n    } else {\n      mustRebuild = true;\n    }\n  } }\n\n  // Remaining children must be collected and rebuilt into the appropriate structure\n  if (mustRebuild) {\n    var decorations = mapAndGatherRemainingDecorations(children, oldChildren, newLocal || [], mapping,\n                                                       offset, oldOffset, options);\n    var built = buildTree(decorations, node, 0, options);\n    newLocal = built.local;\n    for (var i$2 = 0; i$2 < children.length; i$2 += 3) { if (children[i$2 + 1] < 0) {\n      children.splice(i$2, 3);\n      i$2 -= 3;\n    } }\n    for (var i$3 = 0, j = 0; i$3 < built.children.length; i$3 += 3) {\n      var from$1 = built.children[i$3];\n      while (j < children.length && children[j] < from$1) { j += 3; }\n      children.splice(j, 0, built.children[i$3], built.children[i$3 + 1], built.children[i$3 + 2]);\n    }\n  }\n\n  return new DecorationSet(newLocal && newLocal.sort(byPos), children)\n}\n\nfunction moveSpans(spans, offset) {\n  if (!offset || !spans.length) { return spans }\n  var result = [];\n  for (var i = 0; i < spans.length; i++) {\n    var span = spans[i];\n    result.push(new Decoration(span.from + offset, span.to + offset, span.type));\n  }\n  return result\n}\n\nfunction mapAndGatherRemainingDecorations(children, oldChildren, decorations, mapping, offset, oldOffset, options) {\n  // Gather all decorations from the remaining marked children\n  function gather(set, oldOffset) {\n    for (var i = 0; i < set.local.length; i++) {\n      var mapped = set.local[i].map(mapping, offset, oldOffset);\n      if (mapped) { decorations.push(mapped); }\n      else if (options.onRemove) { options.onRemove(set.local[i].spec); }\n    }\n    for (var i$1 = 0; i$1 < set.children.length; i$1 += 3)\n      { gather(set.children[i$1 + 2], set.children[i$1] + oldOffset + 1); }\n  }\n  for (var i = 0; i < children.length; i += 3) { if (children[i + 1] == -1)\n    { gather(children[i + 2], oldChildren[i] + oldOffset + 1); } }\n\n  return decorations\n}\n\nfunction takeSpansForNode(spans, node, offset) {\n  if (node.isLeaf) { return null }\n  var end = offset + node.nodeSize, found = null;\n  for (var i = 0, span = (void 0); i < spans.length; i++) {\n    if ((span = spans[i]) && span.from > offset && span.to < end) {\n(found || (found = [])).push(span);\n      spans[i] = null;\n    }\n  }\n  return found\n}\n\nfunction withoutNulls(array) {\n  var result = [];\n  for (var i = 0; i < array.length; i++)\n    { if (array[i] != null) { result.push(array[i]); } }\n  return result\n}\n\n// : ([Decoration], Node, number) → DecorationSet\n// Build up a tree that corresponds to a set of decorations. `offset`\n// is a base offset that should be subtractet from the `from` and `to`\n// positions in the spans (so that we don't have to allocate new spans\n// for recursive calls).\nfunction buildTree(spans, node, offset, options) {\n  var children = [], hasNulls = false;\n  node.forEach(function (childNode, localStart) {\n    var found = takeSpansForNode(spans, childNode, localStart + offset);\n    if (found) {\n      hasNulls = true;\n      var subtree = buildTree(found, childNode, offset + localStart + 1, options);\n      if (subtree != empty)\n        { children.push(localStart, localStart + childNode.nodeSize, subtree); }\n    }\n  });\n  var locals = moveSpans(hasNulls ? withoutNulls(spans) : spans, -offset).sort(byPos);\n  for (var i = 0; i < locals.length; i++) { if (!locals[i].type.valid(node, locals[i])) {\n    if (options.onRemove) { options.onRemove(locals[i].spec); }\n    locals.splice(i--, 1);\n  } }\n  return locals.length || children.length ? new DecorationSet(locals, children) : empty\n}\n\n// : (Decoration, Decoration) → number\n// Used to sort decorations so that ones with a low start position\n// come first, and within a set with the same start position, those\n// with an smaller end position come first.\nfunction byPos(a, b) {\n  return a.from - b.from || a.to - b.to\n}\n\n// : ([Decoration]) → [Decoration]\n// Scan a sorted array of decorations for partially overlapping spans,\n// and split those so that only fully overlapping spans are left (to\n// make subsequent rendering easier). Will return the input array if\n// no partially overlapping spans are found (the common case).\nfunction removeOverlap(spans) {\n  var working = spans;\n  for (var i = 0; i < working.length - 1; i++) {\n    var span = working[i];\n    if (span.from != span.to) { for (var j = i + 1; j < working.length; j++) {\n      var next = working[j];\n      if (next.from == span.from) {\n        if (next.to != span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // Followed by a partially overlapping larger span. Split that\n          // span.\n          working[j] = next.copy(next.from, span.to);\n          insertAhead(working, j + 1, next.copy(span.to, next.to));\n        }\n        continue\n      } else {\n        if (next.from < span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // The end of this one overlaps with a subsequent span. Split\n          // this one.\n          working[i] = span.copy(span.from, next.from);\n          insertAhead(working, j, span.copy(next.from, span.to));\n        }\n        break\n      }\n    } }\n  }\n  return working\n}\n\nfunction insertAhead(array, i, deco) {\n  while (i < array.length && byPos(deco, array[i]) > 0) { i++; }\n  array.splice(i, 0, deco);\n}\n\n// : (EditorView) → union<DecorationSet, DecorationGroup>\n// Get the decorations associated with the current props of a view.\nfunction viewDecorations(view) {\n  var found = [];\n  view.someProp(\"decorations\", function (f) {\n    var result = f(view.state);\n    if (result && result != empty) { found.push(result); }\n  });\n  if (view.cursorWrapper)\n    { found.push(DecorationSet.create(view.state.doc, [view.cursorWrapper.deco])); }\n  return DecorationGroup.from(found)\n}\n\n// ::- An editor view manages the DOM structure that represents an\n// editable document. Its state and behavior are determined by its\n// [props](#view.DirectEditorProps).\nvar EditorView = function EditorView(place, props) {\n  this._props = props;\n  // :: EditorState\n  // The view's current [state](#state.EditorState).\n  this.state = props.state;\n\n  this.dispatch = this.dispatch.bind(this);\n\n  this._root = null;\n  this.focused = false;\n  // Kludge used to work around a Chrome bug\n  this.trackWrites = null;\n\n  // :: dom.Element\n  // An editable DOM node containing the document. (You probably\n  // should not directly interfere with its content.)\n  this.dom = (place && place.mount) || document.createElement(\"div\");\n  if (place) {\n    if (place.appendChild) { place.appendChild(this.dom); }\n    else if (place.apply) { place(this.dom); }\n    else if (place.mount) { this.mounted = true; }\n  }\n\n  // :: bool\n  // Indicates whether the editor is currently [editable](#view.EditorProps.editable).\n  this.editable = getEditable(this);\n  this.markCursor = null;\n  this.cursorWrapper = null;\n  updateCursorWrapper(this);\n  this.nodeViews = buildNodeViews(this);\n  this.docView = docViewDesc(this.state.doc, computeDocDeco(this), viewDecorations(this), this.dom, this);\n\n  this.lastSelectedViewDesc = null;\n  // :: ?{slice: Slice, move: bool}\n  // When editor content is being dragged, this object contains\n  // information about the dragged slice and whether it is being\n  // copied or moved. At any other time, it is null.\n  this.dragging = null;\n\n  initInput(this);\n\n  this.pluginViews = [];\n  this.updatePluginViews();\n};\n\nvar prototypeAccessors$2 = { props: { configurable: true },root: { configurable: true } };\n\n// composing:: boolean\n// Holds `true` when a\n// [composition](https://developer.mozilla.org/en-US/docs/Mozilla/IME_handling_guide)\n// is active.\n\n// :: DirectEditorProps\n// The view's current [props](#view.EditorProps).\nprototypeAccessors$2.props.get = function () {\n  if (this._props.state != this.state) {\n    var prev = this._props;\n    this._props = {};\n    for (var name in prev) { this._props[name] = prev[name]; }\n    this._props.state = this.state;\n  }\n  return this._props\n};\n\n// :: (DirectEditorProps)\n// Update the view's props. Will immediately cause an update to\n// the DOM.\nEditorView.prototype.update = function update (props) {\n  if (props.handleDOMEvents != this._props.handleDOMEvents) { ensureListeners(this); }\n  this._props = props;\n  this.updateStateInner(props.state, true);\n};\n\n// :: (DirectEditorProps)\n// Update the view by updating existing props object with the object\n// given as argument. Equivalent to `view.update(Object.assign({},\n// view.props, props))`.\nEditorView.prototype.setProps = function setProps (props) {\n  var updated = {};\n  for (var name in this._props) { updated[name] = this._props[name]; }\n  updated.state = this.state;\n  for (var name$1 in props) { updated[name$1] = props[name$1]; }\n  this.update(updated);\n};\n\n// :: (EditorState)\n// Update the editor's `state` prop, without touching any of the\n// other props.\nEditorView.prototype.updateState = function updateState (state) {\n  this.updateStateInner(state, this.state.plugins != state.plugins);\n};\n\nEditorView.prototype.updateStateInner = function updateStateInner (state, reconfigured) {\n    var this$1 = this;\n\n  var prev = this.state, redraw = false, updateSel = false;\n  // When stored marks are added, stop composition, so that they can\n  // be displayed.\n  if (state.storedMarks && this.composing) {\n    clearComposition(this);\n    updateSel = true;\n  }\n  this.state = state;\n  if (reconfigured) {\n    var nodeViews = buildNodeViews(this);\n    if (changedNodeViews(nodeViews, this.nodeViews)) {\n      this.nodeViews = nodeViews;\n      redraw = true;\n    }\n    ensureListeners(this);\n  }\n\n  this.editable = getEditable(this);\n  updateCursorWrapper(this);\n  var innerDeco = viewDecorations(this), outerDeco = computeDocDeco(this);\n\n  var scroll = reconfigured ? \"reset\"\n      : state.scrollToSelection > prev.scrollToSelection ? \"to selection\" : \"preserve\";\n  var updateDoc = redraw || !this.docView.matchesNode(state.doc, outerDeco, innerDeco);\n  if (updateDoc || !state.selection.eq(prev.selection)) { updateSel = true; }\n  var oldScrollPos = scroll == \"preserve\" && updateSel && this.dom.style.overflowAnchor == null && storeScrollPos(this);\n\n  if (updateSel) {\n    this.domObserver.stop();\n    // Work around an issue in Chrome, IE, and Edge where changing\n    // the DOM around an active selection puts it into a broken\n    // state where the thing the user sees differs from the\n    // selection reported by the Selection object (#710, #973,\n    // #1011, #1013, #1035).\n    var forceSelUpdate = updateDoc && (result.ie || result.chrome) && !this.composing &&\n        !prev.selection.empty && !state.selection.empty && selectionContextChanged(prev.selection, state.selection);\n    if (updateDoc) {\n      // If the node that the selection points into is written to,\n      // Chrome sometimes starts misreporting the selection, so this\n      // tracks that and forces a selection reset when our update\n      // did write to the node.\n      var chromeKludge = result.chrome ? (this.trackWrites = this.root.getSelection().focusNode) : null;\n      if (redraw || !this.docView.update(state.doc, outerDeco, innerDeco, this)) {\n        this.docView.updateOuterDeco([]);\n        this.docView.destroy();\n        this.docView = docViewDesc(state.doc, outerDeco, innerDeco, this.dom, this);\n      }\n      if (chromeKludge && !this.trackWrites) { forceSelUpdate = true; }\n    }\n    // Work around for an issue where an update arriving right between\n    // a DOM selection change and the \"selectionchange\" event for it\n    // can cause a spurious DOM selection update, disrupting mouse\n    // drag selection.\n    if (forceSelUpdate ||\n        !(this.mouseDown && this.domObserver.currentSelection.eq(this.root.getSelection()) && anchorInRightPlace(this))) {\n      selectionToDOM(this, forceSelUpdate);\n    } else {\n      syncNodeSelection(this, state.selection);\n      this.domObserver.setCurSelection();\n    }\n    this.domObserver.start();\n  }\n\n  this.updatePluginViews(prev);\n\n  if (scroll == \"reset\") {\n    this.dom.scrollTop = 0;\n  } else if (scroll == \"to selection\") {\n    var startDOM = this.root.getSelection().focusNode;\n    if (this.someProp(\"handleScrollToSelection\", function (f) { return f(this$1); }))\n      ; // Handled\n    else if (state.selection instanceof NodeSelection)\n      { scrollRectIntoView(this, this.docView.domAfterPos(state.selection.from).getBoundingClientRect(), startDOM); }\n    else\n      { scrollRectIntoView(this, this.coordsAtPos(state.selection.head, 1), startDOM); }\n  } else if (oldScrollPos) {\n    resetScrollPos(oldScrollPos);\n  }\n};\n\nEditorView.prototype.destroyPluginViews = function destroyPluginViews () {\n  var view;\n  while (view = this.pluginViews.pop()) { if (view.destroy) { view.destroy(); } }\n};\n\nEditorView.prototype.updatePluginViews = function updatePluginViews (prevState) {\n  if (!prevState || prevState.plugins != this.state.plugins) {\n    this.destroyPluginViews();\n    for (var i = 0; i < this.state.plugins.length; i++) {\n      var plugin = this.state.plugins[i];\n      if (plugin.spec.view) { this.pluginViews.push(plugin.spec.view(this)); }\n    }\n  } else {\n    for (var i$1 = 0; i$1 < this.pluginViews.length; i$1++) {\n      var pluginView = this.pluginViews[i$1];\n      if (pluginView.update) { pluginView.update(this, prevState); }\n    }\n  }\n};\n\n// :: (string, ?(prop: *) → *) → *\n// Goes over the values of a prop, first those provided directly,\n// then those from plugins (in order), and calls `f` every time a\n// non-undefined value is found. When `f` returns a truthy value,\n// that is immediately returned. When `f` isn't provided, it is\n// treated as the identity function (the prop value is returned\n// directly).\nEditorView.prototype.someProp = function someProp (propName, f) {\n  var prop = this._props && this._props[propName], value;\n  if (prop != null && (value = f ? f(prop) : prop)) { return value }\n  var plugins = this.state.plugins;\n  if (plugins) { for (var i = 0; i < plugins.length; i++) {\n    var prop$1 = plugins[i].props[propName];\n    if (prop$1 != null && (value = f ? f(prop$1) : prop$1)) { return value }\n  } }\n};\n\n// :: () → bool\n// Query whether the view has focus.\nEditorView.prototype.hasFocus = function hasFocus () {\n  return this.root.activeElement == this.dom\n};\n\n// :: ()\n// Focus the editor.\nEditorView.prototype.focus = function focus () {\n  this.domObserver.stop();\n  if (this.editable) { focusPreventScroll(this.dom); }\n  selectionToDOM(this);\n  this.domObserver.start();\n};\n\n// :: union<dom.Document, dom.DocumentFragment>\n// Get the document root in which the editor exists. This will\n// usually be the top-level `document`, but might be a [shadow\n// DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM)\n// root if the editor is inside one.\nprototypeAccessors$2.root.get = function () {\n  var cached = this._root;\n  if (cached == null) { for (var search = this.dom.parentNode; search; search = search.parentNode) {\n    if (search.nodeType == 9 || (search.nodeType == 11 && search.host)) {\n      if (!search.getSelection) { Object.getPrototypeOf(search).getSelection = function () { return document.getSelection(); }; }\n      return this._root = search\n    }\n  } }\n  return cached || document\n};\n\n// :: ({left: number, top: number}) → ?{pos: number, inside: number}\n// Given a pair of viewport coordinates, return the document\n// position that corresponds to them. May return null if the given\n// coordinates aren't inside of the editor. When an object is\n// returned, its `pos` property is the position nearest to the\n// coordinates, and its `inside` property holds the position of the\n// inner node that the position falls inside of, or -1 if it is at\n// the top level, not in any node.\nEditorView.prototype.posAtCoords = function posAtCoords$1 (coords) {\n  return posAtCoords(this, coords)\n};\n\n// :: (number, number) → {left: number, right: number, top: number, bottom: number}\n// Returns the viewport rectangle at a given document position.\n// `left` and `right` will be the same number, as this returns a\n// flat cursor-ish rectangle. If the position is between two things\n// that aren't directly adjacent, `side` determines which element is\n// used. When < 0, the element before the position is used,\n// otherwise the element after.\nEditorView.prototype.coordsAtPos = function coordsAtPos$1 (pos, side) {\n    if ( side === void 0 ) side = 1;\n\n  return coordsAtPos(this, pos, side)\n};\n\n// :: (number, number) → {node: dom.Node, offset: number}\n// Find the DOM position that corresponds to the given document\n// position. When `side` is negative, find the position as close as\n// possible to the content before the position. When positive,\n// prefer positions close to the content after the position. When\n// zero, prefer as shallow a position as possible.\n//\n// Note that you should **not** mutate the editor's internal DOM,\n// only inspect it (and even that is usually not necessary).\nEditorView.prototype.domAtPos = function domAtPos (pos, side) {\n    if ( side === void 0 ) side = 0;\n\n  return this.docView.domFromPos(pos, side)\n};\n\n// :: (number) → ?dom.Node\n// Find the DOM node that represents the document node after the\n// given position. May return `null` when the position doesn't point\n// in front of a node or if the node is inside an opaque node view.\n//\n// This is intended to be able to call things like\n// `getBoundingClientRect` on that DOM node. Do **not** mutate the\n// editor DOM directly, or add styling this way, since that will be\n// immediately overriden by the editor as it redraws the node.\nEditorView.prototype.nodeDOM = function nodeDOM (pos) {\n  var desc = this.docView.descAt(pos);\n  return desc ? desc.nodeDOM : null\n};\n\n// :: (dom.Node, number, ?number) → number\n// Find the document position that corresponds to a given DOM\n// position. (Whenever possible, it is preferable to inspect the\n// document structure directly, rather than poking around in the\n// DOM, but sometimes—for example when interpreting an event\n// target—you don't have a choice.)\n//\n// The `bias` parameter can be used to influence which side of a DOM\n// node to use when the position is inside a leaf node.\nEditorView.prototype.posAtDOM = function posAtDOM (node, offset, bias) {\n    if ( bias === void 0 ) bias = -1;\n\n  var pos = this.docView.posFromDOM(node, offset, bias);\n  if (pos == null) { throw new RangeError(\"DOM position not inside the editor\") }\n  return pos\n};\n\n// :: (union<\"up\", \"down\", \"left\", \"right\", \"forward\", \"backward\">, ?EditorState) → bool\n// Find out whether the selection is at the end of a textblock when\n// moving in a given direction. When, for example, given `\"left\"`,\n// it will return true if moving left from the current cursor\n// position would leave that position's parent textblock. Will apply\n// to the view's current state by default, but it is possible to\n// pass a different state.\nEditorView.prototype.endOfTextblock = function endOfTextblock$1 (dir, state) {\n  return endOfTextblock(this, state || this.state, dir)\n};\n\n// :: ()\n// Removes the editor from the DOM and destroys all [node\n// views](#view.NodeView).\nEditorView.prototype.destroy = function destroy () {\n  if (!this.docView) { return }\n  destroyInput(this);\n  this.destroyPluginViews();\n  if (this.mounted) {\n    this.docView.update(this.state.doc, [], viewDecorations(this), this);\n    this.dom.textContent = \"\";\n  } else if (this.dom.parentNode) {\n    this.dom.parentNode.removeChild(this.dom);\n  }\n  this.docView.destroy();\n  this.docView = null;\n};\n\n// Used for testing.\nEditorView.prototype.dispatchEvent = function dispatchEvent$1 (event) {\n  return dispatchEvent(this, event)\n};\n\n// :: (Transaction)\n// Dispatch a transaction. Will call\n// [`dispatchTransaction`](#view.DirectEditorProps.dispatchTransaction)\n// when given, and otherwise defaults to applying the transaction to\n// the current state and calling\n// [`updateState`](#view.EditorView.updateState) with the result.\n// This method is bound to the view instance, so that it can be\n// easily passed around.\nEditorView.prototype.dispatch = function dispatch (tr) {\n  var dispatchTransaction = this._props.dispatchTransaction;\n  if (dispatchTransaction) { dispatchTransaction.call(this, tr); }\n  else { this.updateState(this.state.apply(tr)); }\n};\n\nObject.defineProperties( EditorView.prototype, prototypeAccessors$2 );\n\nfunction computeDocDeco(view) {\n  var attrs = Object.create(null);\n  attrs.class = \"ProseMirror\";\n  attrs.contenteditable = String(view.editable);\n\n  view.someProp(\"attributes\", function (value) {\n    if (typeof value == \"function\") { value = value(view.state); }\n    if (value) { for (var attr in value) {\n      if (attr == \"class\")\n        { attrs.class += \" \" + value[attr]; }\n      else if (!attrs[attr] && attr != \"contenteditable\" && attr != \"nodeName\")\n        { attrs[attr] = String(value[attr]); }\n    } }\n  });\n\n  return [Decoration.node(0, view.state.doc.content.size, attrs)]\n}\n\nfunction updateCursorWrapper(view) {\n  if (view.markCursor) {\n    var dom = document.createElement(\"img\");\n    dom.setAttribute(\"mark-placeholder\", \"true\");\n    view.cursorWrapper = {dom: dom, deco: Decoration.widget(view.state.selection.head, dom, {raw: true, marks: view.markCursor})};\n  } else {\n    view.cursorWrapper = null;\n  }\n}\n\nfunction getEditable(view) {\n  return !view.someProp(\"editable\", function (value) { return value(view.state) === false; })\n}\n\nfunction selectionContextChanged(sel1, sel2) {\n  var depth = Math.min(sel1.$anchor.sharedDepth(sel1.head), sel2.$anchor.sharedDepth(sel2.head));\n  return sel1.$anchor.start(depth) != sel2.$anchor.start(depth)\n}\n\nfunction buildNodeViews(view) {\n  var result = {};\n  view.someProp(\"nodeViews\", function (obj) {\n    for (var prop in obj) { if (!Object.prototype.hasOwnProperty.call(result, prop))\n      { result[prop] = obj[prop]; } }\n  });\n  return result\n}\n\nfunction changedNodeViews(a, b) {\n  var nA = 0, nB = 0;\n  for (var prop in a) {\n    if (a[prop] != b[prop]) { return true }\n    nA++;\n  }\n  for (var _ in b) { nB++; }\n  return nA != nB\n}\n\n// EditorProps:: interface\n//\n// Props are configuration values that can be passed to an editor view\n// or included in a plugin. This interface lists the supported props.\n//\n// The various event-handling functions may all return `true` to\n// indicate that they handled the given event. The view will then take\n// care to call `preventDefault` on the event, except with\n// `handleDOMEvents`, where the handler itself is responsible for that.\n//\n// How a prop is resolved depends on the prop. Handler functions are\n// called one at a time, starting with the base props and then\n// searching through the plugins (in order of appearance) until one of\n// them returns true. For some props, the first plugin that yields a\n// value gets precedence.\n//\n//   handleDOMEvents:: ?Object<(view: EditorView, event: dom.Event) → bool>\n//   Can be an object mapping DOM event type names to functions that\n//   handle them. Such functions will be called before any handling\n//   ProseMirror does of events fired on the editable DOM element.\n//   Contrary to the other event handling props, when returning true\n//   from such a function, you are responsible for calling\n//   `preventDefault` yourself (or not, if you want to allow the\n//   default behavior).\n//\n//   handleKeyDown:: ?(view: EditorView, event: dom.KeyboardEvent) → bool\n//   Called when the editor receives a `keydown` event.\n//\n//   handleKeyPress:: ?(view: EditorView, event: dom.KeyboardEvent) → bool\n//   Handler for `keypress` events.\n//\n//   handleTextInput:: ?(view: EditorView, from: number, to: number, text: string) → bool\n//   Whenever the user directly input text, this handler is called\n//   before the input is applied. If it returns `true`, the default\n//   behavior of actually inserting the text is suppressed.\n//\n//   handleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a click, from the inside out. The\n//   `direct` flag will be true for the inner node.\n//\n//   handleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is clicked, after `handleClickOn` handlers\n//   have been called.\n//\n//   handleDoubleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a double click.\n//\n//   handleDoubleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is double-clicked, after `handleDoubleClickOn`.\n//\n//   handleTripleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a triple click.\n//\n//   handleTripleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is triple-clicked, after `handleTripleClickOn`.\n//\n//   handlePaste:: ?(view: EditorView, event: dom.ClipboardEvent, slice: Slice) → bool\n//   Can be used to override the behavior of pasting. `slice` is the\n//   pasted content parsed by the editor, but you can directly access\n//   the event to get at the raw content.\n//\n//   handleDrop:: ?(view: EditorView, event: dom.Event, slice: Slice, moved: bool) → bool\n//   Called when something is dropped on the editor. `moved` will be\n//   true if this drop moves from the current selection (which should\n//   thus be deleted).\n//\n//   handleScrollToSelection:: ?(view: EditorView) → bool\n//   Called when the view, after updating its state, tries to scroll\n//   the selection into view. A handler function may return false to\n//   indicate that it did not handle the scrolling and further\n//   handlers or the default behavior should be tried.\n//\n//   createSelectionBetween:: ?(view: EditorView, anchor: ResolvedPos, head: ResolvedPos) → ?Selection\n//   Can be used to override the way a selection is created when\n//   reading a DOM selection between the given anchor and head.\n//\n//   domParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading editor changes\n//   from the DOM. Defaults to calling\n//   [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) on the\n//   editor's schema.\n//\n//   transformPastedHTML:: ?(html: string) → string\n//   Can be used to transform pasted HTML text, _before_ it is parsed,\n//   for example to clean it up.\n//\n//   clipboardParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading content from\n//   the clipboard. When not given, the value of the\n//   [`domParser`](#view.EditorProps.domParser) prop is used.\n//\n//   transformPastedText:: ?(text: string, plain: bool) → string\n//   Transform pasted plain text. The `plain` flag will be true when\n//   the text is pasted as plain text.\n//\n//   clipboardTextParser:: ?(text: string, $context: ResolvedPos, plain: bool) → Slice\n//   A function to parse text from the clipboard into a document\n//   slice. Called after\n//   [`transformPastedText`](#view.EditorProps.transformPastedText).\n//   The default behavior is to split the text into lines, wrap them\n//   in `<p>` tags, and call\n//   [`clipboardParser`](#view.EditorProps.clipboardParser) on it.\n//   The `plain` flag will be true when the text is pasted as plain text.\n//\n//   transformPasted:: ?(Slice) → Slice\n//   Can be used to transform pasted content before it is applied to\n//   the document.\n//\n//   nodeViews:: ?Object<(node: Node, view: EditorView, getPos: () → number, decorations: [Decoration]) → NodeView>\n//   Allows you to pass custom rendering and behavior logic for nodes\n//   and marks. Should map node and mark names to constructor\n//   functions that produce a [`NodeView`](#view.NodeView) object\n//   implementing the node's display behavior. For nodes, the third\n//   argument `getPos` is a function that can be called to get the\n//   node's current position, which can be useful when creating\n//   transactions to update it. For marks, the third argument is a\n//   boolean that indicates whether the mark's content is inline.\n//\n//   `decorations` is an array of node or inline decorations that are\n//   active around the node. They are automatically drawn in the\n//   normal way, and you will usually just want to ignore this, but\n//   they can also be used as a way to provide context information to\n//   the node view without adding it to the document itself.\n//\n//   clipboardSerializer:: ?DOMSerializer\n//   The DOM serializer to use when putting content onto the\n//   clipboard. If not given, the result of\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)\n//   will be used.\n//\n//   clipboardTextSerializer:: ?(Slice) → string\n//   A function that will be called to get the text for the current\n//   selection when copying text to the clipboard. By default, the\n//   editor will use [`textBetween`](#model.Node.textBetween) on the\n//   selected range.\n//\n//   decorations:: ?(state: EditorState) → ?DecorationSet\n//   A set of [document decorations](#view.Decoration) to show in the\n//   view.\n//\n//   editable:: ?(state: EditorState) → bool\n//   When this returns false, the content of the view is not directly\n//   editable.\n//\n//   attributes:: ?union<Object<string>, (EditorState) → ?Object<string>>\n//   Control the DOM attributes of the editable element. May be either\n//   an object or a function going from an editor state to an object.\n//   By default, the element will get a class `\"ProseMirror\"`, and\n//   will have its `contentEditable` attribute determined by the\n//   [`editable` prop](#view.EditorProps.editable). Additional classes\n//   provided here will be added to the class. For other attributes,\n//   the value provided first (as in\n//   [`someProp`](#view.EditorView.someProp)) will be used.\n//\n//   scrollThreshold:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the distance (in pixels) between the cursor and the\n//   end of the visible viewport at which point, when scrolling the\n//   cursor into view, scrolling takes place. Defaults to 0.\n//\n//   scrollMargin:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the extra space (in pixels) that is left above or\n//   below the cursor when it is scrolled into view. Defaults to 5.\n\n// DirectEditorProps:: interface extends EditorProps\n//\n// The props object given directly to the editor view supports two\n// fields that can't be used in plugins:\n//\n//   state:: EditorState\n//   The current state of the editor.\n//\n//   dispatchTransaction:: ?(tr: Transaction)\n//   The callback over which to send transactions (state updates)\n//   produced by the view. If you specify this, you probably want to\n//   make sure this ends up calling the view's\n//   [`updateState`](#view.EditorView.updateState) method with a new\n//   state that has the transaction\n//   [applied](#state.EditorState.apply). The callback will be bound to have\n//   the view instance as its `this` binding.\n\nexport { Decoration, DecorationSet, EditorView, endComposition as __endComposition, parseFromClipboard as __parseFromClipboard, serializeForClipboard as __serializeForClipboard };\n//# sourceMappingURL=index.es.js.map\n","import { keydownHandler } from 'prosemirror-keymap';\nimport { NodeSelection, Selection, Plugin, TextSelection } from 'prosemirror-state';\nimport { DecorationSet, Decoration } from 'prosemirror-view';\nimport { Slice } from 'prosemirror-model';\n\n// ::- Gap cursor selections are represented using this class. Its\n// `$anchor` and `$head` properties both point at the cursor position.\nvar GapCursor = /*@__PURE__*/(function (Selection) {\n  function GapCursor($pos) {\n    Selection.call(this, $pos, $pos);\n  }\n\n  if ( Selection ) GapCursor.__proto__ = Selection;\n  GapCursor.prototype = Object.create( Selection && Selection.prototype );\n  GapCursor.prototype.constructor = GapCursor;\n\n  GapCursor.prototype.map = function map (doc, mapping) {\n    var $pos = doc.resolve(mapping.map(this.head));\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  };\n\n  GapCursor.prototype.content = function content () { return Slice.empty };\n\n  GapCursor.prototype.eq = function eq (other) {\n    return other instanceof GapCursor && other.head == this.head\n  };\n\n  GapCursor.prototype.toJSON = function toJSON () {\n    return {type: \"gapcursor\", pos: this.head}\n  };\n\n  GapCursor.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.pos != \"number\") { throw new RangeError(\"Invalid input for GapCursor.fromJSON\") }\n    return new GapCursor(doc.resolve(json.pos))\n  };\n\n  GapCursor.prototype.getBookmark = function getBookmark () { return new GapBookmark(this.anchor) };\n\n  GapCursor.valid = function valid ($pos) {\n    var parent = $pos.parent;\n    if (parent.isTextblock || !closedBefore($pos) || !closedAfter($pos)) { return false }\n    var override = parent.type.spec.allowGapCursor;\n    if (override != null) { return override }\n    var deflt = parent.contentMatchAt($pos.index()).defaultType;\n    return deflt && deflt.isTextblock\n  };\n\n  GapCursor.findFrom = function findFrom ($pos, dir, mustMove) {\n    search: for (;;) {\n      if (!mustMove && GapCursor.valid($pos)) { return $pos }\n      var pos = $pos.pos, next = null;\n      // Scan up from this position\n      for (var d = $pos.depth;; d--) {\n        var parent = $pos.node(d);\n        if (dir > 0 ? $pos.indexAfter(d) < parent.childCount : $pos.index(d) > 0) {\n          next = parent.child(dir > 0 ? $pos.indexAfter(d) : $pos.index(d) - 1);\n          break\n        } else if (d == 0) {\n          return null\n        }\n        pos += dir;\n        var $cur = $pos.doc.resolve(pos);\n        if (GapCursor.valid($cur)) { return $cur }\n      }\n\n      // And then down into the next node\n      for (;;) {\n        var inside = dir > 0 ? next.firstChild : next.lastChild;\n        if (!inside) {\n          if (next.isAtom && !next.isText && !NodeSelection.isSelectable(next)) {\n            $pos = $pos.doc.resolve(pos + next.nodeSize * dir);\n            mustMove = false;\n            continue search\n          }\n          break\n        }\n        next = inside;\n        pos += dir;\n        var $cur$1 = $pos.doc.resolve(pos);\n        if (GapCursor.valid($cur$1)) { return $cur$1 }\n      }\n\n      return null\n    }\n  };\n\n  return GapCursor;\n}(Selection));\n\nGapCursor.prototype.visible = false;\n\nSelection.jsonID(\"gapcursor\", GapCursor);\n\nvar GapBookmark = function GapBookmark(pos) {\n  this.pos = pos;\n};\nGapBookmark.prototype.map = function map (mapping) {\n  return new GapBookmark(mapping.map(this.pos))\n};\nGapBookmark.prototype.resolve = function resolve (doc) {\n  var $pos = doc.resolve(this.pos);\n  return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n};\n\nfunction closedBefore($pos) {\n  for (var d = $pos.depth; d >= 0; d--) {\n    var index = $pos.index(d);\n    // At the start of this parent, look at next one\n    if (index == 0) { continue }\n    // See if the node before (or its first ancestor) is closed\n    for (var before = $pos.node(d).child(index - 1);; before = before.lastChild) {\n      if ((before.childCount == 0 && !before.inlineContent) || before.isAtom || before.type.spec.isolating) { return true }\n      if (before.inlineContent) { return false }\n    }\n  }\n  // Hit start of document\n  return true\n}\n\nfunction closedAfter($pos) {\n  for (var d = $pos.depth; d >= 0; d--) {\n    var index = $pos.indexAfter(d), parent = $pos.node(d);\n    if (index == parent.childCount) { continue }\n    for (var after = parent.child(index);; after = after.firstChild) {\n      if ((after.childCount == 0 && !after.inlineContent) || after.isAtom || after.type.spec.isolating) { return true }\n      if (after.inlineContent) { return false }\n    }\n  }\n  return true\n}\n\n// :: () → Plugin\n// Create a gap cursor plugin. When enabled, this will capture clicks\n// near and arrow-key-motion past places that don't have a normally\n// selectable position nearby, and create a gap cursor selection for\n// them. The cursor is drawn as an element with class\n// `ProseMirror-gapcursor`. You can either include\n// `style/gapcursor.css` from the package's directory or add your own\n// styles to make it visible.\nvar gapCursor = function() {\n  return new Plugin({\n    props: {\n      decorations: drawGapCursor,\n\n      createSelectionBetween: function createSelectionBetween(_view, $anchor, $head) {\n        if ($anchor.pos == $head.pos && GapCursor.valid($head)) { return new GapCursor($head) }\n      },\n\n      handleClick: handleClick,\n      handleKeyDown: handleKeyDown\n    }\n  })\n};\n\nvar handleKeyDown = keydownHandler({\n  \"ArrowLeft\": arrow(\"horiz\", -1),\n  \"ArrowRight\": arrow(\"horiz\", 1),\n  \"ArrowUp\": arrow(\"vert\", -1),\n  \"ArrowDown\": arrow(\"vert\", 1)\n});\n\nfunction arrow(axis, dir) {\n  var dirStr = axis == \"vert\" ? (dir > 0 ? \"down\" : \"up\") : (dir > 0 ? \"right\" : \"left\");\n  return function(state, dispatch, view) {\n    var sel = state.selection;\n    var $start = dir > 0 ? sel.$to : sel.$from, mustMove = sel.empty;\n    if (sel instanceof TextSelection) {\n      if (!view.endOfTextblock(dirStr) || $start.depth == 0) { return false }\n      mustMove = false;\n      $start = state.doc.resolve(dir > 0 ? $start.after() : $start.before());\n    }\n    var $found = GapCursor.findFrom($start, dir, mustMove);\n    if (!$found) { return false }\n    if (dispatch) { dispatch(state.tr.setSelection(new GapCursor($found))); }\n    return true\n  }\n}\n\nfunction handleClick(view, pos, event) {\n  if (!view.editable) { return false }\n  var $pos = view.state.doc.resolve(pos);\n  if (!GapCursor.valid($pos)) { return false }\n  var ref = view.posAtCoords({left: event.clientX, top: event.clientY});\n  var inside = ref.inside;\n  if (inside > -1 && NodeSelection.isSelectable(view.state.doc.nodeAt(inside))) { return false }\n  view.dispatch(view.state.tr.setSelection(new GapCursor($pos)));\n  return true\n}\n\nfunction drawGapCursor(state) {\n  if (!(state.selection instanceof GapCursor)) { return null }\n  var node = document.createElement(\"div\");\n  node.className = \"ProseMirror-gapcursor\";\n  return DecorationSet.create(state.doc, [Decoration.widget(state.selection.head, node, {key: \"gapcursor\"})])\n}\n\nexport { GapCursor, gapCursor };\n//# sourceMappingURL=index.es.js.map\n","import { keymap } from 'prosemirror-keymap';\nimport { undo, redo, history } from 'prosemirror-history';\nimport { toggleMark, wrapIn, chainCommands, exitCode, setBlockType, joinUp, joinDown, lift, selectParentNode, baseKeymap } from 'prosemirror-commands';\nimport { NodeSelection, Plugin } from 'prosemirror-state';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\nimport { icons, MenuItem, wrapItem, blockTypeItem, Dropdown, DropdownSubmenu, joinUpItem, liftItem, selectParentNodeItem, undoItem, redoItem, menuBar } from 'prosemirror-menu';\nimport { wrapInList, splitListItem, liftListItem, sinkListItem } from 'prosemirror-schema-list';\nimport { undoInputRule, smartQuotes, ellipsis, emDash, wrappingInputRule, textblockTypeInputRule, inputRules } from 'prosemirror-inputrules';\n\nvar prefix = \"ProseMirror-prompt\";\n\nfunction openPrompt(options) {\n  var wrapper = document.body.appendChild(document.createElement(\"div\"));\n  wrapper.className = prefix;\n\n  var mouseOutside = function (e) { if (!wrapper.contains(e.target)) { close(); } };\n  setTimeout(function () { return window.addEventListener(\"mousedown\", mouseOutside); }, 50);\n  var close = function () {\n    window.removeEventListener(\"mousedown\", mouseOutside);\n    if (wrapper.parentNode) { wrapper.parentNode.removeChild(wrapper); }\n  };\n\n  var domFields = [];\n  for (var name in options.fields) { domFields.push(options.fields[name].render()); }\n\n  var submitButton = document.createElement(\"button\");\n  submitButton.type = \"submit\";\n  submitButton.className = prefix + \"-submit\";\n  submitButton.textContent = \"OK\";\n  var cancelButton = document.createElement(\"button\");\n  cancelButton.type = \"button\";\n  cancelButton.className = prefix + \"-cancel\";\n  cancelButton.textContent = \"Cancel\";\n  cancelButton.addEventListener(\"click\", close);\n\n  var form = wrapper.appendChild(document.createElement(\"form\"));\n  if (options.title) { form.appendChild(document.createElement(\"h5\")).textContent = options.title; }\n  domFields.forEach(function (field) {\n    form.appendChild(document.createElement(\"div\")).appendChild(field);\n  });\n  var buttons = form.appendChild(document.createElement(\"div\"));\n  buttons.className = prefix + \"-buttons\";\n  buttons.appendChild(submitButton);\n  buttons.appendChild(document.createTextNode(\" \"));\n  buttons.appendChild(cancelButton);\n\n  var box = wrapper.getBoundingClientRect();\n  wrapper.style.top = ((window.innerHeight - box.height) / 2) + \"px\";\n  wrapper.style.left = ((window.innerWidth - box.width) / 2) + \"px\";\n\n  var submit = function () {\n    var params = getValues(options.fields, domFields);\n    if (params) {\n      close();\n      options.callback(params);\n    }\n  };\n\n  form.addEventListener(\"submit\", function (e) {\n    e.preventDefault();\n    submit();\n  });\n\n  form.addEventListener(\"keydown\", function (e) {\n    if (e.keyCode == 27) {\n      e.preventDefault();\n      close();\n    } else if (e.keyCode == 13 && !(e.ctrlKey || e.metaKey || e.shiftKey)) {\n      e.preventDefault();\n      submit();\n    } else if (e.keyCode == 9) {\n      window.setTimeout(function () {\n        if (!wrapper.contains(document.activeElement)) { close(); }\n      }, 500);\n    }\n  });\n\n  var input = form.elements[0];\n  if (input) { input.focus(); }\n}\n\nfunction getValues(fields, domFields) {\n  var result = Object.create(null), i = 0;\n  for (var name in fields) {\n    var field = fields[name], dom = domFields[i++];\n    var value = field.read(dom), bad = field.validate(value);\n    if (bad) {\n      reportInvalid(dom, bad);\n      return null\n    }\n    result[name] = field.clean(value);\n  }\n  return result\n}\n\nfunction reportInvalid(dom, message) {\n  // FIXME this is awful and needs a lot more work\n  var parent = dom.parentNode;\n  var msg = parent.appendChild(document.createElement(\"div\"));\n  msg.style.left = (dom.offsetLeft + dom.offsetWidth + 2) + \"px\";\n  msg.style.top = (dom.offsetTop - 5) + \"px\";\n  msg.className = \"ProseMirror-invalid\";\n  msg.textContent = message;\n  setTimeout(function () { return parent.removeChild(msg); }, 1500);\n}\n\n// ::- The type of field that `FieldPrompt` expects to be passed to it.\nvar Field = function Field(options) { this.options = options; };\n\n// render:: (state: EditorState, props: Object) → dom.Node\n// Render the field to the DOM. Should be implemented by all subclasses.\n\n// :: (dom.Node) → any\n// Read the field's value from its DOM node.\nField.prototype.read = function read (dom) { return dom.value };\n\n// :: (any) → ?string\n// A field-type-specific validation function.\nField.prototype.validateType = function validateType (_value) {};\n\nField.prototype.validate = function validate (value) {\n  if (!value && this.options.required)\n    { return \"Required field\" }\n  return this.validateType(value) || (this.options.validate && this.options.validate(value))\n};\n\nField.prototype.clean = function clean (value) {\n  return this.options.clean ? this.options.clean(value) : value\n};\n\n// ::- A field class for single-line text fields.\nvar TextField = /*@__PURE__*/(function (Field) {\n  function TextField () {\n    Field.apply(this, arguments);\n  }\n\n  if ( Field ) TextField.__proto__ = Field;\n  TextField.prototype = Object.create( Field && Field.prototype );\n  TextField.prototype.constructor = TextField;\n\n  TextField.prototype.render = function render () {\n    var input = document.createElement(\"input\");\n    input.type = \"text\";\n    input.placeholder = this.options.label;\n    input.value = this.options.value || \"\";\n    input.autocomplete = \"off\";\n    return input\n  };\n\n  return TextField;\n}(Field));\n\n// Helpers to create specific types of items\n\nfunction canInsert(state, nodeType) {\n  var $from = state.selection.$from;\n  for (var d = $from.depth; d >= 0; d--) {\n    var index = $from.index(d);\n    if ($from.node(d).canReplaceWith(index, index, nodeType)) { return true }\n  }\n  return false\n}\n\nfunction insertImageItem(nodeType) {\n  return new MenuItem({\n    title: \"Insert image\",\n    label: \"Image\",\n    enable: function enable(state) { return canInsert(state, nodeType) },\n    run: function run(state, _, view) {\n      var ref = state.selection;\n      var from = ref.from;\n      var to = ref.to;\n      var attrs = null;\n      if (state.selection instanceof NodeSelection && state.selection.node.type == nodeType)\n        { attrs = state.selection.node.attrs; }\n      openPrompt({\n        title: \"Insert image\",\n        fields: {\n          src: new TextField({label: \"Location\", required: true, value: attrs && attrs.src}),\n          title: new TextField({label: \"Title\", value: attrs && attrs.title}),\n          alt: new TextField({label: \"Description\",\n                              value: attrs ? attrs.alt : state.doc.textBetween(from, to, \" \")})\n        },\n        callback: function callback(attrs) {\n          view.dispatch(view.state.tr.replaceSelectionWith(nodeType.createAndFill(attrs)));\n          view.focus();\n        }\n      });\n    }\n  })\n}\n\nfunction cmdItem(cmd, options) {\n  var passedOptions = {\n    label: options.title,\n    run: cmd\n  };\n  for (var prop in options) { passedOptions[prop] = options[prop]; }\n  if ((!options.enable || options.enable === true) && !options.select)\n    { passedOptions[options.enable ? \"enable\" : \"select\"] = function (state) { return cmd(state); }; }\n\n  return new MenuItem(passedOptions)\n}\n\nfunction markActive(state, type) {\n  var ref = state.selection;\n  var from = ref.from;\n  var $from = ref.$from;\n  var to = ref.to;\n  var empty = ref.empty;\n  if (empty) { return type.isInSet(state.storedMarks || $from.marks()) }\n  else { return state.doc.rangeHasMark(from, to, type) }\n}\n\nfunction markItem(markType, options) {\n  var passedOptions = {\n    active: function active(state) { return markActive(state, markType) },\n    enable: true\n  };\n  for (var prop in options) { passedOptions[prop] = options[prop]; }\n  return cmdItem(toggleMark(markType), passedOptions)\n}\n\nfunction linkItem(markType) {\n  return new MenuItem({\n    title: \"Add or remove link\",\n    icon: icons.link,\n    active: function active(state) { return markActive(state, markType) },\n    enable: function enable(state) { return !state.selection.empty },\n    run: function run(state, dispatch, view) {\n      if (markActive(state, markType)) {\n        toggleMark(markType)(state, dispatch);\n        return true\n      }\n      openPrompt({\n        title: \"Create a link\",\n        fields: {\n          href: new TextField({\n            label: \"Link target\",\n            required: true\n          }),\n          title: new TextField({label: \"Title\"})\n        },\n        callback: function callback(attrs) {\n          toggleMark(markType, attrs)(view.state, view.dispatch);\n          view.focus();\n        }\n      });\n    }\n  })\n}\n\nfunction wrapListItem(nodeType, options) {\n  return cmdItem(wrapInList(nodeType, options.attrs), options)\n}\n\n// :: (Schema) → Object\n// Given a schema, look for default mark and node types in it and\n// return an object with relevant menu items relating to those marks:\n//\n// **`toggleStrong`**`: MenuItem`\n//   : A menu item to toggle the [strong mark](#schema-basic.StrongMark).\n//\n// **`toggleEm`**`: MenuItem`\n//   : A menu item to toggle the [emphasis mark](#schema-basic.EmMark).\n//\n// **`toggleCode`**`: MenuItem`\n//   : A menu item to toggle the [code font mark](#schema-basic.CodeMark).\n//\n// **`toggleLink`**`: MenuItem`\n//   : A menu item to toggle the [link mark](#schema-basic.LinkMark).\n//\n// **`insertImage`**`: MenuItem`\n//   : A menu item to insert an [image](#schema-basic.Image).\n//\n// **`wrapBulletList`**`: MenuItem`\n//   : A menu item to wrap the selection in a [bullet list](#schema-list.BulletList).\n//\n// **`wrapOrderedList`**`: MenuItem`\n//   : A menu item to wrap the selection in an [ordered list](#schema-list.OrderedList).\n//\n// **`wrapBlockQuote`**`: MenuItem`\n//   : A menu item to wrap the selection in a [block quote](#schema-basic.BlockQuote).\n//\n// **`makeParagraph`**`: MenuItem`\n//   : A menu item to set the current textblock to be a normal\n//     [paragraph](#schema-basic.Paragraph).\n//\n// **`makeCodeBlock`**`: MenuItem`\n//   : A menu item to set the current textblock to be a\n//     [code block](#schema-basic.CodeBlock).\n//\n// **`makeHead[N]`**`: MenuItem`\n//   : Where _N_ is 1 to 6. Menu items to set the current textblock to\n//     be a [heading](#schema-basic.Heading) of level _N_.\n//\n// **`insertHorizontalRule`**`: MenuItem`\n//   : A menu item to insert a horizontal rule.\n//\n// The return value also contains some prefabricated menu elements and\n// menus, that you can use instead of composing your own menu from\n// scratch:\n//\n// **`insertMenu`**`: Dropdown`\n//   : A dropdown containing the `insertImage` and\n//     `insertHorizontalRule` items.\n//\n// **`typeMenu`**`: Dropdown`\n//   : A dropdown containing the items for making the current\n//     textblock a paragraph, code block, or heading.\n//\n// **`fullMenu`**`: [[MenuElement]]`\n//   : An array of arrays of menu elements for use as the full menu\n//     for, for example the [menu bar](https://github.com/prosemirror/prosemirror-menu#user-content-menubar).\nfunction buildMenuItems(schema) {\n  var r = {}, type;\n  if (type = schema.marks.strong)\n    { r.toggleStrong = markItem(type, {title: \"Toggle strong style\", icon: icons.strong}); }\n  if (type = schema.marks.em)\n    { r.toggleEm = markItem(type, {title: \"Toggle emphasis\", icon: icons.em}); }\n  if (type = schema.marks.code)\n    { r.toggleCode = markItem(type, {title: \"Toggle code font\", icon: icons.code}); }\n  if (type = schema.marks.link)\n    { r.toggleLink = linkItem(type); }\n\n  if (type = schema.nodes.image)\n    { r.insertImage = insertImageItem(type); }\n  if (type = schema.nodes.bullet_list)\n    { r.wrapBulletList = wrapListItem(type, {\n      title: \"Wrap in bullet list\",\n      icon: icons.bulletList\n    }); }\n  if (type = schema.nodes.ordered_list)\n    { r.wrapOrderedList = wrapListItem(type, {\n      title: \"Wrap in ordered list\",\n      icon: icons.orderedList\n    }); }\n  if (type = schema.nodes.blockquote)\n    { r.wrapBlockQuote = wrapItem(type, {\n      title: \"Wrap in block quote\",\n      icon: icons.blockquote\n    }); }\n  if (type = schema.nodes.paragraph)\n    { r.makeParagraph = blockTypeItem(type, {\n      title: \"Change to paragraph\",\n      label: \"Plain\"\n    }); }\n  if (type = schema.nodes.code_block)\n    { r.makeCodeBlock = blockTypeItem(type, {\n      title: \"Change to code block\",\n      label: \"Code\"\n    }); }\n  if (type = schema.nodes.heading)\n    { for (var i = 1; i <= 10; i++)\n      { r[\"makeHead\" + i] = blockTypeItem(type, {\n        title: \"Change to heading \" + i,\n        label: \"Level \" + i,\n        attrs: {level: i}\n      }); } }\n  if (type = schema.nodes.horizontal_rule) {\n    var hr = type;\n    r.insertHorizontalRule = new MenuItem({\n      title: \"Insert horizontal rule\",\n      label: \"Horizontal rule\",\n      enable: function enable(state) { return canInsert(state, hr) },\n      run: function run(state, dispatch) { dispatch(state.tr.replaceSelectionWith(hr.create())); }\n    });\n  }\n\n  var cut = function (arr) { return arr.filter(function (x) { return x; }); };\n  r.insertMenu = new Dropdown(cut([r.insertImage, r.insertHorizontalRule]), {label: \"Insert\"});\n  r.typeMenu = new Dropdown(cut([r.makeParagraph, r.makeCodeBlock, r.makeHead1 && new DropdownSubmenu(cut([\n    r.makeHead1, r.makeHead2, r.makeHead3, r.makeHead4, r.makeHead5, r.makeHead6\n  ]), {label: \"Heading\"})]), {label: \"Type...\"});\n\n  r.inlineMenu = [cut([r.toggleStrong, r.toggleEm, r.toggleCode, r.toggleLink])];\n  r.blockMenu = [cut([r.wrapBulletList, r.wrapOrderedList, r.wrapBlockQuote, joinUpItem,\n                      liftItem, selectParentNodeItem])];\n  r.fullMenu = r.inlineMenu.concat([[r.insertMenu, r.typeMenu]], [[undoItem, redoItem]], r.blockMenu);\n\n  return r\n}\n\nvar mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform) : false;\n\n// :: (Schema, ?Object) → Object\n// Inspect the given schema looking for marks and nodes from the\n// basic schema, and if found, add key bindings related to them.\n// This will add:\n//\n// * **Mod-b** for toggling [strong](#schema-basic.StrongMark)\n// * **Mod-i** for toggling [emphasis](#schema-basic.EmMark)\n// * **Mod-`** for toggling [code font](#schema-basic.CodeMark)\n// * **Ctrl-Shift-0** for making the current textblock a paragraph\n// * **Ctrl-Shift-1** to **Ctrl-Shift-Digit6** for making the current\n//   textblock a heading of the corresponding level\n// * **Ctrl-Shift-Backslash** to make the current textblock a code block\n// * **Ctrl-Shift-8** to wrap the selection in an ordered list\n// * **Ctrl-Shift-9** to wrap the selection in a bullet list\n// * **Ctrl->** to wrap the selection in a block quote\n// * **Enter** to split a non-empty textblock in a list item while at\n//   the same time splitting the list item\n// * **Mod-Enter** to insert a hard break\n// * **Mod-_** to insert a horizontal rule\n// * **Backspace** to undo an input rule\n// * **Alt-ArrowUp** to `joinUp`\n// * **Alt-ArrowDown** to `joinDown`\n// * **Mod-BracketLeft** to `lift`\n// * **Escape** to `selectParentNode`\n//\n// You can suppress or map these bindings by passing a `mapKeys`\n// argument, which maps key names (say `\"Mod-B\"` to either `false`, to\n// remove the binding, or a new key name string.\nfunction buildKeymap(schema, mapKeys) {\n  var keys = {}, type;\n  function bind(key, cmd) {\n    if (mapKeys) {\n      var mapped = mapKeys[key];\n      if (mapped === false) { return }\n      if (mapped) { key = mapped; }\n    }\n    keys[key] = cmd;\n  }\n\n\n  bind(\"Mod-z\", undo);\n  bind(\"Shift-Mod-z\", redo);\n  bind(\"Backspace\", undoInputRule);\n  if (!mac) { bind(\"Mod-y\", redo); }\n\n  bind(\"Alt-ArrowUp\", joinUp);\n  bind(\"Alt-ArrowDown\", joinDown);\n  bind(\"Mod-BracketLeft\", lift);\n  bind(\"Escape\", selectParentNode);\n\n  if (type = schema.marks.strong) {\n    bind(\"Mod-b\", toggleMark(type));\n    bind(\"Mod-B\", toggleMark(type));\n  }\n  if (type = schema.marks.em) {\n    bind(\"Mod-i\", toggleMark(type));\n    bind(\"Mod-I\", toggleMark(type));\n  }\n  if (type = schema.marks.code)\n    { bind(\"Mod-`\", toggleMark(type)); }\n\n  if (type = schema.nodes.bullet_list)\n    { bind(\"Shift-Ctrl-8\", wrapInList(type)); }\n  if (type = schema.nodes.ordered_list)\n    { bind(\"Shift-Ctrl-9\", wrapInList(type)); }\n  if (type = schema.nodes.blockquote)\n    { bind(\"Ctrl->\", wrapIn(type)); }\n  if (type = schema.nodes.hard_break) {\n    var br = type, cmd = chainCommands(exitCode, function (state, dispatch) {\n      dispatch(state.tr.replaceSelectionWith(br.create()).scrollIntoView());\n      return true\n    });\n    bind(\"Mod-Enter\", cmd);\n    bind(\"Shift-Enter\", cmd);\n    if (mac) { bind(\"Ctrl-Enter\", cmd); }\n  }\n  if (type = schema.nodes.list_item) {\n    bind(\"Enter\", splitListItem(type));\n    bind(\"Mod-[\", liftListItem(type));\n    bind(\"Mod-]\", sinkListItem(type));\n  }\n  if (type = schema.nodes.paragraph)\n    { bind(\"Shift-Ctrl-0\", setBlockType(type)); }\n  if (type = schema.nodes.code_block)\n    { bind(\"Shift-Ctrl-\\\\\", setBlockType(type)); }\n  if (type = schema.nodes.heading)\n    { for (var i = 1; i <= 6; i++) { bind(\"Shift-Ctrl-\" + i, setBlockType(type, {level: i})); } }\n  if (type = schema.nodes.horizontal_rule) {\n    var hr = type;\n    bind(\"Mod-_\", function (state, dispatch) {\n      dispatch(state.tr.replaceSelectionWith(hr.create()).scrollIntoView());\n      return true\n    });\n  }\n\n  return keys\n}\n\n// : (NodeType) → InputRule\n// Given a blockquote node type, returns an input rule that turns `\"> \"`\n// at the start of a textblock into a blockquote.\nfunction blockQuoteRule(nodeType) {\n  return wrappingInputRule(/^\\s*>\\s$/, nodeType)\n}\n\n// : (NodeType) → InputRule\n// Given a list node type, returns an input rule that turns a number\n// followed by a dot at the start of a textblock into an ordered list.\nfunction orderedListRule(nodeType) {\n  return wrappingInputRule(/^(\\d+)\\.\\s$/, nodeType, function (match) { return ({order: +match[1]}); },\n                           function (match, node) { return node.childCount + node.attrs.order == +match[1]; })\n}\n\n// : (NodeType) → InputRule\n// Given a list node type, returns an input rule that turns a bullet\n// (dash, plush, or asterisk) at the start of a textblock into a\n// bullet list.\nfunction bulletListRule(nodeType) {\n  return wrappingInputRule(/^\\s*([-+*])\\s$/, nodeType)\n}\n\n// : (NodeType) → InputRule\n// Given a code block node type, returns an input rule that turns a\n// textblock starting with three backticks into a code block.\nfunction codeBlockRule(nodeType) {\n  return textblockTypeInputRule(/^```$/, nodeType)\n}\n\n// : (NodeType, number) → InputRule\n// Given a node type and a maximum level, creates an input rule that\n// turns up to that number of `#` characters followed by a space at\n// the start of a textblock into a heading whose level corresponds to\n// the number of `#` signs.\nfunction headingRule(nodeType, maxLevel) {\n  return textblockTypeInputRule(new RegExp(\"^(#{1,\" + maxLevel + \"})\\\\s$\"),\n                                nodeType, function (match) { return ({level: match[1].length}); })\n}\n\n// : (Schema) → Plugin\n// A set of input rules for creating the basic block quotes, lists,\n// code blocks, and heading.\nfunction buildInputRules(schema) {\n  var rules = smartQuotes.concat(ellipsis, emDash), type;\n  if (type = schema.nodes.blockquote) { rules.push(blockQuoteRule(type)); }\n  if (type = schema.nodes.ordered_list) { rules.push(orderedListRule(type)); }\n  if (type = schema.nodes.bullet_list) { rules.push(bulletListRule(type)); }\n  if (type = schema.nodes.code_block) { rules.push(codeBlockRule(type)); }\n  if (type = schema.nodes.heading) { rules.push(headingRule(type, 6)); }\n  return inputRules({rules: rules})\n}\n\n// !! This module exports helper functions for deriving a set of basic\n// menu items, input rules, or key bindings from a schema. These\n// values need to know about the schema for two reasons—they need\n// access to specific instances of node and mark types, and they need\n// to know which of the node and mark types that they know about are\n// actually present in the schema.\n//\n// The `exampleSetup` plugin ties these together into a plugin that\n// will automatically enable this basic functionality in an editor.\n\n// :: (Object) → [Plugin]\n// A convenience plugin that bundles together a simple menu with basic\n// key bindings, input rules, and styling for the example schema.\n// Probably only useful for quickly setting up a passable\n// editor—you'll need more control over your settings in most\n// real-world situations.\n//\n//   options::- The following options are recognized:\n//\n//     schema:: Schema\n//     The schema to generate key bindings and menu items for.\n//\n//     mapKeys:: ?Object\n//     Can be used to [adjust](#example-setup.buildKeymap) the key bindings created.\n//\n//     menuBar:: ?bool\n//     Set to false to disable the menu bar.\n//\n//     history:: ?bool\n//     Set to false to disable the history plugin.\n//\n//     floatingMenu:: ?bool\n//     Set to false to make the menu bar non-floating.\n//\n//     menuContent:: [[MenuItem]]\n//     Can be used to override the menu content.\nfunction exampleSetup(options) {\n  var plugins = [\n    buildInputRules(options.schema),\n    keymap(buildKeymap(options.schema, options.mapKeys)),\n    keymap(baseKeymap),\n    dropCursor(),\n    gapCursor()\n  ];\n  if (options.menuBar !== false)\n    { plugins.push(menuBar({floating: options.floatingMenu !== false,\n                          content: options.menuContent || buildMenuItems(options.schema).fullMenu})); }\n  if (options.history !== false)\n    { plugins.push(history()); }\n\n  return plugins.concat(new Plugin({\n    props: {\n      attributes: {class: \"ProseMirror-example-setup-style\"}\n    }\n  }))\n}\n\nexport { buildInputRules, buildKeymap, buildMenuItems, exampleSetup };\n//# sourceMappingURL=index.es.js.map\n","var GOOD_LEAF_SIZE = 200;\n\n// :: class<T> A rope sequence is a persistent sequence data structure\n// that supports appending, prepending, and slicing without doing a\n// full copy. It is represented as a mostly-balanced tree.\nvar RopeSequence = function RopeSequence () {};\n\nRopeSequence.prototype.append = function append (other) {\n  if (!other.length) { return this }\n  other = RopeSequence.from(other);\n\n  return (!this.length && other) ||\n    (other.length < GOOD_LEAF_SIZE && this.leafAppend(other)) ||\n    (this.length < GOOD_LEAF_SIZE && other.leafPrepend(this)) ||\n    this.appendInner(other)\n};\n\n// :: (union<[T], RopeSequence<T>>) → RopeSequence<T>\n// Prepend an array or other rope to this one, returning a new rope.\nRopeSequence.prototype.prepend = function prepend (other) {\n  if (!other.length) { return this }\n  return RopeSequence.from(other).append(this)\n};\n\nRopeSequence.prototype.appendInner = function appendInner (other) {\n  return new Append(this, other)\n};\n\n// :: (?number, ?number) → RopeSequence<T>\n// Create a rope repesenting a sub-sequence of this rope.\nRopeSequence.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from >= to) { return RopeSequence.empty }\n  return this.sliceInner(Math.max(0, from), Math.min(this.length, to))\n};\n\n// :: (number) → T\n// Retrieve the element at the given position from this rope.\nRopeSequence.prototype.get = function get (i) {\n  if (i < 0 || i >= this.length) { return undefined }\n  return this.getInner(i)\n};\n\n// :: ((element: T, index: number) → ?bool, ?number, ?number)\n// Call the given function for each element between the given\n// indices. This tends to be more efficient than looping over the\n// indices and calling `get`, because it doesn't have to descend the\n// tree for every element.\nRopeSequence.prototype.forEach = function forEach (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from <= to)\n    { this.forEachInner(f, from, to, 0); }\n  else\n    { this.forEachInvertedInner(f, from, to, 0); }\n};\n\n// :: ((element: T, index: number) → U, ?number, ?number) → [U]\n// Map the given functions over the elements of the rope, producing\n// a flat array.\nRopeSequence.prototype.map = function map (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  var result = [];\n  this.forEach(function (elt, i) { return result.push(f(elt, i)); }, from, to);\n  return result\n};\n\n// :: (?union<[T], RopeSequence<T>>) → RopeSequence<T>\n// Create a rope representing the given array, or return the rope\n// itself if a rope was given.\nRopeSequence.from = function from (values) {\n  if (values instanceof RopeSequence) { return values }\n  return values && values.length ? new Leaf(values) : RopeSequence.empty\n};\n\nvar Leaf = /*@__PURE__*/(function (RopeSequence) {\n  function Leaf(values) {\n    RopeSequence.call(this);\n    this.values = values;\n  }\n\n  if ( RopeSequence ) Leaf.__proto__ = RopeSequence;\n  Leaf.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Leaf.prototype.constructor = Leaf;\n\n  var prototypeAccessors = { length: { configurable: true },depth: { configurable: true } };\n\n  Leaf.prototype.flatten = function flatten () {\n    return this.values\n  };\n\n  Leaf.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    return new Leaf(this.values.slice(from, to))\n  };\n\n  Leaf.prototype.getInner = function getInner (i) {\n    return this.values[i]\n  };\n\n  Leaf.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    for (var i = from; i < to; i++)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    for (var i = from - 1; i >= to; i--)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.leafAppend = function leafAppend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(this.values.concat(other.flatten())) }\n  };\n\n  Leaf.prototype.leafPrepend = function leafPrepend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(other.flatten().concat(this.values)) }\n  };\n\n  prototypeAccessors.length.get = function () { return this.values.length };\n\n  prototypeAccessors.depth.get = function () { return 0 };\n\n  Object.defineProperties( Leaf.prototype, prototypeAccessors );\n\n  return Leaf;\n}(RopeSequence));\n\n// :: RopeSequence\n// The empty rope sequence.\nRopeSequence.empty = new Leaf([]);\n\nvar Append = /*@__PURE__*/(function (RopeSequence) {\n  function Append(left, right) {\n    RopeSequence.call(this);\n    this.left = left;\n    this.right = right;\n    this.length = left.length + right.length;\n    this.depth = Math.max(left.depth, right.depth) + 1;\n  }\n\n  if ( RopeSequence ) Append.__proto__ = RopeSequence;\n  Append.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Append.prototype.constructor = Append;\n\n  Append.prototype.flatten = function flatten () {\n    return this.left.flatten().concat(this.right.flatten())\n  };\n\n  Append.prototype.getInner = function getInner (i) {\n    return i < this.left.length ? this.left.get(i) : this.right.get(i - this.left.length)\n  };\n\n  Append.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from < leftLen &&\n        this.left.forEachInner(f, from, Math.min(to, leftLen), start) === false)\n      { return false }\n    if (to > leftLen &&\n        this.right.forEachInner(f, Math.max(from - leftLen, 0), Math.min(this.length, to) - leftLen, start + leftLen) === false)\n      { return false }\n  };\n\n  Append.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from > leftLen &&\n        this.right.forEachInvertedInner(f, from - leftLen, Math.max(to, leftLen) - leftLen, start + leftLen) === false)\n      { return false }\n    if (to < leftLen &&\n        this.left.forEachInvertedInner(f, Math.min(from, leftLen), to, start) === false)\n      { return false }\n  };\n\n  Append.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    var leftLen = this.left.length;\n    if (to <= leftLen) { return this.left.slice(from, to) }\n    if (from >= leftLen) { return this.right.slice(from - leftLen, to - leftLen) }\n    return this.left.slice(from, leftLen).append(this.right.slice(0, to - leftLen))\n  };\n\n  Append.prototype.leafAppend = function leafAppend (other) {\n    var inner = this.right.leafAppend(other);\n    if (inner) { return new Append(this.left, inner) }\n  };\n\n  Append.prototype.leafPrepend = function leafPrepend (other) {\n    var inner = this.left.leafPrepend(other);\n    if (inner) { return new Append(inner, this.right) }\n  };\n\n  Append.prototype.appendInner = function appendInner (other) {\n    if (this.left.depth >= Math.max(this.right.depth, other.depth) + 1)\n      { return new Append(this.left, new Append(this.right, other)) }\n    return new Append(this, other)\n  };\n\n  return Append;\n}(RopeSequence));\n\nvar ropeSequence = RopeSequence;\n\nexport default ropeSequence;\n","import RopeSequence from 'rope-sequence';\nimport { Mapping } from 'prosemirror-transform';\nimport { PluginKey, Plugin } from 'prosemirror-state';\n\n// ProseMirror's history isn't simply a way to roll back to a previous\n// state, because ProseMirror supports applying changes without adding\n// them to the history (for example during collaboration).\n//\n// To this end, each 'Branch' (one for the undo history and one for\n// the redo history) keeps an array of 'Items', which can optionally\n// hold a step (an actual undoable change), and always hold a position\n// map (which is needed to move changes below them to apply to the\n// current document).\n//\n// An item that has both a step and a selection bookmark is the start\n// of an 'event' — a group of changes that will be undone or redone at\n// once. (It stores only the bookmark, since that way we don't have to\n// provide a document until the selection is actually applied, which\n// is useful when compressing.)\n\n// Used to schedule history compression\nvar max_empty_items = 500;\n\nvar Branch = function Branch(items, eventCount) {\n  this.items = items;\n  this.eventCount = eventCount;\n};\n\n// : (EditorState, bool) → ?{transform: Transform, selection: ?SelectionBookmark, remaining: Branch}\n// Pop the latest event off the branch's history and apply it\n// to a document transform.\nBranch.prototype.popEvent = function popEvent (state, preserveItems) {\n    var this$1 = this;\n\n  if (this.eventCount == 0) { return null }\n\n  var end = this.items.length;\n  for (;; end--) {\n    var next = this.items.get(end - 1);\n    if (next.selection) { --end; break }\n  }\n\n  var remap, mapFrom;\n  if (preserveItems) {\n    remap = this.remapping(end, this.items.length);\n    mapFrom = remap.maps.length;\n  }\n  var transform = state.tr;\n  var selection, remaining;\n  var addAfter = [], addBefore = [];\n\n  this.items.forEach(function (item, i) {\n    if (!item.step) {\n      if (!remap) {\n        remap = this$1.remapping(end, i + 1);\n        mapFrom = remap.maps.length;\n      }\n      mapFrom--;\n      addBefore.push(item);\n      return\n    }\n\n    if (remap) {\n      addBefore.push(new Item(item.map));\n      var step = item.step.map(remap.slice(mapFrom)), map;\n\n      if (step && transform.maybeStep(step).doc) {\n        map = transform.mapping.maps[transform.mapping.maps.length - 1];\n        addAfter.push(new Item(map, null, null, addAfter.length + addBefore.length));\n      }\n      mapFrom--;\n      if (map) { remap.appendMap(map, mapFrom); }\n    } else {\n      transform.maybeStep(item.step);\n    }\n\n    if (item.selection) {\n      selection = remap ? item.selection.map(remap.slice(mapFrom)) : item.selection;\n      remaining = new Branch(this$1.items.slice(0, end).append(addBefore.reverse().concat(addAfter)), this$1.eventCount - 1);\n      return false\n    }\n  }, this.items.length, 0);\n\n  return {remaining: remaining, transform: transform, selection: selection}\n};\n\n// : (Transform, ?SelectionBookmark, Object) → Branch\n// Create a new branch with the given transform added.\nBranch.prototype.addTransform = function addTransform (transform, selection, histOptions, preserveItems) {\n  var newItems = [], eventCount = this.eventCount;\n  var oldItems = this.items, lastItem = !preserveItems && oldItems.length ? oldItems.get(oldItems.length - 1) : null;\n\n  for (var i = 0; i < transform.steps.length; i++) {\n    var step = transform.steps[i].invert(transform.docs[i]);\n    var item = new Item(transform.mapping.maps[i], step, selection), merged = (void 0);\n    if (merged = lastItem && lastItem.merge(item)) {\n      item = merged;\n      if (i) { newItems.pop(); }\n      else { oldItems = oldItems.slice(0, oldItems.length - 1); }\n    }\n    newItems.push(item);\n    if (selection) {\n      eventCount++;\n      selection = null;\n    }\n    if (!preserveItems) { lastItem = item; }\n  }\n  var overflow = eventCount - histOptions.depth;\n  if (overflow > DEPTH_OVERFLOW) {\n    oldItems = cutOffEvents(oldItems, overflow);\n    eventCount -= overflow;\n  }\n  return new Branch(oldItems.append(newItems), eventCount)\n};\n\nBranch.prototype.remapping = function remapping (from, to) {\n  var maps = new Mapping;\n  this.items.forEach(function (item, i) {\n    var mirrorPos = item.mirrorOffset != null && i - item.mirrorOffset >= from\n        ? maps.maps.length - item.mirrorOffset : null;\n    maps.appendMap(item.map, mirrorPos);\n  }, from, to);\n  return maps\n};\n\nBranch.prototype.addMaps = function addMaps (array) {\n  if (this.eventCount == 0) { return this }\n  return new Branch(this.items.append(array.map(function (map) { return new Item(map); })), this.eventCount)\n};\n\n// : (Transform, number)\n// When the collab module receives remote changes, the history has\n// to know about those, so that it can adjust the steps that were\n// rebased on top of the remote changes, and include the position\n// maps for the remote changes in its array of items.\nBranch.prototype.rebased = function rebased (rebasedTransform, rebasedCount) {\n  if (!this.eventCount) { return this }\n\n  var rebasedItems = [], start = Math.max(0, this.items.length - rebasedCount);\n\n  var mapping = rebasedTransform.mapping;\n  var newUntil = rebasedTransform.steps.length;\n  var eventCount = this.eventCount;\n  this.items.forEach(function (item) { if (item.selection) { eventCount--; } }, start);\n\n  var iRebased = rebasedCount;\n  this.items.forEach(function (item) {\n    var pos = mapping.getMirror(--iRebased);\n    if (pos == null) { return }\n    newUntil = Math.min(newUntil, pos);\n    var map = mapping.maps[pos];\n    if (item.step) {\n      var step = rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos]);\n      var selection = item.selection && item.selection.map(mapping.slice(iRebased + 1, pos));\n      if (selection) { eventCount++; }\n      rebasedItems.push(new Item(map, step, selection));\n    } else {\n      rebasedItems.push(new Item(map));\n    }\n  }, start);\n\n  var newMaps = [];\n  for (var i = rebasedCount; i < newUntil; i++)\n    { newMaps.push(new Item(mapping.maps[i])); }\n  var items = this.items.slice(0, start).append(newMaps).append(rebasedItems);\n  var branch = new Branch(items, eventCount);\n\n  if (branch.emptyItemCount() > max_empty_items)\n    { branch = branch.compress(this.items.length - rebasedItems.length); }\n  return branch\n};\n\nBranch.prototype.emptyItemCount = function emptyItemCount () {\n  var count = 0;\n  this.items.forEach(function (item) { if (!item.step) { count++; } });\n  return count\n};\n\n// Compressing a branch means rewriting it to push the air (map-only\n// items) out. During collaboration, these naturally accumulate\n// because each remote change adds one. The `upto` argument is used\n// to ensure that only the items below a given level are compressed,\n// because `rebased` relies on a clean, untouched set of items in\n// order to associate old items with rebased steps.\nBranch.prototype.compress = function compress (upto) {\n    if ( upto === void 0 ) upto = this.items.length;\n\n  var remap = this.remapping(0, upto), mapFrom = remap.maps.length;\n  var items = [], events = 0;\n  this.items.forEach(function (item, i) {\n    if (i >= upto) {\n      items.push(item);\n      if (item.selection) { events++; }\n    } else if (item.step) {\n      var step = item.step.map(remap.slice(mapFrom)), map = step && step.getMap();\n      mapFrom--;\n      if (map) { remap.appendMap(map, mapFrom); }\n      if (step) {\n        var selection = item.selection && item.selection.map(remap.slice(mapFrom));\n        if (selection) { events++; }\n        var newItem = new Item(map.invert(), step, selection), merged, last = items.length - 1;\n        if (merged = items.length && items[last].merge(newItem))\n          { items[last] = merged; }\n        else\n          { items.push(newItem); }\n      }\n    } else if (item.map) {\n      mapFrom--;\n    }\n  }, this.items.length, 0);\n  return new Branch(RopeSequence.from(items.reverse()), events)\n};\n\nBranch.empty = new Branch(RopeSequence.empty, 0);\n\nfunction cutOffEvents(items, n) {\n  var cutPoint;\n  items.forEach(function (item, i) {\n    if (item.selection && (n-- == 0)) {\n      cutPoint = i;\n      return false\n    }\n  });\n  return items.slice(cutPoint)\n}\n\nvar Item = function Item(map, step, selection, mirrorOffset) {\n  // The (forward) step map for this item.\n  this.map = map;\n  // The inverted step\n  this.step = step;\n  // If this is non-null, this item is the start of a group, and\n  // this selection is the starting selection for the group (the one\n  // that was active before the first step was applied)\n  this.selection = selection;\n  // If this item is the inverse of a previous mapping on the stack,\n  // this points at the inverse's offset\n  this.mirrorOffset = mirrorOffset;\n};\n\nItem.prototype.merge = function merge (other) {\n  if (this.step && other.step && !other.selection) {\n    var step = other.step.merge(this.step);\n    if (step) { return new Item(step.getMap().invert(), step, this.selection) }\n  }\n};\n\n// The value of the state field that tracks undo/redo history for that\n// state. Will be stored in the plugin state when the history plugin\n// is active.\nvar HistoryState = function HistoryState(done, undone, prevRanges, prevTime) {\n  this.done = done;\n  this.undone = undone;\n  this.prevRanges = prevRanges;\n  this.prevTime = prevTime;\n};\n\nvar DEPTH_OVERFLOW = 20;\n\n// : (HistoryState, EditorState, Transaction, Object)\n// Record a transformation in undo history.\nfunction applyTransaction(history, state, tr, options) {\n  var historyTr = tr.getMeta(historyKey), rebased;\n  if (historyTr) { return historyTr.historyState }\n\n  if (tr.getMeta(closeHistoryKey)) { history = new HistoryState(history.done, history.undone, null, 0); }\n\n  var appended = tr.getMeta(\"appendedTransaction\");\n\n  if (tr.steps.length == 0) {\n    return history\n  } else if (appended && appended.getMeta(historyKey)) {\n    if (appended.getMeta(historyKey).redo)\n      { return new HistoryState(history.done.addTransform(tr, null, options, mustPreserveItems(state)),\n                              history.undone, rangesFor(tr.mapping.maps[tr.steps.length - 1]), history.prevTime) }\n    else\n      { return new HistoryState(history.done, history.undone.addTransform(tr, null, options, mustPreserveItems(state)),\n                              null, history.prevTime) }\n  } else if (tr.getMeta(\"addToHistory\") !== false && !(appended && appended.getMeta(\"addToHistory\") === false)) {\n    // Group transforms that occur in quick succession into one event.\n    var newGroup = history.prevTime == 0 || !appended && (history.prevTime < (tr.time || 0) - options.newGroupDelay ||\n                                                          !isAdjacentTo(tr, history.prevRanges));\n    var prevRanges = appended ? mapRanges(history.prevRanges, tr.mapping) : rangesFor(tr.mapping.maps[tr.steps.length - 1]);\n    return new HistoryState(history.done.addTransform(tr, newGroup ? state.selection.getBookmark() : null,\n                                                      options, mustPreserveItems(state)),\n                            Branch.empty, prevRanges, tr.time)\n  } else if (rebased = tr.getMeta(\"rebased\")) {\n    // Used by the collab module to tell the history that some of its\n    // content has been rebased.\n    return new HistoryState(history.done.rebased(tr, rebased),\n                            history.undone.rebased(tr, rebased),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  } else {\n    return new HistoryState(history.done.addMaps(tr.mapping.maps),\n                            history.undone.addMaps(tr.mapping.maps),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  }\n}\n\nfunction isAdjacentTo(transform, prevRanges) {\n  if (!prevRanges) { return false }\n  if (!transform.docChanged) { return true }\n  var adjacent = false;\n  transform.mapping.maps[0].forEach(function (start, end) {\n    for (var i = 0; i < prevRanges.length; i += 2)\n      { if (start <= prevRanges[i + 1] && end >= prevRanges[i])\n        { adjacent = true; } }\n  });\n  return adjacent\n}\n\nfunction rangesFor(map) {\n  var result = [];\n  map.forEach(function (_from, _to, from, to) { return result.push(from, to); });\n  return result\n}\n\nfunction mapRanges(ranges, mapping) {\n  if (!ranges) { return null }\n  var result = [];\n  for (var i = 0; i < ranges.length; i += 2) {\n    var from = mapping.map(ranges[i], 1), to = mapping.map(ranges[i + 1], -1);\n    if (from <= to) { result.push(from, to); }\n  }\n  return result\n}\n\n// : (HistoryState, EditorState, (tr: Transaction), bool)\n// Apply the latest event from one branch to the document and shift the event\n// onto the other branch.\nfunction histTransaction(history, state, dispatch, redo) {\n  var preserveItems = mustPreserveItems(state), histOptions = historyKey.get(state).spec.config;\n  var pop = (redo ? history.undone : history.done).popEvent(state, preserveItems);\n  if (!pop) { return }\n\n  var selection = pop.selection.resolve(pop.transform.doc);\n  var added = (redo ? history.done : history.undone).addTransform(pop.transform, state.selection.getBookmark(),\n                                                                  histOptions, preserveItems);\n\n  var newHist = new HistoryState(redo ? added : pop.remaining, redo ? pop.remaining : added, null, 0);\n  dispatch(pop.transform.setSelection(selection).setMeta(historyKey, {redo: redo, historyState: newHist}).scrollIntoView());\n}\n\nvar cachedPreserveItems = false, cachedPreserveItemsPlugins = null;\n// Check whether any plugin in the given state has a\n// `historyPreserveItems` property in its spec, in which case we must\n// preserve steps exactly as they came in, so that they can be\n// rebased.\nfunction mustPreserveItems(state) {\n  var plugins = state.plugins;\n  if (cachedPreserveItemsPlugins != plugins) {\n    cachedPreserveItems = false;\n    cachedPreserveItemsPlugins = plugins;\n    for (var i = 0; i < plugins.length; i++) { if (plugins[i].spec.historyPreserveItems) {\n      cachedPreserveItems = true;\n      break\n    } }\n  }\n  return cachedPreserveItems\n}\n\n// :: (Transaction) → Transaction\n// Set a flag on the given transaction that will prevent further steps\n// from being appended to an existing history event (so that they\n// require a separate undo command to undo).\nfunction closeHistory(tr) {\n  return tr.setMeta(closeHistoryKey, true)\n}\n\nvar historyKey = new PluginKey(\"history\");\nvar closeHistoryKey = new PluginKey(\"closeHistory\");\n\n// :: (?Object) → Plugin\n// Returns a plugin that enables the undo history for an editor. The\n// plugin will track undo and redo stacks, which can be used with the\n// [`undo`](#history.undo) and [`redo`](#history.redo) commands.\n//\n// You can set an `\"addToHistory\"` [metadata\n// property](#state.Transaction.setMeta) of `false` on a transaction\n// to prevent it from being rolled back by undo.\n//\n//   config::-\n//   Supports the following configuration options:\n//\n//     depth:: ?number\n//     The amount of history events that are collected before the\n//     oldest events are discarded. Defaults to 100.\n//\n//     newGroupDelay:: ?number\n//     The delay between changes after which a new group should be\n//     started. Defaults to 500 (milliseconds). Note that when changes\n//     aren't adjacent, a new group is always started.\nfunction history(config) {\n  config = {depth: config && config.depth || 100,\n            newGroupDelay: config && config.newGroupDelay || 500};\n  return new Plugin({\n    key: historyKey,\n\n    state: {\n      init: function init() {\n        return new HistoryState(Branch.empty, Branch.empty, null, 0)\n      },\n      apply: function apply(tr, hist, state) {\n        return applyTransaction(hist, state, tr, config)\n      }\n    },\n\n    config: config\n  })\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// A command function that undoes the last change, if any.\nfunction undo(state, dispatch) {\n  var hist = historyKey.getState(state);\n  if (!hist || hist.done.eventCount == 0) { return false }\n  if (dispatch) { histTransaction(hist, state, dispatch, false); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// A command function that redoes the last undone change, if any.\nfunction redo(state, dispatch) {\n  var hist = historyKey.getState(state);\n  if (!hist || hist.undone.eventCount == 0) { return false }\n  if (dispatch) { histTransaction(hist, state, dispatch, true); }\n  return true\n}\n\n// :: (EditorState) → number\n// The amount of undoable events available in a given state.\nfunction undoDepth(state) {\n  var hist = historyKey.getState(state);\n  return hist ? hist.done.eventCount : 0\n}\n\n// :: (EditorState) → number\n// The amount of redoable events available in a given editor state.\nfunction redoDepth(state) {\n  var hist = historyKey.getState(state);\n  return hist ? hist.undone.eventCount : 0\n}\n\nexport { HistoryState, closeHistory, history, redo, redoDepth, undo, undoDepth };\n//# sourceMappingURL=index.es.js.map\n","import { Plugin } from 'prosemirror-state';\nimport { findWrapping, canJoin } from 'prosemirror-transform';\n\n// ::- Input rules are regular expressions describing a piece of text\n// that, when typed, causes something to happen. This might be\n// changing two dashes into an emdash, wrapping a paragraph starting\n// with `\"> \"` into a blockquote, or something entirely different.\nvar InputRule = function InputRule(match, handler) {\n  this.match = match;\n  this.handler = typeof handler == \"string\" ? stringHandler(handler) : handler;\n};\n\nfunction stringHandler(string) {\n  return function(state, match, start, end) {\n    var insert = string;\n    if (match[1]) {\n      var offset = match[0].lastIndexOf(match[1]);\n      insert += match[0].slice(offset + match[1].length);\n      start += offset;\n      var cutOff = start - end;\n      if (cutOff > 0) {\n        insert = match[0].slice(offset - cutOff, offset) + insert;\n        start = end;\n      }\n    }\n    return state.tr.insertText(insert, start, end)\n  }\n}\n\nvar MAX_MATCH = 500;\n\n// :: (config: {rules: [InputRule]}) → Plugin\n// Create an input rules plugin. When enabled, it will cause text\n// input that matches any of the given rules to trigger the rule's\n// action.\nfunction inputRules(ref) {\n  var rules = ref.rules;\n\n  var plugin = new Plugin({\n    state: {\n      init: function init() { return null },\n      apply: function apply(tr, prev) {\n        var stored = tr.getMeta(this);\n        if (stored) { return stored }\n        return tr.selectionSet || tr.docChanged ? null : prev\n      }\n    },\n\n    props: {\n      handleTextInput: function handleTextInput(view, from, to, text) {\n        return run(view, from, to, text, rules, plugin)\n      },\n      handleDOMEvents: {\n        compositionend: function (view) {\n          setTimeout(function () {\n            var ref = view.state.selection;\n            var $cursor = ref.$cursor;\n            if ($cursor) { run(view, $cursor.pos, $cursor.pos, \"\", rules, plugin); }\n          });\n        }\n      }\n    },\n\n    isInputRules: true\n  });\n  return plugin\n}\n\nfunction run(view, from, to, text, rules, plugin) {\n  if (view.composing) { return false }\n  var state = view.state, $from = state.doc.resolve(from);\n  if ($from.parent.type.spec.code) { return false }\n  var textBefore = $from.parent.textBetween(Math.max(0, $from.parentOffset - MAX_MATCH), $from.parentOffset,\n                                            null, \"\\ufffc\") + text;\n  for (var i = 0; i < rules.length; i++) {\n    var match = rules[i].match.exec(textBefore);\n    var tr = match && rules[i].handler(state, match, from - (match[0].length - text.length), to);\n    if (!tr) { continue }\n    view.dispatch(tr.setMeta(plugin, {transform: tr, from: from, to: to, text: text}));\n    return true\n  }\n  return false\n}\n\n// :: (EditorState, ?(Transaction)) → bool\n// This is a command that will undo an input rule, if applying such a\n// rule was the last thing that the user did.\nfunction undoInputRule(state, dispatch) {\n  var plugins = state.plugins;\n  for (var i = 0; i < plugins.length; i++) {\n    var plugin = plugins[i], undoable = (void 0);\n    if (plugin.spec.isInputRules && (undoable = plugin.getState(state))) {\n      if (dispatch) {\n        var tr = state.tr, toUndo = undoable.transform;\n        for (var j = toUndo.steps.length - 1; j >= 0; j--)\n          { tr.step(toUndo.steps[j].invert(toUndo.docs[j])); }\n        if (undoable.text) {\n          var marks = tr.doc.resolve(undoable.from).marks();\n          tr.replaceWith(undoable.from, undoable.to, state.schema.text(undoable.text, marks));\n        } else {\n          tr.delete(undoable.from, undoable.to);\n        }\n        dispatch(tr);\n      }\n      return true\n    }\n  }\n  return false\n}\n\n// :: InputRule Converts double dashes to an emdash.\nvar emDash = new InputRule(/--$/, \"—\");\n// :: InputRule Converts three dots to an ellipsis character.\nvar ellipsis = new InputRule(/\\.\\.\\.$/, \"…\");\n// :: InputRule “Smart” opening double quotes.\nvar openDoubleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(\")$/, \"“\");\n// :: InputRule “Smart” closing double quotes.\nvar closeDoubleQuote = new InputRule(/\"$/, \"”\");\n// :: InputRule “Smart” opening single quotes.\nvar openSingleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(')$/, \"‘\");\n// :: InputRule “Smart” closing single quotes.\nvar closeSingleQuote = new InputRule(/'$/, \"’\");\n\n// :: [InputRule] Smart-quote related input rules.\nvar smartQuotes = [openDoubleQuote, closeDoubleQuote, openSingleQuote, closeSingleQuote];\n\n// :: (RegExp, NodeType, ?union<Object, ([string]) → ?Object>, ?([string], Node) → bool) → InputRule\n// Build an input rule for automatically wrapping a textblock when a\n// given string is typed. The `regexp` argument is\n// directly passed through to the `InputRule` constructor. You'll\n// probably want the regexp to start with `^`, so that the pattern can\n// only occur at the start of a textblock.\n//\n// `nodeType` is the type of node to wrap in. If it needs attributes,\n// you can either pass them directly, or pass a function that will\n// compute them from the regular expression match.\n//\n// By default, if there's a node with the same type above the newly\n// wrapped node, the rule will try to [join](#transform.Transform.join) those\n// two nodes. You can pass a join predicate, which takes a regular\n// expression match and the node before the wrapped node, and can\n// return a boolean to indicate whether a join should happen.\nfunction wrappingInputRule(regexp, nodeType, getAttrs, joinPredicate) {\n  return new InputRule(regexp, function (state, match, start, end) {\n    var attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    var tr = state.tr.delete(start, end);\n    var $start = tr.doc.resolve(start), range = $start.blockRange(), wrapping = range && findWrapping(range, nodeType, attrs);\n    if (!wrapping) { return null }\n    tr.wrap(range, wrapping);\n    var before = tr.doc.resolve(start - 1).nodeBefore;\n    if (before && before.type == nodeType && canJoin(tr.doc, start - 1) &&\n        (!joinPredicate || joinPredicate(match, before)))\n      { tr.join(start - 1); }\n    return tr\n  })\n}\n\n// :: (RegExp, NodeType, ?union<Object, ([string]) → ?Object>) → InputRule\n// Build an input rule that changes the type of a textblock when the\n// matched text is typed into it. You'll usually want to start your\n// regexp with `^` to that it is only matched at the start of a\n// textblock. The optional `getAttrs` parameter can be used to compute\n// the new node's attributes, and works the same as in the\n// `wrappingInputRule` function.\nfunction textblockTypeInputRule(regexp, nodeType, getAttrs) {\n  return new InputRule(regexp, function (state, match, start, end) {\n    var $start = state.doc.resolve(start);\n    var attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    if (!$start.node(-1).canReplaceWith($start.index(-1), $start.indexAfter(-1), nodeType)) { return null }\n    return state.tr\n      .delete(start, end)\n      .setBlockType(start, start, nodeType, attrs)\n  })\n}\n\nexport { InputRule, closeDoubleQuote, closeSingleQuote, ellipsis, emDash, inputRules, openDoubleQuote, openSingleQuote, smartQuotes, textblockTypeInputRule, undoInputRule, wrappingInputRule };\n//# sourceMappingURL=index.es.js.map\n","export var base = {\n  8: \"Backspace\",\n  9: \"Tab\",\n  10: \"Enter\",\n  12: \"NumLock\",\n  13: \"Enter\",\n  16: \"Shift\",\n  17: \"Control\",\n  18: \"Alt\",\n  20: \"CapsLock\",\n  27: \"Escape\",\n  32: \" \",\n  33: \"PageUp\",\n  34: \"PageDown\",\n  35: \"End\",\n  36: \"Home\",\n  37: \"ArrowLeft\",\n  38: \"ArrowUp\",\n  39: \"ArrowRight\",\n  40: \"ArrowDown\",\n  44: \"PrintScreen\",\n  45: \"Insert\",\n  46: \"Delete\",\n  59: \";\",\n  61: \"=\",\n  91: \"Meta\",\n  92: \"Meta\",\n  106: \"*\",\n  107: \"+\",\n  108: \",\",\n  109: \"-\",\n  110: \".\",\n  111: \"/\",\n  144: \"NumLock\",\n  145: \"ScrollLock\",\n  160: \"Shift\",\n  161: \"Shift\",\n  162: \"Control\",\n  163: \"Control\",\n  164: \"Alt\",\n  165: \"Alt\",\n  173: \"-\",\n  186: \";\",\n  187: \"=\",\n  188: \",\",\n  189: \"-\",\n  190: \".\",\n  191: \"/\",\n  192: \"`\",\n  219: \"[\",\n  220: \"\\\\\",\n  221: \"]\",\n  222: \"'\",\n  229: \"q\"\n}\n\nexport var shift = {\n  48: \")\",\n  49: \"!\",\n  50: \"@\",\n  51: \"#\",\n  52: \"$\",\n  53: \"%\",\n  54: \"^\",\n  55: \"&\",\n  56: \"*\",\n  57: \"(\",\n  59: \":\",\n  61: \"+\",\n  173: \"_\",\n  186: \":\",\n  187: \"+\",\n  188: \"<\",\n  189: \"_\",\n  190: \">\",\n  191: \"?\",\n  192: \"~\",\n  219: \"{\",\n  220: \"|\",\n  221: \"}\",\n  222: \"\\\"\",\n  229: \"Q\"\n}\n\nvar chrome = typeof navigator != \"undefined\" && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\nvar safari = typeof navigator != \"undefined\" && /Apple Computer/.test(navigator.vendor)\nvar gecko = typeof navigator != \"undefined\" && /Gecko\\/\\d+/.test(navigator.userAgent)\nvar mac = typeof navigator != \"undefined\" && /Mac/.test(navigator.platform)\nvar ie = typeof navigator != \"undefined\" && /MSIE \\d|Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\nvar brokenModifierNames = chrome && (mac || +chrome[1] < 57) || gecko && mac\n\n// Fill in the digit keys\nfor (var i = 0; i < 10; i++) base[48 + i] = base[96 + i] = String(i)\n\n// The function keys\nfor (var i = 1; i <= 24; i++) base[i + 111] = \"F\" + i\n\n// And the alphabetic keys\nfor (var i = 65; i <= 90; i++) {\n  base[i] = String.fromCharCode(i + 32)\n  shift[i] = String.fromCharCode(i)\n}\n\n// For each code that doesn't have a shift-equivalent, copy the base name\nfor (var code in base) if (!shift.hasOwnProperty(code)) shift[code] = base[code]\n\nexport function keyName(event) {\n  // Don't trust event.key in Chrome when there are modifiers until\n  // they fix https://bugs.chromium.org/p/chromium/issues/detail?id=633838\n  var ignoreKey = brokenModifierNames && (event.ctrlKey || event.altKey || event.metaKey) ||\n    (safari || ie) && event.shiftKey && event.key && event.key.length == 1\n  var name = (!ignoreKey && event.key) ||\n    (event.shiftKey ? shift : base)[event.keyCode] ||\n    event.key || \"Unidentified\"\n  // Edge sometimes produces wrong names (Issue #3)\n  if (name == \"Esc\") name = \"Escape\"\n  if (name == \"Del\") name = \"Delete\"\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8860571/\n  if (name == \"Left\") name = \"ArrowLeft\"\n  if (name == \"Up\") name = \"ArrowUp\"\n  if (name == \"Right\") name = \"ArrowRight\"\n  if (name == \"Down\") name = \"ArrowDown\"\n  return name\n}\n","import { keyName, base } from 'w3c-keyname';\nimport { Plugin } from 'prosemirror-state';\n\n// declare global: navigator\n\nvar mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform) : false;\n\nfunction normalizeKeyName(name) {\n  var parts = name.split(/-(?!$)/), result = parts[parts.length - 1];\n  if (result == \"Space\") { result = \" \"; }\n  var alt, ctrl, shift, meta;\n  for (var i = 0; i < parts.length - 1; i++) {\n    var mod = parts[i];\n    if (/^(cmd|meta|m)$/i.test(mod)) { meta = true; }\n    else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n    else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n    else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n    else if (/^mod$/i.test(mod)) { if (mac) { meta = true; } else { ctrl = true; } }\n    else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n  }\n  if (alt) { result = \"Alt-\" + result; }\n  if (ctrl) { result = \"Ctrl-\" + result; }\n  if (meta) { result = \"Meta-\" + result; }\n  if (shift) { result = \"Shift-\" + result; }\n  return result\n}\n\nfunction normalize(map) {\n  var copy = Object.create(null);\n  for (var prop in map) { copy[normalizeKeyName(prop)] = map[prop]; }\n  return copy\n}\n\nfunction modifiers(name, event, shift) {\n  if (event.altKey) { name = \"Alt-\" + name; }\n  if (event.ctrlKey) { name = \"Ctrl-\" + name; }\n  if (event.metaKey) { name = \"Meta-\" + name; }\n  if (shift !== false && event.shiftKey) { name = \"Shift-\" + name; }\n  return name\n}\n\n// :: (Object) → Plugin\n// Create a keymap plugin for the given set of bindings.\n//\n// Bindings should map key names to [command](#commands)-style\n// functions, which will be called with `(EditorState, dispatch,\n// EditorView)` arguments, and should return true when they've handled\n// the key. Note that the view argument isn't part of the command\n// protocol, but can be used as an escape hatch if a binding needs to\n// directly interact with the UI.\n//\n// Key names may be strings like `\"Shift-Ctrl-Enter\"`—a key\n// identifier prefixed with zero or more modifiers. Key identifiers\n// are based on the strings that can appear in\n// [`KeyEvent.key`](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key).\n// Use lowercase letters to refer to letter keys (or uppercase letters\n// if you want shift to be held). You may use `\"Space\"` as an alias\n// for the `\" \"` name.\n//\n// Modifiers can be given in any order. `Shift-` (or `s-`), `Alt-` (or\n// `a-`), `Ctrl-` (or `c-` or `Control-`) and `Cmd-` (or `m-` or\n// `Meta-`) are recognized. For characters that are created by holding\n// shift, the `Shift-` prefix is implied, and should not be added\n// explicitly.\n//\n// You can use `Mod-` as a shorthand for `Cmd-` on Mac and `Ctrl-` on\n// other platforms.\n//\n// You can add multiple keymap plugins to an editor. The order in\n// which they appear determines their precedence (the ones early in\n// the array get to dispatch first).\nfunction keymap(bindings) {\n  return new Plugin({props: {handleKeyDown: keydownHandler(bindings)}})\n}\n\n// :: (Object) → (view: EditorView, event: dom.Event) → bool\n// Given a set of bindings (using the same format as\n// [`keymap`](#keymap.keymap), return a [keydown\n// handler](#view.EditorProps.handleKeyDown) that handles them.\nfunction keydownHandler(bindings) {\n  var map = normalize(bindings);\n  return function(view, event) {\n    var name = keyName(event), isChar = name.length == 1 && name != \" \", baseName;\n    var direct = map[modifiers(name, event, !isChar)];\n    if (direct && direct(view.state, view.dispatch, view)) { return true }\n    if (isChar && (event.shiftKey || event.altKey || event.metaKey || name.charCodeAt(0) > 127) &&\n        (baseName = base[event.keyCode]) && baseName != name) {\n      // Try falling back to the keyCode when there's a modifier\n      // active or the character produced isn't ASCII, and our table\n      // produces a different name from the the keyCode. See #668,\n      // #1060\n      var fromCode = map[modifiers(baseName, event, true)];\n      if (fromCode && fromCode(view.state, view.dispatch, view)) { return true }\n    } else if (isChar && event.shiftKey) {\n      // Otherwise, if shift is active, also try the binding with the\n      // Shift- prefix enabled. See #997\n      var withShift = map[modifiers(name, event, true)];\n      if (withShift && withShift(view.state, view.dispatch, view)) { return true }\n    }\n    return false\n  }\n}\n\nexport { keydownHandler, keymap };\n//# sourceMappingURL=index.es.js.map\n","export default function crelt() {\n  var elt = arguments[0]\n  if (typeof elt == \"string\") elt = document.createElement(elt)\n  var i = 1, next = arguments[1]\n  if (next && typeof next == \"object\" && next.nodeType == null && !Array.isArray(next)) {\n    for (var name in next) if (Object.prototype.hasOwnProperty.call(next, name)) {\n      var value = next[name]\n      if (typeof value == \"string\") elt.setAttribute(name, value)\n      else if (value != null) elt[name] = value\n    }\n    i++\n  }\n  for (; i < arguments.length; i++) add(elt, arguments[i])\n  return elt\n}\n\nfunction add(elt, child) {\n  if (typeof child == \"string\") {\n    elt.appendChild(document.createTextNode(child))\n  } else if (child == null) {\n  } else if (child.nodeType != null) {\n    elt.appendChild(child)\n  } else if (Array.isArray(child)) {\n    for (var i = 0; i < child.length; i++) add(elt, child[i])\n  } else {\n    throw new RangeError(\"Unsupported child node: \" + child)\n  }\n}\n","import crel from 'crelt';\nimport { joinUp, lift, selectParentNode, setBlockType, wrapIn } from 'prosemirror-commands';\nimport { undo, redo } from 'prosemirror-history';\nimport { Plugin } from 'prosemirror-state';\n\nvar SVG = \"http://www.w3.org/2000/svg\";\nvar XLINK = \"http://www.w3.org/1999/xlink\";\n\nvar prefix = \"ProseMirror-icon\";\n\nfunction hashPath(path) {\n  var hash = 0;\n  for (var i = 0; i < path.length; i++)\n    { hash = (((hash << 5) - hash) + path.charCodeAt(i)) | 0; }\n  return hash\n}\n\nfunction getIcon(icon) {\n  var node = document.createElement(\"div\");\n  node.className = prefix;\n  if (icon.path) {\n    var name = \"pm-icon-\" + hashPath(icon.path).toString(16);\n    if (!document.getElementById(name)) { buildSVG(name, icon); }\n    var svg = node.appendChild(document.createElementNS(SVG, \"svg\"));\n    svg.style.width = (icon.width / icon.height) + \"em\";\n    var use = svg.appendChild(document.createElementNS(SVG, \"use\"));\n    use.setAttributeNS(XLINK, \"href\", /([^#]*)/.exec(document.location)[1] + \"#\" + name);\n  } else if (icon.dom) {\n    node.appendChild(icon.dom.cloneNode(true));\n  } else {\n    node.appendChild(document.createElement(\"span\")).textContent = icon.text || '';\n    if (icon.css) { node.firstChild.style.cssText = icon.css; }\n  }\n  return node\n}\n\nfunction buildSVG(name, data) {\n  var collection = document.getElementById(prefix + \"-collection\");\n  if (!collection) {\n    collection = document.createElementNS(SVG, \"svg\");\n    collection.id = prefix + \"-collection\";\n    collection.style.display = \"none\";\n    document.body.insertBefore(collection, document.body.firstChild);\n  }\n  var sym = document.createElementNS(SVG, \"symbol\");\n  sym.id = name;\n  sym.setAttribute(\"viewBox\", \"0 0 \" + data.width + \" \" + data.height);\n  var path = sym.appendChild(document.createElementNS(SVG, \"path\"));\n  path.setAttribute(\"d\", data.path);\n  collection.appendChild(sym);\n}\n\nvar prefix$1 = \"ProseMirror-menu\";\n\n// ::- An icon or label that, when clicked, executes a command.\nvar MenuItem = function MenuItem(spec) {\n  // :: MenuItemSpec\n  // The spec used to create the menu item.\n  this.spec = spec;\n};\n\n// :: (EditorView) → {dom: dom.Node, update: (EditorState) → bool}\n// Renders the icon according to its [display\n// spec](#menu.MenuItemSpec.display), and adds an event handler which\n// executes the command when the representation is clicked.\nMenuItem.prototype.render = function render (view) {\n  var spec = this.spec;\n  var dom = spec.render ? spec.render(view)\n      : spec.icon ? getIcon(spec.icon)\n      : spec.label ? crel(\"div\", null, translate(view, spec.label))\n      : null;\n  if (!dom) { throw new RangeError(\"MenuItem without icon or label property\") }\n  if (spec.title) {\n    var title = (typeof spec.title === \"function\" ? spec.title(view.state) : spec.title);\n    dom.setAttribute(\"title\", translate(view, title));\n  }\n  if (spec.class) { dom.classList.add(spec.class); }\n  if (spec.css) { dom.style.cssText += spec.css; }\n\n  dom.addEventListener(\"mousedown\", function (e) {\n    e.preventDefault();\n    if (!dom.classList.contains(prefix$1 + \"-disabled\"))\n      { spec.run(view.state, view.dispatch, view, e); }\n  });\n\n  function update(state) {\n    if (spec.select) {\n      var selected = spec.select(state);\n      dom.style.display = selected ? \"\" : \"none\";\n      if (!selected) { return false }\n    }\n    var enabled = true;\n    if (spec.enable) {\n      enabled = spec.enable(state) || false;\n      setClass(dom, prefix$1 + \"-disabled\", !enabled);\n    }\n    if (spec.active) {\n      var active = enabled && spec.active(state) || false;\n      setClass(dom, prefix$1 + \"-active\", active);\n    }\n    return true\n  }\n\n  return {dom: dom, update: update}\n};\n\nfunction translate(view, text) {\n  return view._props.translate ? view._props.translate(text) : text\n}\n\n// MenuItemSpec:: interface\n// The configuration object passed to the `MenuItem` constructor.\n//\n//   run:: (EditorState, (Transaction), EditorView, dom.Event)\n//   The function to execute when the menu item is activated.\n//\n//   select:: ?(EditorState) → bool\n//   Optional function that is used to determine whether the item is\n//   appropriate at the moment. Deselected items will be hidden.\n//\n//   enable:: ?(EditorState) → bool\n//   Function that is used to determine if the item is enabled. If\n//   given and returning false, the item will be given a disabled\n//   styling.\n//\n//   active:: ?(EditorState) → bool\n//   A predicate function to determine whether the item is 'active' (for\n//   example, the item for toggling the strong mark might be active then\n//   the cursor is in strong text).\n//\n//   render:: ?(EditorView) → dom.Node\n//   A function that renders the item. You must provide either this,\n//   [`icon`](#menu.MenuItemSpec.icon), or [`label`](#MenuItemSpec.label).\n//\n//   icon:: ?Object\n//   Describes an icon to show for this item. The object may specify\n//   an SVG icon, in which case its `path` property should be an [SVG\n//   path\n//   spec](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d),\n//   and `width` and `height` should provide the viewbox in which that\n//   path exists. Alternatively, it may have a `text` property\n//   specifying a string of text that makes up the icon, with an\n//   optional `css` property giving additional CSS styling for the\n//   text. _Or_ it may contain `dom` property containing a DOM node.\n//\n//   label:: ?string\n//   Makes the item show up as a text label. Mostly useful for items\n//   wrapped in a [drop-down](#menu.Dropdown) or similar menu. The object\n//   should have a `label` property providing the text to display.\n//\n//   title:: ?union<string, (EditorState) → string>\n//   Defines DOM title (mouseover) text for the item.\n//\n//   class:: ?string\n//   Optionally adds a CSS class to the item's DOM representation.\n//\n//   css:: ?string\n//   Optionally adds a string of inline CSS to the item's DOM\n//   representation.\n\nvar lastMenuEvent = {time: 0, node: null};\nfunction markMenuEvent(e) {\n  lastMenuEvent.time = Date.now();\n  lastMenuEvent.node = e.target;\n}\nfunction isMenuEvent(wrapper) {\n  return Date.now() - 100 < lastMenuEvent.time &&\n    lastMenuEvent.node && wrapper.contains(lastMenuEvent.node)\n}\n\n// ::- A drop-down menu, displayed as a label with a downwards-pointing\n// triangle to the right of it.\nvar Dropdown = function Dropdown(content, options) {\n  this.options = options || {};\n  this.content = Array.isArray(content) ? content : [content];\n};\n\n// :: (EditorView) → {dom: dom.Node, update: (EditorState)}\n// Render the dropdown menu and sub-items.\nDropdown.prototype.render = function render (view) {\n    var this$1 = this;\n\n  var content = renderDropdownItems(this.content, view);\n\n  var label = crel(\"div\", {class: prefix$1 + \"-dropdown \" + (this.options.class || \"\"),\n                           style: this.options.css},\n                   translate(view, this.options.label));\n  if (this.options.title) { label.setAttribute(\"title\", translate(view, this.options.title)); }\n  var wrap = crel(\"div\", {class: prefix$1 + \"-dropdown-wrap\"}, label);\n  var open = null, listeningOnClose = null;\n  var close = function () {\n    if (open && open.close()) {\n      open = null;\n      window.removeEventListener(\"mousedown\", listeningOnClose);\n    }\n  };\n  label.addEventListener(\"mousedown\", function (e) {\n    e.preventDefault();\n    markMenuEvent(e);\n    if (open) {\n      close();\n    } else {\n      open = this$1.expand(wrap, content.dom);\n      window.addEventListener(\"mousedown\", listeningOnClose = function () {\n        if (!isMenuEvent(wrap)) { close(); }\n      });\n    }\n  });\n\n  function update(state) {\n    var inner = content.update(state);\n    wrap.style.display = inner ? \"\" : \"none\";\n    return inner\n  }\n\n  return {dom: wrap, update: update}\n};\n\nDropdown.prototype.expand = function expand (dom, items) {\n  var menuDOM = crel(\"div\", {class: prefix$1 + \"-dropdown-menu \" + (this.options.class || \"\")}, items);\n\n  var done = false;\n  function close() {\n    if (done) { return }\n    done = true;\n    dom.removeChild(menuDOM);\n    return true\n  }\n  dom.appendChild(menuDOM);\n  return {close: close, node: menuDOM}\n};\n\nfunction renderDropdownItems(items, view) {\n  var rendered = [], updates = [];\n  for (var i = 0; i < items.length; i++) {\n    var ref = items[i].render(view);\n    var dom = ref.dom;\n    var update = ref.update;\n    rendered.push(crel(\"div\", {class: prefix$1 + \"-dropdown-item\"}, dom));\n    updates.push(update);\n  }\n  return {dom: rendered, update: combineUpdates(updates, rendered)}\n}\n\nfunction combineUpdates(updates, nodes) {\n  return function (state) {\n    var something = false;\n    for (var i = 0; i < updates.length; i++) {\n      var up = updates[i](state);\n      nodes[i].style.display = up ? \"\" : \"none\";\n      if (up) { something = true; }\n    }\n    return something\n  }\n}\n\n// ::- Represents a submenu wrapping a group of elements that start\n// hidden and expand to the right when hovered over or tapped.\nvar DropdownSubmenu = function DropdownSubmenu(content, options) {\n  this.options = options || {};\n  this.content = Array.isArray(content) ? content : [content];\n};\n\n// :: (EditorView) → {dom: dom.Node, update: (EditorState) → bool}\n// Renders the submenu.\nDropdownSubmenu.prototype.render = function render (view) {\n  var items = renderDropdownItems(this.content, view);\n\n  var label = crel(\"div\", {class: prefix$1 + \"-submenu-label\"}, translate(view, this.options.label));\n  var wrap = crel(\"div\", {class: prefix$1 + \"-submenu-wrap\"}, label,\n                 crel(\"div\", {class: prefix$1 + \"-submenu\"}, items.dom));\n  var listeningOnClose = null;\n  label.addEventListener(\"mousedown\", function (e) {\n    e.preventDefault();\n    markMenuEvent(e);\n    setClass(wrap, prefix$1 + \"-submenu-wrap-active\");\n    if (!listeningOnClose)\n      { window.addEventListener(\"mousedown\", listeningOnClose = function () {\n        if (!isMenuEvent(wrap)) {\n          wrap.classList.remove(prefix$1 + \"-submenu-wrap-active\");\n          window.removeEventListener(\"mousedown\", listeningOnClose);\n          listeningOnClose = null;\n        }\n      }); }\n  });\n\n  function update(state) {\n    var inner = items.update(state);\n    wrap.style.display = inner ? \"\" : \"none\";\n    return inner\n  }\n  return {dom: wrap, update: update}\n};\n\n// :: (EditorView, [union<MenuElement, [MenuElement]>]) → {dom: ?dom.DocumentFragment, update: (EditorState) → bool}\n// Render the given, possibly nested, array of menu elements into a\n// document fragment, placing separators between them (and ensuring no\n// superfluous separators appear when some of the groups turn out to\n// be empty).\nfunction renderGrouped(view, content) {\n  var result = document.createDocumentFragment();\n  var updates = [], separators = [];\n  for (var i = 0; i < content.length; i++) {\n    var items = content[i], localUpdates = [], localNodes = [];\n    for (var j = 0; j < items.length; j++) {\n      var ref = items[j].render(view);\n      var dom = ref.dom;\n      var update$1 = ref.update;\n      var span = crel(\"span\", {class: prefix$1 + \"item\"}, dom);\n      result.appendChild(span);\n      localNodes.push(span);\n      localUpdates.push(update$1);\n    }\n    if (localUpdates.length) {\n      updates.push(combineUpdates(localUpdates, localNodes));\n      if (i < content.length - 1)\n        { separators.push(result.appendChild(separator())); }\n    }\n  }\n\n  function update(state) {\n    var something = false, needSep = false;\n    for (var i = 0; i < updates.length; i++) {\n      var hasContent = updates[i](state);\n      if (i) { separators[i - 1].style.display = needSep && hasContent ? \"\" : \"none\"; }\n      needSep = hasContent;\n      if (hasContent) { something = true; }\n    }\n    return something\n  }\n  return {dom: result, update: update}\n}\n\nfunction separator() {\n  return crel(\"span\", {class: prefix$1 + \"separator\"})\n}\n\n// :: Object\n// A set of basic editor-related icons. Contains the properties\n// `join`, `lift`, `selectParentNode`, `undo`, `redo`, `strong`, `em`,\n// `code`, `link`, `bulletList`, `orderedList`, and `blockquote`, each\n// holding an object that can be used as the `icon` option to\n// `MenuItem`.\nvar icons = {\n  join: {\n    width: 800, height: 900,\n    path: \"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z\"\n  },\n  lift: {\n    width: 1024, height: 1024,\n    path: \"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z\"\n  },\n  selectParentNode: {text: \"\\u2b1a\", css: \"font-weight: bold\"},\n  undo: {\n    width: 1024, height: 1024,\n    path: \"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z\"\n  },\n  redo: {\n    width: 1024, height: 1024,\n    path: \"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z\"\n  },\n  strong: {\n    width: 805, height: 1024,\n    path: \"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z\"\n  },\n  em: {\n    width: 585, height: 1024,\n    path: \"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z\"\n  },\n  code: {\n    width: 896, height: 1024,\n    path: \"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z\"\n  },\n  link: {\n    width: 951, height: 1024,\n    path: \"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z\"\n  },\n  bulletList: {\n    width: 768, height: 896,\n    path: \"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z\"\n  },\n  orderedList: {\n    width: 768, height: 896,\n    path: \"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z\"\n  },\n  blockquote: {\n    width: 640, height: 896,\n    path: \"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z\"\n  }\n};\n\n// :: MenuItem\n// Menu item for the `joinUp` command.\nvar joinUpItem = new MenuItem({\n  title: \"Join with above block\",\n  run: joinUp,\n  select: function (state) { return joinUp(state); },\n  icon: icons.join\n});\n\n// :: MenuItem\n// Menu item for the `lift` command.\nvar liftItem = new MenuItem({\n  title: \"Lift out of enclosing block\",\n  run: lift,\n  select: function (state) { return lift(state); },\n  icon: icons.lift\n});\n\n// :: MenuItem\n// Menu item for the `selectParentNode` command.\nvar selectParentNodeItem = new MenuItem({\n  title: \"Select parent node\",\n  run: selectParentNode,\n  select: function (state) { return selectParentNode(state); },\n  icon: icons.selectParentNode\n});\n\n// :: MenuItem\n// Menu item for the `undo` command.\nvar undoItem = new MenuItem({\n  title: \"Undo last change\",\n  run: undo,\n  enable: function (state) { return undo(state); },\n  icon: icons.undo\n});\n\n// :: MenuItem\n// Menu item for the `redo` command.\nvar redoItem = new MenuItem({\n  title: \"Redo last undone change\",\n  run: redo,\n  enable: function (state) { return redo(state); },\n  icon: icons.redo\n});\n\n// :: (NodeType, Object) → MenuItem\n// Build a menu item for wrapping the selection in a given node type.\n// Adds `run` and `select` properties to the ones present in\n// `options`. `options.attrs` may be an object or a function.\nfunction wrapItem(nodeType, options) {\n  var passedOptions = {\n    run: function run(state, dispatch) {\n      // FIXME if (options.attrs instanceof Function) options.attrs(state, attrs => wrapIn(nodeType, attrs)(state))\n      return wrapIn(nodeType, options.attrs)(state, dispatch)\n    },\n    select: function select(state) {\n      return wrapIn(nodeType, options.attrs instanceof Function ? null : options.attrs)(state)\n    }\n  };\n  for (var prop in options) { passedOptions[prop] = options[prop]; }\n  return new MenuItem(passedOptions)\n}\n\n// :: (NodeType, Object) → MenuItem\n// Build a menu item for changing the type of the textblock around the\n// selection to the given type. Provides `run`, `active`, and `select`\n// properties. Others must be given in `options`. `options.attrs` may\n// be an object to provide the attributes for the textblock node.\nfunction blockTypeItem(nodeType, options) {\n  var command = setBlockType(nodeType, options.attrs);\n  var passedOptions = {\n    run: command,\n    enable: function enable(state) { return command(state) },\n    active: function active(state) {\n      var ref = state.selection;\n      var $from = ref.$from;\n      var to = ref.to;\n      var node = ref.node;\n      if (node) { return node.hasMarkup(nodeType, options.attrs) }\n      return to <= $from.end() && $from.parent.hasMarkup(nodeType, options.attrs)\n    }\n  };\n  for (var prop in options) { passedOptions[prop] = options[prop]; }\n  return new MenuItem(passedOptions)\n}\n\n// Work around classList.toggle being broken in IE11\nfunction setClass(dom, cls, on) {\n  if (on) { dom.classList.add(cls); }\n  else { dom.classList.remove(cls); }\n}\n\nvar prefix$2 = \"ProseMirror-menubar\";\n\nfunction isIOS() {\n  if (typeof navigator == \"undefined\") { return false }\n  var agent = navigator.userAgent;\n  return !/Edge\\/\\d/.test(agent) && /AppleWebKit/.test(agent) && /Mobile\\/\\w+/.test(agent)\n}\n\n// :: (Object) → Plugin\n// A plugin that will place a menu bar above the editor. Note that\n// this involves wrapping the editor in an additional `<div>`.\n//\n//   options::-\n//   Supports the following options:\n//\n//     content:: [[MenuElement]]\n//     Provides the content of the menu, as a nested array to be\n//     passed to `renderGrouped`.\n//\n//     floating:: ?bool\n//     Determines whether the menu floats, i.e. whether it sticks to\n//     the top of the viewport when the editor is partially scrolled\n//     out of view.\nfunction menuBar(options) {\n  return new Plugin({\n    view: function view(editorView) { return new MenuBarView(editorView, options) }\n  })\n}\n\nvar MenuBarView = function MenuBarView(editorView, options) {\n  var this$1 = this;\n\n  this.editorView = editorView;\n  this.options = options;\n\n  this.wrapper = crel(\"div\", {class: prefix$2 + \"-wrapper\"});\n  this.menu = this.wrapper.appendChild(crel(\"div\", {class: prefix$2}));\n  this.menu.className = prefix$2;\n  this.spacer = null;\n\n  editorView.dom.parentNode.replaceChild(this.wrapper, editorView.dom);\n  this.wrapper.appendChild(editorView.dom);\n\n  this.maxHeight = 0;\n  this.widthForMaxHeight = 0;\n  this.floating = false;\n\n  var ref = renderGrouped(this.editorView, this.options.content);\n  var dom = ref.dom;\n  var update = ref.update;\n  this.contentUpdate = update;\n  this.menu.appendChild(dom);\n  this.update();\n\n  if (options.floating && !isIOS()) {\n    this.updateFloat();\n    var potentialScrollers = getAllWrapping(this.wrapper);\n    this.scrollFunc = function (e) {\n      var root = this$1.editorView.root;\n      if (!(root.body || root).contains(this$1.wrapper)) {\n          potentialScrollers.forEach(function (el) { return el.removeEventListener(\"scroll\", this$1.scrollFunc); });\n      } else {\n          this$1.updateFloat(e.target.getBoundingClientRect && e.target);\n      }\n    };\n    potentialScrollers.forEach(function (el) { return el.addEventListener('scroll', this$1.scrollFunc); });\n  }\n};\n\nMenuBarView.prototype.update = function update () {\n  this.contentUpdate(this.editorView.state);\n\n  if (this.floating) {\n    this.updateScrollCursor();\n  } else {\n    if (this.menu.offsetWidth != this.widthForMaxHeight) {\n      this.widthForMaxHeight = this.menu.offsetWidth;\n      this.maxHeight = 0;\n    }\n    if (this.menu.offsetHeight > this.maxHeight) {\n      this.maxHeight = this.menu.offsetHeight;\n      this.menu.style.minHeight = this.maxHeight + \"px\";\n    }\n  }\n};\n\nMenuBarView.prototype.updateScrollCursor = function updateScrollCursor () {\n  var selection = this.editorView.root.getSelection();\n  if (!selection.focusNode) { return }\n  var rects = selection.getRangeAt(0).getClientRects();\n  var selRect = rects[selectionIsInverted(selection) ? 0 : rects.length - 1];\n  if (!selRect) { return }\n  var menuRect = this.menu.getBoundingClientRect();\n  if (selRect.top < menuRect.bottom && selRect.bottom > menuRect.top) {\n    var scrollable = findWrappingScrollable(this.wrapper);\n    if (scrollable) { scrollable.scrollTop -= (menuRect.bottom - selRect.top); }\n  }\n};\n\nMenuBarView.prototype.updateFloat = function updateFloat (scrollAncestor) {\n  var parent = this.wrapper, editorRect = parent.getBoundingClientRect(),\n      top = scrollAncestor ? Math.max(0, scrollAncestor.getBoundingClientRect().top) : 0;\n\n  if (this.floating) {\n    if (editorRect.top >= top || editorRect.bottom < this.menu.offsetHeight + 10) {\n      this.floating = false;\n      this.menu.style.position = this.menu.style.left = this.menu.style.top = this.menu.style.width = \"\";\n      this.menu.style.display = \"\";\n      this.spacer.parentNode.removeChild(this.spacer);\n      this.spacer = null;\n    } else {\n      var border = (parent.offsetWidth - parent.clientWidth) / 2;\n      this.menu.style.left = (editorRect.left + border) + \"px\";\n      this.menu.style.display = (editorRect.top > window.innerHeight ? \"none\" : \"\");\n      if (scrollAncestor) { this.menu.style.top = top + \"px\"; }\n    }\n  } else {\n    if (editorRect.top < top && editorRect.bottom >= this.menu.offsetHeight + 10) {\n      this.floating = true;\n      var menuRect = this.menu.getBoundingClientRect();\n      this.menu.style.left = menuRect.left + \"px\";\n      this.menu.style.width = menuRect.width + \"px\";\n      if (scrollAncestor) { this.menu.style.top = top + \"px\"; }\n      this.menu.style.position = \"fixed\";\n      this.spacer = crel(\"div\", {class: prefix$2 + \"-spacer\", style: (\"height: \" + (menuRect.height) + \"px\")});\n      parent.insertBefore(this.spacer, this.menu);\n    }\n  }\n};\n\nMenuBarView.prototype.destroy = function destroy () {\n  if (this.wrapper.parentNode)\n    { this.wrapper.parentNode.replaceChild(this.editorView.dom, this.wrapper); }\n};\n\n// Not precise, but close enough\nfunction selectionIsInverted(selection) {\n  if (selection.anchorNode == selection.focusNode) { return selection.anchorOffset > selection.focusOffset }\n  return selection.anchorNode.compareDocumentPosition(selection.focusNode) == Node.DOCUMENT_POSITION_FOLLOWING\n}\n\nfunction findWrappingScrollable(node) {\n  for (var cur = node.parentNode; cur; cur = cur.parentNode)\n    { if (cur.scrollHeight > cur.clientHeight) { return cur } }\n}\n\nfunction getAllWrapping(node) {\n    var res = [window];\n    for (var cur = node.parentNode; cur; cur = cur.parentNode)\n        { res.push(cur); }\n    return res\n}\n\nexport { Dropdown, DropdownSubmenu, MenuItem, blockTypeItem, icons, joinUpItem, liftItem, menuBar, redoItem, renderGrouped, selectParentNodeItem, undoItem, wrapItem };\n//# sourceMappingURL=index.es.js.map\n","import OrderedMap from 'orderedmap';\n\nfunction findDiffStart(a, b, pos) {\n  for (var i = 0;; i++) {\n    if (i == a.childCount || i == b.childCount)\n      { return a.childCount == b.childCount ? null : pos }\n\n    var childA = a.child(i), childB = b.child(i);\n    if (childA == childB) { pos += childA.nodeSize; continue }\n\n    if (!childA.sameMarkup(childB)) { return pos }\n\n    if (childA.isText && childA.text != childB.text) {\n      for (var j = 0; childA.text[j] == childB.text[j]; j++)\n        { pos++; }\n      return pos\n    }\n    if (childA.content.size || childB.content.size) {\n      var inner = findDiffStart(childA.content, childB.content, pos + 1);\n      if (inner != null) { return inner }\n    }\n    pos += childA.nodeSize;\n  }\n}\n\nfunction findDiffEnd(a, b, posA, posB) {\n  for (var iA = a.childCount, iB = b.childCount;;) {\n    if (iA == 0 || iB == 0)\n      { return iA == iB ? null : {a: posA, b: posB} }\n\n    var childA = a.child(--iA), childB = b.child(--iB), size = childA.nodeSize;\n    if (childA == childB) {\n      posA -= size; posB -= size;\n      continue\n    }\n\n    if (!childA.sameMarkup(childB)) { return {a: posA, b: posB} }\n\n    if (childA.isText && childA.text != childB.text) {\n      var same = 0, minSize = Math.min(childA.text.length, childB.text.length);\n      while (same < minSize && childA.text[childA.text.length - same - 1] == childB.text[childB.text.length - same - 1]) {\n        same++; posA--; posB--;\n      }\n      return {a: posA, b: posB}\n    }\n    if (childA.content.size || childB.content.size) {\n      var inner = findDiffEnd(childA.content, childB.content, posA - 1, posB - 1);\n      if (inner) { return inner }\n    }\n    posA -= size; posB -= size;\n  }\n}\n\n// ::- A fragment represents a node's collection of child nodes.\n//\n// Like nodes, fragments are persistent data structures, and you\n// should not mutate them or their content. Rather, you create new\n// instances whenever needed. The API tries to make this easy.\nvar Fragment = function Fragment(content, size) {\n  this.content = content;\n  // :: number\n  // The size of the fragment, which is the total of the size of its\n  // content nodes.\n  this.size = size || 0;\n  if (size == null) { for (var i = 0; i < content.length; i++)\n    { this.size += content[i].nodeSize; } }\n};\n\nvar prototypeAccessors = { firstChild: { configurable: true },lastChild: { configurable: true },childCount: { configurable: true } };\n\n// :: (number, number, (node: Node, start: number, parent: Node, index: number) → ?bool, ?number)\n// Invoke a callback for all descendant nodes between the given two\n// positions (relative to start of this fragment). Doesn't descend\n// into a node when the callback returns `false`.\nFragment.prototype.nodesBetween = function nodesBetween (from, to, f, nodeStart, parent) {\n    if ( nodeStart === void 0 ) nodeStart = 0;\n\n  for (var i = 0, pos = 0; pos < to; i++) {\n    var child = this.content[i], end = pos + child.nodeSize;\n    if (end > from && f(child, nodeStart + pos, parent, i) !== false && child.content.size) {\n      var start = pos + 1;\n      child.nodesBetween(Math.max(0, from - start),\n                         Math.min(child.content.size, to - start),\n                         f, nodeStart + start);\n    }\n    pos = end;\n  }\n};\n\n// :: ((node: Node, pos: number, parent: Node) → ?bool)\n// Call the given callback for every descendant node. The callback\n// may return `false` to prevent traversal of a given node's children.\nFragment.prototype.descendants = function descendants (f) {\n  this.nodesBetween(0, this.size, f);\n};\n\n// : (number, number, ?string, ?string) → string\nFragment.prototype.textBetween = function textBetween (from, to, blockSeparator, leafText) {\n  var text = \"\", separated = true;\n  this.nodesBetween(from, to, function (node, pos) {\n    if (node.isText) {\n      text += node.text.slice(Math.max(from, pos) - pos, to - pos);\n      separated = !blockSeparator;\n    } else if (node.isLeaf && leafText) {\n      text += leafText;\n      separated = !blockSeparator;\n    } else if (!separated && node.isBlock) {\n      text += blockSeparator;\n      separated = true;\n    }\n  }, 0);\n  return text\n};\n\n// :: (Fragment) → Fragment\n// Create a new fragment containing the combined content of this\n// fragment and the other.\nFragment.prototype.append = function append (other) {\n  if (!other.size) { return this }\n  if (!this.size) { return other }\n  var last = this.lastChild, first = other.firstChild, content = this.content.slice(), i = 0;\n  if (last.isText && last.sameMarkup(first)) {\n    content[content.length - 1] = last.withText(last.text + first.text);\n    i = 1;\n  }\n  for (; i < other.content.length; i++) { content.push(other.content[i]); }\n  return new Fragment(content, this.size + other.size)\n};\n\n// :: (number, ?number) → Fragment\n// Cut out the sub-fragment between the two given positions.\nFragment.prototype.cut = function cut (from, to) {\n  if (to == null) { to = this.size; }\n  if (from == 0 && to == this.size) { return this }\n  var result = [], size = 0;\n  if (to > from) { for (var i = 0, pos = 0; pos < to; i++) {\n    var child = this.content[i], end = pos + child.nodeSize;\n    if (end > from) {\n      if (pos < from || end > to) {\n        if (child.isText)\n          { child = child.cut(Math.max(0, from - pos), Math.min(child.text.length, to - pos)); }\n        else\n          { child = child.cut(Math.max(0, from - pos - 1), Math.min(child.content.size, to - pos - 1)); }\n      }\n      result.push(child);\n      size += child.nodeSize;\n    }\n    pos = end;\n  } }\n  return new Fragment(result, size)\n};\n\nFragment.prototype.cutByIndex = function cutByIndex (from, to) {\n  if (from == to) { return Fragment.empty }\n  if (from == 0 && to == this.content.length) { return this }\n  return new Fragment(this.content.slice(from, to))\n};\n\n// :: (number, Node) → Fragment\n// Create a new fragment in which the node at the given index is\n// replaced by the given node.\nFragment.prototype.replaceChild = function replaceChild (index, node) {\n  var current = this.content[index];\n  if (current == node) { return this }\n  var copy = this.content.slice();\n  var size = this.size + node.nodeSize - current.nodeSize;\n  copy[index] = node;\n  return new Fragment(copy, size)\n};\n\n// : (Node) → Fragment\n// Create a new fragment by prepending the given node to this\n// fragment.\nFragment.prototype.addToStart = function addToStart (node) {\n  return new Fragment([node].concat(this.content), this.size + node.nodeSize)\n};\n\n// : (Node) → Fragment\n// Create a new fragment by appending the given node to this\n// fragment.\nFragment.prototype.addToEnd = function addToEnd (node) {\n  return new Fragment(this.content.concat(node), this.size + node.nodeSize)\n};\n\n// :: (Fragment) → bool\n// Compare this fragment to another one.\nFragment.prototype.eq = function eq (other) {\n  if (this.content.length != other.content.length) { return false }\n  for (var i = 0; i < this.content.length; i++)\n    { if (!this.content[i].eq(other.content[i])) { return false } }\n  return true\n};\n\n// :: ?Node\n// The first child of the fragment, or `null` if it is empty.\nprototypeAccessors.firstChild.get = function () { return this.content.length ? this.content[0] : null };\n\n// :: ?Node\n// The last child of the fragment, or `null` if it is empty.\nprototypeAccessors.lastChild.get = function () { return this.content.length ? this.content[this.content.length - 1] : null };\n\n// :: number\n// The number of child nodes in this fragment.\nprototypeAccessors.childCount.get = function () { return this.content.length };\n\n// :: (number) → Node\n// Get the child node at the given index. Raise an error when the\n// index is out of range.\nFragment.prototype.child = function child (index) {\n  var found = this.content[index];\n  if (!found) { throw new RangeError(\"Index \" + index + \" out of range for \" + this) }\n  return found\n};\n\n// :: (number) → ?Node\n// Get the child node at the given index, if it exists.\nFragment.prototype.maybeChild = function maybeChild (index) {\n  return this.content[index]\n};\n\n// :: ((node: Node, offset: number, index: number))\n// Call `f` for every child node, passing the node, its offset\n// into this parent node, and its index.\nFragment.prototype.forEach = function forEach (f) {\n  for (var i = 0, p = 0; i < this.content.length; i++) {\n    var child = this.content[i];\n    f(child, p, i);\n    p += child.nodeSize;\n  }\n};\n\n// :: (Fragment) → ?number\n// Find the first position at which this fragment and another\n// fragment differ, or `null` if they are the same.\nFragment.prototype.findDiffStart = function findDiffStart$1 (other, pos) {\n    if ( pos === void 0 ) pos = 0;\n\n  return findDiffStart(this, other, pos)\n};\n\n// :: (Fragment) → ?{a: number, b: number}\n// Find the first position, searching from the end, at which this\n// fragment and the given fragment differ, or `null` if they are the\n// same. Since this position will not be the same in both nodes, an\n// object with two separate positions is returned.\nFragment.prototype.findDiffEnd = function findDiffEnd$1 (other, pos, otherPos) {\n    if ( pos === void 0 ) pos = this.size;\n    if ( otherPos === void 0 ) otherPos = other.size;\n\n  return findDiffEnd(this, other, pos, otherPos)\n};\n\n// : (number, ?number) → {index: number, offset: number}\n// Find the index and inner offset corresponding to a given relative\n// position in this fragment. The result object will be reused\n// (overwritten) the next time the function is called. (Not public.)\nFragment.prototype.findIndex = function findIndex (pos, round) {\n    if ( round === void 0 ) round = -1;\n\n  if (pos == 0) { return retIndex(0, pos) }\n  if (pos == this.size) { return retIndex(this.content.length, pos) }\n  if (pos > this.size || pos < 0) { throw new RangeError((\"Position \" + pos + \" outside of fragment (\" + (this) + \")\")) }\n  for (var i = 0, curPos = 0;; i++) {\n    var cur = this.child(i), end = curPos + cur.nodeSize;\n    if (end >= pos) {\n      if (end == pos || round > 0) { return retIndex(i + 1, end) }\n      return retIndex(i, curPos)\n    }\n    curPos = end;\n  }\n};\n\n// :: () → string\n// Return a debugging string that describes this fragment.\nFragment.prototype.toString = function toString () { return \"<\" + this.toStringInner() + \">\" };\n\nFragment.prototype.toStringInner = function toStringInner () { return this.content.join(\", \") };\n\n// :: () → ?Object\n// Create a JSON-serializeable representation of this fragment.\nFragment.prototype.toJSON = function toJSON () {\n  return this.content.length ? this.content.map(function (n) { return n.toJSON(); }) : null\n};\n\n// :: (Schema, ?Object) → Fragment\n// Deserialize a fragment from its JSON representation.\nFragment.fromJSON = function fromJSON (schema, value) {\n  if (!value) { return Fragment.empty }\n  if (!Array.isArray(value)) { throw new RangeError(\"Invalid input for Fragment.fromJSON\") }\n  return new Fragment(value.map(schema.nodeFromJSON))\n};\n\n// :: ([Node]) → Fragment\n// Build a fragment from an array of nodes. Ensures that adjacent\n// text nodes with the same marks are joined together.\nFragment.fromArray = function fromArray (array) {\n  if (!array.length) { return Fragment.empty }\n  var joined, size = 0;\n  for (var i = 0; i < array.length; i++) {\n    var node = array[i];\n    size += node.nodeSize;\n    if (i && node.isText && array[i - 1].sameMarkup(node)) {\n      if (!joined) { joined = array.slice(0, i); }\n      joined[joined.length - 1] = node.withText(joined[joined.length - 1].text + node.text);\n    } else if (joined) {\n      joined.push(node);\n    }\n  }\n  return new Fragment(joined || array, size)\n};\n\n// :: (?union<Fragment, Node, [Node]>) → Fragment\n// Create a fragment from something that can be interpreted as a set\n// of nodes. For `null`, it returns the empty fragment. For a\n// fragment, the fragment itself. For a node or array of nodes, a\n// fragment containing those nodes.\nFragment.from = function from (nodes) {\n  if (!nodes) { return Fragment.empty }\n  if (nodes instanceof Fragment) { return nodes }\n  if (Array.isArray(nodes)) { return this.fromArray(nodes) }\n  if (nodes.attrs) { return new Fragment([nodes], nodes.nodeSize) }\n  throw new RangeError(\"Can not convert \" + nodes + \" to a Fragment\" +\n                       (nodes.nodesBetween ? \" (looks like multiple versions of prosemirror-model were loaded)\" : \"\"))\n};\n\nObject.defineProperties( Fragment.prototype, prototypeAccessors );\n\nvar found = {index: 0, offset: 0};\nfunction retIndex(index, offset) {\n  found.index = index;\n  found.offset = offset;\n  return found\n}\n\n// :: Fragment\n// An empty fragment. Intended to be reused whenever a node doesn't\n// contain anything (rather than allocating a new empty fragment for\n// each leaf node).\nFragment.empty = new Fragment([], 0);\n\nfunction compareDeep(a, b) {\n  if (a === b) { return true }\n  if (!(a && typeof a == \"object\") ||\n      !(b && typeof b == \"object\")) { return false }\n  var array = Array.isArray(a);\n  if (Array.isArray(b) != array) { return false }\n  if (array) {\n    if (a.length != b.length) { return false }\n    for (var i = 0; i < a.length; i++) { if (!compareDeep(a[i], b[i])) { return false } }\n  } else {\n    for (var p in a) { if (!(p in b) || !compareDeep(a[p], b[p])) { return false } }\n    for (var p$1 in b) { if (!(p$1 in a)) { return false } }\n  }\n  return true\n}\n\n// ::- A mark is a piece of information that can be attached to a node,\n// such as it being emphasized, in code font, or a link. It has a type\n// and optionally a set of attributes that provide further information\n// (such as the target of the link). Marks are created through a\n// `Schema`, which controls which types exist and which\n// attributes they have.\nvar Mark = function Mark(type, attrs) {\n  // :: MarkType\n  // The type of this mark.\n  this.type = type;\n  // :: Object\n  // The attributes associated with this mark.\n  this.attrs = attrs;\n};\n\n// :: ([Mark]) → [Mark]\n// Given a set of marks, create a new set which contains this one as\n// well, in the right position. If this mark is already in the set,\n// the set itself is returned. If any marks that are set to be\n// [exclusive](#model.MarkSpec.excludes) with this mark are present,\n// those are replaced by this one.\nMark.prototype.addToSet = function addToSet (set) {\n  var copy, placed = false;\n  for (var i = 0; i < set.length; i++) {\n    var other = set[i];\n    if (this.eq(other)) { return set }\n    if (this.type.excludes(other.type)) {\n      if (!copy) { copy = set.slice(0, i); }\n    } else if (other.type.excludes(this.type)) {\n      return set\n    } else {\n      if (!placed && other.type.rank > this.type.rank) {\n        if (!copy) { copy = set.slice(0, i); }\n        copy.push(this);\n        placed = true;\n      }\n      if (copy) { copy.push(other); }\n    }\n  }\n  if (!copy) { copy = set.slice(); }\n  if (!placed) { copy.push(this); }\n  return copy\n};\n\n// :: ([Mark]) → [Mark]\n// Remove this mark from the given set, returning a new set. If this\n// mark is not in the set, the set itself is returned.\nMark.prototype.removeFromSet = function removeFromSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (this.eq(set[i]))\n      { return set.slice(0, i).concat(set.slice(i + 1)) } }\n  return set\n};\n\n// :: ([Mark]) → bool\n// Test whether this mark is in the given set of marks.\nMark.prototype.isInSet = function isInSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (this.eq(set[i])) { return true } }\n  return false\n};\n\n// :: (Mark) → bool\n// Test whether this mark has the same type and attributes as\n// another mark.\nMark.prototype.eq = function eq (other) {\n  return this == other ||\n    (this.type == other.type && compareDeep(this.attrs, other.attrs))\n};\n\n// :: () → Object\n// Convert this mark to a JSON-serializeable representation.\nMark.prototype.toJSON = function toJSON () {\n  var obj = {type: this.type.name};\n  for (var _ in this.attrs) {\n    obj.attrs = this.attrs;\n    break\n  }\n  return obj\n};\n\n// :: (Schema, Object) → Mark\nMark.fromJSON = function fromJSON (schema, json) {\n  if (!json) { throw new RangeError(\"Invalid input for Mark.fromJSON\") }\n  var type = schema.marks[json.type];\n  if (!type) { throw new RangeError((\"There is no mark type \" + (json.type) + \" in this schema\")) }\n  return type.create(json.attrs)\n};\n\n// :: ([Mark], [Mark]) → bool\n// Test whether two sets of marks are identical.\nMark.sameSet = function sameSet (a, b) {\n  if (a == b) { return true }\n  if (a.length != b.length) { return false }\n  for (var i = 0; i < a.length; i++)\n    { if (!a[i].eq(b[i])) { return false } }\n  return true\n};\n\n// :: (?union<Mark, [Mark]>) → [Mark]\n// Create a properly sorted mark set from null, a single mark, or an\n// unsorted array of marks.\nMark.setFrom = function setFrom (marks) {\n  if (!marks || marks.length == 0) { return Mark.none }\n  if (marks instanceof Mark) { return [marks] }\n  var copy = marks.slice();\n  copy.sort(function (a, b) { return a.type.rank - b.type.rank; });\n  return copy\n};\n\n// :: [Mark] The empty set of marks.\nMark.none = [];\n\n// ReplaceError:: class extends Error\n// Error type raised by [`Node.replace`](#model.Node.replace) when\n// given an invalid replacement.\n\nfunction ReplaceError(message) {\n  var err = Error.call(this, message);\n  err.__proto__ = ReplaceError.prototype;\n  return err\n}\n\nReplaceError.prototype = Object.create(Error.prototype);\nReplaceError.prototype.constructor = ReplaceError;\nReplaceError.prototype.name = \"ReplaceError\";\n\n// ::- A slice represents a piece cut out of a larger document. It\n// stores not only a fragment, but also the depth up to which nodes on\n// both side are ‘open’ (cut through).\nvar Slice = function Slice(content, openStart, openEnd) {\n  // :: Fragment The slice's content.\n  this.content = content;\n  // :: number The open depth at the start.\n  this.openStart = openStart;\n  // :: number The open depth at the end.\n  this.openEnd = openEnd;\n};\n\nvar prototypeAccessors$1 = { size: { configurable: true } };\n\n// :: number\n// The size this slice would add when inserted into a document.\nprototypeAccessors$1.size.get = function () {\n  return this.content.size - this.openStart - this.openEnd\n};\n\nSlice.prototype.insertAt = function insertAt (pos, fragment) {\n  var content = insertInto(this.content, pos + this.openStart, fragment, null);\n  return content && new Slice(content, this.openStart, this.openEnd)\n};\n\nSlice.prototype.removeBetween = function removeBetween (from, to) {\n  return new Slice(removeRange(this.content, from + this.openStart, to + this.openStart), this.openStart, this.openEnd)\n};\n\n// :: (Slice) → bool\n// Tests whether this slice is equal to another slice.\nSlice.prototype.eq = function eq (other) {\n  return this.content.eq(other.content) && this.openStart == other.openStart && this.openEnd == other.openEnd\n};\n\nSlice.prototype.toString = function toString () {\n  return this.content + \"(\" + this.openStart + \",\" + this.openEnd + \")\"\n};\n\n// :: () → ?Object\n// Convert a slice to a JSON-serializable representation.\nSlice.prototype.toJSON = function toJSON () {\n  if (!this.content.size) { return null }\n  var json = {content: this.content.toJSON()};\n  if (this.openStart > 0) { json.openStart = this.openStart; }\n  if (this.openEnd > 0) { json.openEnd = this.openEnd; }\n  return json\n};\n\n// :: (Schema, ?Object) → Slice\n// Deserialize a slice from its JSON representation.\nSlice.fromJSON = function fromJSON (schema, json) {\n  if (!json) { return Slice.empty }\n  var openStart = json.openStart || 0, openEnd = json.openEnd || 0;\n  if (typeof openStart != \"number\" || typeof openEnd != \"number\")\n    { throw new RangeError(\"Invalid input for Slice.fromJSON\") }\n  return new Slice(Fragment.fromJSON(schema, json.content), openStart, openEnd)\n};\n\n// :: (Fragment, ?bool) → Slice\n// Create a slice from a fragment by taking the maximum possible\n// open value on both side of the fragment.\nSlice.maxOpen = function maxOpen (fragment, openIsolating) {\n    if ( openIsolating === void 0 ) openIsolating=true;\n\n  var openStart = 0, openEnd = 0;\n  for (var n = fragment.firstChild; n && !n.isLeaf && (openIsolating || !n.type.spec.isolating); n = n.firstChild) { openStart++; }\n  for (var n$1 = fragment.lastChild; n$1 && !n$1.isLeaf && (openIsolating || !n$1.type.spec.isolating); n$1 = n$1.lastChild) { openEnd++; }\n  return new Slice(fragment, openStart, openEnd)\n};\n\nObject.defineProperties( Slice.prototype, prototypeAccessors$1 );\n\nfunction removeRange(content, from, to) {\n  var ref = content.findIndex(from);\n  var index = ref.index;\n  var offset = ref.offset;\n  var child = content.maybeChild(index);\n  var ref$1 = content.findIndex(to);\n  var indexTo = ref$1.index;\n  var offsetTo = ref$1.offset;\n  if (offset == from || child.isText) {\n    if (offsetTo != to && !content.child(indexTo).isText) { throw new RangeError(\"Removing non-flat range\") }\n    return content.cut(0, from).append(content.cut(to))\n  }\n  if (index != indexTo) { throw new RangeError(\"Removing non-flat range\") }\n  return content.replaceChild(index, child.copy(removeRange(child.content, from - offset - 1, to - offset - 1)))\n}\n\nfunction insertInto(content, dist, insert, parent) {\n  var ref = content.findIndex(dist);\n  var index = ref.index;\n  var offset = ref.offset;\n  var child = content.maybeChild(index);\n  if (offset == dist || child.isText) {\n    if (parent && !parent.canReplace(index, index, insert)) { return null }\n    return content.cut(0, dist).append(insert).append(content.cut(dist))\n  }\n  var inner = insertInto(child.content, dist - offset - 1, insert);\n  return inner && content.replaceChild(index, child.copy(inner))\n}\n\n// :: Slice\n// The empty slice.\nSlice.empty = new Slice(Fragment.empty, 0, 0);\n\nfunction replace($from, $to, slice) {\n  if (slice.openStart > $from.depth)\n    { throw new ReplaceError(\"Inserted content deeper than insertion position\") }\n  if ($from.depth - slice.openStart != $to.depth - slice.openEnd)\n    { throw new ReplaceError(\"Inconsistent open depths\") }\n  return replaceOuter($from, $to, slice, 0)\n}\n\nfunction replaceOuter($from, $to, slice, depth) {\n  var index = $from.index(depth), node = $from.node(depth);\n  if (index == $to.index(depth) && depth < $from.depth - slice.openStart) {\n    var inner = replaceOuter($from, $to, slice, depth + 1);\n    return node.copy(node.content.replaceChild(index, inner))\n  } else if (!slice.content.size) {\n    return close(node, replaceTwoWay($from, $to, depth))\n  } else if (!slice.openStart && !slice.openEnd && $from.depth == depth && $to.depth == depth) { // Simple, flat case\n    var parent = $from.parent, content = parent.content;\n    return close(parent, content.cut(0, $from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))\n  } else {\n    var ref = prepareSliceForReplace(slice, $from);\n    var start = ref.start;\n    var end = ref.end;\n    return close(node, replaceThreeWay($from, start, end, $to, depth))\n  }\n}\n\nfunction checkJoin(main, sub) {\n  if (!sub.type.compatibleContent(main.type))\n    { throw new ReplaceError(\"Cannot join \" + sub.type.name + \" onto \" + main.type.name) }\n}\n\nfunction joinable($before, $after, depth) {\n  var node = $before.node(depth);\n  checkJoin(node, $after.node(depth));\n  return node\n}\n\nfunction addNode(child, target) {\n  var last = target.length - 1;\n  if (last >= 0 && child.isText && child.sameMarkup(target[last]))\n    { target[last] = child.withText(target[last].text + child.text); }\n  else\n    { target.push(child); }\n}\n\nfunction addRange($start, $end, depth, target) {\n  var node = ($end || $start).node(depth);\n  var startIndex = 0, endIndex = $end ? $end.index(depth) : node.childCount;\n  if ($start) {\n    startIndex = $start.index(depth);\n    if ($start.depth > depth) {\n      startIndex++;\n    } else if ($start.textOffset) {\n      addNode($start.nodeAfter, target);\n      startIndex++;\n    }\n  }\n  for (var i = startIndex; i < endIndex; i++) { addNode(node.child(i), target); }\n  if ($end && $end.depth == depth && $end.textOffset)\n    { addNode($end.nodeBefore, target); }\n}\n\nfunction close(node, content) {\n  if (!node.type.validContent(content))\n    { throw new ReplaceError(\"Invalid content for node \" + node.type.name) }\n  return node.copy(content)\n}\n\nfunction replaceThreeWay($from, $start, $end, $to, depth) {\n  var openStart = $from.depth > depth && joinable($from, $start, depth + 1);\n  var openEnd = $to.depth > depth && joinable($end, $to, depth + 1);\n\n  var content = [];\n  addRange(null, $from, depth, content);\n  if (openStart && openEnd && $start.index(depth) == $end.index(depth)) {\n    checkJoin(openStart, openEnd);\n    addNode(close(openStart, replaceThreeWay($from, $start, $end, $to, depth + 1)), content);\n  } else {\n    if (openStart)\n      { addNode(close(openStart, replaceTwoWay($from, $start, depth + 1)), content); }\n    addRange($start, $end, depth, content);\n    if (openEnd)\n      { addNode(close(openEnd, replaceTwoWay($end, $to, depth + 1)), content); }\n  }\n  addRange($to, null, depth, content);\n  return new Fragment(content)\n}\n\nfunction replaceTwoWay($from, $to, depth) {\n  var content = [];\n  addRange(null, $from, depth, content);\n  if ($from.depth > depth) {\n    var type = joinable($from, $to, depth + 1);\n    addNode(close(type, replaceTwoWay($from, $to, depth + 1)), content);\n  }\n  addRange($to, null, depth, content);\n  return new Fragment(content)\n}\n\nfunction prepareSliceForReplace(slice, $along) {\n  var extra = $along.depth - slice.openStart, parent = $along.node(extra);\n  var node = parent.copy(slice.content);\n  for (var i = extra - 1; i >= 0; i--)\n    { node = $along.node(i).copy(Fragment.from(node)); }\n  return {start: node.resolveNoCache(slice.openStart + extra),\n          end: node.resolveNoCache(node.content.size - slice.openEnd - extra)}\n}\n\n// ::- You can [_resolve_](#model.Node.resolve) a position to get more\n// information about it. Objects of this class represent such a\n// resolved position, providing various pieces of context information,\n// and some helper methods.\n//\n// Throughout this interface, methods that take an optional `depth`\n// parameter will interpret undefined as `this.depth` and negative\n// numbers as `this.depth + value`.\nvar ResolvedPos = function ResolvedPos(pos, path, parentOffset) {\n  // :: number The position that was resolved.\n  this.pos = pos;\n  this.path = path;\n  // :: number\n  // The number of levels the parent node is from the root. If this\n  // position points directly into the root node, it is 0. If it\n  // points into a top-level paragraph, 1, and so on.\n  this.depth = path.length / 3 - 1;\n  // :: number The offset this position has into its parent node.\n  this.parentOffset = parentOffset;\n};\n\nvar prototypeAccessors$2 = { parent: { configurable: true },doc: { configurable: true },textOffset: { configurable: true },nodeAfter: { configurable: true },nodeBefore: { configurable: true } };\n\nResolvedPos.prototype.resolveDepth = function resolveDepth (val) {\n  if (val == null) { return this.depth }\n  if (val < 0) { return this.depth + val }\n  return val\n};\n\n// :: Node\n// The parent node that the position points into. Note that even if\n// a position points into a text node, that node is not considered\n// the parent—text nodes are ‘flat’ in this model, and have no content.\nprototypeAccessors$2.parent.get = function () { return this.node(this.depth) };\n\n// :: Node\n// The root node in which the position was resolved.\nprototypeAccessors$2.doc.get = function () { return this.node(0) };\n\n// :: (?number) → Node\n// The ancestor node at the given level. `p.node(p.depth)` is the\n// same as `p.parent`.\nResolvedPos.prototype.node = function node (depth) { return this.path[this.resolveDepth(depth) * 3] };\n\n// :: (?number) → number\n// The index into the ancestor at the given level. If this points at\n// the 3rd node in the 2nd paragraph on the top level, for example,\n// `p.index(0)` is 1 and `p.index(1)` is 2.\nResolvedPos.prototype.index = function index (depth) { return this.path[this.resolveDepth(depth) * 3 + 1] };\n\n// :: (?number) → number\n// The index pointing after this position into the ancestor at the\n// given level.\nResolvedPos.prototype.indexAfter = function indexAfter (depth) {\n  depth = this.resolveDepth(depth);\n  return this.index(depth) + (depth == this.depth && !this.textOffset ? 0 : 1)\n};\n\n// :: (?number) → number\n// The (absolute) position at the start of the node at the given\n// level.\nResolvedPos.prototype.start = function start (depth) {\n  depth = this.resolveDepth(depth);\n  return depth == 0 ? 0 : this.path[depth * 3 - 1] + 1\n};\n\n// :: (?number) → number\n// The (absolute) position at the end of the node at the given\n// level.\nResolvedPos.prototype.end = function end (depth) {\n  depth = this.resolveDepth(depth);\n  return this.start(depth) + this.node(depth).content.size\n};\n\n// :: (?number) → number\n// The (absolute) position directly before the wrapping node at the\n// given level, or, when `depth` is `this.depth + 1`, the original\n// position.\nResolvedPos.prototype.before = function before (depth) {\n  depth = this.resolveDepth(depth);\n  if (!depth) { throw new RangeError(\"There is no position before the top-level node\") }\n  return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1]\n};\n\n// :: (?number) → number\n// The (absolute) position directly after the wrapping node at the\n// given level, or the original position when `depth` is `this.depth + 1`.\nResolvedPos.prototype.after = function after (depth) {\n  depth = this.resolveDepth(depth);\n  if (!depth) { throw new RangeError(\"There is no position after the top-level node\") }\n  return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1] + this.path[depth * 3].nodeSize\n};\n\n// :: number\n// When this position points into a text node, this returns the\n// distance between the position and the start of the text node.\n// Will be zero for positions that point between nodes.\nprototypeAccessors$2.textOffset.get = function () { return this.pos - this.path[this.path.length - 1] };\n\n// :: ?Node\n// Get the node directly after the position, if any. If the position\n// points into a text node, only the part of that node after the\n// position is returned.\nprototypeAccessors$2.nodeAfter.get = function () {\n  var parent = this.parent, index = this.index(this.depth);\n  if (index == parent.childCount) { return null }\n  var dOff = this.pos - this.path[this.path.length - 1], child = parent.child(index);\n  return dOff ? parent.child(index).cut(dOff) : child\n};\n\n// :: ?Node\n// Get the node directly before the position, if any. If the\n// position points into a text node, only the part of that node\n// before the position is returned.\nprototypeAccessors$2.nodeBefore.get = function () {\n  var index = this.index(this.depth);\n  var dOff = this.pos - this.path[this.path.length - 1];\n  if (dOff) { return this.parent.child(index).cut(0, dOff) }\n  return index == 0 ? null : this.parent.child(index - 1)\n};\n\n// :: (number, ?number) → number\n// Get the position at the given index in the parent node at the\n// given depth (which defaults to `this.depth`).\nResolvedPos.prototype.posAtIndex = function posAtIndex (index, depth) {\n  depth = this.resolveDepth(depth);\n  var node = this.path[depth * 3], pos = depth == 0 ? 0 : this.path[depth * 3 - 1] + 1;\n  for (var i = 0; i < index; i++) { pos += node.child(i).nodeSize; }\n  return pos\n};\n\n// :: () → [Mark]\n// Get the marks at this position, factoring in the surrounding\n// marks' [`inclusive`](#model.MarkSpec.inclusive) property. If the\n// position is at the start of a non-empty node, the marks of the\n// node after it (if any) are returned.\nResolvedPos.prototype.marks = function marks () {\n  var parent = this.parent, index = this.index();\n\n  // In an empty parent, return the empty array\n  if (parent.content.size == 0) { return Mark.none }\n\n  // When inside a text node, just return the text node's marks\n  if (this.textOffset) { return parent.child(index).marks }\n\n  var main = parent.maybeChild(index - 1), other = parent.maybeChild(index);\n  // If the `after` flag is true of there is no node before, make\n  // the node after this position the main reference.\n  if (!main) { var tmp = main; main = other; other = tmp; }\n\n  // Use all marks in the main node, except those that have\n  // `inclusive` set to false and are not present in the other node.\n  var marks = main.marks;\n  for (var i = 0; i < marks.length; i++)\n    { if (marks[i].type.spec.inclusive === false && (!other || !marks[i].isInSet(other.marks)))\n      { marks = marks[i--].removeFromSet(marks); } }\n\n  return marks\n};\n\n// :: (ResolvedPos) → ?[Mark]\n// Get the marks after the current position, if any, except those\n// that are non-inclusive and not present at position `$end`. This\n// is mostly useful for getting the set of marks to preserve after a\n// deletion. Will return `null` if this position is at the end of\n// its parent node or its parent node isn't a textblock (in which\n// case no marks should be preserved).\nResolvedPos.prototype.marksAcross = function marksAcross ($end) {\n  var after = this.parent.maybeChild(this.index());\n  if (!after || !after.isInline) { return null }\n\n  var marks = after.marks, next = $end.parent.maybeChild($end.index());\n  for (var i = 0; i < marks.length; i++)\n    { if (marks[i].type.spec.inclusive === false && (!next || !marks[i].isInSet(next.marks)))\n      { marks = marks[i--].removeFromSet(marks); } }\n  return marks\n};\n\n// :: (number) → number\n// The depth up to which this position and the given (non-resolved)\n// position share the same parent nodes.\nResolvedPos.prototype.sharedDepth = function sharedDepth (pos) {\n  for (var depth = this.depth; depth > 0; depth--)\n    { if (this.start(depth) <= pos && this.end(depth) >= pos) { return depth } }\n  return 0\n};\n\n// :: (?ResolvedPos, ?(Node) → bool) → ?NodeRange\n// Returns a range based on the place where this position and the\n// given position diverge around block content. If both point into\n// the same textblock, for example, a range around that textblock\n// will be returned. If they point into different blocks, the range\n// around those blocks in their shared ancestor is returned. You can\n// pass in an optional predicate that will be called with a parent\n// node to see if a range into that parent is acceptable.\nResolvedPos.prototype.blockRange = function blockRange (other, pred) {\n    if ( other === void 0 ) other = this;\n\n  if (other.pos < this.pos) { return other.blockRange(this) }\n  for (var d = this.depth - (this.parent.inlineContent || this.pos == other.pos ? 1 : 0); d >= 0; d--)\n    { if (other.pos <= this.end(d) && (!pred || pred(this.node(d))))\n      { return new NodeRange(this, other, d) } }\n};\n\n// :: (ResolvedPos) → bool\n// Query whether the given position shares the same parent node.\nResolvedPos.prototype.sameParent = function sameParent (other) {\n  return this.pos - this.parentOffset == other.pos - other.parentOffset\n};\n\n// :: (ResolvedPos) → ResolvedPos\n// Return the greater of this and the given position.\nResolvedPos.prototype.max = function max (other) {\n  return other.pos > this.pos ? other : this\n};\n\n// :: (ResolvedPos) → ResolvedPos\n// Return the smaller of this and the given position.\nResolvedPos.prototype.min = function min (other) {\n  return other.pos < this.pos ? other : this\n};\n\nResolvedPos.prototype.toString = function toString () {\n  var str = \"\";\n  for (var i = 1; i <= this.depth; i++)\n    { str += (str ? \"/\" : \"\") + this.node(i).type.name + \"_\" + this.index(i - 1); }\n  return str + \":\" + this.parentOffset\n};\n\nResolvedPos.resolve = function resolve (doc, pos) {\n  if (!(pos >= 0 && pos <= doc.content.size)) { throw new RangeError(\"Position \" + pos + \" out of range\") }\n  var path = [];\n  var start = 0, parentOffset = pos;\n  for (var node = doc;;) {\n    var ref = node.content.findIndex(parentOffset);\n      var index = ref.index;\n      var offset = ref.offset;\n    var rem = parentOffset - offset;\n    path.push(node, index, start + offset);\n    if (!rem) { break }\n    node = node.child(index);\n    if (node.isText) { break }\n    parentOffset = rem - 1;\n    start += offset + 1;\n  }\n  return new ResolvedPos(pos, path, parentOffset)\n};\n\nResolvedPos.resolveCached = function resolveCached (doc, pos) {\n  for (var i = 0; i < resolveCache.length; i++) {\n    var cached = resolveCache[i];\n    if (cached.pos == pos && cached.doc == doc) { return cached }\n  }\n  var result = resolveCache[resolveCachePos] = ResolvedPos.resolve(doc, pos);\n  resolveCachePos = (resolveCachePos + 1) % resolveCacheSize;\n  return result\n};\n\nObject.defineProperties( ResolvedPos.prototype, prototypeAccessors$2 );\n\nvar resolveCache = [], resolveCachePos = 0, resolveCacheSize = 12;\n\n// ::- Represents a flat range of content, i.e. one that starts and\n// ends in the same node.\nvar NodeRange = function NodeRange($from, $to, depth) {\n  // :: ResolvedPos A resolved position along the start of the\n  // content. May have a `depth` greater than this object's `depth`\n  // property, since these are the positions that were used to\n  // compute the range, not re-resolved positions directly at its\n  // boundaries.\n  this.$from = $from;\n  // :: ResolvedPos A position along the end of the content. See\n  // caveat for [`$from`](#model.NodeRange.$from).\n  this.$to = $to;\n  // :: number The depth of the node that this range points into.\n  this.depth = depth;\n};\n\nvar prototypeAccessors$1$1 = { start: { configurable: true },end: { configurable: true },parent: { configurable: true },startIndex: { configurable: true },endIndex: { configurable: true } };\n\n// :: number The position at the start of the range.\nprototypeAccessors$1$1.start.get = function () { return this.$from.before(this.depth + 1) };\n// :: number The position at the end of the range.\nprototypeAccessors$1$1.end.get = function () { return this.$to.after(this.depth + 1) };\n\n// :: Node The parent node that the range points into.\nprototypeAccessors$1$1.parent.get = function () { return this.$from.node(this.depth) };\n// :: number The start index of the range in the parent node.\nprototypeAccessors$1$1.startIndex.get = function () { return this.$from.index(this.depth) };\n// :: number The end index of the range in the parent node.\nprototypeAccessors$1$1.endIndex.get = function () { return this.$to.indexAfter(this.depth) };\n\nObject.defineProperties( NodeRange.prototype, prototypeAccessors$1$1 );\n\nvar emptyAttrs = Object.create(null);\n\n// ::- This class represents a node in the tree that makes up a\n// ProseMirror document. So a document is an instance of `Node`, with\n// children that are also instances of `Node`.\n//\n// Nodes are persistent data structures. Instead of changing them, you\n// create new ones with the content you want. Old ones keep pointing\n// at the old document shape. This is made cheaper by sharing\n// structure between the old and new data as much as possible, which a\n// tree shape like this (without back pointers) makes easy.\n//\n// **Do not** directly mutate the properties of a `Node` object. See\n// [the guide](/docs/guide/#doc) for more information.\nvar Node = function Node(type, attrs, content, marks) {\n  // :: NodeType\n  // The type of node that this is.\n  this.type = type;\n\n  // :: Object\n  // An object mapping attribute names to values. The kind of\n  // attributes allowed and required are\n  // [determined](#model.NodeSpec.attrs) by the node type.\n  this.attrs = attrs;\n\n  // :: Fragment\n  // A container holding the node's children.\n  this.content = content || Fragment.empty;\n\n  // :: [Mark]\n  // The marks (things like whether it is emphasized or part of a\n  // link) applied to this node.\n  this.marks = marks || Mark.none;\n};\n\nvar prototypeAccessors$3 = { nodeSize: { configurable: true },childCount: { configurable: true },textContent: { configurable: true },firstChild: { configurable: true },lastChild: { configurable: true },isBlock: { configurable: true },isTextblock: { configurable: true },inlineContent: { configurable: true },isInline: { configurable: true },isText: { configurable: true },isLeaf: { configurable: true },isAtom: { configurable: true } };\n\n// text:: ?string\n// For text nodes, this contains the node's text content.\n\n// :: number\n// The size of this node, as defined by the integer-based [indexing\n// scheme](/docs/guide/#doc.indexing). For text nodes, this is the\n// amount of characters. For other leaf nodes, it is one. For\n// non-leaf nodes, it is the size of the content plus two (the start\n// and end token).\nprototypeAccessors$3.nodeSize.get = function () { return this.isLeaf ? 1 : 2 + this.content.size };\n\n// :: number\n// The number of children that the node has.\nprototypeAccessors$3.childCount.get = function () { return this.content.childCount };\n\n// :: (number) → Node\n// Get the child node at the given index. Raises an error when the\n// index is out of range.\nNode.prototype.child = function child (index) { return this.content.child(index) };\n\n// :: (number) → ?Node\n// Get the child node at the given index, if it exists.\nNode.prototype.maybeChild = function maybeChild (index) { return this.content.maybeChild(index) };\n\n// :: ((node: Node, offset: number, index: number))\n// Call `f` for every child node, passing the node, its offset\n// into this parent node, and its index.\nNode.prototype.forEach = function forEach (f) { this.content.forEach(f); };\n\n// :: (number, number, (node: Node, pos: number, parent: Node, index: number) → ?bool, ?number)\n// Invoke a callback for all descendant nodes recursively between\n// the given two positions that are relative to start of this node's\n// content. The callback is invoked with the node, its\n// parent-relative position, its parent node, and its child index.\n// When the callback returns false for a given node, that node's\n// children will not be recursed over. The last parameter can be\n// used to specify a starting position to count from.\nNode.prototype.nodesBetween = function nodesBetween (from, to, f, startPos) {\n    if ( startPos === void 0 ) startPos = 0;\n\n  this.content.nodesBetween(from, to, f, startPos, this);\n};\n\n// :: ((node: Node, pos: number, parent: Node) → ?bool)\n// Call the given callback for every descendant node. Doesn't\n// descend into a node when the callback returns `false`.\nNode.prototype.descendants = function descendants (f) {\n  this.nodesBetween(0, this.content.size, f);\n};\n\n// :: string\n// Concatenates all the text nodes found in this fragment and its\n// children.\nprototypeAccessors$3.textContent.get = function () { return this.textBetween(0, this.content.size, \"\") };\n\n// :: (number, number, ?string, ?string) → string\n// Get all text between positions `from` and `to`. When\n// `blockSeparator` is given, it will be inserted whenever a new\n// block node is started. When `leafText` is given, it'll be\n// inserted for every non-text leaf node encountered.\nNode.prototype.textBetween = function textBetween (from, to, blockSeparator, leafText) {\n  return this.content.textBetween(from, to, blockSeparator, leafText)\n};\n\n// :: ?Node\n// Returns this node's first child, or `null` if there are no\n// children.\nprototypeAccessors$3.firstChild.get = function () { return this.content.firstChild };\n\n// :: ?Node\n// Returns this node's last child, or `null` if there are no\n// children.\nprototypeAccessors$3.lastChild.get = function () { return this.content.lastChild };\n\n// :: (Node) → bool\n// Test whether two nodes represent the same piece of document.\nNode.prototype.eq = function eq (other) {\n  return this == other || (this.sameMarkup(other) && this.content.eq(other.content))\n};\n\n// :: (Node) → bool\n// Compare the markup (type, attributes, and marks) of this node to\n// those of another. Returns `true` if both have the same markup.\nNode.prototype.sameMarkup = function sameMarkup (other) {\n  return this.hasMarkup(other.type, other.attrs, other.marks)\n};\n\n// :: (NodeType, ?Object, ?[Mark]) → bool\n// Check whether this node's markup correspond to the given type,\n// attributes, and marks.\nNode.prototype.hasMarkup = function hasMarkup (type, attrs, marks) {\n  return this.type == type &&\n    compareDeep(this.attrs, attrs || type.defaultAttrs || emptyAttrs) &&\n    Mark.sameSet(this.marks, marks || Mark.none)\n};\n\n// :: (?Fragment) → Node\n// Create a new node with the same markup as this node, containing\n// the given content (or empty, if no content is given).\nNode.prototype.copy = function copy (content) {\n    if ( content === void 0 ) content = null;\n\n  if (content == this.content) { return this }\n  return new this.constructor(this.type, this.attrs, content, this.marks)\n};\n\n// :: ([Mark]) → Node\n// Create a copy of this node, with the given set of marks instead\n// of the node's own marks.\nNode.prototype.mark = function mark (marks) {\n  return marks == this.marks ? this : new this.constructor(this.type, this.attrs, this.content, marks)\n};\n\n// :: (number, ?number) → Node\n// Create a copy of this node with only the content between the\n// given positions. If `to` is not given, it defaults to the end of\n// the node.\nNode.prototype.cut = function cut (from, to) {\n  if (from == 0 && to == this.content.size) { return this }\n  return this.copy(this.content.cut(from, to))\n};\n\n// :: (number, ?number) → Slice\n// Cut out the part of the document between the given positions, and\n// return it as a `Slice` object.\nNode.prototype.slice = function slice (from, to, includeParents) {\n    if ( to === void 0 ) to = this.content.size;\n    if ( includeParents === void 0 ) includeParents = false;\n\n  if (from == to) { return Slice.empty }\n\n  var $from = this.resolve(from), $to = this.resolve(to);\n  var depth = includeParents ? 0 : $from.sharedDepth(to);\n  var start = $from.start(depth), node = $from.node(depth);\n  var content = node.content.cut($from.pos - start, $to.pos - start);\n  return new Slice(content, $from.depth - depth, $to.depth - depth)\n};\n\n// :: (number, number, Slice) → Node\n// Replace the part of the document between the given positions with\n// the given slice. The slice must 'fit', meaning its open sides\n// must be able to connect to the surrounding content, and its\n// content nodes must be valid children for the node they are placed\n// into. If any of this is violated, an error of type\n// [`ReplaceError`](#model.ReplaceError) is thrown.\nNode.prototype.replace = function replace$1 (from, to, slice) {\n  return replace(this.resolve(from), this.resolve(to), slice)\n};\n\n// :: (number) → ?Node\n// Find the node directly after the given position.\nNode.prototype.nodeAt = function nodeAt (pos) {\n  for (var node = this;;) {\n    var ref = node.content.findIndex(pos);\n      var index = ref.index;\n      var offset = ref.offset;\n    node = node.maybeChild(index);\n    if (!node) { return null }\n    if (offset == pos || node.isText) { return node }\n    pos -= offset + 1;\n  }\n};\n\n// :: (number) → {node: ?Node, index: number, offset: number}\n// Find the (direct) child node after the given offset, if any,\n// and return it along with its index and offset relative to this\n// node.\nNode.prototype.childAfter = function childAfter (pos) {\n  var ref = this.content.findIndex(pos);\n    var index = ref.index;\n    var offset = ref.offset;\n  return {node: this.content.maybeChild(index), index: index, offset: offset}\n};\n\n// :: (number) → {node: ?Node, index: number, offset: number}\n// Find the (direct) child node before the given offset, if any,\n// and return it along with its index and offset relative to this\n// node.\nNode.prototype.childBefore = function childBefore (pos) {\n  if (pos == 0) { return {node: null, index: 0, offset: 0} }\n  var ref = this.content.findIndex(pos);\n    var index = ref.index;\n    var offset = ref.offset;\n  if (offset < pos) { return {node: this.content.child(index), index: index, offset: offset} }\n  var node = this.content.child(index - 1);\n  return {node: node, index: index - 1, offset: offset - node.nodeSize}\n};\n\n// :: (number) → ResolvedPos\n// Resolve the given position in the document, returning an\n// [object](#model.ResolvedPos) with information about its context.\nNode.prototype.resolve = function resolve (pos) { return ResolvedPos.resolveCached(this, pos) };\n\nNode.prototype.resolveNoCache = function resolveNoCache (pos) { return ResolvedPos.resolve(this, pos) };\n\n// :: (number, number, union<Mark, MarkType>) → bool\n// Test whether a given mark or mark type occurs in this document\n// between the two given positions.\nNode.prototype.rangeHasMark = function rangeHasMark (from, to, type) {\n  var found = false;\n  if (to > from) { this.nodesBetween(from, to, function (node) {\n    if (type.isInSet(node.marks)) { found = true; }\n    return !found\n  }); }\n  return found\n};\n\n// :: bool\n// True when this is a block (non-inline node)\nprototypeAccessors$3.isBlock.get = function () { return this.type.isBlock };\n\n// :: bool\n// True when this is a textblock node, a block node with inline\n// content.\nprototypeAccessors$3.isTextblock.get = function () { return this.type.isTextblock };\n\n// :: bool\n// True when this node allows inline content.\nprototypeAccessors$3.inlineContent.get = function () { return this.type.inlineContent };\n\n// :: bool\n// True when this is an inline node (a text node or a node that can\n// appear among text).\nprototypeAccessors$3.isInline.get = function () { return this.type.isInline };\n\n// :: bool\n// True when this is a text node.\nprototypeAccessors$3.isText.get = function () { return this.type.isText };\n\n// :: bool\n// True when this is a leaf node.\nprototypeAccessors$3.isLeaf.get = function () { return this.type.isLeaf };\n\n// :: bool\n// True when this is an atom, i.e. when it does not have directly\n// editable content. This is usually the same as `isLeaf`, but can\n// be configured with the [`atom` property](#model.NodeSpec.atom) on\n// a node's spec (typically used when the node is displayed as an\n// uneditable [node view](#view.NodeView)).\nprototypeAccessors$3.isAtom.get = function () { return this.type.isAtom };\n\n// :: () → string\n// Return a string representation of this node for debugging\n// purposes.\nNode.prototype.toString = function toString () {\n  if (this.type.spec.toDebugString) { return this.type.spec.toDebugString(this) }\n  var name = this.type.name;\n  if (this.content.size)\n    { name += \"(\" + this.content.toStringInner() + \")\"; }\n  return wrapMarks(this.marks, name)\n};\n\n// :: (number) → ContentMatch\n// Get the content match in this node at the given index.\nNode.prototype.contentMatchAt = function contentMatchAt (index) {\n  var match = this.type.contentMatch.matchFragment(this.content, 0, index);\n  if (!match) { throw new Error(\"Called contentMatchAt on a node with invalid content\") }\n  return match\n};\n\n// :: (number, number, ?Fragment, ?number, ?number) → bool\n// Test whether replacing the range between `from` and `to` (by\n// child index) with the given replacement fragment (which defaults\n// to the empty fragment) would leave the node's content valid. You\n// can optionally pass `start` and `end` indices into the\n// replacement fragment.\nNode.prototype.canReplace = function canReplace (from, to, replacement, start, end) {\n    if ( replacement === void 0 ) replacement = Fragment.empty;\n    if ( start === void 0 ) start = 0;\n    if ( end === void 0 ) end = replacement.childCount;\n\n  var one = this.contentMatchAt(from).matchFragment(replacement, start, end);\n  var two = one && one.matchFragment(this.content, to);\n  if (!two || !two.validEnd) { return false }\n  for (var i = start; i < end; i++) { if (!this.type.allowsMarks(replacement.child(i).marks)) { return false } }\n  return true\n};\n\n// :: (number, number, NodeType, ?[Mark]) → bool\n// Test whether replacing the range `from` to `to` (by index) with a\n// node of the given type would leave the node's content valid.\nNode.prototype.canReplaceWith = function canReplaceWith (from, to, type, marks) {\n  if (marks && !this.type.allowsMarks(marks)) { return false }\n  var start = this.contentMatchAt(from).matchType(type);\n  var end = start && start.matchFragment(this.content, to);\n  return end ? end.validEnd : false\n};\n\n// :: (Node) → bool\n// Test whether the given node's content could be appended to this\n// node. If that node is empty, this will only return true if there\n// is at least one node type that can appear in both nodes (to avoid\n// merging completely incompatible nodes).\nNode.prototype.canAppend = function canAppend (other) {\n  if (other.content.size) { return this.canReplace(this.childCount, this.childCount, other.content) }\n  else { return this.type.compatibleContent(other.type) }\n};\n\n// :: ()\n// Check whether this node and its descendants conform to the\n// schema, and raise error when they do not.\nNode.prototype.check = function check () {\n  if (!this.type.validContent(this.content))\n    { throw new RangeError((\"Invalid content for node \" + (this.type.name) + \": \" + (this.content.toString().slice(0, 50)))) }\n  this.content.forEach(function (node) { return node.check(); });\n};\n\n// :: () → Object\n// Return a JSON-serializeable representation of this node.\nNode.prototype.toJSON = function toJSON () {\n  var obj = {type: this.type.name};\n  for (var _ in this.attrs) {\n    obj.attrs = this.attrs;\n    break\n  }\n  if (this.content.size)\n    { obj.content = this.content.toJSON(); }\n  if (this.marks.length)\n    { obj.marks = this.marks.map(function (n) { return n.toJSON(); }); }\n  return obj\n};\n\n// :: (Schema, Object) → Node\n// Deserialize a node from its JSON representation.\nNode.fromJSON = function fromJSON (schema, json) {\n  if (!json) { throw new RangeError(\"Invalid input for Node.fromJSON\") }\n  var marks = null;\n  if (json.marks) {\n    if (!Array.isArray(json.marks)) { throw new RangeError(\"Invalid mark data for Node.fromJSON\") }\n    marks = json.marks.map(schema.markFromJSON);\n  }\n  if (json.type == \"text\") {\n    if (typeof json.text != \"string\") { throw new RangeError(\"Invalid text node in JSON\") }\n    return schema.text(json.text, marks)\n  }\n  var content = Fragment.fromJSON(schema, json.content);\n  return schema.nodeType(json.type).create(json.attrs, content, marks)\n};\n\nObject.defineProperties( Node.prototype, prototypeAccessors$3 );\n\nvar TextNode = /*@__PURE__*/(function (Node) {\n  function TextNode(type, attrs, content, marks) {\n    Node.call(this, type, attrs, null, marks);\n\n    if (!content) { throw new RangeError(\"Empty text nodes are not allowed\") }\n\n    this.text = content;\n  }\n\n  if ( Node ) TextNode.__proto__ = Node;\n  TextNode.prototype = Object.create( Node && Node.prototype );\n  TextNode.prototype.constructor = TextNode;\n\n  var prototypeAccessors$1 = { textContent: { configurable: true },nodeSize: { configurable: true } };\n\n  TextNode.prototype.toString = function toString () {\n    if (this.type.spec.toDebugString) { return this.type.spec.toDebugString(this) }\n    return wrapMarks(this.marks, JSON.stringify(this.text))\n  };\n\n  prototypeAccessors$1.textContent.get = function () { return this.text };\n\n  TextNode.prototype.textBetween = function textBetween (from, to) { return this.text.slice(from, to) };\n\n  prototypeAccessors$1.nodeSize.get = function () { return this.text.length };\n\n  TextNode.prototype.mark = function mark (marks) {\n    return marks == this.marks ? this : new TextNode(this.type, this.attrs, this.text, marks)\n  };\n\n  TextNode.prototype.withText = function withText (text) {\n    if (text == this.text) { return this }\n    return new TextNode(this.type, this.attrs, text, this.marks)\n  };\n\n  TextNode.prototype.cut = function cut (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.text.length;\n\n    if (from == 0 && to == this.text.length) { return this }\n    return this.withText(this.text.slice(from, to))\n  };\n\n  TextNode.prototype.eq = function eq (other) {\n    return this.sameMarkup(other) && this.text == other.text\n  };\n\n  TextNode.prototype.toJSON = function toJSON () {\n    var base = Node.prototype.toJSON.call(this);\n    base.text = this.text;\n    return base\n  };\n\n  Object.defineProperties( TextNode.prototype, prototypeAccessors$1 );\n\n  return TextNode;\n}(Node));\n\nfunction wrapMarks(marks, str) {\n  for (var i = marks.length - 1; i >= 0; i--)\n    { str = marks[i].type.name + \"(\" + str + \")\"; }\n  return str\n}\n\n// ::- Instances of this class represent a match state of a node\n// type's [content expression](#model.NodeSpec.content), and can be\n// used to find out whether further content matches here, and whether\n// a given position is a valid end of the node.\nvar ContentMatch = function ContentMatch(validEnd) {\n  // :: bool\n  // True when this match state represents a valid end of the node.\n  this.validEnd = validEnd;\n  this.next = [];\n  this.wrapCache = [];\n};\n\nvar prototypeAccessors$4 = { inlineContent: { configurable: true },defaultType: { configurable: true },edgeCount: { configurable: true } };\n\nContentMatch.parse = function parse (string, nodeTypes) {\n  var stream = new TokenStream(string, nodeTypes);\n  if (stream.next == null) { return ContentMatch.empty }\n  var expr = parseExpr(stream);\n  if (stream.next) { stream.err(\"Unexpected trailing text\"); }\n  var match = dfa(nfa(expr));\n  checkForDeadEnds(match, stream);\n  return match\n};\n\n// :: (NodeType) → ?ContentMatch\n// Match a node type, returning a match after that node if\n// successful.\nContentMatch.prototype.matchType = function matchType (type) {\n  for (var i = 0; i < this.next.length; i += 2)\n    { if (this.next[i] == type) { return this.next[i + 1] } }\n  return null\n};\n\n// :: (Fragment, ?number, ?number) → ?ContentMatch\n// Try to match a fragment. Returns the resulting match when\n// successful.\nContentMatch.prototype.matchFragment = function matchFragment (frag, start, end) {\n    if ( start === void 0 ) start = 0;\n    if ( end === void 0 ) end = frag.childCount;\n\n  var cur = this;\n  for (var i = start; cur && i < end; i++)\n    { cur = cur.matchType(frag.child(i).type); }\n  return cur\n};\n\nprototypeAccessors$4.inlineContent.get = function () {\n  var first = this.next[0];\n  return first ? first.isInline : false\n};\n\n// :: ?NodeType\n// Get the first matching node type at this match position that can\n// be generated.\nprototypeAccessors$4.defaultType.get = function () {\n  for (var i = 0; i < this.next.length; i += 2) {\n    var type = this.next[i];\n    if (!(type.isText || type.hasRequiredAttrs())) { return type }\n  }\n};\n\nContentMatch.prototype.compatible = function compatible (other) {\n  for (var i = 0; i < this.next.length; i += 2)\n    { for (var j = 0; j < other.next.length; j += 2)\n      { if (this.next[i] == other.next[j]) { return true } } }\n  return false\n};\n\n// :: (Fragment, bool, ?number) → ?Fragment\n// Try to match the given fragment, and if that fails, see if it can\n// be made to match by inserting nodes in front of it. When\n// successful, return a fragment of inserted nodes (which may be\n// empty if nothing had to be inserted). When `toEnd` is true, only\n// return a fragment if the resulting match goes to the end of the\n// content expression.\nContentMatch.prototype.fillBefore = function fillBefore (after, toEnd, startIndex) {\n    if ( toEnd === void 0 ) toEnd = false;\n    if ( startIndex === void 0 ) startIndex = 0;\n\n  var seen = [this];\n  function search(match, types) {\n    var finished = match.matchFragment(after, startIndex);\n    if (finished && (!toEnd || finished.validEnd))\n      { return Fragment.from(types.map(function (tp) { return tp.createAndFill(); })) }\n\n    for (var i = 0; i < match.next.length; i += 2) {\n      var type = match.next[i], next = match.next[i + 1];\n      if (!(type.isText || type.hasRequiredAttrs()) && seen.indexOf(next) == -1) {\n        seen.push(next);\n        var found = search(next, types.concat(type));\n        if (found) { return found }\n      }\n    }\n  }\n\n  return search(this, [])\n};\n\n// :: (NodeType) → ?[NodeType]\n// Find a set of wrapping node types that would allow a node of the\n// given type to appear at this position. The result may be empty\n// (when it fits directly) and will be null when no such wrapping\n// exists.\nContentMatch.prototype.findWrapping = function findWrapping (target) {\n  for (var i = 0; i < this.wrapCache.length; i += 2)\n    { if (this.wrapCache[i] == target) { return this.wrapCache[i + 1] } }\n  var computed = this.computeWrapping(target);\n  this.wrapCache.push(target, computed);\n  return computed\n};\n\nContentMatch.prototype.computeWrapping = function computeWrapping (target) {\n  var seen = Object.create(null), active = [{match: this, type: null, via: null}];\n  while (active.length) {\n    var current = active.shift(), match = current.match;\n    if (match.matchType(target)) {\n      var result = [];\n      for (var obj = current; obj.type; obj = obj.via)\n        { result.push(obj.type); }\n      return result.reverse()\n    }\n    for (var i = 0; i < match.next.length; i += 2) {\n      var type = match.next[i];\n      if (!type.isLeaf && !type.hasRequiredAttrs() && !(type.name in seen) && (!current.type || match.next[i + 1].validEnd)) {\n        active.push({match: type.contentMatch, type: type, via: current});\n        seen[type.name] = true;\n      }\n    }\n  }\n};\n\n// :: number\n// The number of outgoing edges this node has in the finite\n// automaton that describes the content expression.\nprototypeAccessors$4.edgeCount.get = function () {\n  return this.next.length >> 1\n};\n\n// :: (number) → {type: NodeType, next: ContentMatch}\n// Get the _n_​th outgoing edge from this node in the finite\n// automaton that describes the content expression.\nContentMatch.prototype.edge = function edge (n) {\n  var i = n << 1;\n  if (i >= this.next.length) { throw new RangeError((\"There's no \" + n + \"th edge in this content match\")) }\n  return {type: this.next[i], next: this.next[i + 1]}\n};\n\nContentMatch.prototype.toString = function toString () {\n  var seen = [];\n  function scan(m) {\n    seen.push(m);\n    for (var i = 1; i < m.next.length; i += 2)\n      { if (seen.indexOf(m.next[i]) == -1) { scan(m.next[i]); } }\n  }\n  scan(this);\n  return seen.map(function (m, i) {\n    var out = i + (m.validEnd ? \"*\" : \" \") + \" \";\n    for (var i$1 = 0; i$1 < m.next.length; i$1 += 2)\n      { out += (i$1 ? \", \" : \"\") + m.next[i$1].name + \"->\" + seen.indexOf(m.next[i$1 + 1]); }\n    return out\n  }).join(\"\\n\")\n};\n\nObject.defineProperties( ContentMatch.prototype, prototypeAccessors$4 );\n\nContentMatch.empty = new ContentMatch(true);\n\nvar TokenStream = function TokenStream(string, nodeTypes) {\n  this.string = string;\n  this.nodeTypes = nodeTypes;\n  this.inline = null;\n  this.pos = 0;\n  this.tokens = string.split(/\\s*(?=\\b|\\W|$)/);\n  if (this.tokens[this.tokens.length - 1] == \"\") { this.tokens.pop(); }\n  if (this.tokens[0] == \"\") { this.tokens.shift(); }\n};\n\nvar prototypeAccessors$1$2 = { next: { configurable: true } };\n\nprototypeAccessors$1$2.next.get = function () { return this.tokens[this.pos] };\n\nTokenStream.prototype.eat = function eat (tok) { return this.next == tok && (this.pos++ || true) };\n\nTokenStream.prototype.err = function err (str) { throw new SyntaxError(str + \" (in content expression '\" + this.string + \"')\") };\n\nObject.defineProperties( TokenStream.prototype, prototypeAccessors$1$2 );\n\nfunction parseExpr(stream) {\n  var exprs = [];\n  do { exprs.push(parseExprSeq(stream)); }\n  while (stream.eat(\"|\"))\n  return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs: exprs}\n}\n\nfunction parseExprSeq(stream) {\n  var exprs = [];\n  do { exprs.push(parseExprSubscript(stream)); }\n  while (stream.next && stream.next != \")\" && stream.next != \"|\")\n  return exprs.length == 1 ? exprs[0] : {type: \"seq\", exprs: exprs}\n}\n\nfunction parseExprSubscript(stream) {\n  var expr = parseExprAtom(stream);\n  for (;;) {\n    if (stream.eat(\"+\"))\n      { expr = {type: \"plus\", expr: expr}; }\n    else if (stream.eat(\"*\"))\n      { expr = {type: \"star\", expr: expr}; }\n    else if (stream.eat(\"?\"))\n      { expr = {type: \"opt\", expr: expr}; }\n    else if (stream.eat(\"{\"))\n      { expr = parseExprRange(stream, expr); }\n    else { break }\n  }\n  return expr\n}\n\nfunction parseNum(stream) {\n  if (/\\D/.test(stream.next)) { stream.err(\"Expected number, got '\" + stream.next + \"'\"); }\n  var result = Number(stream.next);\n  stream.pos++;\n  return result\n}\n\nfunction parseExprRange(stream, expr) {\n  var min = parseNum(stream), max = min;\n  if (stream.eat(\",\")) {\n    if (stream.next != \"}\") { max = parseNum(stream); }\n    else { max = -1; }\n  }\n  if (!stream.eat(\"}\")) { stream.err(\"Unclosed braced range\"); }\n  return {type: \"range\", min: min, max: max, expr: expr}\n}\n\nfunction resolveName(stream, name) {\n  var types = stream.nodeTypes, type = types[name];\n  if (type) { return [type] }\n  var result = [];\n  for (var typeName in types) {\n    var type$1 = types[typeName];\n    if (type$1.groups.indexOf(name) > -1) { result.push(type$1); }\n  }\n  if (result.length == 0) { stream.err(\"No node type or group '\" + name + \"' found\"); }\n  return result\n}\n\nfunction parseExprAtom(stream) {\n  if (stream.eat(\"(\")) {\n    var expr = parseExpr(stream);\n    if (!stream.eat(\")\")) { stream.err(\"Missing closing paren\"); }\n    return expr\n  } else if (!/\\W/.test(stream.next)) {\n    var exprs = resolveName(stream, stream.next).map(function (type) {\n      if (stream.inline == null) { stream.inline = type.isInline; }\n      else if (stream.inline != type.isInline) { stream.err(\"Mixing inline and block content\"); }\n      return {type: \"name\", value: type}\n    });\n    stream.pos++;\n    return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs: exprs}\n  } else {\n    stream.err(\"Unexpected token '\" + stream.next + \"'\");\n  }\n}\n\n// The code below helps compile a regular-expression-like language\n// into a deterministic finite automaton. For a good introduction to\n// these concepts, see https://swtch.com/~rsc/regexp/regexp1.html\n\n// : (Object) → [[{term: ?any, to: number}]]\n// Construct an NFA from an expression as returned by the parser. The\n// NFA is represented as an array of states, which are themselves\n// arrays of edges, which are `{term, to}` objects. The first state is\n// the entry state and the last node is the success state.\n//\n// Note that unlike typical NFAs, the edge ordering in this one is\n// significant, in that it is used to contruct filler content when\n// necessary.\nfunction nfa(expr) {\n  var nfa = [[]];\n  connect(compile(expr, 0), node());\n  return nfa\n\n  function node() { return nfa.push([]) - 1 }\n  function edge(from, to, term) {\n    var edge = {term: term, to: to};\n    nfa[from].push(edge);\n    return edge\n  }\n  function connect(edges, to) { edges.forEach(function (edge) { return edge.to = to; }); }\n\n  function compile(expr, from) {\n    if (expr.type == \"choice\") {\n      return expr.exprs.reduce(function (out, expr) { return out.concat(compile(expr, from)); }, [])\n    } else if (expr.type == \"seq\") {\n      for (var i = 0;; i++) {\n        var next = compile(expr.exprs[i], from);\n        if (i == expr.exprs.length - 1) { return next }\n        connect(next, from = node());\n      }\n    } else if (expr.type == \"star\") {\n      var loop = node();\n      edge(from, loop);\n      connect(compile(expr.expr, loop), loop);\n      return [edge(loop)]\n    } else if (expr.type == \"plus\") {\n      var loop$1 = node();\n      connect(compile(expr.expr, from), loop$1);\n      connect(compile(expr.expr, loop$1), loop$1);\n      return [edge(loop$1)]\n    } else if (expr.type == \"opt\") {\n      return [edge(from)].concat(compile(expr.expr, from))\n    } else if (expr.type == \"range\") {\n      var cur = from;\n      for (var i$1 = 0; i$1 < expr.min; i$1++) {\n        var next$1 = node();\n        connect(compile(expr.expr, cur), next$1);\n        cur = next$1;\n      }\n      if (expr.max == -1) {\n        connect(compile(expr.expr, cur), cur);\n      } else {\n        for (var i$2 = expr.min; i$2 < expr.max; i$2++) {\n          var next$2 = node();\n          edge(cur, next$2);\n          connect(compile(expr.expr, cur), next$2);\n          cur = next$2;\n        }\n      }\n      return [edge(cur)]\n    } else if (expr.type == \"name\") {\n      return [edge(from, null, expr.value)]\n    }\n  }\n}\n\nfunction cmp(a, b) { return b - a }\n\n// Get the set of nodes reachable by null edges from `node`. Omit\n// nodes with only a single null-out-edge, since they may lead to\n// needless duplicated nodes.\nfunction nullFrom(nfa, node) {\n  var result = [];\n  scan(node);\n  return result.sort(cmp)\n\n  function scan(node) {\n    var edges = nfa[node];\n    if (edges.length == 1 && !edges[0].term) { return scan(edges[0].to) }\n    result.push(node);\n    for (var i = 0; i < edges.length; i++) {\n      var ref = edges[i];\n      var term = ref.term;\n      var to = ref.to;\n      if (!term && result.indexOf(to) == -1) { scan(to); }\n    }\n  }\n}\n\n// : ([[{term: ?any, to: number}]]) → ContentMatch\n// Compiles an NFA as produced by `nfa` into a DFA, modeled as a set\n// of state objects (`ContentMatch` instances) with transitions\n// between them.\nfunction dfa(nfa) {\n  var labeled = Object.create(null);\n  return explore(nullFrom(nfa, 0))\n\n  function explore(states) {\n    var out = [];\n    states.forEach(function (node) {\n      nfa[node].forEach(function (ref) {\n        var term = ref.term;\n        var to = ref.to;\n\n        if (!term) { return }\n        var known = out.indexOf(term), set = known > -1 && out[known + 1];\n        nullFrom(nfa, to).forEach(function (node) {\n          if (!set) { out.push(term, set = []); }\n          if (set.indexOf(node) == -1) { set.push(node); }\n        });\n      });\n    });\n    var state = labeled[states.join(\",\")] = new ContentMatch(states.indexOf(nfa.length - 1) > -1);\n    for (var i = 0; i < out.length; i += 2) {\n      var states$1 = out[i + 1].sort(cmp);\n      state.next.push(out[i], labeled[states$1.join(\",\")] || explore(states$1));\n    }\n    return state\n  }\n}\n\nfunction checkForDeadEnds(match, stream) {\n  for (var i = 0, work = [match]; i < work.length; i++) {\n    var state = work[i], dead = !state.validEnd, nodes = [];\n    for (var j = 0; j < state.next.length; j += 2) {\n      var node = state.next[j], next = state.next[j + 1];\n      nodes.push(node.name);\n      if (dead && !(node.isText || node.hasRequiredAttrs())) { dead = false; }\n      if (work.indexOf(next) == -1) { work.push(next); }\n    }\n    if (dead) { stream.err(\"Only non-generatable nodes (\" + nodes.join(\", \") + \") in a required position (see https://prosemirror.net/docs/guide/#generatable)\"); }\n  }\n}\n\n// For node types where all attrs have a default value (or which don't\n// have any attributes), build up a single reusable default attribute\n// object, and use it for all nodes that don't specify specific\n// attributes.\nfunction defaultAttrs(attrs) {\n  var defaults = Object.create(null);\n  for (var attrName in attrs) {\n    var attr = attrs[attrName];\n    if (!attr.hasDefault) { return null }\n    defaults[attrName] = attr.default;\n  }\n  return defaults\n}\n\nfunction computeAttrs(attrs, value) {\n  var built = Object.create(null);\n  for (var name in attrs) {\n    var given = value && value[name];\n    if (given === undefined) {\n      var attr = attrs[name];\n      if (attr.hasDefault) { given = attr.default; }\n      else { throw new RangeError(\"No value supplied for attribute \" + name) }\n    }\n    built[name] = given;\n  }\n  return built\n}\n\nfunction initAttrs(attrs) {\n  var result = Object.create(null);\n  if (attrs) { for (var name in attrs) { result[name] = new Attribute(attrs[name]); } }\n  return result\n}\n\n// ::- Node types are objects allocated once per `Schema` and used to\n// [tag](#model.Node.type) `Node` instances. They contain information\n// about the node type, such as its name and what kind of node it\n// represents.\nvar NodeType = function NodeType(name, schema, spec) {\n  // :: string\n  // The name the node type has in this schema.\n  this.name = name;\n\n  // :: Schema\n  // A link back to the `Schema` the node type belongs to.\n  this.schema = schema;\n\n  // :: NodeSpec\n  // The spec that this type is based on\n  this.spec = spec;\n\n  this.groups = spec.group ? spec.group.split(\" \") : [];\n  this.attrs = initAttrs(spec.attrs);\n\n  this.defaultAttrs = defaultAttrs(this.attrs);\n\n  // :: ContentMatch\n  // The starting match of the node type's content expression.\n  this.contentMatch = null;\n\n  // : ?[MarkType]\n  // The set of marks allowed in this node. `null` means all marks\n  // are allowed.\n  this.markSet = null;\n\n  // :: bool\n  // True if this node type has inline content.\n  this.inlineContent = null;\n\n  // :: bool\n  // True if this is a block type\n  this.isBlock = !(spec.inline || name == \"text\");\n\n  // :: bool\n  // True if this is the text node type.\n  this.isText = name == \"text\";\n};\n\nvar prototypeAccessors$5 = { isInline: { configurable: true },isTextblock: { configurable: true },isLeaf: { configurable: true },isAtom: { configurable: true } };\n\n// :: bool\n// True if this is an inline type.\nprototypeAccessors$5.isInline.get = function () { return !this.isBlock };\n\n// :: bool\n// True if this is a textblock type, a block that contains inline\n// content.\nprototypeAccessors$5.isTextblock.get = function () { return this.isBlock && this.inlineContent };\n\n// :: bool\n// True for node types that allow no content.\nprototypeAccessors$5.isLeaf.get = function () { return this.contentMatch == ContentMatch.empty };\n\n// :: bool\n// True when this node is an atom, i.e. when it does not have\n// directly editable content.\nprototypeAccessors$5.isAtom.get = function () { return this.isLeaf || this.spec.atom };\n\n// :: () → bool\n// Tells you whether this node type has any required attributes.\nNodeType.prototype.hasRequiredAttrs = function hasRequiredAttrs () {\n  for (var n in this.attrs) { if (this.attrs[n].isRequired) { return true } }\n  return false\n};\n\nNodeType.prototype.compatibleContent = function compatibleContent (other) {\n  return this == other || this.contentMatch.compatible(other.contentMatch)\n};\n\nNodeType.prototype.computeAttrs = function computeAttrs$1 (attrs) {\n  if (!attrs && this.defaultAttrs) { return this.defaultAttrs }\n  else { return computeAttrs(this.attrs, attrs) }\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n// Create a `Node` of this type. The given attributes are\n// checked and defaulted (you can pass `null` to use the type's\n// defaults entirely, if no required attributes exist). `content`\n// may be a `Fragment`, a node, an array of nodes, or\n// `null`. Similarly `marks` may be `null` to default to the empty\n// set of marks.\nNodeType.prototype.create = function create (attrs, content, marks) {\n  if (this.isText) { throw new Error(\"NodeType.create can't construct text nodes\") }\n  return new Node(this, this.computeAttrs(attrs), Fragment.from(content), Mark.setFrom(marks))\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n// Like [`create`](#model.NodeType.create), but check the given content\n// against the node type's content restrictions, and throw an error\n// if it doesn't match.\nNodeType.prototype.createChecked = function createChecked (attrs, content, marks) {\n  content = Fragment.from(content);\n  if (!this.validContent(content))\n    { throw new RangeError(\"Invalid content for node \" + this.name) }\n  return new Node(this, this.computeAttrs(attrs), content, Mark.setFrom(marks))\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → ?Node\n// Like [`create`](#model.NodeType.create), but see if it is necessary to\n// add nodes to the start or end of the given fragment to make it\n// fit the node. If no fitting wrapping can be found, return null.\n// Note that, due to the fact that required nodes can always be\n// created, this will always succeed if you pass null or\n// `Fragment.empty` as content.\nNodeType.prototype.createAndFill = function createAndFill (attrs, content, marks) {\n  attrs = this.computeAttrs(attrs);\n  content = Fragment.from(content);\n  if (content.size) {\n    var before = this.contentMatch.fillBefore(content);\n    if (!before) { return null }\n    content = before.append(content);\n  }\n  var after = this.contentMatch.matchFragment(content).fillBefore(Fragment.empty, true);\n  if (!after) { return null }\n  return new Node(this, attrs, content.append(after), Mark.setFrom(marks))\n};\n\n// :: (Fragment) → bool\n// Returns true if the given fragment is valid content for this node\n// type with the given attributes.\nNodeType.prototype.validContent = function validContent (content) {\n  var result = this.contentMatch.matchFragment(content);\n  if (!result || !result.validEnd) { return false }\n  for (var i = 0; i < content.childCount; i++)\n    { if (!this.allowsMarks(content.child(i).marks)) { return false } }\n  return true\n};\n\n// :: (MarkType) → bool\n// Check whether the given mark type is allowed in this node.\nNodeType.prototype.allowsMarkType = function allowsMarkType (markType) {\n  return this.markSet == null || this.markSet.indexOf(markType) > -1\n};\n\n// :: ([Mark]) → bool\n// Test whether the given set of marks are allowed in this node.\nNodeType.prototype.allowsMarks = function allowsMarks (marks) {\n  if (this.markSet == null) { return true }\n  for (var i = 0; i < marks.length; i++) { if (!this.allowsMarkType(marks[i].type)) { return false } }\n  return true\n};\n\n// :: ([Mark]) → [Mark]\n// Removes the marks that are not allowed in this node from the given set.\nNodeType.prototype.allowedMarks = function allowedMarks (marks) {\n  if (this.markSet == null) { return marks }\n  var copy;\n  for (var i = 0; i < marks.length; i++) {\n    if (!this.allowsMarkType(marks[i].type)) {\n      if (!copy) { copy = marks.slice(0, i); }\n    } else if (copy) {\n      copy.push(marks[i]);\n    }\n  }\n  return !copy ? marks : copy.length ? copy : Mark.empty\n};\n\nNodeType.compile = function compile (nodes, schema) {\n  var result = Object.create(null);\n  nodes.forEach(function (name, spec) { return result[name] = new NodeType(name, schema, spec); });\n\n  var topType = schema.spec.topNode || \"doc\";\n  if (!result[topType]) { throw new RangeError(\"Schema is missing its top node type ('\" + topType + \"')\") }\n  if (!result.text) { throw new RangeError(\"Every schema needs a 'text' type\") }\n  for (var _ in result.text.attrs) { throw new RangeError(\"The text node type should not have attributes\") }\n\n  return result\n};\n\nObject.defineProperties( NodeType.prototype, prototypeAccessors$5 );\n\n// Attribute descriptors\n\nvar Attribute = function Attribute(options) {\n  this.hasDefault = Object.prototype.hasOwnProperty.call(options, \"default\");\n  this.default = options.default;\n};\n\nvar prototypeAccessors$1$3 = { isRequired: { configurable: true } };\n\nprototypeAccessors$1$3.isRequired.get = function () {\n  return !this.hasDefault\n};\n\nObject.defineProperties( Attribute.prototype, prototypeAccessors$1$3 );\n\n// Marks\n\n// ::- Like nodes, marks (which are associated with nodes to signify\n// things like emphasis or being part of a link) are\n// [tagged](#model.Mark.type) with type objects, which are\n// instantiated once per `Schema`.\nvar MarkType = function MarkType(name, rank, schema, spec) {\n  // :: string\n  // The name of the mark type.\n  this.name = name;\n\n  // :: Schema\n  // The schema that this mark type instance is part of.\n  this.schema = schema;\n\n  // :: MarkSpec\n  // The spec on which the type is based.\n  this.spec = spec;\n\n  this.attrs = initAttrs(spec.attrs);\n\n  this.rank = rank;\n  this.excluded = null;\n  var defaults = defaultAttrs(this.attrs);\n  this.instance = defaults && new Mark(this, defaults);\n};\n\n// :: (?Object) → Mark\n// Create a mark of this type. `attrs` may be `null` or an object\n// containing only some of the mark's attributes. The others, if\n// they have defaults, will be added.\nMarkType.prototype.create = function create (attrs) {\n  if (!attrs && this.instance) { return this.instance }\n  return new Mark(this, computeAttrs(this.attrs, attrs))\n};\n\nMarkType.compile = function compile (marks, schema) {\n  var result = Object.create(null), rank = 0;\n  marks.forEach(function (name, spec) { return result[name] = new MarkType(name, rank++, schema, spec); });\n  return result\n};\n\n// :: ([Mark]) → [Mark]\n// When there is a mark of this type in the given set, a new set\n// without it is returned. Otherwise, the input set is returned.\nMarkType.prototype.removeFromSet = function removeFromSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (set[i].type == this)\n      { return set.slice(0, i).concat(set.slice(i + 1)) } }\n  return set\n};\n\n// :: ([Mark]) → ?Mark\n// Tests whether there is a mark of this type in the given set.\nMarkType.prototype.isInSet = function isInSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (set[i].type == this) { return set[i] } }\n};\n\n// :: (MarkType) → bool\n// Queries whether a given mark type is\n// [excluded](#model.MarkSpec.excludes) by this one.\nMarkType.prototype.excludes = function excludes (other) {\n  return this.excluded.indexOf(other) > -1\n};\n\n// SchemaSpec:: interface\n// An object describing a schema, as passed to the [`Schema`](#model.Schema)\n// constructor.\n//\n//   nodes:: union<Object<NodeSpec>, OrderedMap<NodeSpec>>\n//   The node types in this schema. Maps names to\n//   [`NodeSpec`](#model.NodeSpec) objects that describe the node type\n//   associated with that name. Their order is significant—it\n//   determines which [parse rules](#model.NodeSpec.parseDOM) take\n//   precedence by default, and which nodes come first in a given\n//   [group](#model.NodeSpec.group).\n//\n//   marks:: ?union<Object<MarkSpec>, OrderedMap<MarkSpec>>\n//   The mark types that exist in this schema. The order in which they\n//   are provided determines the order in which [mark\n//   sets](#model.Mark.addToSet) are sorted and in which [parse\n//   rules](#model.MarkSpec.parseDOM) are tried.\n//\n//   topNode:: ?string\n//   The name of the default top-level node for the schema. Defaults\n//   to `\"doc\"`.\n\n// NodeSpec:: interface\n//\n//   content:: ?string\n//   The content expression for this node, as described in the [schema\n//   guide](/docs/guide/#schema.content_expressions). When not given,\n//   the node does not allow any content.\n//\n//   marks:: ?string\n//   The marks that are allowed inside of this node. May be a\n//   space-separated string referring to mark names or groups, `\"_\"`\n//   to explicitly allow all marks, or `\"\"` to disallow marks. When\n//   not given, nodes with inline content default to allowing all\n//   marks, other nodes default to not allowing marks.\n//\n//   group:: ?string\n//   The group or space-separated groups to which this node belongs,\n//   which can be referred to in the content expressions for the\n//   schema.\n//\n//   inline:: ?bool\n//   Should be set to true for inline nodes. (Implied for text nodes.)\n//\n//   atom:: ?bool\n//   Can be set to true to indicate that, though this isn't a [leaf\n//   node](#model.NodeType.isLeaf), it doesn't have directly editable\n//   content and should be treated as a single unit in the view.\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that nodes of this type get.\n//\n//   selectable:: ?bool\n//   Controls whether nodes of this type can be selected as a [node\n//   selection](#state.NodeSelection). Defaults to true for non-text\n//   nodes.\n//\n//   draggable:: ?bool\n//   Determines whether nodes of this type can be dragged without\n//   being selected. Defaults to false.\n//\n//   code:: ?bool\n//   Can be used to indicate that this node contains code, which\n//   causes some commands to behave differently.\n//\n//   defining:: ?bool\n//   Determines whether this node is considered an important parent\n//   node during replace operations (such as paste). Non-defining (the\n//   default) nodes get dropped when their entire content is replaced,\n//   whereas defining nodes persist and wrap the inserted content.\n//   Likewise, in _inserted_ content the defining parents of the\n//   content are preserved when possible. Typically,\n//   non-default-paragraph textblock types, and possibly list items,\n//   are marked as defining.\n//\n//   isolating:: ?bool\n//   When enabled (default is false), the sides of nodes of this type\n//   count as boundaries that regular editing operations, like\n//   backspacing or lifting, won't cross. An example of a node that\n//   should probably have this enabled is a table cell.\n//\n//   toDOM:: ?(node: Node) → DOMOutputSpec\n//   Defines the default way a node of this type should be serialized\n//   to DOM/HTML (as used by\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)).\n//   Should return a DOM node or an [array\n//   structure](#model.DOMOutputSpec) that describes one, with an\n//   optional number zero (“hole”) in it to indicate where the node's\n//   content should be inserted.\n//\n//   For text nodes, the default is to create a text DOM node. Though\n//   it is possible to create a serializer where text is rendered\n//   differently, this is not supported inside the editor, so you\n//   shouldn't override that in your text node spec.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this node, which can be\n//   used by [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) to\n//   automatically derive a parser. The `node` field in the rules is\n//   implied (the name of this node will be filled in automatically).\n//   If you supply your own parser, you do not need to also specify\n//   parsing rules in your schema.\n//\n//   toDebugString:: ?(node: Node) -> string\n//   Defines the default way a node of this type should be serialized\n//   to a string representation for debugging (e.g. in error messages).\n\n// MarkSpec:: interface\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that marks of this type get.\n//\n//   inclusive:: ?bool\n//   Whether this mark should be active when the cursor is positioned\n//   at its end (or at its start when that is also the start of the\n//   parent node). Defaults to true.\n//\n//   excludes:: ?string\n//   Determines which other marks this mark can coexist with. Should\n//   be a space-separated strings naming other marks or groups of marks.\n//   When a mark is [added](#model.Mark.addToSet) to a set, all marks\n//   that it excludes are removed in the process. If the set contains\n//   any mark that excludes the new mark but is not, itself, excluded\n//   by the new mark, the mark can not be added an the set. You can\n//   use the value `\"_\"` to indicate that the mark excludes all\n//   marks in the schema.\n//\n//   Defaults to only being exclusive with marks of the same type. You\n//   can set it to an empty string (or any string not containing the\n//   mark's own name) to allow multiple marks of a given type to\n//   coexist (as long as they have different attributes).\n//\n//   group:: ?string\n//   The group or space-separated groups to which this mark belongs.\n//\n//   spanning:: ?bool\n//   Determines whether marks of this type can span multiple adjacent\n//   nodes when serialized to DOM/HTML. Defaults to true.\n//\n//   toDOM:: ?(mark: Mark, inline: bool) → DOMOutputSpec\n//   Defines the default way marks of this type should be serialized\n//   to DOM/HTML. When the resulting spec contains a hole, that is\n//   where the marked content is placed. Otherwise, it is appended to\n//   the top node.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this mark (see the\n//   corresponding [node spec field](#model.NodeSpec.parseDOM)). The\n//   `mark` field in the rules is implied.\n\n// AttributeSpec:: interface\n//\n// Used to [define](#model.NodeSpec.attrs) attributes on nodes or\n// marks.\n//\n//   default:: ?any\n//   The default value for this attribute, to use when no explicit\n//   value is provided. Attributes that have no default must be\n//   provided whenever a node or mark of a type that has them is\n//   created.\n\n// ::- A document schema. Holds [node](#model.NodeType) and [mark\n// type](#model.MarkType) objects for the nodes and marks that may\n// occur in conforming documents, and provides functionality for\n// creating and deserializing such documents.\nvar Schema = function Schema(spec) {\n  // :: SchemaSpec\n  // The [spec](#model.SchemaSpec) on which the schema is based,\n  // with the added guarantee that its `nodes` and `marks`\n  // properties are\n  // [`OrderedMap`](https://github.com/marijnh/orderedmap) instances\n  // (not raw objects).\n  this.spec = {};\n  for (var prop in spec) { this.spec[prop] = spec[prop]; }\n  this.spec.nodes = OrderedMap.from(spec.nodes);\n  this.spec.marks = OrderedMap.from(spec.marks);\n\n  // :: Object<NodeType>\n  // An object mapping the schema's node names to node type objects.\n  this.nodes = NodeType.compile(this.spec.nodes, this);\n\n  // :: Object<MarkType>\n  // A map from mark names to mark type objects.\n  this.marks = MarkType.compile(this.spec.marks, this);\n\n  var contentExprCache = Object.create(null);\n  for (var prop$1 in this.nodes) {\n    if (prop$1 in this.marks)\n      { throw new RangeError(prop$1 + \" can not be both a node and a mark\") }\n    var type = this.nodes[prop$1], contentExpr = type.spec.content || \"\", markExpr = type.spec.marks;\n    type.contentMatch = contentExprCache[contentExpr] ||\n      (contentExprCache[contentExpr] = ContentMatch.parse(contentExpr, this.nodes));\n    type.inlineContent = type.contentMatch.inlineContent;\n    type.markSet = markExpr == \"_\" ? null :\n      markExpr ? gatherMarks(this, markExpr.split(\" \")) :\n      markExpr == \"\" || !type.inlineContent ? [] : null;\n  }\n  for (var prop$2 in this.marks) {\n    var type$1 = this.marks[prop$2], excl = type$1.spec.excludes;\n    type$1.excluded = excl == null ? [type$1] : excl == \"\" ? [] : gatherMarks(this, excl.split(\" \"));\n  }\n\n  this.nodeFromJSON = this.nodeFromJSON.bind(this);\n  this.markFromJSON = this.markFromJSON.bind(this);\n\n  // :: NodeType\n  // The type of the [default top node](#model.SchemaSpec.topNode)\n  // for this schema.\n  this.topNodeType = this.nodes[this.spec.topNode || \"doc\"];\n\n  // :: Object\n  // An object for storing whatever values modules may want to\n  // compute and cache per schema. (If you want to store something\n  // in it, try to use property names unlikely to clash.)\n  this.cached = Object.create(null);\n  this.cached.wrappings = Object.create(null);\n};\n\n// :: (union<string, NodeType>, ?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n// Create a node in this schema. The `type` may be a string or a\n// `NodeType` instance. Attributes will be extended\n// with defaults, `content` may be a `Fragment`,\n// `null`, a `Node`, or an array of nodes.\nSchema.prototype.node = function node (type, attrs, content, marks) {\n  if (typeof type == \"string\")\n    { type = this.nodeType(type); }\n  else if (!(type instanceof NodeType))\n    { throw new RangeError(\"Invalid node type: \" + type) }\n  else if (type.schema != this)\n    { throw new RangeError(\"Node type from different schema used (\" + type.name + \")\") }\n\n  return type.createChecked(attrs, content, marks)\n};\n\n// :: (string, ?[Mark]) → Node\n// Create a text node in the schema. Empty text nodes are not\n// allowed.\nSchema.prototype.text = function text (text$1, marks) {\n  var type = this.nodes.text;\n  return new TextNode(type, type.defaultAttrs, text$1, Mark.setFrom(marks))\n};\n\n// :: (union<string, MarkType>, ?Object) → Mark\n// Create a mark with the given type and attributes.\nSchema.prototype.mark = function mark (type, attrs) {\n  if (typeof type == \"string\") { type = this.marks[type]; }\n  return type.create(attrs)\n};\n\n// :: (Object) → Node\n// Deserialize a node from its JSON representation. This method is\n// bound.\nSchema.prototype.nodeFromJSON = function nodeFromJSON (json) {\n  return Node.fromJSON(this, json)\n};\n\n// :: (Object) → Mark\n// Deserialize a mark from its JSON representation. This method is\n// bound.\nSchema.prototype.markFromJSON = function markFromJSON (json) {\n  return Mark.fromJSON(this, json)\n};\n\nSchema.prototype.nodeType = function nodeType (name) {\n  var found = this.nodes[name];\n  if (!found) { throw new RangeError(\"Unknown node type: \" + name) }\n  return found\n};\n\nfunction gatherMarks(schema, marks) {\n  var found = [];\n  for (var i = 0; i < marks.length; i++) {\n    var name = marks[i], mark = schema.marks[name], ok = mark;\n    if (mark) {\n      found.push(mark);\n    } else {\n      for (var prop in schema.marks) {\n        var mark$1 = schema.marks[prop];\n        if (name == \"_\" || (mark$1.spec.group && mark$1.spec.group.split(\" \").indexOf(name) > -1))\n          { found.push(ok = mark$1); }\n      }\n    }\n    if (!ok) { throw new SyntaxError(\"Unknown mark type: '\" + marks[i] + \"'\") }\n  }\n  return found\n}\n\n// ParseOptions:: interface\n// These are the options recognized by the\n// [`parse`](#model.DOMParser.parse) and\n// [`parseSlice`](#model.DOMParser.parseSlice) methods.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   By default, whitespace is collapsed as per HTML's rules. Pass\n//   `true` to preserve whitespace, but normalize newlines to\n//   spaces, and `\"full\"` to preserve whitespace entirely.\n//\n//   findPositions:: ?[{node: dom.Node, offset: number}]\n//   When given, the parser will, beside parsing the content,\n//   record the document positions of the given DOM positions. It\n//   will do so by writing to the objects, adding a `pos` property\n//   that holds the document position. DOM positions that are not\n//   in the parsed content will not be written to.\n//\n//   from:: ?number\n//   The child node index to start parsing from.\n//\n//   to:: ?number\n//   The child node index to stop parsing at.\n//\n//   topNode:: ?Node\n//   By default, the content is parsed into the schema's default\n//   [top node type](#model.Schema.topNodeType). You can pass this\n//   option to use the type and attributes from a different node\n//   as the top container.\n//\n//   topMatch:: ?ContentMatch\n//   Provide the starting content match that content parsed into the\n//   top node is matched against.\n//\n//   context:: ?ResolvedPos\n//   A set of additional nodes to count as\n//   [context](#model.ParseRule.context) when parsing, above the\n//   given [top node](#model.ParseOptions.topNode).\n\n// ParseRule:: interface\n// A value that describes how to parse a given DOM node or inline\n// style as a ProseMirror node or mark.\n//\n//   tag:: ?string\n//   A CSS selector describing the kind of DOM elements to match. A\n//   single rule should have _either_ a `tag` or a `style` property.\n//\n//   namespace:: ?string\n//   The namespace to match. This should be used with `tag`.\n//   Nodes are only matched when the namespace matches or this property\n//   is null.\n//\n//   style:: ?string\n//   A CSS property name to match. When given, this rule matches\n//   inline styles that list that property. May also have the form\n//   `\"property=value\"`, in which case the rule only matches if the\n//   property's value exactly matches the given value. (For more\n//   complicated filters, use [`getAttrs`](#model.ParseRule.getAttrs)\n//   and return false to indicate that the match failed.)\n//\n//   priority:: ?number\n//   Can be used to change the order in which the parse rules in a\n//   schema are tried. Those with higher priority come first. Rules\n//   without a priority are counted as having priority 50. This\n//   property is only meaningful in a schema—when directly\n//   constructing a parser, the order of the rule array is used.\n//\n//   consuming:: ?boolean\n//   By default, when a rule matches an element or style, no further\n//   rules get a chance to match it. By setting this to `false`, you\n//   indicate that even when this rule matches, other rules that come\n//   after it should also run.\n//\n//   context:: ?string\n//   When given, restricts this rule to only match when the current\n//   context—the parent nodes into which the content is being\n//   parsed—matches this expression. Should contain one or more node\n//   names or node group names followed by single or double slashes.\n//   For example `\"paragraph/\"` means the rule only matches when the\n//   parent node is a paragraph, `\"blockquote/paragraph/\"` restricts\n//   it to be in a paragraph that is inside a blockquote, and\n//   `\"section//\"` matches any position inside a section—a double\n//   slash matches any sequence of ancestor nodes. To allow multiple\n//   different contexts, they can be separated by a pipe (`|`)\n//   character, as in `\"blockquote/|list_item/\"`.\n//\n//   node:: ?string\n//   The name of the node type to create when this rule matches. Only\n//   valid for rules with a `tag` property, not for style rules. Each\n//   rule should have one of a `node`, `mark`, or `ignore` property\n//   (except when it appears in a [node](#model.NodeSpec.parseDOM) or\n//   [mark spec](#model.MarkSpec.parseDOM), in which case the `node`\n//   or `mark` property will be derived from its position).\n//\n//   mark:: ?string\n//   The name of the mark type to wrap the matched content in.\n//\n//   ignore:: ?bool\n//   When true, ignore content that matches this rule.\n//\n//   closeParent:: ?bool\n//   When true, finding an element that matches this rule will close\n//   the current node.\n//\n//   skip:: ?bool\n//   When true, ignore the node that matches this rule, but do parse\n//   its content.\n//\n//   attrs:: ?Object\n//   Attributes for the node or mark created by this rule. When\n//   `getAttrs` is provided, it takes precedence.\n//\n//   getAttrs:: ?(union<dom.Node, string>) → ?union<Object, false>\n//   A function used to compute the attributes for the node or mark\n//   created by this rule. Can also be used to describe further\n//   conditions the DOM element or style must match. When it returns\n//   `false`, the rule won't match. When it returns null or undefined,\n//   that is interpreted as an empty/default set of attributes.\n//\n//   Called with a DOM Element for `tag` rules, and with a string (the\n//   style's value) for `style` rules.\n//\n//   contentElement:: ?union<string, (dom.Node) → dom.Node>\n//   For `tag` rules that produce non-leaf nodes or marks, by default\n//   the content of the DOM element is parsed as content of the mark\n//   or node. If the child nodes are in a descendent node, this may be\n//   a CSS selector string that the parser must use to find the actual\n//   content element, or a function that returns the actual content\n//   element to the parser.\n//\n//   getContent:: ?(dom.Node, schema: Schema) → Fragment\n//   Can be used to override the content of a matched node. When\n//   present, instead of parsing the node's child nodes, the result of\n//   this function is used.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   Controls whether whitespace should be preserved when parsing the\n//   content inside the matched element. `false` means whitespace may\n//   be collapsed, `true` means that whitespace should be preserved\n//   but newlines normalized to spaces, and `\"full\"` means that\n//   newlines should also be preserved.\n\n// ::- A DOM parser represents a strategy for parsing DOM content into\n// a ProseMirror document conforming to a given schema. Its behavior\n// is defined by an array of [rules](#model.ParseRule).\nvar DOMParser = function DOMParser(schema, rules) {\n  var this$1 = this;\n\n  // :: Schema\n  // The schema into which the parser parses.\n  this.schema = schema;\n  // :: [ParseRule]\n  // The set of [parse rules](#model.ParseRule) that the parser\n  // uses, in order of precedence.\n  this.rules = rules;\n  this.tags = [];\n  this.styles = [];\n\n  rules.forEach(function (rule) {\n    if (rule.tag) { this$1.tags.push(rule); }\n    else if (rule.style) { this$1.styles.push(rule); }\n  });\n\n  // Only normalize list elements when lists in the schema can't directly contain themselves\n  this.normalizeLists = !this.tags.some(function (r) {\n    if (!/^(ul|ol)\\b/.test(r.tag) || !r.node) { return false }\n    var node = schema.nodes[r.node];\n    return node.contentMatch.matchType(node)\n  });\n};\n\n// :: (dom.Node, ?ParseOptions) → Node\n// Parse a document from the content of a DOM node.\nDOMParser.prototype.parse = function parse (dom, options) {\n    if ( options === void 0 ) options = {};\n\n  var context = new ParseContext(this, options, false);\n  context.addAll(dom, null, options.from, options.to);\n  return context.finish()\n};\n\n// :: (dom.Node, ?ParseOptions) → Slice\n// Parses the content of the given DOM node, like\n// [`parse`](#model.DOMParser.parse), and takes the same set of\n// options. But unlike that method, which produces a whole node,\n// this one returns a slice that is open at the sides, meaning that\n// the schema constraints aren't applied to the start of nodes to\n// the left of the input and the end of nodes at the end.\nDOMParser.prototype.parseSlice = function parseSlice (dom, options) {\n    if ( options === void 0 ) options = {};\n\n  var context = new ParseContext(this, options, true);\n  context.addAll(dom, null, options.from, options.to);\n  return Slice.maxOpen(context.finish())\n};\n\nDOMParser.prototype.matchTag = function matchTag (dom, context, after) {\n  for (var i = after ? this.tags.indexOf(after) + 1 : 0; i < this.tags.length; i++) {\n    var rule = this.tags[i];\n    if (matches(dom, rule.tag) &&\n        (rule.namespace === undefined || dom.namespaceURI == rule.namespace) &&\n        (!rule.context || context.matchesContext(rule.context))) {\n      if (rule.getAttrs) {\n        var result = rule.getAttrs(dom);\n        if (result === false) { continue }\n        rule.attrs = result;\n      }\n      return rule\n    }\n  }\n};\n\nDOMParser.prototype.matchStyle = function matchStyle (prop, value, context, after) {\n  for (var i = after ? this.styles.indexOf(after) + 1 : 0; i < this.styles.length; i++) {\n    var rule = this.styles[i];\n    if (rule.style.indexOf(prop) != 0 ||\n        rule.context && !context.matchesContext(rule.context) ||\n        // Test that the style string either precisely matches the prop,\n        // or has an '=' sign after the prop, followed by the given\n        // value.\n        rule.style.length > prop.length &&\n        (rule.style.charCodeAt(prop.length) != 61 || rule.style.slice(prop.length + 1) != value))\n      { continue }\n    if (rule.getAttrs) {\n      var result = rule.getAttrs(value);\n      if (result === false) { continue }\n      rule.attrs = result;\n    }\n    return rule\n  }\n};\n\n// : (Schema) → [ParseRule]\nDOMParser.schemaRules = function schemaRules (schema) {\n  var result = [];\n  function insert(rule) {\n    var priority = rule.priority == null ? 50 : rule.priority, i = 0;\n    for (; i < result.length; i++) {\n      var next = result[i], nextPriority = next.priority == null ? 50 : next.priority;\n      if (nextPriority < priority) { break }\n    }\n    result.splice(i, 0, rule);\n  }\n\n  var loop = function ( name ) {\n    var rules = schema.marks[name].spec.parseDOM;\n    if (rules) { rules.forEach(function (rule) {\n      insert(rule = copy(rule));\n      rule.mark = name;\n    }); }\n  };\n\n    for (var name in schema.marks) loop( name );\n  var loop$1 = function ( name ) {\n    var rules$1 = schema.nodes[name$1].spec.parseDOM;\n    if (rules$1) { rules$1.forEach(function (rule) {\n      insert(rule = copy(rule));\n      rule.node = name$1;\n    }); }\n  };\n\n    for (var name$1 in schema.nodes) loop$1();\n  return result\n};\n\n// :: (Schema) → DOMParser\n// Construct a DOM parser using the parsing rules listed in a\n// schema's [node specs](#model.NodeSpec.parseDOM), reordered by\n// [priority](#model.ParseRule.priority).\nDOMParser.fromSchema = function fromSchema (schema) {\n  return schema.cached.domParser ||\n    (schema.cached.domParser = new DOMParser(schema, DOMParser.schemaRules(schema)))\n};\n\n// : Object<bool> The block-level tags in HTML5\nvar blockTags = {\n  address: true, article: true, aside: true, blockquote: true, canvas: true,\n  dd: true, div: true, dl: true, fieldset: true, figcaption: true, figure: true,\n  footer: true, form: true, h1: true, h2: true, h3: true, h4: true, h5: true,\n  h6: true, header: true, hgroup: true, hr: true, li: true, noscript: true, ol: true,\n  output: true, p: true, pre: true, section: true, table: true, tfoot: true, ul: true\n};\n\n// : Object<bool> The tags that we normally ignore.\nvar ignoreTags = {\n  head: true, noscript: true, object: true, script: true, style: true, title: true\n};\n\n// : Object<bool> List tags.\nvar listTags = {ol: true, ul: true};\n\n// Using a bitfield for node context options\nvar OPT_PRESERVE_WS = 1, OPT_PRESERVE_WS_FULL = 2, OPT_OPEN_LEFT = 4;\n\nfunction wsOptionsFor(preserveWhitespace) {\n  return (preserveWhitespace ? OPT_PRESERVE_WS : 0) | (preserveWhitespace === \"full\" ? OPT_PRESERVE_WS_FULL : 0)\n}\n\nvar NodeContext = function NodeContext(type, attrs, marks, pendingMarks, solid, match, options) {\n  this.type = type;\n  this.attrs = attrs;\n  this.solid = solid;\n  this.match = match || (options & OPT_OPEN_LEFT ? null : type.contentMatch);\n  this.options = options;\n  this.content = [];\n  // Marks applied to this node itself\n  this.marks = marks;\n  // Marks applied to its children\n  this.activeMarks = Mark.none;\n  // Marks that can't apply here, but will be used in children if possible\n  this.pendingMarks = pendingMarks;\n  // Nested Marks with same type\n  this.stashMarks = [];\n};\n\nNodeContext.prototype.findWrapping = function findWrapping (node) {\n  if (!this.match) {\n    if (!this.type) { return [] }\n    var fill = this.type.contentMatch.fillBefore(Fragment.from(node));\n    if (fill) {\n      this.match = this.type.contentMatch.matchFragment(fill);\n    } else {\n      var start = this.type.contentMatch, wrap;\n      if (wrap = start.findWrapping(node.type)) {\n        this.match = start;\n        return wrap\n      } else {\n        return null\n      }\n    }\n  }\n  return this.match.findWrapping(node.type)\n};\n\nNodeContext.prototype.finish = function finish (openEnd) {\n  if (!(this.options & OPT_PRESERVE_WS)) { // Strip trailing whitespace\n    var last = this.content[this.content.length - 1], m;\n    if (last && last.isText && (m = /[ \\t\\r\\n\\u000c]+$/.exec(last.text))) {\n      if (last.text.length == m[0].length) { this.content.pop(); }\n      else { this.content[this.content.length - 1] = last.withText(last.text.slice(0, last.text.length - m[0].length)); }\n    }\n  }\n  var content = Fragment.from(this.content);\n  if (!openEnd && this.match)\n    { content = content.append(this.match.fillBefore(Fragment.empty, true)); }\n  return this.type ? this.type.create(this.attrs, content, this.marks) : content\n};\n\nNodeContext.prototype.popFromStashMark = function popFromStashMark (mark) {\n  for (var i = this.stashMarks.length - 1; i >= 0; i--)\n    { if (mark.eq(this.stashMarks[i])) { return this.stashMarks.splice(i, 1)[0] } }\n};\n\nNodeContext.prototype.applyPending = function applyPending (nextType) {\n  for (var i = 0, pending = this.pendingMarks; i < pending.length; i++) {\n    var mark = pending[i];\n    if ((this.type ? this.type.allowsMarkType(mark.type) : markMayApply(mark.type, nextType)) &&\n        !mark.isInSet(this.activeMarks)) {\n      this.activeMarks = mark.addToSet(this.activeMarks);\n      this.pendingMarks = mark.removeFromSet(this.pendingMarks);\n    }\n  }\n};\n\nvar ParseContext = function ParseContext(parser, options, open) {\n  // : DOMParser The parser we are using.\n  this.parser = parser;\n  // : Object The options passed to this parse.\n  this.options = options;\n  this.isOpen = open;\n  var topNode = options.topNode, topContext;\n  var topOptions = wsOptionsFor(options.preserveWhitespace) | (open ? OPT_OPEN_LEFT : 0);\n  if (topNode)\n    { topContext = new NodeContext(topNode.type, topNode.attrs, Mark.none, Mark.none, true,\n                                 options.topMatch || topNode.type.contentMatch, topOptions); }\n  else if (open)\n    { topContext = new NodeContext(null, null, Mark.none, Mark.none, true, null, topOptions); }\n  else\n    { topContext = new NodeContext(parser.schema.topNodeType, null, Mark.none, Mark.none, true, null, topOptions); }\n  this.nodes = [topContext];\n  // : [Mark] The current set of marks\n  this.open = 0;\n  this.find = options.findPositions;\n  this.needsBlock = false;\n};\n\nvar prototypeAccessors$6 = { top: { configurable: true },currentPos: { configurable: true } };\n\nprototypeAccessors$6.top.get = function () {\n  return this.nodes[this.open]\n};\n\n// : (dom.Node)\n// Add a DOM node to the content. Text is inserted as text node,\n// otherwise, the node is passed to `addElement` or, if it has a\n// `style` attribute, `addElementWithStyles`.\nParseContext.prototype.addDOM = function addDOM (dom) {\n  if (dom.nodeType == 3) {\n    this.addTextNode(dom);\n  } else if (dom.nodeType == 1) {\n    var style = dom.getAttribute(\"style\");\n    var marks = style ? this.readStyles(parseStyles(style)) : null, top = this.top;\n    if (marks != null) { for (var i = 0; i < marks.length; i++) { this.addPendingMark(marks[i]); } }\n    this.addElement(dom);\n    if (marks != null) { for (var i$1 = 0; i$1 < marks.length; i$1++) { this.removePendingMark(marks[i$1], top); } }\n  }\n};\n\nParseContext.prototype.addTextNode = function addTextNode (dom) {\n  var value = dom.nodeValue;\n  var top = this.top;\n  if ((top.type ? top.type.inlineContent : top.content.length && top.content[0].isInline) || /[^ \\t\\r\\n\\u000c]/.test(value)) {\n    if (!(top.options & OPT_PRESERVE_WS)) {\n      value = value.replace(/[ \\t\\r\\n\\u000c]+/g, \" \");\n      // If this starts with whitespace, and there is no node before it, or\n      // a hard break, or a text node that ends with whitespace, strip the\n      // leading space.\n      if (/^[ \\t\\r\\n\\u000c]/.test(value) && this.open == this.nodes.length - 1) {\n        var nodeBefore = top.content[top.content.length - 1];\n        var domNodeBefore = dom.previousSibling;\n        if (!nodeBefore ||\n            (domNodeBefore && domNodeBefore.nodeName == 'BR') ||\n            (nodeBefore.isText && /[ \\t\\r\\n\\u000c]$/.test(nodeBefore.text)))\n          { value = value.slice(1); }\n      }\n    } else if (!(top.options & OPT_PRESERVE_WS_FULL)) {\n      value = value.replace(/\\r?\\n|\\r/g, \" \");\n    }\n    if (value) { this.insertNode(this.parser.schema.text(value)); }\n    this.findInText(dom);\n  } else {\n    this.findInside(dom);\n  }\n};\n\n// : (dom.Element, ?ParseRule)\n// Try to find a handler for the given tag and use that to parse. If\n// none is found, the element's content nodes are added directly.\nParseContext.prototype.addElement = function addElement (dom, matchAfter) {\n  var name = dom.nodeName.toLowerCase(), ruleID;\n  if (listTags.hasOwnProperty(name) && this.parser.normalizeLists) { normalizeList(dom); }\n  var rule = (this.options.ruleFromNode && this.options.ruleFromNode(dom)) ||\n      (ruleID = this.parser.matchTag(dom, this, matchAfter));\n  if (rule ? rule.ignore : ignoreTags.hasOwnProperty(name)) {\n    this.findInside(dom);\n  } else if (!rule || rule.skip || rule.closeParent) {\n    if (rule && rule.closeParent) { this.open = Math.max(0, this.open - 1); }\n    else if (rule && rule.skip.nodeType) { dom = rule.skip; }\n    var sync, top = this.top, oldNeedsBlock = this.needsBlock;\n    if (blockTags.hasOwnProperty(name)) {\n      sync = true;\n      if (!top.type) { this.needsBlock = true; }\n    } else if (!dom.firstChild) {\n      this.leafFallback(dom);\n      return\n    }\n    this.addAll(dom);\n    if (sync) { this.sync(top); }\n    this.needsBlock = oldNeedsBlock;\n  } else {\n    this.addElementByRule(dom, rule, rule.consuming === false ? ruleID : null);\n  }\n};\n\n// Called for leaf DOM nodes that would otherwise be ignored\nParseContext.prototype.leafFallback = function leafFallback (dom) {\n  if (dom.nodeName == \"BR\" && this.top.type && this.top.type.inlineContent)\n    { this.addTextNode(dom.ownerDocument.createTextNode(\"\\n\")); }\n};\n\n// Run any style parser associated with the node's styles. Either\n// return an array of marks, or null to indicate some of the styles\n// had a rule with `ignore` set.\nParseContext.prototype.readStyles = function readStyles (styles) {\n  var marks = Mark.none;\n  style: for (var i = 0; i < styles.length; i += 2) {\n    for (var after = null;;) {\n      var rule = this.parser.matchStyle(styles[i], styles[i + 1], this, after);\n      if (!rule) { continue style }\n      if (rule.ignore) { return null }\n      marks = this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(marks);\n      if (rule.consuming === false) { after = rule; }\n      else { break }\n    }\n  }\n  return marks\n};\n\n// : (dom.Element, ParseRule) → bool\n// Look up a handler for the given node. If none are found, return\n// false. Otherwise, apply it, use its return value to drive the way\n// the node's content is wrapped, and return true.\nParseContext.prototype.addElementByRule = function addElementByRule (dom, rule, continueAfter) {\n    var this$1 = this;\n\n  var sync, nodeType, markType, mark;\n  if (rule.node) {\n    nodeType = this.parser.schema.nodes[rule.node];\n    if (!nodeType.isLeaf) {\n      sync = this.enter(nodeType, rule.attrs, rule.preserveWhitespace);\n    } else if (!this.insertNode(nodeType.create(rule.attrs))) {\n      this.leafFallback(dom);\n    }\n  } else {\n    markType = this.parser.schema.marks[rule.mark];\n    mark = markType.create(rule.attrs);\n    this.addPendingMark(mark);\n  }\n  var startIn = this.top;\n\n  if (nodeType && nodeType.isLeaf) {\n    this.findInside(dom);\n  } else if (continueAfter) {\n    this.addElement(dom, continueAfter);\n  } else if (rule.getContent) {\n    this.findInside(dom);\n    rule.getContent(dom, this.parser.schema).forEach(function (node) { return this$1.insertNode(node); });\n  } else {\n    var contentDOM = rule.contentElement;\n    if (typeof contentDOM == \"string\") { contentDOM = dom.querySelector(contentDOM); }\n    else if (typeof contentDOM == \"function\") { contentDOM = contentDOM(dom); }\n    if (!contentDOM) { contentDOM = dom; }\n    this.findAround(dom, contentDOM, true);\n    this.addAll(contentDOM, sync);\n  }\n  if (sync) { this.sync(startIn); this.open--; }\n  if (mark) { this.removePendingMark(mark, startIn); }\n};\n\n// : (dom.Node, ?NodeBuilder, ?number, ?number)\n// Add all child nodes between `startIndex` and `endIndex` (or the\n// whole node, if not given). If `sync` is passed, use it to\n// synchronize after every block element.\nParseContext.prototype.addAll = function addAll (parent, sync, startIndex, endIndex) {\n  var index = startIndex || 0;\n  for (var dom = startIndex ? parent.childNodes[startIndex] : parent.firstChild,\n           end = endIndex == null ? null : parent.childNodes[endIndex];\n       dom != end; dom = dom.nextSibling, ++index) {\n    this.findAtPoint(parent, index);\n    this.addDOM(dom);\n    if (sync && blockTags.hasOwnProperty(dom.nodeName.toLowerCase()))\n      { this.sync(sync); }\n  }\n  this.findAtPoint(parent, index);\n};\n\n// Try to find a way to fit the given node type into the current\n// context. May add intermediate wrappers and/or leave non-solid\n// nodes that we're in.\nParseContext.prototype.findPlace = function findPlace (node) {\n  var route, sync;\n  for (var depth = this.open; depth >= 0; depth--) {\n    var cx = this.nodes[depth];\n    var found = cx.findWrapping(node);\n    if (found && (!route || route.length > found.length)) {\n      route = found;\n      sync = cx;\n      if (!found.length) { break }\n    }\n    if (cx.solid) { break }\n  }\n  if (!route) { return false }\n  this.sync(sync);\n  for (var i = 0; i < route.length; i++)\n    { this.enterInner(route[i], null, false); }\n  return true\n};\n\n// : (Node) → ?Node\n// Try to insert the given node, adjusting the context when needed.\nParseContext.prototype.insertNode = function insertNode (node) {\n  if (node.isInline && this.needsBlock && !this.top.type) {\n    var block = this.textblockFromContext();\n    if (block) { this.enterInner(block); }\n  }\n  if (this.findPlace(node)) {\n    this.closeExtra();\n    var top = this.top;\n    top.applyPending(node.type);\n    if (top.match) { top.match = top.match.matchType(node.type); }\n    var marks = top.activeMarks;\n    for (var i = 0; i < node.marks.length; i++)\n      { if (!top.type || top.type.allowsMarkType(node.marks[i].type))\n        { marks = node.marks[i].addToSet(marks); } }\n    top.content.push(node.mark(marks));\n    return true\n  }\n  return false\n};\n\n// : (NodeType, ?Object) → bool\n// Try to start a node of the given type, adjusting the context when\n// necessary.\nParseContext.prototype.enter = function enter (type, attrs, preserveWS) {\n  var ok = this.findPlace(type.create(attrs));\n  if (ok) { this.enterInner(type, attrs, true, preserveWS); }\n  return ok\n};\n\n// Open a node of the given type\nParseContext.prototype.enterInner = function enterInner (type, attrs, solid, preserveWS) {\n  this.closeExtra();\n  var top = this.top;\n  top.applyPending(type);\n  top.match = top.match && top.match.matchType(type, attrs);\n  var options = preserveWS == null ? top.options & ~OPT_OPEN_LEFT : wsOptionsFor(preserveWS);\n  if ((top.options & OPT_OPEN_LEFT) && top.content.length == 0) { options |= OPT_OPEN_LEFT; }\n  this.nodes.push(new NodeContext(type, attrs, top.activeMarks, top.pendingMarks, solid, null, options));\n  this.open++;\n};\n\n// Make sure all nodes above this.open are finished and added to\n// their parents\nParseContext.prototype.closeExtra = function closeExtra (openEnd) {\n  var i = this.nodes.length - 1;\n  if (i > this.open) {\n    for (; i > this.open; i--) { this.nodes[i - 1].content.push(this.nodes[i].finish(openEnd)); }\n    this.nodes.length = this.open + 1;\n  }\n};\n\nParseContext.prototype.finish = function finish () {\n  this.open = 0;\n  this.closeExtra(this.isOpen);\n  return this.nodes[0].finish(this.isOpen || this.options.topOpen)\n};\n\nParseContext.prototype.sync = function sync (to) {\n  for (var i = this.open; i >= 0; i--) { if (this.nodes[i] == to) {\n    this.open = i;\n    return\n  } }\n};\n\nprototypeAccessors$6.currentPos.get = function () {\n  this.closeExtra();\n  var pos = 0;\n  for (var i = this.open; i >= 0; i--) {\n    var content = this.nodes[i].content;\n    for (var j = content.length - 1; j >= 0; j--)\n      { pos += content[j].nodeSize; }\n    if (i) { pos++; }\n  }\n  return pos\n};\n\nParseContext.prototype.findAtPoint = function findAtPoint (parent, offset) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].node == parent && this.find[i].offset == offset)\n      { this.find[i].pos = this.currentPos; }\n  } }\n};\n\nParseContext.prototype.findInside = function findInside (parent) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node))\n      { this.find[i].pos = this.currentPos; }\n  } }\n};\n\nParseContext.prototype.findAround = function findAround (parent, content, before) {\n  if (parent != content && this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node)) {\n      var pos = content.compareDocumentPosition(this.find[i].node);\n      if (pos & (before ? 2 : 4))\n        { this.find[i].pos = this.currentPos; }\n    }\n  } }\n};\n\nParseContext.prototype.findInText = function findInText (textNode) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].node == textNode)\n      { this.find[i].pos = this.currentPos - (textNode.nodeValue.length - this.find[i].offset); }\n  } }\n};\n\n// : (string) → bool\n// Determines whether the given [context\n// string](#ParseRule.context) matches this context.\nParseContext.prototype.matchesContext = function matchesContext (context) {\n    var this$1 = this;\n\n  if (context.indexOf(\"|\") > -1)\n    { return context.split(/\\s*\\|\\s*/).some(this.matchesContext, this) }\n\n  var parts = context.split(\"/\");\n  var option = this.options.context;\n  var useRoot = !this.isOpen && (!option || option.parent.type == this.nodes[0].type);\n  var minDepth = -(option ? option.depth + 1 : 0) + (useRoot ? 0 : 1);\n  var match = function (i, depth) {\n    for (; i >= 0; i--) {\n      var part = parts[i];\n      if (part == \"\") {\n        if (i == parts.length - 1 || i == 0) { continue }\n        for (; depth >= minDepth; depth--)\n          { if (match(i - 1, depth)) { return true } }\n        return false\n      } else {\n        var next = depth > 0 || (depth == 0 && useRoot) ? this$1.nodes[depth].type\n            : option && depth >= minDepth ? option.node(depth - minDepth).type\n            : null;\n        if (!next || (next.name != part && next.groups.indexOf(part) == -1))\n          { return false }\n        depth--;\n      }\n    }\n    return true\n  };\n  return match(parts.length - 1, this.open)\n};\n\nParseContext.prototype.textblockFromContext = function textblockFromContext () {\n  var $context = this.options.context;\n  if ($context) { for (var d = $context.depth; d >= 0; d--) {\n    var deflt = $context.node(d).contentMatchAt($context.indexAfter(d)).defaultType;\n    if (deflt && deflt.isTextblock && deflt.defaultAttrs) { return deflt }\n  } }\n  for (var name in this.parser.schema.nodes) {\n    var type = this.parser.schema.nodes[name];\n    if (type.isTextblock && type.defaultAttrs) { return type }\n  }\n};\n\nParseContext.prototype.addPendingMark = function addPendingMark (mark) {\n  var found = findSameMarkInSet(mark, this.top.pendingMarks);\n  if (found) { this.top.stashMarks.push(found); }\n  this.top.pendingMarks = mark.addToSet(this.top.pendingMarks);\n};\n\nParseContext.prototype.removePendingMark = function removePendingMark (mark, upto) {\n  for (var depth = this.open; depth >= 0; depth--) {\n    var level = this.nodes[depth];\n    var found = level.pendingMarks.lastIndexOf(mark);\n    if (found > -1) {\n      level.pendingMarks = mark.removeFromSet(level.pendingMarks);\n    } else {\n      level.activeMarks = mark.removeFromSet(level.activeMarks);\n      var stashMark = level.popFromStashMark(mark);\n      if (stashMark) { level.activeMarks = stashMark.addToSet(level.activeMarks); }\n    }\n    if (level == upto) { break }\n  }\n};\n\nObject.defineProperties( ParseContext.prototype, prototypeAccessors$6 );\n\n// Kludge to work around directly nested list nodes produced by some\n// tools and allowed by browsers to mean that the nested list is\n// actually part of the list item above it.\nfunction normalizeList(dom) {\n  for (var child = dom.firstChild, prevItem = null; child; child = child.nextSibling) {\n    var name = child.nodeType == 1 ? child.nodeName.toLowerCase() : null;\n    if (name && listTags.hasOwnProperty(name) && prevItem) {\n      prevItem.appendChild(child);\n      child = prevItem;\n    } else if (name == \"li\") {\n      prevItem = child;\n    } else if (name) {\n      prevItem = null;\n    }\n  }\n}\n\n// Apply a CSS selector.\nfunction matches(dom, selector) {\n  return (dom.matches || dom.msMatchesSelector || dom.webkitMatchesSelector || dom.mozMatchesSelector).call(dom, selector)\n}\n\n// : (string) → [string]\n// Tokenize a style attribute into property/value pairs.\nfunction parseStyles(style) {\n  var re = /\\s*([\\w-]+)\\s*:\\s*([^;]+)/g, m, result = [];\n  while (m = re.exec(style)) { result.push(m[1], m[2].trim()); }\n  return result\n}\n\nfunction copy(obj) {\n  var copy = {};\n  for (var prop in obj) { copy[prop] = obj[prop]; }\n  return copy\n}\n\n// Used when finding a mark at the top level of a fragment parse.\n// Checks whether it would be reasonable to apply a given mark type to\n// a given node, by looking at the way the mark occurs in the schema.\nfunction markMayApply(markType, nodeType) {\n  var nodes = nodeType.schema.nodes;\n  var loop = function ( name ) {\n    var parent = nodes[name];\n    if (!parent.allowsMarkType(markType)) { return }\n    var seen = [], scan = function (match) {\n      seen.push(match);\n      for (var i = 0; i < match.edgeCount; i++) {\n        var ref = match.edge(i);\n        var type = ref.type;\n        var next = ref.next;\n        if (type == nodeType) { return true }\n        if (seen.indexOf(next) < 0 && scan(next)) { return true }\n      }\n    };\n    if (scan(parent.contentMatch)) { return { v: true } }\n  };\n\n  for (var name in nodes) {\n    var returned = loop( name );\n\n    if ( returned ) return returned.v;\n  }\n}\n\nfunction findSameMarkInSet(mark, set) {\n  for (var i = 0; i < set.length; i++) {\n    if (mark.eq(set[i])) { return set[i] }\n  }\n}\n\n// DOMOutputSpec:: interface\n// A description of a DOM structure. Can be either a string, which is\n// interpreted as a text node, a DOM node, which is interpreted as\n// itself, a `{dom: Node, contentDOM: ?Node}` object, or an array.\n//\n// An array describes a DOM element. The first value in the array\n// should be a string—the name of the DOM element, optionally prefixed\n// by a namespace URL and a space. If the second element is plain\n// object, it is interpreted as a set of attributes for the element.\n// Any elements after that (including the 2nd if it's not an attribute\n// object) are interpreted as children of the DOM elements, and must\n// either be valid `DOMOutputSpec` values, or the number zero.\n//\n// The number zero (pronounced “hole”) is used to indicate the place\n// where a node's child nodes should be inserted. If it occurs in an\n// output spec, it should be the only child element in its parent\n// node.\n\n// ::- A DOM serializer knows how to convert ProseMirror nodes and\n// marks of various types to DOM nodes.\nvar DOMSerializer = function DOMSerializer(nodes, marks) {\n  // :: Object<(node: Node) → DOMOutputSpec>\n  // The node serialization functions.\n  this.nodes = nodes || {};\n  // :: Object<?(mark: Mark, inline: bool) → DOMOutputSpec>\n  // The mark serialization functions.\n  this.marks = marks || {};\n};\n\n// :: (Fragment, ?Object) → dom.DocumentFragment\n// Serialize the content of this fragment to a DOM fragment. When\n// not in the browser, the `document` option, containing a DOM\n// document, should be passed so that the serializer can create\n// nodes.\nDOMSerializer.prototype.serializeFragment = function serializeFragment (fragment, options, target) {\n    var this$1 = this;\n    if ( options === void 0 ) options = {};\n\n  if (!target) { target = doc(options).createDocumentFragment(); }\n\n  var top = target, active = null;\n  fragment.forEach(function (node) {\n    if (active || node.marks.length) {\n      if (!active) { active = []; }\n      var keep = 0, rendered = 0;\n      while (keep < active.length && rendered < node.marks.length) {\n        var next = node.marks[rendered];\n        if (!this$1.marks[next.type.name]) { rendered++; continue }\n        if (!next.eq(active[keep]) || next.type.spec.spanning === false) { break }\n        keep += 2; rendered++;\n      }\n      while (keep < active.length) {\n        top = active.pop();\n        active.pop();\n      }\n      while (rendered < node.marks.length) {\n        var add = node.marks[rendered++];\n        var markDOM = this$1.serializeMark(add, node.isInline, options);\n        if (markDOM) {\n          active.push(add, top);\n          top.appendChild(markDOM.dom);\n          top = markDOM.contentDOM || markDOM.dom;\n        }\n      }\n    }\n    top.appendChild(this$1.serializeNode(node, options));\n  });\n\n  return target\n};\n\n// :: (Node, ?Object) → dom.Node\n// Serialize this node to a DOM node. This can be useful when you\n// need to serialize a part of a document, as opposed to the whole\n// document. To serialize a whole document, use\n// [`serializeFragment`](#model.DOMSerializer.serializeFragment) on\n// its [content](#model.Node.content).\nDOMSerializer.prototype.serializeNode = function serializeNode (node, options) {\n    if ( options === void 0 ) options = {};\n\n  var ref =\n      DOMSerializer.renderSpec(doc(options), this.nodes[node.type.name](node));\n    var dom = ref.dom;\n    var contentDOM = ref.contentDOM;\n  if (contentDOM) {\n    if (node.isLeaf)\n      { throw new RangeError(\"Content hole not allowed in a leaf node spec\") }\n    if (options.onContent)\n      { options.onContent(node, contentDOM, options); }\n    else\n      { this.serializeFragment(node.content, options, contentDOM); }\n  }\n  return dom\n};\n\nDOMSerializer.prototype.serializeNodeAndMarks = function serializeNodeAndMarks (node, options) {\n    if ( options === void 0 ) options = {};\n\n  var dom = this.serializeNode(node, options);\n  for (var i = node.marks.length - 1; i >= 0; i--) {\n    var wrap = this.serializeMark(node.marks[i], node.isInline, options);\n    if (wrap) {\n(wrap.contentDOM || wrap.dom).appendChild(dom);\n      dom = wrap.dom;\n    }\n  }\n  return dom\n};\n\nDOMSerializer.prototype.serializeMark = function serializeMark (mark, inline, options) {\n    if ( options === void 0 ) options = {};\n\n  var toDOM = this.marks[mark.type.name];\n  return toDOM && DOMSerializer.renderSpec(doc(options), toDOM(mark, inline))\n};\n\n// :: (dom.Document, DOMOutputSpec) → {dom: dom.Node, contentDOM: ?dom.Node}\n// Render an [output spec](#model.DOMOutputSpec) to a DOM node. If\n// the spec has a hole (zero) in it, `contentDOM` will point at the\n// node with the hole.\nDOMSerializer.renderSpec = function renderSpec (doc, structure, xmlNS) {\n    if ( xmlNS === void 0 ) xmlNS = null;\n\n  if (typeof structure == \"string\")\n    { return {dom: doc.createTextNode(structure)} }\n  if (structure.nodeType != null)\n    { return {dom: structure} }\n  if (structure.dom && structure.dom.nodeType != null)\n    { return structure }\n  var tagName = structure[0], space = tagName.indexOf(\" \");\n  if (space > 0) {\n    xmlNS = tagName.slice(0, space);\n    tagName = tagName.slice(space + 1);\n  }\n  var contentDOM = null, dom = xmlNS ? doc.createElementNS(xmlNS, tagName) : doc.createElement(tagName);\n  var attrs = structure[1], start = 1;\n  if (attrs && typeof attrs == \"object\" && attrs.nodeType == null && !Array.isArray(attrs)) {\n    start = 2;\n    for (var name in attrs) { if (attrs[name] != null) {\n      var space$1 = name.indexOf(\" \");\n      if (space$1 > 0) { dom.setAttributeNS(name.slice(0, space$1), name.slice(space$1 + 1), attrs[name]); }\n      else { dom.setAttribute(name, attrs[name]); }\n    } }\n  }\n  for (var i = start; i < structure.length; i++) {\n    var child = structure[i];\n    if (child === 0) {\n      if (i < structure.length - 1 || i > start)\n        { throw new RangeError(\"Content hole must be the only child of its parent node\") }\n      return {dom: dom, contentDOM: dom}\n    } else {\n      var ref = DOMSerializer.renderSpec(doc, child, xmlNS);\n        var inner = ref.dom;\n        var innerContent = ref.contentDOM;\n      dom.appendChild(inner);\n      if (innerContent) {\n        if (contentDOM) { throw new RangeError(\"Multiple content holes\") }\n        contentDOM = innerContent;\n      }\n    }\n  }\n  return {dom: dom, contentDOM: contentDOM}\n};\n\n// :: (Schema) → DOMSerializer\n// Build a serializer using the [`toDOM`](#model.NodeSpec.toDOM)\n// properties in a schema's node and mark specs.\nDOMSerializer.fromSchema = function fromSchema (schema) {\n  return schema.cached.domSerializer ||\n    (schema.cached.domSerializer = new DOMSerializer(this.nodesFromSchema(schema), this.marksFromSchema(schema)))\n};\n\n// : (Schema) → Object<(node: Node) → DOMOutputSpec>\n// Gather the serializers in a schema's node specs into an object.\n// This can be useful as a base to build a custom serializer from.\nDOMSerializer.nodesFromSchema = function nodesFromSchema (schema) {\n  var result = gatherToDOM(schema.nodes);\n  if (!result.text) { result.text = function (node) { return node.text; }; }\n  return result\n};\n\n// : (Schema) → Object<(mark: Mark) → DOMOutputSpec>\n// Gather the serializers in a schema's mark specs into an object.\nDOMSerializer.marksFromSchema = function marksFromSchema (schema) {\n  return gatherToDOM(schema.marks)\n};\n\nfunction gatherToDOM(obj) {\n  var result = {};\n  for (var name in obj) {\n    var toDOM = obj[name].spec.toDOM;\n    if (toDOM) { result[name] = toDOM; }\n  }\n  return result\n}\n\nfunction doc(options) {\n  // declare global: window\n  return options.document || window.document\n}\n\nexport { ContentMatch, DOMParser, DOMSerializer, Fragment, Mark, MarkType, Node, NodeRange, NodeType, ReplaceError, ResolvedPos, Schema, Slice };\n//# sourceMappingURL=index.es.js.map\n","import { findWrapping, ReplaceAroundStep, canSplit, liftTarget } from 'prosemirror-transform';\nimport { NodeRange, Fragment, Slice } from 'prosemirror-model';\n\nvar olDOM = [\"ol\", 0], ulDOM = [\"ul\", 0], liDOM = [\"li\", 0];\n\n// :: NodeSpec\n// An ordered list [node spec](#model.NodeSpec). Has a single\n// attribute, `order`, which determines the number at which the list\n// starts counting, and defaults to 1. Represented as an `<ol>`\n// element.\nvar orderedList = {\n  attrs: {order: {default: 1}},\n  parseDOM: [{tag: \"ol\", getAttrs: function getAttrs(dom) {\n    return {order: dom.hasAttribute(\"start\") ? +dom.getAttribute(\"start\") : 1}\n  }}],\n  toDOM: function toDOM(node) {\n    return node.attrs.order == 1 ? olDOM : [\"ol\", {start: node.attrs.order}, 0]\n  }\n};\n\n// :: NodeSpec\n// A bullet list node spec, represented in the DOM as `<ul>`.\nvar bulletList = {\n  parseDOM: [{tag: \"ul\"}],\n  toDOM: function toDOM() { return ulDOM }\n};\n\n// :: NodeSpec\n// A list item (`<li>`) spec.\nvar listItem = {\n  parseDOM: [{tag: \"li\"}],\n  toDOM: function toDOM() { return liDOM },\n  defining: true\n};\n\nfunction add(obj, props) {\n  var copy = {};\n  for (var prop in obj) { copy[prop] = obj[prop]; }\n  for (var prop$1 in props) { copy[prop$1] = props[prop$1]; }\n  return copy\n}\n\n// :: (OrderedMap<NodeSpec>, string, ?string) → OrderedMap<NodeSpec>\n// Convenience function for adding list-related node types to a map\n// specifying the nodes for a schema. Adds\n// [`orderedList`](#schema-list.orderedList) as `\"ordered_list\"`,\n// [`bulletList`](#schema-list.bulletList) as `\"bullet_list\"`, and\n// [`listItem`](#schema-list.listItem) as `\"list_item\"`.\n//\n// `itemContent` determines the content expression for the list items.\n// If you want the commands defined in this module to apply to your\n// list structure, it should have a shape like `\"paragraph block*\"` or\n// `\"paragraph (ordered_list | bullet_list)*\"`. `listGroup` can be\n// given to assign a group name to the list node types, for example\n// `\"block\"`.\nfunction addListNodes(nodes, itemContent, listGroup) {\n  return nodes.append({\n    ordered_list: add(orderedList, {content: \"list_item+\", group: listGroup}),\n    bullet_list: add(bulletList, {content: \"list_item+\", group: listGroup}),\n    list_item: add(listItem, {content: itemContent})\n  })\n}\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Returns a command function that wraps the selection in a list with\n// the given type an attributes. If `dispatch` is null, only return a\n// value to indicate whether this is possible, but don't actually\n// perform the change.\nfunction wrapInList(listType, attrs) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var range = $from.blockRange($to), doJoin = false, outerRange = range;\n    if (!range) { return false }\n    // This is at the top of an existing list item\n    if (range.depth >= 2 && $from.node(range.depth - 1).type.compatibleContent(listType) && range.startIndex == 0) {\n      // Don't do anything if this is the top of the list\n      if ($from.index(range.depth - 1) == 0) { return false }\n      var $insert = state.doc.resolve(range.start - 2);\n      outerRange = new NodeRange($insert, $insert, range.depth);\n      if (range.endIndex < range.parent.childCount)\n        { range = new NodeRange($from, state.doc.resolve($to.end(range.depth)), range.depth); }\n      doJoin = true;\n    }\n    var wrap = findWrapping(outerRange, listType, attrs, range);\n    if (!wrap) { return false }\n    if (dispatch) { dispatch(doWrapInList(state.tr, range, wrap, doJoin, listType).scrollIntoView()); }\n    return true\n  }\n}\n\nfunction doWrapInList(tr, range, wrappers, joinBefore, listType) {\n  var content = Fragment.empty;\n  for (var i = wrappers.length - 1; i >= 0; i--)\n    { content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content)); }\n\n  tr.step(new ReplaceAroundStep(range.start - (joinBefore ? 2 : 0), range.end, range.start, range.end,\n                                new Slice(content, 0, 0), wrappers.length, true));\n\n  var found = 0;\n  for (var i$1 = 0; i$1 < wrappers.length; i$1++) { if (wrappers[i$1].type == listType) { found = i$1 + 1; } }\n  var splitDepth = wrappers.length - found;\n\n  var splitPos = range.start + wrappers.length - (joinBefore ? 2 : 0), parent = range.parent;\n  for (var i$2 = range.startIndex, e = range.endIndex, first = true; i$2 < e; i$2++, first = false) {\n    if (!first && canSplit(tr.doc, splitPos, splitDepth)) {\n      tr.split(splitPos, splitDepth);\n      splitPos += 2 * splitDepth;\n    }\n    splitPos += parent.child(i$2).nodeSize;\n  }\n  return tr\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Build a command that splits a non-empty textblock at the top level\n// of a list item by also splitting that list item.\nfunction splitListItem(itemType) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var node = ref.node;\n    if ((node && node.isBlock) || $from.depth < 2 || !$from.sameParent($to)) { return false }\n    var grandParent = $from.node(-1);\n    if (grandParent.type != itemType) { return false }\n    if ($from.parent.content.size == 0 && $from.node(-1).childCount == $from.indexAfter(-1)) {\n      // In an empty block. If this is a nested list, the wrapping\n      // list item should be split. Otherwise, bail out and let next\n      // command handle lifting.\n      if ($from.depth == 2 || $from.node(-3).type != itemType ||\n          $from.index(-2) != $from.node(-2).childCount - 1) { return false }\n      if (dispatch) {\n        var wrap = Fragment.empty, keepItem = $from.index(-1) > 0;\n        // Build a fragment containing empty versions of the structure\n        // from the outer list item to the parent node of the cursor\n        for (var d = $from.depth - (keepItem ? 1 : 2); d >= $from.depth - 3; d--)\n          { wrap = Fragment.from($from.node(d).copy(wrap)); }\n        // Add a second list item with an empty default start node\n        wrap = wrap.append(Fragment.from(itemType.createAndFill()));\n        var tr$1 = state.tr.replace($from.before(keepItem ? null : -1), $from.after(-3), new Slice(wrap, keepItem ? 3 : 2, 2));\n        tr$1.setSelection(state.selection.constructor.near(tr$1.doc.resolve($from.pos + (keepItem ? 3 : 2))));\n        dispatch(tr$1.scrollIntoView());\n      }\n      return true\n    }\n    var nextType = $to.pos == $from.end() ? grandParent.contentMatchAt(0).defaultType : null;\n    var tr = state.tr.delete($from.pos, $to.pos);\n    var types = nextType && [null, {type: nextType}];\n    if (!canSplit(tr.doc, $from.pos, 2, types)) { return false }\n    if (dispatch) { dispatch(tr.split($from.pos, 2, types).scrollIntoView()); }\n    return true\n  }\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command to lift the list item around the selection up into\n// a wrapping list.\nfunction liftListItem(itemType) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var range = $from.blockRange($to, function (node) { return node.childCount && node.firstChild.type == itemType; });\n    if (!range) { return false }\n    if (!dispatch) { return true }\n    if ($from.node(range.depth - 1).type == itemType) // Inside a parent list\n      { return liftToOuterList(state, dispatch, itemType, range) }\n    else // Outer list node\n      { return liftOutOfList(state, dispatch, range) }\n  }\n}\n\nfunction liftToOuterList(state, dispatch, itemType, range) {\n  var tr = state.tr, end = range.end, endOfList = range.$to.end(range.depth);\n  if (end < endOfList) {\n    // There are siblings after the lifted items, which must become\n    // children of the last item\n    tr.step(new ReplaceAroundStep(end - 1, endOfList, end, endOfList,\n                                  new Slice(Fragment.from(itemType.create(null, range.parent.copy())), 1, 0), 1, true));\n    range = new NodeRange(tr.doc.resolve(range.$from.pos), tr.doc.resolve(endOfList), range.depth);\n  }\n  dispatch(tr.lift(range, liftTarget(range)).scrollIntoView());\n  return true\n}\n\nfunction liftOutOfList(state, dispatch, range) {\n  var tr = state.tr, list = range.parent;\n  // Merge the list items into a single big item\n  for (var pos = range.end, i = range.endIndex - 1, e = range.startIndex; i > e; i--) {\n    pos -= list.child(i).nodeSize;\n    tr.delete(pos - 1, pos + 1);\n  }\n  var $start = tr.doc.resolve(range.start), item = $start.nodeAfter;\n  var atStart = range.startIndex == 0, atEnd = range.endIndex == list.childCount;\n  var parent = $start.node(-1), indexBefore = $start.index(-1);\n  if (!parent.canReplace(indexBefore + (atStart ? 0 : 1), indexBefore + 1,\n                         item.content.append(atEnd ? Fragment.empty : Fragment.from(list))))\n    { return false }\n  var start = $start.pos, end = start + item.nodeSize;\n  // Strip off the surrounding list. At the sides where we're not at\n  // the end of the list, the existing list is closed. At sides where\n  // this is the end, it is overwritten to its end.\n  tr.step(new ReplaceAroundStep(start - (atStart ? 1 : 0), end + (atEnd ? 1 : 0), start + 1, end - 1,\n                                new Slice((atStart ? Fragment.empty : Fragment.from(list.copy(Fragment.empty)))\n                                          .append(atEnd ? Fragment.empty : Fragment.from(list.copy(Fragment.empty))),\n                                          atStart ? 0 : 1, atEnd ? 0 : 1), atStart ? 0 : 1));\n  dispatch(tr.scrollIntoView());\n  return true\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command to sink the list item around the selection down\n// into an inner list.\nfunction sinkListItem(itemType) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var range = $from.blockRange($to, function (node) { return node.childCount && node.firstChild.type == itemType; });\n    if (!range) { return false }\n    var startIndex = range.startIndex;\n    if (startIndex == 0) { return false }\n    var parent = range.parent, nodeBefore = parent.child(startIndex - 1);\n    if (nodeBefore.type != itemType) { return false }\n\n    if (dispatch) {\n      var nestedBefore = nodeBefore.lastChild && nodeBefore.lastChild.type == parent.type;\n      var inner = Fragment.from(nestedBefore ? itemType.create() : null);\n      var slice = new Slice(Fragment.from(itemType.create(null, Fragment.from(parent.type.create(null, inner)))),\n                            nestedBefore ? 3 : 1, 0);\n      var before = range.start, after = range.end;\n      dispatch(state.tr.step(new ReplaceAroundStep(before - (nestedBefore ? 3 : 1), after,\n                                                   before, after, slice, 1, true))\n               .scrollIntoView());\n    }\n    return true\n  }\n}\n\nexport { addListNodes, bulletList, liftListItem, listItem, orderedList, sinkListItem, splitListItem, wrapInList };\n//# sourceMappingURL=index.es.js.map\n","import { Slice, Fragment, Mark, Node } from 'prosemirror-model';\nimport { ReplaceStep, ReplaceAroundStep, Transform } from 'prosemirror-transform';\n\nvar classesById = Object.create(null);\n\n// ::- Superclass for editor selections. Every selection type should\n// extend this. Should not be instantiated directly.\nvar Selection = function Selection($anchor, $head, ranges) {\n  // :: [SelectionRange]\n  // The ranges covered by the selection.\n  this.ranges = ranges || [new SelectionRange($anchor.min($head), $anchor.max($head))];\n  // :: ResolvedPos\n  // The resolved anchor of the selection (the side that stays in\n  // place when the selection is modified).\n  this.$anchor = $anchor;\n  // :: ResolvedPos\n  // The resolved head of the selection (the side that moves when\n  // the selection is modified).\n  this.$head = $head;\n};\n\nvar prototypeAccessors = { anchor: { configurable: true },head: { configurable: true },from: { configurable: true },to: { configurable: true },$from: { configurable: true },$to: { configurable: true },empty: { configurable: true } };\n\n// :: number\n// The selection's anchor, as an unresolved position.\nprototypeAccessors.anchor.get = function () { return this.$anchor.pos };\n\n// :: number\n// The selection's head.\nprototypeAccessors.head.get = function () { return this.$head.pos };\n\n// :: number\n// The lower bound of the selection's main range.\nprototypeAccessors.from.get = function () { return this.$from.pos };\n\n// :: number\n// The upper bound of the selection's main range.\nprototypeAccessors.to.get = function () { return this.$to.pos };\n\n// :: ResolvedPos\n// The resolved lowerbound of the selection's main range.\nprototypeAccessors.$from.get = function () {\n  return this.ranges[0].$from\n};\n\n// :: ResolvedPos\n// The resolved upper bound of the selection's main range.\nprototypeAccessors.$to.get = function () {\n  return this.ranges[0].$to\n};\n\n// :: bool\n// Indicates whether the selection contains any content.\nprototypeAccessors.empty.get = function () {\n  var ranges = this.ranges;\n  for (var i = 0; i < ranges.length; i++)\n    { if (ranges[i].$from.pos != ranges[i].$to.pos) { return false } }\n  return true\n};\n\n// eq:: (Selection) → bool\n// Test whether the selection is the same as another selection.\n\n// map:: (doc: Node, mapping: Mappable) → Selection\n// Map this selection through a [mappable](#transform.Mappable) thing. `doc`\n// should be the new document to which we are mapping.\n\n// :: () → Slice\n// Get the content of this selection as a slice.\nSelection.prototype.content = function content () {\n  return this.$from.node(0).slice(this.from, this.to, true)\n};\n\n// :: (Transaction, ?Slice)\n// Replace the selection with a slice or, if no slice is given,\n// delete the selection. Will append to the given transaction.\nSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n  // Put the new selection at the position after the inserted\n  // content. When that ended in an inline node, search backwards,\n  // to get the position after that node. If not, search forward.\n  var lastNode = content.content.lastChild, lastParent = null;\n  for (var i = 0; i < content.openEnd; i++) {\n    lastParent = lastNode;\n    lastNode = lastNode.lastChild;\n  }\n\n  var mapFrom = tr.steps.length, ranges = this.ranges;\n  for (var i$1 = 0; i$1 < ranges.length; i$1++) {\n    var ref = ranges[i$1];\n      var $from = ref.$from;\n      var $to = ref.$to;\n      var mapping = tr.mapping.slice(mapFrom);\n    tr.replaceRange(mapping.map($from.pos), mapping.map($to.pos), i$1 ? Slice.empty : content);\n    if (i$1 == 0)\n      { selectionToInsertionEnd(tr, mapFrom, (lastNode ? lastNode.isInline : lastParent && lastParent.isTextblock) ? -1 : 1); }\n  }\n};\n\n// :: (Transaction, Node)\n// Replace the selection with the given node, appending the changes\n// to the given transaction.\nSelection.prototype.replaceWith = function replaceWith (tr, node) {\n  var mapFrom = tr.steps.length, ranges = this.ranges;\n  for (var i = 0; i < ranges.length; i++) {\n    var ref = ranges[i];\n      var $from = ref.$from;\n      var $to = ref.$to;\n      var mapping = tr.mapping.slice(mapFrom);\n    var from = mapping.map($from.pos), to = mapping.map($to.pos);\n    if (i) {\n      tr.deleteRange(from, to);\n    } else {\n      tr.replaceRangeWith(from, to, node);\n      selectionToInsertionEnd(tr, mapFrom, node.isInline ? -1 : 1);\n    }\n  }\n};\n\n// toJSON:: () → Object\n// Convert the selection to a JSON representation. When implementing\n// this for a custom selection class, make sure to give the object a\n// `type` property whose value matches the ID under which you\n// [registered](#state.Selection^jsonID) your class.\n\n// :: (ResolvedPos, number, ?bool) → ?Selection\n// Find a valid cursor or leaf node selection starting at the given\n// position and searching back if `dir` is negative, and forward if\n// positive. When `textOnly` is true, only consider cursor\n// selections. Will return null when no valid selection position is\n// found.\nSelection.findFrom = function findFrom ($pos, dir, textOnly) {\n  var inner = $pos.parent.inlineContent ? new TextSelection($pos)\n      : findSelectionIn($pos.node(0), $pos.parent, $pos.pos, $pos.index(), dir, textOnly);\n  if (inner) { return inner }\n\n  for (var depth = $pos.depth - 1; depth >= 0; depth--) {\n    var found = dir < 0\n        ? findSelectionIn($pos.node(0), $pos.node(depth), $pos.before(depth + 1), $pos.index(depth), dir, textOnly)\n        : findSelectionIn($pos.node(0), $pos.node(depth), $pos.after(depth + 1), $pos.index(depth) + 1, dir, textOnly);\n    if (found) { return found }\n  }\n};\n\n// :: (ResolvedPos, ?number) → Selection\n// Find a valid cursor or leaf node selection near the given\n// position. Searches forward first by default, but if `bias` is\n// negative, it will search backwards first.\nSelection.near = function near ($pos, bias) {\n    if ( bias === void 0 ) bias = 1;\n\n  return this.findFrom($pos, bias) || this.findFrom($pos, -bias) || new AllSelection($pos.node(0))\n};\n\n// :: (Node) → Selection\n// Find the cursor or leaf node selection closest to the start of\n// the given document. Will return an\n// [`AllSelection`](#state.AllSelection) if no valid position\n// exists.\nSelection.atStart = function atStart (doc) {\n  return findSelectionIn(doc, doc, 0, 0, 1) || new AllSelection(doc)\n};\n\n// :: (Node) → Selection\n// Find the cursor or leaf node selection closest to the end of the\n// given document.\nSelection.atEnd = function atEnd (doc) {\n  return findSelectionIn(doc, doc, doc.content.size, doc.childCount, -1) || new AllSelection(doc)\n};\n\n// :: (Node, Object) → Selection\n// Deserialize the JSON representation of a selection. Must be\n// implemented for custom classes (as a static class method).\nSelection.fromJSON = function fromJSON (doc, json) {\n  if (!json || !json.type) { throw new RangeError(\"Invalid input for Selection.fromJSON\") }\n  var cls = classesById[json.type];\n  if (!cls) { throw new RangeError((\"No selection type \" + (json.type) + \" defined\")) }\n  return cls.fromJSON(doc, json)\n};\n\n// :: (string, constructor<Selection>)\n// To be able to deserialize selections from JSON, custom selection\n// classes must register themselves with an ID string, so that they\n// can be disambiguated. Try to pick something that's unlikely to\n// clash with classes from other modules.\nSelection.jsonID = function jsonID (id, selectionClass) {\n  if (id in classesById) { throw new RangeError(\"Duplicate use of selection JSON ID \" + id) }\n  classesById[id] = selectionClass;\n  selectionClass.prototype.jsonID = id;\n  return selectionClass\n};\n\n// :: () → SelectionBookmark\n// Get a [bookmark](#state.SelectionBookmark) for this selection,\n// which is a value that can be mapped without having access to a\n// current document, and later resolved to a real selection for a\n// given document again. (This is used mostly by the history to\n// track and restore old selections.) The default implementation of\n// this method just converts the selection to a text selection and\n// returns the bookmark for that.\nSelection.prototype.getBookmark = function getBookmark () {\n  return TextSelection.between(this.$anchor, this.$head).getBookmark()\n};\n\nObject.defineProperties( Selection.prototype, prototypeAccessors );\n\n// :: bool\n// Controls whether, when a selection of this type is active in the\n// browser, the selected range should be visible to the user. Defaults\n// to `true`.\nSelection.prototype.visible = true;\n\n// SelectionBookmark:: interface\n// A lightweight, document-independent representation of a selection.\n// You can define a custom bookmark type for a custom selection class\n// to make the history handle it well.\n//\n//   map:: (mapping: Mapping) → SelectionBookmark\n//   Map the bookmark through a set of changes.\n//\n//   resolve:: (doc: Node) → Selection\n//   Resolve the bookmark to a real selection again. This may need to\n//   do some error checking and may fall back to a default (usually\n//   [`TextSelection.between`](#state.TextSelection^between)) if\n//   mapping made the bookmark invalid.\n\n// ::- Represents a selected range in a document.\nvar SelectionRange = function SelectionRange($from, $to) {\n  // :: ResolvedPos\n  // The lower bound of the range.\n  this.$from = $from;\n  // :: ResolvedPos\n  // The upper bound of the range.\n  this.$to = $to;\n};\n\n// ::- A text selection represents a classical editor selection, with\n// a head (the moving side) and anchor (immobile side), both of which\n// point into textblock nodes. It can be empty (a regular cursor\n// position).\nvar TextSelection = /*@__PURE__*/(function (Selection) {\n  function TextSelection($anchor, $head) {\n    if ( $head === void 0 ) $head = $anchor;\n\n    Selection.call(this, $anchor, $head);\n  }\n\n  if ( Selection ) TextSelection.__proto__ = Selection;\n  TextSelection.prototype = Object.create( Selection && Selection.prototype );\n  TextSelection.prototype.constructor = TextSelection;\n\n  var prototypeAccessors$1 = { $cursor: { configurable: true } };\n\n  // :: ?ResolvedPos\n  // Returns a resolved position if this is a cursor selection (an\n  // empty text selection), and null otherwise.\n  prototypeAccessors$1.$cursor.get = function () { return this.$anchor.pos == this.$head.pos ? this.$head : null };\n\n  TextSelection.prototype.map = function map (doc, mapping) {\n    var $head = doc.resolve(mapping.map(this.head));\n    if (!$head.parent.inlineContent) { return Selection.near($head) }\n    var $anchor = doc.resolve(mapping.map(this.anchor));\n    return new TextSelection($anchor.parent.inlineContent ? $anchor : $head, $head)\n  };\n\n  TextSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n    Selection.prototype.replace.call(this, tr, content);\n    if (content == Slice.empty) {\n      var marks = this.$from.marksAcross(this.$to);\n      if (marks) { tr.ensureMarks(marks); }\n    }\n  };\n\n  TextSelection.prototype.eq = function eq (other) {\n    return other instanceof TextSelection && other.anchor == this.anchor && other.head == this.head\n  };\n\n  TextSelection.prototype.getBookmark = function getBookmark () {\n    return new TextBookmark(this.anchor, this.head)\n  };\n\n  TextSelection.prototype.toJSON = function toJSON () {\n    return {type: \"text\", anchor: this.anchor, head: this.head}\n  };\n\n  TextSelection.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.anchor != \"number\" || typeof json.head != \"number\")\n      { throw new RangeError(\"Invalid input for TextSelection.fromJSON\") }\n    return new TextSelection(doc.resolve(json.anchor), doc.resolve(json.head))\n  };\n\n  // :: (Node, number, ?number) → TextSelection\n  // Create a text selection from non-resolved positions.\n  TextSelection.create = function create (doc, anchor, head) {\n    if ( head === void 0 ) head = anchor;\n\n    var $anchor = doc.resolve(anchor);\n    return new this($anchor, head == anchor ? $anchor : doc.resolve(head))\n  };\n\n  // :: (ResolvedPos, ResolvedPos, ?number) → Selection\n  // Return a text selection that spans the given positions or, if\n  // they aren't text positions, find a text selection near them.\n  // `bias` determines whether the method searches forward (default)\n  // or backwards (negative number) first. Will fall back to calling\n  // [`Selection.near`](#state.Selection^near) when the document\n  // doesn't contain a valid text position.\n  TextSelection.between = function between ($anchor, $head, bias) {\n    var dPos = $anchor.pos - $head.pos;\n    if (!bias || dPos) { bias = dPos >= 0 ? 1 : -1; }\n    if (!$head.parent.inlineContent) {\n      var found = Selection.findFrom($head, bias, true) || Selection.findFrom($head, -bias, true);\n      if (found) { $head = found.$head; }\n      else { return Selection.near($head, bias) }\n    }\n    if (!$anchor.parent.inlineContent) {\n      if (dPos == 0) {\n        $anchor = $head;\n      } else {\n        $anchor = (Selection.findFrom($anchor, -bias, true) || Selection.findFrom($anchor, bias, true)).$anchor;\n        if (($anchor.pos < $head.pos) != (dPos < 0)) { $anchor = $head; }\n      }\n    }\n    return new TextSelection($anchor, $head)\n  };\n\n  Object.defineProperties( TextSelection.prototype, prototypeAccessors$1 );\n\n  return TextSelection;\n}(Selection));\n\nSelection.jsonID(\"text\", TextSelection);\n\nvar TextBookmark = function TextBookmark(anchor, head) {\n  this.anchor = anchor;\n  this.head = head;\n};\nTextBookmark.prototype.map = function map (mapping) {\n  return new TextBookmark(mapping.map(this.anchor), mapping.map(this.head))\n};\nTextBookmark.prototype.resolve = function resolve (doc) {\n  return TextSelection.between(doc.resolve(this.anchor), doc.resolve(this.head))\n};\n\n// ::- A node selection is a selection that points at a single node.\n// All nodes marked [selectable](#model.NodeSpec.selectable) can be\n// the target of a node selection. In such a selection, `from` and\n// `to` point directly before and after the selected node, `anchor`\n// equals `from`, and `head` equals `to`..\nvar NodeSelection = /*@__PURE__*/(function (Selection) {\n  function NodeSelection($pos) {\n    var node = $pos.nodeAfter;\n    var $end = $pos.node(0).resolve($pos.pos + node.nodeSize);\n    Selection.call(this, $pos, $end);\n    // :: Node The selected node.\n    this.node = node;\n  }\n\n  if ( Selection ) NodeSelection.__proto__ = Selection;\n  NodeSelection.prototype = Object.create( Selection && Selection.prototype );\n  NodeSelection.prototype.constructor = NodeSelection;\n\n  NodeSelection.prototype.map = function map (doc, mapping) {\n    var ref = mapping.mapResult(this.anchor);\n    var deleted = ref.deleted;\n    var pos = ref.pos;\n    var $pos = doc.resolve(pos);\n    if (deleted) { return Selection.near($pos) }\n    return new NodeSelection($pos)\n  };\n\n  NodeSelection.prototype.content = function content () {\n    return new Slice(Fragment.from(this.node), 0, 0)\n  };\n\n  NodeSelection.prototype.eq = function eq (other) {\n    return other instanceof NodeSelection && other.anchor == this.anchor\n  };\n\n  NodeSelection.prototype.toJSON = function toJSON () {\n    return {type: \"node\", anchor: this.anchor}\n  };\n\n  NodeSelection.prototype.getBookmark = function getBookmark () { return new NodeBookmark(this.anchor) };\n\n  NodeSelection.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.anchor != \"number\")\n      { throw new RangeError(\"Invalid input for NodeSelection.fromJSON\") }\n    return new NodeSelection(doc.resolve(json.anchor))\n  };\n\n  // :: (Node, number) → NodeSelection\n  // Create a node selection from non-resolved positions.\n  NodeSelection.create = function create (doc, from) {\n    return new this(doc.resolve(from))\n  };\n\n  // :: (Node) → bool\n  // Determines whether the given node may be selected as a node\n  // selection.\n  NodeSelection.isSelectable = function isSelectable (node) {\n    return !node.isText && node.type.spec.selectable !== false\n  };\n\n  return NodeSelection;\n}(Selection));\n\nNodeSelection.prototype.visible = false;\n\nSelection.jsonID(\"node\", NodeSelection);\n\nvar NodeBookmark = function NodeBookmark(anchor) {\n  this.anchor = anchor;\n};\nNodeBookmark.prototype.map = function map (mapping) {\n  var ref = mapping.mapResult(this.anchor);\n    var deleted = ref.deleted;\n    var pos = ref.pos;\n  return deleted ? new TextBookmark(pos, pos) : new NodeBookmark(pos)\n};\nNodeBookmark.prototype.resolve = function resolve (doc) {\n  var $pos = doc.resolve(this.anchor), node = $pos.nodeAfter;\n  if (node && NodeSelection.isSelectable(node)) { return new NodeSelection($pos) }\n  return Selection.near($pos)\n};\n\n// ::- A selection type that represents selecting the whole document\n// (which can not necessarily be expressed with a text selection, when\n// there are for example leaf block nodes at the start or end of the\n// document).\nvar AllSelection = /*@__PURE__*/(function (Selection) {\n  function AllSelection(doc) {\n    Selection.call(this, doc.resolve(0), doc.resolve(doc.content.size));\n  }\n\n  if ( Selection ) AllSelection.__proto__ = Selection;\n  AllSelection.prototype = Object.create( Selection && Selection.prototype );\n  AllSelection.prototype.constructor = AllSelection;\n\n  AllSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n    if (content == Slice.empty) {\n      tr.delete(0, tr.doc.content.size);\n      var sel = Selection.atStart(tr.doc);\n      if (!sel.eq(tr.selection)) { tr.setSelection(sel); }\n    } else {\n      Selection.prototype.replace.call(this, tr, content);\n    }\n  };\n\n  AllSelection.prototype.toJSON = function toJSON () { return {type: \"all\"} };\n\n  AllSelection.fromJSON = function fromJSON (doc) { return new AllSelection(doc) };\n\n  AllSelection.prototype.map = function map (doc) { return new AllSelection(doc) };\n\n  AllSelection.prototype.eq = function eq (other) { return other instanceof AllSelection };\n\n  AllSelection.prototype.getBookmark = function getBookmark () { return AllBookmark };\n\n  return AllSelection;\n}(Selection));\n\nSelection.jsonID(\"all\", AllSelection);\n\nvar AllBookmark = {\n  map: function map() { return this },\n  resolve: function resolve(doc) { return new AllSelection(doc) }\n};\n\n// FIXME we'll need some awareness of text direction when scanning for selections\n\n// Try to find a selection inside the given node. `pos` points at the\n// position where the search starts. When `text` is true, only return\n// text selections.\nfunction findSelectionIn(doc, node, pos, index, dir, text) {\n  if (node.inlineContent) { return TextSelection.create(doc, pos) }\n  for (var i = index - (dir > 0 ? 0 : 1); dir > 0 ? i < node.childCount : i >= 0; i += dir) {\n    var child = node.child(i);\n    if (!child.isAtom) {\n      var inner = findSelectionIn(doc, child, pos + dir, dir < 0 ? child.childCount : 0, dir, text);\n      if (inner) { return inner }\n    } else if (!text && NodeSelection.isSelectable(child)) {\n      return NodeSelection.create(doc, pos - (dir < 0 ? child.nodeSize : 0))\n    }\n    pos += child.nodeSize * dir;\n  }\n}\n\nfunction selectionToInsertionEnd(tr, startLen, bias) {\n  var last = tr.steps.length - 1;\n  if (last < startLen) { return }\n  var step = tr.steps[last];\n  if (!(step instanceof ReplaceStep || step instanceof ReplaceAroundStep)) { return }\n  var map = tr.mapping.maps[last], end;\n  map.forEach(function (_from, _to, _newFrom, newTo) { if (end == null) { end = newTo; } });\n  tr.setSelection(Selection.near(tr.doc.resolve(end), bias));\n}\n\nvar UPDATED_SEL = 1, UPDATED_MARKS = 2, UPDATED_SCROLL = 4;\n\n// ::- An editor state transaction, which can be applied to a state to\n// create an updated state. Use\n// [`EditorState.tr`](#state.EditorState.tr) to create an instance.\n//\n// Transactions track changes to the document (they are a subclass of\n// [`Transform`](#transform.Transform)), but also other state changes,\n// like selection updates and adjustments of the set of [stored\n// marks](#state.EditorState.storedMarks). In addition, you can store\n// metadata properties in a transaction, which are extra pieces of\n// information that client code or plugins can use to describe what a\n// transacion represents, so that they can update their [own\n// state](#state.StateField) accordingly.\n//\n// The [editor view](#view.EditorView) uses a few metadata properties:\n// it will attach a property `\"pointer\"` with the value `true` to\n// selection transactions directly caused by mouse or touch input, and\n// a `\"uiEvent\"` property of that may be `\"paste\"`, `\"cut\"`, or `\"drop\"`.\nvar Transaction = /*@__PURE__*/(function (Transform) {\n  function Transaction(state) {\n    Transform.call(this, state.doc);\n    // :: number\n    // The timestamp associated with this transaction, in the same\n    // format as `Date.now()`.\n    this.time = Date.now();\n    this.curSelection = state.selection;\n    // The step count for which the current selection is valid.\n    this.curSelectionFor = 0;\n    // :: ?[Mark]\n    // The stored marks set by this transaction, if any.\n    this.storedMarks = state.storedMarks;\n    // Bitfield to track which aspects of the state were updated by\n    // this transaction.\n    this.updated = 0;\n    // Object used to store metadata properties for the transaction.\n    this.meta = Object.create(null);\n  }\n\n  if ( Transform ) Transaction.__proto__ = Transform;\n  Transaction.prototype = Object.create( Transform && Transform.prototype );\n  Transaction.prototype.constructor = Transaction;\n\n  var prototypeAccessors = { selection: { configurable: true },selectionSet: { configurable: true },storedMarksSet: { configurable: true },isGeneric: { configurable: true },scrolledIntoView: { configurable: true } };\n\n  // :: Selection\n  // The transaction's current selection. This defaults to the editor\n  // selection [mapped](#state.Selection.map) through the steps in the\n  // transaction, but can be overwritten with\n  // [`setSelection`](#state.Transaction.setSelection).\n  prototypeAccessors.selection.get = function () {\n    if (this.curSelectionFor < this.steps.length) {\n      this.curSelection = this.curSelection.map(this.doc, this.mapping.slice(this.curSelectionFor));\n      this.curSelectionFor = this.steps.length;\n    }\n    return this.curSelection\n  };\n\n  // :: (Selection) → Transaction\n  // Update the transaction's current selection. Will determine the\n  // selection that the editor gets when the transaction is applied.\n  Transaction.prototype.setSelection = function setSelection (selection) {\n    if (selection.$from.doc != this.doc)\n      { throw new RangeError(\"Selection passed to setSelection must point at the current document\") }\n    this.curSelection = selection;\n    this.curSelectionFor = this.steps.length;\n    this.updated = (this.updated | UPDATED_SEL) & ~UPDATED_MARKS;\n    this.storedMarks = null;\n    return this\n  };\n\n  // :: bool\n  // Whether the selection was explicitly updated by this transaction.\n  prototypeAccessors.selectionSet.get = function () {\n    return (this.updated & UPDATED_SEL) > 0\n  };\n\n  // :: (?[Mark]) → Transaction\n  // Set the current stored marks.\n  Transaction.prototype.setStoredMarks = function setStoredMarks (marks) {\n    this.storedMarks = marks;\n    this.updated |= UPDATED_MARKS;\n    return this\n  };\n\n  // :: ([Mark]) → Transaction\n  // Make sure the current stored marks or, if that is null, the marks\n  // at the selection, match the given set of marks. Does nothing if\n  // this is already the case.\n  Transaction.prototype.ensureMarks = function ensureMarks (marks) {\n    if (!Mark.sameSet(this.storedMarks || this.selection.$from.marks(), marks))\n      { this.setStoredMarks(marks); }\n    return this\n  };\n\n  // :: (Mark) → Transaction\n  // Add a mark to the set of stored marks.\n  Transaction.prototype.addStoredMark = function addStoredMark (mark) {\n    return this.ensureMarks(mark.addToSet(this.storedMarks || this.selection.$head.marks()))\n  };\n\n  // :: (union<Mark, MarkType>) → Transaction\n  // Remove a mark or mark type from the set of stored marks.\n  Transaction.prototype.removeStoredMark = function removeStoredMark (mark) {\n    return this.ensureMarks(mark.removeFromSet(this.storedMarks || this.selection.$head.marks()))\n  };\n\n  // :: bool\n  // Whether the stored marks were explicitly set for this transaction.\n  prototypeAccessors.storedMarksSet.get = function () {\n    return (this.updated & UPDATED_MARKS) > 0\n  };\n\n  Transaction.prototype.addStep = function addStep (step, doc) {\n    Transform.prototype.addStep.call(this, step, doc);\n    this.updated = this.updated & ~UPDATED_MARKS;\n    this.storedMarks = null;\n  };\n\n  // :: (number) → Transaction\n  // Update the timestamp for the transaction.\n  Transaction.prototype.setTime = function setTime (time) {\n    this.time = time;\n    return this\n  };\n\n  // :: (Slice) → Transaction\n  // Replace the current selection with the given slice.\n  Transaction.prototype.replaceSelection = function replaceSelection (slice) {\n    this.selection.replace(this, slice);\n    return this\n  };\n\n  // :: (Node, ?bool) → Transaction\n  // Replace the selection with the given node. When `inheritMarks` is\n  // true and the content is inline, it inherits the marks from the\n  // place where it is inserted.\n  Transaction.prototype.replaceSelectionWith = function replaceSelectionWith (node, inheritMarks) {\n    var selection = this.selection;\n    if (inheritMarks !== false)\n      { node = node.mark(this.storedMarks || (selection.empty ? selection.$from.marks() : (selection.$from.marksAcross(selection.$to) || Mark.none))); }\n    selection.replaceWith(this, node);\n    return this\n  };\n\n  // :: () → Transaction\n  // Delete the selection.\n  Transaction.prototype.deleteSelection = function deleteSelection () {\n    this.selection.replace(this);\n    return this\n  };\n\n  // :: (string, from: ?number, to: ?number) → Transaction\n  // Replace the given range, or the selection if no range is given,\n  // with a text node containing the given string.\n  Transaction.prototype.insertText = function insertText (text, from, to) {\n    if ( to === void 0 ) to = from;\n\n    var schema = this.doc.type.schema;\n    if (from == null) {\n      if (!text) { return this.deleteSelection() }\n      return this.replaceSelectionWith(schema.text(text), true)\n    } else {\n      if (!text) { return this.deleteRange(from, to) }\n      var marks = this.storedMarks;\n      if (!marks) {\n        var $from = this.doc.resolve(from);\n        marks = to == from ? $from.marks() : $from.marksAcross(this.doc.resolve(to));\n      }\n      this.replaceRangeWith(from, to, schema.text(text, marks));\n      if (!this.selection.empty) { this.setSelection(Selection.near(this.selection.$to)); }\n      return this\n    }\n  };\n\n  // :: (union<string, Plugin, PluginKey>, any) → Transaction\n  // Store a metadata property in this transaction, keyed either by\n  // name or by plugin.\n  Transaction.prototype.setMeta = function setMeta (key, value) {\n    this.meta[typeof key == \"string\" ? key : key.key] = value;\n    return this\n  };\n\n  // :: (union<string, Plugin, PluginKey>) → any\n  // Retrieve a metadata property for a given name or plugin.\n  Transaction.prototype.getMeta = function getMeta (key) {\n    return this.meta[typeof key == \"string\" ? key : key.key]\n  };\n\n  // :: bool\n  // Returns true if this transaction doesn't contain any metadata,\n  // and can thus safely be extended.\n  prototypeAccessors.isGeneric.get = function () {\n    for (var _ in this.meta) { return false }\n    return true\n  };\n\n  // :: () → Transaction\n  // Indicate that the editor should scroll the selection into view\n  // when updated to the state produced by this transaction.\n  Transaction.prototype.scrollIntoView = function scrollIntoView () {\n    this.updated |= UPDATED_SCROLL;\n    return this\n  };\n\n  prototypeAccessors.scrolledIntoView.get = function () {\n    return (this.updated & UPDATED_SCROLL) > 0\n  };\n\n  Object.defineProperties( Transaction.prototype, prototypeAccessors );\n\n  return Transaction;\n}(Transform));\n\nfunction bind(f, self) {\n  return !self || !f ? f : f.bind(self)\n}\n\nvar FieldDesc = function FieldDesc(name, desc, self) {\n  this.name = name;\n  this.init = bind(desc.init, self);\n  this.apply = bind(desc.apply, self);\n};\n\nvar baseFields = [\n  new FieldDesc(\"doc\", {\n    init: function init(config) { return config.doc || config.schema.topNodeType.createAndFill() },\n    apply: function apply(tr) { return tr.doc }\n  }),\n\n  new FieldDesc(\"selection\", {\n    init: function init(config, instance) { return config.selection || Selection.atStart(instance.doc) },\n    apply: function apply(tr) { return tr.selection }\n  }),\n\n  new FieldDesc(\"storedMarks\", {\n    init: function init(config) { return config.storedMarks || null },\n    apply: function apply(tr, _marks, _old, state) { return state.selection.$cursor ? tr.storedMarks : null }\n  }),\n\n  new FieldDesc(\"scrollToSelection\", {\n    init: function init() { return 0 },\n    apply: function apply(tr, prev) { return tr.scrolledIntoView ? prev + 1 : prev }\n  })\n];\n\n// Object wrapping the part of a state object that stays the same\n// across transactions. Stored in the state's `config` property.\nvar Configuration = function Configuration(schema, plugins) {\n  var this$1 = this;\n\n  this.schema = schema;\n  this.fields = baseFields.concat();\n  this.plugins = [];\n  this.pluginsByKey = Object.create(null);\n  if (plugins) { plugins.forEach(function (plugin) {\n    if (this$1.pluginsByKey[plugin.key])\n      { throw new RangeError(\"Adding different instances of a keyed plugin (\" + plugin.key + \")\") }\n    this$1.plugins.push(plugin);\n    this$1.pluginsByKey[plugin.key] = plugin;\n    if (plugin.spec.state)\n      { this$1.fields.push(new FieldDesc(plugin.key, plugin.spec.state, plugin)); }\n  }); }\n};\n\n// ::- The state of a ProseMirror editor is represented by an object\n// of this type. A state is a persistent data structure—it isn't\n// updated, but rather a new state value is computed from an old one\n// using the [`apply`](#state.EditorState.apply) method.\n//\n// A state holds a number of built-in fields, and plugins can\n// [define](#state.PluginSpec.state) additional fields.\nvar EditorState = function EditorState(config) {\n  this.config = config;\n};\n\nvar prototypeAccessors$1 = { schema: { configurable: true },plugins: { configurable: true },tr: { configurable: true } };\n\n// doc:: Node\n// The current document.\n\n// selection:: Selection\n// The selection.\n\n// storedMarks:: ?[Mark]\n// A set of marks to apply to the next input. Will be null when\n// no explicit marks have been set.\n\n// :: Schema\n// The schema of the state's document.\nprototypeAccessors$1.schema.get = function () {\n  return this.config.schema\n};\n\n// :: [Plugin]\n// The plugins that are active in this state.\nprototypeAccessors$1.plugins.get = function () {\n  return this.config.plugins\n};\n\n// :: (Transaction) → EditorState\n// Apply the given transaction to produce a new state.\nEditorState.prototype.apply = function apply (tr) {\n  return this.applyTransaction(tr).state\n};\n\n// : (Transaction) → bool\nEditorState.prototype.filterTransaction = function filterTransaction (tr, ignore) {\n    if ( ignore === void 0 ) ignore = -1;\n\n  for (var i = 0; i < this.config.plugins.length; i++) { if (i != ignore) {\n    var plugin = this.config.plugins[i];\n    if (plugin.spec.filterTransaction && !plugin.spec.filterTransaction.call(plugin, tr, this))\n      { return false }\n  } }\n  return true\n};\n\n// :: (Transaction) → {state: EditorState, transactions: [Transaction]}\n// Verbose variant of [`apply`](#state.EditorState.apply) that\n// returns the precise transactions that were applied (which might\n// be influenced by the [transaction\n// hooks](#state.PluginSpec.filterTransaction) of\n// plugins) along with the new state.\nEditorState.prototype.applyTransaction = function applyTransaction (rootTr) {\n  if (!this.filterTransaction(rootTr)) { return {state: this, transactions: []} }\n\n  var trs = [rootTr], newState = this.applyInner(rootTr), seen = null;\n  // This loop repeatedly gives plugins a chance to respond to\n  // transactions as new transactions are added, making sure to only\n  // pass the transactions the plugin did not see before.\n   for (;;) {\n    var haveNew = false;\n    for (var i = 0; i < this.config.plugins.length; i++) {\n      var plugin = this.config.plugins[i];\n      if (plugin.spec.appendTransaction) {\n        var n = seen ? seen[i].n : 0, oldState = seen ? seen[i].state : this;\n        var tr = n < trs.length &&\n            plugin.spec.appendTransaction.call(plugin, n ? trs.slice(n) : trs, oldState, newState);\n        if (tr && newState.filterTransaction(tr, i)) {\n          tr.setMeta(\"appendedTransaction\", rootTr);\n          if (!seen) {\n            seen = [];\n            for (var j = 0; j < this.config.plugins.length; j++)\n              { seen.push(j < i ? {state: newState, n: trs.length} : {state: this, n: 0}); }\n          }\n          trs.push(tr);\n          newState = newState.applyInner(tr);\n          haveNew = true;\n        }\n        if (seen) { seen[i] = {state: newState, n: trs.length}; }\n      }\n    }\n    if (!haveNew) { return {state: newState, transactions: trs} }\n  }\n};\n\n// : (Transaction) → EditorState\nEditorState.prototype.applyInner = function applyInner (tr) {\n  if (!tr.before.eq(this.doc)) { throw new RangeError(\"Applying a mismatched transaction\") }\n  var newInstance = new EditorState(this.config), fields = this.config.fields;\n  for (var i = 0; i < fields.length; i++) {\n    var field = fields[i];\n    newInstance[field.name] = field.apply(tr, this[field.name], this, newInstance);\n  }\n  for (var i$1 = 0; i$1 < applyListeners.length; i$1++) { applyListeners[i$1](this, tr, newInstance); }\n  return newInstance\n};\n\n// :: Transaction\n// Start a [transaction](#state.Transaction) from this state.\nprototypeAccessors$1.tr.get = function () { return new Transaction(this) };\n\n// :: (Object) → EditorState\n// Create a new state.\n//\n// config::- Configuration options. Must contain `schema` or `doc` (or both).\n//\n//    schema:: ?Schema\n//    The schema to use (only relevant if no `doc` is specified).\n//\n//    doc:: ?Node\n//    The starting document.\n//\n//    selection:: ?Selection\n//    A valid selection in the document.\n//\n//    storedMarks:: ?[Mark]\n//    The initial set of [stored marks](#state.EditorState.storedMarks).\n//\n//    plugins:: ?[Plugin]\n//    The plugins that should be active in this state.\nEditorState.create = function create (config) {\n  var $config = new Configuration(config.doc ? config.doc.type.schema : config.schema, config.plugins);\n  var instance = new EditorState($config);\n  for (var i = 0; i < $config.fields.length; i++)\n    { instance[$config.fields[i].name] = $config.fields[i].init(config, instance); }\n  return instance\n};\n\n// :: (Object) → EditorState\n// Create a new state based on this one, but with an adjusted set of\n// active plugins. State fields that exist in both sets of plugins\n// are kept unchanged. Those that no longer exist are dropped, and\n// those that are new are initialized using their\n// [`init`](#state.StateField.init) method, passing in the new\n// configuration object..\n//\n// config::- configuration options\n//\n//   plugins:: [Plugin]\n//   New set of active plugins.\nEditorState.prototype.reconfigure = function reconfigure (config) {\n  var $config = new Configuration(this.schema, config.plugins);\n  var fields = $config.fields, instance = new EditorState($config);\n  for (var i = 0; i < fields.length; i++) {\n    var name = fields[i].name;\n    instance[name] = this.hasOwnProperty(name) ? this[name] : fields[i].init(config, instance);\n  }\n  return instance\n};\n\n// :: (?union<Object<Plugin>, string, number>) → Object\n// Serialize this state to JSON. If you want to serialize the state\n// of plugins, pass an object mapping property names to use in the\n// resulting JSON object to plugin objects. The argument may also be\n// a string or number, in which case it is ignored, to support the\n// way `JSON.stringify` calls `toString` methods.\nEditorState.prototype.toJSON = function toJSON (pluginFields) {\n  var result = {doc: this.doc.toJSON(), selection: this.selection.toJSON()};\n  if (this.storedMarks) { result.storedMarks = this.storedMarks.map(function (m) { return m.toJSON(); }); }\n  if (pluginFields && typeof pluginFields == 'object') { for (var prop in pluginFields) {\n    if (prop == \"doc\" || prop == \"selection\")\n      { throw new RangeError(\"The JSON fields `doc` and `selection` are reserved\") }\n    var plugin = pluginFields[prop], state = plugin.spec.state;\n    if (state && state.toJSON) { result[prop] = state.toJSON.call(plugin, this[plugin.key]); }\n  } }\n  return result\n};\n\n// :: (Object, Object, ?Object<Plugin>) → EditorState\n// Deserialize a JSON representation of a state. `config` should\n// have at least a `schema` field, and should contain array of\n// plugins to initialize the state with. `pluginFields` can be used\n// to deserialize the state of plugins, by associating plugin\n// instances with the property names they use in the JSON object.\n//\n// config::- configuration options\n//\n//   schema:: Schema\n//   The schema to use.\n//\n//   plugins:: ?[Plugin]\n//   The set of active plugins.\nEditorState.fromJSON = function fromJSON (config, json, pluginFields) {\n  if (!json) { throw new RangeError(\"Invalid input for EditorState.fromJSON\") }\n  if (!config.schema) { throw new RangeError(\"Required config field 'schema' missing\") }\n  var $config = new Configuration(config.schema, config.plugins);\n  var instance = new EditorState($config);\n  $config.fields.forEach(function (field) {\n    if (field.name == \"doc\") {\n      instance.doc = Node.fromJSON(config.schema, json.doc);\n    } else if (field.name == \"selection\") {\n      instance.selection = Selection.fromJSON(instance.doc, json.selection);\n    } else if (field.name == \"storedMarks\") {\n      if (json.storedMarks) { instance.storedMarks = json.storedMarks.map(config.schema.markFromJSON); }\n    } else {\n      if (pluginFields) { for (var prop in pluginFields) {\n        var plugin = pluginFields[prop], state = plugin.spec.state;\n        if (plugin.key == field.name && state && state.fromJSON &&\n            Object.prototype.hasOwnProperty.call(json, prop)) {\n          // This field belongs to a plugin mapped to a JSON field, read it from there.\n          instance[field.name] = state.fromJSON.call(plugin, config, json[prop], instance);\n          return\n        }\n      } }\n      instance[field.name] = field.init(config, instance);\n    }\n  });\n  return instance\n};\n\n// Kludge to allow the view to track mappings between different\n// instances of a state.\n//\n// FIXME this is no longer needed as of prosemirror-view 1.9.0,\n// though due to backwards-compat we should probably keep it around\n// for a while (if only as a no-op)\nEditorState.addApplyListener = function addApplyListener (f) {\n  applyListeners.push(f);\n};\nEditorState.removeApplyListener = function removeApplyListener (f) {\n  var found = applyListeners.indexOf(f);\n  if (found > -1) { applyListeners.splice(found, 1); }\n};\n\nObject.defineProperties( EditorState.prototype, prototypeAccessors$1 );\n\nvar applyListeners = [];\n\n// PluginSpec:: interface\n//\n// This is the type passed to the [`Plugin`](#state.Plugin)\n// constructor. It provides a definition for a plugin.\n//\n//   props:: ?EditorProps\n//   The [view props](#view.EditorProps) added by this plugin. Props\n//   that are functions will be bound to have the plugin instance as\n//   their `this` binding.\n//\n//   state:: ?StateField<any>\n//   Allows a plugin to define a [state field](#state.StateField), an\n//   extra slot in the state object in which it can keep its own data.\n//\n//   key:: ?PluginKey\n//   Can be used to make this a keyed plugin. You can have only one\n//   plugin with a given key in a given state, but it is possible to\n//   access the plugin's configuration and state through the key,\n//   without having access to the plugin instance object.\n//\n//   view:: ?(EditorView) → Object\n//   When the plugin needs to interact with the editor view, or\n//   set something up in the DOM, use this field. The function\n//   will be called when the plugin's state is associated with an\n//   editor view.\n//\n//     return::-\n//     Should return an object with the following optional\n//     properties:\n//\n//       update:: ?(view: EditorView, prevState: EditorState)\n//       Called whenever the view's state is updated.\n//\n//       destroy:: ?()\n//       Called when the view is destroyed or receives a state\n//       with different plugins.\n//\n//   filterTransaction:: ?(Transaction, EditorState) → bool\n//   When present, this will be called before a transaction is\n//   applied by the state, allowing the plugin to cancel it (by\n//   returning false).\n//\n//   appendTransaction:: ?(transactions: [Transaction], oldState: EditorState, newState: EditorState) → ?Transaction\n//   Allows the plugin to append another transaction to be applied\n//   after the given array of transactions. When another plugin\n//   appends a transaction after this was called, it is called again\n//   with the new state and new transactions—but only the new\n//   transactions, i.e. it won't be passed transactions that it\n//   already saw.\n\nfunction bindProps(obj, self, target) {\n  for (var prop in obj) {\n    var val = obj[prop];\n    if (val instanceof Function) { val = val.bind(self); }\n    else if (prop == \"handleDOMEvents\") { val = bindProps(val, self, {}); }\n    target[prop] = val;\n  }\n  return target\n}\n\n// ::- Plugins bundle functionality that can be added to an editor.\n// They are part of the [editor state](#state.EditorState) and\n// may influence that state and the view that contains it.\nvar Plugin = function Plugin(spec) {\n  // :: EditorProps\n  // The [props](#view.EditorProps) exported by this plugin.\n  this.props = {};\n  if (spec.props) { bindProps(spec.props, this, this.props); }\n  // :: Object\n  // The plugin's [spec object](#state.PluginSpec).\n  this.spec = spec;\n  this.key = spec.key ? spec.key.key : createKey(\"plugin\");\n};\n\n// :: (EditorState) → any\n// Extract the plugin's state field from an editor state.\nPlugin.prototype.getState = function getState (state) { return state[this.key] };\n\n// StateField:: interface<T>\n// A plugin spec may provide a state field (under its\n// [`state`](#state.PluginSpec.state) property) of this type, which\n// describes the state it wants to keep. Functions provided here are\n// always called with the plugin instance as their `this` binding.\n//\n//   init:: (config: Object, instance: EditorState) → T\n//   Initialize the value of the field. `config` will be the object\n//   passed to [`EditorState.create`](#state.EditorState^create). Note\n//   that `instance` is a half-initialized state instance, and will\n//   not have values for plugin fields initialized after this one.\n//\n//   apply:: (tr: Transaction, value: T, oldState: EditorState, newState: EditorState) → T\n//   Apply the given transaction to this state field, producing a new\n//   field value. Note that the `newState` argument is again a partially\n//   constructed state does not yet contain the state from plugins\n//   coming after this one.\n//\n//   toJSON:: ?(value: T) → *\n//   Convert this field to JSON. Optional, can be left off to disable\n//   JSON serialization for the field.\n//\n//   fromJSON:: ?(config: Object, value: *, state: EditorState) → T\n//   Deserialize the JSON representation of this field. Note that the\n//   `state` argument is again a half-initialized state.\n\nvar keys = Object.create(null);\n\nfunction createKey(name) {\n  if (name in keys) { return name + \"$\" + ++keys[name] }\n  keys[name] = 0;\n  return name + \"$\"\n}\n\n// ::- A key is used to [tag](#state.PluginSpec.key)\n// plugins in a way that makes it possible to find them, given an\n// editor state. Assigning a key does mean only one plugin of that\n// type can be active in a state.\nvar PluginKey = function PluginKey(name) {\nif ( name === void 0 ) name = \"key\";\n this.key = createKey(name); };\n\n// :: (EditorState) → ?Plugin\n// Get the active plugin with this key, if any, from an editor\n// state.\nPluginKey.prototype.get = function get (state) { return state.config.pluginsByKey[this.key] };\n\n// :: (EditorState) → ?any\n// Get the plugin's state from an editor state.\nPluginKey.prototype.getState = function getState (state) { return state[this.key] };\n\nexport { AllSelection, EditorState, NodeSelection, Plugin, PluginKey, Selection, SelectionRange, TextSelection, Transaction };\n//# sourceMappingURL=index.es.js.map\n","import { ReplaceError, Slice, Fragment, MarkType } from 'prosemirror-model';\n\n// Mappable:: interface\n// There are several things that positions can be mapped through.\n// Such objects conform to this interface.\n//\n//   map:: (pos: number, assoc: ?number) → number\n//   Map a position through this object. When given, `assoc` (should\n//   be -1 or 1, defaults to 1) determines with which side the\n//   position is associated, which determines in which direction to\n//   move when a chunk of content is inserted at the mapped position.\n//\n//   mapResult:: (pos: number, assoc: ?number) → MapResult\n//   Map a position, and return an object containing additional\n//   information about the mapping. The result's `deleted` field tells\n//   you whether the position was deleted (completely enclosed in a\n//   replaced range) during the mapping. When content on only one side\n//   is deleted, the position itself is only considered deleted when\n//   `assoc` points in the direction of the deleted content.\n\n// Recovery values encode a range index and an offset. They are\n// represented as numbers, because tons of them will be created when\n// mapping, for example, a large number of decorations. The number's\n// lower 16 bits provide the index, the remaining bits the offset.\n//\n// Note: We intentionally don't use bit shift operators to en- and\n// decode these, since those clip to 32 bits, which we might in rare\n// cases want to overflow. A 64-bit float can represent 48-bit\n// integers precisely.\n\nvar lower16 = 0xffff;\nvar factor16 = Math.pow(2, 16);\n\nfunction makeRecover(index, offset) { return index + offset * factor16 }\nfunction recoverIndex(value) { return value & lower16 }\nfunction recoverOffset(value) { return (value - (value & lower16)) / factor16 }\n\n// ::- An object representing a mapped position with extra\n// information.\nvar MapResult = function MapResult(pos, deleted, recover) {\n  if ( deleted === void 0 ) deleted = false;\n  if ( recover === void 0 ) recover = null;\n\n  // :: number The mapped version of the position.\n  this.pos = pos;\n  // :: bool Tells you whether the position was deleted, that is,\n  // whether the step removed its surroundings from the document.\n  this.deleted = deleted;\n  this.recover = recover;\n};\n\n// :: class extends Mappable\n// A map describing the deletions and insertions made by a step, which\n// can be used to find the correspondence between positions in the\n// pre-step version of a document and the same position in the\n// post-step version.\nvar StepMap = function StepMap(ranges, inverted) {\n  if ( inverted === void 0 ) inverted = false;\n\n  this.ranges = ranges;\n  this.inverted = inverted;\n};\n\nStepMap.prototype.recover = function recover (value) {\n  var diff = 0, index = recoverIndex(value);\n  if (!this.inverted) { for (var i = 0; i < index; i++)\n    { diff += this.ranges[i * 3 + 2] - this.ranges[i * 3 + 1]; } }\n  return this.ranges[index * 3] + diff + recoverOffset(value)\n};\n\n// : (number, ?number) → MapResult\nStepMap.prototype.mapResult = function mapResult (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, false) };\n\n// : (number, ?number) → number\nStepMap.prototype.map = function map (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, true) };\n\nStepMap.prototype._map = function _map (pos, assoc, simple) {\n  var diff = 0, oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i] - (this.inverted ? diff : 0);\n    if (start > pos) { break }\n    var oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex], end = start + oldSize;\n    if (pos <= end) {\n      var side = !oldSize ? assoc : pos == start ? -1 : pos == end ? 1 : assoc;\n      var result = start + diff + (side < 0 ? 0 : newSize);\n      if (simple) { return result }\n      var recover = pos == (assoc < 0 ? start : end) ? null : makeRecover(i / 3, pos - start);\n      return new MapResult(result, assoc < 0 ? pos != start : pos != end, recover)\n    }\n    diff += newSize - oldSize;\n  }\n  return simple ? pos + diff : new MapResult(pos + diff)\n};\n\nStepMap.prototype.touches = function touches (pos, recover) {\n  var diff = 0, index = recoverIndex(recover);\n  var oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i] - (this.inverted ? diff : 0);\n    if (start > pos) { break }\n    var oldSize = this.ranges[i + oldIndex], end = start + oldSize;\n    if (pos <= end && i == index * 3) { return true }\n    diff += this.ranges[i + newIndex] - oldSize;\n  }\n  return false\n};\n\n// :: ((oldStart: number, oldEnd: number, newStart: number, newEnd: number))\n// Calls the given function on each of the changed ranges included in\n// this map.\nStepMap.prototype.forEach = function forEach (f) {\n  var oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0, diff = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i], oldStart = start - (this.inverted ? diff : 0), newStart = start + (this.inverted ? 0 : diff);\n    var oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex];\n    f(oldStart, oldStart + oldSize, newStart, newStart + newSize);\n    diff += newSize - oldSize;\n  }\n};\n\n// :: () → StepMap\n// Create an inverted version of this map. The result can be used to\n// map positions in the post-step document to the pre-step document.\nStepMap.prototype.invert = function invert () {\n  return new StepMap(this.ranges, !this.inverted)\n};\n\nStepMap.prototype.toString = function toString () {\n  return (this.inverted ? \"-\" : \"\") + JSON.stringify(this.ranges)\n};\n\n// :: (n: number) → StepMap\n// Create a map that moves all positions by offset `n` (which may be\n// negative). This can be useful when applying steps meant for a\n// sub-document to a larger document, or vice-versa.\nStepMap.offset = function offset (n) {\n  return n == 0 ? StepMap.empty : new StepMap(n < 0 ? [0, -n, 0] : [0, 0, n])\n};\n\nStepMap.empty = new StepMap([]);\n\n// :: class extends Mappable\n// A mapping represents a pipeline of zero or more [step\n// maps](#transform.StepMap). It has special provisions for losslessly\n// handling mapping positions through a series of steps in which some\n// steps are inverted versions of earlier steps. (This comes up when\n// ‘[rebasing](/docs/guide/#transform.rebasing)’ steps for\n// collaboration or history management.)\nvar Mapping = function Mapping(maps, mirror, from, to) {\n  // :: [StepMap]\n  // The step maps in this mapping.\n  this.maps = maps || [];\n  // :: number\n  // The starting position in the `maps` array, used when `map` or\n  // `mapResult` is called.\n  this.from = from || 0;\n  // :: number\n  // The end position in the `maps` array.\n  this.to = to == null ? this.maps.length : to;\n  this.mirror = mirror;\n};\n\n// :: (?number, ?number) → Mapping\n// Create a mapping that maps only through a part of this one.\nMapping.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.maps.length;\n\n  return new Mapping(this.maps, this.mirror, from, to)\n};\n\nMapping.prototype.copy = function copy () {\n  return new Mapping(this.maps.slice(), this.mirror && this.mirror.slice(), this.from, this.to)\n};\n\n// :: (StepMap, ?number)\n// Add a step map to the end of this mapping. If `mirrors` is\n// given, it should be the index of the step map that is the mirror\n// image of this one.\nMapping.prototype.appendMap = function appendMap (map, mirrors) {\n  this.to = this.maps.push(map);\n  if (mirrors != null) { this.setMirror(this.maps.length - 1, mirrors); }\n};\n\n// :: (Mapping)\n// Add all the step maps in a given mapping to this one (preserving\n// mirroring information).\nMapping.prototype.appendMapping = function appendMapping (mapping) {\n  for (var i = 0, startSize = this.maps.length; i < mapping.maps.length; i++) {\n    var mirr = mapping.getMirror(i);\n    this.appendMap(mapping.maps[i], mirr != null && mirr < i ? startSize + mirr : null);\n  }\n};\n\n// :: (number) → ?number\n// Finds the offset of the step map that mirrors the map at the\n// given offset, in this mapping (as per the second argument to\n// `appendMap`).\nMapping.prototype.getMirror = function getMirror (n) {\n  if (this.mirror) { for (var i = 0; i < this.mirror.length; i++)\n    { if (this.mirror[i] == n) { return this.mirror[i + (i % 2 ? -1 : 1)] } } }\n};\n\nMapping.prototype.setMirror = function setMirror (n, m) {\n  if (!this.mirror) { this.mirror = []; }\n  this.mirror.push(n, m);\n};\n\n// :: (Mapping)\n// Append the inverse of the given mapping to this one.\nMapping.prototype.appendMappingInverted = function appendMappingInverted (mapping) {\n  for (var i = mapping.maps.length - 1, totalSize = this.maps.length + mapping.maps.length; i >= 0; i--) {\n    var mirr = mapping.getMirror(i);\n    this.appendMap(mapping.maps[i].invert(), mirr != null && mirr > i ? totalSize - mirr - 1 : null);\n  }\n};\n\n// :: () → Mapping\n// Create an inverted version of this mapping.\nMapping.prototype.invert = function invert () {\n  var inverse = new Mapping;\n  inverse.appendMappingInverted(this);\n  return inverse\n};\n\n// : (number, ?number) → number\n// Map a position through this mapping.\nMapping.prototype.map = function map (pos, assoc) {\n    if ( assoc === void 0 ) assoc = 1;\n\n  if (this.mirror) { return this._map(pos, assoc, true) }\n  for (var i = this.from; i < this.to; i++)\n    { pos = this.maps[i].map(pos, assoc); }\n  return pos\n};\n\n// : (number, ?number) → MapResult\n// Map a position through this mapping, returning a mapping\n// result.\nMapping.prototype.mapResult = function mapResult (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, false) };\n\nMapping.prototype._map = function _map (pos, assoc, simple) {\n  var deleted = false;\n\n  for (var i = this.from; i < this.to; i++) {\n    var map = this.maps[i], result = map.mapResult(pos, assoc);\n    if (result.recover != null) {\n      var corr = this.getMirror(i);\n      if (corr != null && corr > i && corr < this.to) {\n        i = corr;\n        pos = this.maps[corr].recover(result.recover);\n        continue\n      }\n    }\n\n    if (result.deleted) { deleted = true; }\n    pos = result.pos;\n  }\n\n  return simple ? pos : new MapResult(pos, deleted)\n};\n\nfunction TransformError(message) {\n  var err = Error.call(this, message);\n  err.__proto__ = TransformError.prototype;\n  return err\n}\n\nTransformError.prototype = Object.create(Error.prototype);\nTransformError.prototype.constructor = TransformError;\nTransformError.prototype.name = \"TransformError\";\n\n// ::- Abstraction to build up and track an array of\n// [steps](#transform.Step) representing a document transformation.\n//\n// Most transforming methods return the `Transform` object itself, so\n// that they can be chained.\nvar Transform = function Transform(doc) {\n  // :: Node\n  // The current document (the result of applying the steps in the\n  // transform).\n  this.doc = doc;\n  // :: [Step]\n  // The steps in this transform.\n  this.steps = [];\n  // :: [Node]\n  // The documents before each of the steps.\n  this.docs = [];\n  // :: Mapping\n  // A mapping with the maps for each of the steps in this transform.\n  this.mapping = new Mapping;\n};\n\nvar prototypeAccessors = { before: { configurable: true },docChanged: { configurable: true } };\n\n// :: Node The starting document.\nprototypeAccessors.before.get = function () { return this.docs.length ? this.docs[0] : this.doc };\n\n// :: (step: Step) → this\n// Apply a new step in this transform, saving the result. Throws an\n// error when the step fails.\nTransform.prototype.step = function step (object) {\n  var result = this.maybeStep(object);\n  if (result.failed) { throw new TransformError(result.failed) }\n  return this\n};\n\n// :: (Step) → StepResult\n// Try to apply a step in this transformation, ignoring it if it\n// fails. Returns the step result.\nTransform.prototype.maybeStep = function maybeStep (step) {\n  var result = step.apply(this.doc);\n  if (!result.failed) { this.addStep(step, result.doc); }\n  return result\n};\n\n// :: bool\n// True when the document has been changed (when there are any\n// steps).\nprototypeAccessors.docChanged.get = function () {\n  return this.steps.length > 0\n};\n\nTransform.prototype.addStep = function addStep (step, doc) {\n  this.docs.push(this.doc);\n  this.steps.push(step);\n  this.mapping.appendMap(step.getMap());\n  this.doc = doc;\n};\n\nObject.defineProperties( Transform.prototype, prototypeAccessors );\n\nfunction mustOverride() { throw new Error(\"Override me\") }\n\nvar stepsByID = Object.create(null);\n\n// ::- A step object represents an atomic change. It generally applies\n// only to the document it was created for, since the positions\n// stored in it will only make sense for that document.\n//\n// New steps are defined by creating classes that extend `Step`,\n// overriding the `apply`, `invert`, `map`, `getMap` and `fromJSON`\n// methods, and registering your class with a unique\n// JSON-serialization identifier using\n// [`Step.jsonID`](#transform.Step^jsonID).\nvar Step = function Step () {};\n\nStep.prototype.apply = function apply (_doc) { return mustOverride() };\n\n// :: () → StepMap\n// Get the step map that represents the changes made by this step,\n// and which can be used to transform between positions in the old\n// and the new document.\nStep.prototype.getMap = function getMap () { return StepMap.empty };\n\n// :: (doc: Node) → Step\n// Create an inverted version of this step. Needs the document as it\n// was before the step as argument.\nStep.prototype.invert = function invert (_doc) { return mustOverride() };\n\n// :: (mapping: Mappable) → ?Step\n// Map this step through a mappable thing, returning either a\n// version of that step with its positions adjusted, or `null` if\n// the step was entirely deleted by the mapping.\nStep.prototype.map = function map (_mapping) { return mustOverride() };\n\n// :: (other: Step) → ?Step\n// Try to merge this step with another one, to be applied directly\n// after it. Returns the merged step when possible, null if the\n// steps can't be merged.\nStep.prototype.merge = function merge (_other) { return null };\n\n// :: () → Object\n// Create a JSON-serializeable representation of this step. When\n// defining this for a custom subclass, make sure the result object\n// includes the step type's [JSON id](#transform.Step^jsonID) under\n// the `stepType` property.\nStep.prototype.toJSON = function toJSON () { return mustOverride() };\n\n// :: (Schema, Object) → Step\n// Deserialize a step from its JSON representation. Will call\n// through to the step class' own implementation of this method.\nStep.fromJSON = function fromJSON (schema, json) {\n  if (!json || !json.stepType) { throw new RangeError(\"Invalid input for Step.fromJSON\") }\n  var type = stepsByID[json.stepType];\n  if (!type) { throw new RangeError((\"No step type \" + (json.stepType) + \" defined\")) }\n  return type.fromJSON(schema, json)\n};\n\n// :: (string, constructor<Step>)\n// To be able to serialize steps to JSON, each step needs a string\n// ID to attach to its JSON representation. Use this method to\n// register an ID for your step classes. Try to pick something\n// that's unlikely to clash with steps from other modules.\nStep.jsonID = function jsonID (id, stepClass) {\n  if (id in stepsByID) { throw new RangeError(\"Duplicate use of step JSON ID \" + id) }\n  stepsByID[id] = stepClass;\n  stepClass.prototype.jsonID = id;\n  return stepClass\n};\n\n// ::- The result of [applying](#transform.Step.apply) a step. Contains either a\n// new document or a failure value.\nvar StepResult = function StepResult(doc, failed) {\n  // :: ?Node The transformed document.\n  this.doc = doc;\n  // :: ?string Text providing information about a failed step.\n  this.failed = failed;\n};\n\n// :: (Node) → StepResult\n// Create a successful step result.\nStepResult.ok = function ok (doc) { return new StepResult(doc, null) };\n\n// :: (string) → StepResult\n// Create a failed step result.\nStepResult.fail = function fail (message) { return new StepResult(null, message) };\n\n// :: (Node, number, number, Slice) → StepResult\n// Call [`Node.replace`](#model.Node.replace) with the given\n// arguments. Create a successful result if it succeeds, and a\n// failed one if it throws a `ReplaceError`.\nStepResult.fromReplace = function fromReplace (doc, from, to, slice) {\n  try {\n    return StepResult.ok(doc.replace(from, to, slice))\n  } catch (e) {\n    if (e instanceof ReplaceError) { return StepResult.fail(e.message) }\n    throw e\n  }\n};\n\n// ::- Replace a part of the document with a slice of new content.\nvar ReplaceStep = /*@__PURE__*/(function (Step) {\n  function ReplaceStep(from, to, slice, structure) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.slice = slice;\n    this.structure = !!structure;\n  }\n\n  if ( Step ) ReplaceStep.__proto__ = Step;\n  ReplaceStep.prototype = Object.create( Step && Step.prototype );\n  ReplaceStep.prototype.constructor = ReplaceStep;\n\n  ReplaceStep.prototype.apply = function apply (doc) {\n    if (this.structure && contentBetween(doc, this.from, this.to))\n      { return StepResult.fail(\"Structure replace would overwrite content\") }\n    return StepResult.fromReplace(doc, this.from, this.to, this.slice)\n  };\n\n  ReplaceStep.prototype.getMap = function getMap () {\n    return new StepMap([this.from, this.to - this.from, this.slice.size])\n  };\n\n  ReplaceStep.prototype.invert = function invert (doc) {\n    return new ReplaceStep(this.from, this.from + this.slice.size, doc.slice(this.from, this.to))\n  };\n\n  ReplaceStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted) { return null }\n    return new ReplaceStep(from.pos, Math.max(from.pos, to.pos), this.slice)\n  };\n\n  ReplaceStep.prototype.merge = function merge (other) {\n    if (!(other instanceof ReplaceStep) || other.structure != this.structure) { return null }\n\n    if (this.from + this.slice.size == other.from && !this.slice.openEnd && !other.slice.openStart) {\n      var slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(this.slice.content.append(other.slice.content), this.slice.openStart, other.slice.openEnd);\n      return new ReplaceStep(this.from, this.to + (other.to - other.from), slice, this.structure)\n    } else if (other.to == this.from && !this.slice.openStart && !other.slice.openEnd) {\n      var slice$1 = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(other.slice.content.append(this.slice.content), other.slice.openStart, this.slice.openEnd);\n      return new ReplaceStep(other.from, this.to, slice$1, this.structure)\n    } else {\n      return null\n    }\n  };\n\n  ReplaceStep.prototype.toJSON = function toJSON () {\n    var json = {stepType: \"replace\", from: this.from, to: this.to};\n    if (this.slice.size) { json.slice = this.slice.toJSON(); }\n    if (this.structure) { json.structure = true; }\n    return json\n  };\n\n  ReplaceStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for ReplaceStep.fromJSON\") }\n    return new ReplaceStep(json.from, json.to, Slice.fromJSON(schema, json.slice), !!json.structure)\n  };\n\n  return ReplaceStep;\n}(Step));\n\nStep.jsonID(\"replace\", ReplaceStep);\n\n// ::- Replace a part of the document with a slice of content, but\n// preserve a range of the replaced content by moving it into the\n// slice.\nvar ReplaceAroundStep = /*@__PURE__*/(function (Step) {\n  function ReplaceAroundStep(from, to, gapFrom, gapTo, slice, insert, structure) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.gapFrom = gapFrom;\n    this.gapTo = gapTo;\n    this.slice = slice;\n    this.insert = insert;\n    this.structure = !!structure;\n  }\n\n  if ( Step ) ReplaceAroundStep.__proto__ = Step;\n  ReplaceAroundStep.prototype = Object.create( Step && Step.prototype );\n  ReplaceAroundStep.prototype.constructor = ReplaceAroundStep;\n\n  ReplaceAroundStep.prototype.apply = function apply (doc) {\n    if (this.structure && (contentBetween(doc, this.from, this.gapFrom) ||\n                           contentBetween(doc, this.gapTo, this.to)))\n      { return StepResult.fail(\"Structure gap-replace would overwrite content\") }\n\n    var gap = doc.slice(this.gapFrom, this.gapTo);\n    if (gap.openStart || gap.openEnd)\n      { return StepResult.fail(\"Gap is not a flat range\") }\n    var inserted = this.slice.insertAt(this.insert, gap.content);\n    if (!inserted) { return StepResult.fail(\"Content does not fit in gap\") }\n    return StepResult.fromReplace(doc, this.from, this.to, inserted)\n  };\n\n  ReplaceAroundStep.prototype.getMap = function getMap () {\n    return new StepMap([this.from, this.gapFrom - this.from, this.insert,\n                        this.gapTo, this.to - this.gapTo, this.slice.size - this.insert])\n  };\n\n  ReplaceAroundStep.prototype.invert = function invert (doc) {\n    var gap = this.gapTo - this.gapFrom;\n    return new ReplaceAroundStep(this.from, this.from + this.slice.size + gap,\n                                 this.from + this.insert, this.from + this.insert + gap,\n                                 doc.slice(this.from, this.to).removeBetween(this.gapFrom - this.from, this.gapTo - this.from),\n                                 this.gapFrom - this.from, this.structure)\n  };\n\n  ReplaceAroundStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    var gapFrom = mapping.map(this.gapFrom, -1), gapTo = mapping.map(this.gapTo, 1);\n    if ((from.deleted && to.deleted) || gapFrom < from.pos || gapTo > to.pos) { return null }\n    return new ReplaceAroundStep(from.pos, to.pos, gapFrom, gapTo, this.slice, this.insert, this.structure)\n  };\n\n  ReplaceAroundStep.prototype.toJSON = function toJSON () {\n    var json = {stepType: \"replaceAround\", from: this.from, to: this.to,\n                gapFrom: this.gapFrom, gapTo: this.gapTo, insert: this.insert};\n    if (this.slice.size) { json.slice = this.slice.toJSON(); }\n    if (this.structure) { json.structure = true; }\n    return json\n  };\n\n  ReplaceAroundStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\" ||\n        typeof json.gapFrom != \"number\" || typeof json.gapTo != \"number\" || typeof json.insert != \"number\")\n      { throw new RangeError(\"Invalid input for ReplaceAroundStep.fromJSON\") }\n    return new ReplaceAroundStep(json.from, json.to, json.gapFrom, json.gapTo,\n                                 Slice.fromJSON(schema, json.slice), json.insert, !!json.structure)\n  };\n\n  return ReplaceAroundStep;\n}(Step));\n\nStep.jsonID(\"replaceAround\", ReplaceAroundStep);\n\nfunction contentBetween(doc, from, to) {\n  var $from = doc.resolve(from), dist = to - from, depth = $from.depth;\n  while (dist > 0 && depth > 0 && $from.indexAfter(depth) == $from.node(depth).childCount) {\n    depth--;\n    dist--;\n  }\n  if (dist > 0) {\n    var next = $from.node(depth).maybeChild($from.indexAfter(depth));\n    while (dist > 0) {\n      if (!next || next.isLeaf) { return true }\n      next = next.firstChild;\n      dist--;\n    }\n  }\n  return false\n}\n\nfunction canCut(node, start, end) {\n  return (start == 0 || node.canReplace(start, node.childCount)) &&\n    (end == node.childCount || node.canReplace(0, end))\n}\n\n// :: (NodeRange) → ?number\n// Try to find a target depth to which the content in the given range\n// can be lifted. Will not go across\n// [isolating](#model.NodeSpec.isolating) parent nodes.\nfunction liftTarget(range) {\n  var parent = range.parent;\n  var content = parent.content.cutByIndex(range.startIndex, range.endIndex);\n  for (var depth = range.depth;; --depth) {\n    var node = range.$from.node(depth);\n    var index = range.$from.index(depth), endIndex = range.$to.indexAfter(depth);\n    if (depth < range.depth && node.canReplace(index, endIndex, content))\n      { return depth }\n    if (depth == 0 || node.type.spec.isolating || !canCut(node, index, endIndex)) { break }\n  }\n}\n\n// :: (NodeRange, number) → this\n// Split the content in the given range off from its parent, if there\n// is sibling content before or after it, and move it up the tree to\n// the depth specified by `target`. You'll probably want to use\n// [`liftTarget`](#transform.liftTarget) to compute `target`, to make\n// sure the lift is valid.\nTransform.prototype.lift = function(range, target) {\n  var $from = range.$from;\n  var $to = range.$to;\n  var depth = range.depth;\n\n  var gapStart = $from.before(depth + 1), gapEnd = $to.after(depth + 1);\n  var start = gapStart, end = gapEnd;\n\n  var before = Fragment.empty, openStart = 0;\n  for (var d = depth, splitting = false; d > target; d--)\n    { if (splitting || $from.index(d) > 0) {\n      splitting = true;\n      before = Fragment.from($from.node(d).copy(before));\n      openStart++;\n    } else {\n      start--;\n    } }\n  var after = Fragment.empty, openEnd = 0;\n  for (var d$1 = depth, splitting$1 = false; d$1 > target; d$1--)\n    { if (splitting$1 || $to.after(d$1 + 1) < $to.end(d$1)) {\n      splitting$1 = true;\n      after = Fragment.from($to.node(d$1).copy(after));\n      openEnd++;\n    } else {\n      end++;\n    } }\n\n  return this.step(new ReplaceAroundStep(start, end, gapStart, gapEnd,\n                                         new Slice(before.append(after), openStart, openEnd),\n                                         before.size - openStart, true))\n};\n\n// :: (NodeRange, NodeType, ?Object, ?NodeRange) → ?[{type: NodeType, attrs: ?Object}]\n// Try to find a valid way to wrap the content in the given range in a\n// node of the given type. May introduce extra nodes around and inside\n// the wrapper node, if necessary. Returns null if no valid wrapping\n// could be found. When `innerRange` is given, that range's content is\n// used as the content to fit into the wrapping, instead of the\n// content of `range`.\nfunction findWrapping(range, nodeType, attrs, innerRange) {\n  if ( innerRange === void 0 ) innerRange = range;\n\n  var around = findWrappingOutside(range, nodeType);\n  var inner = around && findWrappingInside(innerRange, nodeType);\n  if (!inner) { return null }\n  return around.map(withAttrs).concat({type: nodeType, attrs: attrs}).concat(inner.map(withAttrs))\n}\n\nfunction withAttrs(type) { return {type: type, attrs: null} }\n\nfunction findWrappingOutside(range, type) {\n  var parent = range.parent;\n  var startIndex = range.startIndex;\n  var endIndex = range.endIndex;\n  var around = parent.contentMatchAt(startIndex).findWrapping(type);\n  if (!around) { return null }\n  var outer = around.length ? around[0] : type;\n  return parent.canReplaceWith(startIndex, endIndex, outer) ? around : null\n}\n\nfunction findWrappingInside(range, type) {\n  var parent = range.parent;\n  var startIndex = range.startIndex;\n  var endIndex = range.endIndex;\n  var inner = parent.child(startIndex);\n  var inside = type.contentMatch.findWrapping(inner.type);\n  if (!inside) { return null }\n  var lastType = inside.length ? inside[inside.length - 1] : type;\n  var innerMatch = lastType.contentMatch;\n  for (var i = startIndex; innerMatch && i < endIndex; i++)\n    { innerMatch = innerMatch.matchType(parent.child(i).type); }\n  if (!innerMatch || !innerMatch.validEnd) { return null }\n  return inside\n}\n\n// :: (NodeRange, [{type: NodeType, attrs: ?Object}]) → this\n// Wrap the given [range](#model.NodeRange) in the given set of wrappers.\n// The wrappers are assumed to be valid in this position, and should\n// probably be computed with [`findWrapping`](#transform.findWrapping).\nTransform.prototype.wrap = function(range, wrappers) {\n  var content = Fragment.empty;\n  for (var i = wrappers.length - 1; i >= 0; i--)\n    { content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content)); }\n\n  var start = range.start, end = range.end;\n  return this.step(new ReplaceAroundStep(start, end, start, end, new Slice(content, 0, 0), wrappers.length, true))\n};\n\n// :: (number, ?number, NodeType, ?Object) → this\n// Set the type of all textblocks (partly) between `from` and `to` to\n// the given node type with the given attributes.\nTransform.prototype.setBlockType = function(from, to, type, attrs) {\n  var this$1 = this;\n  if ( to === void 0 ) to = from;\n\n  if (!type.isTextblock) { throw new RangeError(\"Type given to setBlockType should be a textblock\") }\n  var mapFrom = this.steps.length;\n  this.doc.nodesBetween(from, to, function (node, pos) {\n    if (node.isTextblock && !node.hasMarkup(type, attrs) && canChangeType(this$1.doc, this$1.mapping.slice(mapFrom).map(pos), type)) {\n      // Ensure all markup that isn't allowed in the new node type is cleared\n      this$1.clearIncompatible(this$1.mapping.slice(mapFrom).map(pos, 1), type);\n      var mapping = this$1.mapping.slice(mapFrom);\n      var startM = mapping.map(pos, 1), endM = mapping.map(pos + node.nodeSize, 1);\n      this$1.step(new ReplaceAroundStep(startM, endM, startM + 1, endM - 1,\n                                      new Slice(Fragment.from(type.create(attrs, null, node.marks)), 0, 0), 1, true));\n      return false\n    }\n  });\n  return this\n};\n\nfunction canChangeType(doc, pos, type) {\n  var $pos = doc.resolve(pos), index = $pos.index();\n  return $pos.parent.canReplaceWith(index, index + 1, type)\n}\n\n// :: (number, ?NodeType, ?Object, ?[Mark]) → this\n// Change the type, attributes, and/or marks of the node at `pos`.\n// When `type` isn't given, the existing node type is preserved,\nTransform.prototype.setNodeMarkup = function(pos, type, attrs, marks) {\n  var node = this.doc.nodeAt(pos);\n  if (!node) { throw new RangeError(\"No node at given position\") }\n  if (!type) { type = node.type; }\n  var newNode = type.create(attrs, null, marks || node.marks);\n  if (node.isLeaf)\n    { return this.replaceWith(pos, pos + node.nodeSize, newNode) }\n\n  if (!type.validContent(node.content))\n    { throw new RangeError(\"Invalid content for node type \" + type.name) }\n\n  return this.step(new ReplaceAroundStep(pos, pos + node.nodeSize, pos + 1, pos + node.nodeSize - 1,\n                                         new Slice(Fragment.from(newNode), 0, 0), 1, true))\n};\n\n// :: (Node, number, number, ?[?{type: NodeType, attrs: ?Object}]) → bool\n// Check whether splitting at the given position is allowed.\nfunction canSplit(doc, pos, depth, typesAfter) {\n  if ( depth === void 0 ) depth = 1;\n\n  var $pos = doc.resolve(pos), base = $pos.depth - depth;\n  var innerType = (typesAfter && typesAfter[typesAfter.length - 1]) || $pos.parent;\n  if (base < 0 || $pos.parent.type.spec.isolating ||\n      !$pos.parent.canReplace($pos.index(), $pos.parent.childCount) ||\n      !innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(), $pos.parent.childCount)))\n    { return false }\n  for (var d = $pos.depth - 1, i = depth - 2; d > base; d--, i--) {\n    var node = $pos.node(d), index$1 = $pos.index(d);\n    if (node.type.spec.isolating) { return false }\n    var rest = node.content.cutByIndex(index$1, node.childCount);\n    var after = (typesAfter && typesAfter[i]) || node;\n    if (after != node) { rest = rest.replaceChild(0, after.type.create(after.attrs)); }\n    if (!node.canReplace(index$1 + 1, node.childCount) || !after.type.validContent(rest))\n      { return false }\n  }\n  var index = $pos.indexAfter(base);\n  var baseType = typesAfter && typesAfter[0];\n  return $pos.node(base).canReplaceWith(index, index, baseType ? baseType.type : $pos.node(base + 1).type)\n}\n\n// :: (number, ?number, ?[?{type: NodeType, attrs: ?Object}]) → this\n// Split the node at the given position, and optionally, if `depth` is\n// greater than one, any number of nodes above that. By default, the\n// parts split off will inherit the node type of the original node.\n// This can be changed by passing an array of types and attributes to\n// use after the split.\nTransform.prototype.split = function(pos, depth, typesAfter) {\n  if ( depth === void 0 ) depth = 1;\n\n  var $pos = this.doc.resolve(pos), before = Fragment.empty, after = Fragment.empty;\n  for (var d = $pos.depth, e = $pos.depth - depth, i = depth - 1; d > e; d--, i--) {\n    before = Fragment.from($pos.node(d).copy(before));\n    var typeAfter = typesAfter && typesAfter[i];\n    after = Fragment.from(typeAfter ? typeAfter.type.create(typeAfter.attrs, after) : $pos.node(d).copy(after));\n  }\n  return this.step(new ReplaceStep(pos, pos, new Slice(before.append(after), depth, depth), true))\n};\n\n// :: (Node, number) → bool\n// Test whether the blocks before and after a given position can be\n// joined.\nfunction canJoin(doc, pos) {\n  var $pos = doc.resolve(pos), index = $pos.index();\n  return joinable($pos.nodeBefore, $pos.nodeAfter) &&\n    $pos.parent.canReplace(index, index + 1)\n}\n\nfunction joinable(a, b) {\n  return a && b && !a.isLeaf && a.canAppend(b)\n}\n\n// :: (Node, number, ?number) → ?number\n// Find an ancestor of the given position that can be joined to the\n// block before (or after if `dir` is positive). Returns the joinable\n// point, if any.\nfunction joinPoint(doc, pos, dir) {\n  if ( dir === void 0 ) dir = -1;\n\n  var $pos = doc.resolve(pos);\n  for (var d = $pos.depth;; d--) {\n    var before = (void 0), after = (void 0), index = $pos.index(d);\n    if (d == $pos.depth) {\n      before = $pos.nodeBefore;\n      after = $pos.nodeAfter;\n    } else if (dir > 0) {\n      before = $pos.node(d + 1);\n      index++;\n      after = $pos.node(d).maybeChild(index);\n    } else {\n      before = $pos.node(d).maybeChild(index - 1);\n      after = $pos.node(d + 1);\n    }\n    if (before && !before.isTextblock && joinable(before, after) &&\n        $pos.node(d).canReplace(index, index + 1)) { return pos }\n    if (d == 0) { break }\n    pos = dir < 0 ? $pos.before(d) : $pos.after(d);\n  }\n}\n\n// :: (number, ?number) → this\n// Join the blocks around the given position. If depth is 2, their\n// last and first siblings are also joined, and so on.\nTransform.prototype.join = function(pos, depth) {\n  if ( depth === void 0 ) depth = 1;\n\n  var step = new ReplaceStep(pos - depth, pos + depth, Slice.empty, true);\n  return this.step(step)\n};\n\n// :: (Node, number, NodeType) → ?number\n// Try to find a point where a node of the given type can be inserted\n// near `pos`, by searching up the node hierarchy when `pos` itself\n// isn't a valid place but is at the start or end of a node. Return\n// null if no position was found.\nfunction insertPoint(doc, pos, nodeType) {\n  var $pos = doc.resolve(pos);\n  if ($pos.parent.canReplaceWith($pos.index(), $pos.index(), nodeType)) { return pos }\n\n  if ($pos.parentOffset == 0)\n    { for (var d = $pos.depth - 1; d >= 0; d--) {\n      var index = $pos.index(d);\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) { return $pos.before(d + 1) }\n      if (index > 0) { return null }\n    } }\n  if ($pos.parentOffset == $pos.parent.content.size)\n    { for (var d$1 = $pos.depth - 1; d$1 >= 0; d$1--) {\n      var index$1 = $pos.indexAfter(d$1);\n      if ($pos.node(d$1).canReplaceWith(index$1, index$1, nodeType)) { return $pos.after(d$1 + 1) }\n      if (index$1 < $pos.node(d$1).childCount) { return null }\n    } }\n}\n\n// :: (Node, number, Slice) → ?number\n// Finds a position at or around the given position where the given\n// slice can be inserted. Will look at parent nodes' nearest boundary\n// and try there, even if the original position wasn't directly at the\n// start or end of that node. Returns null when no position was found.\nfunction dropPoint(doc, pos, slice) {\n  var $pos = doc.resolve(pos);\n  if (!slice.content.size) { return pos }\n  var content = slice.content;\n  for (var i = 0; i < slice.openStart; i++) { content = content.firstChild.content; }\n  for (var pass = 1; pass <= (slice.openStart == 0 && slice.size ? 2 : 1); pass++) {\n    for (var d = $pos.depth; d >= 0; d--) {\n      var bias = d == $pos.depth ? 0 : $pos.pos <= ($pos.start(d + 1) + $pos.end(d + 1)) / 2 ? -1 : 1;\n      var insertPos = $pos.index(d) + (bias > 0 ? 1 : 0);\n      if (pass == 1\n          ? $pos.node(d).canReplace(insertPos, insertPos, content)\n          : $pos.node(d).contentMatchAt(insertPos).findWrapping(content.firstChild.type))\n        { return bias == 0 ? $pos.pos : bias < 0 ? $pos.before(d + 1) : $pos.after(d + 1) }\n    }\n  }\n  return null\n}\n\nfunction mapFragment(fragment, f, parent) {\n  var mapped = [];\n  for (var i = 0; i < fragment.childCount; i++) {\n    var child = fragment.child(i);\n    if (child.content.size) { child = child.copy(mapFragment(child.content, f, child)); }\n    if (child.isInline) { child = f(child, parent, i); }\n    mapped.push(child);\n  }\n  return Fragment.fromArray(mapped)\n}\n\n// ::- Add a mark to all inline content between two positions.\nvar AddMarkStep = /*@__PURE__*/(function (Step) {\n  function AddMarkStep(from, to, mark) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.mark = mark;\n  }\n\n  if ( Step ) AddMarkStep.__proto__ = Step;\n  AddMarkStep.prototype = Object.create( Step && Step.prototype );\n  AddMarkStep.prototype.constructor = AddMarkStep;\n\n  AddMarkStep.prototype.apply = function apply (doc) {\n    var this$1 = this;\n\n    var oldSlice = doc.slice(this.from, this.to), $from = doc.resolve(this.from);\n    var parent = $from.node($from.sharedDepth(this.to));\n    var slice = new Slice(mapFragment(oldSlice.content, function (node, parent) {\n      if (!node.isAtom || !parent.type.allowsMarkType(this$1.mark.type)) { return node }\n      return node.mark(this$1.mark.addToSet(node.marks))\n    }, parent), oldSlice.openStart, oldSlice.openEnd);\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  };\n\n  AddMarkStep.prototype.invert = function invert () {\n    return new RemoveMarkStep(this.from, this.to, this.mark)\n  };\n\n  AddMarkStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted || from.pos >= to.pos) { return null }\n    return new AddMarkStep(from.pos, to.pos, this.mark)\n  };\n\n  AddMarkStep.prototype.merge = function merge (other) {\n    if (other instanceof AddMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      { return new AddMarkStep(Math.min(this.from, other.from),\n                             Math.max(this.to, other.to), this.mark) }\n  };\n\n  AddMarkStep.prototype.toJSON = function toJSON () {\n    return {stepType: \"addMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  };\n\n  AddMarkStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for AddMarkStep.fromJSON\") }\n    return new AddMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  };\n\n  return AddMarkStep;\n}(Step));\n\nStep.jsonID(\"addMark\", AddMarkStep);\n\n// ::- Remove a mark from all inline content between two positions.\nvar RemoveMarkStep = /*@__PURE__*/(function (Step) {\n  function RemoveMarkStep(from, to, mark) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.mark = mark;\n  }\n\n  if ( Step ) RemoveMarkStep.__proto__ = Step;\n  RemoveMarkStep.prototype = Object.create( Step && Step.prototype );\n  RemoveMarkStep.prototype.constructor = RemoveMarkStep;\n\n  RemoveMarkStep.prototype.apply = function apply (doc) {\n    var this$1 = this;\n\n    var oldSlice = doc.slice(this.from, this.to);\n    var slice = new Slice(mapFragment(oldSlice.content, function (node) {\n      return node.mark(this$1.mark.removeFromSet(node.marks))\n    }), oldSlice.openStart, oldSlice.openEnd);\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  };\n\n  RemoveMarkStep.prototype.invert = function invert () {\n    return new AddMarkStep(this.from, this.to, this.mark)\n  };\n\n  RemoveMarkStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted || from.pos >= to.pos) { return null }\n    return new RemoveMarkStep(from.pos, to.pos, this.mark)\n  };\n\n  RemoveMarkStep.prototype.merge = function merge (other) {\n    if (other instanceof RemoveMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      { return new RemoveMarkStep(Math.min(this.from, other.from),\n                                Math.max(this.to, other.to), this.mark) }\n  };\n\n  RemoveMarkStep.prototype.toJSON = function toJSON () {\n    return {stepType: \"removeMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  };\n\n  RemoveMarkStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for RemoveMarkStep.fromJSON\") }\n    return new RemoveMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  };\n\n  return RemoveMarkStep;\n}(Step));\n\nStep.jsonID(\"removeMark\", RemoveMarkStep);\n\n// :: (number, number, Mark) → this\n// Add the given mark to the inline content between `from` and `to`.\nTransform.prototype.addMark = function(from, to, mark) {\n  var this$1 = this;\n\n  var removed = [], added = [], removing = null, adding = null;\n  this.doc.nodesBetween(from, to, function (node, pos, parent) {\n    if (!node.isInline) { return }\n    var marks = node.marks;\n    if (!mark.isInSet(marks) && parent.type.allowsMarkType(mark.type)) {\n      var start = Math.max(pos, from), end = Math.min(pos + node.nodeSize, to);\n      var newSet = mark.addToSet(marks);\n\n      for (var i = 0; i < marks.length; i++) {\n        if (!marks[i].isInSet(newSet)) {\n          if (removing && removing.to == start && removing.mark.eq(marks[i]))\n            { removing.to = end; }\n          else\n            { removed.push(removing = new RemoveMarkStep(start, end, marks[i])); }\n        }\n      }\n\n      if (adding && adding.to == start)\n        { adding.to = end; }\n      else\n        { added.push(adding = new AddMarkStep(start, end, mark)); }\n    }\n  });\n\n  removed.forEach(function (s) { return this$1.step(s); });\n  added.forEach(function (s) { return this$1.step(s); });\n  return this\n};\n\n// :: (number, number, ?union<Mark, MarkType>) → this\n// Remove marks from inline nodes between `from` and `to`. When `mark`\n// is a single mark, remove precisely that mark. When it is a mark type,\n// remove all marks of that type. When it is null, remove all marks of\n// any type.\nTransform.prototype.removeMark = function(from, to, mark) {\n  var this$1 = this;\n  if ( mark === void 0 ) mark = null;\n\n  var matched = [], step = 0;\n  this.doc.nodesBetween(from, to, function (node, pos) {\n    if (!node.isInline) { return }\n    step++;\n    var toRemove = null;\n    if (mark instanceof MarkType) {\n      var found = mark.isInSet(node.marks);\n      if (found) { toRemove = [found]; }\n    } else if (mark) {\n      if (mark.isInSet(node.marks)) { toRemove = [mark]; }\n    } else {\n      toRemove = node.marks;\n    }\n    if (toRemove && toRemove.length) {\n      var end = Math.min(pos + node.nodeSize, to);\n      for (var i = 0; i < toRemove.length; i++) {\n        var style = toRemove[i], found$1 = (void 0);\n        for (var j = 0; j < matched.length; j++) {\n          var m = matched[j];\n          if (m.step == step - 1 && style.eq(matched[j].style)) { found$1 = m; }\n        }\n        if (found$1) {\n          found$1.to = end;\n          found$1.step = step;\n        } else {\n          matched.push({style: style, from: Math.max(pos, from), to: end, step: step});\n        }\n      }\n    }\n  });\n  matched.forEach(function (m) { return this$1.step(new RemoveMarkStep(m.from, m.to, m.style)); });\n  return this\n};\n\n// :: (number, NodeType, ?ContentMatch) → this\n// Removes all marks and nodes from the content of the node at `pos`\n// that don't match the given new parent node type. Accepts an\n// optional starting [content match](#model.ContentMatch) as third\n// argument.\nTransform.prototype.clearIncompatible = function(pos, parentType, match) {\n  if ( match === void 0 ) match = parentType.contentMatch;\n\n  var node = this.doc.nodeAt(pos);\n  var delSteps = [], cur = pos + 1;\n  for (var i = 0; i < node.childCount; i++) {\n    var child = node.child(i), end = cur + child.nodeSize;\n    var allowed = match.matchType(child.type, child.attrs);\n    if (!allowed) {\n      delSteps.push(new ReplaceStep(cur, end, Slice.empty));\n    } else {\n      match = allowed;\n      for (var j = 0; j < child.marks.length; j++) { if (!parentType.allowsMarkType(child.marks[j].type))\n        { this.step(new RemoveMarkStep(cur, end, child.marks[j])); } }\n    }\n    cur = end;\n  }\n  if (!match.validEnd) {\n    var fill = match.fillBefore(Fragment.empty, true);\n    this.replace(cur, cur, new Slice(fill, 0, 0));\n  }\n  for (var i$1 = delSteps.length - 1; i$1 >= 0; i$1--) { this.step(delSteps[i$1]); }\n  return this\n};\n\n// :: (Node, number, ?number, ?Slice) → ?Step\n// ‘Fit’ a slice into a given position in the document, producing a\n// [step](#transform.Step) that inserts it. Will return null if\n// there's no meaningful way to insert the slice here, or inserting it\n// would be a no-op (an empty slice over an empty range).\nfunction replaceStep(doc, from, to, slice) {\n  if ( to === void 0 ) to = from;\n  if ( slice === void 0 ) slice = Slice.empty;\n\n  if (from == to && !slice.size) { return null }\n\n  var $from = doc.resolve(from), $to = doc.resolve(to);\n  // Optimization -- avoid work if it's obvious that it's not needed.\n  if (fitsTrivially($from, $to, slice)) { return new ReplaceStep(from, to, slice) }\n  return new Fitter($from, $to, slice).fit()\n}\n\n// :: (number, ?number, ?Slice) → this\n// Replace the part of the document between `from` and `to` with the\n// given `slice`.\nTransform.prototype.replace = function(from, to, slice) {\n  if ( to === void 0 ) to = from;\n  if ( slice === void 0 ) slice = Slice.empty;\n\n  var step = replaceStep(this.doc, from, to, slice);\n  if (step) { this.step(step); }\n  return this\n};\n\n// :: (number, number, union<Fragment, Node, [Node]>) → this\n// Replace the given range with the given content, which may be a\n// fragment, node, or array of nodes.\nTransform.prototype.replaceWith = function(from, to, content) {\n  return this.replace(from, to, new Slice(Fragment.from(content), 0, 0))\n};\n\n// :: (number, number) → this\n// Delete the content between the given positions.\nTransform.prototype.delete = function(from, to) {\n  return this.replace(from, to, Slice.empty)\n};\n\n// :: (number, union<Fragment, Node, [Node]>) → this\n// Insert the given content at the given position.\nTransform.prototype.insert = function(pos, content) {\n  return this.replaceWith(pos, pos, content)\n};\n\nfunction fitsTrivially($from, $to, slice) {\n  return !slice.openStart && !slice.openEnd && $from.start() == $to.start() &&\n    $from.parent.canReplace($from.index(), $to.index(), slice.content)\n}\n\n// Algorithm for 'placing' the elements of a slice into a gap:\n//\n// We consider the content of each node that is open to the left to be\n// independently placeable. I.e. in <p(\"foo\"), p(\"bar\")>, when the\n// paragraph on the left is open, \"foo\" can be placed (somewhere on\n// the left side of the replacement gap) independently from p(\"bar\").\n//\n// This class tracks the state of the placement progress in the\n// following properties:\n//\n//  - `frontier` holds a stack of `{type, match}` objects that\n//    represent the open side of the replacement. It starts at\n//    `$from`, then moves forward as content is placed, and is finally\n//    reconciled with `$to`.\n//\n//  - `unplaced` is a slice that represents the content that hasn't\n//    been placed yet.\n//\n//  - `placed` is a fragment of placed content. Its open-start value\n//    is implicit in `$from`, and its open-end value in `frontier`.\nvar Fitter = function Fitter($from, $to, slice) {\n  this.$to = $to;\n  this.$from = $from;\n  this.unplaced = slice;\n\n  this.frontier = [];\n  for (var i = 0; i <= $from.depth; i++) {\n    var node = $from.node(i);\n    this.frontier.push({\n      type: node.type,\n      match: node.contentMatchAt($from.indexAfter(i))\n    });\n  }\n\n  this.placed = Fragment.empty;\n  for (var i$1 = $from.depth; i$1 > 0; i$1--)\n    { this.placed = Fragment.from($from.node(i$1).copy(this.placed)); }\n};\n\nvar prototypeAccessors$1 = { depth: { configurable: true } };\n\nprototypeAccessors$1.depth.get = function () { return this.frontier.length - 1 };\n\nFitter.prototype.fit = function fit () {\n  // As long as there's unplaced content, try to place some of it.\n  // If that fails, either increase the open score of the unplaced\n  // slice, or drop nodes from it, and then try again.\n  while (this.unplaced.size) {\n    var fit = this.findFittable();\n    if (fit) { this.placeNodes(fit); }\n    else { this.openMore() || this.dropNode(); }\n  }\n  // When there's inline content directly after the frontier _and_\n  // directly after `this.$to`, we must generate a `ReplaceAround`\n  // step that pulls that content into the node after the frontier.\n  // That means the fitting must be done to the end of the textblock\n  // node after `this.$to`, not `this.$to` itself.\n  var moveInline = this.mustMoveInline(), placedSize = this.placed.size - this.depth - this.$from.depth;\n  var $from = this.$from, $to = this.close(moveInline < 0 ? this.$to : $from.doc.resolve(moveInline));\n  if (!$to) { return null }\n\n  // If closing to `$to` succeeded, create a step\n  var content = this.placed, openStart = $from.depth, openEnd = $to.depth;\n  while (openStart && openEnd && content.childCount == 1) { // Normalize by dropping open parent nodes\n    content = content.firstChild.content;\n    openStart--; openEnd--;\n  }\n  var slice = new Slice(content, openStart, openEnd);\n  if (moveInline > -1)\n    { return new ReplaceAroundStep($from.pos, moveInline, this.$to.pos, this.$to.end(), slice, placedSize) }\n  if (slice.size || $from.pos != this.$to.pos) // Don't generate no-op steps\n    { return new ReplaceStep($from.pos, $to.pos, slice) }\n};\n\n// Find a position on the start spine of `this.unplaced` that has\n// content that can be moved somewhere on the frontier. Returns two\n// depths, one for the slice and one for the frontier.\nFitter.prototype.findFittable = function findFittable () {\n  // Only try wrapping nodes (pass 2) after finding a place without\n  // wrapping failed.\n  for (var pass = 1; pass <= 2; pass++) {\n    for (var sliceDepth = this.unplaced.openStart; sliceDepth >= 0; sliceDepth--) {\n      var fragment = (void 0), parent = (void 0);\n      if (sliceDepth) {\n        parent = contentAt(this.unplaced.content, sliceDepth - 1).firstChild;\n        fragment = parent.content;\n      } else {\n        fragment = this.unplaced.content;\n      }\n      var first = fragment.firstChild;\n      for (var frontierDepth = this.depth; frontierDepth >= 0; frontierDepth--) {\n        var ref = this.frontier[frontierDepth];\n          var type = ref.type;\n          var match = ref.match;\n          var wrap = (void 0), inject = (void 0);\n        // In pass 1, if the next node matches, or there is no next\n        // node but the parents look compatible, we've found a\n        // place.\n        if (pass == 1 && (first ? match.matchType(first.type) || (inject = match.fillBefore(Fragment.from(first), false))\n                          : type.compatibleContent(parent.type)))\n          { return {sliceDepth: sliceDepth, frontierDepth: frontierDepth, parent: parent, inject: inject} }\n        // In pass 2, look for a set of wrapping nodes that make\n        // `first` fit here.\n        else if (pass == 2 && first && (wrap = match.findWrapping(first.type)))\n          { return {sliceDepth: sliceDepth, frontierDepth: frontierDepth, parent: parent, wrap: wrap} }\n        // Don't continue looking further up if the parent node\n        // would fit here.\n        if (parent && match.matchType(parent.type)) { break }\n      }\n    }\n  }\n};\n\nFitter.prototype.openMore = function openMore () {\n  var ref = this.unplaced;\n    var content = ref.content;\n    var openStart = ref.openStart;\n    var openEnd = ref.openEnd;\n  var inner = contentAt(content, openStart);\n  if (!inner.childCount || inner.firstChild.isLeaf) { return false }\n  this.unplaced = new Slice(content, openStart + 1,\n                            Math.max(openEnd, inner.size + openStart >= content.size - openEnd ? openStart + 1 : 0));\n  return true\n};\n\nFitter.prototype.dropNode = function dropNode () {\n  var ref = this.unplaced;\n    var content = ref.content;\n    var openStart = ref.openStart;\n    var openEnd = ref.openEnd;\n  var inner = contentAt(content, openStart);\n  if (inner.childCount <= 1 && openStart > 0) {\n    var openAtEnd = content.size - openStart <= openStart + inner.size;\n    this.unplaced = new Slice(dropFromFragment(content, openStart - 1, 1), openStart - 1,\n                              openAtEnd ? openStart - 1 : openEnd);\n  } else {\n    this.unplaced = new Slice(dropFromFragment(content, openStart, 1), openStart, openEnd);\n  }\n};\n\n// : ({sliceDepth: number, frontierDepth: number, parent: ?Node, wrap: ?[NodeType], inject: ?Fragment})\n// Move content from the unplaced slice at `sliceDepth` to the\n// frontier node at `frontierDepth`. Close that frontier node when\n// applicable.\nFitter.prototype.placeNodes = function placeNodes (ref) {\n    var sliceDepth = ref.sliceDepth;\n    var frontierDepth = ref.frontierDepth;\n    var parent = ref.parent;\n    var inject = ref.inject;\n    var wrap = ref.wrap;\n\n  while (this.depth > frontierDepth) { this.closeFrontierNode(); }\n  if (wrap) { for (var i = 0; i < wrap.length; i++) { this.openFrontierNode(wrap[i]); } }\n\n  var slice = this.unplaced, fragment = parent ? parent.content : slice.content;\n  var openStart = slice.openStart - sliceDepth;\n  var taken = 0, add = [];\n  var ref$1 = this.frontier[frontierDepth];\n    var match = ref$1.match;\n    var type = ref$1.type;\n  if (inject) {\n    for (var i$1 = 0; i$1 < inject.childCount; i$1++) { add.push(inject.child(i$1)); }\n    match = match.matchFragment(inject);\n  }\n  // Computes the amount of (end) open nodes at the end of the\n  // fragment. When 0, the parent is open, but no more. When\n  // negative, nothing is open.\n  var openEndCount = (fragment.size + sliceDepth) - (slice.content.size - slice.openEnd);\n  // Scan over the fragment, fitting as many child nodes as\n  // possible.\n  while (taken < fragment.childCount) {\n    var next = fragment.child(taken), matches = match.matchType(next.type);\n    if (!matches) { break }\n    taken++;\n    if (taken > 1 || openStart == 0 || next.content.size) { // Drop empty open nodes\n      match = matches;\n      add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)), taken == 1 ? openStart : 0,\n                              taken == fragment.childCount ? openEndCount : -1));\n    }\n  }\n  var toEnd = taken == fragment.childCount;\n  if (!toEnd) { openEndCount = -1; }\n\n  this.placed = addToFragment(this.placed, frontierDepth, Fragment.from(add));\n  this.frontier[frontierDepth].match = match;\n\n  // If the parent types match, and the entire node was moved, and\n  // it's not open, close this frontier node right away.\n  if (toEnd && openEndCount < 0 && parent && parent.type == this.frontier[this.depth].type && this.frontier.length > 1)\n    { this.closeFrontierNode(); }\n\n  // Add new frontier nodes for any open nodes at the end.\n  for (var i$2 = 0, cur = fragment; i$2 < openEndCount; i$2++) {\n    var node = cur.lastChild;\n    this.frontier.push({type: node.type, match: node.contentMatchAt(node.childCount)});\n    cur = node.content;\n  }\n\n  // Update `this.unplaced`. Drop the entire node from which we\n  // placed it we got to its end, otherwise just drop the placed\n  // nodes.\n  this.unplaced = !toEnd ? new Slice(dropFromFragment(slice.content, sliceDepth, taken), slice.openStart, slice.openEnd)\n    : sliceDepth == 0 ? Slice.empty\n    : new Slice(dropFromFragment(slice.content, sliceDepth - 1, 1),\n                sliceDepth - 1, openEndCount < 0 ? slice.openEnd : sliceDepth - 1);\n};\n\nFitter.prototype.mustMoveInline = function mustMoveInline () {\n  if (!this.$to.parent.isTextblock || this.$to.end() == this.$to.pos) { return -1 }\n  var top = this.frontier[this.depth], level;\n  if (!top.type.isTextblock || !contentAfterFits(this.$to, this.$to.depth, top.type, top.match, false) ||\n      (this.$to.depth == this.depth && (level = this.findCloseLevel(this.$to)) && level.depth == this.depth)) { return -1 }\n\n  var ref = this.$to;\n    var depth = ref.depth;\n    var after = this.$to.after(depth);\n  while (depth > 1 && after == this.$to.end(--depth)) { ++after; }\n  return after\n};\n\nFitter.prototype.findCloseLevel = function findCloseLevel ($to) {\n  scan: for (var i = Math.min(this.depth, $to.depth); i >= 0; i--) {\n    var ref = this.frontier[i];\n      var match = ref.match;\n      var type = ref.type;\n    var dropInner = i < $to.depth && $to.end(i + 1) == $to.pos + ($to.depth - (i + 1));\n    var fit = contentAfterFits($to, i, type, match, dropInner);\n    if (!fit) { continue }\n    for (var d = i - 1; d >= 0; d--) {\n      var ref$1 = this.frontier[d];\n        var match$1 = ref$1.match;\n        var type$1 = ref$1.type;\n      var matches = contentAfterFits($to, d, type$1, match$1, true);\n      if (!matches || matches.childCount) { continue scan }\n    }\n    return {depth: i, fit: fit, move: dropInner ? $to.doc.resolve($to.after(i + 1)) : $to}\n  }\n};\n\nFitter.prototype.close = function close ($to) {\n  var close = this.findCloseLevel($to);\n  if (!close) { return null }\n\n  while (this.depth > close.depth) { this.closeFrontierNode(); }\n  if (close.fit.childCount) { this.placed = addToFragment(this.placed, close.depth, close.fit); }\n  $to = close.move;\n  for (var d = close.depth + 1; d <= $to.depth; d++) {\n    var node = $to.node(d), add = node.type.contentMatch.fillBefore(node.content, true, $to.index(d));\n    this.openFrontierNode(node.type, node.attrs, add);\n  }\n  return $to\n};\n\nFitter.prototype.openFrontierNode = function openFrontierNode (type, attrs, content) {\n  var top = this.frontier[this.depth];\n  top.match = top.match.matchType(type);\n  this.placed = addToFragment(this.placed, this.depth, Fragment.from(type.create(attrs, content)));\n  this.frontier.push({type: type, match: type.contentMatch});\n};\n\nFitter.prototype.closeFrontierNode = function closeFrontierNode () {\n  var open = this.frontier.pop();\n  var add = open.match.fillBefore(Fragment.empty, true);\n  if (add.childCount) { this.placed = addToFragment(this.placed, this.frontier.length, add); }\n};\n\nObject.defineProperties( Fitter.prototype, prototypeAccessors$1 );\n\nfunction dropFromFragment(fragment, depth, count) {\n  if (depth == 0) { return fragment.cutByIndex(count) }\n  return fragment.replaceChild(0, fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content, depth - 1, count)))\n}\n\nfunction addToFragment(fragment, depth, content) {\n  if (depth == 0) { return fragment.append(content) }\n  return fragment.replaceChild(fragment.childCount - 1,\n                               fragment.lastChild.copy(addToFragment(fragment.lastChild.content, depth - 1, content)))\n}\n\nfunction contentAt(fragment, depth) {\n  for (var i = 0; i < depth; i++) { fragment = fragment.firstChild.content; }\n  return fragment\n}\n\nfunction closeNodeStart(node, openStart, openEnd) {\n  if (openStart <= 0) { return node }\n  var frag = node.content;\n  if (openStart > 1)\n    { frag = frag.replaceChild(0, closeNodeStart(frag.firstChild, openStart - 1, frag.childCount == 1 ? openEnd - 1 : 0)); }\n  if (openStart > 0) {\n    frag = node.type.contentMatch.fillBefore(frag).append(frag);\n    if (openEnd <= 0) { frag = frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(Fragment.empty, true)); }\n  }\n  return node.copy(frag)\n}\n\nfunction contentAfterFits($to, depth, type, match, open) {\n  var node = $to.node(depth), index = open ? $to.indexAfter(depth) : $to.index(depth);\n  if (index == node.childCount && !type.compatibleContent(node.type)) { return null }\n  var fit = match.fillBefore(node.content, true, index);\n  return fit && !invalidMarks(type, node.content, index) ? fit : null\n}\n\nfunction invalidMarks(type, fragment, start) {\n  for (var i = start; i < fragment.childCount; i++)\n    { if (!type.allowsMarks(fragment.child(i).marks)) { return true } }\n  return false\n}\n\n// :: (number, number, Slice) → this\n// Replace a range of the document with a given slice, using `from`,\n// `to`, and the slice's [`openStart`](#model.Slice.openStart) property\n// as hints, rather than fixed start and end points. This method may\n// grow the replaced area or close open nodes in the slice in order to\n// get a fit that is more in line with WYSIWYG expectations, by\n// dropping fully covered parent nodes of the replaced region when\n// they are marked [non-defining](#model.NodeSpec.defining), or\n// including an open parent node from the slice that _is_ marked as\n// [defining](#model.NodeSpec.defining).\n//\n// This is the method, for example, to handle paste. The similar\n// [`replace`](#transform.Transform.replace) method is a more\n// primitive tool which will _not_ move the start and end of its given\n// range, and is useful in situations where you need more precise\n// control over what happens.\nTransform.prototype.replaceRange = function(from, to, slice) {\n  if (!slice.size) { return this.deleteRange(from, to) }\n\n  var $from = this.doc.resolve(from), $to = this.doc.resolve(to);\n  if (fitsTrivially($from, $to, slice))\n    { return this.step(new ReplaceStep(from, to, slice)) }\n\n  var targetDepths = coveredDepths($from, this.doc.resolve(to));\n  // Can't replace the whole document, so remove 0 if it's present\n  if (targetDepths[targetDepths.length - 1] == 0) { targetDepths.pop(); }\n  // Negative numbers represent not expansion over the whole node at\n  // that depth, but replacing from $from.before(-D) to $to.pos.\n  var preferredTarget = -($from.depth + 1);\n  targetDepths.unshift(preferredTarget);\n  // This loop picks a preferred target depth, if one of the covering\n  // depths is not outside of a defining node, and adds negative\n  // depths for any depth that has $from at its start and does not\n  // cross a defining node.\n  for (var d = $from.depth, pos = $from.pos - 1; d > 0; d--, pos--) {\n    var spec = $from.node(d).type.spec;\n    if (spec.defining || spec.isolating) { break }\n    if (targetDepths.indexOf(d) > -1) { preferredTarget = d; }\n    else if ($from.before(d) == pos) { targetDepths.splice(1, 0, -d); }\n  }\n  // Try to fit each possible depth of the slice into each possible\n  // target depth, starting with the preferred depths.\n  var preferredTargetIndex = targetDepths.indexOf(preferredTarget);\n\n  var leftNodes = [], preferredDepth = slice.openStart;\n  for (var content = slice.content, i = 0;; i++) {\n    var node = content.firstChild;\n    leftNodes.push(node);\n    if (i == slice.openStart) { break }\n    content = node.content;\n  }\n  // Back up if the node directly above openStart, or the node above\n  // that separated only by a non-defining textblock node, is defining.\n  if (preferredDepth > 0 && leftNodes[preferredDepth - 1].type.spec.defining &&\n      $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 1].type)\n    { preferredDepth -= 1; }\n  else if (preferredDepth >= 2 && leftNodes[preferredDepth - 1].isTextblock && leftNodes[preferredDepth - 2].type.spec.defining &&\n           $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 2].type)\n    { preferredDepth -= 2; }\n\n  for (var j = slice.openStart; j >= 0; j--) {\n    var openDepth = (j + preferredDepth + 1) % (slice.openStart + 1);\n    var insert = leftNodes[openDepth];\n    if (!insert) { continue }\n    for (var i$1 = 0; i$1 < targetDepths.length; i$1++) {\n      // Loop over possible expansion levels, starting with the\n      // preferred one\n      var targetDepth = targetDepths[(i$1 + preferredTargetIndex) % targetDepths.length], expand = true;\n      if (targetDepth < 0) { expand = false; targetDepth = -targetDepth; }\n      var parent = $from.node(targetDepth - 1), index = $from.index(targetDepth - 1);\n      if (parent.canReplaceWith(index, index, insert.type, insert.marks))\n        { return this.replace($from.before(targetDepth), expand ? $to.after(targetDepth) : to,\n                            new Slice(closeFragment(slice.content, 0, slice.openStart, openDepth),\n                                      openDepth, slice.openEnd)) }\n    }\n  }\n\n  var startSteps = this.steps.length;\n  for (var i$2 = targetDepths.length - 1; i$2 >= 0; i$2--) {\n    this.replace(from, to, slice);\n    if (this.steps.length > startSteps) { break }\n    var depth = targetDepths[i$2];\n    if (i$2 < 0) { continue }\n    from = $from.before(depth); to = $to.after(depth);\n  }\n  return this\n};\n\nfunction closeFragment(fragment, depth, oldOpen, newOpen, parent) {\n  if (depth < oldOpen) {\n    var first = fragment.firstChild;\n    fragment = fragment.replaceChild(0, first.copy(closeFragment(first.content, depth + 1, oldOpen, newOpen, first)));\n  }\n  if (depth > newOpen) {\n    var match = parent.contentMatchAt(0);\n    var start = match.fillBefore(fragment).append(fragment);\n    fragment = start.append(match.matchFragment(start).fillBefore(Fragment.empty, true));\n  }\n  return fragment\n}\n\n// :: (number, number, Node) → this\n// Replace the given range with a node, but use `from` and `to` as\n// hints, rather than precise positions. When from and to are the same\n// and are at the start or end of a parent node in which the given\n// node doesn't fit, this method may _move_ them out towards a parent\n// that does allow the given node to be placed. When the given range\n// completely covers a parent node, this method may completely replace\n// that parent node.\nTransform.prototype.replaceRangeWith = function(from, to, node) {\n  if (!node.isInline && from == to && this.doc.resolve(from).parent.content.size) {\n    var point = insertPoint(this.doc, from, node.type);\n    if (point != null) { from = to = point; }\n  }\n  return this.replaceRange(from, to, new Slice(Fragment.from(node), 0, 0))\n};\n\n// :: (number, number) → this\n// Delete the given range, expanding it to cover fully covered\n// parent nodes until a valid replace is found.\nTransform.prototype.deleteRange = function(from, to) {\n  var $from = this.doc.resolve(from), $to = this.doc.resolve(to);\n  var covered = coveredDepths($from, $to);\n  for (var i = 0; i < covered.length; i++) {\n    var depth = covered[i], last = i == covered.length - 1;\n    if ((last && depth == 0) || $from.node(depth).type.contentMatch.validEnd)\n      { return this.delete($from.start(depth), $to.end(depth)) }\n    if (depth > 0 && (last || $from.node(depth - 1).canReplace($from.index(depth - 1), $to.indexAfter(depth - 1))))\n      { return this.delete($from.before(depth), $to.after(depth)) }\n  }\n  for (var d = 1; d <= $from.depth && d <= $to.depth; d++) {\n    if (from - $from.start(d) == $from.depth - d && to > $from.end(d) && $to.end(d) - to != $to.depth - d)\n      { return this.delete($from.before(d), to) }\n  }\n  return this.delete(from, to)\n};\n\n// : (ResolvedPos, ResolvedPos) → [number]\n// Returns an array of all depths for which $from - $to spans the\n// whole content of the nodes at that depth.\nfunction coveredDepths($from, $to) {\n  var result = [], minDepth = Math.min($from.depth, $to.depth);\n  for (var d = minDepth; d >= 0; d--) {\n    var start = $from.start(d);\n    if (start < $from.pos - ($from.depth - d) ||\n        $to.end(d) > $to.pos + ($to.depth - d) ||\n        $from.node(d).type.spec.isolating ||\n        $to.node(d).type.spec.isolating) { break }\n    if (start == $to.start(d)) { result.push(d); }\n  }\n  return result\n}\n\nexport { AddMarkStep, MapResult, Mapping, RemoveMarkStep, ReplaceAroundStep, ReplaceStep, Step, StepMap, StepResult, Transform, TransformError, canJoin, canSplit, dropPoint, findWrapping, insertPoint, joinPoint, liftTarget, replaceStep };\n//# sourceMappingURL=index.es.js.map\n","import { TextSelection, NodeSelection, Selection } from 'prosemirror-state';\nimport { DOMSerializer, Fragment, Mark, DOMParser, Slice } from 'prosemirror-model';\nimport { dropPoint } from 'prosemirror-transform';\n\nvar result = {};\n\nif (typeof navigator != \"undefined\" && typeof document != \"undefined\") {\n  var ie_edge = /Edge\\/(\\d+)/.exec(navigator.userAgent);\n  var ie_upto10 = /MSIE \\d/.test(navigator.userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent);\n\n  result.mac = /Mac/.test(navigator.platform);\n  var ie = result.ie = !!(ie_upto10 || ie_11up || ie_edge);\n  result.ie_version = ie_upto10 ? document.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : null;\n  result.gecko = !ie && /gecko\\/(\\d+)/i.test(navigator.userAgent);\n  result.gecko_version = result.gecko && +(/Firefox\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n  var chrome = !ie && /Chrome\\/(\\d+)/.exec(navigator.userAgent);\n  result.chrome = !!chrome;\n  result.chrome_version = chrome && +chrome[1];\n  // Is true for both iOS and iPadOS for convenience\n  result.safari = !ie && /Apple Computer/.test(navigator.vendor);\n  result.ios = result.safari && (/Mobile\\/\\w+/.test(navigator.userAgent) || navigator.maxTouchPoints > 2);\n  result.android = /Android \\d/.test(navigator.userAgent);\n  result.webkit = \"webkitFontSmoothing\" in document.documentElement.style;\n  result.webkit_version = result.webkit && +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n}\n\nvar domIndex = function(node) {\n  for (var index = 0;; index++) {\n    node = node.previousSibling;\n    if (!node) { return index }\n  }\n};\n\nvar parentNode = function(node) {\n  var parent = node.parentNode;\n  return parent && parent.nodeType == 11 ? parent.host : parent\n};\n\nvar reusedRange = null;\n\n// Note that this will always return the same range, because DOM range\n// objects are every expensive, and keep slowing down subsequent DOM\n// updates, for some reason.\nvar textRange = function(node, from, to) {\n  var range = reusedRange || (reusedRange = document.createRange());\n  range.setEnd(node, to == null ? node.nodeValue.length : to);\n  range.setStart(node, from || 0);\n  return range\n};\n\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nvar isEquivalentPosition = function(node, off, targetNode, targetOff) {\n  return targetNode && (scanFor(node, off, targetNode, targetOff, -1) ||\n                        scanFor(node, off, targetNode, targetOff, 1))\n};\n\nvar atomElements = /^(img|br|input|textarea|hr)$/i;\n\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n  for (;;) {\n    if (node == targetNode && off == targetOff) { return true }\n    if (off == (dir < 0 ? 0 : nodeSize(node))) {\n      var parent = node.parentNode;\n      if (parent.nodeType != 1 || hasBlockDesc(node) || atomElements.test(node.nodeName) || node.contentEditable == \"false\")\n        { return false }\n      off = domIndex(node) + (dir < 0 ? 0 : 1);\n      node = parent;\n    } else if (node.nodeType == 1) {\n      node = node.childNodes[off + (dir < 0 ? -1 : 0)];\n      if (node.contentEditable == \"false\") { return false }\n      off = dir < 0 ? nodeSize(node) : 0;\n    } else {\n      return false\n    }\n  }\n}\n\nfunction nodeSize(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isOnEdge(node, offset, parent) {\n  for (var atStart = offset == 0, atEnd = offset == nodeSize(node); atStart || atEnd;) {\n    if (node == parent) { return true }\n    var index = domIndex(node);\n    node = node.parentNode;\n    if (!node) { return false }\n    atStart = atStart && index == 0;\n    atEnd = atEnd && index == nodeSize(node);\n  }\n}\n\nfunction hasBlockDesc(dom) {\n  var desc;\n  for (var cur = dom; cur; cur = cur.parentNode) { if (desc = cur.pmViewDesc) { break } }\n  return desc && desc.node && desc.node.isBlock && (desc.dom == dom || desc.contentDOM == dom)\n}\n\n// Work around Chrome issue https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n// (isCollapsed inappropriately returns true in shadow dom)\nvar selectionCollapsed = function(domSel) {\n  var collapsed = domSel.isCollapsed;\n  if (collapsed && result.chrome && domSel.rangeCount && !domSel.getRangeAt(0).collapsed)\n    { collapsed = false; }\n  return collapsed\n};\n\nfunction keyEvent(keyCode, key) {\n  var event = document.createEvent(\"Event\");\n  event.initEvent(\"keydown\", true, true);\n  event.keyCode = keyCode;\n  event.key = event.code = key;\n  return event\n}\n\nfunction windowRect(doc) {\n  return {left: 0, right: doc.documentElement.clientWidth,\n          top: 0, bottom: doc.documentElement.clientHeight}\n}\n\nfunction getSide(value, side) {\n  return typeof value == \"number\" ? value : value[side]\n}\n\nfunction clientRect(node) {\n  var rect = node.getBoundingClientRect();\n  // Make sure scrollbar width isn't included in the rectangle\n  return {left: rect.left, right: rect.left + node.clientWidth,\n          top: rect.top, bottom: rect.top + node.clientHeight}\n}\n\nfunction scrollRectIntoView(view, rect, startDOM) {\n  var scrollThreshold = view.someProp(\"scrollThreshold\") || 0, scrollMargin = view.someProp(\"scrollMargin\") || 5;\n  var doc = view.dom.ownerDocument;\n  for (var parent = startDOM || view.dom;; parent = parentNode(parent)) {\n    if (!parent) { break }\n    if (parent.nodeType != 1) { continue }\n    var atTop = parent == doc.body || parent.nodeType != 1;\n    var bounding = atTop ? windowRect(doc) : clientRect(parent);\n    var moveX = 0, moveY = 0;\n    if (rect.top < bounding.top + getSide(scrollThreshold, \"top\"))\n      { moveY = -(bounding.top - rect.top + getSide(scrollMargin, \"top\")); }\n    else if (rect.bottom > bounding.bottom - getSide(scrollThreshold, \"bottom\"))\n      { moveY = rect.bottom - bounding.bottom + getSide(scrollMargin, \"bottom\"); }\n    if (rect.left < bounding.left + getSide(scrollThreshold, \"left\"))\n      { moveX = -(bounding.left - rect.left + getSide(scrollMargin, \"left\")); }\n    else if (rect.right > bounding.right - getSide(scrollThreshold, \"right\"))\n      { moveX = rect.right - bounding.right + getSide(scrollMargin, \"right\"); }\n    if (moveX || moveY) {\n      if (atTop) {\n        doc.defaultView.scrollBy(moveX, moveY);\n      } else {\n        var startX = parent.scrollLeft, startY = parent.scrollTop;\n        if (moveY) { parent.scrollTop += moveY; }\n        if (moveX) { parent.scrollLeft += moveX; }\n        var dX = parent.scrollLeft - startX, dY = parent.scrollTop - startY;\n        rect = {left: rect.left - dX, top: rect.top - dY, right: rect.right - dX, bottom: rect.bottom - dY};\n      }\n    }\n    if (atTop) { break }\n  }\n}\n\n// Store the scroll position of the editor's parent nodes, along with\n// the top position of an element near the top of the editor, which\n// will be used to make sure the visible viewport remains stable even\n// when the size of the content above changes.\nfunction storeScrollPos(view) {\n  var rect = view.dom.getBoundingClientRect(), startY = Math.max(0, rect.top);\n  var refDOM, refTop;\n  for (var x = (rect.left + rect.right) / 2, y = startY + 1;\n       y < Math.min(innerHeight, rect.bottom); y += 5) {\n    var dom = view.root.elementFromPoint(x, y);\n    if (dom == view.dom || !view.dom.contains(dom)) { continue }\n    var localRect = dom.getBoundingClientRect();\n    if (localRect.top >= startY - 20) {\n      refDOM = dom;\n      refTop = localRect.top;\n      break\n    }\n  }\n  return {refDOM: refDOM, refTop: refTop, stack: scrollStack(view.dom)}\n}\n\nfunction scrollStack(dom) {\n  var stack = [], doc = dom.ownerDocument;\n  for (; dom; dom = parentNode(dom)) {\n    stack.push({dom: dom, top: dom.scrollTop, left: dom.scrollLeft});\n    if (dom == doc) { break }\n  }\n  return stack\n}\n\n// Reset the scroll position of the editor's parent nodes to that what\n// it was before, when storeScrollPos was called.\nfunction resetScrollPos(ref) {\n  var refDOM = ref.refDOM;\n  var refTop = ref.refTop;\n  var stack = ref.stack;\n\n  var newRefTop = refDOM ? refDOM.getBoundingClientRect().top : 0;\n  restoreScrollStack(stack, newRefTop == 0 ? 0 : newRefTop - refTop);\n}\n\nfunction restoreScrollStack(stack, dTop) {\n  for (var i = 0; i < stack.length; i++) {\n    var ref = stack[i];\n    var dom = ref.dom;\n    var top = ref.top;\n    var left = ref.left;\n    if (dom.scrollTop != top + dTop) { dom.scrollTop = top + dTop; }\n    if (dom.scrollLeft != left) { dom.scrollLeft = left; }\n  }\n}\n\nvar preventScrollSupported = null;\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nfunction focusPreventScroll(dom) {\n  if (dom.setActive) { return dom.setActive() } // in IE\n  if (preventScrollSupported) { return dom.focus(preventScrollSupported) }\n\n  var stored = scrollStack(dom);\n  dom.focus(preventScrollSupported == null ? {\n    get preventScroll() {\n      preventScrollSupported = {preventScroll: true};\n      return true\n    }\n  } : undefined);\n  if (!preventScrollSupported) {\n    preventScrollSupported = false;\n    restoreScrollStack(stored, 0);\n  }\n}\n\nfunction findOffsetInNode(node, coords) {\n  var closest, dxClosest = 2e8, coordsClosest, offset = 0;\n  var rowBot = coords.top, rowTop = coords.top;\n  for (var child = node.firstChild, childIndex = 0; child; child = child.nextSibling, childIndex++) {\n    var rects = (void 0);\n    if (child.nodeType == 1) { rects = child.getClientRects(); }\n    else if (child.nodeType == 3) { rects = textRange(child).getClientRects(); }\n    else { continue }\n\n    for (var i = 0; i < rects.length; i++) {\n      var rect = rects[i];\n      if (rect.top <= rowBot && rect.bottom >= rowTop) {\n        rowBot = Math.max(rect.bottom, rowBot);\n        rowTop = Math.min(rect.top, rowTop);\n        var dx = rect.left > coords.left ? rect.left - coords.left\n            : rect.right < coords.left ? coords.left - rect.right : 0;\n        if (dx < dxClosest) {\n          closest = child;\n          dxClosest = dx;\n          coordsClosest = dx && closest.nodeType == 3 ? {left: rect.right < coords.left ? rect.right : rect.left, top: coords.top} : coords;\n          if (child.nodeType == 1 && dx)\n            { offset = childIndex + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0); }\n          continue\n        }\n      }\n      if (!closest && (coords.left >= rect.right && coords.top >= rect.top ||\n                       coords.left >= rect.left && coords.top >= rect.bottom))\n        { offset = childIndex + 1; }\n    }\n  }\n  if (closest && closest.nodeType == 3) { return findOffsetInText(closest, coordsClosest) }\n  if (!closest || (dxClosest && closest.nodeType == 1)) { return {node: node, offset: offset} }\n  return findOffsetInNode(closest, coordsClosest)\n}\n\nfunction findOffsetInText(node, coords) {\n  var len = node.nodeValue.length;\n  var range = document.createRange();\n  for (var i = 0; i < len; i++) {\n    range.setEnd(node, i + 1);\n    range.setStart(node, i);\n    var rect = singleRect(range, 1);\n    if (rect.top == rect.bottom) { continue }\n    if (inRect(coords, rect))\n      { return {node: node, offset: i + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)} }\n  }\n  return {node: node, offset: 0}\n}\n\nfunction inRect(coords, rect) {\n  return coords.left >= rect.left - 1 && coords.left <= rect.right + 1&&\n    coords.top >= rect.top - 1 && coords.top <= rect.bottom + 1\n}\n\nfunction targetKludge(dom, coords) {\n  var parent = dom.parentNode;\n  if (parent && /^li$/i.test(parent.nodeName) && coords.left < dom.getBoundingClientRect().left)\n    { return parent }\n  return dom\n}\n\nfunction posFromElement(view, elt, coords) {\n  var ref = findOffsetInNode(elt, coords);\n  var node = ref.node;\n  var offset = ref.offset;\n  var bias = -1;\n  if (node.nodeType == 1 && !node.firstChild) {\n    var rect = node.getBoundingClientRect();\n    bias = rect.left != rect.right && coords.left > (rect.left + rect.right) / 2 ? 1 : -1;\n  }\n  return view.docView.posFromDOM(node, offset, bias)\n}\n\nfunction posFromCaret(view, node, offset, coords) {\n  // Browser (in caretPosition/RangeFromPoint) will agressively\n  // normalize towards nearby inline nodes. Since we are interested in\n  // positions between block nodes too, we first walk up the hierarchy\n  // of nodes to see if there are block nodes that the coordinates\n  // fall outside of. If so, we take the position before/after that\n  // block. If not, we call `posFromDOM` on the raw node/offset.\n  var outside = -1;\n  for (var cur = node;;) {\n    if (cur == view.dom) { break }\n    var desc = view.docView.nearestDesc(cur, true);\n    if (!desc) { return null }\n    if (desc.node.isBlock && desc.parent) {\n      var rect = desc.dom.getBoundingClientRect();\n      if (rect.left > coords.left || rect.top > coords.top) { outside = desc.posBefore; }\n      else if (rect.right < coords.left || rect.bottom < coords.top) { outside = desc.posAfter; }\n      else { break }\n    }\n    cur = desc.dom.parentNode;\n  }\n  return outside > -1 ? outside : view.docView.posFromDOM(node, offset)\n}\n\nfunction elementFromPoint(element, coords, box) {\n  var len = element.childNodes.length;\n  if (len && box.top < box.bottom) {\n    for (var startI = Math.max(0, Math.min(len - 1, Math.floor(len * (coords.top - box.top) / (box.bottom - box.top)) - 2)), i = startI;;) {\n      var child = element.childNodes[i];\n      if (child.nodeType == 1) {\n        var rects = child.getClientRects();\n        for (var j = 0; j < rects.length; j++) {\n          var rect = rects[j];\n          if (inRect(coords, rect)) { return elementFromPoint(child, coords, rect) }\n        }\n      }\n      if ((i = (i + 1) % len) == startI) { break }\n    }\n  }\n  return element\n}\n\n// Given an x,y position on the editor, get the position in the document.\nfunction posAtCoords(view, coords) {\n  var assign, assign$1;\n\n  var root = view.root, node, offset;\n  if (root.caretPositionFromPoint) {\n    try { // Firefox throws for this call in hard-to-predict circumstances (#994)\n      var pos$1 = root.caretPositionFromPoint(coords.left, coords.top);\n      if (pos$1) { ((assign = pos$1, node = assign.offsetNode, offset = assign.offset)); }\n    } catch (_) {}\n  }\n  if (!node && root.caretRangeFromPoint) {\n    var range = root.caretRangeFromPoint(coords.left, coords.top);\n    if (range) { ((assign$1 = range, node = assign$1.startContainer, offset = assign$1.startOffset)); }\n  }\n\n  var elt = root.elementFromPoint(coords.left, coords.top + 1), pos;\n  if (!elt || !view.dom.contains(elt.nodeType != 1 ? elt.parentNode : elt)) {\n    var box = view.dom.getBoundingClientRect();\n    if (!inRect(coords, box)) { return null }\n    elt = elementFromPoint(view.dom, coords, box);\n    if (!elt) { return null }\n  }\n  // Safari's caretRangeFromPoint returns nonsense when on a draggable element\n  if (result.safari && elt.draggable) { node = offset = null; }\n  elt = targetKludge(elt, coords);\n  if (node) {\n    if (result.gecko && node.nodeType == 1) {\n      // Firefox will sometimes return offsets into <input> nodes, which\n      // have no actual children, from caretPositionFromPoint (#953)\n      offset = Math.min(offset, node.childNodes.length);\n      // It'll also move the returned position before image nodes,\n      // even if those are behind it.\n      if (offset < node.childNodes.length) {\n        var next = node.childNodes[offset], box$1;\n        if (next.nodeName == \"IMG\" && (box$1 = next.getBoundingClientRect()).right <= coords.left &&\n            box$1.bottom > coords.top)\n          { offset++; }\n      }\n    }\n    // Suspiciously specific kludge to work around caret*FromPoint\n    // never returning a position at the end of the document\n    if (node == view.dom && offset == node.childNodes.length - 1 && node.lastChild.nodeType == 1 &&\n        coords.top > node.lastChild.getBoundingClientRect().bottom)\n      { pos = view.state.doc.content.size; }\n    // Ignore positions directly after a BR, since caret*FromPoint\n    // 'round up' positions that would be more accurately placed\n    // before the BR node.\n    else if (offset == 0 || node.nodeType != 1 || node.childNodes[offset - 1].nodeName != \"BR\")\n      { pos = posFromCaret(view, node, offset, coords); }\n  }\n  if (pos == null) { pos = posFromElement(view, elt, coords); }\n\n  var desc = view.docView.nearestDesc(elt, true);\n  return {pos: pos, inside: desc ? desc.posAtStart - desc.border : -1}\n}\n\nfunction singleRect(object, bias) {\n  var rects = object.getClientRects();\n  return !rects.length ? object.getBoundingClientRect() : rects[bias < 0 ? 0 : rects.length - 1]\n}\n\nvar BIDI = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n\n// : (EditorView, number, number) → {left: number, top: number, right: number, bottom: number}\n// Given a position in the document model, get a bounding box of the\n// character at that position, relative to the window.\nfunction coordsAtPos(view, pos, side) {\n  var ref = view.docView.domFromPos(pos, side < 0 ? -1 : 1);\n  var node = ref.node;\n  var offset = ref.offset;\n\n  var supportEmptyRange = result.webkit || result.gecko;\n  if (node.nodeType == 3) {\n    // These browsers support querying empty text ranges. Prefer that in\n    // bidi context or when at the end of a node.\n    if (supportEmptyRange && (BIDI.test(node.nodeValue) || (side < 0 ? !offset : offset == node.nodeValue.length))) {\n      var rect = singleRect(textRange(node, offset, offset), side);\n      // Firefox returns bad results (the position before the space)\n      // when querying a position directly after line-broken\n      // whitespace. Detect this situation and and kludge around it\n      if (result.gecko && offset && /\\s/.test(node.nodeValue[offset - 1]) && offset < node.nodeValue.length) {\n        var rectBefore = singleRect(textRange(node, offset - 1, offset - 1), -1);\n        if (rectBefore.top == rect.top) {\n          var rectAfter = singleRect(textRange(node, offset, offset + 1), -1);\n          if (rectAfter.top != rect.top)\n            { return flattenV(rectAfter, rectAfter.left < rectBefore.left) }\n        }\n      }\n      return rect\n    } else {\n      var from = offset, to = offset, takeSide = side < 0 ? 1 : -1;\n      if (side < 0 && !offset) { to++; takeSide = -1; }\n      else if (side >= 0 && offset == node.nodeValue.length) { from--; takeSide = 1; }\n      else if (side < 0) { from--; }\n      else { to ++; }\n      return flattenV(singleRect(textRange(node, from, to), takeSide), takeSide < 0)\n    }\n  }\n\n  // Return a horizontal line in block context\n  if (!view.state.doc.resolve(pos).parent.inlineContent) {\n    if (offset && (side < 0 || offset == nodeSize(node))) {\n      var before = node.childNodes[offset - 1];\n      if (before.nodeType == 1) { return flattenH(before.getBoundingClientRect(), false) }\n    }\n    if (offset < nodeSize(node)) {\n      var after = node.childNodes[offset];\n      if (after.nodeType == 1) { return flattenH(after.getBoundingClientRect(), true) }\n    }\n    return flattenH(node.getBoundingClientRect(), side >= 0)\n  }\n\n  // Inline, not in text node (this is not Bidi-safe)\n  if (offset && (side < 0 || offset == nodeSize(node))) {\n    var before$1 = node.childNodes[offset - 1];\n    var target = before$1.nodeType == 3 ? textRange(before$1, nodeSize(before$1) - (supportEmptyRange ? 0 : 1))\n        // BR nodes tend to only return the rectangle before them.\n        // Only use them if they are the last element in their parent\n        : before$1.nodeType == 1 && (before$1.nodeName != \"BR\" || !before$1.nextSibling) ? before$1 : null;\n    if (target) { return flattenV(singleRect(target, 1), false) }\n  }\n  if (offset < nodeSize(node)) {\n    var after$1 = node.childNodes[offset];\n    var target$1 = after$1.nodeType == 3 ? textRange(after$1, 0, (supportEmptyRange ? 0 : 1))\n        : after$1.nodeType == 1 ? after$1 : null;\n    if (target$1) { return flattenV(singleRect(target$1, -1), true) }\n  }\n  // All else failed, just try to get a rectangle for the target node\n  return flattenV(singleRect(node.nodeType == 3 ? textRange(node) : node, -side), side >= 0)\n}\n\nfunction flattenV(rect, left) {\n  if (rect.width == 0) { return rect }\n  var x = left ? rect.left : rect.right;\n  return {top: rect.top, bottom: rect.bottom, left: x, right: x}\n}\n\nfunction flattenH(rect, top) {\n  if (rect.height == 0) { return rect }\n  var y = top ? rect.top : rect.bottom;\n  return {top: y, bottom: y, left: rect.left, right: rect.right}\n}\n\nfunction withFlushedState(view, state, f) {\n  var viewState = view.state, active = view.root.activeElement;\n  if (viewState != state) { view.updateState(state); }\n  if (active != view.dom) { view.focus(); }\n  try {\n    return f()\n  } finally {\n    if (viewState != state) { view.updateState(viewState); }\n    if (active != view.dom && active) { active.focus(); }\n  }\n}\n\n// : (EditorView, number, number)\n// Whether vertical position motion in a given direction\n// from a position would leave a text block.\nfunction endOfTextblockVertical(view, state, dir) {\n  var sel = state.selection;\n  var $pos = dir == \"up\" ? sel.$from : sel.$to;\n  return withFlushedState(view, state, function () {\n    var ref = view.docView.domFromPos($pos.pos, dir == \"up\" ? -1 : 1);\n    var dom = ref.node;\n    for (;;) {\n      var nearest = view.docView.nearestDesc(dom, true);\n      if (!nearest) { break }\n      if (nearest.node.isBlock) { dom = nearest.dom; break }\n      dom = nearest.dom.parentNode;\n    }\n    var coords = coordsAtPos(view, $pos.pos, 1);\n    for (var child = dom.firstChild; child; child = child.nextSibling) {\n      var boxes = (void 0);\n      if (child.nodeType == 1) { boxes = child.getClientRects(); }\n      else if (child.nodeType == 3) { boxes = textRange(child, 0, child.nodeValue.length).getClientRects(); }\n      else { continue }\n      for (var i = 0; i < boxes.length; i++) {\n        var box = boxes[i];\n        if (box.bottom > box.top && (dir == \"up\" ? box.bottom < coords.top + 1 : box.top > coords.bottom - 1))\n          { return false }\n      }\n    }\n    return true\n  })\n}\n\nvar maybeRTL = /[\\u0590-\\u08ac]/;\n\nfunction endOfTextblockHorizontal(view, state, dir) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  if (!$head.parent.isTextblock) { return false }\n  var offset = $head.parentOffset, atStart = !offset, atEnd = offset == $head.parent.content.size;\n  var sel = getSelection();\n  // If the textblock is all LTR, or the browser doesn't support\n  // Selection.modify (Edge), fall back to a primitive approach\n  if (!maybeRTL.test($head.parent.textContent) || !sel.modify)\n    { return dir == \"left\" || dir == \"backward\" ? atStart : atEnd }\n\n  return withFlushedState(view, state, function () {\n    // This is a huge hack, but appears to be the best we can\n    // currently do: use `Selection.modify` to move the selection by\n    // one character, and see if that moves the cursor out of the\n    // textblock (or doesn't move it at all, when at the start/end of\n    // the document).\n    var oldRange = sel.getRangeAt(0), oldNode = sel.focusNode, oldOff = sel.focusOffset;\n    var oldBidiLevel = sel.caretBidiLevel; // Only for Firefox\n    sel.modify(\"move\", dir, \"character\");\n    var parentDOM = $head.depth ? view.docView.domAfterPos($head.before()) : view.dom;\n    var result = !parentDOM.contains(sel.focusNode.nodeType == 1 ? sel.focusNode : sel.focusNode.parentNode) ||\n        (oldNode == sel.focusNode && oldOff == sel.focusOffset);\n    // Restore the previous selection\n    sel.removeAllRanges();\n    sel.addRange(oldRange);\n    if (oldBidiLevel != null) { sel.caretBidiLevel = oldBidiLevel; }\n    return result\n  })\n}\n\nvar cachedState = null, cachedDir = null, cachedResult = false;\nfunction endOfTextblock(view, state, dir) {\n  if (cachedState == state && cachedDir == dir) { return cachedResult }\n  cachedState = state; cachedDir = dir;\n  return cachedResult = dir == \"up\" || dir == \"down\"\n    ? endOfTextblockVertical(view, state, dir)\n    : endOfTextblockHorizontal(view, state, dir)\n}\n\n// NodeView:: interface\n//\n// By default, document nodes are rendered using the result of the\n// [`toDOM`](#model.NodeSpec.toDOM) method of their spec, and managed\n// entirely by the editor. For some use cases, such as embedded\n// node-specific editing interfaces, you want more control over\n// the behavior of a node's in-editor representation, and need to\n// [define](#view.EditorProps.nodeViews) a custom node view.\n//\n// Mark views only support `dom` and `contentDOM`, and don't support\n// any of the node view methods.\n//\n// Objects returned as node views must conform to this interface.\n//\n//   dom:: ?dom.Node\n//   The outer DOM node that represents the document node. When not\n//   given, the default strategy is used to create a DOM node.\n//\n//   contentDOM:: ?dom.Node\n//   The DOM node that should hold the node's content. Only meaningful\n//   if the node view also defines a `dom` property and if its node\n//   type is not a leaf node type. When this is present, ProseMirror\n//   will take care of rendering the node's children into it. When it\n//   is not present, the node view itself is responsible for rendering\n//   (or deciding not to render) its child nodes.\n//\n//   update:: ?(node: Node, decorations: [Decoration]) → bool\n//   When given, this will be called when the view is updating itself.\n//   It will be given a node (possibly of a different type), and an\n//   array of active decorations (which are automatically drawn, and\n//   the node view may ignore if it isn't interested in them), and\n//   should return true if it was able to update to that node, and\n//   false otherwise. If the node view has a `contentDOM` property (or\n//   no `dom` property), updating its child nodes will be handled by\n//   ProseMirror.\n//\n//   selectNode:: ?()\n//   Can be used to override the way the node's selected status (as a\n//   node selection) is displayed.\n//\n//   deselectNode:: ?()\n//   When defining a `selectNode` method, you should also provide a\n//   `deselectNode` method to remove the effect again.\n//\n//   setSelection:: ?(anchor: number, head: number, root: dom.Document)\n//   This will be called to handle setting the selection inside the\n//   node. The `anchor` and `head` positions are relative to the start\n//   of the node. By default, a DOM selection will be created between\n//   the DOM positions corresponding to those positions, but if you\n//   override it you can do something else.\n//\n//   stopEvent:: ?(event: dom.Event) → bool\n//   Can be used to prevent the editor view from trying to handle some\n//   or all DOM events that bubble up from the node view. Events for\n//   which this returns true are not handled by the editor.\n//\n//   ignoreMutation:: ?(dom.MutationRecord) → bool\n//   Called when a DOM\n//   [mutation](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)\n//   or a selection change happens within the view. When the change is\n//   a selection change, the record will have a `type` property of\n//   `\"selection\"` (which doesn't occur for native mutation records).\n//   Return false if the editor should re-read the selection or\n//   re-parse the range around the mutation, true if it can safely be\n//   ignored.\n//\n//   destroy:: ?()\n//   Called when the node view is removed from the editor or the whole\n//   editor is destroyed.\n\n// View descriptions are data structures that describe the DOM that is\n// used to represent the editor's content. They are used for:\n//\n// - Incremental redrawing when the document changes\n//\n// - Figuring out what part of the document a given DOM position\n//   corresponds to\n//\n// - Wiring in custom implementations of the editing interface for a\n//   given node\n//\n// They form a doubly-linked mutable tree, starting at `view.docView`.\n\nvar NOT_DIRTY = 0, CHILD_DIRTY = 1, CONTENT_DIRTY = 2, NODE_DIRTY = 3;\n\n// Superclass for the various kinds of descriptions. Defines their\n// basic structure and shared methods.\nvar ViewDesc = function ViewDesc(parent, children, dom, contentDOM) {\n  this.parent = parent;\n  this.children = children;\n  this.dom = dom;\n  // An expando property on the DOM node provides a link back to its\n  // description.\n  dom.pmViewDesc = this;\n  // This is the node that holds the child views. It may be null for\n  // descs that don't have children.\n  this.contentDOM = contentDOM;\n  this.dirty = NOT_DIRTY;\n};\n\nvar prototypeAccessors = { beforePosition: { configurable: true },size: { configurable: true },border: { configurable: true },posBefore: { configurable: true },posAtStart: { configurable: true },posAfter: { configurable: true },posAtEnd: { configurable: true },contentLost: { configurable: true },domAtom: { configurable: true } };\n\n// Used to check whether a given description corresponds to a\n// widget/mark/node.\nViewDesc.prototype.matchesWidget = function matchesWidget () { return false };\nViewDesc.prototype.matchesMark = function matchesMark () { return false };\nViewDesc.prototype.matchesNode = function matchesNode () { return false };\nViewDesc.prototype.matchesHack = function matchesHack () { return false };\n\nprototypeAccessors.beforePosition.get = function () { return false };\n\n// : () → ?ParseRule\n// When parsing in-editor content (in domchange.js), we allow\n// descriptions to determine the parse rules that should be used to\n// parse them.\nViewDesc.prototype.parseRule = function parseRule () { return null };\n\n// : (dom.Event) → bool\n// Used by the editor's event handler to ignore events that come\n// from certain descs.\nViewDesc.prototype.stopEvent = function stopEvent () { return false };\n\n// The size of the content represented by this desc.\nprototypeAccessors.size.get = function () {\n  var size = 0;\n  for (var i = 0; i < this.children.length; i++) { size += this.children[i].size; }\n  return size\n};\n\n// For block nodes, this represents the space taken up by their\n// start/end tokens.\nprototypeAccessors.border.get = function () { return 0 };\n\nViewDesc.prototype.destroy = function destroy () {\n  this.parent = null;\n  if (this.dom.pmViewDesc == this) { this.dom.pmViewDesc = null; }\n  for (var i = 0; i < this.children.length; i++)\n    { this.children[i].destroy(); }\n};\n\nViewDesc.prototype.posBeforeChild = function posBeforeChild (child) {\n  for (var i = 0, pos = this.posAtStart; i < this.children.length; i++) {\n    var cur = this.children[i];\n    if (cur == child) { return pos }\n    pos += cur.size;\n  }\n};\n\nprototypeAccessors.posBefore.get = function () {\n  return this.parent.posBeforeChild(this)\n};\n\nprototypeAccessors.posAtStart.get = function () {\n  return this.parent ? this.parent.posBeforeChild(this) + this.border : 0\n};\n\nprototypeAccessors.posAfter.get = function () {\n  return this.posBefore + this.size\n};\n\nprototypeAccessors.posAtEnd.get = function () {\n  return this.posAtStart + this.size - 2 * this.border\n};\n\n// : (dom.Node, number, ?number) → number\nViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n  // If the DOM position is in the content, use the child desc after\n  // it to figure out a position.\n  if (this.contentDOM && this.contentDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode)) {\n    if (bias < 0) {\n      var domBefore, desc;\n      if (dom == this.contentDOM) {\n        domBefore = dom.childNodes[offset - 1];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domBefore = dom.previousSibling;\n      }\n      while (domBefore && !((desc = domBefore.pmViewDesc) && desc.parent == this)) { domBefore = domBefore.previousSibling; }\n      return domBefore ? this.posBeforeChild(desc) + desc.size : this.posAtStart\n    } else {\n      var domAfter, desc$1;\n      if (dom == this.contentDOM) {\n        domAfter = dom.childNodes[offset];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domAfter = dom.nextSibling;\n      }\n      while (domAfter && !((desc$1 = domAfter.pmViewDesc) && desc$1.parent == this)) { domAfter = domAfter.nextSibling; }\n      return domAfter ? this.posBeforeChild(desc$1) : this.posAtEnd\n    }\n  }\n  // Otherwise, use various heuristics, falling back on the bias\n  // parameter, to determine whether to return the position at the\n  // start or at the end of this view desc.\n  var atEnd;\n  if (this.contentDOM && this.contentDOM != this.dom && this.dom.contains(this.contentDOM)) {\n    atEnd = dom.compareDocumentPosition(this.contentDOM) & 2;\n  } else if (this.dom.firstChild) {\n    if (offset == 0) { for (var search = dom;; search = search.parentNode) {\n      if (search == this.dom) { atEnd = false; break }\n      if (search.parentNode.firstChild != search) { break }\n    } }\n    if (atEnd == null && offset == dom.childNodes.length) { for (var search$1 = dom;; search$1 = search$1.parentNode) {\n      if (search$1 == this.dom) { atEnd = true; break }\n      if (search$1.parentNode.lastChild != search$1) { break }\n    } }\n  }\n  return (atEnd == null ? bias > 0 : atEnd) ? this.posAtEnd : this.posAtStart\n};\n\n// Scan up the dom finding the first desc that is a descendant of\n// this one.\nViewDesc.prototype.nearestDesc = function nearestDesc (dom, onlyNodes) {\n  for (var first = true, cur = dom; cur; cur = cur.parentNode) {\n    var desc = this.getDesc(cur);\n    if (desc && (!onlyNodes || desc.node)) {\n      // If dom is outside of this desc's nodeDOM, don't count it.\n      if (first && desc.nodeDOM &&\n          !(desc.nodeDOM.nodeType == 1 ? desc.nodeDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode) : desc.nodeDOM == dom))\n        { first = false; }\n      else\n        { return desc }\n    }\n  }\n};\n\nViewDesc.prototype.getDesc = function getDesc (dom) {\n  var desc = dom.pmViewDesc;\n  for (var cur = desc; cur; cur = cur.parent) { if (cur == this) { return desc } }\n};\n\nViewDesc.prototype.posFromDOM = function posFromDOM (dom, offset, bias) {\n  for (var scan = dom; scan; scan = scan.parentNode) {\n    var desc = this.getDesc(scan);\n    if (desc) { return desc.localPosFromDOM(dom, offset, bias) }\n  }\n  return -1\n};\n\n// : (number) → ?NodeViewDesc\n// Find the desc for the node after the given pos, if any. (When a\n// parent node overrode rendering, there might not be one.)\nViewDesc.prototype.descAt = function descAt (pos) {\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == pos && end != offset) {\n      while (!child.border && child.children.length) { child = child.children[0]; }\n      return child\n    }\n    if (pos < end) { return child.descAt(pos - offset - child.border) }\n    offset = end;\n  }\n};\n\n// : (number, number) → {node: dom.Node, offset: number}\nViewDesc.prototype.domFromPos = function domFromPos (pos, side) {\n  if (!this.contentDOM) { return {node: this.dom, offset: 0} }\n  for (var offset = 0, i = 0, first = true;; i++, first = false) {\n    // Skip removed or always-before children\n    while (i < this.children.length && (this.children[i].beforePosition ||\n                                        this.children[i].dom.parentNode != this.contentDOM))\n      { offset += this.children[i++].size; }\n    var child = i == this.children.length ? null : this.children[i];\n    if (offset == pos && (side == 0 || !child || !child.size || child.border || (side < 0 && first)) ||\n        child && child.domAtom && pos < offset + child.size) { return {\n      node: this.contentDOM,\n      offset: child ? domIndex(child.dom) : this.contentDOM.childNodes.length\n    } }\n    if (!child) { throw new Error(\"Invalid position \" + pos) }\n    var end = offset + child.size;\n    if (!child.domAtom && (side < 0 && !child.border ? end >= pos : end > pos))\n      { return child.domFromPos(pos - offset - child.border, side) }\n    offset = end;\n  }\n};\n\n// Used to find a DOM range in a single parent for a given changed\n// range.\nViewDesc.prototype.parseRange = function parseRange (from, to, base) {\n    if ( base === void 0 ) base = 0;\n\n  if (this.children.length == 0)\n    { return {node: this.contentDOM, from: from, to: to, fromOffset: 0, toOffset: this.contentDOM.childNodes.length} }\n\n  var fromOffset = -1, toOffset = -1;\n  for (var offset = base, i = 0;; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (fromOffset == -1 && from <= end) {\n      var childBase = offset + child.border;\n      // FIXME maybe descend mark views to parse a narrower range?\n      if (from >= childBase && to <= end - child.border && child.node &&\n          child.contentDOM && this.contentDOM.contains(child.contentDOM))\n        { return child.parseRange(from, to, childBase) }\n\n      from = offset;\n      for (var j = i; j > 0; j--) {\n        var prev = this.children[j - 1];\n        if (prev.size && prev.dom.parentNode == this.contentDOM && !prev.emptyChildAt(1)) {\n          fromOffset = domIndex(prev.dom) + 1;\n          break\n        }\n        from -= prev.size;\n      }\n      if (fromOffset == -1) { fromOffset = 0; }\n    }\n    if (fromOffset > -1 && (end > to || i == this.children.length - 1)) {\n      to = end;\n      for (var j$1 = i + 1; j$1 < this.children.length; j$1++) {\n        var next = this.children[j$1];\n        if (next.size && next.dom.parentNode == this.contentDOM && !next.emptyChildAt(-1)) {\n          toOffset = domIndex(next.dom);\n          break\n        }\n        to += next.size;\n      }\n      if (toOffset == -1) { toOffset = this.contentDOM.childNodes.length; }\n      break\n    }\n    offset = end;\n  }\n  return {node: this.contentDOM, from: from, to: to, fromOffset: fromOffset, toOffset: toOffset}\n};\n\nViewDesc.prototype.emptyChildAt = function emptyChildAt (side) {\n  if (this.border || !this.contentDOM || !this.children.length) { return false }\n  var child = this.children[side < 0 ? 0 : this.children.length - 1];\n  return child.size == 0 || child.emptyChildAt(side)\n};\n\n// : (number) → dom.Node\nViewDesc.prototype.domAfterPos = function domAfterPos (pos) {\n  var ref = this.domFromPos(pos, 0);\n    var node = ref.node;\n    var offset = ref.offset;\n  if (node.nodeType != 1 || offset == node.childNodes.length)\n    { throw new RangeError(\"No node after pos \" + pos) }\n  return node.childNodes[offset]\n};\n\n// : (number, number, dom.Document)\n// View descs are responsible for setting any selection that falls\n// entirely inside of them, so that custom implementations can do\n// custom things with the selection. Note that this falls apart when\n// a selection starts in such a node and ends in another, in which\n// case we just use whatever domFromPos produces as a best effort.\nViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n  // If the selection falls entirely in a child, give it to that child\n  var from = Math.min(anchor, head), to = Math.max(anchor, head);\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (from > offset && to < end)\n      { return child.setSelection(anchor - offset - child.border, head - offset - child.border, root, force) }\n    offset = end;\n  }\n\n  var anchorDOM = this.domFromPos(anchor, anchor ? -1 : 1);\n  var headDOM = head == anchor ? anchorDOM : this.domFromPos(head, head ? -1 : 1);\n  var domSel = root.getSelection();\n\n  var brKludge = false;\n  // On Firefox, using Selection.collapse to put the cursor after a\n  // BR node for some reason doesn't always work (#1073). On Safari,\n  // the cursor sometimes inexplicable visually lags behind its\n  // reported position in such situations (#1092).\n  if ((result.gecko || result.safari) && anchor == head) {\n    var node = anchorDOM.node;\n      var offset$1 = anchorDOM.offset;\n    if (node.nodeType == 3) {\n      brKludge = offset$1 && node.nodeValue[offset$1 - 1] == \"\\n\";\n      // Issue #1128\n      if (brKludge && offset$1 == node.nodeValue.length &&\n          node.nextSibling && node.nextSibling.nodeName == \"BR\")\n        { anchorDOM = headDOM = {node: node.parentNode, offset: domIndex(node) + 1}; }\n    } else {\n      var prev = node.childNodes[offset$1 - 1];\n      brKludge = prev && (prev.nodeName == \"BR\" || prev.contentEditable == \"false\");\n    }\n  }\n\n  if (!(force || brKludge && result.safari) &&\n      isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset) &&\n      isEquivalentPosition(headDOM.node, headDOM.offset, domSel.focusNode, domSel.focusOffset))\n    { return }\n\n  // Selection.extend can be used to create an 'inverted' selection\n  // (one where the focus is before the anchor), but not all\n  // browsers support it yet.\n  var domSelExtended = false;\n  if ((domSel.extend || anchor == head) && !brKludge) {\n    domSel.collapse(anchorDOM.node, anchorDOM.offset);\n    try {\n      if (anchor != head) { domSel.extend(headDOM.node, headDOM.offset); }\n      domSelExtended = true;\n    } catch (err) {\n      // In some cases with Chrome the selection is empty after calling\n      // collapse, even when it should be valid. This appears to be a bug, but\n      // it is difficult to isolate. If this happens fallback to the old path\n      // without using extend.\n      if (!(err instanceof DOMException)) { throw err }\n      // declare global: DOMException\n    }\n  }\n  if (!domSelExtended) {\n    if (anchor > head) { var tmp = anchorDOM; anchorDOM = headDOM; headDOM = tmp; }\n    var range = document.createRange();\n    range.setEnd(headDOM.node, headDOM.offset);\n    range.setStart(anchorDOM.node, anchorDOM.offset);\n    domSel.removeAllRanges();\n    domSel.addRange(range);\n  }\n};\n\n// : (dom.MutationRecord) → bool\nViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n  return !this.contentDOM && mutation.type != \"selection\"\n};\n\nprototypeAccessors.contentLost.get = function () {\n  return this.contentDOM && this.contentDOM != this.dom && !this.dom.contains(this.contentDOM)\n};\n\n// Remove a subtree of the element tree that has been touched\n// by a DOM change, so that the next update will redraw it.\nViewDesc.prototype.markDirty = function markDirty (from, to) {\n  for (var offset = 0, i = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == end ? from <= end && to >= offset : from < end && to > offset) {\n      var startInside = offset + child.border, endInside = end - child.border;\n      if (from >= startInside && to <= endInside) {\n        this.dirty = from == offset || to == end ? CONTENT_DIRTY : CHILD_DIRTY;\n        if (from == startInside && to == endInside &&\n            (child.contentLost || child.dom.parentNode != this.contentDOM)) { child.dirty = NODE_DIRTY; }\n        else { child.markDirty(from - startInside, to - startInside); }\n        return\n      } else {\n        child.dirty = NODE_DIRTY;\n      }\n    }\n    offset = end;\n  }\n  this.dirty = CONTENT_DIRTY;\n};\n\nViewDesc.prototype.markParentsDirty = function markParentsDirty () {\n  var level = 1;\n  for (var node = this.parent; node; node = node.parent, level++) {\n    var dirty = level == 1 ? CONTENT_DIRTY : CHILD_DIRTY;\n    if (node.dirty < dirty) { node.dirty = dirty; }\n  }\n};\n\nprototypeAccessors.domAtom.get = function () { return false };\n\nObject.defineProperties( ViewDesc.prototype, prototypeAccessors );\n\n// Reused array to avoid allocating fresh arrays for things that will\n// stay empty anyway.\nvar nothing = [];\n\n// A widget desc represents a widget decoration, which is a DOM node\n// drawn between the document nodes.\nvar WidgetViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function WidgetViewDesc(parent, widget, view, pos) {\n    var self, dom = widget.type.toDOM;\n    if (typeof dom == \"function\") { dom = dom(view, function () {\n      if (!self) { return pos }\n      if (self.parent) { return self.parent.posBeforeChild(self) }\n    }); }\n    if (!widget.type.spec.raw) {\n      if (dom.nodeType != 1) {\n        var wrap = document.createElement(\"span\");\n        wrap.appendChild(dom);\n        dom = wrap;\n      }\n      dom.contentEditable = false;\n      dom.classList.add(\"ProseMirror-widget\");\n    }\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.widget = widget;\n    self = this;\n  }\n\n  if ( ViewDesc ) WidgetViewDesc.__proto__ = ViewDesc;\n  WidgetViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  WidgetViewDesc.prototype.constructor = WidgetViewDesc;\n\n  var prototypeAccessors$1 = { beforePosition: { configurable: true },domAtom: { configurable: true } };\n\n  prototypeAccessors$1.beforePosition.get = function () {\n    return this.widget.type.side < 0\n  };\n\n  WidgetViewDesc.prototype.matchesWidget = function matchesWidget (widget) {\n    return this.dirty == NOT_DIRTY && widget.type.eq(this.widget.type)\n  };\n\n  WidgetViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n\n  WidgetViewDesc.prototype.stopEvent = function stopEvent (event) {\n    var stop = this.widget.spec.stopEvent;\n    return stop ? stop(event) : false\n  };\n\n  WidgetViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"selection\" || this.widget.spec.ignoreSelection\n  };\n\n  prototypeAccessors$1.domAtom.get = function () { return true };\n\n  Object.defineProperties( WidgetViewDesc.prototype, prototypeAccessors$1 );\n\n  return WidgetViewDesc;\n}(ViewDesc));\n\nvar CompositionViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function CompositionViewDesc(parent, dom, textDOM, text) {\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.textDOM = textDOM;\n    this.text = text;\n  }\n\n  if ( ViewDesc ) CompositionViewDesc.__proto__ = ViewDesc;\n  CompositionViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  CompositionViewDesc.prototype.constructor = CompositionViewDesc;\n\n  var prototypeAccessors$2 = { size: { configurable: true } };\n\n  prototypeAccessors$2.size.get = function () { return this.text.length };\n\n  CompositionViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset) {\n    if (dom != this.textDOM) { return this.posAtStart + (offset ? this.size : 0) }\n    return this.posAtStart + offset\n  };\n\n  CompositionViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.textDOM, offset: pos}\n  };\n\n  CompositionViewDesc.prototype.ignoreMutation = function ignoreMutation (mut) {\n    return mut.type === 'characterData' && mut.target.nodeValue == mut.oldValue\n   };\n\n  Object.defineProperties( CompositionViewDesc.prototype, prototypeAccessors$2 );\n\n  return CompositionViewDesc;\n}(ViewDesc));\n\n// A mark desc represents a mark. May have multiple children,\n// depending on how the mark is split. Note that marks are drawn using\n// a fixed nesting order, for simplicity and predictability, so in\n// some cases they will be split more often than would appear\n// necessary.\nvar MarkViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function MarkViewDesc(parent, mark, dom, contentDOM) {\n    ViewDesc.call(this, parent, [], dom, contentDOM);\n    this.mark = mark;\n  }\n\n  if ( ViewDesc ) MarkViewDesc.__proto__ = ViewDesc;\n  MarkViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  MarkViewDesc.prototype.constructor = MarkViewDesc;\n\n  MarkViewDesc.create = function create (parent, mark, inline, view) {\n    var custom = view.nodeViews[mark.type.name];\n    var spec = custom && custom(mark, view, inline);\n    if (!spec || !spec.dom)\n      { spec = DOMSerializer.renderSpec(document, mark.type.spec.toDOM(mark, inline)); }\n    return new MarkViewDesc(parent, mark, spec.dom, spec.contentDOM || spec.dom)\n  };\n\n  MarkViewDesc.prototype.parseRule = function parseRule () { return {mark: this.mark.type.name, attrs: this.mark.attrs, contentElement: this.contentDOM} };\n\n  MarkViewDesc.prototype.matchesMark = function matchesMark (mark) { return this.dirty != NODE_DIRTY && this.mark.eq(mark) };\n\n  MarkViewDesc.prototype.markDirty = function markDirty (from, to) {\n    ViewDesc.prototype.markDirty.call(this, from, to);\n    // Move dirty info to nearest node view\n    if (this.dirty != NOT_DIRTY) {\n      var parent = this.parent;\n      while (!parent.node) { parent = parent.parent; }\n      if (parent.dirty < this.dirty) { parent.dirty = this.dirty; }\n      this.dirty = NOT_DIRTY;\n    }\n  };\n\n  MarkViewDesc.prototype.slice = function slice (from, to, view) {\n    var copy = MarkViewDesc.create(this.parent, this.mark, true, view);\n    var nodes = this.children, size = this.size;\n    if (to < size) { nodes = replaceNodes(nodes, to, size, view); }\n    if (from > 0) { nodes = replaceNodes(nodes, 0, from, view); }\n    for (var i = 0; i < nodes.length; i++) { nodes[i].parent = copy; }\n    copy.children = nodes;\n    return copy\n  };\n\n  return MarkViewDesc;\n}(ViewDesc));\n\n// Node view descs are the main, most common type of view desc, and\n// correspond to an actual node in the document. Unlike mark descs,\n// they populate their child array themselves.\nvar NodeViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos) {\n    ViewDesc.call(this, parent, node.isLeaf ? nothing : [], dom, contentDOM);\n    this.nodeDOM = nodeDOM;\n    this.node = node;\n    this.outerDeco = outerDeco;\n    this.innerDeco = innerDeco;\n    if (contentDOM) { this.updateChildren(view, pos); }\n  }\n\n  if ( ViewDesc ) NodeViewDesc.__proto__ = ViewDesc;\n  NodeViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  NodeViewDesc.prototype.constructor = NodeViewDesc;\n\n  var prototypeAccessors$3 = { size: { configurable: true },border: { configurable: true },domAtom: { configurable: true } };\n\n  // By default, a node is rendered using the `toDOM` method from the\n  // node type spec. But client code can use the `nodeViews` spec to\n  // supply a custom node view, which can influence various aspects of\n  // the way the node works.\n  //\n  // (Using subclassing for this was intentionally decided against,\n  // since it'd require exposing a whole slew of finnicky\n  // implementation details to the user code that they probably will\n  // never need.)\n  NodeViewDesc.create = function create (parent, node, outerDeco, innerDeco, view, pos) {\n    var assign;\n\n    var custom = view.nodeViews[node.type.name], descObj;\n    var spec = custom && custom(node, view, function () {\n      // (This is a function that allows the custom view to find its\n      // own position)\n      if (!descObj) { return pos }\n      if (descObj.parent) { return descObj.parent.posBeforeChild(descObj) }\n    }, outerDeco);\n\n    var dom = spec && spec.dom, contentDOM = spec && spec.contentDOM;\n    if (node.isText) {\n      if (!dom) { dom = document.createTextNode(node.text); }\n      else if (dom.nodeType != 3) { throw new RangeError(\"Text must be rendered as a DOM text node\") }\n    } else if (!dom) {\n((assign = DOMSerializer.renderSpec(document, node.type.spec.toDOM(node)), dom = assign.dom, contentDOM = assign.contentDOM));\n    }\n    if (!contentDOM && !node.isText && dom.nodeName != \"BR\") { // Chrome gets confused by <br contenteditable=false>\n      if (!dom.hasAttribute(\"contenteditable\")) { dom.contentEditable = false; }\n      if (node.type.spec.draggable) { dom.draggable = true; }\n    }\n\n    var nodeDOM = dom;\n    dom = applyOuterDeco(dom, outerDeco, node);\n\n    if (spec)\n      { return descObj = new CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM,\n                                              spec, view, pos + 1) }\n    else if (node.isText)\n      { return new TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) }\n    else\n      { return new NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos + 1) }\n  };\n\n  NodeViewDesc.prototype.parseRule = function parseRule () {\n    var this$1 = this;\n\n    // Experimental kludge to allow opt-in re-parsing of nodes\n    if (this.node.type.spec.reparseInView) { return null }\n    // FIXME the assumption that this can always return the current\n    // attrs means that if the user somehow manages to change the\n    // attrs in the dom, that won't be picked up. Not entirely sure\n    // whether this is a problem\n    var rule = {node: this.node.type.name, attrs: this.node.attrs};\n    if (this.node.type.spec.code) { rule.preserveWhitespace = \"full\"; }\n    if (this.contentDOM && !this.contentLost) { rule.contentElement = this.contentDOM; }\n    else { rule.getContent = function () { return this$1.contentDOM ? Fragment.empty : this$1.node.content; }; }\n    return rule\n  };\n\n  NodeViewDesc.prototype.matchesNode = function matchesNode (node, outerDeco, innerDeco) {\n    return this.dirty == NOT_DIRTY && node.eq(this.node) &&\n      sameOuterDeco(outerDeco, this.outerDeco) && innerDeco.eq(this.innerDeco)\n  };\n\n  prototypeAccessors$3.size.get = function () { return this.node.nodeSize };\n\n  prototypeAccessors$3.border.get = function () { return this.node.isLeaf ? 0 : 1 };\n\n  // Syncs `this.children` to match `this.node.content` and the local\n  // decorations, possibly introducing nesting for marks. Then, in a\n  // separate step, syncs the DOM inside `this.contentDOM` to\n  // `this.children`.\n  NodeViewDesc.prototype.updateChildren = function updateChildren (view, pos) {\n    var this$1 = this;\n\n    var inline = this.node.inlineContent, off = pos;\n    var composition = inline && view.composing && this.localCompositionNode(view, pos);\n    var updater = new ViewTreeUpdater(this, composition && composition.node);\n    iterDeco(this.node, this.innerDeco, function (widget, i, insideNode) {\n      if (widget.spec.marks)\n        { updater.syncToMarks(widget.spec.marks, inline, view); }\n      else if (widget.type.side >= 0 && !insideNode)\n        { updater.syncToMarks(i == this$1.node.childCount ? Mark.none : this$1.node.child(i).marks, inline, view); }\n      // If the next node is a desc matching this widget, reuse it,\n      // otherwise insert the widget as a new view desc.\n      updater.placeWidget(widget, view, off);\n    }, function (child, outerDeco, innerDeco, i) {\n      // Make sure the wrapping mark descs match the node's marks.\n      updater.syncToMarks(child.marks, inline, view);\n      // Either find an existing desc that exactly matches this node,\n      // and drop the descs before it.\n      updater.findNodeMatch(child, outerDeco, innerDeco, i) ||\n        // Or try updating the next desc to reflect this node.\n        updater.updateNextNode(child, outerDeco, innerDeco, view, i) ||\n        // Or just add it as a new desc.\n        updater.addNode(child, outerDeco, innerDeco, view, off);\n      off += child.nodeSize;\n    });\n    // Drop all remaining descs after the current position.\n    updater.syncToMarks(nothing, inline, view);\n    if (this.node.isTextblock) { updater.addTextblockHacks(); }\n    updater.destroyRest();\n\n    // Sync the DOM if anything changed\n    if (updater.changed || this.dirty == CONTENT_DIRTY) {\n      // May have to protect focused DOM from being changed if a composition is active\n      if (composition) { this.protectLocalComposition(view, composition); }\n      renderDescs(this.contentDOM, this.children, view);\n      if (result.ios) { iosHacks(this.dom); }\n    }\n  };\n\n  NodeViewDesc.prototype.localCompositionNode = function localCompositionNode (view, pos) {\n    // Only do something if both the selection and a focused text node\n    // are inside of this node, and the node isn't already part of a\n    // view that's a child of this view\n    var ref = view.state.selection;\n    var from = ref.from;\n    var to = ref.to;\n    if (!(view.state.selection instanceof TextSelection) || from < pos || to > pos + this.node.content.size) { return }\n    var sel = view.root.getSelection();\n    var textNode = nearbyTextNode(sel.focusNode, sel.focusOffset);\n    if (!textNode || !this.dom.contains(textNode.parentNode)) { return }\n\n    // Find the text in the focused node in the node, stop if it's not\n    // there (may have been modified through other means, in which\n    // case it should overwritten)\n    var text = textNode.nodeValue;\n    var textPos = findTextInFragment(this.node.content, text, from - pos, to - pos);\n\n    return textPos < 0 ? null : {node: textNode, pos: textPos, text: text}\n  };\n\n  NodeViewDesc.prototype.protectLocalComposition = function protectLocalComposition (view, ref) {\n    var node = ref.node;\n    var pos = ref.pos;\n    var text = ref.text;\n\n    // The node is already part of a local view desc, leave it there\n    if (this.getDesc(node)) { return }\n\n    // Create a composition view for the orphaned nodes\n    var topNode = node;\n    for (;; topNode = topNode.parentNode) {\n      if (topNode.parentNode == this.contentDOM) { break }\n      while (topNode.previousSibling) { topNode.parentNode.removeChild(topNode.previousSibling); }\n      while (topNode.nextSibling) { topNode.parentNode.removeChild(topNode.nextSibling); }\n      if (topNode.pmViewDesc) { topNode.pmViewDesc = null; }\n    }\n    var desc = new CompositionViewDesc(this, topNode, node, text);\n    view.compositionNodes.push(desc);\n\n    // Patch up this.children to contain the composition view\n    this.children = replaceNodes(this.children, pos, pos + text.length, view, desc);\n  };\n\n  // : (Node, [Decoration], DecorationSet, EditorView) → bool\n  // If this desc be updated to match the given node decoration,\n  // do so and return true.\n  NodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateInner(node, outerDeco, innerDeco, view);\n    return true\n  };\n\n  NodeViewDesc.prototype.updateInner = function updateInner (node, outerDeco, innerDeco, view) {\n    this.updateOuterDeco(outerDeco);\n    this.node = node;\n    this.innerDeco = innerDeco;\n    if (this.contentDOM) { this.updateChildren(view, this.posAtStart); }\n    this.dirty = NOT_DIRTY;\n  };\n\n  NodeViewDesc.prototype.updateOuterDeco = function updateOuterDeco (outerDeco) {\n    if (sameOuterDeco(outerDeco, this.outerDeco)) { return }\n    var needsWrap = this.nodeDOM.nodeType != 1;\n    var oldDOM = this.dom;\n    this.dom = patchOuterDeco(this.dom, this.nodeDOM,\n                              computeOuterDeco(this.outerDeco, this.node, needsWrap),\n                              computeOuterDeco(outerDeco, this.node, needsWrap));\n    if (this.dom != oldDOM) {\n      oldDOM.pmViewDesc = null;\n      this.dom.pmViewDesc = this;\n    }\n    this.outerDeco = outerDeco;\n  };\n\n  // Mark this node as being the selected node.\n  NodeViewDesc.prototype.selectNode = function selectNode () {\n    this.nodeDOM.classList.add(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.draggable = true; }\n  };\n\n  // Remove selected node marking from this node.\n  NodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.nodeDOM.classList.remove(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.removeAttribute(\"draggable\"); }\n  };\n\n  prototypeAccessors$3.domAtom.get = function () { return this.node.isAtom };\n\n  Object.defineProperties( NodeViewDesc.prototype, prototypeAccessors$3 );\n\n  return NodeViewDesc;\n}(ViewDesc));\n\n// Create a view desc for the top-level document node, to be exported\n// and used by the view class.\nfunction docViewDesc(doc, outerDeco, innerDeco, dom, view) {\n  applyOuterDeco(dom, outerDeco, doc);\n  return new NodeViewDesc(null, doc, outerDeco, innerDeco, dom, dom, dom, view, 0)\n}\n\nvar TextViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, null, nodeDOM, view);\n  }\n\n  if ( NodeViewDesc ) TextViewDesc.__proto__ = NodeViewDesc;\n  TextViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  TextViewDesc.prototype.constructor = TextViewDesc;\n\n  var prototypeAccessors$4 = { domAtom: { configurable: true } };\n\n  TextViewDesc.prototype.parseRule = function parseRule () {\n    var skip = this.nodeDOM.parentNode;\n    while (skip && skip != this.dom && !skip.pmIsDeco) { skip = skip.parentNode; }\n    return {skip: skip || true}\n  };\n\n  TextViewDesc.prototype.update = function update (node, outerDeco, _, view) {\n    if (this.dirty == NODE_DIRTY || (this.dirty != NOT_DIRTY && !this.inParent()) ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateOuterDeco(outerDeco);\n    if ((this.dirty != NOT_DIRTY || node.text != this.node.text) && node.text != this.nodeDOM.nodeValue) {\n      this.nodeDOM.nodeValue = node.text;\n      if (view.trackWrites == this.nodeDOM) { view.trackWrites = null; }\n    }\n    this.node = node;\n    this.dirty = NOT_DIRTY;\n    return true\n  };\n\n  TextViewDesc.prototype.inParent = function inParent () {\n    var parentDOM = this.parent.contentDOM;\n    for (var n = this.nodeDOM; n; n = n.parentNode) { if (n == parentDOM) { return true } }\n    return false\n  };\n\n  TextViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.nodeDOM, offset: pos}\n  };\n\n  TextViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n    if (dom == this.nodeDOM) { return this.posAtStart + Math.min(offset, this.node.text.length) }\n    return NodeViewDesc.prototype.localPosFromDOM.call(this, dom, offset, bias)\n  };\n\n  TextViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"characterData\" && mutation.type != \"selection\"\n  };\n\n  TextViewDesc.prototype.slice = function slice (from, to, view) {\n    var node = this.node.cut(from, to), dom = document.createTextNode(node.text);\n    return new TextViewDesc(this.parent, node, this.outerDeco, this.innerDeco, dom, dom, view)\n  };\n\n  prototypeAccessors$4.domAtom.get = function () { return false };\n\n  Object.defineProperties( TextViewDesc.prototype, prototypeAccessors$4 );\n\n  return TextViewDesc;\n}(NodeViewDesc));\n\n// A dummy desc used to tag trailing BR or span nodes created to work\n// around contentEditable terribleness.\nvar BRHackViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function BRHackViewDesc () {\n    ViewDesc.apply(this, arguments);\n  }\n\n  if ( ViewDesc ) BRHackViewDesc.__proto__ = ViewDesc;\n  BRHackViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  BRHackViewDesc.prototype.constructor = BRHackViewDesc;\n\n  var prototypeAccessors$5 = { domAtom: { configurable: true } };\n\n  BRHackViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n  BRHackViewDesc.prototype.matchesHack = function matchesHack () { return this.dirty == NOT_DIRTY };\n  prototypeAccessors$5.domAtom.get = function () { return true };\n\n  Object.defineProperties( BRHackViewDesc.prototype, prototypeAccessors$5 );\n\n  return BRHackViewDesc;\n}(ViewDesc));\n\n// A separate subclass is used for customized node views, so that the\n// extra checks only have to be made for nodes that are actually\n// customized.\nvar CustomNodeViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, spec, view, pos) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos);\n    this.spec = spec;\n  }\n\n  if ( NodeViewDesc ) CustomNodeViewDesc.__proto__ = NodeViewDesc;\n  CustomNodeViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  CustomNodeViewDesc.prototype.constructor = CustomNodeViewDesc;\n\n  // A custom `update` method gets to decide whether the update goes\n  // through. If it does, and there's a `contentDOM` node, our logic\n  // updates the children.\n  CustomNodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY) { return false }\n    if (this.spec.update) {\n      var result = this.spec.update(node, outerDeco);\n      if (result) { this.updateInner(node, outerDeco, innerDeco, view); }\n      return result\n    } else if (!this.contentDOM && !node.isLeaf) {\n      return false\n    } else {\n      return NodeViewDesc.prototype.update.call(this, node, outerDeco, innerDeco, view)\n    }\n  };\n\n  CustomNodeViewDesc.prototype.selectNode = function selectNode () {\n    this.spec.selectNode ? this.spec.selectNode() : NodeViewDesc.prototype.selectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.spec.deselectNode ? this.spec.deselectNode() : NodeViewDesc.prototype.deselectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n    this.spec.setSelection ? this.spec.setSelection(anchor, head, root)\n      : NodeViewDesc.prototype.setSelection.call(this, anchor, head, root, force);\n  };\n\n  CustomNodeViewDesc.prototype.destroy = function destroy () {\n    if (this.spec.destroy) { this.spec.destroy(); }\n    NodeViewDesc.prototype.destroy.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.stopEvent = function stopEvent (event) {\n    return this.spec.stopEvent ? this.spec.stopEvent(event) : false\n  };\n\n  CustomNodeViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return this.spec.ignoreMutation ? this.spec.ignoreMutation(mutation) : NodeViewDesc.prototype.ignoreMutation.call(this, mutation)\n  };\n\n  return CustomNodeViewDesc;\n}(NodeViewDesc));\n\n// : (dom.Node, [ViewDesc])\n// Sync the content of the given DOM node with the nodes associated\n// with the given array of view descs, recursing into mark descs\n// because this should sync the subtree for a whole node at a time.\nfunction renderDescs(parentDOM, descs, view) {\n  var dom = parentDOM.firstChild, written = false;\n  for (var i = 0; i < descs.length; i++) {\n    var desc = descs[i], childDOM = desc.dom;\n    if (childDOM.parentNode == parentDOM) {\n      while (childDOM != dom) { dom = rm(dom); written = true; }\n      dom = dom.nextSibling;\n    } else {\n      written = true;\n      parentDOM.insertBefore(childDOM, dom);\n    }\n    if (desc instanceof MarkViewDesc) {\n      var pos = dom ? dom.previousSibling : parentDOM.lastChild;\n      renderDescs(desc.contentDOM, desc.children, view);\n      dom = pos ? pos.nextSibling : parentDOM.firstChild;\n    }\n  }\n  while (dom) { dom = rm(dom); written = true; }\n  if (written && view.trackWrites == parentDOM) { view.trackWrites = null; }\n}\n\nfunction OuterDecoLevel(nodeName) {\n  if (nodeName) { this.nodeName = nodeName; }\n}\nOuterDecoLevel.prototype = Object.create(null);\n\nvar noDeco = [new OuterDecoLevel];\n\nfunction computeOuterDeco(outerDeco, node, needsWrap) {\n  if (outerDeco.length == 0) { return noDeco }\n\n  var top = needsWrap ? noDeco[0] : new OuterDecoLevel, result = [top];\n\n  for (var i = 0; i < outerDeco.length; i++) {\n    var attrs = outerDeco[i].type.attrs;\n    if (!attrs) { continue }\n    if (attrs.nodeName)\n      { result.push(top = new OuterDecoLevel(attrs.nodeName)); }\n\n    for (var name in attrs) {\n      var val = attrs[name];\n      if (val == null) { continue }\n      if (needsWrap && result.length == 1)\n        { result.push(top = new OuterDecoLevel(node.isInline ? \"span\" : \"div\")); }\n      if (name == \"class\") { top.class = (top.class ? top.class + \" \" : \"\") + val; }\n      else if (name == \"style\") { top.style = (top.style ? top.style + \";\" : \"\") + val; }\n      else if (name != \"nodeName\") { top[name] = val; }\n    }\n  }\n\n  return result\n}\n\nfunction patchOuterDeco(outerDOM, nodeDOM, prevComputed, curComputed) {\n  // Shortcut for trivial case\n  if (prevComputed == noDeco && curComputed == noDeco) { return nodeDOM }\n\n  var curDOM = nodeDOM;\n  for (var i = 0; i < curComputed.length; i++) {\n    var deco = curComputed[i], prev = prevComputed[i];\n    if (i) {\n      var parent = (void 0);\n      if (prev && prev.nodeName == deco.nodeName && curDOM != outerDOM &&\n          (parent = curDOM.parentNode) && parent.tagName.toLowerCase() == deco.nodeName) {\n        curDOM = parent;\n      } else {\n        parent = document.createElement(deco.nodeName);\n        parent.pmIsDeco = true;\n        parent.appendChild(curDOM);\n        prev = noDeco[0];\n        curDOM = parent;\n      }\n    }\n    patchAttributes(curDOM, prev || noDeco[0], deco);\n  }\n  return curDOM\n}\n\nfunction patchAttributes(dom, prev, cur) {\n  for (var name in prev)\n    { if (name != \"class\" && name != \"style\" && name != \"nodeName\" && !(name in cur))\n      { dom.removeAttribute(name); } }\n  for (var name$1 in cur)\n    { if (name$1 != \"class\" && name$1 != \"style\" && name$1 != \"nodeName\" && cur[name$1] != prev[name$1])\n      { dom.setAttribute(name$1, cur[name$1]); } }\n  if (prev.class != cur.class) {\n    var prevList = prev.class ? prev.class.split(\" \") : nothing;\n    var curList = cur.class ? cur.class.split(\" \") : nothing;\n    for (var i = 0; i < prevList.length; i++) { if (curList.indexOf(prevList[i]) == -1)\n      { dom.classList.remove(prevList[i]); } }\n    for (var i$1 = 0; i$1 < curList.length; i$1++) { if (prevList.indexOf(curList[i$1]) == -1)\n      { dom.classList.add(curList[i$1]); } }\n  }\n  if (prev.style != cur.style) {\n    if (prev.style) {\n      var prop = /\\s*([\\w\\-\\xa1-\\uffff]+)\\s*:(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|\\(.*?\\)|[^;])*/g, m;\n      while (m = prop.exec(prev.style))\n        { dom.style.removeProperty(m[1]); }\n    }\n    if (cur.style)\n      { dom.style.cssText += cur.style; }\n  }\n}\n\nfunction applyOuterDeco(dom, deco, node) {\n  return patchOuterDeco(dom, dom, noDeco, computeOuterDeco(deco, node, dom.nodeType != 1))\n}\n\n// : ([Decoration], [Decoration]) → bool\nfunction sameOuterDeco(a, b) {\n  if (a.length != b.length) { return false }\n  for (var i = 0; i < a.length; i++) { if (!a[i].type.eq(b[i].type)) { return false } }\n  return true\n}\n\n// Remove a DOM node and return its next sibling.\nfunction rm(dom) {\n  var next = dom.nextSibling;\n  dom.parentNode.removeChild(dom);\n  return next\n}\n\n// Helper class for incrementally updating a tree of mark descs and\n// the widget and node descs inside of them.\nvar ViewTreeUpdater = function ViewTreeUpdater(top, lockedNode) {\n  this.top = top;\n  this.lock = lockedNode;\n  // Index into `this.top`'s child array, represents the current\n  // update position.\n  this.index = 0;\n  // When entering a mark, the current top and index are pushed\n  // onto this.\n  this.stack = [];\n  // Tracks whether anything was changed\n  this.changed = false;\n\n  var pre = preMatch(top.node.content, top.children);\n  this.preMatched = pre.nodes;\n  this.preMatchOffset = pre.offset;\n};\n\nViewTreeUpdater.prototype.getPreMatch = function getPreMatch (index) {\n  return index >= this.preMatchOffset ? this.preMatched[index - this.preMatchOffset] : null\n};\n\n// Destroy and remove the children between the given indices in\n// `this.top`.\nViewTreeUpdater.prototype.destroyBetween = function destroyBetween (start, end) {\n  if (start == end) { return }\n  for (var i = start; i < end; i++) { this.top.children[i].destroy(); }\n  this.top.children.splice(start, end - start);\n  this.changed = true;\n};\n\n// Destroy all remaining children in `this.top`.\nViewTreeUpdater.prototype.destroyRest = function destroyRest () {\n  this.destroyBetween(this.index, this.top.children.length);\n};\n\n// : ([Mark], EditorView)\n// Sync the current stack of mark descs with the given array of\n// marks, reusing existing mark descs when possible.\nViewTreeUpdater.prototype.syncToMarks = function syncToMarks (marks, inline, view) {\n  var keep = 0, depth = this.stack.length >> 1;\n  var maxKeep = Math.min(depth, marks.length);\n  while (keep < maxKeep &&\n         (keep == depth - 1 ? this.top : this.stack[(keep + 1) << 1]).matchesMark(marks[keep]) && marks[keep].type.spec.spanning !== false)\n    { keep++; }\n\n  while (keep < depth) {\n    this.destroyRest();\n    this.top.dirty = NOT_DIRTY;\n    this.index = this.stack.pop();\n    this.top = this.stack.pop();\n    depth--;\n  }\n  while (depth < marks.length) {\n    this.stack.push(this.top, this.index + 1);\n    var found = -1;\n    for (var i = this.index; i < Math.min(this.index + 3, this.top.children.length); i++) {\n      if (this.top.children[i].matchesMark(marks[depth])) { found = i; break }\n    }\n    if (found > -1) {\n      if (found > this.index) {\n        this.changed = true;\n        this.destroyBetween(this.index, found);\n      }\n      this.top = this.top.children[this.index];\n    } else {\n      var markDesc = MarkViewDesc.create(this.top, marks[depth], inline, view);\n      this.top.children.splice(this.index, 0, markDesc);\n      this.top = markDesc;\n      this.changed = true;\n    }\n    this.index = 0;\n    depth++;\n  }\n};\n\n// : (Node, [Decoration], DecorationSet) → bool\n// Try to find a node desc matching the given data. Skip over it and\n// return true when successful.\nViewTreeUpdater.prototype.findNodeMatch = function findNodeMatch (node, outerDeco, innerDeco, index) {\n  var found = -1, preMatch = index < 0 ? undefined : this.getPreMatch(index), children = this.top.children;\n  if (preMatch && preMatch.matchesNode(node, outerDeco, innerDeco)) {\n    found = children.indexOf(preMatch);\n  } else {\n    for (var i = this.index, e = Math.min(children.length, i + 5); i < e; i++) {\n      var child = children[i];\n      if (child.matchesNode(node, outerDeco, innerDeco) && this.preMatched.indexOf(child) < 0) {\n        found = i;\n        break\n      }\n    }\n  }\n  if (found < 0) { return false }\n  this.destroyBetween(this.index, found);\n  this.index++;\n  return true\n};\n\n// : (Node, [Decoration], DecorationSet, EditorView, Fragment, number) → bool\n// Try to update the next node, if any, to the given data. Checks\n// pre-matches to avoid overwriting nodes that could still be used.\nViewTreeUpdater.prototype.updateNextNode = function updateNextNode (node, outerDeco, innerDeco, view, index) {\n  for (var i = this.index; i < this.top.children.length; i++) {\n    var next = this.top.children[i];\n    if (next instanceof NodeViewDesc) {\n      var preMatch = this.preMatched.indexOf(next);\n      if (preMatch > -1 && preMatch + this.preMatchOffset != index) { return false }\n      var nextDOM = next.dom;\n\n      // Can't update if nextDOM is or contains this.lock, except if\n      // it's a text node whose content already matches the new text\n      // and whose decorations match the new ones.\n      var locked = this.lock && (nextDOM == this.lock || nextDOM.nodeType == 1 && nextDOM.contains(this.lock.parentNode)) &&\n          !(node.isText && next.node && next.node.isText && next.nodeDOM.nodeValue == node.text &&\n            next.dirty != NODE_DIRTY && sameOuterDeco(outerDeco, next.outerDeco));\n      if (!locked && next.update(node, outerDeco, innerDeco, view)) {\n        this.destroyBetween(this.index, i);\n        if (next.dom != nextDOM) { this.changed = true; }\n        this.index++;\n        return true\n      }\n      break\n    }\n  }\n  return false\n};\n\n// : (Node, [Decoration], DecorationSet, EditorView)\n// Insert the node as a newly created node desc.\nViewTreeUpdater.prototype.addNode = function addNode (node, outerDeco, innerDeco, view, pos) {\n  this.top.children.splice(this.index++, 0, NodeViewDesc.create(this.top, node, outerDeco, innerDeco, view, pos));\n  this.changed = true;\n};\n\nViewTreeUpdater.prototype.placeWidget = function placeWidget (widget, view, pos) {\n  var next = this.index < this.top.children.length ? this.top.children[this.index] : null;\n  if (next && next.matchesWidget(widget) && (widget == next.widget || !next.widget.type.toDOM.parentNode)) {\n    this.index++;\n  } else {\n    var desc = new WidgetViewDesc(this.top, widget, view, pos);\n    this.top.children.splice(this.index++, 0, desc);\n    this.changed = true;\n  }\n};\n\n// Make sure a textblock looks and behaves correctly in\n// contentEditable.\nViewTreeUpdater.prototype.addTextblockHacks = function addTextblockHacks () {\n  var lastChild = this.top.children[this.index - 1];\n  while (lastChild instanceof MarkViewDesc) { lastChild = lastChild.children[lastChild.children.length - 1]; }\n\n  if (!lastChild || // Empty textblock\n      !(lastChild instanceof TextViewDesc) ||\n      /\\n$/.test(lastChild.node.text)) {\n    if (this.index < this.top.children.length && this.top.children[this.index].matchesHack()) {\n      this.index++;\n    } else {\n      var dom = document.createElement(\"br\");\n      this.top.children.splice(this.index++, 0, new BRHackViewDesc(this.top, nothing, dom, null));\n      this.changed = true;\n    }\n  }\n};\n\n// : (Fragment, [ViewDesc]) → [ViewDesc]\n// Iterate from the end of the fragment and array of descs to find\n// directly matching ones, in order to avoid overeagerly reusing\n// those for other nodes. Returns an array whose positions correspond\n// to node positions in the fragment, and whose elements are either\n// descs matched to the child at that index, or empty.\nfunction preMatch(frag, descs) {\n  var result = [], end = frag.childCount;\n  for (var i = descs.length - 1; end > 0 && i >= 0; i--) {\n    var desc = descs[i], node = desc.node;\n    if (!node) { continue }\n    if (node != frag.child(end - 1)) { break }\n    result.push(desc);\n    --end;\n  }\n  return {nodes: result.reverse(), offset: end}\n}\n\nfunction compareSide(a, b) { return a.type.side - b.type.side }\n\n// : (ViewDesc, DecorationSet, (Decoration, number), (Node, [Decoration], DecorationSet, number))\n// This function abstracts iterating over the nodes and decorations in\n// a fragment. Calls `onNode` for each node, with its local and child\n// decorations. Splits text nodes when there is a decoration starting\n// or ending inside of them. Calls `onWidget` for each widget.\nfunction iterDeco(parent, deco, onWidget, onNode) {\n  var locals = deco.locals(parent), offset = 0;\n  // Simple, cheap variant for when there are no local decorations\n  if (locals.length == 0) {\n    for (var i = 0; i < parent.childCount; i++) {\n      var child = parent.child(i);\n      onNode(child, locals, deco.forChild(offset, child), i);\n      offset += child.nodeSize;\n    }\n    return\n  }\n\n  var decoIndex = 0, active = [], restNode = null;\n  for (var parentIndex = 0;;) {\n    if (decoIndex < locals.length && locals[decoIndex].to == offset) {\n      var widget = locals[decoIndex++], widgets = (void 0);\n      while (decoIndex < locals.length && locals[decoIndex].to == offset)\n        { (widgets || (widgets = [widget])).push(locals[decoIndex++]); }\n      if (widgets) {\n        widgets.sort(compareSide);\n        for (var i$1 = 0; i$1 < widgets.length; i$1++) { onWidget(widgets[i$1], parentIndex, !!restNode); }\n      } else {\n        onWidget(widget, parentIndex, !!restNode);\n      }\n    }\n\n    var child$1 = (void 0), index = (void 0);\n    if (restNode) {\n      index = -1;\n      child$1 = restNode;\n      restNode = null;\n    } else if (parentIndex < parent.childCount) {\n      index = parentIndex;\n      child$1 = parent.child(parentIndex++);\n    } else {\n      break\n    }\n\n    for (var i$2 = 0; i$2 < active.length; i$2++) { if (active[i$2].to <= offset) { active.splice(i$2--, 1); } }\n    while (decoIndex < locals.length && locals[decoIndex].from <= offset && locals[decoIndex].to > offset)\n      { active.push(locals[decoIndex++]); }\n\n    var end = offset + child$1.nodeSize;\n    if (child$1.isText) {\n      var cutAt = end;\n      if (decoIndex < locals.length && locals[decoIndex].from < cutAt) { cutAt = locals[decoIndex].from; }\n      for (var i$3 = 0; i$3 < active.length; i$3++) { if (active[i$3].to < cutAt) { cutAt = active[i$3].to; } }\n      if (cutAt < end) {\n        restNode = child$1.cut(cutAt - offset);\n        child$1 = child$1.cut(0, cutAt - offset);\n        end = cutAt;\n        index = -1;\n      }\n    }\n\n    var outerDeco = !active.length ? nothing\n        : child$1.isInline && !child$1.isLeaf ? active.filter(function (d) { return !d.inline; })\n        : active.slice();\n    onNode(child$1, outerDeco, deco.forChild(offset, child$1), index);\n    offset = end;\n  }\n}\n\n// List markers in Mobile Safari will mysteriously disappear\n// sometimes. This works around that.\nfunction iosHacks(dom) {\n  if (dom.nodeName == \"UL\" || dom.nodeName == \"OL\") {\n    var oldCSS = dom.style.cssText;\n    dom.style.cssText = oldCSS + \"; list-style: square !important\";\n    window.getComputedStyle(dom).listStyle;\n    dom.style.cssText = oldCSS;\n  }\n}\n\nfunction nearbyTextNode(node, offset) {\n  for (;;) {\n    if (node.nodeType == 3) { return node }\n    if (node.nodeType == 1 && offset > 0) {\n      if (node.childNodes.length > offset && node.childNodes[offset].nodeType == 3)\n        { return node.childNodes[offset] }\n      node = node.childNodes[offset - 1];\n      offset = nodeSize(node);\n    } else if (node.nodeType == 1 && offset < node.childNodes.length) {\n      node = node.childNodes[offset];\n      offset = 0;\n    } else {\n      return null\n    }\n  }\n}\n\n// Find a piece of text in an inline fragment, overlapping from-to\nfunction findTextInFragment(frag, text, from, to) {\n  for (var i = 0, pos = 0; i < frag.childCount && pos <= to;) {\n    var child = frag.child(i++), childStart = pos;\n    pos += child.nodeSize;\n    if (!child.isText) { continue }\n    var str = child.text;\n    while (i < frag.childCount) {\n      var next = frag.child(i++);\n      pos += next.nodeSize;\n      if (!next.isText) { break }\n      str += next.text;\n    }\n    if (pos >= from) {\n      var found = str.lastIndexOf(text, to - childStart);\n      if (found >= 0 && found + text.length + childStart >= from)\n        { return childStart + found }\n    }\n  }\n  return -1\n}\n\n// Replace range from-to in an array of view descs with replacement\n// (may be null to just delete). This goes very much against the grain\n// of the rest of this code, which tends to create nodes with the\n// right shape in one go, rather than messing with them after\n// creation, but is necessary in the composition hack.\nfunction replaceNodes(nodes, from, to, view, replacement) {\n  var result = [];\n  for (var i = 0, off = 0; i < nodes.length; i++) {\n    var child = nodes[i], start = off, end = off += child.size;\n    if (start >= to || end <= from) {\n      result.push(child);\n    } else {\n      if (start < from) { result.push(child.slice(0, from - start, view)); }\n      if (replacement) {\n        result.push(replacement);\n        replacement = null;\n      }\n      if (end > to) { result.push(child.slice(to - start, child.size, view)); }\n    }\n  }\n  return result\n}\n\nfunction selectionFromDOM(view, origin) {\n  var domSel = view.root.getSelection(), doc = view.state.doc;\n  if (!domSel.focusNode) { return null }\n  var nearestDesc = view.docView.nearestDesc(domSel.focusNode), inWidget = nearestDesc && nearestDesc.size == 0;\n  var head = view.docView.posFromDOM(domSel.focusNode, domSel.focusOffset);\n  if (head < 0) { return null }\n  var $head = doc.resolve(head), $anchor, selection;\n  if (selectionCollapsed(domSel)) {\n    $anchor = $head;\n    while (nearestDesc && !nearestDesc.node) { nearestDesc = nearestDesc.parent; }\n    if (nearestDesc && nearestDesc.node.isAtom && NodeSelection.isSelectable(nearestDesc.node) && nearestDesc.parent\n        && !(nearestDesc.node.isInline && isOnEdge(domSel.focusNode, domSel.focusOffset, nearestDesc.dom))) {\n      var pos = nearestDesc.posBefore;\n      selection = new NodeSelection(head == pos ? $head : doc.resolve(pos));\n    }\n  } else {\n    var anchor = view.docView.posFromDOM(domSel.anchorNode, domSel.anchorOffset);\n    if (anchor < 0) { return null }\n    $anchor = doc.resolve(anchor);\n  }\n\n  if (!selection) {\n    var bias = origin == \"pointer\" || (view.state.selection.head < $head.pos && !inWidget) ? 1 : -1;\n    selection = selectionBetween(view, $anchor, $head, bias);\n  }\n  return selection\n}\n\nfunction selectionToDOM(view, force) {\n  var sel = view.state.selection;\n  syncNodeSelection(view, sel);\n\n  if (view.editable ? !view.hasFocus() :\n      !(hasSelection(view) && document.activeElement && document.activeElement.contains(view.dom))) { return }\n\n  view.domObserver.disconnectSelection();\n\n  if (view.cursorWrapper) {\n    selectCursorWrapper(view);\n  } else {\n    var anchor = sel.anchor;\n    var head = sel.head;\n    var resetEditableFrom, resetEditableTo;\n    if (brokenSelectBetweenUneditable && !(sel instanceof TextSelection)) {\n      if (!sel.$from.parent.inlineContent)\n        { resetEditableFrom = temporarilyEditableNear(view, sel.from); }\n      if (!sel.empty && !sel.$from.parent.inlineContent)\n        { resetEditableTo = temporarilyEditableNear(view, sel.to); }\n    }\n    view.docView.setSelection(anchor, head, view.root, force);\n    if (brokenSelectBetweenUneditable) {\n      if (resetEditableFrom) { resetEditable(resetEditableFrom); }\n      if (resetEditableTo) { resetEditable(resetEditableTo); }\n    }\n    if (sel.visible) {\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    } else {\n      view.dom.classList.add(\"ProseMirror-hideselection\");\n      if (\"onselectionchange\" in document) { removeClassOnSelectionChange(view); }\n    }\n  }\n\n  view.domObserver.setCurSelection();\n  view.domObserver.connectSelection();\n}\n\n// Kludge to work around Webkit not allowing a selection to start/end\n// between non-editable block nodes. We briefly make something\n// editable, set the selection, then set it uneditable again.\n\nvar brokenSelectBetweenUneditable = result.safari || result.chrome && result.chrome_version < 63;\n\nfunction temporarilyEditableNear(view, pos) {\n  var ref = view.docView.domFromPos(pos, 0);\n  var node = ref.node;\n  var offset = ref.offset;\n  var after = offset < node.childNodes.length ? node.childNodes[offset] : null;\n  var before = offset ? node.childNodes[offset - 1] : null;\n  if (result.safari && after && after.contentEditable == \"false\") { return setEditable(after) }\n  if ((!after || after.contentEditable == \"false\") && (!before || before.contentEditable == \"false\")) {\n    if (after) { return setEditable(after) }\n    else if (before) { return setEditable(before) }\n  }\n}\n\nfunction setEditable(element) {\n  element.contentEditable = \"true\";\n  if (result.safari && element.draggable) { element.draggable = false; element.wasDraggable = true; }\n  return element\n}\n\nfunction resetEditable(element) {\n  element.contentEditable = \"false\";\n  if (element.wasDraggable) { element.draggable = true; element.wasDraggable = null; }\n}\n\nfunction removeClassOnSelectionChange(view) {\n  var doc = view.dom.ownerDocument;\n  doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n  var domSel = view.root.getSelection();\n  var node = domSel.anchorNode, offset = domSel.anchorOffset;\n  doc.addEventListener(\"selectionchange\", view.hideSelectionGuard = function () {\n    if (domSel.anchorNode != node || domSel.anchorOffset != offset) {\n      doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    }\n  });\n}\n\nfunction selectCursorWrapper(view) {\n  var domSel = view.root.getSelection(), range = document.createRange();\n  var node = view.cursorWrapper.dom, img = node.nodeName == \"IMG\";\n  if (img) { range.setEnd(node.parentNode, domIndex(node) + 1); }\n  else { range.setEnd(node, 0); }\n  range.collapse(false);\n  domSel.removeAllRanges();\n  domSel.addRange(range);\n  // Kludge to kill 'control selection' in IE11 when selecting an\n  // invisible cursor wrapper, since that would result in those weird\n  // resize handles and a selection that considers the absolutely\n  // positioned wrapper, rather than the root editable node, the\n  // focused element.\n  if (!img && !view.state.selection.visible && result.ie && result.ie_version <= 11) {\n    node.disabled = true;\n    node.disabled = false;\n  }\n}\n\nfunction syncNodeSelection(view, sel) {\n  if (sel instanceof NodeSelection) {\n    var desc = view.docView.descAt(sel.from);\n    if (desc != view.lastSelectedViewDesc) {\n      clearNodeSelection(view);\n      if (desc) { desc.selectNode(); }\n      view.lastSelectedViewDesc = desc;\n    }\n  } else {\n    clearNodeSelection(view);\n  }\n}\n\n// Clear all DOM statefulness of the last node selection.\nfunction clearNodeSelection(view) {\n  if (view.lastSelectedViewDesc) {\n    if (view.lastSelectedViewDesc.parent)\n      { view.lastSelectedViewDesc.deselectNode(); }\n    view.lastSelectedViewDesc = null;\n  }\n}\n\nfunction selectionBetween(view, $anchor, $head, bias) {\n  return view.someProp(\"createSelectionBetween\", function (f) { return f(view, $anchor, $head); })\n    || TextSelection.between($anchor, $head, bias)\n}\n\nfunction hasFocusAndSelection(view) {\n  if (view.editable && view.root.activeElement != view.dom) { return false }\n  return hasSelection(view)\n}\n\nfunction hasSelection(view) {\n  var sel = view.root.getSelection();\n  if (!sel.anchorNode) { return false }\n  try {\n    // Firefox will raise 'permission denied' errors when accessing\n    // properties of `sel.anchorNode` when it's in a generated CSS\n    // element.\n    return view.dom.contains(sel.anchorNode.nodeType == 3 ? sel.anchorNode.parentNode : sel.anchorNode) &&\n      (view.editable || view.dom.contains(sel.focusNode.nodeType == 3 ? sel.focusNode.parentNode : sel.focusNode))\n  } catch(_) {\n    return false\n  }\n}\n\nfunction anchorInRightPlace(view) {\n  var anchorDOM = view.docView.domFromPos(view.state.selection.anchor, 0);\n  var domSel = view.root.getSelection();\n  return isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset)\n}\n\nfunction moveSelectionBlock(state, dir) {\n  var ref = state.selection;\n  var $anchor = ref.$anchor;\n  var $head = ref.$head;\n  var $side = dir > 0 ? $anchor.max($head) : $anchor.min($head);\n  var $start = !$side.parent.inlineContent ? $side : $side.depth ? state.doc.resolve(dir > 0 ? $side.after() : $side.before()) : null;\n  return $start && Selection.findFrom($start, dir)\n}\n\nfunction apply(view, sel) {\n  view.dispatch(view.state.tr.setSelection(sel).scrollIntoView());\n  return true\n}\n\nfunction selectHorizontally(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection) {\n    if (!sel.empty || mods.indexOf(\"s\") > -1) {\n      return false\n    } else if (view.endOfTextblock(dir > 0 ? \"right\" : \"left\")) {\n      var next = moveSelectionBlock(view.state, dir);\n      if (next && (next instanceof NodeSelection)) { return apply(view, next) }\n      return false\n    } else if (!(result.mac && mods.indexOf(\"m\") > -1)) {\n      var $head = sel.$head, node = $head.textOffset ? null : dir < 0 ? $head.nodeBefore : $head.nodeAfter, desc;\n      if (!node || node.isText) { return false }\n      var nodePos = dir < 0 ? $head.pos - node.nodeSize : $head.pos;\n      if (!(node.isAtom || (desc = view.docView.descAt(nodePos)) && !desc.contentDOM)) { return false }\n      if (NodeSelection.isSelectable(node)) {\n        return apply(view, new NodeSelection(dir < 0 ? view.state.doc.resolve($head.pos - node.nodeSize) : $head))\n      } else if (result.webkit) {\n        // Chrome and Safari will introduce extra pointless cursor\n        // positions around inline uneditable nodes, so we have to\n        // take over and move the cursor past them (#937)\n        return apply(view, new TextSelection(view.state.doc.resolve(dir < 0 ? nodePos : nodePos + node.nodeSize)))\n      } else {\n        return false\n      }\n    }\n  } else if (sel instanceof NodeSelection && sel.node.isInline) {\n    return apply(view, new TextSelection(dir > 0 ? sel.$to : sel.$from))\n  } else {\n    var next$1 = moveSelectionBlock(view.state, dir);\n    if (next$1) { return apply(view, next$1) }\n    return false\n  }\n}\n\nfunction nodeLen(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isIgnorable(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.size == 0 && (dom.nextSibling || dom.nodeName != \"BR\")\n}\n\n// Make sure the cursor isn't directly after one or more ignored\n// nodes, which will confuse the browser's cursor motion logic.\nfunction skipIgnoredNodesLeft(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var moveNode, moveOffset, force = false;\n  // Gecko will do odd things when the selection is directly in front\n  // of a non-editable node, so in that case, move it into the next\n  // node if possible. Issue prosemirror/prosemirror#832.\n  if (result.gecko && node.nodeType == 1 && offset < nodeLen(node) && isIgnorable(node.childNodes[offset])) { force = true; }\n  for (;;) {\n    if (offset > 0) {\n      if (node.nodeType != 1) {\n        break\n      } else {\n        var before = node.childNodes[offset - 1];\n        if (isIgnorable(before)) {\n          moveNode = node;\n          moveOffset = --offset;\n        } else if (before.nodeType == 3) {\n          node = before;\n          offset = node.nodeValue.length;\n        } else { break }\n      }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var prev = node.previousSibling;\n      while (prev && isIgnorable(prev)) {\n        moveNode = node.parentNode;\n        moveOffset = domIndex(prev);\n        prev = prev.previousSibling;\n      }\n      if (!prev) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = 0;\n      } else {\n        node = prev;\n        offset = nodeLen(node);\n      }\n    }\n  }\n  if (force) { setSelFocus(view, sel, node, offset); }\n  else if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\n// Make sure the cursor isn't directly before one or more ignored\n// nodes.\nfunction skipIgnoredNodesRight(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var len = nodeLen(node);\n  var moveNode, moveOffset;\n  for (;;) {\n    if (offset < len) {\n      if (node.nodeType != 1) { break }\n      var after = node.childNodes[offset];\n      if (isIgnorable(after)) {\n        moveNode = node;\n        moveOffset = ++offset;\n      }\n      else { break }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var next = node.nextSibling;\n      while (next && isIgnorable(next)) {\n        moveNode = next.parentNode;\n        moveOffset = domIndex(next) + 1;\n        next = next.nextSibling;\n      }\n      if (!next) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = len = 0;\n      } else {\n        node = next;\n        offset = 0;\n        len = nodeLen(node);\n      }\n    }\n  }\n  if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\nfunction isBlockNode(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.node && desc.node.isBlock\n}\n\nfunction setSelFocus(view, sel, node, offset) {\n  if (selectionCollapsed(sel)) {\n    var range = document.createRange();\n    range.setEnd(node, offset);\n    range.setStart(node, offset);\n    sel.removeAllRanges();\n    sel.addRange(range);\n  } else if (sel.extend) {\n    sel.extend(node, offset);\n  }\n  view.domObserver.setCurSelection();\n  var state = view.state;\n  // If no state update ends up happening, reset the selection.\n  setTimeout(function () {\n    if (view.state == state) { selectionToDOM(view); }\n  }, 50);\n}\n\n// : (EditorState, number)\n// Check whether vertical selection motion would involve node\n// selections. If so, apply it (if not, the result is left to the\n// browser)\nfunction selectVertically(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection && !sel.empty || mods.indexOf(\"s\") > -1) { return false }\n  if (result.mac && mods.indexOf(\"m\") > -1) { return false }\n  var $from = sel.$from;\n  var $to = sel.$to;\n\n  if (!$from.parent.inlineContent || view.endOfTextblock(dir < 0 ? \"up\" : \"down\")) {\n    var next = moveSelectionBlock(view.state, dir);\n    if (next && (next instanceof NodeSelection))\n      { return apply(view, next) }\n  }\n  if (!$from.parent.inlineContent) {\n    var beyond = Selection.findFrom(dir < 0 ? $from : $to, dir);\n    return beyond ? apply(view, beyond) : true\n  }\n  return false\n}\n\nfunction stopNativeHorizontalDelete(view, dir) {\n  if (!(view.state.selection instanceof TextSelection)) { return true }\n  var ref = view.state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  var empty = ref.empty;\n  if (!$head.sameParent($anchor)) { return true }\n  if (!empty) { return false }\n  if (view.endOfTextblock(dir > 0 ? \"forward\" : \"backward\")) { return true }\n  var nextNode = !$head.textOffset && (dir < 0 ? $head.nodeBefore : $head.nodeAfter);\n  if (nextNode && !nextNode.isText) {\n    var tr = view.state.tr;\n    if (dir < 0) { tr.delete($head.pos - nextNode.nodeSize, $head.pos); }\n    else { tr.delete($head.pos, $head.pos + nextNode.nodeSize); }\n    view.dispatch(tr);\n    return true\n  }\n  return false\n}\n\nfunction switchEditable(view, node, state) {\n  view.domObserver.stop();\n  node.contentEditable = state;\n  view.domObserver.start();\n}\n\n// Issue #867 / #1090 / https://bugs.chromium.org/p/chromium/issues/detail?id=903821\n// In which Safari (and at some point in the past, Chrome) does really\n// wrong things when the down arrow is pressed when the cursor is\n// directly at the start of a textblock and has an uneditable node\n// after it\nfunction safariDownArrowBug(view) {\n  if (!result.safari || view.state.selection.$head.parentOffset > 0) { return }\n  var ref = view.root.getSelection();\n  var focusNode = ref.focusNode;\n  var focusOffset = ref.focusOffset;\n  if (focusNode && focusNode.nodeType == 1 && focusOffset == 0 &&\n      focusNode.firstChild && focusNode.firstChild.contentEditable == \"false\") {\n    var child = focusNode.firstChild;\n    switchEditable(view, child, true);\n    setTimeout(function () { return switchEditable(view, child, false); }, 20);\n  }\n}\n\n// A backdrop key mapping used to make sure we always suppress keys\n// that have a dangerous default effect, even if the commands they are\n// bound to return false, and to make sure that cursor-motion keys\n// find a cursor (as opposed to a node selection) when pressed. For\n// cursor-motion keys, the code in the handlers also takes care of\n// block selections.\n\nfunction getMods(event) {\n  var result = \"\";\n  if (event.ctrlKey) { result += \"c\"; }\n  if (event.metaKey) { result += \"m\"; }\n  if (event.altKey) { result += \"a\"; }\n  if (event.shiftKey) { result += \"s\"; }\n  return result\n}\n\nfunction captureKeyDown(view, event) {\n  var code = event.keyCode, mods = getMods(event);\n  if (code == 8 || (result.mac && code == 72 && mods == \"c\")) { // Backspace, Ctrl-h on Mac\n    return stopNativeHorizontalDelete(view, -1) || skipIgnoredNodesLeft(view)\n  } else if (code == 46 || (result.mac && code == 68 && mods == \"c\")) { // Delete, Ctrl-d on Mac\n    return stopNativeHorizontalDelete(view, 1) || skipIgnoredNodesRight(view)\n  } else if (code == 13 || code == 27) { // Enter, Esc\n    return true\n  } else if (code == 37) { // Left arrow\n    return selectHorizontally(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 39) { // Right arrow\n    return selectHorizontally(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (code == 38) { // Up arrow\n    return selectVertically(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 40) { // Down arrow\n    return safariDownArrowBug(view) || selectVertically(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (mods == (result.mac ? \"m\" : \"c\") &&\n             (code == 66 || code == 73 || code == 89 || code == 90)) { // Mod-[biyz]\n    return true\n  }\n  return false\n}\n\n// Note that all referencing and parsing is done with the\n// start-of-operation selection and document, since that's the one\n// that the DOM represents. If any changes came in in the meantime,\n// the modification is mapped over those before it is applied, in\n// readDOMChange.\n\nfunction parseBetween(view, from_, to_) {\n  var ref = view.docView.parseRange(from_, to_);\n  var parent = ref.node;\n  var fromOffset = ref.fromOffset;\n  var toOffset = ref.toOffset;\n  var from = ref.from;\n  var to = ref.to;\n\n  var domSel = view.root.getSelection(), find = null, anchor = domSel.anchorNode;\n  if (anchor && view.dom.contains(anchor.nodeType == 1 ? anchor : anchor.parentNode)) {\n    find = [{node: anchor, offset: domSel.anchorOffset}];\n    if (!selectionCollapsed(domSel))\n      { find.push({node: domSel.focusNode, offset: domSel.focusOffset}); }\n  }\n  // Work around issue in Chrome where backspacing sometimes replaces\n  // the deleted content with a random BR node (issues #799, #831)\n  if (result.chrome && view.lastKeyCode === 8) {\n    for (var off = toOffset; off > fromOffset; off--) {\n      var node = parent.childNodes[off - 1], desc = node.pmViewDesc;\n      if (node.nodeType == \"BR\" && !desc) { toOffset = off; break }\n      if (!desc || desc.size) { break }\n    }\n  }\n  var startDoc = view.state.doc;\n  var parser = view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n  var $from = startDoc.resolve(from);\n\n  var sel = null, doc = parser.parse(parent, {\n    topNode: $from.parent,\n    topMatch: $from.parent.contentMatchAt($from.index()),\n    topOpen: true,\n    from: fromOffset,\n    to: toOffset,\n    preserveWhitespace: $from.parent.type.spec.code ? \"full\" : true,\n    editableContent: true,\n    findPositions: find,\n    ruleFromNode: ruleFromNode,\n    context: $from\n  });\n  if (find && find[0].pos != null) {\n    var anchor$1 = find[0].pos, head = find[1] && find[1].pos;\n    if (head == null) { head = anchor$1; }\n    sel = {anchor: anchor$1 + from, head: head + from};\n  }\n  return {doc: doc, sel: sel, from: from, to: to}\n}\n\nfunction ruleFromNode(dom) {\n  var desc = dom.pmViewDesc;\n  if (desc) {\n    return desc.parseRule()\n  } else if (dom.nodeName == \"BR\" && dom.parentNode) {\n    // Safari replaces the list item or table cell with a BR\n    // directly in the list node (?!) if you delete the last\n    // character in a list item or table cell (#708, #862)\n    if (result.safari && /^(ul|ol)$/i.test(dom.parentNode.nodeName)) {\n      var skip = document.createElement(\"div\");\n      skip.appendChild(document.createElement(\"li\"));\n      return {skip: skip}\n    } else if (dom.parentNode.lastChild == dom || result.safari && /^(tr|table)$/i.test(dom.parentNode.nodeName)) {\n      return {ignore: true}\n    }\n  } else if (dom.nodeName == \"IMG\" && dom.getAttribute(\"mark-placeholder\")) {\n    return {ignore: true}\n  }\n}\n\nfunction readDOMChange(view, from, to, typeOver, addedNodes) {\n  if (from < 0) {\n    var origin = view.lastSelectionTime > Date.now() - 50 ? view.lastSelectionOrigin : null;\n    var newSel = selectionFromDOM(view, origin);\n    if (newSel && !view.state.selection.eq(newSel)) {\n      var tr$1 = view.state.tr.setSelection(newSel);\n      if (origin == \"pointer\") { tr$1.setMeta(\"pointer\", true); }\n      else if (origin == \"key\") { tr$1.scrollIntoView(); }\n      view.dispatch(tr$1);\n    }\n    return\n  }\n\n  var $before = view.state.doc.resolve(from);\n  var shared = $before.sharedDepth(to);\n  from = $before.before(shared + 1);\n  to = view.state.doc.resolve(to).after(shared + 1);\n\n  var sel = view.state.selection;\n  var parse = parseBetween(view, from, to);\n  // Chrome sometimes leaves the cursor before the inserted text when\n  // composing after a cursor wrapper. This moves it forward.\n  if (result.chrome && view.cursorWrapper && parse.sel && parse.sel.anchor == view.cursorWrapper.deco.from) {\n    var text = view.cursorWrapper.deco.type.toDOM.nextSibling;\n    var size = text && text.nodeValue ? text.nodeValue.length : 1;\n    parse.sel = {anchor: parse.sel.anchor + size, head: parse.sel.anchor + size};\n  }\n\n  var doc = view.state.doc, compare = doc.slice(parse.from, parse.to);\n  var preferredPos, preferredSide;\n  // Prefer anchoring to end when Backspace is pressed\n  if (view.lastKeyCode === 8 && Date.now() - 100 < view.lastKeyCodeTime) {\n    preferredPos = view.state.selection.to;\n    preferredSide = \"end\";\n  } else {\n    preferredPos = view.state.selection.from;\n    preferredSide = \"start\";\n  }\n  view.lastKeyCode = null;\n\n  var change = findDiff(compare.content, parse.doc.content, parse.from, preferredPos, preferredSide);\n  if (!change) {\n    if (typeOver && sel instanceof TextSelection && !sel.empty && sel.$head.sameParent(sel.$anchor) &&\n        !view.composing && !(parse.sel && parse.sel.anchor != parse.sel.head)) {\n      change = {start: sel.from, endA: sel.to, endB: sel.to};\n    } else if (result.ios && view.lastIOSEnter > Date.now() - 225 &&\n               addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }) &&\n               view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n      view.lastIOSEnter = 0;\n      return\n    } else {\n      if (parse.sel) {\n        var sel$1 = resolveSelection(view, view.state.doc, parse.sel);\n        if (sel$1 && !sel$1.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel$1)); }\n      }\n      return\n    }\n  }\n  view.domChangeCount++;\n  // Handle the case where overwriting a selection by typing matches\n  // the start or end of the selected content, creating a change\n  // that's smaller than what was actually overwritten.\n  if (view.state.selection.from < view.state.selection.to &&\n      change.start == change.endB &&\n      view.state.selection instanceof TextSelection) {\n    if (change.start > view.state.selection.from && change.start <= view.state.selection.from + 2) {\n      change.start = view.state.selection.from;\n    } else if (change.endA < view.state.selection.to && change.endA >= view.state.selection.to - 2) {\n      change.endB += (view.state.selection.to - change.endA);\n      change.endA = view.state.selection.to;\n    }\n  }\n\n  // IE11 will insert a non-breaking space _ahead_ of the space after\n  // the cursor space when adding a space before another space. When\n  // that happened, adjust the change to cover the space instead.\n  if (result.ie && result.ie_version <= 11 && change.endB == change.start + 1 &&\n      change.endA == change.start && change.start > parse.from &&\n      parse.doc.textBetween(change.start - parse.from - 1, change.start - parse.from + 1) == \" \\u00a0\") {\n    change.start--;\n    change.endA--;\n    change.endB--;\n  }\n\n  var $from = parse.doc.resolveNoCache(change.start - parse.from);\n  var $to = parse.doc.resolveNoCache(change.endB - parse.from);\n  var inlineChange = $from.sameParent($to) && $from.parent.inlineContent;\n  var nextSel;\n  // If this looks like the effect of pressing Enter (or was recorded\n  // as being an iOS enter press), just dispatch an Enter key instead.\n  if (((result.ios && view.lastIOSEnter > Date.now() - 225 &&\n        (!inlineChange || addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }))) ||\n       (!inlineChange && $from.pos < parse.doc.content.size &&\n        (nextSel = Selection.findFrom(parse.doc.resolve($from.pos + 1), 1, true)) &&\n        nextSel.head == $to.pos)) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n    view.lastIOSEnter = 0;\n    return\n  }\n  // Same for backspace\n  if (view.state.selection.anchor > change.start &&\n      looksLikeJoin(doc, change.start, change.endA, $from, $to) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) {\n    if (result.android && result.chrome) { view.domObserver.suppressSelectionUpdates(); } // #820\n    return\n  }\n\n  // This tries to detect Android virtual keyboard\n  // enter-and-pick-suggestion action. That sometimes (see issue\n  // #1059) first fires a DOM mutation, before moving the selection to\n  // the newly created block. And then, because ProseMirror cleans up\n  // the DOM selection, it gives up moving the selection entirely,\n  // leaving the cursor in the wrong place. When that happens, we drop\n  // the new paragraph from the initial change, and fire a simulated\n  // enter key afterwards.\n  if (result.android && !inlineChange && $from.start() != $to.start() && $to.parentOffset == 0 && $from.depth == $to.depth &&\n      parse.sel && parse.sel.anchor == parse.sel.head && parse.sel.head == change.endA) {\n    change.endB -= 2;\n    $to = parse.doc.resolveNoCache(change.endB - parse.from);\n    setTimeout(function () {\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n    }, 20);\n  }\n\n  var chFrom = change.start, chTo = change.endA;\n\n  var tr, storedMarks, markChange, $from1;\n  if (inlineChange) {\n    if ($from.pos == $to.pos) { // Deletion\n      // IE11 sometimes weirdly moves the DOM selection around after\n      // backspacing out the first element in a textblock\n      if (result.ie && result.ie_version <= 11 && $from.parentOffset == 0) {\n        view.domObserver.suppressSelectionUpdates();\n        setTimeout(function () { return selectionToDOM(view); }, 20);\n      }\n      tr = view.state.tr.delete(chFrom, chTo);\n      storedMarks = doc.resolve(change.start).marksAcross(doc.resolve(change.endA));\n    } else if ( // Adding or removing a mark\n      change.endA == change.endB && ($from1 = doc.resolve(change.start)) &&\n      (markChange = isMarkChange($from.parent.content.cut($from.parentOffset, $to.parentOffset),\n                                 $from1.parent.content.cut($from1.parentOffset, change.endA - $from1.start())))\n    ) {\n      tr = view.state.tr;\n      if (markChange.type == \"add\") { tr.addMark(chFrom, chTo, markChange.mark); }\n      else { tr.removeMark(chFrom, chTo, markChange.mark); }\n    } else if ($from.parent.child($from.index()).isText && $from.index() == $to.index() - ($to.textOffset ? 0 : 1)) {\n      // Both positions in the same text node -- simply insert text\n      var text$1 = $from.parent.textBetween($from.parentOffset, $to.parentOffset);\n      if (view.someProp(\"handleTextInput\", function (f) { return f(view, chFrom, chTo, text$1); })) { return }\n      tr = view.state.tr.insertText(text$1, chFrom, chTo);\n    }\n  }\n\n  if (!tr)\n    { tr = view.state.tr.replace(chFrom, chTo, parse.doc.slice(change.start - parse.from, change.endB - parse.from)); }\n  if (parse.sel) {\n    var sel$2 = resolveSelection(view, tr.doc, parse.sel);\n    // Chrome Android will sometimes, during composition, report the\n    // selection in the wrong place. If it looks like that is\n    // happening, don't update the selection.\n    // Edge just doesn't move the cursor forward when you start typing\n    // in an empty block or between br nodes.\n    if (sel$2 && !(result.chrome && result.android && view.composing && sel$2.empty &&\n                   (sel$2.head == chFrom || sel$2.head == tr.mapping.map(chTo) - 1) ||\n                 result.ie && sel$2.empty && sel$2.head == chFrom))\n      { tr.setSelection(sel$2); }\n  }\n  if (storedMarks) { tr.ensureMarks(storedMarks); }\n  view.dispatch(tr.scrollIntoView());\n}\n\nfunction resolveSelection(view, doc, parsedSel) {\n  if (Math.max(parsedSel.anchor, parsedSel.head) > doc.content.size) { return null }\n  return selectionBetween(view, doc.resolve(parsedSel.anchor), doc.resolve(parsedSel.head))\n}\n\n// : (Fragment, Fragment) → ?{mark: Mark, type: string}\n// Given two same-length, non-empty fragments of inline content,\n// determine whether the first could be created from the second by\n// removing or adding a single mark type.\nfunction isMarkChange(cur, prev) {\n  var curMarks = cur.firstChild.marks, prevMarks = prev.firstChild.marks;\n  var added = curMarks, removed = prevMarks, type, mark, update;\n  for (var i = 0; i < prevMarks.length; i++) { added = prevMarks[i].removeFromSet(added); }\n  for (var i$1 = 0; i$1 < curMarks.length; i$1++) { removed = curMarks[i$1].removeFromSet(removed); }\n  if (added.length == 1 && removed.length == 0) {\n    mark = added[0];\n    type = \"add\";\n    update = function (node) { return node.mark(mark.addToSet(node.marks)); };\n  } else if (added.length == 0 && removed.length == 1) {\n    mark = removed[0];\n    type = \"remove\";\n    update = function (node) { return node.mark(mark.removeFromSet(node.marks)); };\n  } else {\n    return null\n  }\n  var updated = [];\n  for (var i$2 = 0; i$2 < prev.childCount; i$2++) { updated.push(update(prev.child(i$2))); }\n  if (Fragment.from(updated).eq(cur)) { return {mark: mark, type: type} }\n}\n\nfunction looksLikeJoin(old, start, end, $newStart, $newEnd) {\n  if (!$newStart.parent.isTextblock ||\n      // The content must have shrunk\n      end - start <= $newEnd.pos - $newStart.pos ||\n      // newEnd must point directly at or after the end of the block that newStart points into\n      skipClosingAndOpening($newStart, true, false) < $newEnd.pos)\n    { return false }\n\n  var $start = old.resolve(start);\n  // Start must be at the end of a block\n  if ($start.parentOffset < $start.parent.content.size || !$start.parent.isTextblock)\n    { return false }\n  var $next = old.resolve(skipClosingAndOpening($start, true, true));\n  // The next textblock must start before end and end near it\n  if (!$next.parent.isTextblock || $next.pos > end ||\n      skipClosingAndOpening($next, true, false) < end)\n    { return false }\n\n  // The fragments after the join point must match\n  return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)\n}\n\nfunction skipClosingAndOpening($pos, fromEnd, mayOpen) {\n  var depth = $pos.depth, end = fromEnd ? $pos.end() : $pos.pos;\n  while (depth > 0 && (fromEnd || $pos.indexAfter(depth) == $pos.node(depth).childCount)) {\n    depth--;\n    end++;\n    fromEnd = false;\n  }\n  if (mayOpen) {\n    var next = $pos.node(depth).maybeChild($pos.indexAfter(depth));\n    while (next && !next.isLeaf) {\n      next = next.firstChild;\n      end++;\n    }\n  }\n  return end\n}\n\nfunction findDiff(a, b, pos, preferredPos, preferredSide) {\n  var start = a.findDiffStart(b, pos);\n  if (start == null) { return null }\n  var ref = a.findDiffEnd(b, pos + a.size, pos + b.size);\n  var endA = ref.a;\n  var endB = ref.b;\n  if (preferredSide == \"end\") {\n    var adjust = Math.max(0, start - Math.min(endA, endB));\n    preferredPos -= endA + adjust - start;\n  }\n  if (endA < start && a.size < b.size) {\n    var move = preferredPos <= start && preferredPos >= endA ? start - preferredPos : 0;\n    start -= move;\n    endB = start + (endB - endA);\n    endA = start;\n  } else if (endB < start) {\n    var move$1 = preferredPos <= start && preferredPos >= endB ? start - preferredPos : 0;\n    start -= move$1;\n    endA = start + (endA - endB);\n    endB = start;\n  }\n  return {start: start, endA: endA, endB: endB}\n}\n\nfunction serializeForClipboard(view, slice) {\n  var context = [];\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  while (openStart > 1 && openEnd > 1 && content.childCount == 1 && content.firstChild.childCount == 1) {\n    openStart--;\n    openEnd--;\n    var node = content.firstChild;\n    context.push(node.type.name, node.attrs != node.type.defaultAttrs ? node.attrs : null);\n    content = node.content;\n  }\n\n  var serializer = view.someProp(\"clipboardSerializer\") || DOMSerializer.fromSchema(view.state.schema);\n  var doc = detachedDoc(), wrap = doc.createElement(\"div\");\n  wrap.appendChild(serializer.serializeFragment(content, {document: doc}));\n\n  var firstChild = wrap.firstChild, needsWrap;\n  while (firstChild && firstChild.nodeType == 1 && (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])) {\n    for (var i = needsWrap.length - 1; i >= 0; i--) {\n      var wrapper = doc.createElement(needsWrap[i]);\n      while (wrap.firstChild) { wrapper.appendChild(wrap.firstChild); }\n      wrap.appendChild(wrapper);\n    }\n    firstChild = wrap.firstChild;\n  }\n\n  if (firstChild && firstChild.nodeType == 1)\n    { firstChild.setAttribute(\"data-pm-slice\", (openStart + \" \" + openEnd + \" \" + (JSON.stringify(context)))); }\n\n  var text = view.someProp(\"clipboardTextSerializer\", function (f) { return f(slice); }) ||\n      slice.content.textBetween(0, slice.content.size, \"\\n\\n\");\n\n  return {dom: wrap, text: text}\n}\n\n// : (EditorView, string, string, ?bool, ResolvedPos) → ?Slice\n// Read a slice of content from the clipboard (or drop data).\nfunction parseFromClipboard(view, text, html, plainText, $context) {\n  var dom, inCode = $context.parent.type.spec.code, slice;\n  if (!html && !text) { return null }\n  var asText = text && (plainText || inCode || !html);\n  if (asText) {\n    view.someProp(\"transformPastedText\", function (f) { text = f(text, inCode || plainText); });\n    if (inCode) { return new Slice(Fragment.from(view.state.schema.text(text)), 0, 0) }\n    var parsed = view.someProp(\"clipboardTextParser\", function (f) { return f(text, $context, plainText); });\n    if (parsed) {\n      slice = parsed;\n    } else {\n      dom = document.createElement(\"div\");\n      text.trim().split(/(?:\\r\\n?|\\n)+/).forEach(function (block) {\n        dom.appendChild(document.createElement(\"p\")).textContent = block;\n      });\n    }\n  } else {\n    view.someProp(\"transformPastedHTML\", function (f) { html = f(html); });\n    dom = readHTML(html);\n  }\n\n  var contextNode = dom && dom.querySelector(\"[data-pm-slice]\");\n  var sliceData = contextNode && /^(\\d+) (\\d+) (.*)/.exec(contextNode.getAttribute(\"data-pm-slice\"));\n  if (!slice) {\n    var parser = view.someProp(\"clipboardParser\") || view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n    slice = parser.parseSlice(dom, {preserveWhitespace: !!(asText || sliceData), context: $context});\n  }\n  if (sliceData)\n    { slice = addContext(closeSlice(slice, +sliceData[1], +sliceData[2]), sliceData[3]); }\n  else // HTML wasn't created by ProseMirror. Make sure top-level siblings are coherent\n    { slice = Slice.maxOpen(normalizeSiblings(slice.content, $context), false); }\n\n  view.someProp(\"transformPasted\", function (f) { slice = f(slice); });\n  return slice\n}\n\n// Takes a slice parsed with parseSlice, which means there hasn't been\n// any content-expression checking done on the top nodes, tries to\n// find a parent node in the current context that might fit the nodes,\n// and if successful, rebuilds the slice so that it fits into that parent.\n//\n// This addresses the problem that Transform.replace expects a\n// coherent slice, and will fail to place a set of siblings that don't\n// fit anywhere in the schema.\nfunction normalizeSiblings(fragment, $context) {\n  if (fragment.childCount < 2) { return fragment }\n  var loop = function ( d ) {\n    var parent = $context.node(d);\n    var match = parent.contentMatchAt($context.index(d));\n    var lastWrap = (void 0), result = [];\n    fragment.forEach(function (node) {\n      if (!result) { return }\n      var wrap = match.findWrapping(node.type), inLast;\n      if (!wrap) { return result = null }\n      if (inLast = result.length && lastWrap.length && addToSibling(wrap, lastWrap, node, result[result.length - 1], 0)) {\n        result[result.length - 1] = inLast;\n      } else {\n        if (result.length) { result[result.length - 1] = closeRight(result[result.length - 1], lastWrap.length); }\n        var wrapped = withWrappers(node, wrap);\n        result.push(wrapped);\n        match = match.matchType(wrapped.type, wrapped.attrs);\n        lastWrap = wrap;\n      }\n    });\n    if (result) { return { v: Fragment.from(result) } }\n  };\n\n  for (var d = $context.depth; d >= 0; d--) {\n    var returned = loop( d );\n\n    if ( returned ) return returned.v;\n  }\n  return fragment\n}\n\nfunction withWrappers(node, wrap, from) {\n  if ( from === void 0 ) from = 0;\n\n  for (var i = wrap.length - 1; i >= from; i--)\n    { node = wrap[i].create(null, Fragment.from(node)); }\n  return node\n}\n\n// Used to group adjacent nodes wrapped in similar parents by\n// normalizeSiblings into the same parent node\nfunction addToSibling(wrap, lastWrap, node, sibling, depth) {\n  if (depth < wrap.length && depth < lastWrap.length && wrap[depth] == lastWrap[depth]) {\n    var inner = addToSibling(wrap, lastWrap, node, sibling.lastChild, depth + 1);\n    if (inner) { return sibling.copy(sibling.content.replaceChild(sibling.childCount - 1, inner)) }\n    var match = sibling.contentMatchAt(sibling.childCount);\n    if (match.matchType(depth == wrap.length - 1 ? node.type : wrap[depth + 1]))\n      { return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node, wrap, depth + 1)))) }\n  }\n}\n\nfunction closeRight(node, depth) {\n  if (depth == 0) { return node }\n  var fragment = node.content.replaceChild(node.childCount - 1, closeRight(node.lastChild, depth - 1));\n  var fill = node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true);\n  return node.copy(fragment.append(fill))\n}\n\nfunction closeRange(fragment, side, from, to, depth, openEnd) {\n  var node = side < 0 ? fragment.firstChild : fragment.lastChild, inner = node.content;\n  if (depth < to - 1) { inner = closeRange(inner, side, from, to, depth + 1, openEnd); }\n  if (depth >= from)\n    { inner = side < 0 ? node.contentMatchAt(0).fillBefore(inner, fragment.childCount > 1 || openEnd <= depth).append(inner)\n      : inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true)); }\n  return fragment.replaceChild(side < 0 ? 0 : fragment.childCount - 1, node.copy(inner))\n}\n\nfunction closeSlice(slice, openStart, openEnd) {\n  if (openStart < slice.openStart)\n    { slice = new Slice(closeRange(slice.content, -1, openStart, slice.openStart, 0, slice.openEnd), openStart, slice.openEnd); }\n  if (openEnd < slice.openEnd)\n    { slice = new Slice(closeRange(slice.content, 1, openEnd, slice.openEnd, 0, 0), slice.openStart, openEnd); }\n  return slice\n}\n\n// Trick from jQuery -- some elements must be wrapped in other\n// elements for innerHTML to work. I.e. if you do `div.innerHTML =\n// \"<td>..</td>\"` the table cells are ignored.\nvar wrapMap = {\n  thead: [\"table\"],\n  tbody: [\"table\"],\n  tfoot: [\"table\"],\n  caption: [\"table\"],\n  colgroup: [\"table\"],\n  col: [\"table\", \"colgroup\"],\n  tr: [\"table\", \"tbody\"],\n  td: [\"table\", \"tbody\", \"tr\"],\n  th: [\"table\", \"tbody\", \"tr\"]\n};\n\nvar _detachedDoc = null;\nfunction detachedDoc() {\n  return _detachedDoc || (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n}\n\nfunction readHTML(html) {\n  var metas = /(\\s*<meta [^>]*>)*/.exec(html);\n  if (metas) { html = html.slice(metas[0].length); }\n  var elt = detachedDoc().createElement(\"div\");\n  var firstTag = /(?:<meta [^>]*>)*<([a-z][^>\\s]+)/i.exec(html), wrap, depth = 0;\n  if (wrap = firstTag && wrapMap[firstTag[1].toLowerCase()]) {\n    html = wrap.map(function (n) { return \"<\" + n + \">\"; }).join(\"\") + html + wrap.map(function (n) { return \"</\" + n + \">\"; }).reverse().join(\"\");\n    depth = wrap.length;\n  }\n  elt.innerHTML = html;\n  for (var i = 0; i < depth; i++) { elt = elt.firstChild; }\n  return elt\n}\n\nfunction addContext(slice, context) {\n  if (!slice.size) { return slice }\n  var schema = slice.content.firstChild.type.schema, array;\n  try { array = JSON.parse(context); }\n  catch(e) { return slice }\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  for (var i = array.length - 2; i >= 0; i -= 2) {\n    var type = schema.nodes[array[i]];\n    if (!type || type.hasRequiredAttrs()) { break }\n    content = Fragment.from(type.create(array[i + 1], content));\n    openStart++; openEnd++;\n  }\n  return new Slice(content, openStart, openEnd)\n}\n\nvar observeOptions = {\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  attributes: true,\n  attributeOldValue: true,\n  subtree: true\n};\n// IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\nvar useCharData = result.ie && result.ie_version <= 11;\n\nvar SelectionState = function SelectionState() {\n  this.anchorNode = this.anchorOffset = this.focusNode = this.focusOffset = null;\n};\n\nSelectionState.prototype.set = function set (sel) {\n  this.anchorNode = sel.anchorNode; this.anchorOffset = sel.anchorOffset;\n  this.focusNode = sel.focusNode; this.focusOffset = sel.focusOffset;\n};\n\nSelectionState.prototype.eq = function eq (sel) {\n  return sel.anchorNode == this.anchorNode && sel.anchorOffset == this.anchorOffset &&\n    sel.focusNode == this.focusNode && sel.focusOffset == this.focusOffset\n};\n\nvar DOMObserver = function DOMObserver(view, handleDOMChange) {\n  var this$1 = this;\n\n  this.view = view;\n  this.handleDOMChange = handleDOMChange;\n  this.queue = [];\n  this.flushingSoon = -1;\n  this.observer = window.MutationObserver &&\n    new window.MutationObserver(function (mutations) {\n      for (var i = 0; i < mutations.length; i++) { this$1.queue.push(mutations[i]); }\n      // IE11 will sometimes (on backspacing out a single character\n      // text node after a BR node) call the observer callback\n      // before actually updating the DOM, which will cause\n      // ProseMirror to miss the change (see #930)\n      if (result.ie && result.ie_version <= 11 && mutations.some(\n        function (m) { return m.type == \"childList\" && m.removedNodes.length ||\n             m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length; }))\n        { this$1.flushSoon(); }\n      else\n        { this$1.flush(); }\n    });\n  this.currentSelection = new SelectionState;\n  if (useCharData) {\n    this.onCharData = function (e) {\n      this$1.queue.push({target: e.target, type: \"characterData\", oldValue: e.prevValue});\n      this$1.flushSoon();\n    };\n  }\n  this.onSelectionChange = this.onSelectionChange.bind(this);\n  this.suppressingSelectionUpdates = false;\n};\n\nDOMObserver.prototype.flushSoon = function flushSoon () {\n    var this$1 = this;\n\n  if (this.flushingSoon < 0)\n    { this.flushingSoon = window.setTimeout(function () { this$1.flushingSoon = -1; this$1.flush(); }, 20); }\n};\n\nDOMObserver.prototype.forceFlush = function forceFlush () {\n  if (this.flushingSoon > -1) {\n    window.clearTimeout(this.flushingSoon);\n    this.flushingSoon = -1;\n    this.flush();\n  }\n};\n\nDOMObserver.prototype.start = function start () {\n  if (this.observer)\n    { this.observer.observe(this.view.dom, observeOptions); }\n  if (useCharData)\n    { this.view.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.connectSelection();\n};\n\nDOMObserver.prototype.stop = function stop () {\n    var this$1 = this;\n\n  if (this.observer) {\n    var take = this.observer.takeRecords();\n    if (take.length) {\n      for (var i = 0; i < take.length; i++) { this.queue.push(take[i]); }\n      window.setTimeout(function () { return this$1.flush(); }, 20);\n    }\n    this.observer.disconnect();\n  }\n  if (useCharData) { this.view.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.disconnectSelection();\n};\n\nDOMObserver.prototype.connectSelection = function connectSelection () {\n  this.view.dom.ownerDocument.addEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.disconnectSelection = function disconnectSelection () {\n  this.view.dom.ownerDocument.removeEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.suppressSelectionUpdates = function suppressSelectionUpdates () {\n    var this$1 = this;\n\n  this.suppressingSelectionUpdates = true;\n  setTimeout(function () { return this$1.suppressingSelectionUpdates = false; }, 50);\n};\n\nDOMObserver.prototype.onSelectionChange = function onSelectionChange () {\n  if (!hasFocusAndSelection(this.view)) { return }\n  if (this.suppressingSelectionUpdates) { return selectionToDOM(this.view) }\n  // Deletions on IE11 fire their events in the wrong order, giving\n  // us a selection change event before the DOM changes are\n  // reported.\n  if (result.ie && result.ie_version <= 11 && !this.view.state.selection.empty) {\n    var sel = this.view.root.getSelection();\n    // Selection.isCollapsed isn't reliable on IE\n    if (sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n      { return this.flushSoon() }\n  }\n  this.flush();\n};\n\nDOMObserver.prototype.setCurSelection = function setCurSelection () {\n  this.currentSelection.set(this.view.root.getSelection());\n};\n\nDOMObserver.prototype.ignoreSelectionChange = function ignoreSelectionChange (sel) {\n  if (sel.rangeCount == 0) { return true }\n  var container = sel.getRangeAt(0).commonAncestorContainer;\n  var desc = this.view.docView.nearestDesc(container);\n  if (desc && desc.ignoreMutation({type: \"selection\", target: container.nodeType == 3 ? container.parentNode : container})) {\n    this.setCurSelection();\n    return true\n  }\n};\n\nDOMObserver.prototype.flush = function flush () {\n  if (!this.view.docView || this.flushingSoon > -1) { return }\n  var mutations = this.observer ? this.observer.takeRecords() : [];\n  if (this.queue.length) {\n    mutations = this.queue.concat(mutations);\n    this.queue.length = 0;\n  }\n\n  var sel = this.view.root.getSelection();\n  var newSel = !this.suppressingSelectionUpdates && !this.currentSelection.eq(sel) && hasSelection(this.view) && !this.ignoreSelectionChange(sel);\n\n  var from = -1, to = -1, typeOver = false, added = [];\n  if (this.view.editable) {\n    for (var i = 0; i < mutations.length; i++) {\n      var result$1 = this.registerMutation(mutations[i], added);\n      if (result$1) {\n        from = from < 0 ? result$1.from : Math.min(result$1.from, from);\n        to = to < 0 ? result$1.to : Math.max(result$1.to, to);\n        if (result$1.typeOver) { typeOver = true; }\n      }\n    }\n  }\n\n  if (result.gecko && added.length > 1) {\n    var brs = added.filter(function (n) { return n.nodeName == \"BR\"; });\n    if (brs.length == 2) {\n      var a = brs[0];\n        var b = brs[1];\n      if (a.parentNode && a.parentNode.parentNode == b.parentNode) { b.remove(); }\n      else { a.remove(); }\n    }\n  }\n\n  if (from > -1 || newSel) {\n    if (from > -1) {\n      this.view.docView.markDirty(from, to);\n      checkCSS(this.view);\n    }\n    this.handleDOMChange(from, to, typeOver, added);\n    if (this.view.docView.dirty) { this.view.updateState(this.view.state); }\n    else if (!this.currentSelection.eq(sel)) { selectionToDOM(this.view); }\n  }\n};\n\nDOMObserver.prototype.registerMutation = function registerMutation (mut, added) {\n  // Ignore mutations inside nodes that were already noted as inserted\n  if (added.indexOf(mut.target) > -1) { return null }\n  var desc = this.view.docView.nearestDesc(mut.target);\n  if (mut.type == \"attributes\" &&\n      (desc == this.view.docView || mut.attributeName == \"contenteditable\" ||\n       // Firefox sometimes fires spurious events for null/empty styles\n       (mut.attributeName == \"style\" && !mut.oldValue && !mut.target.getAttribute(\"style\"))))\n    { return null }\n  if (!desc || desc.ignoreMutation(mut)) { return null }\n\n  if (mut.type == \"childList\") {\n    var prev = mut.previousSibling, next = mut.nextSibling;\n    if (result.ie && result.ie_version <= 11 && mut.addedNodes.length) {\n      // IE11 gives us incorrect next/prev siblings for some\n      // insertions, so if there are added nodes, recompute those\n      for (var i = 0; i < mut.addedNodes.length; i++) {\n        var ref = mut.addedNodes[i];\n          var previousSibling = ref.previousSibling;\n          var nextSibling = ref.nextSibling;\n        if (!previousSibling || Array.prototype.indexOf.call(mut.addedNodes, previousSibling) < 0) { prev = previousSibling; }\n        if (!nextSibling || Array.prototype.indexOf.call(mut.addedNodes, nextSibling) < 0) { next = nextSibling; }\n      }\n    }\n    var fromOffset = prev && prev.parentNode == mut.target\n        ? domIndex(prev) + 1 : 0;\n    var from = desc.localPosFromDOM(mut.target, fromOffset, -1);\n    var toOffset = next && next.parentNode == mut.target\n        ? domIndex(next) : mut.target.childNodes.length;\n    for (var i$1 = 0; i$1 < mut.addedNodes.length; i$1++) { added.push(mut.addedNodes[i$1]); }\n    var to = desc.localPosFromDOM(mut.target, toOffset, 1);\n    return {from: from, to: to}\n  } else if (mut.type == \"attributes\") {\n    return {from: desc.posAtStart - desc.border, to: desc.posAtEnd + desc.border}\n  } else { // \"characterData\"\n    return {\n      from: desc.posAtStart,\n      to: desc.posAtEnd,\n      // An event was generated for a text change that didn't change\n      // any text. Mark the dom change to fall back to assuming the\n      // selection was typed over with an identical value if it can't\n      // find another change.\n      typeOver: mut.target.nodeValue == mut.oldValue\n    }\n  }\n};\n\nvar cssChecked = false;\n\nfunction checkCSS(view) {\n  if (cssChecked) { return }\n  cssChecked = true;\n  if (getComputedStyle(view.dom).whiteSpace == \"normal\")\n    { console[\"warn\"](\"ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.\"); }\n}\n\n// A collection of DOM events that occur within the editor, and callback functions\n// to invoke when the event fires.\nvar handlers = {}, editHandlers = {};\n\nfunction initInput(view) {\n  view.shiftKey = false;\n  view.mouseDown = null;\n  view.lastKeyCode = null;\n  view.lastKeyCodeTime = 0;\n  view.lastClick = {time: 0, x: 0, y: 0, type: \"\"};\n  view.lastSelectionOrigin = null;\n  view.lastSelectionTime = 0;\n\n  view.lastIOSEnter = 0;\n  view.lastIOSEnterFallbackTimeout = null;\n\n  view.composing = false;\n  view.composingTimeout = null;\n  view.compositionNodes = [];\n  view.compositionEndedAt = -2e8;\n\n  view.domObserver = new DOMObserver(view, function (from, to, typeOver, added) { return readDOMChange(view, from, to, typeOver, added); });\n  view.domObserver.start();\n  // Used by hacks like the beforeinput handler to check whether anything happened in the DOM\n  view.domChangeCount = 0;\n\n  view.eventHandlers = Object.create(null);\n  var loop = function ( event ) {\n    var handler = handlers[event];\n    view.dom.addEventListener(event, view.eventHandlers[event] = function (event) {\n      if (eventBelongsToView(view, event) && !runCustomHandler(view, event) &&\n          (view.editable || !(event.type in editHandlers)))\n        { handler(view, event); }\n    });\n  };\n\n  for (var event in handlers) loop( event );\n  // On Safari, for reasons beyond my understanding, adding an input\n  // event handler makes an issue where the composition vanishes when\n  // you press enter go away.\n  if (result.safari) { view.dom.addEventListener(\"input\", function () { return null; }); }\n\n  ensureListeners(view);\n}\n\nfunction setSelectionOrigin(view, origin) {\n  view.lastSelectionOrigin = origin;\n  view.lastSelectionTime = Date.now();\n}\n\nfunction destroyInput(view) {\n  view.domObserver.stop();\n  for (var type in view.eventHandlers)\n    { view.dom.removeEventListener(type, view.eventHandlers[type]); }\n  clearTimeout(view.composingTimeout);\n  clearTimeout(view.lastIOSEnterFallbackTimeout);\n}\n\nfunction ensureListeners(view) {\n  view.someProp(\"handleDOMEvents\", function (currentHandlers) {\n    for (var type in currentHandlers) { if (!view.eventHandlers[type])\n      { view.dom.addEventListener(type, view.eventHandlers[type] = function (event) { return runCustomHandler(view, event); }); } }\n  });\n}\n\nfunction runCustomHandler(view, event) {\n  return view.someProp(\"handleDOMEvents\", function (handlers) {\n    var handler = handlers[event.type];\n    return handler ? handler(view, event) || event.defaultPrevented : false\n  })\n}\n\nfunction eventBelongsToView(view, event) {\n  if (!event.bubbles) { return true }\n  if (event.defaultPrevented) { return false }\n  for (var node = event.target; node != view.dom; node = node.parentNode)\n    { if (!node || node.nodeType == 11 ||\n        (node.pmViewDesc && node.pmViewDesc.stopEvent(event)))\n      { return false } }\n  return true\n}\n\nfunction dispatchEvent(view, event) {\n  if (!runCustomHandler(view, event) && handlers[event.type] &&\n      (view.editable || !(event.type in editHandlers)))\n    { handlers[event.type](view, event); }\n}\n\neditHandlers.keydown = function (view, event) {\n  view.shiftKey = event.keyCode == 16 || event.shiftKey;\n  if (inOrNearComposition(view, event)) { return }\n  view.domObserver.forceFlush();\n  view.lastKeyCode = event.keyCode;\n  view.lastKeyCodeTime = Date.now();\n  // On iOS, if we preventDefault enter key presses, the virtual\n  // keyboard gets confused. So the hack here is to set a flag that\n  // makes the DOM change code recognize that what just happens should\n  // be replaced by whatever the Enter key handlers do.\n  if (result.ios && event.keyCode == 13 && !event.ctrlKey && !event.altKey && !event.metaKey) {\n    var now = Date.now();\n    view.lastIOSEnter = now;\n    view.lastIOSEnterFallbackTimeout = setTimeout(function () {\n      if (view.lastIOSEnter == now) {\n        view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n        view.lastIOSEnter = 0;\n      }\n    }, 200);\n  } else if (view.someProp(\"handleKeyDown\", function (f) { return f(view, event); }) || captureKeyDown(view, event)) {\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(view, \"key\");\n  }\n};\n\neditHandlers.keyup = function (view, e) {\n  if (e.keyCode == 16) { view.shiftKey = false; }\n};\n\neditHandlers.keypress = function (view, event) {\n  if (inOrNearComposition(view, event) || !event.charCode ||\n      event.ctrlKey && !event.altKey || result.mac && event.metaKey) { return }\n\n  if (view.someProp(\"handleKeyPress\", function (f) { return f(view, event); })) {\n    event.preventDefault();\n    return\n  }\n\n  var sel = view.state.selection;\n  if (!(sel instanceof TextSelection) || !sel.$from.sameParent(sel.$to)) {\n    var text = String.fromCharCode(event.charCode);\n    if (!view.someProp(\"handleTextInput\", function (f) { return f(view, sel.$from.pos, sel.$to.pos, text); }))\n      { view.dispatch(view.state.tr.insertText(text).scrollIntoView()); }\n    event.preventDefault();\n  }\n};\n\nfunction eventCoords(event) { return {left: event.clientX, top: event.clientY} }\n\nfunction isNear(event, click) {\n  var dx = click.x - event.clientX, dy = click.y - event.clientY;\n  return dx * dx + dy * dy < 100\n}\n\nfunction runHandlerOnContext(view, propName, pos, inside, event) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside);\n  var loop = function ( i ) {\n    if (view.someProp(propName, function (f) { return i > $pos.depth ? f(view, pos, $pos.nodeAfter, $pos.before(i), event, true)\n                                                    : f(view, pos, $pos.node(i), $pos.before(i), event, false); }))\n      { return { v: true } }\n  };\n\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var returned = loop( i );\n\n    if ( returned ) return returned.v;\n  }\n  return false\n}\n\nfunction updateSelection(view, selection, origin) {\n  if (!view.focused) { view.focus(); }\n  var tr = view.state.tr.setSelection(selection);\n  if (origin == \"pointer\") { tr.setMeta(\"pointer\", true); }\n  view.dispatch(tr);\n}\n\nfunction selectClickedLeaf(view, inside) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside), node = $pos.nodeAfter;\n  if (node && node.isAtom && NodeSelection.isSelectable(node)) {\n    updateSelection(view, new NodeSelection($pos), \"pointer\");\n    return true\n  }\n  return false\n}\n\nfunction selectClickedNode(view, inside) {\n  if (inside == -1) { return false }\n  var sel = view.state.selection, selectedNode, selectAt;\n  if (sel instanceof NodeSelection) { selectedNode = sel.node; }\n\n  var $pos = view.state.doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    if (NodeSelection.isSelectable(node)) {\n      if (selectedNode && sel.$from.depth > 0 &&\n          i >= sel.$from.depth && $pos.before(sel.$from.depth + 1) == sel.$from.pos)\n        { selectAt = $pos.before(sel.$from.depth); }\n      else\n        { selectAt = $pos.before(i); }\n      break\n    }\n  }\n\n  if (selectAt != null) {\n    updateSelection(view, NodeSelection.create(view.state.doc, selectAt), \"pointer\");\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction handleSingleClick(view, pos, inside, event, selectNode) {\n  return runHandlerOnContext(view, \"handleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleClick\", function (f) { return f(view, pos, event); }) ||\n    (selectNode ? selectClickedNode(view, inside) : selectClickedLeaf(view, inside))\n}\n\nfunction handleDoubleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleDoubleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleDoubleClick\", function (f) { return f(view, pos, event); })\n}\n\nfunction handleTripleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleTripleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleTripleClick\", function (f) { return f(view, pos, event); }) ||\n    defaultTripleClick(view, inside)\n}\n\nfunction defaultTripleClick(view, inside) {\n  var doc = view.state.doc;\n  if (inside == -1) {\n    if (doc.inlineContent) {\n      updateSelection(view, TextSelection.create(doc, 0, doc.content.size), \"pointer\");\n      return true\n    }\n    return false\n  }\n\n  var $pos = doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    var nodePos = $pos.before(i);\n    if (node.inlineContent)\n      { updateSelection(view, TextSelection.create(doc, nodePos + 1, nodePos + 1 + node.content.size), \"pointer\"); }\n    else if (NodeSelection.isSelectable(node))\n      { updateSelection(view, NodeSelection.create(doc, nodePos), \"pointer\"); }\n    else\n      { continue }\n    return true\n  }\n}\n\nfunction forceDOMFlush(view) {\n  return endComposition(view)\n}\n\nvar selectNodeModifier = result.mac ? \"metaKey\" : \"ctrlKey\";\n\nhandlers.mousedown = function (view, event) {\n  view.shiftKey = event.shiftKey;\n  var flushed = forceDOMFlush(view);\n  var now = Date.now(), type = \"singleClick\";\n  if (now - view.lastClick.time < 500 && isNear(event, view.lastClick) && !event[selectNodeModifier]) {\n    if (view.lastClick.type == \"singleClick\") { type = \"doubleClick\"; }\n    else if (view.lastClick.type == \"doubleClick\") { type = \"tripleClick\"; }\n  }\n  view.lastClick = {time: now, x: event.clientX, y: event.clientY, type: type};\n\n  var pos = view.posAtCoords(eventCoords(event));\n  if (!pos) { return }\n\n  if (type == \"singleClick\")\n    { view.mouseDown = new MouseDown(view, pos, event, flushed); }\n  else if ((type == \"doubleClick\" ? handleDoubleClick : handleTripleClick)(view, pos.pos, pos.inside, event))\n    { event.preventDefault(); }\n  else\n    { setSelectionOrigin(view, \"pointer\"); }\n};\n\nvar MouseDown = function MouseDown(view, pos, event, flushed) {\n  var this$1 = this;\n\n  this.view = view;\n  this.startDoc = view.state.doc;\n  this.pos = pos;\n  this.event = event;\n  this.flushed = flushed;\n  this.selectNode = event[selectNodeModifier];\n  this.allowDefault = event.shiftKey;\n\n  var targetNode, targetPos;\n  if (pos.inside > -1) {\n    targetNode = view.state.doc.nodeAt(pos.inside);\n    targetPos = pos.inside;\n  } else {\n    var $pos = view.state.doc.resolve(pos.pos);\n    targetNode = $pos.parent;\n    targetPos = $pos.depth ? $pos.before() : 0;\n  }\n\n  this.mightDrag = null;\n\n  var target = flushed ? null : event.target;\n  var targetDesc = target ? view.docView.nearestDesc(target, true) : null;\n  this.target = targetDesc ? targetDesc.dom : null;\n\n  if (targetNode.type.spec.draggable && targetNode.type.spec.selectable !== false ||\n      view.state.selection instanceof NodeSelection && targetPos == view.state.selection.from)\n    { this.mightDrag = {node: targetNode,\n                      pos: targetPos,\n                      addAttr: this.target && !this.target.draggable,\n                      setUneditable: this.target && result.gecko && !this.target.hasAttribute(\"contentEditable\")}; }\n\n  if (this.target && this.mightDrag && (this.mightDrag.addAttr || this.mightDrag.setUneditable)) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.draggable = true; }\n    if (this.mightDrag.setUneditable)\n      { setTimeout(function () { return this$1.target.setAttribute(\"contentEditable\", \"false\"); }, 20); }\n    this.view.domObserver.start();\n  }\n\n  view.root.addEventListener(\"mouseup\", this.up = this.up.bind(this));\n  view.root.addEventListener(\"mousemove\", this.move = this.move.bind(this));\n  setSelectionOrigin(view, \"pointer\");\n};\n\nMouseDown.prototype.done = function done () {\n  this.view.root.removeEventListener(\"mouseup\", this.up);\n  this.view.root.removeEventListener(\"mousemove\", this.move);\n  if (this.mightDrag && this.target) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.removeAttribute(\"draggable\"); }\n    if (this.mightDrag.setUneditable) { this.target.removeAttribute(\"contentEditable\"); }\n    this.view.domObserver.start();\n  }\n  this.view.mouseDown = null;\n};\n\nMouseDown.prototype.up = function up (event) {\n  this.done();\n\n  if (!this.view.dom.contains(event.target.nodeType == 3 ? event.target.parentNode : event.target))\n    { return }\n\n  var pos = this.pos;\n  if (this.view.state.doc != this.startDoc) { pos = this.view.posAtCoords(eventCoords(event)); }\n\n  if (this.allowDefault || !pos) {\n    setSelectionOrigin(this.view, \"pointer\");\n  } else if (handleSingleClick(this.view, pos.pos, pos.inside, event, this.selectNode)) {\n    event.preventDefault();\n  } else if (this.flushed ||\n             // Safari ignores clicks on draggable elements\n             (result.safari && this.mightDrag && !this.mightDrag.node.isAtom) ||\n             // Chrome will sometimes treat a node selection as a\n             // cursor, but still report that the node is selected\n             // when asked through getSelection. You'll then get a\n             // situation where clicking at the point where that\n             // (hidden) cursor is doesn't change the selection, and\n             // thus doesn't get a reaction from ProseMirror. This\n             // works around that.\n             (result.chrome && !(this.view.state.selection instanceof TextSelection) &&\n              (pos.pos == this.view.state.selection.from || pos.pos == this.view.state.selection.to))) {\n    updateSelection(this.view, Selection.near(this.view.state.doc.resolve(pos.pos)), \"pointer\");\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(this.view, \"pointer\");\n  }\n};\n\nMouseDown.prototype.move = function move (event) {\n  if (!this.allowDefault && (Math.abs(this.event.x - event.clientX) > 4 ||\n                             Math.abs(this.event.y - event.clientY) > 4))\n    { this.allowDefault = true; }\n  setSelectionOrigin(this.view, \"pointer\");\n};\n\nhandlers.touchdown = function (view) {\n  forceDOMFlush(view);\n  setSelectionOrigin(view, \"pointer\");\n};\n\nhandlers.contextmenu = function (view) { return forceDOMFlush(view); };\n\nfunction inOrNearComposition(view, event) {\n  if (view.composing) { return true }\n  // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n  // On Japanese input method editors (IMEs), the Enter key is used to confirm character\n  // selection. On Safari, when Enter is pressed, compositionend and keydown events are\n  // emitted. The keydown event triggers newline insertion, which we don't want.\n  // This method returns true if the keydown event should be ignored.\n  // We only ignore it once, as pressing Enter a second time *should* insert a newline.\n  // Furthermore, the keydown event timestamp must be close to the compositionEndedAt timestamp.\n  // This guards against the case where compositionend is triggered without the keyboard\n  // (e.g. character confirmation may be done with the mouse), and keydown is triggered\n  // afterwards- we wouldn't want to ignore the keydown event in this case.\n  if (result.safari && Math.abs(event.timeStamp - view.compositionEndedAt) < 500) {\n    view.compositionEndedAt = -2e8;\n    return true\n  }\n  return false\n}\n\n// Drop active composition after 5 seconds of inactivity on Android\nvar timeoutComposition = result.android ? 5000 : -1;\n\neditHandlers.compositionstart = editHandlers.compositionupdate = function (view) {\n  if (!view.composing) {\n    view.domObserver.flush();\n    var state = view.state;\n    var $pos = state.selection.$from;\n    if (state.selection.empty &&\n        (state.storedMarks ||\n         (!$pos.textOffset && $pos.parentOffset && $pos.nodeBefore.marks.some(function (m) { return m.type.spec.inclusive === false; })))) {\n      // Need to wrap the cursor in mark nodes different from the ones in the DOM context\n      view.markCursor = view.state.storedMarks || $pos.marks();\n      endComposition(view, true);\n      view.markCursor = null;\n    } else {\n      endComposition(view);\n      // In firefox, if the cursor is after but outside a marked node,\n      // the inserted text won't inherit the marks. So this moves it\n      // inside if necessary.\n      if (result.gecko && state.selection.empty && $pos.parentOffset && !$pos.textOffset && $pos.nodeBefore.marks.length) {\n        var sel = view.root.getSelection();\n        for (var node = sel.focusNode, offset = sel.focusOffset; node && node.nodeType == 1 && offset != 0;) {\n          var before = offset < 0 ? node.lastChild : node.childNodes[offset - 1];\n          if (!before) { break }\n          if (before.nodeType == 3) {\n            sel.collapse(before, before.nodeValue.length);\n            break\n          } else {\n            node = before;\n            offset = -1;\n          }\n        }\n      }\n    }\n    view.composing = true;\n  }\n  scheduleComposeEnd(view, timeoutComposition);\n};\n\neditHandlers.compositionend = function (view, event) {\n  if (view.composing) {\n    view.composing = false;\n    view.compositionEndedAt = event.timeStamp;\n    scheduleComposeEnd(view, 20);\n  }\n};\n\nfunction scheduleComposeEnd(view, delay) {\n  clearTimeout(view.composingTimeout);\n  if (delay > -1) { view.composingTimeout = setTimeout(function () { return endComposition(view); }, delay); }\n}\n\nfunction clearComposition(view) {\n  view.composing = false;\n  while (view.compositionNodes.length > 0) { view.compositionNodes.pop().markParentsDirty(); }\n}\n\nfunction endComposition(view, forceUpdate) {\n  view.domObserver.forceFlush();\n  clearComposition(view);\n  if (forceUpdate || view.docView.dirty) {\n    var sel = selectionFromDOM(view);\n    if (sel && !sel.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel)); }\n    else { view.updateState(view.state); }\n    return true\n  }\n  return false\n}\n\nfunction captureCopy(view, dom) {\n  // The extra wrapper is somehow necessary on IE/Edge to prevent the\n  // content from being mangled when it is put onto the clipboard\n  if (!view.dom.parentNode) { return }\n  var wrap = view.dom.parentNode.appendChild(document.createElement(\"div\"));\n  wrap.appendChild(dom);\n  wrap.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  var sel = getSelection(), range = document.createRange();\n  range.selectNodeContents(dom);\n  // Done because IE will fire a selectionchange moving the selection\n  // to its start when removeAllRanges is called and the editor still\n  // has focus (which will mess up the editor's selection state).\n  view.dom.blur();\n  sel.removeAllRanges();\n  sel.addRange(range);\n  setTimeout(function () {\n    if (wrap.parentNode) { wrap.parentNode.removeChild(wrap); }\n    view.focus();\n  }, 50);\n}\n\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard API—all the objects and methods are\n// there, they just don't work, and they are hard to test.\nvar brokenClipboardAPI = (result.ie && result.ie_version < 15) ||\n      (result.ios && result.webkit_version < 604);\n\nhandlers.copy = editHandlers.cut = function (view, e) {\n  var sel = view.state.selection, cut = e.type == \"cut\";\n  if (sel.empty) { return }\n\n  // IE and Edge's clipboard interface is completely broken\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  var slice = sel.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  if (data) {\n    e.preventDefault();\n    data.clearData();\n    data.setData(\"text/html\", dom.innerHTML);\n    data.setData(\"text/plain\", text);\n  } else {\n    captureCopy(view, dom);\n  }\n  if (cut) { view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta(\"uiEvent\", \"cut\")); }\n};\n\nfunction sliceSingleNode(slice) {\n  return slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1 ? slice.content.firstChild : null\n}\n\nfunction capturePaste(view, e) {\n  if (!view.dom.parentNode) { return }\n  var plainText = view.shiftKey || view.state.selection.$from.parent.type.spec.code;\n  var target = view.dom.parentNode.appendChild(document.createElement(plainText ? \"textarea\" : \"div\"));\n  if (!plainText) { target.contentEditable = \"true\"; }\n  target.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  target.focus();\n  setTimeout(function () {\n    view.focus();\n    if (target.parentNode) { target.parentNode.removeChild(target); }\n    if (plainText) { doPaste(view, target.value, null, e); }\n    else { doPaste(view, target.textContent, target.innerHTML, e); }\n  }, 50);\n}\n\nfunction doPaste(view, text, html, e) {\n  var slice = parseFromClipboard(view, text, html, view.shiftKey, view.state.selection.$from);\n  if (view.someProp(\"handlePaste\", function (f) { return f(view, e, slice || Slice.empty); })) { return true }\n  if (!slice) { return false }\n\n  var singleNode = sliceSingleNode(slice);\n  var tr = singleNode ? view.state.tr.replaceSelectionWith(singleNode, view.shiftKey) : view.state.tr.replaceSelection(slice);\n  view.dispatch(tr.scrollIntoView().setMeta(\"paste\", true).setMeta(\"uiEvent\", \"paste\"));\n  return true\n}\n\neditHandlers.paste = function (view, e) {\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  if (data && doPaste(view, data.getData(\"text/plain\"), data.getData(\"text/html\"), e)) { e.preventDefault(); }\n  else { capturePaste(view, e); }\n};\n\nvar Dragging = function Dragging(slice, move) {\n  this.slice = slice;\n  this.move = move;\n};\n\nvar dragCopyModifier = result.mac ? \"altKey\" : \"ctrlKey\";\n\nhandlers.dragstart = function (view, e) {\n  var mouseDown = view.mouseDown;\n  if (mouseDown) { mouseDown.done(); }\n  if (!e.dataTransfer) { return }\n\n  var sel = view.state.selection;\n  var pos = sel.empty ? null : view.posAtCoords(eventCoords(e));\n  if (pos && pos.pos >= sel.from && pos.pos <= (sel instanceof NodeSelection ? sel.to - 1: sel.to)) ; else if (mouseDown && mouseDown.mightDrag) {\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, mouseDown.mightDrag.pos)));\n  } else if (e.target && e.target.nodeType == 1) {\n    var desc = view.docView.nearestDesc(e.target, true);\n    if (!desc || !desc.node.type.spec.draggable || desc == view.docView) { return }\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, desc.posBefore)));\n  }\n  var slice = view.state.selection.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  e.dataTransfer.clearData();\n  e.dataTransfer.setData(brokenClipboardAPI ? \"Text\" : \"text/html\", dom.innerHTML);\n  if (!brokenClipboardAPI) { e.dataTransfer.setData(\"text/plain\", text); }\n  view.dragging = new Dragging(slice, !e[dragCopyModifier]);\n};\n\nhandlers.dragend = function (view) {\n  var dragging = view.dragging;\n  window.setTimeout(function () {\n    if (view.dragging == dragging)  { view.dragging = null; }\n  }, 50);\n};\n\neditHandlers.dragover = editHandlers.dragenter = function (_, e) { return e.preventDefault(); };\n\neditHandlers.drop = function (view, e) {\n  var dragging = view.dragging;\n  view.dragging = null;\n\n  if (!e.dataTransfer) { return }\n\n  var eventPos = view.posAtCoords(eventCoords(e));\n  if (!eventPos) { return }\n  var $mouse = view.state.doc.resolve(eventPos.pos);\n  if (!$mouse) { return }\n  var slice = dragging && dragging.slice ||\n      parseFromClipboard(view, e.dataTransfer.getData(brokenClipboardAPI ? \"Text\" : \"text/plain\"),\n                         brokenClipboardAPI ? null : e.dataTransfer.getData(\"text/html\"), false, $mouse);\n  var move = dragging && !e[dragCopyModifier];\n  if (view.someProp(\"handleDrop\", function (f) { return f(view, e, slice || Slice.empty, move); })) {\n    e.preventDefault();\n    return\n  }\n  if (!slice) { return }\n\n  e.preventDefault();\n  var insertPos = slice ? dropPoint(view.state.doc, $mouse.pos, slice) : $mouse.pos;\n  if (insertPos == null) { insertPos = $mouse.pos; }\n\n  var tr = view.state.tr;\n  if (move) { tr.deleteSelection(); }\n\n  var pos = tr.mapping.map(insertPos);\n  var isNode = slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1;\n  var beforeInsert = tr.doc;\n  if (isNode)\n    { tr.replaceRangeWith(pos, pos, slice.content.firstChild); }\n  else\n    { tr.replaceRange(pos, pos, slice); }\n  if (tr.doc.eq(beforeInsert)) { return }\n\n  var $pos = tr.doc.resolve(pos);\n  if (isNode && NodeSelection.isSelectable(slice.content.firstChild) &&\n      $pos.nodeAfter && $pos.nodeAfter.sameMarkup(slice.content.firstChild)) {\n    tr.setSelection(new NodeSelection($pos));\n  } else {\n    var end = tr.mapping.map(insertPos);\n    tr.mapping.maps[tr.mapping.maps.length - 1].forEach(function (_from, _to, _newFrom, newTo) { return end = newTo; });\n    tr.setSelection(selectionBetween(view, $pos, tr.doc.resolve(end)));\n  }\n  view.focus();\n  view.dispatch(tr.setMeta(\"uiEvent\", \"drop\"));\n};\n\nhandlers.focus = function (view) {\n  if (!view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.add(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.focused = true;\n    setTimeout(function () {\n      if (view.docView && view.hasFocus() && !view.domObserver.currentSelection.eq(view.root.getSelection()))\n        { selectionToDOM(view); }\n    }, 20);\n  }\n};\n\nhandlers.blur = function (view) {\n  if (view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.remove(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.domObserver.currentSelection.set({});\n    view.focused = false;\n  }\n};\n\nhandlers.beforeinput = function (view, event) {\n  // We should probably do more with beforeinput events, but support\n  // is so spotty that I'm still waiting to see where they are going.\n\n  // Very specific hack to deal with backspace sometimes failing on\n  // Chrome Android when after an uneditable node.\n  if (result.chrome && result.android && event.inputType == \"deleteContentBackward\") {\n    var domChangeCount = view.domChangeCount;\n    setTimeout(function () {\n      if (view.domChangeCount != domChangeCount) { return } // Event already had some effect\n      // This bug tends to close the virtual keyboard, so we refocus\n      view.dom.blur();\n      view.focus();\n      if (view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) { return }\n      var ref = view.state.selection;\n      var $cursor = ref.$cursor;\n      // Crude approximation of backspace behavior when no command handled it\n      if ($cursor && $cursor.pos > 0) { view.dispatch(view.state.tr.delete($cursor.pos - 1, $cursor.pos).scrollIntoView()); }\n    }, 50);\n  }\n};\n\n// Make sure all handlers get registered\nfor (var prop in editHandlers) { handlers[prop] = editHandlers[prop]; }\n\nfunction compareObjs(a, b) {\n  if (a == b) { return true }\n  for (var p in a) { if (a[p] !== b[p]) { return false } }\n  for (var p$1 in b) { if (!(p$1 in a)) { return false } }\n  return true\n}\n\nvar WidgetType = function WidgetType(toDOM, spec) {\n  this.spec = spec || noSpec;\n  this.side = this.spec.side || 0;\n  this.toDOM = toDOM;\n};\n\nWidgetType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var ref = mapping.mapResult(span.from + oldOffset, this.side < 0 ? -1 : 1);\n    var pos = ref.pos;\n    var deleted = ref.deleted;\n  return deleted ? null : new Decoration(pos - offset, pos - offset, this)\n};\n\nWidgetType.prototype.valid = function valid () { return true };\n\nWidgetType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof WidgetType &&\n     (this.spec.key && this.spec.key == other.spec.key ||\n      this.toDOM == other.toDOM && compareObjs(this.spec, other.spec)))\n};\n\nvar InlineType = function InlineType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nInlineType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.map(span.from + oldOffset, this.spec.inclusiveStart ? -1 : 1) - offset;\n  var to = mapping.map(span.to + oldOffset, this.spec.inclusiveEnd ? 1 : -1) - offset;\n  return from >= to ? null : new Decoration(from, to, this)\n};\n\nInlineType.prototype.valid = function valid (_, span) { return span.from < span.to };\n\nInlineType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof InlineType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\nInlineType.is = function is (span) { return span.type instanceof InlineType };\n\nvar NodeType = function NodeType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nNodeType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.mapResult(span.from + oldOffset, 1);\n  if (from.deleted) { return null }\n  var to = mapping.mapResult(span.to + oldOffset, -1);\n  if (to.deleted || to.pos <= from.pos) { return null }\n  return new Decoration(from.pos - offset, to.pos - offset, this)\n};\n\nNodeType.prototype.valid = function valid (node, span) {\n  var ref = node.content.findIndex(span.from);\n    var index = ref.index;\n    var offset = ref.offset;\n  return offset == span.from && offset + node.child(index).nodeSize == span.to\n};\n\nNodeType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof NodeType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\n// ::- Decoration objects can be provided to the view through the\n// [`decorations` prop](#view.EditorProps.decorations). They come in\n// several variants—see the static members of this class for details.\nvar Decoration = function Decoration(from, to, type) {\n  // :: number\n  // The start position of the decoration.\n  this.from = from;\n  // :: number\n  // The end position. Will be the same as `from` for [widget\n  // decorations](#view.Decoration^widget).\n  this.to = to;\n  this.type = type;\n};\n\nvar prototypeAccessors$1 = { spec: { configurable: true },inline: { configurable: true } };\n\nDecoration.prototype.copy = function copy (from, to) {\n  return new Decoration(from, to, this.type)\n};\n\nDecoration.prototype.eq = function eq (other, offset) {\n    if ( offset === void 0 ) offset = 0;\n\n  return this.type.eq(other.type) && this.from + offset == other.from && this.to + offset == other.to\n};\n\nDecoration.prototype.map = function map (mapping, offset, oldOffset) {\n  return this.type.map(mapping, this, offset, oldOffset)\n};\n\n// :: (number, union<(view: EditorView, getPos: () → number) → dom.Node, dom.Node>, ?Object) → Decoration\n// Creates a widget decoration, which is a DOM node that's shown in\n// the document at the given position. It is recommended that you\n// delay rendering the widget by passing a function that will be\n// called when the widget is actually drawn in a view, but you can\n// also directly pass a DOM node. `getPos` can be used to find the\n// widget's current document position.\n//\n// spec::- These options are supported:\n//\n//   side:: ?number\n//   Controls which side of the document position this widget is\n//   associated with. When negative, it is drawn before a cursor\n//   at its position, and content inserted at that position ends\n//   up after the widget. When zero (the default) or positive, the\n//   widget is drawn after the cursor and content inserted there\n//   ends up before the widget.\n//\n//   When there are multiple widgets at a given position, their\n//   `side` values determine the order in which they appear. Those\n//   with lower values appear first. The ordering of widgets with\n//   the same `side` value is unspecified.\n//\n//   When `marks` is null, `side` also determines the marks that\n//   the widget is wrapped in—those of the node before when\n//   negative, those of the node after when positive.\n//\n//   marks:: ?[Mark]\n//   The precise set of marks to draw around the widget.\n//\n//   stopEvent:: ?(event: dom.Event) → bool\n//   Can be used to control which DOM events, when they bubble out\n//   of this widget, the editor view should ignore.\n//\n//   ignoreSelection:: ?bool\n//   When set (defaults to false), selection changes inside the\n//   widget are ignored, and don't cause ProseMirror to try and\n//   re-sync the selection with its selection state.\n//\n//   key:: ?string\n//   When comparing decorations of this type (in order to decide\n//   whether it needs to be redrawn), ProseMirror will by default\n//   compare the widget DOM node by identity. If you pass a key,\n//   that key will be compared instead, which can be useful when\n//   you generate decorations on the fly and don't want to store\n//   and reuse DOM nodes. Make sure that any widgets with the same\n//   key are interchangeable—if widgets differ in, for example,\n//   the behavior of some event handler, they should get\n//   different keys.\nDecoration.widget = function widget (pos, toDOM, spec) {\n  return new Decoration(pos, pos, new WidgetType(toDOM, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object) → Decoration\n// Creates an inline decoration, which adds the given attributes to\n// each inline node between `from` and `to`.\n//\n// spec::- These options are recognized:\n//\n//   inclusiveStart:: ?bool\n//   Determines how the left side of the decoration is\n//   [mapped](#transform.Position_Mapping) when content is\n//   inserted directly at that position. By default, the decoration\n//   won't include the new content, but you can set this to `true`\n//   to make it inclusive.\n//\n//   inclusiveEnd:: ?bool\n//   Determines how the right side of the decoration is mapped.\n//   See\n//   [`inclusiveStart`](#view.Decoration^inline^spec.inclusiveStart).\nDecoration.inline = function inline (from, to, attrs, spec) {\n  return new Decoration(from, to, new InlineType(attrs, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object) → Decoration\n// Creates a node decoration. `from` and `to` should point precisely\n// before and after a node in the document. That node, and only that\n// node, will receive the given attributes.\n//\n// spec::-\n//\n// Optional information to store with the decoration. It\n// is also used when comparing decorators for equality.\nDecoration.node = function node (from, to, attrs, spec) {\n  return new Decoration(from, to, new NodeType(attrs, spec))\n};\n\n// :: Object\n// The spec provided when creating this decoration. Can be useful\n// if you've stored extra information in that object.\nprototypeAccessors$1.spec.get = function () { return this.type.spec };\n\nprototypeAccessors$1.inline.get = function () { return this.type instanceof InlineType };\n\nObject.defineProperties( Decoration.prototype, prototypeAccessors$1 );\n\n// DecorationAttrs:: interface\n// A set of attributes to add to a decorated node. Most properties\n// simply directly correspond to DOM attributes of the same name,\n// which will be set to the property's value. These are exceptions:\n//\n//   class:: ?string\n//   A CSS class name or a space-separated set of class names to be\n//   _added_ to the classes that the node already had.\n//\n//   style:: ?string\n//   A string of CSS to be _added_ to the node's existing `style` property.\n//\n//   nodeName:: ?string\n//   When non-null, the target node is wrapped in a DOM element of\n//   this type (and the other attributes are applied to this element).\n\nvar none = [], noSpec = {};\n\n// ::- A collection of [decorations](#view.Decoration), organized in\n// such a way that the drawing algorithm can efficiently use and\n// compare them. This is a persistent data structure—it is not\n// modified, updates create a new value.\nvar DecorationSet = function DecorationSet(local, children) {\n  this.local = local && local.length ? local : none;\n  this.children = children && children.length ? children : none;\n};\n\n// :: (Node, [Decoration]) → DecorationSet\n// Create a set of decorations, using the structure of the given\n// document.\nDecorationSet.create = function create (doc, decorations) {\n  return decorations.length ? buildTree(decorations, doc, 0, noSpec) : empty\n};\n\n// :: (?number, ?number, ?(spec: Object) → bool) → [Decoration]\n// Find all decorations in this set which touch the given range\n// (including decorations that start or end directly at the\n// boundaries) and match the given predicate on their spec. When\n// `start` and `end` are omitted, all decorations in the set are\n// considered. When `predicate` isn't given, all decorations are\n// assumed to match.\nDecorationSet.prototype.find = function find (start, end, predicate) {\n  var result = [];\n  this.findInner(start == null ? 0 : start, end == null ? 1e9 : end, result, 0, predicate);\n  return result\n};\n\nDecorationSet.prototype.findInner = function findInner (start, end, result, offset, predicate) {\n  for (var i = 0; i < this.local.length; i++) {\n    var span = this.local[i];\n    if (span.from <= end && span.to >= start && (!predicate || predicate(span.spec)))\n      { result.push(span.copy(span.from + offset, span.to + offset)); }\n  }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3) {\n    if (this.children[i$1] < end && this.children[i$1 + 1] > start) {\n      var childOff = this.children[i$1] + 1;\n      this.children[i$1 + 2].findInner(start - childOff, end - childOff, result, offset + childOff, predicate);\n    }\n  }\n};\n\n// :: (Mapping, Node, ?Object) → DecorationSet\n// Map the set of decorations in response to a change in the\n// document.\n//\n// options::- An optional set of options.\n//\n//   onRemove:: ?(decorationSpec: Object)\n//   When given, this function will be called for each decoration\n//   that gets dropped as a result of the mapping, passing the\n//   spec of that decoration.\nDecorationSet.prototype.map = function map (mapping, doc, options) {\n  if (this == empty || mapping.maps.length == 0) { return this }\n  return this.mapInner(mapping, doc, 0, 0, options || noSpec)\n};\n\nDecorationSet.prototype.mapInner = function mapInner (mapping, node, offset, oldOffset, options) {\n  var newLocal;\n  for (var i = 0; i < this.local.length; i++) {\n    var mapped = this.local[i].map(mapping, offset, oldOffset);\n    if (mapped && mapped.type.valid(node, mapped)) { (newLocal || (newLocal = [])).push(mapped); }\n    else if (options.onRemove) { options.onRemove(this.local[i].spec); }\n  }\n\n  if (this.children.length)\n    { return mapChildren(this.children, newLocal, mapping, node, offset, oldOffset, options) }\n  else\n    { return newLocal ? new DecorationSet(newLocal.sort(byPos)) : empty }\n};\n\n// :: (Node, [Decoration]) → DecorationSet\n// Add the given array of decorations to the ones in the set,\n// producing a new set. Needs access to the current document to\n// create the appropriate tree structure.\nDecorationSet.prototype.add = function add (doc, decorations) {\n  if (!decorations.length) { return this }\n  if (this == empty) { return DecorationSet.create(doc, decorations) }\n  return this.addInner(doc, decorations, 0)\n};\n\nDecorationSet.prototype.addInner = function addInner (doc, decorations, offset) {\n    var this$1 = this;\n\n  var children, childIndex = 0;\n  doc.forEach(function (childNode, childOffset) {\n    var baseOffset = childOffset + offset, found;\n    if (!(found = takeSpansForNode(decorations, childNode, baseOffset))) { return }\n\n    if (!children) { children = this$1.children.slice(); }\n    while (childIndex < children.length && children[childIndex] < childOffset) { childIndex += 3; }\n    if (children[childIndex] == childOffset)\n      { children[childIndex + 2] = children[childIndex + 2].addInner(childNode, found, baseOffset + 1); }\n    else\n      { children.splice(childIndex, 0, childOffset, childOffset + childNode.nodeSize, buildTree(found, childNode, baseOffset + 1, noSpec)); }\n    childIndex += 3;\n  });\n\n  var local = moveSpans(childIndex ? withoutNulls(decorations) : decorations, -offset);\n  for (var i = 0; i < local.length; i++) { if (!local[i].type.valid(doc, local[i])) { local.splice(i--, 1); } }\n\n  return new DecorationSet(local.length ? this.local.concat(local).sort(byPos) : this.local,\n                           children || this.children)\n};\n\n// :: ([Decoration]) → DecorationSet\n// Create a new set that contains the decorations in this set, minus\n// the ones in the given array.\nDecorationSet.prototype.remove = function remove (decorations) {\n  if (decorations.length == 0 || this == empty) { return this }\n  return this.removeInner(decorations, 0)\n};\n\nDecorationSet.prototype.removeInner = function removeInner (decorations, offset) {\n  var children = this.children, local = this.local;\n  for (var i = 0; i < children.length; i += 3) {\n    var found = (void 0), from = children[i] + offset, to = children[i + 1] + offset;\n    for (var j = 0, span = (void 0); j < decorations.length; j++) { if (span = decorations[j]) {\n      if (span.from > from && span.to < to) {\n        decorations[j] = null\n        ;(found || (found = [])).push(span);\n      }\n    } }\n    if (!found) { continue }\n    if (children == this.children) { children = this.children.slice(); }\n    var removed = children[i + 2].removeInner(found, from + 1);\n    if (removed != empty) {\n      children[i + 2] = removed;\n    } else {\n      children.splice(i, 3);\n      i -= 3;\n    }\n  }\n  if (local.length) { for (var i$1 = 0, span$1 = (void 0); i$1 < decorations.length; i$1++) { if (span$1 = decorations[i$1]) {\n    for (var j$1 = 0; j$1 < local.length; j$1++) { if (local[j$1].eq(span$1, offset)) {\n      if (local == this.local) { local = this.local.slice(); }\n      local.splice(j$1--, 1);\n    } }\n  } } }\n  if (children == this.children && local == this.local) { return this }\n  return local.length || children.length ? new DecorationSet(local, children) : empty\n};\n\nDecorationSet.prototype.forChild = function forChild (offset, node) {\n  if (this == empty) { return this }\n  if (node.isLeaf) { return DecorationSet.empty }\n\n  var child, local;\n  for (var i = 0; i < this.children.length; i += 3) { if (this.children[i] >= offset) {\n    if (this.children[i] == offset) { child = this.children[i + 2]; }\n    break\n  } }\n  var start = offset + 1, end = start + node.content.size;\n  for (var i$1 = 0; i$1 < this.local.length; i$1++) {\n    var dec = this.local[i$1];\n    if (dec.from < end && dec.to > start && (dec.type instanceof InlineType)) {\n      var from = Math.max(start, dec.from) - start, to = Math.min(end, dec.to) - start;\n      if (from < to) { (local || (local = [])).push(dec.copy(from, to)); }\n    }\n  }\n  if (local) {\n    var localSet = new DecorationSet(local.sort(byPos));\n    return child ? new DecorationGroup([localSet, child]) : localSet\n  }\n  return child || empty\n};\n\nDecorationSet.prototype.eq = function eq (other) {\n  if (this == other) { return true }\n  if (!(other instanceof DecorationSet) ||\n      this.local.length != other.local.length ||\n      this.children.length != other.children.length) { return false }\n  for (var i = 0; i < this.local.length; i++)\n    { if (!this.local[i].eq(other.local[i])) { return false } }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3)\n    { if (this.children[i$1] != other.children[i$1] ||\n        this.children[i$1 + 1] != other.children[i$1 + 1] ||\n        !this.children[i$1 + 2].eq(other.children[i$1 + 2])) { return false } }\n  return true\n};\n\nDecorationSet.prototype.locals = function locals (node) {\n  return removeOverlap(this.localsInner(node))\n};\n\nDecorationSet.prototype.localsInner = function localsInner (node) {\n  if (this == empty) { return none }\n  if (node.inlineContent || !this.local.some(InlineType.is)) { return this.local }\n  var result = [];\n  for (var i = 0; i < this.local.length; i++) {\n    if (!(this.local[i].type instanceof InlineType))\n      { result.push(this.local[i]); }\n  }\n  return result\n};\n\nvar empty = new DecorationSet();\n\n// :: DecorationSet\n// The empty set of decorations.\nDecorationSet.empty = empty;\n\nDecorationSet.removeOverlap = removeOverlap;\n\n// :- An abstraction that allows the code dealing with decorations to\n// treat multiple DecorationSet objects as if it were a single object\n// with (a subset of) the same interface.\nvar DecorationGroup = function DecorationGroup(members) {\n  this.members = members;\n};\n\nDecorationGroup.prototype.forChild = function forChild (offset, child) {\n  if (child.isLeaf) { return DecorationSet.empty }\n  var found = [];\n  for (var i = 0; i < this.members.length; i++) {\n    var result = this.members[i].forChild(offset, child);\n    if (result == empty) { continue }\n    if (result instanceof DecorationGroup) { found = found.concat(result.members); }\n    else { found.push(result); }\n  }\n  return DecorationGroup.from(found)\n};\n\nDecorationGroup.prototype.eq = function eq (other) {\n  if (!(other instanceof DecorationGroup) ||\n      other.members.length != this.members.length) { return false }\n  for (var i = 0; i < this.members.length; i++)\n    { if (!this.members[i].eq(other.members[i])) { return false } }\n  return true\n};\n\nDecorationGroup.prototype.locals = function locals (node) {\n  var result, sorted = true;\n  for (var i = 0; i < this.members.length; i++) {\n    var locals = this.members[i].localsInner(node);\n    if (!locals.length) { continue }\n    if (!result) {\n      result = locals;\n    } else {\n      if (sorted) {\n        result = result.slice();\n        sorted = false;\n      }\n      for (var j = 0; j < locals.length; j++) { result.push(locals[j]); }\n    }\n  }\n  return result ? removeOverlap(sorted ? result : result.sort(byPos)) : none\n};\n\n// : ([DecorationSet]) → union<DecorationSet, DecorationGroup>\n// Create a group for the given array of decoration sets, or return\n// a single set when possible.\nDecorationGroup.from = function from (members) {\n  switch (members.length) {\n    case 0: return empty\n    case 1: return members[0]\n    default: return new DecorationGroup(members)\n  }\n};\n\nfunction mapChildren(oldChildren, newLocal, mapping, node, offset, oldOffset, options) {\n  var children = oldChildren.slice();\n\n  // Mark the children that are directly touched by changes, and\n  // move those that are after the changes.\n  var shift = function (oldStart, oldEnd, newStart, newEnd) {\n    for (var i = 0; i < children.length; i += 3) {\n      var end = children[i + 1], dSize = (void 0);\n      if (end == -1 || oldStart > end + oldOffset) { continue }\n      if (oldEnd >= children[i] + oldOffset) {\n        children[i + 1] = -1;\n      } else if (newStart >= offset && (dSize = (newEnd - newStart) - (oldEnd - oldStart))) {\n        children[i] += dSize;\n        children[i + 1] += dSize;\n      }\n    }\n  };\n  for (var i = 0; i < mapping.maps.length; i++) { mapping.maps[i].forEach(shift); }\n\n  // Find the child nodes that still correspond to a single node,\n  // recursively call mapInner on them and update their positions.\n  var mustRebuild = false;\n  for (var i$1 = 0; i$1 < children.length; i$1 += 3) { if (children[i$1 + 1] == -1) { // Touched nodes\n    var from = mapping.map(oldChildren[i$1] + oldOffset), fromLocal = from - offset;\n    if (fromLocal < 0 || fromLocal >= node.content.size) {\n      mustRebuild = true;\n      continue\n    }\n    // Must read oldChildren because children was tagged with -1\n    var to = mapping.map(oldChildren[i$1 + 1] + oldOffset, -1), toLocal = to - offset;\n    var ref = node.content.findIndex(fromLocal);\n    var index = ref.index;\n    var childOffset = ref.offset;\n    var childNode = node.maybeChild(index);\n    if (childNode && childOffset == fromLocal && childOffset + childNode.nodeSize == toLocal) {\n      var mapped = children[i$1 + 2].mapInner(mapping, childNode, from + 1, oldChildren[i$1] + oldOffset + 1, options);\n      if (mapped != empty) {\n        children[i$1] = fromLocal;\n        children[i$1 + 1] = toLocal;\n        children[i$1 + 2] = mapped;\n      } else {\n        children[i$1 + 1] = -2;\n        mustRebuild = true;\n      }\n    } else {\n      mustRebuild = true;\n    }\n  } }\n\n  // Remaining children must be collected and rebuilt into the appropriate structure\n  if (mustRebuild) {\n    var decorations = mapAndGatherRemainingDecorations(children, oldChildren, newLocal || [], mapping,\n                                                       offset, oldOffset, options);\n    var built = buildTree(decorations, node, 0, options);\n    newLocal = built.local;\n    for (var i$2 = 0; i$2 < children.length; i$2 += 3) { if (children[i$2 + 1] < 0) {\n      children.splice(i$2, 3);\n      i$2 -= 3;\n    } }\n    for (var i$3 = 0, j = 0; i$3 < built.children.length; i$3 += 3) {\n      var from$1 = built.children[i$3];\n      while (j < children.length && children[j] < from$1) { j += 3; }\n      children.splice(j, 0, built.children[i$3], built.children[i$3 + 1], built.children[i$3 + 2]);\n    }\n  }\n\n  return new DecorationSet(newLocal && newLocal.sort(byPos), children)\n}\n\nfunction moveSpans(spans, offset) {\n  if (!offset || !spans.length) { return spans }\n  var result = [];\n  for (var i = 0; i < spans.length; i++) {\n    var span = spans[i];\n    result.push(new Decoration(span.from + offset, span.to + offset, span.type));\n  }\n  return result\n}\n\nfunction mapAndGatherRemainingDecorations(children, oldChildren, decorations, mapping, offset, oldOffset, options) {\n  // Gather all decorations from the remaining marked children\n  function gather(set, oldOffset) {\n    for (var i = 0; i < set.local.length; i++) {\n      var mapped = set.local[i].map(mapping, offset, oldOffset);\n      if (mapped) { decorations.push(mapped); }\n      else if (options.onRemove) { options.onRemove(set.local[i].spec); }\n    }\n    for (var i$1 = 0; i$1 < set.children.length; i$1 += 3)\n      { gather(set.children[i$1 + 2], set.children[i$1] + oldOffset + 1); }\n  }\n  for (var i = 0; i < children.length; i += 3) { if (children[i + 1] == -1)\n    { gather(children[i + 2], oldChildren[i] + oldOffset + 1); } }\n\n  return decorations\n}\n\nfunction takeSpansForNode(spans, node, offset) {\n  if (node.isLeaf) { return null }\n  var end = offset + node.nodeSize, found = null;\n  for (var i = 0, span = (void 0); i < spans.length; i++) {\n    if ((span = spans[i]) && span.from > offset && span.to < end) {\n(found || (found = [])).push(span);\n      spans[i] = null;\n    }\n  }\n  return found\n}\n\nfunction withoutNulls(array) {\n  var result = [];\n  for (var i = 0; i < array.length; i++)\n    { if (array[i] != null) { result.push(array[i]); } }\n  return result\n}\n\n// : ([Decoration], Node, number) → DecorationSet\n// Build up a tree that corresponds to a set of decorations. `offset`\n// is a base offset that should be subtractet from the `from` and `to`\n// positions in the spans (so that we don't have to allocate new spans\n// for recursive calls).\nfunction buildTree(spans, node, offset, options) {\n  var children = [], hasNulls = false;\n  node.forEach(function (childNode, localStart) {\n    var found = takeSpansForNode(spans, childNode, localStart + offset);\n    if (found) {\n      hasNulls = true;\n      var subtree = buildTree(found, childNode, offset + localStart + 1, options);\n      if (subtree != empty)\n        { children.push(localStart, localStart + childNode.nodeSize, subtree); }\n    }\n  });\n  var locals = moveSpans(hasNulls ? withoutNulls(spans) : spans, -offset).sort(byPos);\n  for (var i = 0; i < locals.length; i++) { if (!locals[i].type.valid(node, locals[i])) {\n    if (options.onRemove) { options.onRemove(locals[i].spec); }\n    locals.splice(i--, 1);\n  } }\n  return locals.length || children.length ? new DecorationSet(locals, children) : empty\n}\n\n// : (Decoration, Decoration) → number\n// Used to sort decorations so that ones with a low start position\n// come first, and within a set with the same start position, those\n// with an smaller end position come first.\nfunction byPos(a, b) {\n  return a.from - b.from || a.to - b.to\n}\n\n// : ([Decoration]) → [Decoration]\n// Scan a sorted array of decorations for partially overlapping spans,\n// and split those so that only fully overlapping spans are left (to\n// make subsequent rendering easier). Will return the input array if\n// no partially overlapping spans are found (the common case).\nfunction removeOverlap(spans) {\n  var working = spans;\n  for (var i = 0; i < working.length - 1; i++) {\n    var span = working[i];\n    if (span.from != span.to) { for (var j = i + 1; j < working.length; j++) {\n      var next = working[j];\n      if (next.from == span.from) {\n        if (next.to != span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // Followed by a partially overlapping larger span. Split that\n          // span.\n          working[j] = next.copy(next.from, span.to);\n          insertAhead(working, j + 1, next.copy(span.to, next.to));\n        }\n        continue\n      } else {\n        if (next.from < span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // The end of this one overlaps with a subsequent span. Split\n          // this one.\n          working[i] = span.copy(span.from, next.from);\n          insertAhead(working, j, span.copy(next.from, span.to));\n        }\n        break\n      }\n    } }\n  }\n  return working\n}\n\nfunction insertAhead(array, i, deco) {\n  while (i < array.length && byPos(deco, array[i]) > 0) { i++; }\n  array.splice(i, 0, deco);\n}\n\n// : (EditorView) → union<DecorationSet, DecorationGroup>\n// Get the decorations associated with the current props of a view.\nfunction viewDecorations(view) {\n  var found = [];\n  view.someProp(\"decorations\", function (f) {\n    var result = f(view.state);\n    if (result && result != empty) { found.push(result); }\n  });\n  if (view.cursorWrapper)\n    { found.push(DecorationSet.create(view.state.doc, [view.cursorWrapper.deco])); }\n  return DecorationGroup.from(found)\n}\n\n// ::- An editor view manages the DOM structure that represents an\n// editable document. Its state and behavior are determined by its\n// [props](#view.DirectEditorProps).\nvar EditorView = function EditorView(place, props) {\n  this._props = props;\n  // :: EditorState\n  // The view's current [state](#state.EditorState).\n  this.state = props.state;\n\n  this.dispatch = this.dispatch.bind(this);\n\n  this._root = null;\n  this.focused = false;\n  // Kludge used to work around a Chrome bug\n  this.trackWrites = null;\n\n  // :: dom.Element\n  // An editable DOM node containing the document. (You probably\n  // should not directly interfere with its content.)\n  this.dom = (place && place.mount) || document.createElement(\"div\");\n  if (place) {\n    if (place.appendChild) { place.appendChild(this.dom); }\n    else if (place.apply) { place(this.dom); }\n    else if (place.mount) { this.mounted = true; }\n  }\n\n  // :: bool\n  // Indicates whether the editor is currently [editable](#view.EditorProps.editable).\n  this.editable = getEditable(this);\n  this.markCursor = null;\n  this.cursorWrapper = null;\n  updateCursorWrapper(this);\n  this.nodeViews = buildNodeViews(this);\n  this.docView = docViewDesc(this.state.doc, computeDocDeco(this), viewDecorations(this), this.dom, this);\n\n  this.lastSelectedViewDesc = null;\n  // :: ?{slice: Slice, move: bool}\n  // When editor content is being dragged, this object contains\n  // information about the dragged slice and whether it is being\n  // copied or moved. At any other time, it is null.\n  this.dragging = null;\n\n  initInput(this);\n\n  this.pluginViews = [];\n  this.updatePluginViews();\n};\n\nvar prototypeAccessors$2 = { props: { configurable: true },root: { configurable: true } };\n\n// composing:: boolean\n// Holds `true` when a\n// [composition](https://developer.mozilla.org/en-US/docs/Mozilla/IME_handling_guide)\n// is active.\n\n// :: DirectEditorProps\n// The view's current [props](#view.EditorProps).\nprototypeAccessors$2.props.get = function () {\n  if (this._props.state != this.state) {\n    var prev = this._props;\n    this._props = {};\n    for (var name in prev) { this._props[name] = prev[name]; }\n    this._props.state = this.state;\n  }\n  return this._props\n};\n\n// :: (DirectEditorProps)\n// Update the view's props. Will immediately cause an update to\n// the DOM.\nEditorView.prototype.update = function update (props) {\n  if (props.handleDOMEvents != this._props.handleDOMEvents) { ensureListeners(this); }\n  this._props = props;\n  this.updateStateInner(props.state, true);\n};\n\n// :: (DirectEditorProps)\n// Update the view by updating existing props object with the object\n// given as argument. Equivalent to `view.update(Object.assign({},\n// view.props, props))`.\nEditorView.prototype.setProps = function setProps (props) {\n  var updated = {};\n  for (var name in this._props) { updated[name] = this._props[name]; }\n  updated.state = this.state;\n  for (var name$1 in props) { updated[name$1] = props[name$1]; }\n  this.update(updated);\n};\n\n// :: (EditorState)\n// Update the editor's `state` prop, without touching any of the\n// other props.\nEditorView.prototype.updateState = function updateState (state) {\n  this.updateStateInner(state, this.state.plugins != state.plugins);\n};\n\nEditorView.prototype.updateStateInner = function updateStateInner (state, reconfigured) {\n    var this$1 = this;\n\n  var prev = this.state, redraw = false, updateSel = false;\n  // When stored marks are added, stop composition, so that they can\n  // be displayed.\n  if (state.storedMarks && this.composing) {\n    clearComposition(this);\n    updateSel = true;\n  }\n  this.state = state;\n  if (reconfigured) {\n    var nodeViews = buildNodeViews(this);\n    if (changedNodeViews(nodeViews, this.nodeViews)) {\n      this.nodeViews = nodeViews;\n      redraw = true;\n    }\n    ensureListeners(this);\n  }\n\n  this.editable = getEditable(this);\n  updateCursorWrapper(this);\n  var innerDeco = viewDecorations(this), outerDeco = computeDocDeco(this);\n\n  var scroll = reconfigured ? \"reset\"\n      : state.scrollToSelection > prev.scrollToSelection ? \"to selection\" : \"preserve\";\n  var updateDoc = redraw || !this.docView.matchesNode(state.doc, outerDeco, innerDeco);\n  if (updateDoc || !state.selection.eq(prev.selection)) { updateSel = true; }\n  var oldScrollPos = scroll == \"preserve\" && updateSel && this.dom.style.overflowAnchor == null && storeScrollPos(this);\n\n  if (updateSel) {\n    this.domObserver.stop();\n    // Work around an issue in Chrome, IE, and Edge where changing\n    // the DOM around an active selection puts it into a broken\n    // state where the thing the user sees differs from the\n    // selection reported by the Selection object (#710, #973,\n    // #1011, #1013, #1035).\n    var forceSelUpdate = updateDoc && (result.ie || result.chrome) && !this.composing &&\n        !prev.selection.empty && !state.selection.empty && selectionContextChanged(prev.selection, state.selection);\n    if (updateDoc) {\n      // If the node that the selection points into is written to,\n      // Chrome sometimes starts misreporting the selection, so this\n      // tracks that and forces a selection reset when our update\n      // did write to the node.\n      var chromeKludge = result.chrome ? (this.trackWrites = this.root.getSelection().focusNode) : null;\n      if (redraw || !this.docView.update(state.doc, outerDeco, innerDeco, this)) {\n        this.docView.updateOuterDeco([]);\n        this.docView.destroy();\n        this.docView = docViewDesc(state.doc, outerDeco, innerDeco, this.dom, this);\n      }\n      if (chromeKludge && !this.trackWrites) { forceSelUpdate = true; }\n    }\n    // Work around for an issue where an update arriving right between\n    // a DOM selection change and the \"selectionchange\" event for it\n    // can cause a spurious DOM selection update, disrupting mouse\n    // drag selection.\n    if (forceSelUpdate ||\n        !(this.mouseDown && this.domObserver.currentSelection.eq(this.root.getSelection()) && anchorInRightPlace(this))) {\n      selectionToDOM(this, forceSelUpdate);\n    } else {\n      syncNodeSelection(this, state.selection);\n      this.domObserver.setCurSelection();\n    }\n    this.domObserver.start();\n  }\n\n  this.updatePluginViews(prev);\n\n  if (scroll == \"reset\") {\n    this.dom.scrollTop = 0;\n  } else if (scroll == \"to selection\") {\n    var startDOM = this.root.getSelection().focusNode;\n    if (this.someProp(\"handleScrollToSelection\", function (f) { return f(this$1); }))\n      ; // Handled\n    else if (state.selection instanceof NodeSelection)\n      { scrollRectIntoView(this, this.docView.domAfterPos(state.selection.from).getBoundingClientRect(), startDOM); }\n    else\n      { scrollRectIntoView(this, this.coordsAtPos(state.selection.head, 1), startDOM); }\n  } else if (oldScrollPos) {\n    resetScrollPos(oldScrollPos);\n  }\n};\n\nEditorView.prototype.destroyPluginViews = function destroyPluginViews () {\n  var view;\n  while (view = this.pluginViews.pop()) { if (view.destroy) { view.destroy(); } }\n};\n\nEditorView.prototype.updatePluginViews = function updatePluginViews (prevState) {\n  if (!prevState || prevState.plugins != this.state.plugins) {\n    this.destroyPluginViews();\n    for (var i = 0; i < this.state.plugins.length; i++) {\n      var plugin = this.state.plugins[i];\n      if (plugin.spec.view) { this.pluginViews.push(plugin.spec.view(this)); }\n    }\n  } else {\n    for (var i$1 = 0; i$1 < this.pluginViews.length; i$1++) {\n      var pluginView = this.pluginViews[i$1];\n      if (pluginView.update) { pluginView.update(this, prevState); }\n    }\n  }\n};\n\n// :: (string, ?(prop: *) → *) → *\n// Goes over the values of a prop, first those provided directly,\n// then those from plugins (in order), and calls `f` every time a\n// non-undefined value is found. When `f` returns a truthy value,\n// that is immediately returned. When `f` isn't provided, it is\n// treated as the identity function (the prop value is returned\n// directly).\nEditorView.prototype.someProp = function someProp (propName, f) {\n  var prop = this._props && this._props[propName], value;\n  if (prop != null && (value = f ? f(prop) : prop)) { return value }\n  var plugins = this.state.plugins;\n  if (plugins) { for (var i = 0; i < plugins.length; i++) {\n    var prop$1 = plugins[i].props[propName];\n    if (prop$1 != null && (value = f ? f(prop$1) : prop$1)) { return value }\n  } }\n};\n\n// :: () → bool\n// Query whether the view has focus.\nEditorView.prototype.hasFocus = function hasFocus () {\n  return this.root.activeElement == this.dom\n};\n\n// :: ()\n// Focus the editor.\nEditorView.prototype.focus = function focus () {\n  this.domObserver.stop();\n  if (this.editable) { focusPreventScroll(this.dom); }\n  selectionToDOM(this);\n  this.domObserver.start();\n};\n\n// :: union<dom.Document, dom.DocumentFragment>\n// Get the document root in which the editor exists. This will\n// usually be the top-level `document`, but might be a [shadow\n// DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM)\n// root if the editor is inside one.\nprototypeAccessors$2.root.get = function () {\n  var cached = this._root;\n  if (cached == null) { for (var search = this.dom.parentNode; search; search = search.parentNode) {\n    if (search.nodeType == 9 || (search.nodeType == 11 && search.host)) {\n      if (!search.getSelection) { Object.getPrototypeOf(search).getSelection = function () { return document.getSelection(); }; }\n      return this._root = search\n    }\n  } }\n  return cached || document\n};\n\n// :: ({left: number, top: number}) → ?{pos: number, inside: number}\n// Given a pair of viewport coordinates, return the document\n// position that corresponds to them. May return null if the given\n// coordinates aren't inside of the editor. When an object is\n// returned, its `pos` property is the position nearest to the\n// coordinates, and its `inside` property holds the position of the\n// inner node that the position falls inside of, or -1 if it is at\n// the top level, not in any node.\nEditorView.prototype.posAtCoords = function posAtCoords$1 (coords) {\n  return posAtCoords(this, coords)\n};\n\n// :: (number, number) → {left: number, right: number, top: number, bottom: number}\n// Returns the viewport rectangle at a given document position.\n// `left` and `right` will be the same number, as this returns a\n// flat cursor-ish rectangle. If the position is between two things\n// that aren't directly adjacent, `side` determines which element is\n// used. When < 0, the element before the position is used,\n// otherwise the element after.\nEditorView.prototype.coordsAtPos = function coordsAtPos$1 (pos, side) {\n    if ( side === void 0 ) side = 1;\n\n  return coordsAtPos(this, pos, side)\n};\n\n// :: (number, number) → {node: dom.Node, offset: number}\n// Find the DOM position that corresponds to the given document\n// position. When `side` is negative, find the position as close as\n// possible to the content before the position. When positive,\n// prefer positions close to the content after the position. When\n// zero, prefer as shallow a position as possible.\n//\n// Note that you should **not** mutate the editor's internal DOM,\n// only inspect it (and even that is usually not necessary).\nEditorView.prototype.domAtPos = function domAtPos (pos, side) {\n    if ( side === void 0 ) side = 0;\n\n  return this.docView.domFromPos(pos, side)\n};\n\n// :: (number) → ?dom.Node\n// Find the DOM node that represents the document node after the\n// given position. May return `null` when the position doesn't point\n// in front of a node or if the node is inside an opaque node view.\n//\n// This is intended to be able to call things like\n// `getBoundingClientRect` on that DOM node. Do **not** mutate the\n// editor DOM directly, or add styling this way, since that will be\n// immediately overriden by the editor as it redraws the node.\nEditorView.prototype.nodeDOM = function nodeDOM (pos) {\n  var desc = this.docView.descAt(pos);\n  return desc ? desc.nodeDOM : null\n};\n\n// :: (dom.Node, number, ?number) → number\n// Find the document position that corresponds to a given DOM\n// position. (Whenever possible, it is preferable to inspect the\n// document structure directly, rather than poking around in the\n// DOM, but sometimes—for example when interpreting an event\n// target—you don't have a choice.)\n//\n// The `bias` parameter can be used to influence which side of a DOM\n// node to use when the position is inside a leaf node.\nEditorView.prototype.posAtDOM = function posAtDOM (node, offset, bias) {\n    if ( bias === void 0 ) bias = -1;\n\n  var pos = this.docView.posFromDOM(node, offset, bias);\n  if (pos == null) { throw new RangeError(\"DOM position not inside the editor\") }\n  return pos\n};\n\n// :: (union<\"up\", \"down\", \"left\", \"right\", \"forward\", \"backward\">, ?EditorState) → bool\n// Find out whether the selection is at the end of a textblock when\n// moving in a given direction. When, for example, given `\"left\"`,\n// it will return true if moving left from the current cursor\n// position would leave that position's parent textblock. Will apply\n// to the view's current state by default, but it is possible to\n// pass a different state.\nEditorView.prototype.endOfTextblock = function endOfTextblock$1 (dir, state) {\n  return endOfTextblock(this, state || this.state, dir)\n};\n\n// :: ()\n// Removes the editor from the DOM and destroys all [node\n// views](#view.NodeView).\nEditorView.prototype.destroy = function destroy () {\n  if (!this.docView) { return }\n  destroyInput(this);\n  this.destroyPluginViews();\n  if (this.mounted) {\n    this.docView.update(this.state.doc, [], viewDecorations(this), this);\n    this.dom.textContent = \"\";\n  } else if (this.dom.parentNode) {\n    this.dom.parentNode.removeChild(this.dom);\n  }\n  this.docView.destroy();\n  this.docView = null;\n};\n\n// Used for testing.\nEditorView.prototype.dispatchEvent = function dispatchEvent$1 (event) {\n  return dispatchEvent(this, event)\n};\n\n// :: (Transaction)\n// Dispatch a transaction. Will call\n// [`dispatchTransaction`](#view.DirectEditorProps.dispatchTransaction)\n// when given, and otherwise defaults to applying the transaction to\n// the current state and calling\n// [`updateState`](#view.EditorView.updateState) with the result.\n// This method is bound to the view instance, so that it can be\n// easily passed around.\nEditorView.prototype.dispatch = function dispatch (tr) {\n  var dispatchTransaction = this._props.dispatchTransaction;\n  if (dispatchTransaction) { dispatchTransaction.call(this, tr); }\n  else { this.updateState(this.state.apply(tr)); }\n};\n\nObject.defineProperties( EditorView.prototype, prototypeAccessors$2 );\n\nfunction computeDocDeco(view) {\n  var attrs = Object.create(null);\n  attrs.class = \"ProseMirror\";\n  attrs.contenteditable = String(view.editable);\n\n  view.someProp(\"attributes\", function (value) {\n    if (typeof value == \"function\") { value = value(view.state); }\n    if (value) { for (var attr in value) {\n      if (attr == \"class\")\n        { attrs.class += \" \" + value[attr]; }\n      else if (!attrs[attr] && attr != \"contenteditable\" && attr != \"nodeName\")\n        { attrs[attr] = String(value[attr]); }\n    } }\n  });\n\n  return [Decoration.node(0, view.state.doc.content.size, attrs)]\n}\n\nfunction updateCursorWrapper(view) {\n  if (view.markCursor) {\n    var dom = document.createElement(\"img\");\n    dom.setAttribute(\"mark-placeholder\", \"true\");\n    view.cursorWrapper = {dom: dom, deco: Decoration.widget(view.state.selection.head, dom, {raw: true, marks: view.markCursor})};\n  } else {\n    view.cursorWrapper = null;\n  }\n}\n\nfunction getEditable(view) {\n  return !view.someProp(\"editable\", function (value) { return value(view.state) === false; })\n}\n\nfunction selectionContextChanged(sel1, sel2) {\n  var depth = Math.min(sel1.$anchor.sharedDepth(sel1.head), sel2.$anchor.sharedDepth(sel2.head));\n  return sel1.$anchor.start(depth) != sel2.$anchor.start(depth)\n}\n\nfunction buildNodeViews(view) {\n  var result = {};\n  view.someProp(\"nodeViews\", function (obj) {\n    for (var prop in obj) { if (!Object.prototype.hasOwnProperty.call(result, prop))\n      { result[prop] = obj[prop]; } }\n  });\n  return result\n}\n\nfunction changedNodeViews(a, b) {\n  var nA = 0, nB = 0;\n  for (var prop in a) {\n    if (a[prop] != b[prop]) { return true }\n    nA++;\n  }\n  for (var _ in b) { nB++; }\n  return nA != nB\n}\n\n// EditorProps:: interface\n//\n// Props are configuration values that can be passed to an editor view\n// or included in a plugin. This interface lists the supported props.\n//\n// The various event-handling functions may all return `true` to\n// indicate that they handled the given event. The view will then take\n// care to call `preventDefault` on the event, except with\n// `handleDOMEvents`, where the handler itself is responsible for that.\n//\n// How a prop is resolved depends on the prop. Handler functions are\n// called one at a time, starting with the base props and then\n// searching through the plugins (in order of appearance) until one of\n// them returns true. For some props, the first plugin that yields a\n// value gets precedence.\n//\n//   handleDOMEvents:: ?Object<(view: EditorView, event: dom.Event) → bool>\n//   Can be an object mapping DOM event type names to functions that\n//   handle them. Such functions will be called before any handling\n//   ProseMirror does of events fired on the editable DOM element.\n//   Contrary to the other event handling props, when returning true\n//   from such a function, you are responsible for calling\n//   `preventDefault` yourself (or not, if you want to allow the\n//   default behavior).\n//\n//   handleKeyDown:: ?(view: EditorView, event: dom.KeyboardEvent) → bool\n//   Called when the editor receives a `keydown` event.\n//\n//   handleKeyPress:: ?(view: EditorView, event: dom.KeyboardEvent) → bool\n//   Handler for `keypress` events.\n//\n//   handleTextInput:: ?(view: EditorView, from: number, to: number, text: string) → bool\n//   Whenever the user directly input text, this handler is called\n//   before the input is applied. If it returns `true`, the default\n//   behavior of actually inserting the text is suppressed.\n//\n//   handleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a click, from the inside out. The\n//   `direct` flag will be true for the inner node.\n//\n//   handleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is clicked, after `handleClickOn` handlers\n//   have been called.\n//\n//   handleDoubleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a double click.\n//\n//   handleDoubleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is double-clicked, after `handleDoubleClickOn`.\n//\n//   handleTripleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a triple click.\n//\n//   handleTripleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is triple-clicked, after `handleTripleClickOn`.\n//\n//   handlePaste:: ?(view: EditorView, event: dom.ClipboardEvent, slice: Slice) → bool\n//   Can be used to override the behavior of pasting. `slice` is the\n//   pasted content parsed by the editor, but you can directly access\n//   the event to get at the raw content.\n//\n//   handleDrop:: ?(view: EditorView, event: dom.Event, slice: Slice, moved: bool) → bool\n//   Called when something is dropped on the editor. `moved` will be\n//   true if this drop moves from the current selection (which should\n//   thus be deleted).\n//\n//   handleScrollToSelection:: ?(view: EditorView) → bool\n//   Called when the view, after updating its state, tries to scroll\n//   the selection into view. A handler function may return false to\n//   indicate that it did not handle the scrolling and further\n//   handlers or the default behavior should be tried.\n//\n//   createSelectionBetween:: ?(view: EditorView, anchor: ResolvedPos, head: ResolvedPos) → ?Selection\n//   Can be used to override the way a selection is created when\n//   reading a DOM selection between the given anchor and head.\n//\n//   domParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading editor changes\n//   from the DOM. Defaults to calling\n//   [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) on the\n//   editor's schema.\n//\n//   transformPastedHTML:: ?(html: string) → string\n//   Can be used to transform pasted HTML text, _before_ it is parsed,\n//   for example to clean it up.\n//\n//   clipboardParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading content from\n//   the clipboard. When not given, the value of the\n//   [`domParser`](#view.EditorProps.domParser) prop is used.\n//\n//   transformPastedText:: ?(text: string, plain: bool) → string\n//   Transform pasted plain text. The `plain` flag will be true when\n//   the text is pasted as plain text.\n//\n//   clipboardTextParser:: ?(text: string, $context: ResolvedPos, plain: bool) → Slice\n//   A function to parse text from the clipboard into a document\n//   slice. Called after\n//   [`transformPastedText`](#view.EditorProps.transformPastedText).\n//   The default behavior is to split the text into lines, wrap them\n//   in `<p>` tags, and call\n//   [`clipboardParser`](#view.EditorProps.clipboardParser) on it.\n//   The `plain` flag will be true when the text is pasted as plain text.\n//\n//   transformPasted:: ?(Slice) → Slice\n//   Can be used to transform pasted content before it is applied to\n//   the document.\n//\n//   nodeViews:: ?Object<(node: Node, view: EditorView, getPos: () → number, decorations: [Decoration]) → NodeView>\n//   Allows you to pass custom rendering and behavior logic for nodes\n//   and marks. Should map node and mark names to constructor\n//   functions that produce a [`NodeView`](#view.NodeView) object\n//   implementing the node's display behavior. For nodes, the third\n//   argument `getPos` is a function that can be called to get the\n//   node's current position, which can be useful when creating\n//   transactions to update it. For marks, the third argument is a\n//   boolean that indicates whether the mark's content is inline.\n//\n//   `decorations` is an array of node or inline decorations that are\n//   active around the node. They are automatically drawn in the\n//   normal way, and you will usually just want to ignore this, but\n//   they can also be used as a way to provide context information to\n//   the node view without adding it to the document itself.\n//\n//   clipboardSerializer:: ?DOMSerializer\n//   The DOM serializer to use when putting content onto the\n//   clipboard. If not given, the result of\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)\n//   will be used.\n//\n//   clipboardTextSerializer:: ?(Slice) → string\n//   A function that will be called to get the text for the current\n//   selection when copying text to the clipboard. By default, the\n//   editor will use [`textBetween`](#model.Node.textBetween) on the\n//   selected range.\n//\n//   decorations:: ?(state: EditorState) → ?DecorationSet\n//   A set of [document decorations](#view.Decoration) to show in the\n//   view.\n//\n//   editable:: ?(state: EditorState) → bool\n//   When this returns false, the content of the view is not directly\n//   editable.\n//\n//   attributes:: ?union<Object<string>, (EditorState) → ?Object<string>>\n//   Control the DOM attributes of the editable element. May be either\n//   an object or a function going from an editor state to an object.\n//   By default, the element will get a class `\"ProseMirror\"`, and\n//   will have its `contentEditable` attribute determined by the\n//   [`editable` prop](#view.EditorProps.editable). Additional classes\n//   provided here will be added to the class. For other attributes,\n//   the value provided first (as in\n//   [`someProp`](#view.EditorView.someProp)) will be used.\n//\n//   scrollThreshold:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the distance (in pixels) between the cursor and the\n//   end of the visible viewport at which point, when scrolling the\n//   cursor into view, scrolling takes place. Defaults to 0.\n//\n//   scrollMargin:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the extra space (in pixels) that is left above or\n//   below the cursor when it is scrolled into view. Defaults to 5.\n\n// DirectEditorProps:: interface extends EditorProps\n//\n// The props object given directly to the editor view supports two\n// fields that can't be used in plugins:\n//\n//   state:: EditorState\n//   The current state of the editor.\n//\n//   dispatchTransaction:: ?(tr: Transaction)\n//   The callback over which to send transactions (state updates)\n//   produced by the view. If you specify this, you probably want to\n//   make sure this ends up calling the view's\n//   [`updateState`](#view.EditorView.updateState) method with a new\n//   state that has the transaction\n//   [applied](#state.EditorState.apply). The callback will be bound to have\n//   the view instance as its `this` binding.\n\nexport { Decoration, DecorationSet, EditorView, endComposition as __endComposition, parseFromClipboard as __parseFromClipboard, serializeForClipboard as __serializeForClipboard };\n//# sourceMappingURL=index.es.js.map\n"],"sourceRoot":""}