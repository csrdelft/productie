{"version":3,"sources":["webpack:///./js/lib/grafiek.ts","webpack:////home/runner/work/csrdelft.nl/csrdelft.nl/.yarn/cache/moment-npm-2.27.0-0e670d438d-72d9a7d8db.zip/node_modules/moment/locale|sync|/[/\\\\](nl(\\.js)"],"names":["createCanvas","parent","canvas","appendChild","initPie","el","stringData","dataset","data","Error","JSON","parse","defaultKleuren","type","async","initLine","url","datasets","kleuren","length","Symbol","iterator","forEach","pointBorderColor","backgroundColor","borderColor","next","value","kleurPerDataset","options","scales","xAxes","stacked","time","tooltipFormat","yAxes","ticks","min","tooltips","intersect","mode","map","_a","_b","Object","assign","col","initBar","beginAtZero","stepSize","initDeelnamegrafiek","callback","t","index","jaren","callbacks","title","d","labels","String","initSaldoGrafiek","closed","uid","timespan","tooltipItem","datasetIndex","label","Number","yLabel","args","this","chart","reduce","mininum","p","y","max","maximum","yScale","getScaleForId","getMeta","yAxisID","top","getPixelForValue","zero","bottom","gradient","ctx","createLinearGradient","ratio","Math","addColorStop","load","then","response","update","querySelector","terugButton","addEventListener","button","e","preventDefault","classList","remove","parentElement","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","code","keys","resolve","module","exports"],"mappings":"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","file":"js/grafiek.2058ffefa40429346551.chunk.js","sourcesContent":["import axios from 'axios';\nimport Chart from 'chart.js';\nimport palette from 'google-palette';\nimport { formatBedrag, html } from './util';\nfunction createCanvas(parent) {\n    const canvas = html `<canvas style=\"width: 100%; height: 100%\"/>`;\n    parent.appendChild(canvas);\n    return canvas;\n}\nexport function initPie(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initPie: element heeft geen data-data\");\n    }\n    let data = JSON.parse(stringData);\n    data = defaultKleuren(data);\n    return new Chart(createCanvas(el), { data, type: 'pie' });\n}\nexport async function initLine(el) {\n    let data;\n    if (el.dataset.data) {\n        data = JSON.parse(el.dataset.data);\n    }\n    else if (el.dataset.url) {\n        data = (await axios.post(el.dataset.url)).data;\n    }\n    else {\n        throw new Error('Hier kan ik niets mee');\n    }\n    data = kleurPerDataset(data);\n    return new Chart(createCanvas(el), {\n        data,\n        options: {\n            scales: {\n                xAxes: [{\n                        stacked: true,\n                        time: {\n                            tooltipFormat: 'D MMM H:mm ',\n                        },\n                        type: 'time',\n                    }],\n                yAxes: [{\n                        stacked: true,\n                        ticks: {\n                            min: 0,\n                        },\n                    }],\n            },\n            tooltips: {\n                intersect: false,\n                mode: 'index',\n            },\n        },\n        type: 'line',\n    });\n}\nfunction kleurPerDataset(data) {\n    const datasets = data.datasets;\n    if (!datasets) {\n        throw new Error(\"Data heeft geen datasets\");\n    }\n    const kleuren = palette(['tol', 'qualitative'], datasets.length)[Symbol.iterator]();\n    datasets.forEach((dataset) => {\n        dataset.pointBorderColor = dataset.backgroundColor = dataset.borderColor = `#${kleuren.next().value}`;\n    });\n    return data;\n}\nfunction defaultKleuren(data) {\n    const datasets = data.datasets;\n    if (!datasets) {\n        throw new Error(\"Data heeft geen datasets\");\n    }\n    data.datasets = datasets\n        .map((dataset) => {\n        var _a, _b;\n        return (Object.assign({ backgroundColor: palette('tol-rainbow', (_b = (_a = dataset.data) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0).map((col) => `#${col}`) }, dataset));\n    });\n    return data;\n}\nexport function initBar(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initBar: geen data-data attribuut\");\n    }\n    let data = JSON.parse(stringData);\n    data = defaultKleuren(data);\n    const options = {\n        scales: {\n            yAxes: [{\n                    ticks: {\n                        beginAtZero: true,\n                        stepSize: 1,\n                    },\n                }],\n        },\n    };\n    return new Chart(createCanvas(el), { data, type: 'bar', options });\n}\nexport function initDeelnamegrafiek(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initBar: geen data-data attribuut\");\n    }\n    const data = JSON.parse(stringData);\n    const options = {\n        scales: {\n            xAxes: [{\n                    stacked: true,\n                    ticks: {\n                        callback: (t, index) => data.jaren[index],\n                    },\n                }],\n            yAxes: [{\n                    stacked: true,\n                    ticks: {\n                        stepSize: 1,\n                    },\n                }],\n        },\n        tooltips: {\n            callbacks: {\n                title: (t, d) => {\n                    const labels = d.labels;\n                    const index = t[0].index;\n                    if (!labels || !index) {\n                        throw new Error(\"Data heeft geen labels of index\");\n                    }\n                    return String(labels[index]);\n                },\n            },\n            intersect: false,\n            mode: 'index',\n        },\n    };\n    return new Chart(createCanvas(el), { data, type: 'bar', options });\n}\nfunction createNegativetransparentLineChartController() {\n    if (Chart.defaults.NegativeTransparentLine) {\n        return;\n    }\n    Chart.defaults.NegativeTransparentLine = Chart.helpers.clone(Chart.defaults.line);\n    Chart.controllers.NegativeTransparentLine = Chart.controllers.line.extend({\n        update(...args) {\n            if (this.chart.data.datasets.length) {\n                // get the min and max values\n                const min = this.chart.data.datasets[0].data\n                    .reduce((mininum, p) => p.y < mininum ? p.y : mininum, this.chart.data.datasets[0].data[0].y);\n                if (min >= 0) {\n                    this.chart.data.datasets[0].borderColor = 'green';\n                    return Chart.controllers.line.prototype.update.apply(this, args);\n                }\n                const max = this.chart.data.datasets[0].data\n                    .reduce((maximum, p) => p.y > maximum ? p.y : maximum, this.chart.data.datasets[0].data[0].y);\n                if (max <= 0) {\n                    this.chart.data.datasets[0].borderColor = 'red';\n                    return Chart.controllers.line.prototype.update.apply(this, args);\n                }\n                const yScale = this.getScaleForId(this.getMeta().yAxisID);\n                // figure out the pixels for these and the value 0\n                const top = yScale.getPixelForValue(max);\n                const zero = yScale.getPixelForValue(0);\n                const bottom = yScale.getPixelForValue(min);\n                // build a gradient that switches color at the 0 point\n                const context = this.chart.chart.ctx;\n                const gradient = context.createLinearGradient(0, top, 0, bottom);\n                const ratio = Math.min((zero - top) / (bottom - top), 1);\n                gradient.addColorStop(0, 'green');\n                gradient.addColorStop(ratio, 'green');\n                gradient.addColorStop(ratio, 'red');\n                gradient.addColorStop(1, 'red');\n                this.chart.data.datasets[0].borderColor = gradient;\n            }\n            // noinspection JSPotentiallyInvalidConstructorUsage\n            return Chart.controllers.line.prototype.update.apply(this, args);\n        },\n    });\n}\nexport function initSaldoGrafiek(el) {\n    const closed = el.dataset.closed === 'true';\n    const uid = el.dataset.uid;\n    if (!uid) {\n        throw new Error(\"Saldografiek heeft geen uid\");\n    }\n    let timespan = 11;\n    const options = {\n        scales: {\n            xAxes: [{\n                    time: {\n                        tooltipFormat: 'LLL',\n                    },\n                    type: 'time',\n                }],\n            yAxes: [{\n                    ticks: {\n                        callback: formatBedrag,\n                    },\n                }],\n        },\n        tooltips: {\n            callbacks: {\n                label(tooltipItem, data) {\n                    const datasets = data.datasets;\n                    const datasetIndex = tooltipItem.datasetIndex;\n                    if (!datasets || !datasetIndex) {\n                        throw new Error(\"Saldografiek heeft geen datasets\");\n                    }\n                    const datasetLabel = datasets[datasetIndex].label || '';\n                    return datasetLabel + ': ' + formatBedrag(Number(tooltipItem.yLabel));\n                },\n            },\n        },\n    };\n    createNegativetransparentLineChartController();\n    const chart = new Chart(createCanvas(el), { data: {}, type: 'NegativeTransparentLine', options });\n    function load() {\n        axios.post(`/profiel/${uid}/saldo/${timespan}`)\n            .then((response) => {\n            chart.data = response.data;\n            chart.update();\n        });\n        if (!el.querySelector('.saldo-terug-button')) {\n            const terugButton = html `<a title=\"verder terug in de tijd\" class=\"saldo-terug-button\">&laquo;</a>`;\n            el.appendChild(terugButton);\n            terugButton.addEventListener('click', () => {\n                timespan = timespan * 2;\n                if (timespan > (15 * 356)) {\n                    return;\n                }\n                load();\n            });\n        }\n    }\n    if (closed) {\n        const button = html `<a href=\"#\" class=\"btn btn-primary\">Toon saldografiek</a>`;\n        button.addEventListener('click', (e) => {\n            e.preventDefault();\n            el.classList.remove('verborgen');\n            button.remove();\n            load();\n        });\n        const parent = el.parentElement;\n        if (!parent) {\n            throw new Error(\"Saldografiek geen onderdeel van DOM\");\n        }\n        parent.appendChild(button);\n    }\n    else {\n        el.classList.remove('verborgen');\n        load();\n    }\n}\n","var map = {\n\t\"./nl\": 4273,\n\t\"./nl.js\": 4273\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 4734;"],"sourceRoot":""}