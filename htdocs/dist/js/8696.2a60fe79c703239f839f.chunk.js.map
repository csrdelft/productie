{"version":3,"sources":["webpack:///./js/lib/domUpdate.ts","webpack:///./js/lib/fotoalbum/with-admin-buttons.ts","webpack:///./js/lib/modal.ts","webpack:///./js/lib/reload.ts"],"names":["domUpdate","htmlString","trim","substring","alert","Error","elements","element","HTMLElement","id","parentId","getAttribute","HTMLScriptElement","eval","innerText","target","document","querySelector","targetParent","classList","contains","replaceWith","append","head","constructor","albums","params","super","this","root","container","style","color","backgroundColor","background","textColor","transform","content","addEventListener","dropdown","display","rotateClockwiseButton","padding","url","getUrl","foto","rotation","then","rotateCounterClockwiseButton","setCoverButton","resp","data","deleteButton","confirm","decodeURI","flexDirection","left","position","top","whiteSpace","children","appendChild","appendControlsElements","item","currentItem","goToItem","fullUrl","replace","modalOpen","_a","_b","modalEl","getElementById","modal","Modal","modalBackdrop","innerHTML","length","remove","Array","from","querySelectorAll","find","el","window","getComputedStyle","dispatchEvent","FocusEvent","show","Event","modalClose","hide","reload","location","redirect","href"],"mappings":"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","file":"js/8696.2a60fe79c703239f839f.chunk.js","sourcesContent":["import $ from 'jquery';\nimport { init } from '../ctx';\nimport { modalClose, modalOpen } from './modal';\nimport { fadeAway, htmlParse } from './util';\nimport { select } from \"./dom\";\nexport function domUpdate(htmlString) {\n    if (typeof htmlString !== 'string') {\n        return;\n    }\n    htmlString = htmlString.trim();\n    if (htmlString.substring(0, 9) === '<!DOCTYPE') {\n        alert('response error');\n        throw new Error(htmlString);\n    }\n    const elements = htmlParse(htmlString);\n    for (const element of elements) {\n        if (!(element instanceof HTMLElement)) {\n            // element kan ook een stuk tekst zijn, hier kunnen we niets mee.\n            continue;\n        }\n        const id = element.id;\n        const parentId = element.getAttribute('parentid');\n        if (!id && element instanceof HTMLScriptElement) {\n            eval(element.innerText);\n            modalClose();\n            return;\n        }\n        // Probeer niet een lege id te laden.\n        const target = id ? document.querySelector(`#${id}`) : null;\n        const targetParent = parentId ? document.querySelector(`#${parentId}`) : null;\n        if (target) {\n            if (element.classList.contains('remove')) {\n                fadeAway(target, 400);\n            }\n            else {\n                // Jquery voert ook js uit, dat is nodig op dit moment voor forms\n                $(target).replaceWith($(element));\n            }\n        }\n        else if (targetParent) {\n            targetParent.append(element);\n        }\n        else if (element instanceof HTMLScriptElement) {\n            document.head.append(element);\n        }\n        else {\n            select('#maalcie-tabel tbody:visible:first').append(element); // FIXME: make generic\n        }\n        init(element);\n        if (id === 'modal') {\n            modalOpen();\n        }\n        else {\n            modalClose();\n        }\n    }\n}\n","import axios from 'axios';\nimport createElement from 'jgallery/src/utils/create-element';\nimport withTooltip from 'jgallery/src/utils/with-tooltip';\nimport { redirect, reload } from '../reload';\nimport { basename, dirname } from '../util';\nconst withAdminButtons = (constructor) => class extends constructor {\n    constructor(albums, params) {\n        super(albums, params);\n        this.root = params.root || '';\n        const container = withTooltip(createElement('<span class=\"j-gallery-icon\"><i class=\"fa fa-wrench\"></i></span>'), {\n            style: {\n                color: params.backgroundColor,\n                background: params.textColor,\n                transform: 'translateY(-8px)',\n            },\n            content: 'Beheer',\n        });\n        container.addEventListener('click', () => {\n            dropdown.style.display = 'flex';\n        });\n        container.addEventListener('mouseleave', () => {\n            dropdown.style.display = 'none';\n        });\n        const rotateClockwiseButton = createElement(`<div><i class=\"fa fa-redo\"></i>&nbsp;Draai met de klok mee</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        rotateClockwiseButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/roteren' + dirname(url), {\n                foto: basename(url),\n                rotation: 90,\n            }).then(reload);\n        });\n        const rotateCounterClockwiseButton = createElement(`<div><i class=\"fa fa-undo\"></i>&nbsp;Draai tegen de klok in</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        rotateCounterClockwiseButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/roteren' + dirname(url), {\n                foto: basename(url),\n                rotation: -90,\n            }).then(reload);\n        });\n        const setCoverButton = createElement(`<div><i class=\"fa fa-folder\"></i>&nbsp;Instellen als albumcover</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        setCoverButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/albumcover' + dirname(url), {\n                foto: basename(url),\n            }).then((resp) => redirect(resp.data));\n        });\n        const deleteButton = createElement(`<div><i class=\"fa fa-times\"></i>&nbsp;Verwijderen</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        deleteButton.addEventListener('click', () => {\n            if (!confirm('Foto definitief verwijderen. Weet u het zeker?')) {\n                return false;\n            }\n            const url = this.getUrl();\n            axios.post('/fotoalbum/verwijderen' + dirname(url), {\n                foto: decodeURI(basename(url)),\n            }).then(reload);\n        });\n        const dropdown = createElement('<div class=\"j-gallery-dropdown\"></div>', {\n            style: {\n                background: params.backgroundColor,\n                display: 'none',\n                flexDirection: 'column',\n                left: '0',\n                position: 'absolute',\n                top: '0',\n                whiteSpace: 'nowrap',\n            },\n            children: [rotateClockwiseButton, rotateCounterClockwiseButton, setCoverButton, deleteButton],\n        });\n        container.appendChild(dropdown);\n        this.appendControlsElements([container]);\n    }\n    goToItem(item) {\n        this.currentItem = item;\n        return super.goToItem(item);\n    }\n    getUrl() {\n        return this.currentItem.fullUrl.replace(this.root, '');\n    }\n};\nexport default withAdminButtons;\n","import $ from 'jquery';\nimport { Modal } from \"bootstrap\";\nexport function modalOpen(htmlString = '') {\n    var _a, _b;\n    const modalEl = document.getElementById(\"modal\");\n    const modal = (_a = Modal.getInstance(modalEl)) !== null && _a !== void 0 ? _a : new Modal(modalEl);\n    const modalBackdrop = $('.modal-backdrop');\n    if (modalEl.innerHTML === '' && htmlString === '') {\n        return false;\n    }\n    if (modalBackdrop.length) {\n        modalBackdrop.remove();\n    }\n    if (htmlString !== '') {\n        modalEl.replaceWith(htmlString);\n        (_b = Array.from(modalEl.querySelectorAll('input'))\n            .find(el => window.getComputedStyle(el).display != 'none')) === null || _b === void 0 ? void 0 : _b.dispatchEvent(new FocusEvent('focus'));\n    }\n    modal.show();\n    document.dispatchEvent(new Event('modalOpen'));\n    return true;\n}\nexport function modalClose() {\n    const modal = Modal.getInstance(document.getElementById(\"modal\"));\n    if (modal) {\n        modal.hide();\n    }\n    document.dispatchEvent(new Event('modalClose'));\n}\n","import { domUpdate } from './domUpdate';\nexport function reload(htmlString) {\n    if (typeof htmlString === 'string' && htmlString.substring(0, 16) === '<div id=\"modal\" ') {\n        domUpdate(htmlString);\n        return;\n    }\n    location.reload();\n}\nexport function redirect(htmlString) {\n    if (htmlString.substring(0, 16) === '<div id=\"modal\" ') {\n        domUpdate(htmlString);\n        return;\n    }\n    window.location.href = htmlString;\n}\n"],"sourceRoot":""}