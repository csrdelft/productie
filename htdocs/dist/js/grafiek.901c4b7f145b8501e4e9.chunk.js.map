{"version":3,"sources":["webpack:///../.yarn/cache/moment-npm-2.27.0-0e670d438d-72d9a7d8db.zip/node_modules/moment/locale sync [/\\\\](nl(\\.js)","webpack:///./js/lib/grafiek.ts"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","createCanvas","parent","canvas","appendChild","initPie","el","stringData","dataset","data","JSON","parse","defaultKleuren","type","async","initLine","url","a","post","datasets","kleuren","length","Symbol","iterator","forEach","pointBorderColor","backgroundColor","borderColor","next","value","kleurPerDataset","options","scales","xAxes","stacked","time","tooltipFormat","yAxes","ticks","min","tooltips","intersect","mode","_a","_b","assign","col","initBar","beginAtZero","stepSize","initDeelnamegrafiek","callback","t","index","jaren","callbacks","title","d","labels","String","initSaldoGrafiek","closed","uid","timespan","tooltipItem","datasetIndex","label","Number","yLabel","defaults","NegativeTransparentLine","helpers","clone","line","controllers","extend","args","this","chart","reduce","mininum","p","y","prototype","update","apply","max","maximum","yScale","getScaleForId","getMeta","yAxisID","top","getPixelForValue","zero","bottom","gradient","ctx","createLinearGradient","ratio","Math","addColorStop","load","then","response","querySelector","terugButton","addEventListener","button","preventDefault","classList","remove","parentElement"],"mappings":"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","file":"js/grafiek.901c4b7f145b8501e4e9.chunk.js","sourcesContent":["var map = {\n\t\"./nl\": 97,\n\t\"./nl.js\": 97\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 134;","import axios from 'axios';\nimport Chart from 'chart.js';\nimport palette from 'google-palette';\nimport { formatBedrag, html } from './util';\nfunction createCanvas(parent) {\n    const canvas = html `<canvas style=\"width: 100%; height: 100%\"/>`;\n    parent.appendChild(canvas);\n    return canvas;\n}\nexport function initPie(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initPie: element heeft geen data-data\");\n    }\n    let data = JSON.parse(stringData);\n    data = defaultKleuren(data);\n    return new Chart(createCanvas(el), { data, type: 'pie' });\n}\nexport async function initLine(el) {\n    let data;\n    if (el.dataset.data) {\n        data = JSON.parse(el.dataset.data);\n    }\n    else if (el.dataset.url) {\n        data = (await axios.post(el.dataset.url)).data;\n    }\n    else {\n        throw new Error('Hier kan ik niets mee');\n    }\n    data = kleurPerDataset(data);\n    return new Chart(createCanvas(el), {\n        data,\n        options: {\n            scales: {\n                xAxes: [{\n                        stacked: true,\n                        time: {\n                            tooltipFormat: 'D MMM H:mm ',\n                        },\n                        type: 'time',\n                    }],\n                yAxes: [{\n                        stacked: true,\n                        ticks: {\n                            min: 0,\n                        },\n                    }],\n            },\n            tooltips: {\n                intersect: false,\n                mode: 'index',\n            },\n        },\n        type: 'line',\n    });\n}\nfunction kleurPerDataset(data) {\n    const datasets = data.datasets;\n    if (!datasets) {\n        throw new Error(\"Data heeft geen datasets\");\n    }\n    const kleuren = palette(['tol', 'qualitative'], datasets.length)[Symbol.iterator]();\n    datasets.forEach((dataset) => {\n        dataset.pointBorderColor = dataset.backgroundColor = dataset.borderColor = `#${kleuren.next().value}`;\n    });\n    return data;\n}\nfunction defaultKleuren(data) {\n    const datasets = data.datasets;\n    if (!datasets) {\n        throw new Error(\"Data heeft geen datasets\");\n    }\n    data.datasets = datasets\n        .map((dataset) => {\n        var _a, _b;\n        return (Object.assign({ backgroundColor: palette('tol-rainbow', (_b = (_a = dataset.data) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0).map((col) => `#${col}`) }, dataset));\n    });\n    return data;\n}\nexport function initBar(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initBar: geen data-data attribuut\");\n    }\n    let data = JSON.parse(stringData);\n    data = defaultKleuren(data);\n    const options = {\n        scales: {\n            yAxes: [{\n                    ticks: {\n                        beginAtZero: true,\n                        stepSize: 1,\n                    },\n                }],\n        },\n    };\n    return new Chart(createCanvas(el), { data, type: 'bar', options });\n}\nexport function initDeelnamegrafiek(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initBar: geen data-data attribuut\");\n    }\n    const data = JSON.parse(stringData);\n    const options = {\n        scales: {\n            xAxes: [{\n                    stacked: true,\n                    ticks: {\n                        callback: (t, index) => data.jaren[index],\n                    },\n                }],\n            yAxes: [{\n                    stacked: true,\n                    ticks: {\n                        stepSize: 1,\n                    },\n                }],\n        },\n        tooltips: {\n            callbacks: {\n                title: (t, d) => {\n                    const labels = d.labels;\n                    const index = t[0].index;\n                    if (!labels || !index) {\n                        throw new Error(\"Data heeft geen labels of index\");\n                    }\n                    return String(labels[index]);\n                },\n            },\n            intersect: false,\n            mode: 'index',\n        },\n    };\n    return new Chart(createCanvas(el), { data, type: 'bar', options });\n}\nfunction createNegativetransparentLineChartController() {\n    if (Chart.defaults.NegativeTransparentLine) {\n        return;\n    }\n    Chart.defaults.NegativeTransparentLine = Chart.helpers.clone(Chart.defaults.line);\n    Chart.controllers.NegativeTransparentLine = Chart.controllers.line.extend({\n        update(...args) {\n            if (this.chart.data.datasets.length) {\n                // get the min and max values\n                const min = this.chart.data.datasets[0].data\n                    .reduce((mininum, p) => p.y < mininum ? p.y : mininum, this.chart.data.datasets[0].data[0].y);\n                if (min >= 0) {\n                    this.chart.data.datasets[0].borderColor = 'green';\n                    return Chart.controllers.line.prototype.update.apply(this, args);\n                }\n                const max = this.chart.data.datasets[0].data\n                    .reduce((maximum, p) => p.y > maximum ? p.y : maximum, this.chart.data.datasets[0].data[0].y);\n                if (max <= 0) {\n                    this.chart.data.datasets[0].borderColor = 'red';\n                    return Chart.controllers.line.prototype.update.apply(this, args);\n                }\n                const yScale = this.getScaleForId(this.getMeta().yAxisID);\n                // figure out the pixels for these and the value 0\n                const top = yScale.getPixelForValue(max);\n                const zero = yScale.getPixelForValue(0);\n                const bottom = yScale.getPixelForValue(min);\n                // build a gradient that switches color at the 0 point\n                const context = this.chart.chart.ctx;\n                const gradient = context.createLinearGradient(0, top, 0, bottom);\n                const ratio = Math.min((zero - top) / (bottom - top), 1);\n                gradient.addColorStop(0, 'green');\n                gradient.addColorStop(ratio, 'green');\n                gradient.addColorStop(ratio, 'red');\n                gradient.addColorStop(1, 'red');\n                this.chart.data.datasets[0].borderColor = gradient;\n            }\n            // noinspection JSPotentiallyInvalidConstructorUsage\n            return Chart.controllers.line.prototype.update.apply(this, args);\n        },\n    });\n}\nexport function initSaldoGrafiek(el) {\n    const closed = el.dataset.closed === 'true';\n    const uid = el.dataset.uid;\n    if (!uid) {\n        throw new Error(\"Saldografiek heeft geen uid\");\n    }\n    let timespan = 11;\n    const options = {\n        scales: {\n            xAxes: [{\n                    time: {\n                        tooltipFormat: 'LLL',\n                    },\n                    type: 'time',\n                }],\n            yAxes: [{\n                    ticks: {\n                        callback: formatBedrag,\n                    },\n                }],\n        },\n        tooltips: {\n            callbacks: {\n                label(tooltipItem, data) {\n                    const datasets = data.datasets;\n                    const datasetIndex = tooltipItem.datasetIndex;\n                    if (!datasets || !datasetIndex) {\n                        throw new Error(\"Saldografiek heeft geen datasets\");\n                    }\n                    const datasetLabel = datasets[datasetIndex].label || '';\n                    return datasetLabel + ': ' + formatBedrag(Number(tooltipItem.yLabel));\n                },\n            },\n        },\n    };\n    createNegativetransparentLineChartController();\n    const chart = new Chart(createCanvas(el), { data: {}, type: 'NegativeTransparentLine', options });\n    function load() {\n        axios.post(`/profiel/${uid}/saldo/${timespan}`)\n            .then((response) => {\n            chart.data = response.data;\n            chart.update();\n        });\n        if (!el.querySelector('.saldo-terug-button')) {\n            const terugButton = html `<a title=\"verder terug in de tijd\" class=\"saldo-terug-button\">&laquo;</a>`;\n            el.appendChild(terugButton);\n            terugButton.addEventListener('click', () => {\n                timespan = timespan * 2;\n                if (timespan > (15 * 356)) {\n                    return;\n                }\n                load();\n            });\n        }\n    }\n    if (closed) {\n        const button = html `<a href=\"#\" class=\"btn btn-primary\">Toon saldografiek</a>`;\n        button.addEventListener('click', (e) => {\n            e.preventDefault();\n            el.classList.remove('verborgen');\n            button.remove();\n            load();\n        });\n        const parent = el.parentElement;\n        if (!parent) {\n            throw new Error(\"Saldografiek geen onderdeel van DOM\");\n        }\n        parent.appendChild(button);\n    }\n    else {\n        el.classList.remove('verborgen');\n        load();\n    }\n}\n"],"sourceRoot":""}