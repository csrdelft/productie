{"version":3,"sources":["webpack:///./js/lib/grafiek.ts","webpack:///../.yarn/cache/moment-npm-2.27.0-0e670d438d-72d9a7d8db.zip/node_modules/moment/locale sync [/\\\\](nl(\\.js)"],"names":["createCanvas","parent","canvas","appendChild","initPie","el","stringData","dataset","data","Error","JSON","parse","defaultKleuren","type","async","initLine","url","a","post","datasets","kleuren","length","Symbol","iterator","forEach","pointBorderColor","backgroundColor","borderColor","next","value","kleurPerDataset","options","scales","xAxes","stacked","time","tooltipFormat","yAxes","ticks","min","tooltips","intersect","mode","map","_a","_b","Object","assign","col","initBar","beginAtZero","stepSize","initDeelnamegrafiek","callback","t","index","jaren","callbacks","title","d","labels","String","initSaldoGrafiek","closed","uid","timespan","tooltipItem","datasetIndex","label","Number","yLabel","defaults","NegativeTransparentLine","helpers","clone","line","controllers","extend","args","this","chart","reduce","mininum","p","y","prototype","update","apply","max","maximum","yScale","getScaleForId","getMeta","yAxisID","top","getPixelForValue","zero","bottom","gradient","ctx","createLinearGradient","ratio","Math","addColorStop","load","then","response","querySelector","terugButton","addEventListener","button","e","preventDefault","classList","remove","parentElement","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","code","keys","resolve","module","exports"],"mappings":"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","file":"js/grafiek.d40733ab393271588cde.chunk.js","sourcesContent":["import axios from 'axios';\nimport Chart from 'chart.js';\nimport palette from 'google-palette';\nimport { formatBedrag, html } from './util';\nfunction createCanvas(parent) {\n    const canvas = html `<canvas style=\"width: 100%; height: 100%\"/>`;\n    parent.appendChild(canvas);\n    return canvas;\n}\nexport function initPie(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initPie: element heeft geen data-data\");\n    }\n    let data = JSON.parse(stringData);\n    data = defaultKleuren(data);\n    return new Chart(createCanvas(el), { data, type: 'pie' });\n}\nexport async function initLine(el) {\n    let data;\n    if (el.dataset.data) {\n        data = JSON.parse(el.dataset.data);\n    }\n    else if (el.dataset.url) {\n        data = (await axios.post(el.dataset.url)).data;\n    }\n    else {\n        throw new Error('Hier kan ik niets mee');\n    }\n    data = kleurPerDataset(data);\n    return new Chart(createCanvas(el), {\n        data,\n        options: {\n            scales: {\n                xAxes: [{\n                        stacked: true,\n                        time: {\n                            tooltipFormat: 'D MMM H:mm ',\n                        },\n                        type: 'time',\n                    }],\n                yAxes: [{\n                        stacked: true,\n                        ticks: {\n                            min: 0,\n                        },\n                    }],\n            },\n            tooltips: {\n                intersect: false,\n                mode: 'index',\n            },\n        },\n        type: 'line',\n    });\n}\nfunction kleurPerDataset(data) {\n    const datasets = data.datasets;\n    if (!datasets) {\n        throw new Error(\"Data heeft geen datasets\");\n    }\n    const kleuren = palette(['tol', 'qualitative'], datasets.length)[Symbol.iterator]();\n    datasets.forEach((dataset) => {\n        dataset.pointBorderColor = dataset.backgroundColor = dataset.borderColor = `#${kleuren.next().value}`;\n    });\n    return data;\n}\nfunction defaultKleuren(data) {\n    const datasets = data.datasets;\n    if (!datasets) {\n        throw new Error(\"Data heeft geen datasets\");\n    }\n    data.datasets = datasets\n        .map((dataset) => {\n        var _a, _b;\n        return (Object.assign({ backgroundColor: palette('tol-rainbow', (_b = (_a = dataset.data) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0).map((col) => `#${col}`) }, dataset));\n    });\n    return data;\n}\nexport function initBar(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initBar: geen data-data attribuut\");\n    }\n    let data = JSON.parse(stringData);\n    data = defaultKleuren(data);\n    const options = {\n        scales: {\n            yAxes: [{\n                    ticks: {\n                        beginAtZero: true,\n                        stepSize: 1,\n                    },\n                }],\n        },\n    };\n    return new Chart(createCanvas(el), { data, type: 'bar', options });\n}\nexport function initDeelnamegrafiek(el) {\n    const stringData = el.dataset.data;\n    if (!stringData) {\n        throw new Error(\"initBar: geen data-data attribuut\");\n    }\n    const data = JSON.parse(stringData);\n    const options = {\n        scales: {\n            xAxes: [{\n                    stacked: true,\n                    ticks: {\n                        callback: (t, index) => data.jaren[index],\n                    },\n                }],\n            yAxes: [{\n                    stacked: true,\n                    ticks: {\n                        stepSize: 1,\n                    },\n                }],\n        },\n        tooltips: {\n            callbacks: {\n                title: (t, d) => {\n                    const labels = d.labels;\n                    const index = t[0].index;\n                    if (!labels || !index) {\n                        throw new Error(\"Data heeft geen labels of index\");\n                    }\n                    return String(labels[index]);\n                },\n            },\n            intersect: false,\n            mode: 'index',\n        },\n    };\n    return new Chart(createCanvas(el), { data, type: 'bar', options });\n}\nfunction createNegativetransparentLineChartController() {\n    if (Chart.defaults.NegativeTransparentLine) {\n        return;\n    }\n    Chart.defaults.NegativeTransparentLine = Chart.helpers.clone(Chart.defaults.line);\n    Chart.controllers.NegativeTransparentLine = Chart.controllers.line.extend({\n        update(...args) {\n            if (this.chart.data.datasets.length) {\n                // get the min and max values\n                const min = this.chart.data.datasets[0].data\n                    .reduce((mininum, p) => p.y < mininum ? p.y : mininum, this.chart.data.datasets[0].data[0].y);\n                if (min >= 0) {\n                    this.chart.data.datasets[0].borderColor = 'green';\n                    return Chart.controllers.line.prototype.update.apply(this, args);\n                }\n                const max = this.chart.data.datasets[0].data\n                    .reduce((maximum, p) => p.y > maximum ? p.y : maximum, this.chart.data.datasets[0].data[0].y);\n                if (max <= 0) {\n                    this.chart.data.datasets[0].borderColor = 'red';\n                    return Chart.controllers.line.prototype.update.apply(this, args);\n                }\n                const yScale = this.getScaleForId(this.getMeta().yAxisID);\n                // figure out the pixels for these and the value 0\n                const top = yScale.getPixelForValue(max);\n                const zero = yScale.getPixelForValue(0);\n                const bottom = yScale.getPixelForValue(min);\n                // build a gradient that switches color at the 0 point\n                const context = this.chart.chart.ctx;\n                const gradient = context.createLinearGradient(0, top, 0, bottom);\n                const ratio = Math.min((zero - top) / (bottom - top), 1);\n                gradient.addColorStop(0, 'green');\n                gradient.addColorStop(ratio, 'green');\n                gradient.addColorStop(ratio, 'red');\n                gradient.addColorStop(1, 'red');\n                this.chart.data.datasets[0].borderColor = gradient;\n            }\n            // noinspection JSPotentiallyInvalidConstructorUsage\n            return Chart.controllers.line.prototype.update.apply(this, args);\n        },\n    });\n}\nexport function initSaldoGrafiek(el) {\n    const closed = el.dataset.closed === 'true';\n    const uid = el.dataset.uid;\n    if (!uid) {\n        throw new Error(\"Saldografiek heeft geen uid\");\n    }\n    let timespan = 11;\n    const options = {\n        scales: {\n            xAxes: [{\n                    time: {\n                        tooltipFormat: 'LLL',\n                    },\n                    type: 'time',\n                }],\n            yAxes: [{\n                    ticks: {\n                        callback: formatBedrag,\n                    },\n                }],\n        },\n        tooltips: {\n            callbacks: {\n                label(tooltipItem, data) {\n                    const datasets = data.datasets;\n                    const datasetIndex = tooltipItem.datasetIndex;\n                    if (!datasets || !datasetIndex) {\n                        throw new Error(\"Saldografiek heeft geen datasets\");\n                    }\n                    const datasetLabel = datasets[datasetIndex].label || '';\n                    return datasetLabel + ': ' + formatBedrag(Number(tooltipItem.yLabel));\n                },\n            },\n        },\n    };\n    createNegativetransparentLineChartController();\n    const chart = new Chart(createCanvas(el), { data: {}, type: 'NegativeTransparentLine', options });\n    function load() {\n        axios.post(`/profiel/${uid}/saldo/${timespan}`)\n            .then((response) => {\n            chart.data = response.data;\n            chart.update();\n        });\n        if (!el.querySelector('.saldo-terug-button')) {\n            const terugButton = html `<a title=\"verder terug in de tijd\" class=\"saldo-terug-button\">&laquo;</a>`;\n            el.appendChild(terugButton);\n            terugButton.addEventListener('click', () => {\n                timespan = timespan * 2;\n                if (timespan > (15 * 356)) {\n                    return;\n                }\n                load();\n            });\n        }\n    }\n    if (closed) {\n        const button = html `<a href=\"#\" class=\"btn btn-primary\">Toon saldografiek</a>`;\n        button.addEventListener('click', (e) => {\n            e.preventDefault();\n            el.classList.remove('verborgen');\n            button.remove();\n            load();\n        });\n        const parent = el.parentElement;\n        if (!parent) {\n            throw new Error(\"Saldografiek geen onderdeel van DOM\");\n        }\n        parent.appendChild(button);\n    }\n    else {\n        el.classList.remove('verborgen');\n        load();\n    }\n}\n","var map = {\n\t\"./nl\": 78,\n\t\"./nl.js\": 78\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 93;"],"sourceRoot":""}