{"version":3,"sources":["webpack:///../.yarn/cache/moment-npm-2.27.0-0e670d438d-72d9a7d8db.zip/node_modules/moment/locale sync [/\\\\](nl(\\.js)","webpack:///./js/editor/schema/block-nodes.ts","webpack:///./js/editor/schema/index.ts","webpack:///./js/editor/schema/embed.ts","webpack:///./js/editor/prompt.ts","webpack:///./js/editor/bb-prompt.ts","webpack:///./js/editor/plugin/placeholder.ts","webpack:///./js/editor/forum-plaatje.ts","webpack:///./js/editor/menu-item.ts","webpack:///./js/editor/icon.ts","webpack:///./js/editor/plugin/track-changes.ts","webpack:///./js/editor/plugin/lid-hint.ts","webpack:///./js/editor/plugin/image-upload.ts","webpack:///./js/editor/index.ts","webpack:///./js/editor/menu.ts","webpack:///./js/lib/domUpdate.ts","webpack:///./js/lib/modal.ts","webpack:///./js/lib/ajax.ts","webpack:///./js/datatable/api.ts","webpack:///./js/lib/formulier.ts","webpack:///./js/lib/reload.ts","webpack:///./js/datatable/render.ts"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","createBlockSpec","type","attr","attrs","group","draggable","toDOM","node","class","parseDOM","tag","getAttrs","dom","dataset","createGroepBlockSpec","tagType","el","fetch","then","response","json","_a","ledenDiv","lid","leden","appendChild","naam","uid","innerHTML","samenvatting_html","catch","innerText","activiteit","bestuur","commissie","groep","ketzer","ondervereniging","verticale","werkgroep","woonoord","boek","maaltijd","peiling","nodes","doc","content","paragraph","blockquote","defining","citaat","van","default","url","bbCitaat","bbCitaatNaam","bbCitaatUrl","inline","lidNaam","horizontal_rule","heading","level","code_block","marks","preserveWhitespace","text","image","src","alt","title","HTMLElement","getAttribute","plaatje","key","plaatjeSrc","hard_break","selectable","verklapper","bb","document","twitter","bbTwitter","youtube","video","bbVideo","audio","bbAudio","spotify","formaat","bbSpotify","bbSpotifyFormaat","link","href","inclusive","em","style","strong","fontWeight","value","test","superscript","excludes","subscript","strikethrough","underline","offtopic","neuzen","parseDom","prive","nodesMap","from","prefix","openPrompt","options","submitButton","cancelButton","form","createElement","formBody","formFooter","description","entries","fields","forEach","name","field","label","required","render","modal","body","mouseOutside","contains","target","close","setTimeout","window","addEventListener","removeEventListener","parentNode","removeChild","submit","params","result","create","read","bad","validate","reportInvalid","clean","getValues","callback","preventDefault","ctrlKey","metaKey","shiftKey","activeElement","tagName","toLowerCase","input","elements","focus","message","parent","msg","left","offsetLeft","offsetWidth","top","offsetTop","className","textContent","Field","this","_value","validateType","TextAreaField","classList","add","placeholder","autocomplete","rows","FileField","files","textInput","hiddenInput","auxInput","ledenDataset","datumTokenizer","tokenizers","obj","whitespace","queryTokenizer","remote","wildcard","initialize","textValue","$","typeahead","hint","highlight","display","limit","source","ttAdapter","templates","suggestion","html","icon","on","event","super","bbPrompt","view","dispatch","state","tr","replaceSelectionWith","createAndFill","placeholderPlugin","init","empty","set","mapping","action","getMeta","widget","deco","pos","remove","find","spec","props","getState","async","imageUpload","file","data","FormData","append","a","post","headers","uploadFile","found","length","findPlaceholder","replaceWith","schema","setMeta","__rest","s","t","p","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","propertyIsEnumerable","canInsert","nodeType","$from","selection","d","depth","index","canReplaceWith","insertImageItem","enable","_","callbackAttrs","insertCitaat","run","of","newAttrs","assign","cmdItem","cmd","enabled","passedOptions","select","markActive","to","isInSet","storedMarks","rangeHasMark","markItem","markType","active","wrapListItem","priveItem","blockTypeItemPrompt","fromEntries","undefined","bbInsert","insertPlaatjeItem","imageType","deleteSelection","startImageUpload","undo","redo","ol","ul","quote","selectParentNode","lift","join","trackChangesPlugin","trs","oldState","newState","JSON","stringify","toJSON","selectedIndex","lidList","cancel","CancelToken","updateLidHintsPosition","lidHints","querySelector","viewPos","parentElement","getBoundingClientRect","bottom","removeLidHints","updateLidHints","Array","children","lidHint","item","suggestLeden","noDecorations","char","appendText","keyBindings","ArrowUp","ArrowDown","Enter","command","Tab","Esc","onChange","queryText","range","coordsAtPos","end","term","cancelToken","get","encodeURI","search","full","token","querySelectorAll","position","lidDiv","createLidHints","onExit","createCommand","match","lidHintPlugin","imageRemovePlugin","newTransaction","descendants","startsWith","deleteRange","imageUploadPlugin","newView","ctx","addHandler","extern","menuContent","loggedIn","tekst","mark","bullet_list","ordered_list","prosemirrorDoc","replace","currentEditor","fromJSON","parse","plugins","handleDoubleClickOn","domUpdate","htmlString","trim","substring","alert","element","parentId","HTMLScriptElement","eval","targetParent","head","modalOpen","modalBackdrop","trigger","modalClose","ajaxRequest","onsuccess","onerror","onfinish","backgroundImage","backgroundPosition","backgroundRepeat","img","method","hasClass","css","hide","error","ketzerAjax","addClass","ajax","cache","done","fail","jqXHR","textStatus","errorThrown","responseText","isDataTableResponse","initDataTable","$el","settingsJson","lastUpdate","fnGetLastUpdate","dataSrc","fnAjaxUpdateCallback","columns","col","table","DataTable","dataTable","api","selected","deselect","container","initOfflineDataTable","fnUpdateDataTable","tableId","row","$tr","UUID","draw","fnGetSelection","each","uuid","push","getApiFromSettings","settings","fn","Api","$table","Number","fnSetLastUpdate","tableConfig","autoUpdate","timeout","parseInt","isNaN","$scroll","scrollTop","height","innerHeight","scrollHeight","animate","fnAutoScroll","replacePlaceholders","replacements","exec","formIsChanged","changed","not","elmnt","is","val","formInlineToggle","$form","prev","toggle","formToggle","formReset","closest","confirm","orig","HTMLInputElement","HTMLTextAreaElement","formSubmit","q","setAttribute","formData","tableid","getElementById","off","formCancel","sourceEl","insertPlaatje","markItUp","initSterrenField","raty","config","path","cancelHint","cancelPlace","noRatedMsg","click","score","console","log","reload","location","redirect","sort","export","bedrag","check","aanmeldFilter","aanmeldingen","aantal_aanmeldingen","aanmeld_limiet","totaalPrijs","prijs","datetime","date","unix","format","substr","meta","cell","firstChild","dateTime"],"mappings":"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","file":"js/formulier.e208d0f82220e02ee743.chunk.js","sourcesContent":["var map = {\n\t\"./nl\": 97,\n\t\"./nl.js\": 97\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 134;","import { html } from \"../../lib/util\";\nconst createBlockSpec = (type, attr = 'id') => ({\n    attrs: { [attr]: {} },\n    group: \"block\",\n    draggable: true,\n    toDOM: node => [\"div\", { [`data-${type}`]: node.attrs[attr], class: \"pm-block\" }, `${type}: ${node.attrs[attr]}`],\n    parseDOM: [{ tag: `div[data-${type}`, getAttrs: (dom) => ({ [attr]: dom.dataset[type] }) }],\n});\nconst createGroepBlockSpec = (tagType, type, attr = 'id') => ({\n    attrs: { [attr]: {} },\n    group: \"block\",\n    draggable: true,\n    toDOM: node => {\n        const el = html `\n\t\t\t<div data-${tagType}=\"${node.attrs[attr]}\" class=\"bb-block\"><i class=\"fa fa-spinner fa-spin\"></i></div>`;\n        fetch(`/groepen/${type}/${node.attrs[attr]}/info`)\n            .then(response => response.json())\n            .then(json => {\n            var _a;\n            const ledenDiv = html `\n\t\t\t\t\t<div id=\"groep-leden-content-2152\" class=\"groep-tab-content GroepPasfotosView\" style=\"height: 212.8px;\">`;\n            for (const lid of json.leden) {\n                ledenDiv.appendChild(html `<a href=\"#\" title=\"${lid.naam}\" class=\"lidLink\"><img\n\t\t\t\t\t\tclass=\"pasfoto\"\n\t\t\t\t\t\tsrc=\"/profiel/pasfoto/${lid.uid}.jpg\"\n\t\t\t\t\t\talt=\"Pasfoto van ${lid.naam}\"></a>`);\n            }\n            el.innerHTML = '';\n            el.appendChild(html `\n\t\t\t\t\t<div class=\"bb-groep bb-block\">\n\t\t\t\t\t\t<div class=\"groep-samenvatting\">\n\t\t\t\t\t\t\t<div class=\"float-right\"><a class=\"btn\" target=\"_blank\" href=\"/groepen/${type}/${json.id}/wijzigen\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"Wijzig ${json.naam}\"><span\n\t\t\t\t\t\t\t\tclass=\"fa fa-edit\"></span></a></div>\n\t\t\t\t\t\t\t<h3>${json.naam} <span class=\"groep-id-hint\">(<a target=\"_blank\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t href=\"/groepen/${type}/${json.id}\">#${json.id}</a>)</span>\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t${(_a = json.samenvatting_html) !== null && _a !== void 0 ? _a : \"\"}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div id=\"groep-leden-2152\" class=\"groep-leden\">\n\t\t\t\t\t\t\t<ul class=\"groep-tabs nobullets\">\n\t\t\t\t\t\t\t\t<li class=\"geschiedenis\"><a class=\"btn disabled\" href=\"#\" title=\"Bekijk geschiedenis\"><span\n\t\t\t\t\t\t\t\t\tclass=\"fa fa-clock\"></span></a></li>\n\t\t\t\t\t\t\t\t<li><a class=\"btn btn-primary disabled\" href=\"#\" title=\"Pasfoto's tonen\"><span\n\t\t\t\t\t\t\t\t\tclass=\"fa fa-user\"></span></a></li>\n\t\t\t\t\t\t\t\t<li><a class=\"btn disabled\" href=\"#\" title=\"Lijst tonen\"><span class=\"fa fa-align-justify\"></span></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li><a class=\"btn disabled\" href=\"#\" title=\"Statistiek tonen\"><span class=\"fa fa-chart-pie\"></span></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li><a class=\"btn disabled\" href=\"#\" title=\"E-mails tonen\"><span class=\"fa fa-envelope\"></span></a></li>\n\t\t\t\t\t\t\t\t<li><a class=\"btn disabled\" href=\"#\" title=\"Allergie/dieet tonen\"><span class=\"fa fa-heartbeat\"></span></a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li class=\"knop-vergroot\"></li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t${ledenDiv}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"clear\">&nbsp;</div>\n\t\t\t\t\t</div>`);\n        })\n            .catch(() => {\n            el.innerText = \"Groep niet gevonden\";\n        });\n        return el;\n    },\n    parseDOM: [{ tag: `div[data-${type}`, getAttrs: (dom) => ({ [attr]: dom.dataset[type] }) }]\n});\n// Groepen\nexport const activiteit = createGroepBlockSpec(\"activiteit\", \"activiteiten\");\nexport const bestuur = createGroepBlockSpec(\"bestuur\", \"besturen\");\nexport const commissie = createGroepBlockSpec(\"commissie\", \"commissies\");\nexport const groep = createGroepBlockSpec(\"groep\", \"groepen\");\nexport const ketzer = createGroepBlockSpec(\"ketzer\", \"ketzers\");\nexport const ondervereniging = createGroepBlockSpec(\"ondervereniging\", \"onderverenigingen\");\nexport const verticale = createGroepBlockSpec(\"verticale\", \"verticalen\");\nexport const werkgroep = createGroepBlockSpec(\"werkgroep\", \"werkgroepen\");\nexport const woonoord = createGroepBlockSpec(\"woonoord\", \"woonoorden\");\n// Overig\nexport const boek = createBlockSpec(\"boek\");\nexport const document = createBlockSpec(\"document\");\nexport const maaltijd = createBlockSpec(\"maaltijd\");\nexport const peiling = createBlockSpec(\"peiling\");\n","import { Schema } from \"prosemirror-model\";\nimport { activiteit, bestuur, boek, commissie, document, groep, ketzer, maaltijd, ondervereniging, peiling, verticale, werkgroep, woonoord } from \"./block-nodes\";\nimport { audio, spotify, twitter, video, youtube } from \"./embed\";\nimport { addListNodes } from \"prosemirror-schema-list\";\nimport OrderedMap from \"orderedmap\";\n// Helper functie om typescript te laten snappen dat alle elementen van i U zijn, maar dat de sleutels nog te ontdekken zijn.\nconst RecordWithType = () => (id) => id;\n// :: Object\n// [Specs](#model.NodeSpec) for the nodes defined in this schema.\nexport const nodes = RecordWithType()({\n    // :: NodeSpec The top level document node.\n    doc: {\n        content: \"block+\"\n    },\n    // :: NodeSpec A plain paragraph textblock. Represented in the DOM\n    // as a `<p>` element.\n    paragraph: {\n        content: \"inline*\",\n        group: \"block\",\n        parseDOM: [{ tag: \"p\" }],\n        toDOM: () => [\"p\", 0]\n    },\n    // :: NodeSpec A blockquote (`<blockquote>`) wrapping one or more blocks.\n    blockquote: {\n        content: \"block+\",\n        group: \"block\",\n        defining: true,\n        parseDOM: [{ tag: \"blockquote\" }],\n        toDOM: () => [\"blockquote\", 0]\n    },\n    citaat: {\n        attrs: { van: {}, naam: { default: \"Lid\" }, url: { default: \"\" } },\n        content: \"block+\",\n        group: \"block\",\n        defining: true,\n        parseDOM: [{\n                tag: \"div[data-bb-citaat]\",\n                getAttrs: (dom) => ({ van: dom.dataset.bbCitaat, naam: dom.dataset.bbCitaatNaam, url: dom.dataset.bbCitaatUrl })\n            }],\n        toDOM: node => [\"div\", { \"data-bb-citaat\": node.attrs.van, \"data-bb-citaat-naam\": node.attrs.naam, \"data-bb-citaat-url\": node.attrs.url }, 0]\n    },\n    lid: {\n        attrs: { uid: {}, naam: { default: null } },\n        group: \"inline\",\n        inline: true,\n        parseDOM: [{\n                tag: \"span[data-lid]\",\n                getAttrs: (dom) => ({ uid: dom.dataset.lid, naam: dom.dataset.lidNaam })\n            }],\n        toDOM: node => [\"span\", { \"data-lid\": node.attrs.uid, \"data-lidNaam\": node.attrs.naam }, node.attrs.naam],\n    },\n    // :: NodeSpec A horizontal rule (`<hr>`).\n    horizontal_rule: {\n        group: \"block\",\n        parseDOM: [{ tag: \"hr\" }],\n        toDOM: () => [\"hr\"]\n    },\n    // :: NodeSpec A heading textblock, with a `level` attribute that\n    // should hold the number 1 to 6. Parsed and serialized as `<h1>` to\n    // `<h6>` elements.\n    heading: {\n        attrs: { level: { default: 1 } },\n        content: \"inline*\",\n        group: \"block\",\n        defining: true,\n        parseDOM: [{ tag: \"h1\", attrs: { level: 1 } },\n            { tag: \"h2\", attrs: { level: 2 } },\n            { tag: \"h3\", attrs: { level: 3 } },\n            { tag: \"h4\", attrs: { level: 4 } },\n            { tag: \"h5\", attrs: { level: 5 } },\n            { tag: \"h6\", attrs: { level: 6 } }],\n        toDOM: node => [\"h\" + node.attrs.level, 0]\n    },\n    // :: NodeSpec A code listing. Disallows marks or non-text inline\n    // nodes by default. Represented as a `<pre>` element with a\n    // `<code>` element inside of it.\n    code_block: {\n        content: \"text*\",\n        marks: \"\",\n        group: \"block\",\n        code: true,\n        defining: true,\n        parseDOM: [{ tag: \"pre\", preserveWhitespace: \"full\" }],\n        toDOM: () => [\"pre\", [\"code\", 0]]\n    },\n    // :: NodeSpec The text node.\n    text: {\n        group: \"inline\"\n    },\n    // :: NodeSpec An inline image (`<img>`) node. Supports `src`,\n    // `alt`, and `href` attributes. The latter two default to the empty\n    // string.\n    image: {\n        inline: true,\n        attrs: {\n            src: {},\n            alt: { default: null },\n            title: { default: null }\n        },\n        group: \"inline\",\n        draggable: true,\n        parseDOM: [{\n                tag: \"img[src]\",\n                getAttrs: dom => {\n                    if (dom instanceof HTMLElement) {\n                        return {\n                            src: dom.getAttribute(\"src\"),\n                            title: dom.getAttribute(\"title\"),\n                            alt: dom.getAttribute(\"alt\")\n                        };\n                    }\n                    else {\n                        throw new Error(\"Unable to process dom\");\n                    }\n                }\n            }],\n        toDOM: (node) => {\n            const { src, alt, title } = node.attrs;\n            return [\"img\", { src, alt, title }];\n        }\n    },\n    plaatje: {\n        inline: true,\n        attrs: {\n            src: {},\n            key: {},\n        },\n        group: \"inline\",\n        draggable: true,\n        parseDOM: [{\n                tag: \"[data-plaatje]\",\n                getAttrs: (dom) => ({ key: dom.dataset.plaatje, src: dom.dataset.plaatjeSrc })\n            }],\n        toDOM: (node) => [\"div\", {\n                \"data-plaatje\": node.attrs.key,\n                \"data-plaatje-src\": node.attrs.src\n            }, [\"img\", { src: node.attrs.src }]],\n    },\n    // :: NodeSpec A hard line break, represented in the DOM as `<br>`.\n    hard_break: {\n        inline: true,\n        group: \"inline\",\n        selectable: false,\n        parseDOM: [{ tag: \"br\" }],\n        toDOM: () => [\"br\"]\n    },\n    verklapper: {\n        content: \"block+\",\n        group: \"block\",\n        parseDOM: [{ tag: \"div[data-bb-verklapper]\" }],\n        toDOM: () => [\"div\", { \"data-bb-verklapper\": \"\", class: \"pm-verklapper\" }, 0]\n    },\n    bb: {\n        attrs: { bb: { default: null } },\n        group: \"block\",\n        toDOM: node => [\"div\", { \"data-bb\": node.attrs.bb }, node.attrs.bb],\n        parseDOM: [{\n                tag: \"div[data-bb]\",\n                getAttrs: (dom) => ({ bb: dom.dataset.bb })\n            }]\n    },\n    // Groepen\n    activiteit, bestuur, commissie, groep,\n    ketzer, ondervereniging, verticale, werkgroep,\n    woonoord,\n    // Overige blokken\n    boek, document, maaltijd, peiling,\n    // Embeds\n    twitter, youtube, video, audio, spotify,\n});\n// :: Object [Specs](#model.MarkSpec) for the marks in the schema.\nexport const marks = RecordWithType()({\n    // :: MarkSpec A link. Has `href` and `title` attributes. `title`\n    // defaults to the empty string. Rendered and parsed as an `<a>`\n    // element.\n    link: {\n        attrs: {\n            href: {},\n        },\n        inclusive: false,\n        parseDOM: [{\n                tag: \"a[href]\",\n                getAttrs: dom => {\n                    if (dom instanceof HTMLElement) {\n                        return { href: dom.getAttribute(\"href\") };\n                    }\n                    else {\n                        throw new Error(\"Cannot process dom\");\n                    }\n                }\n            }],\n        toDOM: node => {\n            const { href } = node.attrs;\n            return [\"a\", { href, title: href }, 0];\n        }\n    },\n    // :: MarkSpec An emphasis mark. Rendered as an `<em>` element.\n    // Has parse rules that also match `<i>` and `font-style: italic`.\n    em: {\n        parseDOM: [{ tag: \"i\" }, { tag: \"em\" }, { style: \"font-style=italic\" }],\n        toDOM: () => [\"em\", 0]\n    },\n    // :: MarkSpec A strong mark. Rendered as `<strong>`, parse rules\n    // also match `<b>` and `font-weight: bold`.\n    strong: {\n        parseDOM: [{ tag: \"strong\" },\n            // This works around a Google Docs misbehavior where\n            // pasted content will be inexplicably wrapped in `<b>`\n            // tags with a font-weight normal.\n            {\n                tag: \"b\", getAttrs: node => {\n                    if (node instanceof HTMLElement) {\n                        return node.style.fontWeight != \"normal\" && null;\n                    }\n                    else {\n                        throw new Error(\"Cannot process dom\");\n                    }\n                }\n            },\n            {\n                style: \"font-weight\", getAttrs: value => {\n                    if (typeof value == 'string') {\n                        return /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null;\n                    }\n                    else {\n                        throw new Error(\"Cannot process value\");\n                    }\n                }\n            }],\n        toDOM: () => [\"strong\", 0]\n    },\n    superscript: {\n        excludes: \"superscript subscript\",\n        parseDOM: [{ tag: \"sup\" }],\n        toDOM: () => [\"sup\", 0]\n    },\n    subscript: {\n        excludes: \"subscript superscript\",\n        parseDOM: [{ tag: \"sub\" }],\n        toDOM: () => [\"sub\", 0]\n    },\n    strikethrough: {\n        parseDOM: [{ tag: \"del\" }],\n        toDOM: () => [\"del\", 0]\n    },\n    underline: {\n        parseDOM: [{ tag: \"ins\" }],\n        toDOM: () => [\"ins\", 0]\n    },\n    // :: MarkSpec Code font mark. Represented as a `<code>` element.\n    code: {\n        parseDOM: [{ tag: \"code\" }],\n        toDOM: () => [\"code\", 0]\n    },\n    offtopic: {\n        parseDOM: [{ tag: \"span[data-offtopic]\" }],\n        toDOM: () => [\"span\", { \"data-offtopic\": \"\", class: \"offtopic\" }, 0],\n    },\n    neuzen: {\n        parseDom: [{ tag: \"span[data-neuzen]\" }],\n        toDOM: () => [\"span\", { \"data-neuzen\": \"\" }, 0],\n    },\n    prive: {\n        attrs: { prive: { default: null } },\n        parseDOM: [{ tag: \"span[data-prive]\" }],\n        toDOM: (node) => [\"span\", {\n                \"data-prive\": node.attrs.prive,\n                class: \"bb-prive\",\n                title: `Prive: ${node.attrs.prive || \"P_LOGGED_IN\"}`\n            }, 0],\n    },\n});\nconst nodesMap = OrderedMap.from(nodes);\nexport const schema = new Schema({\n    nodes: addListNodes(nodesMap, \"paragraph block*\", \"block\"),\n    marks\n});\n","export const twitter = {\n    attrs: { url: {} },\n    group: \"block\",\n    parseDOM: [{\n            tag: \"div[data-bb-twitter]\",\n            getAttrs: (dom) => ({ url: dom.dataset.bbTwitter })\n        }],\n    toDOM: node => [\"div\", { \"data-bb-twitter\": node.attrs.url }]\n};\nexport const video = {\n    attrs: { url: {} },\n    group: \"block\",\n    parseDOM: [{\n            tag: \"div[data-bb-video]\",\n            getAttrs: (dom) => ({ url: dom.dataset.bbVideo })\n        }],\n    toDOM: node => [\"div\", { \"data-bb-video\": node.attrs.url }],\n};\nexport const audio = {\n    attrs: { url: {} },\n    group: \"block\",\n    parseDOM: [{\n            tag: \"div[data-bb-audio]\",\n            getAttrs: (dom) => ({ url: dom.dataset.bbAudio })\n        }],\n    toDOM: node => [\"div\", { \"data-bb-audio\": node.attrs.url }]\n};\nexport const youtube = {\n    attrs: { id: {} },\n    group: \"block\",\n    parseDOM: [{ tag: \"div[data-bb-youtube]\" }],\n    toDOM: node => [\"div\", {\n            \"data-bb-youtube\": node.attrs.id,\n            \"class\": \"bb-video\",\n            title: \"YouTube\"\n        }, [\"img\", { src: `https://i.ytimg.com/vi/${node.attrs.id}/sddefault.jpg` }]]\n};\nexport const spotify = {\n    attrs: { url: {}, formaat: { default: \"hoog\" } },\n    group: \"block\",\n    parseDOM: [{\n            tag: \"div[data-bb-spotify]\",\n            getAttrs: (dom) => ({\n                url: dom.dataset.bbSpotify,\n                formaat: dom.dataset.bbSpotifyFormaat\n            })\n        }],\n    toDOM: node => [\"div\", { \"data-bb-spotify\": node.attrs.url, \"data-bb-spotify-formaat\": node.attrs.formaat }]\n};\n","import { html } from \"../lib/util\";\nimport Bloodhound from \"corejs-typeahead\";\nconst prefix = \"ProseMirror-popup\";\nexport function openPrompt(options) {\n    const submitButton = html `\n\t\t<button type=\"submit\" class=\"${prefix}-submit btn btn-primary\">OK</button>`;\n    const cancelButton = html `\n\t\t<button type=\"button\" class=\"${prefix}-cancel btn btn-primary\">Cancel</button>`;\n    const form = document.createElement(\"form\");\n    const formBody = form.appendChild(html `\n\t\t<div class=\"modal-body\"></div>`);\n    const formFooter = form.appendChild(html `\n\t\t<div class=\"modal-footer\"></div>`);\n    if (options.description) {\n        formBody.appendChild(html `<p>${options.description}</p>`);\n    }\n    Object.entries(options.fields).forEach(([name, field]) => {\n        formBody.appendChild(html `\n\t\t\t<div class=\"form-group row\">\n\t\t\t\t<label class=\"col-sm-2 col-form-label\" for=\"${name}\">${field.options.label}${field.options.required ? html `<span class=\"text-danger\">*</span>` : \"\"}</label>\n\t\t\t\t<div class=\"col-sm-10\">${field.render(name)}</div>\n\t\t\t</div>`);\n    });\n    formFooter.appendChild(html `\n\t\t<div class=\"${prefix}-buttons\">${submitButton} ${cancelButton}</div>`);\n    const modal = html `\n\t\t<div class=\"modal\" style=\"display: block;\" tabindex=\"-1\">\n\t\t\t<div class=\"modal-dialog\">\n\t\t\t\t<div class=\"modal-content\">\n\t\t\t\t\t<div class=\"modal-header\">\n\t\t\t\t\t\t<h5 class=\"modal-title\">${options.title}</h5>\n\t\t\t\t\t</div>\n\t\t\t\t\t${form}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`;\n    document.body.appendChild(modal);\n    const mouseOutside = e => {\n        if (!form.contains(e.target))\n            close();\n    };\n    setTimeout(() => window.addEventListener(\"mousedown\", mouseOutside), 50);\n    const close = () => {\n        window.removeEventListener(\"mousedown\", mouseOutside);\n        if (modal.parentNode)\n            modal.parentNode.removeChild(modal);\n    };\n    cancelButton.addEventListener(\"click\", close);\n    const submit = () => {\n        const params = getValues(options.fields, form);\n        if (params) {\n            close();\n            options.callback(params);\n        }\n    };\n    form.addEventListener(\"submit\", e => {\n        e.preventDefault();\n        submit();\n    });\n    form.addEventListener(\"keydown\", e => {\n        if (e.key == \"Escape\") {\n            e.preventDefault();\n            close();\n        }\n        else if (e.key == \"Enter\" && !(e.ctrlKey || e.metaKey || e.shiftKey) && document.activeElement.tagName.toLowerCase() != \"textarea\") {\n            e.preventDefault();\n            submit();\n        }\n        else if (e.key == \"Tab\") {\n            window.setTimeout(() => {\n                if (!modal.contains(document.activeElement))\n                    close();\n            }, 500);\n        }\n    });\n    const input = form.elements[0];\n    if (input)\n        input.focus();\n}\nfunction getValues(fields, form) {\n    const result = Object.create(null);\n    for (const name of Object.keys(fields)) {\n        const field = fields[name];\n        const dom = form[name];\n        const value = field.read(dom);\n        const bad = field.validate(value);\n        if (bad) {\n            reportInvalid(dom, bad);\n            return null;\n        }\n        result[name] = field.clean(value);\n    }\n    return result;\n}\nfunction reportInvalid(dom, message) {\n    // FIXME this is awful and needs a lot more work\n    const parent = dom.parentNode;\n    const msg = parent.appendChild(document.createElement(\"div\"));\n    msg.style.left = (dom.offsetLeft + dom.offsetWidth + 2) + \"px\";\n    msg.style.top = (dom.offsetTop - 5) + \"px\";\n    msg.className = \"ProseMirror-invalid\";\n    msg.textContent = message;\n    setTimeout(() => parent.removeChild(msg), 1500);\n}\n// ::- The type of field that `FieldPrompt` expects to be passed to it.\nexport class Field {\n    // :: (Object)\n    // Create a field with the given options. Options support by all\n    // field types are:\n    //\n    // **`value`**`: ?any`\n    //   : The starting value for the field.\n    //\n    // **`label`**`: string`\n    //   : The label for the field.\n    //\n    // **`required`**`: ?bool`\n    //   : Whether the field is required.\n    //\n    // **`validate`**`: ?(any) → ?string`\n    //   : A function to validate the given value. Should return an\n    //     error message if it is not valid.\n    constructor(options) {\n        this.options = options;\n    }\n    // render:: (state: EditorState, props: Object) → dom.Node\n    // Render the field to the DOM. Should be implemented by all subclasses.\n    // :: (dom.Node) → any\n    // Read the field's value from its DOM node.\n    read(dom) {\n        return dom.value;\n    }\n    // :: (any) → ?string\n    // A field-type-specific validation function.\n    validateType(_value) {\n        return null;\n    }\n    validate(value) {\n        if (!value && this.options.required)\n            return \"Required field\";\n        return this.validateType(value) || (this.options.validate && this.options.validate(value));\n    }\n    clean(value) {\n        return this.options.clean ? this.options.clean(value) : value;\n    }\n    render(name) {\n        // abstract\n        return null;\n    }\n}\n// ::- A field class for single-line text fields.\nexport class TextField extends Field {\n    render(name) {\n        return html `<input type=\"text\" name=\"${name}\" id=\"${name}\" value=\"${this.options.value || \"\"}\" autocomplete=\"off\"\n\t\t\t\t\t\t\t\t\t\t\t class=\"form-control\"/>`;\n    }\n}\nexport class Label extends Field {\n    render(name) {\n        return html `<div>${this.options.value}</div>`;\n    }\n    read(dom) {\n        return \"\";\n    }\n}\n// ::- A field class for dropdown fields based on a plain `<select>`\n// tag. Expects an option `options`, which should be an array of\n// `{value: string, label: string}` objects, or a function taking a\n// `ProseMirror` instance and returning such an array.\nexport class SelectField extends Field {\n    render(name) {\n        const select = document.createElement(\"select\");\n        select.id = name;\n        select.name = name;\n        this.options.options.forEach(o => {\n            const opt = select.appendChild(document.createElement(\"option\"));\n            opt.value = o.value;\n            opt.selected = o.value == this.options.value;\n            opt.label = o.label;\n        });\n        return select;\n    }\n}\nexport class TextAreaField extends Field {\n    render(name) {\n        const input = document.createElement(\"textarea\");\n        input.id = name;\n        input.name = name;\n        input.classList.add(\"form-control\");\n        input.placeholder = this.options.label;\n        input.value = this.options.value || \"\";\n        input.autocomplete = \"off\";\n        input.rows = 20;\n        return input;\n    }\n}\nexport class FileField extends Field {\n    render(name) {\n        const input = document.createElement(\"input\");\n        input.id = name;\n        input.name = name;\n        input.classList.add(\"form-control\");\n        input.type = \"file\";\n        return input;\n    }\n    read(dom) {\n        return dom.files[0];\n    }\n}\nexport class LidField extends Field {\n    render(name) {\n        this.name = name;\n        const textInput = html `<input type=\"text\" class=\"form-control\" autocomplete=\"off\" name=\"${name}_naam\" value=\"${this.options.value.naam}\">`;\n        const hiddenInput = html `<input type=\"hidden\" name=\"${name}_uid\" value=\"${this.options.value.uid}\">`;\n        const auxInput = html `<input type=\"hidden\" name=\"${name}\">`;\n        const ledenDataset = new Bloodhound({\n            datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),\n            queryTokenizer: Bloodhound.tokenizers.whitespace,\n            remote: {\n                url: '/tools/naamsuggesties?vorm=user&zoekin=voorkeur&q=%QUERY',\n                wildcard: '%QUERY',\n            }\n        });\n        ledenDataset.initialize();\n        let textValue = this.options.value.naam;\n        setTimeout(() => {\n            $(textInput).typeahead({\n                hint: true,\n                highlight: true,\n            }, {\n                name: 'leden',\n                display: 'value',\n                limit: 20,\n                source: ledenDataset.ttAdapter(),\n                templates: {\n                    suggestion: function (suggestion) {\n                        let html = '<p';\n                        if (suggestion.title) {\n                            html += ' title=\"' + suggestion.title + '\"';\n                        }\n                        html += '>';\n                        if (suggestion.icon) {\n                            html += suggestion.icon;\n                        }\n                        html += suggestion.value;\n                        if (suggestion.label) {\n                            html += '<span class=\"lichtgrijs\"> - ' + suggestion.label + '</span>';\n                        }\n                        return html + '</p>';\n                    }\n                }\n            });\n            $(textInput).on(\"typeahead:select\", (event, suggestion) => {\n                hiddenInput.value = suggestion['uid'];\n                textValue = suggestion['value'];\n            });\n            $(textInput).on(\"typeahead:change\", (event, value) => {\n                if (textValue != value) {\n                    hiddenInput.value = \"\";\n                }\n            });\n        });\n        return html `\n\t\t\t<div>\n\t\t\t\t${textInput}\n\t\t\t\t${hiddenInput}\n\t\t\t\t${auxInput}\n\t\t\t</div>`;\n    }\n    read(dom) {\n        return {\n            naam: dom.form[`${this.name}_naam`].value,\n            uid: dom.form[`${this.name}_uid`].value,\n        };\n    }\n    validate(value) {\n        if (this.options.required && !value.uid) {\n            return \"Selecteer een lid\";\n        }\n        return super.validate(value);\n    }\n}\n","import { openPrompt, TextAreaField } from \"./prompt\";\nexport const bbPrompt = (node, attrs, view) => openPrompt({\n    title: \"Bewerk bb\",\n    fields: {\n        'bb': new TextAreaField({ label: \"Bb\", value: attrs.bb })\n    },\n    callback(params) {\n        view.dispatch(view.state.tr.replaceSelectionWith(node.createAndFill(params)));\n        view.focus();\n    }\n});\n","import { Plugin } from \"prosemirror-state\";\nimport { Decoration, DecorationSet } from \"prosemirror-view\";\nexport const placeholderPlugin = new Plugin({\n    state: {\n        init() {\n            return DecorationSet.empty;\n        },\n        apply(tr, set) {\n            // Adjust decoration positions to changes made by the transaction\n            set = set.map(tr.mapping, tr.doc);\n            // See if the transaction adds or removes any placeholders\n            const action = tr.getMeta(this);\n            if (action && action.add) {\n                const widget = document.createElement(\"div\");\n                widget.classList.add(\"plaatje-placeholder\");\n                const deco = Decoration.widget(action.add.pos, widget, { id: action.add.id });\n                set = set.add(tr.doc, [deco]);\n            }\n            else if (action && action.remove) {\n                set = set.remove(set.find(null, null, spec => spec.id == action.remove.id));\n            }\n            return set;\n        }\n    },\n    props: {\n        decorations(state) {\n            return this.getState(state);\n        }\n    }\n});\nexport const findPlaceholder = (state, id) => {\n    const decorations = placeholderPlugin.getState(state);\n    const found = decorations.find(null, null, spec => spec.id == id);\n    return found.length ? found[0].from : null;\n};\n","import { findPlaceholder, placeholderPlugin } from \"./plugin/placeholder\";\nimport axios from \"axios\";\nimport { preloadImage } from \"../lib/util\";\n/**\n * Wordt opgepikt door de ImageField in PlaatjesUploadModalForm.\n * @param file\n */\nasync function uploadFile(file) {\n    const data = new FormData();\n    data.append('image_HF', file, file.name);\n    data.append('image', 'image_HF');\n    const response = await axios.post(\"/forum/plaatjes/upload_json\", data, {\n        headers: { 'content-type': 'multipart/form-data' },\n    });\n    return response.data;\n}\nexport async function startImageUpload(view, file) {\n    // A fresh object to act as the ID for this upload\n    const id = {};\n    // Replace the selection with a placeholder\n    const tr = view.state.tr;\n    if (!tr.selection.empty)\n        tr.deleteSelection();\n    tr.setMeta(placeholderPlugin, { add: { id, pos: tr.selection.from } });\n    view.dispatch(tr);\n    await imageUpload(view, file, id);\n}\nexport async function imageUpload(view, file, id) {\n    try {\n        const { src, key } = await uploadFile(file);\n        // Voorkom dat de view eventjes leeg is\n        await preloadImage(src);\n        const pos = findPlaceholder(view.state, id);\n        // If the content around the placeholder has been deleted, drop the image\n        if (pos == null)\n            return;\n        // Otherwise, insert it at the placeholder's position, and remove the placeholder\n        view.dispatch(view.state.tr\n            .replaceWith(pos, pos, view.state.schema.nodes.plaatje.create({ src, key }))\n            .setMeta(placeholderPlugin, { remove: { id } }));\n    }\n    catch (e) {\n        // On failure, just clean up the placeholder\n        view.dispatch(view.state.tr.setMeta(placeholderPlugin, { remove: { id } }));\n        // Rethrow\n        throw e;\n    }\n}\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { bbPrompt } from \"./bb-prompt\";\nimport { NodeSelection } from \"prosemirror-state\";\nimport { MenuItem } from \"prosemirror-menu\";\nimport { FileField, Label, LidField, openPrompt, TextField } from \"./prompt\";\nimport { toggleMark } from \"prosemirror-commands\";\nimport { wrapInList } from \"prosemirror-schema-list\";\nimport { startImageUpload } from \"./forum-plaatje\";\nimport { html, ucfirst, uidLike } from \"../lib/util\";\nexport function canInsert(state, nodeType) {\n    const $from = state.selection.$from;\n    for (let d = $from.depth; d >= 0; d--) {\n        const index = $from.index(d);\n        if ($from.node(d).canReplaceWith(index, index, nodeType))\n            return true;\n    }\n    return false;\n}\n/**\n * Alleen voor externen\n * @param nodeType\n */\nexport const insertImageItem = (nodeType) => new MenuItem({\n    title: \"Afbeelding invoegen\",\n    label: \"Afbeelding\",\n    enable(state) {\n        return canInsert(state, nodeType);\n    },\n    run(state, _, view) {\n        let attrs = null;\n        if (state.selection instanceof NodeSelection && state.selection.node.type == nodeType)\n            attrs = state.selection.node.attrs;\n        openPrompt({\n            title: \"Afbeelding invoegen\",\n            fields: {\n                src: new TextField({ label: \"Locatie\", required: true, value: attrs && attrs.src }),\n            },\n            callback: callbackAttrs => {\n                view.dispatch(view.state.tr.replaceSelectionWith(nodeType.createAndFill(callbackAttrs)));\n                view.focus();\n            }\n        });\n    }\n});\nexport function insertCitaat(nodeType) {\n    return new MenuItem({\n        label: \"Citaat\",\n        title: \"Citaat invoegen\",\n        enable: state => canInsert(state, nodeType),\n        run: (state, dispatch, view) => {\n            let attrs = null;\n            let content = null;\n            if (state.selection instanceof NodeSelection && state.selection.node.type == nodeType) {\n                attrs = state.selection.node.attrs;\n                content = state.selection.node.content;\n            }\n            openPrompt({\n                description: \"\",\n                title: attrs ? \"Update: \" + nodeType.name : \"Invoegen: \" + nodeType.name,\n                fields: {\n                    lid: new LidField({\n                        label: \"Lid\",\n                        required: false,\n                        value: attrs && uidLike(attrs.van) ? { naam: attrs.naam, uid: attrs.van } : { naam: \"\", uid: \"\" },\n                    }),\n                    of: new Label({ label: \"\", value: \"- Of -\" }),\n                    naam: new TextField({\n                        label: \"Van\",\n                        required: false,\n                        value: attrs && !uidLike(attrs.van) ? attrs.naam : \"\",\n                    }),\n                    url: new TextField({\n                        label: \"Url\",\n                        required: false,\n                        value: attrs && !uidLike(attrs.van) ? attrs.url : \"\",\n                    })\n                },\n                callback({ lid, naam, url }) {\n                    const newAttrs = lid.uid ? { naam: lid.naam, van: lid.uid } : { van: naam, naam, url };\n                    view.dispatch(view.state.tr.replaceSelectionWith(nodeType.createAndFill(Object.assign({ type: nodeType.name }, newAttrs), content)));\n                    view.focus();\n                }\n            });\n        }\n    });\n}\nfunction cmdItem(cmd, _a) {\n    var { enabled } = _a, options = __rest(_a, [\"enabled\"]);\n    const passedOptions = Object.assign({ label: typeof options.title == \"string\" ? options.title : \"\", run: cmd }, options);\n    if ((!enabled || enabled === true) && !options.select)\n        passedOptions[enabled ? \"enable\" : \"select\"] = state => cmd(state);\n    return new MenuItem(passedOptions);\n}\nfunction markActive(state, type) {\n    const { from, $from, to, empty } = state.selection;\n    if (empty)\n        return !!type.isInSet(state.storedMarks || $from.marks());\n    else\n        return state.doc.rangeHasMark(from, to, type);\n}\nexport const markItem = (markType, options) => cmdItem(toggleMark(markType), Object.assign({ active(state) {\n        return markActive(state, markType);\n    }, enabled: true }, options));\nexport const linkItem = (markType) => new MenuItem({\n    title: \"Maak of verwijder link\",\n    icon: { dom: html `<i class=\"fa fa-link\"></i>` },\n    active(state) {\n        return markActive(state, markType);\n    },\n    enable() {\n        return true;\n    },\n    run(state, dispatch, view) {\n        if (markActive(state, markType)) {\n            toggleMark(markType)(state, dispatch);\n            return true;\n        }\n        if (state.selection.empty) {\n            openPrompt({\n                title: \"Maak een link\",\n                fields: {\n                    tekst: new TextField({\n                        label: \"Link tekst\",\n                        required: true,\n                    }),\n                    href: new TextField({\n                        label: \"Link doel\",\n                        required: true\n                    }),\n                },\n                callback({ tekst, href }) {\n                    // Voeg https toe als dat er nog niet staat.\n                    if (!(href.startsWith(\"/\") || href.startsWith(\"https://\") || href.startsWith(\"http://\"))) {\n                        href = \"https://\" + href;\n                    }\n                    view.dispatch(view.state.tr.replaceSelectionWith(state.schema.text(tekst).mark([markType.create({ href })]), false));\n                    view.focus();\n                }\n            });\n        }\n        else {\n            openPrompt({\n                title: \"Maak een link\",\n                fields: {\n                    href: new TextField({\n                        label: \"Link doel\",\n                        required: true\n                    }),\n                },\n                callback({ href }) {\n                    // Voeg https toe als dat er nog niet staat.\n                    if (!(href.startsWith(\"/\") || href.startsWith(\"https://\") || href.startsWith(\"http://\"))) {\n                        href = \"https://\" + href;\n                    }\n                    toggleMark(markType, { href })(view.state, view.dispatch);\n                    view.focus();\n                }\n            });\n        }\n    }\n});\nexport const wrapListItem = (nodeType, options) => cmdItem(wrapInList(nodeType, null), options);\nexport const priveItem = (markType) => new MenuItem({\n    title: \"Markeer tekst als prive\",\n    label: \"Prive\",\n    active: state => markActive(state, markType),\n    enable: state => !state.selection.empty,\n    run(state, dispatch, view) {\n        if (markActive(state, markType)) {\n            toggleMark(markType)(state, dispatch);\n            return true;\n        }\n        openPrompt({\n            title: \"Markeer als prive\",\n            fields: {\n                prive: new TextField({ label: \"Rechten (leeg voor ingelogd)\" }),\n            },\n            callback(attrs) {\n                toggleMark(markType, attrs)(view.state, view.dispatch);\n                view.focus();\n            }\n        });\n    }\n});\nexport const lidInsert = (nodeType) => new MenuItem({\n    title: \"Lid invoegen\",\n    label: \"Lid\",\n    enable: state => canInsert(state, nodeType),\n    run: (state, dispatch, view) => {\n        let attrs = null;\n        let content = null;\n        if (state.selection instanceof NodeSelection && state.selection.node.type == nodeType) {\n            attrs = state.selection.node.attrs;\n            content = state.selection.node.content;\n        }\n        openPrompt({\n            title: attrs ? \"Update: \" + nodeType.name : \"Invoegen: \" + nodeType.name,\n            description: \"Tip: Type '@' met een zoekterm in je bericht om snel een lid te noemen.\",\n            fields: {\n                lid: new LidField({\n                    label: \"Lid\",\n                    required: true,\n                    value: attrs ? { uid: attrs.uid, naam: attrs.naam } : { uid: \"\", naam: \"\" }\n                })\n            },\n            callback(callbackAttrs) {\n                view.dispatch(view.state.tr.replaceSelectionWith(nodeType.createAndFill(Object.assign({ type: nodeType.name }, callbackAttrs.lid), content)));\n                view.focus();\n            }\n        });\n    }\n});\nexport const blockTypeItemPrompt = (nodeType, label, title, description = \"\") => new MenuItem({\n    title,\n    label,\n    enable: state => canInsert(state, nodeType),\n    run: (state, dispatch, view) => {\n        let attrs = null;\n        let content = null;\n        if (state.selection instanceof NodeSelection && state.selection.node.type == nodeType) {\n            attrs = state.selection.node.attrs;\n            content = state.selection.node.content;\n        }\n        openPrompt({\n            description,\n            title: attrs ? \"Update: \" + nodeType.name : \"Invoegen: \" + nodeType.name,\n            fields: Object.fromEntries(Object.entries(nodeType.spec.attrs).map(([attr, spec]) => [attr, new TextField({\n                    label: ucfirst(attr),\n                    required: spec.default === undefined,\n                    value: attrs ? attrs[attr] : spec.default\n                })])),\n            callback(callbackAttrs) {\n                view.dispatch(view.state.tr.replaceSelectionWith(nodeType.createAndFill(Object.assign({ type: nodeType.name }, callbackAttrs), content)));\n                view.focus();\n            }\n        });\n    }\n});\nexport const bbInsert = (nodeType) => new MenuItem({\n    title: \"BB code als platte tekst invoegen\",\n    label: \"BB code\",\n    enable: state => canInsert(state, nodeType),\n    run: (state, dispatch, view) => {\n        let attrs = { bb: \"\" };\n        if (state.selection instanceof NodeSelection && state.selection.node.type == nodeType) {\n            attrs = state.selection.node.attrs;\n        }\n        bbPrompt(nodeType, attrs, view);\n    }\n});\nexport const insertPlaatjeItem = (nodeType, imageType) => new MenuItem({\n    title: \"Afbeelding invoegen\",\n    label: \"Afbeelding\",\n    enable: state => canInsert(state, nodeType) || canInsert(state, imageType),\n    run: (state, dispatch, view) => {\n        openPrompt({\n            title: \"Plaatje uploaden\",\n            fields: {\n                image: new FileField({ label: \"Afbeelding\" }),\n                of: new Label({ label: \"\", value: \"- Of -\" }),\n                url: new TextField({ label: \"Url\" }),\n            },\n            callback: params => {\n                if (params.url) {\n                    view.dispatch(view.state.tr.replaceSelectionWith(imageType.createAndFill({ src: params.url })));\n                    view.focus();\n                }\n                else if (params.image) {\n                    startImageUpload(view, params.image);\n                }\n            }\n        });\n    }\n});\n","import { html } from \"../lib/util\";\nexport default {\n    strong: { dom: html `<i class=\"fa fa-bold\"></i>` },\n    em: { dom: html `<i class=\"fa fa-italic\"></i>` },\n    link: { dom: html `<i class=\"fa fa-link\"></i>` },\n    undo: { dom: html `<i class=\"fa fa-undo\"></i>` },\n    redo: { dom: html `<i class=\"fa fa-redo\"></i>` },\n    ol: { dom: html `<i class=\"fa fa-list-ol\"></i>` },\n    ul: { dom: html `<i class=\"fa fa-list-ul\"></i>` },\n    quote: { dom: html `<i class=\"fa fa-quote-right\"></i>` },\n    underline: { dom: html `<i class=\"fa fa-underline\"></i>` },\n    selectParentNode: { dom: html `<i class=\"fa fa-object-group\"></i>` },\n    lift: { dom: html `<i class=\"fa fa-outdent\"></i>` },\n    prive: { dom: html `<i class=\"fa fa-user-shield\"></i>` },\n    join: { dom: html `<i class=\"fa fa-caret-up\"></i>` },\n};\n","import { Plugin } from \"prosemirror-state\";\n/**\n * Track changes as JSON to an input element\n * @param input\n */\nexport const trackChangesPlugin = (input) => new Plugin({\n    appendTransaction(trs, oldState, newState) {\n        input.value = JSON.stringify(newState.doc.toJSON());\n    }\n});\n","import { suggest } from \"prosemirror-suggest\";\nimport axios from \"axios\";\nlet selectedIndex = 0;\nlet lidList = [];\nlet cancel = axios.CancelToken.source();\nasync function search(term, cancelToken) {\n    if (!term || term.length === 1) {\n        return [];\n    }\n    else {\n        const response = await axios.get(\"/tools/naamsuggesties?vorm=user&zoekin=voorkeur&q=\" + encodeURI(term), { cancelToken });\n        return response.data;\n    }\n}\nconst updateLidHintsPosition = (view, pos) => {\n    const lidHints = document.querySelector(\".lid-hints\");\n    if (!lidHints)\n        return;\n    const viewPos = view.dom.parentElement.getBoundingClientRect();\n    lidHints.style.left = (pos.left - viewPos.left) + \"px\";\n    lidHints.style.top = (pos.bottom - viewPos.top) + \"px\";\n};\nconst createLidHints = (command, view, pos) => {\n    Array.from(document.querySelectorAll('.lid-hints')).forEach(hint => hint.remove());\n    const lidHints = document.createElement(\"div\");\n    lidHints.classList.add('lid-hints', 'list-group');\n    lidHints.style.position = 'absolute';\n    for (const lid of lidList) {\n        const lidDiv = lidHints.appendChild(document.createElement(\"div\"));\n        lidDiv.classList.add(\"list-group-item\", \"list-group-item-action\");\n        lidDiv.addEventListener('click', () => {\n            command(lid);\n        });\n        lidDiv.textContent = lid.value;\n    }\n    view.dom.parentElement.appendChild(lidHints);\n    updateLidHintsPosition(view, pos);\n    updateLidHints();\n};\nconst removeLidHints = () => {\n    const lidHints = document.querySelector(\".lid-hints\");\n    if (lidHints)\n        lidHints.remove();\n};\nconst updateLidHints = () => {\n    const lidHints = document.querySelector(\".lid-hints\");\n    for (const hint of Array.from(lidHints.children)) {\n        hint.classList.remove(\"active\");\n    }\n    const lidHint = lidHints.children.item(selectedIndex);\n    if (lidHint)\n        lidHint.classList.add(\"active\");\n};\nconst suggestLeden = {\n    noDecorations: true,\n    char: '@',\n    name: 'lid-hint',\n    appendText: '',\n    keyBindings: {\n        ArrowUp: () => {\n            selectedIndex = (selectedIndex - 1 + lidList.length) % lidList.length;\n            updateLidHints();\n        },\n        ArrowDown: () => {\n            selectedIndex = (selectedIndex + 1) % lidList.length;\n            updateLidHints();\n        },\n        // Enter wordt niet opgepikt.\n        Enter: ({ command, event }) => {\n            event.preventDefault();\n            command(lidList[selectedIndex]);\n        },\n        Tab: ({ command, event }) => {\n            event.preventDefault();\n            command(lidList[selectedIndex]);\n        },\n        Esc: () => {\n            removeLidHints();\n        },\n    },\n    onChange: async ({ command, queryText, range, view }) => {\n        updateLidHintsPosition(view, view.coordsAtPos(range.end));\n        cancel.cancel();\n        cancel = axios.CancelToken.source();\n        try {\n            lidList = await search(queryText.full, cancel.token);\n            selectedIndex = 0;\n            createLidHints(command, view, view.coordsAtPos(range.end));\n        }\n        catch (_a) {\n            // noop, cancelled\n        }\n    },\n    onExit: () => {\n        cancel.cancel();\n        removeLidHints();\n        lidList = [];\n        selectedIndex = 0;\n    },\n    // Create a  function that is passed into the change, exit and keybinding handlers.\n    // This is useful when these handlers are called in a different part of the app.\n    createCommand: ({ match, view }) => {\n        return (lid) => {\n            if (!lid) {\n                return;\n            }\n            const tr = view.state.tr;\n            const { from, to } = match.range;\n            tr.replaceWith(from, to, view.state.schema.nodes.lid.createAndFill({ uid: lid.uid, naam: lid.value }));\n            view.dispatch(tr);\n        };\n    },\n};\nexport const lidHintPlugin = suggest(suggestLeden);\n","import { Plugin } from \"prosemirror-state\";\nimport { placeholderPlugin } from \"./placeholder\";\nimport { imageUpload } from \"../forum-plaatje\";\nimport { base64toFile } from \"../../lib/util\";\n/**\n * Verwijderd plaatjes zonder url. (Extern)\n * @param schema\n */\nexport const imageRemovePlugin = (schema) => new Plugin({\n    appendTransaction(trs, oldState, newState) {\n        let newTransaction = null;\n        newState.doc.descendants((node, pos) => {\n            if (node.type == schema.nodes.image && node.attrs.src.startsWith(\"data:\")) {\n                newTransaction = (newTransaction !== null && newTransaction !== void 0 ? newTransaction : newState.tr).deleteRange(pos, pos + 1);\n            }\n        });\n        return newTransaction;\n    },\n});\n/**\n * Upload plaatjes zonder url. (Intern)\n * @param schema\n */\nexport const imageUploadPlugin = (schema) => {\n    let view = null;\n    return new Plugin({\n        view: newView => {\n            view = newView;\n            return {};\n        },\n        appendTransaction(trs, oldState, newState) {\n            let newTransaction = null;\n            newState.doc.descendants((node, pos) => {\n                if (node.type == schema.nodes.image && node.attrs.src.startsWith(\"data:\")) {\n                    // Found an image\n                    const id = {};\n                    // Verwijder de afbeelding.\n                    newTransaction = newState.tr.deleteRange(pos, pos + 1);\n                    // Zorg ervoor dat er een placeholder op deze plek wordt neergezet.\n                    newTransaction.setMeta(placeholderPlugin, { add: { id, pos } });\n                    (async () => {\n                        // Converteer de data attribuut naar een file\n                        const file = await base64toFile(node.attrs.src, 'pastedImage');\n                        await imageUpload(view, file, id);\n                    })();\n                }\n            });\n            return newTransaction;\n        },\n    });\n};\n","import { EditorState } from \"prosemirror-state\";\nimport { EditorView } from \"prosemirror-view\";\nimport { Node } from \"prosemirror-model\";\nimport { schema } from \"./schema\";\nimport { exampleSetup } from \"prosemirror-example-setup\";\nimport { buildMenuItems } from \"./menu\";\nimport { htmlDecode } from \"../lib/util\";\nimport { bbPrompt } from \"./bb-prompt\";\nimport ctx from \"../ctx\";\nimport { placeholderPlugin } from \"./plugin/placeholder\";\nimport { trackChangesPlugin } from \"./plugin/track-changes\";\nimport { lidHintPlugin } from \"./plugin/lid-hint\";\nimport { imageRemovePlugin, imageUploadPlugin } from \"./plugin/image-upload\";\nctx.addHandler('.pm-editor', (el) => {\n    const extern = el.dataset.extern;\n    const menuContent = buildMenuItems(schema, window.loggedIn && !extern);\n    const input = document.querySelector('#' + el.dataset.prosemirrorDoc);\n    const text = htmlDecode(input.value.replace(/&quot;/g, \"\\\\\\\"\"));\n    window.currentEditor = new EditorView(el, {\n        state: EditorState.create({\n            doc: Node.fromJSON(schema, JSON.parse(text)),\n            plugins: [\n                lidHintPlugin,\n                (window.loggedIn ? imageUploadPlugin(schema) : imageRemovePlugin(schema)),\n                ...exampleSetup({\n                    schema,\n                    menuContent\n                }),\n                placeholderPlugin,\n                trackChangesPlugin(input),\n            ]\n        }),\n        handleDoubleClickOn(view, pos, node) {\n            if (node.type == schema.nodes.bb) {\n                bbPrompt(node.type, node.attrs, view);\n            }\n            return true;\n        }\n    });\n});\n","import { blockTypeItem, Dropdown, DropdownSubmenu, MenuItem, wrapItem } from \"prosemirror-menu\";\nimport { redo, undo } from \"prosemirror-history\";\nimport { bbInsert, blockTypeItemPrompt, canInsert, insertCitaat, insertImageItem, insertPlaatjeItem, lidInsert, linkItem, markItem, priveItem, wrapListItem } from \"./menu-item\";\nimport { cut } from \"../lib/util\";\nimport icon from \"./icon\";\nimport { joinUp, lift, selectParentNode } from \"prosemirror-commands\";\nexport function buildMenuItems(schema, loggedIn) {\n    return [\n        cut([\n            markItem(schema.marks.strong, { title: \"Schakel dikgedrukt\", icon: icon.strong }),\n            markItem(schema.marks.em, { title: \"Schakel schuingedrukt\", icon: icon.em }),\n            markItem(schema.marks.underline, { title: \"Schakel onderlijn\", icon: icon.underline }),\n            linkItem(schema.marks.link),\n            !loggedIn && markItem(schema.marks.prive, { title: \"Maak prive\", icon: icon.prive }),\n            new Dropdown(cut([\n                markItem(schema.marks.code, { title: \"Schakel code\", label: \"Code\" }),\n                markItem(schema.marks.superscript, { title: \"Schakel superscript\", label: \"Superscript\" }),\n                markItem(schema.marks.subscript, { title: \"Schakel subscript\", label: \"Subscript\" }),\n                markItem(schema.marks.strikethrough, { title: \"Schakel doorstreep\", label: \"Doorstreep\" }),\n                markItem(schema.marks.offtopic, { title: \"Schakel offtopic\", label: \"Offtopic\" }),\n                loggedIn && priveItem(schema.marks.prive),\n            ]), { label: \"Meer\" })\n        ]),\n        cut([\n            loggedIn && lidInsert(schema.nodes.lid),\n        ]),\n        cut([\n            new Dropdown(cut([\n                loggedIn && insertPlaatjeItem(schema.nodes.plaatje, schema.nodes.image),\n                !loggedIn && insertImageItem(schema.nodes.image),\n                loggedIn && insertCitaat(schema.nodes.citaat),\n                wrapItem(schema.nodes.blockquote, { title: \"Maak een quote\", label: \"Quote\" }),\n                loggedIn && blockTypeItemPrompt(schema.nodes.activiteit, \"Activiteitenketzer\", \"Activiteit invoegen\"),\n                loggedIn && blockTypeItemPrompt(schema.nodes.ketzer, \"Aanschafketzer\", \"Ketzer invoegen\"),\n                loggedIn && new DropdownSubmenu([\n                    blockTypeItemPrompt(schema.nodes.twitter, \"Twitter\", \"Twitter invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.youtube, \"YouTube\", \"YouTube invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.spotify, \"Spotify\", \"Spotify invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.video, \"Video\", \"Video invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.audio, \"Geluid\", \"Geluid invoegen\"),\n                ], { label: \"Embed\" }),\n                loggedIn && new DropdownSubmenu([\n                    blockTypeItemPrompt(schema.nodes.bestuur, \"Bestuur\", \"Bestuur invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.commissie, \"Commissie\", \"Commissie invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.groep, \"Groep\", \"Groep invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.ondervereniging, \"Ondervereniging\", \"Ondervereniging invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.verticale, \"Verticale\", \"Verticale invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.werkgroep, \"Werkgroep\", \"Werkgroep invoegen\"),\n                    blockTypeItemPrompt(schema.nodes.woonoord, \"Woonoord\", \"Woonoord invoegen\"),\n                ], { label: \"Groep\" }),\n                loggedIn && blockTypeItemPrompt(schema.nodes.boek, \"Boek\", \"Boek invoegen\"),\n                loggedIn && blockTypeItemPrompt(schema.nodes.document, \"Document\", \"Document invoegen\"),\n                loggedIn && blockTypeItemPrompt(schema.nodes.maaltijd, \"Maaltijd\", \"Maaltijd invoegen\"),\n                loggedIn && blockTypeItemPrompt(schema.nodes.peiling, \"Peiling\", \"Peiling invoegen\"),\n                new MenuItem({\n                    title: \"Horizontale lijn invoegen\",\n                    label: \"Lijn\",\n                    enable(state) {\n                        return canInsert(state, schema.nodes.horizontal_rule);\n                    },\n                    run(state, dispatch) {\n                        dispatch(state.tr.replaceSelectionWith(schema.nodes.horizontal_rule.create()));\n                    }\n                }),\n                wrapItem(schema.nodes.verklapper, {\n                    title: \"Stop selectie in verklapper\",\n                    label: \"Verklapper\"\n                }),\n                bbInsert(schema.nodes.bb),\n            ]), { label: \"Invoegen\" }),\n            new Dropdown([\n                blockTypeItem(schema.nodes.paragraph, {\n                    title: \"Verander naar een paragraaf\",\n                    label: \"Tekst\"\n                }),\n                blockTypeItem(schema.nodes.code_block, {\n                    title: \"Verander naar een code blok\",\n                    label: \"Code\"\n                }),\n                blockTypeItem(schema.nodes.heading, {\n                    title: \"Verander naar kop 1\",\n                    label: \"Titel\",\n                    attrs: { level: 1 },\n                }),\n                blockTypeItem(schema.nodes.heading, {\n                    title: \"Verander naar kop 2\",\n                    label: \"Kop\",\n                    attrs: { level: 2 },\n                }),\n                blockTypeItem(schema.nodes.heading, {\n                    title: \"Verander naar kop 3\",\n                    label: \"Subkop\",\n                    attrs: { level: 3 },\n                }),\n            ], { label: \"Stijl\" }),\n        ]),\n        [\n            new MenuItem({\n                title: \"Laatste wijziging ongedaan maken\",\n                run: undo,\n                enable: state => undo(state),\n                icon: icon.undo\n            }),\n            new MenuItem({\n                title: \"Herhaal de laatste ongedaan gemaakte wijziging\",\n                run: redo,\n                enable: state => redo(state),\n                icon: icon.redo\n            })\n        ],\n        [\n            wrapListItem(schema.nodes.bullet_list, {\n                title: \"Maak een puntenlijst\",\n                icon: icon.ul\n            }),\n            wrapListItem(schema.nodes.ordered_list, {\n                title: \"Maak een geordende lijst\",\n                icon: icon.ol\n            }),\n            new MenuItem({\n                title: \"Voeg samen met blok hier boven\",\n                run: joinUp,\n                select: state => joinUp(state),\n                icon: icon.join\n            }),\n            new MenuItem({\n                title: \"Til uit omvattende blok\",\n                run: lift,\n                select: state => lift(state),\n                icon: icon.lift\n            }),\n            new MenuItem({\n                title: \"Selecteer dit blok\",\n                run: selectParentNode,\n                select: state => selectParentNode(state),\n                icon: icon.selectParentNode\n            }),\n        ],\n    ];\n}\n","import $ from 'jquery';\nimport { init } from '../ctx';\nimport { modalClose, modalOpen } from './modal';\nimport { fadeAway, htmlParse } from './util';\nimport { select } from \"./dom\";\nexport function domUpdate(htmlString) {\n    if (typeof htmlString !== 'string') {\n        return;\n    }\n    htmlString = htmlString.trim();\n    if (htmlString.substring(0, 9) === '<!DOCTYPE') {\n        alert('response error');\n        throw new Error(htmlString);\n    }\n    const elements = htmlParse(htmlString);\n    for (const element of elements) {\n        if (!(element instanceof HTMLElement)) {\n            // element kan ook een stuk tekst zijn, hier kunnen we niets mee.\n            continue;\n        }\n        const id = element.id;\n        const parentId = element.getAttribute('parentid');\n        if (!id && element instanceof HTMLScriptElement) {\n            eval(element.innerText);\n            modalClose();\n            return;\n        }\n        // Probeer niet een lege id te laden.\n        const target = id ? document.querySelector(`#${id}`) : null;\n        const targetParent = parentId ? document.querySelector(`#${parentId}`) : null;\n        if (target) {\n            if (element.classList.contains('remove')) {\n                fadeAway(target, 400);\n            }\n            else {\n                // Jquery voert ook js uit, dat is nodig op dit moment voor forms\n                $(target).replaceWith($(element));\n            }\n        }\n        else if (targetParent) {\n            targetParent.append(element);\n        }\n        else if (element instanceof HTMLScriptElement) {\n            document.head.append(element);\n        }\n        else {\n            select('#maalcie-tabel tbody:visible:first').append(element); // FIXME: make generic\n        }\n        init(element);\n        if (id === 'modal') {\n            modalOpen();\n        }\n        else {\n            modalClose();\n        }\n    }\n}\n","import $ from 'jquery';\nexport function modalOpen(htmlString = '') {\n    const modal = $('#modal');\n    const modalBackdrop = $('.modal-backdrop');\n    if (modal.html() === '' && htmlString === '') {\n        return false;\n    }\n    if (modalBackdrop.length) {\n        modalBackdrop.remove();\n    }\n    if (htmlString !== '') {\n        modal.replaceWith(htmlString);\n        modal.find('input:visible:first').trigger('focus');\n    }\n    modal.modal('show');\n    $(document.body).trigger('modalOpen');\n    return true;\n}\nexport function modalClose() {\n    $('#modal').modal('hide');\n    $(document.body).trigger('modalClose');\n}\n","import $ from 'jquery';\nimport { modalClose } from './modal';\nimport axios from 'axios';\nimport { select } from \"./dom\";\nexport function ajaxRequest(type, url, data, source, onsuccess, onerror, onfinish) {\n    if (source) {\n        if (!source.classList.contains('noanim')) {\n            const img = $(`<img alt=\"Laden\" id=\"${source.id}\" title=\"${url}\" src=\"/images/loading-arrows.gif\" />`);\n            $(source).replaceWith(img);\n            source = img.get(0);\n        }\n        else if (source.classList.contains('InlineForm')) {\n            try {\n                Object.assign(select('.FormElement:first', source).style, {\n                    backgroundImage: 'url(\"/images/loading-fb.gif\")',\n                    backgroundPosition: 'center right',\n                    backgroundRepeat: 'no-repeat',\n                });\n            }\n            catch (e) {\n                // negeer\n            }\n        }\n        else {\n            source.classList.add('loading');\n        }\n    }\n    axios(url, {\n        method: type,\n        data,\n    }).then((response) => {\n        if (source) {\n            if (!$(source).hasClass('noanim')) {\n                $(source).hide();\n            }\n            else if ($(source).hasClass('InlineForm')) {\n                $(source).find('.FormElement:first').css({\n                    'background-image': '',\n                    'background-position': '',\n                    'background-repeat': '',\n                });\n            }\n            source.classList.remove('loading');\n        }\n        onsuccess(response.data);\n    }).catch((error) => {\n        if (source) {\n            $(source).replaceWith('<img alt=\"Mislukt\" title=\"' + error.message + '\" src=\"/plaetjes/famfamfam/cancel.png\" />');\n        }\n        else {\n            modalClose();\n        }\n        if (onerror) {\n            if (error.message.startsWith('<!DOC')) {\n                onerror('Er ging iets fout, code is: ' + error.code);\n            }\n            onerror(error.message);\n        }\n    }).then(() => {\n        if (onfinish) {\n            onfinish();\n        }\n    });\n}\n/**\n * @param url\n * @param ketzer\n * @returns {boolean}\n */\nexport function ketzerAjax(url, ketzer) {\n    $(ketzer + ' .aanmeldbtn').addClass('loading');\n    $.ajax({\n        cache: false,\n        data: '',\n        type: 'GET',\n        url,\n    }).done((data) => {\n        $(ketzer).replaceWith(data);\n    }).fail((jqXHR, textStatus, errorThrown) => {\n        $(ketzer + ' .aanmeldbtn')\n            .replaceWith($(`<div class=\"alert alert-danger\"><strong>Actie mislukt!</strong> ${errorThrown}</div>`));\n        throw new Error(jqXHR.responseText);\n    });\n    return true;\n}\n","import $ from 'jquery';\nimport { init } from '../ctx';\nimport { parseData } from '../lib/util';\nimport render from './render';\nexport function isDataTableResponse(response) {\n    const check = response;\n    return typeof response == 'object'\n        && \"lastUpdate\" in check\n        && \"autoUpdate\" in check\n        && \"data\" in check;\n}\nexport async function initDataTable(el) {\n    await import(/*webpackChunkName: \"bootstrap\"*/ './bootstrap');\n    const $el = $(el);\n    const settingsJson = $el.data('settings');\n    const search = $el.data('search');\n    // Zet de callback voor ajax\n    if (settingsJson.ajax) {\n        settingsJson.ajax.data.lastUpdate = fnGetLastUpdate($el);\n        settingsJson.ajax.dataSrc = fnAjaxUpdateCallback($el);\n    }\n    // Zet de render method op de columns\n    settingsJson.columns.forEach((col) => col.render = render[col.render]);\n    // Init DataTable\n    const table = $el.DataTable(settingsJson);\n    $el.dataTable().api().search(search);\n    table.on('page', () => table.rows({ selected: true }).deselect());\n    table.on('childRow.dt', (event, data) => init(data.container.get(0)));\n}\nexport async function initOfflineDataTable(el) {\n    await import(/*webpackChunkName: \"bootstrap\"*/ './bootstrap');\n    $(el).DataTable(parseData(el));\n}\n/****************************\n * Een paar functies om met datatables te\n * praten, laadt datatables zelf niet in.\n */\nexport function fnUpdateDataTable(tableId, response) {\n    const $table = $(tableId);\n    const table = $table.DataTable();\n    // update or remove existing rows or add new rows\n    response.data.forEach((row) => {\n        const $tr = $('tr[data-uuid=\"' + row.UUID + '\"]');\n        if ($tr.length === 1) {\n            if ('remove' in row) {\n                table.row($tr).remove();\n            }\n            else {\n                table.row($tr).data(row);\n                init($tr.get(0));\n            }\n        }\n        else if ($tr.length === 0) {\n            table.row.add(row);\n        }\n        else {\n            alert($tr.length);\n        }\n    });\n    table.draw(false);\n}\nexport function fnGetSelection(tableId) {\n    const selection = [];\n    $(tableId + ' tbody tr.selected').each(function () {\n        const uuid = $(this).attr('data-uuid');\n        if (!uuid) {\n            throw new Error(\"Tablerow heeft geen uuid\");\n        }\n        selection.push(uuid);\n    });\n    return selection;\n}\n// new Api(selector: Settings) is valide, maar wordt als type niet geaccepteerd, type lijkt niet uit te breiden.\n// https://datatables.net/reference/type/DataTables.Settings\nexport function getApiFromSettings(settings) {\n    return new $.fn.dataTable.Api(settings);\n}\n/**\n * Wordt gebruikt in gesprekken.\n *\n * @param {jQuery} $table\n */\nfunction fnAutoScroll($table) {\n    const $scroll = $table.parent();\n    if ($scroll.hasClass('dataTables_scrollBody')) {\n        const top = $scroll.scrollTop();\n        const height = $scroll.innerHeight();\n        if (!top || !height) {\n            throw new Error(\"$scroll heeft geen top of height\");\n        }\n        // autoscroll if already on bottom\n        if (top + height >= $scroll[0].scrollHeight - 20) {\n            // check before draw and scroll after\n            window.setTimeout(() => {\n                $scroll.animate({\n                    scrollTop: $scroll[0].scrollHeight,\n                }, 800);\n            }, 200);\n        }\n    }\n}\nexport const fnGetLastUpdate = ($table) => () => Number($table.data('lastupdate'));\nexport const fnSetLastUpdate = ($table) => (lastUpdate) => $table.data('lastupdate', lastUpdate);\n/**\n * Called after ajax load complete.\n *\n * @returns object\n * @param {jQuery} $table\n */\nexport const fnAjaxUpdateCallback = ($table) => (json) => {\n    fnSetLastUpdate($table)(json.lastUpdate);\n    const tableConfig = $table.DataTable();\n    if (json.autoUpdate) {\n        const timeout = parseInt(json.autoUpdate, 10);\n        if (!isNaN(timeout) && timeout < 600000) { // max 10 min\n            setTimeout(() => {\n                $.post(tableConfig.ajax.url(), {\n                    lastUpdate: fnGetLastUpdate($table),\n                }, (data) => {\n                    const tableId = $table.attr('id');\n                    if (!tableId) {\n                        throw new Error(\"Table heeft geen id\");\n                    }\n                    fnUpdateDataTable(tableId, data);\n                    fnAjaxUpdateCallback($table)(data);\n                });\n            }, timeout);\n        }\n    }\n    fnAutoScroll($table);\n    return json.data;\n};\nexport function replacePlaceholders(action, row) {\n    const replacements = /:(\\w+)/g.exec(action);\n    if (!replacements) {\n        return action;\n    }\n    for (let i = 1; i < replacements.length; i++) {\n        action = action.replace(':' + replacements[i], row[replacements[i]]);\n    }\n    return action;\n}\n","import axios from 'axios';\nimport $ from 'jquery';\nimport { fnGetSelection, fnUpdateDataTable, isDataTableResponse } from '../datatable/api';\nimport { ajaxRequest } from './ajax';\nimport { domUpdate } from './domUpdate';\nimport { modalClose } from './modal';\nimport { redirect, reload } from './reload';\nimport { parents, select, selectAll } from \"./dom\";\nimport { throwError } from \"./util\";\nrequire('../editor');\nexport function formIsChanged(form) {\n    let changed = false;\n    $(form).find('.FormElement').not('.tt-hint').each(function () {\n        const elmnt = $(this);\n        if (elmnt.is('input:radio')) {\n            if (elmnt.is(':checked') && elmnt.attr('origvalue') !== elmnt.val()) {\n                changed = true;\n                return false; // break each\n            }\n        }\n        else if (elmnt.is('input:checkbox')) {\n            if (elmnt.is(':checked') !== (elmnt.attr('origvalue') === '1')) {\n                changed = true;\n                return false; // break each\n            }\n        }\n        else if (elmnt.val() !== elmnt.attr('origvalue')) {\n            changed = true;\n            return false; // break each\n        }\n    });\n    return changed;\n}\n/**\n * @see templates/instellingen/beheer/instelling_row.tpl\n * @param form\n */\nexport function formInlineToggle(form) {\n    const $form = $(form);\n    $form.prev('.InlineFormToggle').toggle();\n    $form.toggle();\n    $form.children(':first').trigger('focus');\n}\nexport function formToggle(target, event) {\n    event.preventDefault();\n    formInlineToggle(select('form', parents(target)));\n    return false;\n}\nexport function formReset(event, form) {\n    const target = event.target;\n    if (!target || !(target instanceof HTMLElement)) {\n        throw new Error(\"formReset: geen EventTarget\");\n    }\n    if (!form) {\n        form = target.closest('form');\n        event.preventDefault();\n    }\n    if (!form) {\n        throw new Error(\"Geen form gevonden in formReset\");\n    }\n    if (target.classList.contains('confirm') && !confirm(target.title + '.\\n\\nWeet u het zeker?')) {\n        return false;\n    }\n    selectAll('.FormElement', form).forEach(function (el) {\n        const orig = el.getAttribute('origvalue');\n        if (orig && (el instanceof HTMLInputElement || el instanceof HTMLTextAreaElement)) {\n            el.value = orig;\n        }\n    });\n    return false;\n}\n/**\n * @see view/formulier/invoervelden/InputField.abstract.php\n * @see view/formulier/invoervelden/ZoekField.php\n * @param event\n * @returns {boolean}\n */\nexport function formSubmit(event) {\n    const target = event.target;\n    if (target.classList.contains('confirm')) {\n        let q = target.title;\n        if (q) {\n            q += '.\\n\\n';\n        }\n        else {\n            q = 'Weet u het zeker?';\n        }\n        if (!confirm(q)) {\n            event.preventDefault();\n            return false;\n        }\n    }\n    const form = target.closest('form');\n    if (!form || !form.classList.contains('Formulier')) {\n        return false;\n    }\n    if (form.classList.contains('PreventUnchanged') && !formIsChanged(form)) {\n        event.preventDefault();\n        alert('Geen wijzigingen');\n        return false;\n    }\n    const href = target.getAttribute('href');\n    if (href && href != '#') {\n        form.setAttribute('action', href);\n    }\n    if (!(form.classList.contains('ModalForm') || form.classList.contains('InlineForm'))) {\n        // kijk of er een manier is die niet jquery is\n        $(form).off('submit');\n        $(form).trigger('submit');\n        return true;\n    }\n    else {\n        event.preventDefault();\n        const formData = new FormData(form);\n        let done = domUpdate;\n        let source = null;\n        if (form.classList.contains('InlineForm')) {\n            source = form;\n            const id = form.id;\n            if (id) {\n                formData.append('InlineFormId', id);\n            }\n            if ($(form).data('submitCallback')) {\n                done = $(form).data('submitCallback');\n            }\n        }\n        if (form.classList.contains('ModalForm')) {\n            done = (response) => {\n                if (typeof response === 'string') {\n                    domUpdate(response);\n                }\n                else {\n                    modalClose();\n                }\n            };\n        }\n        if (form.classList.contains('DataTableResponse')) {\n            const tableId = form.dataset.tableid;\n            if (!tableId || !document.getElementById(tableId)) {\n                throw new Error(\"DataTable not found\");\n            }\n            formData.append('DataTableId', tableId);\n            const selection = fnGetSelection('#' + tableId);\n            $.each(selection, (key, value) => {\n                formData.append('DataTableSelection[]', value);\n            });\n            done = (response) => {\n                if (isDataTableResponse(response)) { // JSON\n                    fnUpdateDataTable('#' + tableId, response);\n                    if (response.modal) {\n                        domUpdate(response.modal);\n                    }\n                    else {\n                        modalClose();\n                    }\n                }\n                else if (typeof response === 'string') { // HTML\n                    domUpdate(response);\n                }\n                else {\n                    throw new Error('onbekende response' + response);\n                }\n            };\n            if (!form.classList.contains('noanim')) {\n                source = null;\n            }\n        }\n        if (form.classList.contains('ReloadPage')) {\n            done = reload;\n        }\n        else if (form.classList.contains('redirect')) {\n            done = redirect;\n        }\n        const url = form.getAttribute('action');\n        if (!url) {\n            throw new Error(\"Form heeft geen action\");\n        }\n        ajaxRequest('POST', url, formData, source, done, throwError, () => {\n            if (form.classList.contains('SubmitReset')) {\n                formReset(event, form);\n            }\n        });\n        return false;\n    }\n}\n/**\n * @see view/formulier/invoervelden/InputField.abstract.php\n * @param event\n * @returns {boolean}\n */\nexport function formCancel(event) {\n    const sourceEl = event.target;\n    if (!sourceEl || !(sourceEl instanceof HTMLElement)) {\n        throw new Error(\"formCancel: Geen EventTarget\");\n    }\n    if (sourceEl.classList.contains('confirm') && !confirm(sourceEl.title + '.\\n\\nWeet u het zeker?')) {\n        event.preventDefault();\n        return false;\n    }\n    const form = sourceEl.closest('form');\n    if (!form) {\n        throw new Error(\"Geen form in formCancel\");\n    }\n    if (form.classList.contains('InlineForm')) {\n        event.preventDefault();\n        formInlineToggle(form);\n        return false;\n    }\n    if (form.classList.contains('ModalForm')) {\n        event.preventDefault();\n        const href = sourceEl.getAttribute('href');\n        if (href) {\n            axios.get(href);\n        }\n        if (!formIsChanged(form) || confirm('Sluiten zonder wijzigingen op te slaan?')) {\n            modalClose();\n        }\n        return false;\n    }\n    return true;\n}\nexport function insertPlaatje(id) {\n    $.markItUp({ replaceWith: '[plaatje]' + id + '[/plaatje]' });\n}\nexport function initSterrenField(el) {\n    $(el).raty(Object.assign(Object.assign({}, JSON.parse(el.dataset.config)), { path: '/images/raty/', cancelHint: 'Wis beoordeling', cancelPlace: 'right', noRatedMsg: '', click: function (score) {\n            console.log(score);\n            $(this).raty('score', score);\n            $(this).closest('form').submit();\n        } }));\n}\n","import { domUpdate } from './domUpdate';\nexport function reload(htmlString) {\n    if (typeof htmlString === 'string' && htmlString.substring(0, 16) === '<div id=\"modal\" ') {\n        domUpdate(htmlString);\n        return;\n    }\n    location.reload();\n}\nexport function redirect(htmlString) {\n    if (htmlString.substring(0, 16) === '<div id=\"modal\" ') {\n        domUpdate(htmlString);\n        return;\n    }\n    window.location.href = htmlString;\n}\n","import moment from 'moment';\nimport { formatBedrag, formatFilesize } from '../lib/util';\nimport { getApiFromSettings } from './api';\n/**\n * Standaard gedefinieerde render functies.\n */\nexport default {\n    default(data, type) {\n        if (data === null || typeof data !== 'object') {\n            return data;\n        }\n        switch (type) {\n            case 'sort':\n                return data.sort;\n            case 'export':\n                return data.export;\n            default:\n                return data.display;\n        }\n    },\n    bedrag(data) {\n        return formatBedrag(data);\n    },\n    check(data) {\n        return '<span class=\"ico ' + (data ? 'tick' : 'cross') + '\"></span>';\n    },\n    aanmeldFilter(data) {\n        return data ? `<span class=\"ico group_key\" title=\"Aanmeld filter actief: '${data}'\"></span>` : '';\n    },\n    aanmeldingen(data, type, row) {\n        return row.aantal_aanmeldingen + ' (' + row.aanmeld_limiet + ')';\n    },\n    totaalPrijs(data, type, row) {\n        return formatBedrag(row.aantal_aanmeldingen * parseInt(row.prijs, 10));\n    },\n    datetime(date) {\n        if (Number(date) == date) {\n            return moment.unix(date).format('YYYY-MM-DD HH:mm');\n        }\n        if (!date) {\n            return '';\n        }\n        if (date.substr(0, 5) === '<time') {\n            return date;\n        }\n        if (date.substr(0, 1) === '-') {\n            return \"Nooit\";\n        }\n        return moment(date).format('YYYY-MM-DD HH:mm');\n    },\n    timeago(data, type, row, meta) {\n        const api = getApiFromSettings(meta.settings);\n        const cell = api.cell(meta.row, meta.col).node().firstChild;\n        switch (type) {\n            case 'sort':\n            case 'export':\n                return cell.dateTime;\n            default:\n                return data;\n        }\n    },\n    filesize(data, type) {\n        switch (type) {\n            case 'sort':\n                return Number(data);\n            default:\n                return formatFilesize(data);\n        }\n    },\n};\n"],"sourceRoot":""}