"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3378],{3378:(e,n,i)=>{i.r(n);var s=i(4474),t=i.n(s),r=i(4948),a=i(8307);const o=document.getElementsByTagName("meta")["vapid-public-key"].content;let c,l=!1;const u=async e=>{switch(e){case"ja":return await(async()=>{if(!l)return;const e=await Notification.requestPermission();if("denied"===e)throw new Error("The user explicitly denied the permission request.");if("granted"===e&&console.info("The user accepted the permission request."),c=await navigator.serviceWorker.ready,await(null==c?void 0:c.pushManager.getSubscription()))return void console.info("User is already subscribed.");const n={userVisibleOnly:!0,applicationServerKey:(0,a.Mp)(o)},i=await c.pushManager.subscribe(n);if(i)try{const e=await fetch("/push-abonnement",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!e.ok)throw new Error("Bad status code from server.");const n=await e.json();if(!n||!n.success)throw new Error("Bad response from server.");console.info("Successfully subscribed to push notifications.")}catch(e){throw await(null==i?void 0:i.unsubscribe()),e}})();case"nee":return await(async()=>{var e;if(!l)return;c=await navigator.serviceWorker.ready;const n=null!==(e=await(null==c?void 0:c.pushManager.getSubscription()))&&void 0!==e?e:null;if(!n)throw new Error("No existing subscription");const i=await fetch("/push-abonnement",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:n.endpoint})});if(!i.ok)throw new Error("Bad status code from server.");const s=await i.json();if(!s||!s.success)throw new Error("Bad response from server.");await(null==n?void 0:n.unsubscribe())&&console.info("Successfully unsubscribed from push notifications.")})()}};(async()=>{if(!o)return void(l=!1);const e=(0,r.Ys)("#inst_forum_meldingPush_ja"),n=(0,r.Ys)("#inst_forum_meldingPush_nee");if("serviceWorker"in navigator&&"PushManager"in window){c=await navigator.serviceWorker.ready;if(void 0!==c&&"pushManager"in c){if(navigator.userAgent.includes("iPhone")||navigator.userAgent.includes("Macintosh")&&"ontouchend"in document){const e=window.matchMedia("(display-mode: fullscreen)").matches||window.matchMedia("(display-mode: standalone)").matches;l=e}else l=!0}}if(l){await(null==c?void 0:c.pushManager.getSubscription())?e.checked=!0:n.checked=!0}else{(0,r.Ys)("#instelling-forum-meldingPush > div > div.btn-group").setAttribute("title","Push is niet beschikbaar op dit apparaat"),e.disabled=!0,n.disabled=!0,n.checked=!0}})();const d=async e=>{const n=e.target;let i=null,s=null;if(n.classList.add("loading"),n instanceof HTMLInputElement||n instanceof HTMLSelectElement){if(!n.checkValidity())return!1;i=n.dataset.href,s=n.value}else n instanceof HTMLAnchorElement&&(i=n.href);if(!i)throw new Error("Geen url gevonden voor instelling");try{if(i.includes("meldingPush")){const e=/meldingPush\/(\w+)/g.exec(i);await u(e[1])}else await t().post(i,{waarde:s}),document.querySelectorAll(".instellingen-bericht").forEach((e=>e.classList.remove("d-none")));n.classList.remove("loading")}catch(e){console.error(e),alert("WP Error: "+e.message)}};(0,a.o0)((()=>{document.querySelectorAll(".instellingKnop, .change-opslaan").forEach((e=>e.addEventListener("click",d)))}))}}]);
//# sourceMappingURL=3378.ae88a048125d9c3d77a3.chunk.js.map