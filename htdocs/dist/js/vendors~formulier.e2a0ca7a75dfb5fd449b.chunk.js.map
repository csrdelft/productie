{"version":3,"sources":["webpack:///../.yarn/cache/prosemirror-model-npm-1.13.1-69d3c422e0-c11b211404.zip/node_modules/prosemirror-model/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-state-npm-1.3.4-c4b4427e53-b15af9acab.zip/node_modules/prosemirror-state/dist/index.es.js","webpack:///../.yarn/cache/@remirror-core-helpers-npm-0.7.6-1f7dffc505-7ee8f6d2ec.zip/node_modules/@remirror/core-helpers/lib/dist/core-helpers.esm.js","webpack:///../.yarn/cache/crelt-npm-1.0.5-6dad646a54-12c81d1fc3.zip/node_modules/crelt/index.es.js","webpack:///../.yarn/cache/prosemirror-menu-npm-1.1.4-f1d0b04a6c-0953581b36.zip/node_modules/prosemirror-menu/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-commands-npm-1.1.5-49682fd359-e5cd22dfbc.zip/node_modules/prosemirror-commands/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-transform-npm-1.2.9-d6493b7767-f5e4fc950d.zip/node_modules/prosemirror-transform/dist/index.es.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///../.yarn/cache/rope-sequence-npm-1.3.2-cc341e8423-a4ab304045.zip/node_modules/rope-sequence/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-history-npm-1.1.3-45c1c5e7a3-62437ec882.zip/node_modules/prosemirror-history/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-inputrules-npm-1.1.3-1006d2d553-fddaf86ae4.zip/node_modules/prosemirror-inputrules/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-schema-list-npm-1.1.4-314796cf2a-7445ccdfe7.zip/node_modules/prosemirror-schema-list/dist/index.es.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///../.yarn/cache/prosemirror-view-npm-1.17.4-b9d748cddf-82d411031b.zip/node_modules/prosemirror-view/dist/index.es.js","webpack:///../.yarn/cache/webpack-npm-4.43.0-e073844e15-9f1e6375ba.zip/node_modules/webpack/buildin/global.js","webpack:///../.yarn/cache/w3c-keyname-npm-2.2.4-8c6e5969c5-b711eaa986.zip/node_modules/w3c-keyname/index.es.js","webpack:///../.yarn/cache/prosemirror-keymap-npm-1.1.4-cc2478e236-761162efd1.zip/node_modules/prosemirror-keymap/dist/index.es.js","webpack:///../.yarn/cache/corejs-typeahead-npm-1.3.1-6f321c4326-af82baff69.zip/node_modules/corejs-typeahead/dist/typeahead.bundle.js","webpack:///../.yarn/cache/orderedmap-npm-1.1.1-dffd12a1bd-d4e4857553.zip/node_modules/orderedmap/index.es.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/createClass.js","webpack:///../.yarn/cache/@remirror-core-constants-npm-0.7.4-e2e83cdeda-9e8b8a6c67.zip/node_modules/@remirror/core-constants/lib/dist/core-constants.esm.js","webpack:///../.yarn/cache/@remirror-core-utils-npm-0.8.0-e84b106689-582604c606.zip/node_modules/@remirror/core-utils/lib/dist/core-utils.esm.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///../.yarn/cache/timers-browserify-npm-2.0.11-f20435228f-73faad065e.zip/node_modules/timers-browserify/main.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///../.yarn/cache/isobject-npm-3.0.1-8145901fd2-b537a9ccdd.zip/node_modules/isobject/index.js","webpack:///../.yarn/cache/dom-walk-npm-0.1.2-7d20a1a8d8-948c7527f3.zip/node_modules/dom-walk/index.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/dom-element.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/event/dispatch-event.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/event/add-event-listener.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/event/remove-event-listener.js","webpack:///../.yarn/$virtual/prosemirror-suggest-virtual-2402e477b7/0/cache/prosemirror-suggest-npm-0.7.6-7b4e6bf185-43f58225a6.zip/node_modules/prosemirror-suggest/lib/dist/prosemirror-suggest.esm.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///../.yarn/cache/escape-string-regexp-npm-2.0.0-aef69d2a25-f3500f264e.zip/node_modules/escape-string-regexp/index.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/typeof.js","webpack:///../.yarn/cache/deepmerge-npm-4.2.2-112165ced2-85abf8e004.zip/node_modules/deepmerge/dist/cjs.js","webpack:///../.yarn/cache/fast-deep-equal-npm-2.0.1-9c01e08a62-ad315b79ab.zip/node_modules/fast-deep-equal/index.js","webpack:///../.yarn/cache/fast-memoize-npm-2.5.2-f42a7c6940-88bd914880.zip/node_modules/fast-memoize/src/index.js","webpack:///../.yarn/cache/object.omit-npm-3.0.0-272d141ea0-233f4b08ca.zip/node_modules/object.omit/index.js","webpack:///../.yarn/cache/object.pick-npm-1.3.0-dad8eae8fb-e22d555d3b.zip/node_modules/object.pick/index.js","webpack:///../.yarn/cache/nanoid-npm-2.1.11-60ba7b48b5-41453e344e.zip/node_modules/nanoid/index.browser.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/construct.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/index.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/objectWithoutProperties.js","webpack:///../.yarn/cache/util-npm-0.11.1-d2633dea18-f05afc3d9a.zip/node_modules/util/util.js","webpack:///../.yarn/cache/prosemirror-dropcursor-npm-1.3.2-cbe5e39b8e-953ef06c4f.zip/node_modules/prosemirror-dropcursor/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-view-npm-1.17.2-631af400b5-4dd727f293.zip/node_modules/prosemirror-view/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-gapcursor-npm-1.1.5-4f4961ab8d-870a81e140.zip/node_modules/prosemirror-gapcursor/dist/index.es.js","webpack:///../.yarn/cache/prosemirror-example-setup-npm-1.1.2-3f610530d1-ac2765643d.zip/node_modules/prosemirror-example-setup/dist/index.es.js","webpack:///../.yarn/cache/setimmediate-npm-1.0.5-54587459b6-87884d8add.zip/node_modules/setimmediate/setImmediate.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///../.yarn/cache/is-extendable-npm-1.0.1-7095ad8b16-2bf711afe6.zip/node_modules/is-extendable/index.js","webpack:///../.yarn/cache/is-plain-object-npm-2.0.4-da3265d804-2f32322673.zip/node_modules/is-plain-object/index.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/document.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/dom-comment.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/dom-text.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/serialize.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/dom-fragment.js","webpack:///../.yarn/cache/min-document-npm-2.19.0-458cdb3d84-8da883996e.zip/node_modules/min-document/event.js","webpack:///../.yarn/cache/@babel-runtime-npm-7.12.5-b3edb8ee8e-423fb00793.zip/node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","webpack:///../.yarn/cache/util-npm-0.11.1-d2633dea18-f05afc3d9a.zip/node_modules/util/support/isBufferBrowser.js","webpack:///../.yarn/cache/inherits-npm-2.0.3-401e64b080-9488f9433e.zip/node_modules/inherits/inherits_browser.js"],"names":["Fragment","content","size","this","i","length","nodeSize","prototypeAccessors","firstChild","configurable","lastChild","childCount","prototype","nodesBetween","from","to","f","nodeStart","parent","pos","child","end","start","Math","max","min","descendants","textBetween","blockSeparator","leafText","text","separated","node","isText","slice","isLeaf","isBlock","append","other","last","first","sameMarkup","withText","push","cut","result","cutByIndex","empty","replaceChild","index","current","copy","addToStart","concat","addToEnd","eq","get","found","RangeError","maybeChild","forEach","p","findDiffStart","a","b","childA","childB","j","inner","findDiffEnd","otherPos","posA","posB","iA","iB","same","minSize","findIndex","round","retIndex","curPos","toString","toStringInner","join","toJSON","map","n","fromJSON","schema","value","Array","isArray","nodeFromJSON","fromArray","array","joined","nodes","attrs","Object","defineProperties","offset","compareDeep","p$1","Mark","type","ReplaceError","message","err","Error","call","__proto__","addToSet","set","placed","excludes","rank","removeFromSet","isInSet","obj","name","_","json","marks","create","sameSet","setFrom","none","sort","constructor","Slice","openStart","openEnd","prototypeAccessors$1","replace","$from","$to","depth","replaceOuter","ref","$along","extra","resolveNoCache","prepareSliceForReplace","close","replaceThreeWay","$start","$end","joinable","addRange","checkJoin","addNode","replaceTwoWay","parentOffset","main","sub","compatibleContent","$before","$after","target","startIndex","endIndex","textOffset","nodeAfter","nodeBefore","validContent","insertAt","fragment","insertInto","dist","insert","canReplace","removeBetween","removeRange","ref$1","indexTo","offsetTo","maxOpen","openIsolating","spec","isolating","n$1","ResolvedPos","path","prototypeAccessors$2","doc","resolveDepth","val","indexAfter","before","after","dOff","posAtIndex","tmp","inclusive","marksAcross","isInline","next","sharedDepth","blockRange","pred","d","inlineContent","NodeRange","sameParent","str","resolve","rem","resolveCached","resolveCache","cached","resolveCachePos","resolveCacheSize","prototypeAccessors$1$1","emptyAttrs","Node","prototypeAccessors$3","textContent","isTextblock","isAtom","startPos","hasMarkup","defaultAttrs","mark","includeParents","nodeAt","childAfter","childBefore","rangeHasMark","toDebugString","wrapMarks","contentMatchAt","match","contentMatch","matchFragment","replacement","one","two","validEnd","allowsMarks","canReplaceWith","matchType","canAppend","check","markFromJSON","nodeType","TextNode","JSON","stringify","base","ContentMatch","wrapCache","prototypeAccessors$4","defaultType","edgeCount","parse","string","nodeTypes","stream","TokenStream","expr","parseExpr","nfa","labeled","explore","states","out","term","known","indexOf","nullFrom","state","states$1","cmp","dfa","connect","compile","exprs","reduce","loop","edge","loop$1","cur","i$1","next$1","i$2","next$2","edges","work","dead","hasRequiredAttrs","checkForDeadEnds","frag","compatible","fillBefore","toEnd","seen","search","types","finished","tp","createAndFill","findWrapping","computed","computeWrapping","active","via","shift","reverse","scan","m","inline","tokens","split","pop","prototypeAccessors$1$2","parseExprSeq","eat","parseExprSubscript","test","typeName","type$1","groups","resolveName","parseExprAtom","parseExprRange","parseNum","Number","defaults","attrName","attr","hasDefault","default","computeAttrs","built","given","undefined","initAttrs","Attribute","tok","SyntaxError","NodeType","group","markSet","prototypeAccessors$5","atom","isRequired","createChecked","allowsMarkType","markType","allowedMarks","topType","topNode","options","hasOwnProperty","prototypeAccessors$1$3","MarkType","excluded","instance","Schema","prop","contentExprCache","prop$1","contentExpr","markExpr","gatherMarks","prop$2","excl","bind","topNodeType","wrappings","ok","mark$1","text$1","DOMParser","rules","this$1","tags","styles","rule","tag","style","normalizeLists","some","r","dom","context","ParseContext","addAll","finish","parseSlice","matchTag","matches","namespace","namespaceURI","matchesContext","getAttrs","matchStyle","charCodeAt","schemaRules","priority","splice","parseDOM","rules$1","name$1","fromSchema","domParser","blockTags","address","article","aside","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","noscript","ol","output","pre","section","table","tfoot","ul","ignoreTags","head","object","script","title","listTags","wsOptionsFor","preserveWhitespace","NodeContext","pendingMarks","solid","activeMarks","stashMarks","fill","wrap","exec","popFromStashMark","applyPending","nextType","pending","markMayApply","parser","open","isOpen","topContext","topOptions","topMatch","find","findPositions","needsBlock","prototypeAccessors$6","top","currentPos","selector","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","v","returned","addDOM","addTextNode","getAttribute","readStyles","re","trim","parseStyles","addPendingMark","addElement","removePendingMark","nodeValue","domNodeBefore","previousSibling","nodeName","insertNode","findInText","findInside","matchAfter","ruleID","toLowerCase","prevItem","nextSibling","appendChild","normalizeList","ruleFromNode","ignore","skip","closeParent","sync","oldNeedsBlock","leafFallback","addElementByRule","consuming","ownerDocument","createTextNode","continueAfter","enter","startIn","getContent","contentDOM","contentElement","querySelector","findAround","childNodes","findAtPoint","findPlace","route","cx","enterInner","block","textblockFromContext","closeExtra","preserveWS","topOpen","contains","compareDocumentPosition","textNode","parts","option","useRoot","minDepth","part","$context","deflt","findSameMarkInSet","upto","level","lastIndexOf","stashMark","DOMSerializer","gatherToDOM","toDOM","document","window","serializeFragment","createDocumentFragment","keep","rendered","spanning","add","markDOM","serializeMark","serializeNode","renderSpec","onContent","serializeNodeAndMarks","structure","xmlNS","tagName","space","createElementNS","createElement","space$1","setAttributeNS","setAttribute","innerContent","domSerializer","nodesFromSchema","marksFromSchema","classesById","Selection","$anchor","$head","ranges","SelectionRange","anchor","tr","lastNode","lastParent","mapFrom","steps","mapping","replaceRange","selectionToInsertionEnd","replaceWith","deleteRange","replaceRangeWith","findFrom","$pos","dir","textOnly","TextSelection","findSelectionIn","near","bias","AllSelection","atStart","atEnd","cls","jsonID","id","selectionClass","getBookmark","between","visible","$cursor","ensureMarks","TextBookmark","dPos","NodeSelection","mapResult","deleted","NodeBookmark","isSelectable","selectable","delete","sel","selection","setSelection","AllBookmark","startLen","step","maps","_from","_to","_newFrom","newTo","Transaction","Transform","time","Date","now","curSelection","curSelectionFor","storedMarks","updated","meta","selectionSet","storedMarksSet","isGeneric","scrolledIntoView","setStoredMarks","addStoredMark","removeStoredMark","addStep","setTime","replaceSelection","replaceSelectionWith","inheritMarks","deleteSelection","insertText","setMeta","key","getMeta","scrollIntoView","self","FieldDesc","desc","init","apply","baseFields","config","_marks","_old","prev","Configuration","plugins","fields","pluginsByKey","plugin","EditorState","applyTransaction","filterTransaction","rootTr","transactions","trs","newState","applyInner","haveNew","appendTransaction","oldState","newInstance","field","applyListeners","$config","reconfigure","pluginFields","addApplyListener","removeApplyListener","Plugin","props","bindProps","Function","createKey","getState","keys","PluginKey","TypeName","Cast","arg","bool","getObjectType","isOfType","isObjectOfType","isUndefined","isString","isNumber","isNaN","isFunction","isNull","isNullOrUndefined","isObject","isRegExp","RegExp","findMatches","regexp","results","flags","includes","source","lastIndex","noop","crelt","elt","arguments","SVG","prefix","getIcon","icon","className","hash","hashPath","getElementById","data","collection","display","body","insertBefore","sym","width","height","buildSVG","svg","location","cloneNode","css","cssText","prefix$1","MenuItem","translate","view","_props","render","label","class","classList","addEventListener","e","preventDefault","run","dispatch","update","select","selected","enabled","enable","setClass","lastMenuEvent","markMenuEvent","isMenuEvent","wrapper","Dropdown","renderDropdownItems","items","updates","combineUpdates","something","up","listeningOnClose","removeEventListener","expand","menuDOM","done","removeChild","DropdownSubmenu","remove","icons","lift","selectParentNode","undo","redo","strong","em","code","link","bulletList","orderedList","joinUpItem","liftItem","selectParentNodeItem","undoItem","redoItem","wrapItem","passedOptions","blockTypeItem","command","on","prefix$2","menuBar","editorView","menu","spacer","parentNode","maxHeight","widthForMaxHeight","floating","separators","localUpdates","localNodes","update$1","span","needSep","hasContent","renderGrouped","contentUpdate","navigator","agent","userAgent","isIOS","updateFloat","potentialScrollers","res","getAllWrapping","scrollFunc","root","getBoundingClientRect","el","updateScrollCursor","offsetWidth","offsetHeight","minHeight","getSelection","focusNode","rects","getRangeAt","getClientRects","selRect","anchorNode","anchorOffset","focusOffset","DOCUMENT_POSITION_FOLLOWING","selectionIsInverted","menuRect","bottom","scrollable","scrollHeight","clientHeight","findWrappingScrollable","scrollTop","scrollAncestor","editorRect","position","left","border","clientWidth","innerHeight","destroy","textblockAt","side","findCutBefore","findCutAfter","joinUp","point","nodeSel","joinDown","range","defaultBlockAt","exitCode","above","splitBlock","can","setNodeMarkup","deleteBarrier","$cut","conn","clearIncompatible","joinMaybeClear","canDelAfter","joinAt","selAfter","at","wrap$1","end$1","wrapIn","wrapping","setBlockType","applicable","toggleMark","markApplies","has","ref$2","$from$1","$to$1","removeMark","spaceStart","spaceEnd","addMark","chainCommands","commands","len","backspace","endOfTextblock","del","pcBaseKeymap","macBaseKeymap","baseKeymap","platform","os","factor16","pow","recoverIndex","MapResult","recover","StepMap","inverted","diff","recoverOffset","assoc","_map","simple","oldIndex","newIndex","oldSize","newSize","touches","oldStart","newStart","invert","Mapping","mirror","TransformError","appendMap","mirrors","setMirror","appendMapping","startSize","mirr","getMirror","appendMappingInverted","totalSize","inverse","corr","docs","docChanged","mustOverride","maybeStep","failed","getMap","stepsByID","Step","_doc","_mapping","merge","_other","stepType","stepClass","StepResult","fail","fromReplace","ReplaceStep","contentBetween","slice$1","ReplaceAroundStep","gapFrom","gapTo","gap","inserted","canCut","liftTarget","innerRange","around","outer","findWrappingOutside","inside","innerMatch","findWrappingInside","withAttrs","canSplit","typesAfter","innerType","index$1","rest","baseType","canJoin","joinPoint","dropPoint","pass","insertPos","mapFragment","mapped","gapStart","gapEnd","splitting","d$1","splitting$1","wrappers","canChangeType","startM","endM","newNode","typeAfter","AddMarkStep","oldSlice","RemoveMarkStep","fitsTrivially","removed","added","removing","adding","newSet","s","matched","toRemove","found$1","parentType","delSteps","allowed","Fitter","fit","replaceStep","unplaced","frontier","dropFromFragment","count","addToFragment","contentAt","closeNodeStart","contentAfterFits","invalidMarks","closeFragment","oldOpen","newOpen","coveredDepths","findFittable","placeNodes","openMore","dropNode","moveInline","mustMoveInline","placedSize","sliceDepth","frontierDepth","inject","openAtEnd","closeFrontierNode","openFrontierNode","taken","openEndCount","findCloseLevel","dropInner","match$1","move","targetDepths","preferredTarget","unshift","defining","preferredTargetIndex","leftNodes","preferredDepth","openDepth","targetDepth","startSteps","insertPoint","covered","module","exports","defineProperty","enumerable","writable","RopeSequence","leafAppend","leafPrepend","appendInner","prepend","Append","sliceInner","getInner","forEachInner","forEachInvertedInner","values","Leaf","flatten","right","leftLen","Branch","eventCount","popEvent","preserveItems","remap","remapping","remaining","transform","addAfter","addBefore","item","Item","addTransform","histOptions","newItems","oldItems","lastItem","merged","cutPoint","overflow","DEPTH_OVERFLOW","mirrorPos","mirrorOffset","addMaps","rebased","rebasedTransform","rebasedCount","rebasedItems","newUntil","iRebased","newMaps","branch","emptyItemCount","compress","events","newItem","HistoryState","undone","prevRanges","prevTime","rangesFor","mapRanges","histTransaction","history","mustPreserveItems","historyKey","newHist","historyState","cachedPreserveItems","cachedPreserveItemsPlugins","historyPreserveItems","closeHistoryKey","newGroupDelay","hist","historyTr","appended","newGroup","adjacent","isAdjacentTo","InputRule","handler","cutOff","inputRules","stored","handleTextInput","handleDOMEvents","compositionend","setTimeout","isInputRules","composing","textBefore","undoInputRule","undoable","toUndo","emDash","ellipsis","smartQuotes","wrappingInputRule","joinPredicate","textblockTypeInputRule","olDOM","ulDOM","liDOM","order","hasAttribute","listItem","addListNodes","itemContent","listGroup","ordered_list","bullet_list","list_item","wrapInList","listType","doJoin","outerRange","$insert","joinBefore","splitDepth","splitPos","doWrapInList","splitListItem","itemType","grandParent","keepItem","tr$1","liftListItem","endOfList","liftToOuterList","list","indexBefore","liftOutOfList","sinkListItem","nestedBefore","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","arr","ie_edge","ie_upto10","ie_11up","mac","ie","ie_version","documentMode","gecko","gecko_version","chrome","chrome_version","safari","vendor","ios","maxTouchPoints","android","webkit","documentElement","webkit_version","domIndex","host","reusedRange","textRange","createRange","setEnd","setStart","isEquivalentPosition","off","targetNode","targetOff","scanFor","atomElements","hasBlockDesc","contentEditable","pmViewDesc","selectionCollapsed","domSel","collapsed","isCollapsed","rangeCount","keyEvent","keyCode","event","createEvent","initEvent","windowRect","getSide","clientRect","rect","scrollRectIntoView","startDOM","scrollThreshold","someProp","scrollMargin","atTop","bounding","moveX","moveY","defaultView","scrollBy","startX","scrollLeft","startY","dX","dY","scrollStack","stack","restoreScrollStack","dTop","preventScrollSupported","findOffsetInNode","coords","closest","coordsClosest","dxClosest","rowBot","rowTop","childIndex","dx","singleRect","inRect","findOffsetInText","posAtCoords","assign","assign$1","caretPositionFromPoint","pos$1","offsetNode","caretRangeFromPoint","startContainer","startOffset","elementFromPoint","box","element","startI","floor","draggable","targetKludge","box$1","outside","docView","nearestDesc","posBefore","posAfter","posFromDOM","posFromCaret","posFromElement","posAtStart","BIDI","coordsAtPos","domFromPos","supportEmptyRange","takeSide","flattenV","rectBefore","rectAfter","flattenH","before$1","after$1","target$1","x","y","withFlushedState","viewState","activeElement","updateState","focus","maybeRTL","cachedState","cachedDir","cachedResult","nearest","boxes","endOfTextblockVertical","modify","oldRange","oldNode","oldOff","oldBidiLevel","caretBidiLevel","domAfterPos","removeAllRanges","endOfTextblockHorizontal","ViewDesc","children","dirty","beforePosition","posAtEnd","contentLost","domAtom","matchesWidget","matchesMark","matchesNode","matchesHack","parseRule","stopEvent","posBeforeChild","localPosFromDOM","domBefore","domAfter","desc$1","search$1","onlyNodes","getDesc","nodeDOM","descAt","parseRange","fromOffset","toOffset","childBase","emptyChildAt","j$1","force","anchorDOM","headDOM","brKludge","offset$1","domSelExtended","extend","collapse","DOMException","ignoreMutation","mutation","markDirty","startInside","endInside","markParentsDirty","nothing","WidgetViewDesc","widget","raw","stop","ignoreSelection","CompositionViewDesc","textDOM","mut","oldValue","MarkViewDesc","custom","nodeViews","replaceNodes","NodeViewDesc","outerDeco","innerDeco","updateChildren","descObj","applyOuterDeco","CustomNodeViewDesc","TextViewDesc","reparseInView","sameOuterDeco","composition","localCompositionNode","updater","ViewTreeUpdater","deco","onWidget","onNode","locals","forChild","decoIndex","restNode","parentIndex","widgets","compareSide","child$1","cutAt","i$3","filter","iterDeco","insideNode","syncToMarks","placeWidget","findNodeMatch","updateNextNode","addTextblockHacks","destroyRest","changed","protectLocalComposition","renderDescs","parentDOM","descs","written","childDOM","rm","trackWrites","oldCSS","getComputedStyle","listStyle","iosHacks","nearbyTextNode","textPos","childStart","findTextInFragment","compositionNodes","updateInner","updateOuterDeco","needsWrap","oldDOM","patchOuterDeco","computeOuterDeco","selectNode","deselectNode","removeAttribute","docViewDesc","pmIsDeco","inParent","BRHackViewDesc","OuterDecoLevel","noDeco","outerDOM","prevComputed","curComputed","curDOM","patchAttributes","prevList","curList","removeProperty","lockedNode","lock","preMatch","preMatched","preMatchOffset","selectionFromDOM","origin","inWidget","isOnEdge","selectionBetween","selectionToDOM","syncNodeSelection","editable","hasFocus","hasSelection","domObserver","disconnectSelection","cursorWrapper","img","disabled","selectCursorWrapper","resetEditableFrom","resetEditableTo","brokenSelectBetweenUneditable","temporarilyEditableNear","resetEditable","hideSelectionGuard","removeClassOnSelectionChange","setCurSelection","connectSelection","getPreMatch","destroyBetween","maxKeep","markDesc","nextDOM","setEditable","wasDraggable","lastSelectedViewDesc","clearNodeSelection","moveSelectionBlock","$side","selectHorizontally","mods","nodePos","nodeLen","isIgnorable","skipIgnoredNodesLeft","moveNode","moveOffset","isBlockNode","setSelFocus","skipIgnoredNodesRight","selectVertically","beyond","stopNativeHorizontalDelete","nextNode","switchEditable","captureKeyDown","ctrlKey","metaKey","altKey","shiftKey","getMods","safariDownArrowBug","readDOMChange","typeOver","addedNodes","lastSelectionTime","lastSelectionOrigin","newSel","shared","from_","to_","lastKeyCode","startDoc","editableContent","anchor$1","parseBetween","preferredPos","preferredSide","compare","lastKeyCodeTime","change","endA","endB","adjust","findDiff","lastIOSEnter","sel$1","resolveSelection","domChangeCount","nextSel","inlineChange","old","$newStart","$newEnd","skipClosingAndOpening","$next","looksLikeJoin","suppressSelectionUpdates","markChange","$from1","chFrom","chTo","curMarks","prevMarks","isMarkChange","sel$2","parsedSel","fromEnd","mayOpen","serializeForClipboard","serializer","detachedDoc","wrapMap","parseFromClipboard","html","plainText","inCode","asText","parsed","metas","firstTag","innerHTML","readHTML","contextNode","sliceData","addContext","closeRange","closeSlice","lastWrap","inLast","addToSibling","sibling","withWrappers","closeRight","wrapped","normalizeSiblings","thead","tbody","caption","colgroup","col","td","th","_detachedDoc","implementation","createHTMLDocument","observeOptions","childList","characterData","characterDataOldValue","attributes","attributeOldValue","subtree","useCharData","SelectionState","DOMObserver","handleDOMChange","queue","flushingSoon","observer","MutationObserver","mutations","removedNodes","flushSoon","flush","currentSelection","onCharData","prevValue","onSelectionChange","suppressingSelectionUpdates","forceFlush","clearTimeout","observe","take","takeRecords","disconnect","ignoreSelectionChange","container","commonAncestorContainer","result$1","registerMutation","brs","cssChecked","whiteSpace","console","checkCSS","attributeName","handlers","editHandlers","setSelectionOrigin","ensureListeners","currentHandlers","eventHandlers","runCustomHandler","defaultPrevented","eventCoords","clientX","clientY","runHandlerOnContext","propName","updateSelection","focused","handleSingleClick","selectedNode","selectAt","selectClickedNode","selectClickedLeaf","handleDoubleClick","handleTripleClick","defaultTripleClick","forceDOMFlush","endComposition","keydown","inOrNearComposition","lastIOSEnterFallbackTimeout","keyup","keypress","charCode","String","fromCharCode","selectNodeModifier","mousedown","flushed","lastClick","click","dy","isNear","mouseDown","MouseDown","targetPos","allowDefault","mightDrag","targetDesc","addAttr","setUneditable","abs","timeStamp","compositionEndedAt","touchdown","contextmenu","timeoutComposition","scheduleComposeEnd","delay","composingTimeout","clearComposition","forceUpdate","compositionstart","compositionupdate","markCursor","brokenClipboardAPI","doPaste","singleNode","sliceSingleNode","clipboardData","clearData","setData","selectNodeContents","blur","captureCopy","paste","getData","capturePaste","Dragging","dragCopyModifier","dragstart","dataTransfer","dragging","dragend","dragover","dragenter","drop","eventPos","$mouse","isNode","beforeInsert","beforeinput","inputType","compareObjs","WidgetType","noSpec","oldOffset","Decoration","valid","InlineType","inclusiveStart","inclusiveEnd","is","DecorationSet","local","decorations","buildTree","predicate","findInner","childOff","mapInner","newLocal","onRemove","oldChildren","oldEnd","newEnd","dSize","mustRebuild","fromLocal","toLocal","childOffset","childNode","gather","mapAndGatherRemainingDecorations","from$1","byPos","mapChildren","addInner","baseOffset","takeSpansForNode","moveSpans","withoutNulls","removeInner","span$1","dec","localSet","DecorationGroup","removeOverlap","localsInner","members","spans","hasNulls","localStart","working","insertAhead","viewDecorations","sorted","EditorView","place","_root","mount","mounted","getEditable","updateCursorWrapper","buildNodeViews","computeDocDeco","bubbles","eventBelongsToView","initInput","pluginViews","updatePluginViews","contenteditable","updateStateInner","setProps","reconfigured","redraw","updateSel","nA","nB","changedNodeViews","scroll","scrollToSelection","updateDoc","sel1","sel2","refDOM","refTop","newRefTop","oldScrollPos","overflowAnchor","localRect","storeScrollPos","forceSelUpdate","chromeKludge","destroyPluginViews","prevState","pluginView","setActive","preventScroll","focusPreventScroll","getPrototypeOf","domAtPos","posAtDOM","destroyInput","dispatchEvent","dispatchTransaction","g","8","9","10","12","13","16","17","18","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","106","107","108","109","110","111","144","145","160","161","162","163","164","165","173","186","187","188","189","190","191","192","219","220","221","222","229","48","49","50","51","52","53","54","55","56","57","brokenModifierNames","normalizeKeyName","alt","ctrl","mod","modifiers","keymap","bindings","handleKeyDown","keydownHandler","normalize","baseName","keyName","isChar","direct","fromCode","withShift","a0","$","isMsie","isBlankString","escapeRegExChars","isPlainObject","isElement","isJQuery","toStr","proxy","each","cb","grep","every","mixin","identity","clone","getIdGenerator","counter","templatify","defer","fn","debounce","func","wait","immediate","timeout","later","callNow","args","throttle","previous","guid","_p8","random","substr","tokenizers","nonword","whitespace","ngram","getObjTokenizer","word","char","tokenizer","o","k","LruCache","maxSize","reset","List","tail","tailItem","moveToFront","PersistentStorage","LOCAL_STORAGE","localStorage","setItem","removeItem","override","ttlKey","keyMatcher","ls","_noop","_prefix","_ttlKey","clear","isExpired","_safeSet","decode","getItem","ttl","encode","gatherMatchingKeys","getTime","parseJSON","Transport","pendingRequestsCount","pendingRequests","sharedCache","maxPendingRequests","cancelled","lastReq","_send","transport","_get","limiter","_cache","cache","setMaxPendingRequests","num","resetCache","_fingerprint","url","param","fingerprint","jqXhr","that","resp","always","onDeckRequestArgs","cancel","SearchIndex","datumTokenizer","queryTokenizer","error","identify","matchAnyQueryToken","bootstrap","datums","trie","datum","normalizeTokens","token","chars","ch","ids","query","arrayA","arrayB","ai","bi","intersection","lenArrayA","lenArrayB","getIntersection","uniques","unique","all","serialize","Prefetch","prepare","thumbprint","storage","cacheKey","protocol","_settings","dataType","store","fromCache","fromNetwork","settings","Remote","indexResponse","cancelLastRequest","oParser","sorter","initialize","sufficient","indexRemote","prefetch","remote","callbackToDeferred","ajax","parsePrefetch","wildcard","rateLimitBy","rateLimitWait","encodeURIComponent","toRemotePrepare","method","toLimiter","parseRemote","deferred","Deferred","reject","Bloodhound","noConflict","__ttAdapter","async","_loadPrefetch","serialized","promise","_initialize","initPromise","nonDuplicates","l","clearPrefetchCache","clearRemoteCache","ttAdapter","WWW","defaultClassNames","input","hint","dataset","suggestion","cursor","highlight","www","classes","c","borderColor","boxShadow","opacity","verticalAlign","backgroundColor","inputWithNoHint","zIndex","ltr","rtl","backgroundImage","selectors","buildSelectors","EventBus","deprecationMap","$el","cursorchange","autocomplete","_trigger","$e","Event","trigger","isDefaultPrevented","deprecatedType","EventEmitter","splitter","nextTick","setImmediate","onSync","onAsync","_callbacks","callbacks","syncFlush","asyncFlush","getFlush","bindContext","pattern","wordsOnly","caseSensitive","diacriticInsensitive","accented","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","regex","patterns","regexStr","escapedPatterns","escapedWord","accent_replacer","getRegex","traverse","hightlightTextNode","patternNode","wrapperNode","splitText","chr","toUpperCase","Input","specialKeyCodeMap","$input","$hint","$menu","role","queryWhenFocused","$overflowHelper","visibility","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","wordSpacing","letterSpacing","textIndent","textRendering","textTransform","insertAfter","_checkLanguageDirection","setHint","getHint","clearHint","clearHintIfInvalid","_updateDescendent","normalizeQuery","_onBlur","resetInputValue","_onFocus","_onKeydown","which","_managePreventDefault","_shouldTrigger","_onInput","_setQuery","getInputValue","withModifier","silent","areEquivalent","hasDifferentWhitespace","onBlur","onFocus","onKeydown","onInput","getLangDir","getQuery","setQuery","setInputValue","hasQueryChangedSinceLastFocus","valIsPrefixOfHint","hasOverflow","constraint","isCursorAtEnd","valueLength","selectionStart","moveStart","setAriaExpanded","Dataset","nameGenerator","templates","displayFn","notFound","limit","displayKey","template","_resetLastSuggestion","addClass","extractData","_overwrite","suggestions","_renderSuggestions","_renderPending","_renderNotFound","_empty","_append","$lastSuggestion","_appendSuggestions","$fragment","_getSuggestionsFragment","_getHeader","_getFooter","_injectQuery","_query","canceled","syncCalled","idx","isEmpty","Menu","$node","datasets","oDataset","appendTo","_onSelectableClick","currentTarget","_onRendered","toggleClass","_allDatasetsEmpty","_onCleared","_propagate","_getSelectables","_removeCursor","$selectable","getActiveSelectable","removeClass","_ensureVisible","elTop","elBottom","nodeScrollTop","nodeHeight","outerHeight","parseInt","onSelectableClick","setCursor","hasClass","setLanguageDirection","selectableRelativeToCursor","delta","$selectables","$oldCursor","getSelectableData","getTopSelectable","isValidUpdate","Status","padding","clip","cleared","words","DefaultMenu","_show","_hide","hide","Typeahead","onFocused","onBlurred","onEnterKeyed","onTabKeyed","onEscKeyed","onUpKeyed","onDownKeyed","onLeftKeyed","onRightKeyed","onQueryChanged","onWhitespaceChanged","eventBus","minLength","autoselect","activate","_hacks","_onSelectableClicked","_onAsyncRequested","_onAsyncCanceled","_onAsyncReceived","_onDatasetRendered","_onDatasetCleared","_onLangDirChanged","isActive","hasActive","stopImmediatePropagation","_updateHint","cursorClass","_onFocused","_minLengthMet","_onBlurred","_onEnterKeyed","stopPropagation","_onTabKeyed","_onEscKeyed","_onUpKeyed","moveCursor","_onDownKeyed","_onLeftKeyed","_onRightKeyed","_onQueryChanged","_onWhitespaceChanged","_openIfActive","escapedQuery","isEnabled","disable","deactivate","setVal","getVal","$candidate","datasetName","ctx","methods","ttEach","$els","typeahead","buildHintFromInput","removeData","backgroundAttachment","backgroundClip","backgroundOrigin","backgroundPosition","backgroundRepeat","backgroundSize","readonly","required","removeAttr","spellcheck","tabindex","prepInput","$elOrNull","classNames","attach","$wrapper","defaultHint","defaultMenu","MenuConstructor","t","success","newVal","detach","revert","OrderedMap","newKey","without","subtract","orderedmap","_defineProperties","descriptor","Constructor","protoProps","staticProps","Side","NULL_CHARACTER","MarkGroup","NodeGroup","ExtensionType","Tags","RemirrorClassName","EMPTY_PARAGRAPH_NODE","isProsemirrorNode","isSelection","getPluginState","selectionEmpty","isEditorState","transactionChanged","ownKeys$1","enumerableOnly","getOwnPropertySymbols","symbols","getOwnPropertyDescriptor","findChildren","_ref2","descend","_ref","_ref$descend","findNodeByPredicate","_ref3","params","getOwnPropertyDescriptors","_objectSpread$1","TypeError","Timeout","clearFn","_id","_clearFn","scope","setInterval","clearInterval","unref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","_onTimeout","global","clearImmediate","arrayLikeToArray","minLen","arr2","ret","domWalk","htmlns","DOMElement","owner","ns","_attributes","elem","needle","localName","colonPosition","getAttributeNS","removeAttributeNS","hasAttributeNS","getElementsByClassName","elems","nodeClasses","getElementsByTagName","ev","listeners","listener","handleEvent","ExitReason","ChangeReason","defaultHandler","DEFAULT_SUGGESTER","appendText","createCommand","ignoredClassName","ignoredTag","invalidPrefixCharacters","keyBindings","matchOffset","noDecorations","onChange","onCharacterEntry","onExit","startOfLine","suggestClassName","suggestTag","supportedCharacters","validPrefixCharacters","isValidMatch","queryText","full","suggester","escapeChar","_char","regexToString","regexOrString","getRegexPrefix","onlyStartOfLine","getRegexSupportedCharacters","ownKeys","_objectSpread","createMatchWithReason","reason","findPosition","matchPrefix","matchLength","partial","matchText","findMatch","_ref4","_char2","createRegexFromSuggester","recheckMatch","_ref5","_unused","createInsertReason","_ref6","exit","Removed","End","Split","InvalidSplit","runKeyBindings","_ref10","entries","_ref11","_ref12","transformKeyBindings","findReason","_ref13","isJump","_ref7","updatedPrev","JumpForward","JumpBackward","findJumpReason","isEntry","Start","isExit","_ref9","SelectionOutside","MoveEnd","MoveStart","findExitReason","isChange","Text","isMove","Move","SelectionInside","SuggestState","suggesters","_this","_this$handlerMatches","handlerMatches","exitParams","createReasonParams","changeParams","movedForwards","_ref$specific","specific","decoration","ignored","decorationsToClear","names","setMarkRemoved","setRemovedTrue","addIgnored","clearIgnored","getCommand","createParams","invalid","_ref14","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","_unused2","warn","findFromSuggesters","shouldIgnoreMatch","onViewUpdate","_ref8","mapIgnoredDecorations","resetState","updateReasons","_match$suggester","decorationsTag","suggestionClassName","suggestPluginKey","suggest","_len","_key","pluginState","_view","viewHandler","arrayWithHoles","iterableToArrayLimit","nonIterableRest","matchOperatorsRegex","_typeof","isMergeableObject","isNonNullObject","stringValue","$$typeof","REACT_ELEMENT_TYPE","isReactElement","isSpecial","for","cloneUnlessOtherwiseSpecified","deepmerge","defaultArrayMerge","getKeys","symbol","propertyIsEnumerable","getEnumerableOwnPropertySymbols","propertyIsOnObject","property","mergeObject","destination","propertyIsUnsafe","customMerge","getMergeFunction","arrayMerge","sourceIsArray","deepmerge_1","keyList","hasProp","equal","arrA","arrB","dateA","dateB","regexpA","regexpB","monadic","computedValue","variadic","assemble","strategy","strategyDefault","serializerDefault","ObjectWithoutPrototypeCache","cacheDefault","strategies","crypto","msCrypto","bytes","getRandomValues","Uint8Array","setPrototypeOf","isNativeReflectConstruct","_construct","Parent","Class","Reflect","construct","Document","objectWithoutPropertiesLoose","sourceSymbolKeys","descriptors","formatRegExp","format","objects","inspect","deprecate","msg","process","noDeprecation","warned","throwDeprecation","traceDeprecation","trace","debugEnviron","debugs","opts","stylize","stylizeNoColor","colors","isBoolean","showHidden","_extend","customInspect","stylizeWithColor","formatValue","styleType","recurseTimes","primitive","formatPrimitive","visibleKeys","arrayToHash","getOwnPropertyNames","isError","formatError","isDate","braces","toUTCString","formatProperty","formatArray","numLinesEst","reduceToSingleString","line","ar","objectToString","pad","debuglog","env","NODE_DEBUG","pid","isSymbol","isPrimitive","isBuffer","months","timestamp","getHours","getMinutes","getSeconds","getDate","getMonth","log","inherits","kCustomPromisifiedSymbol","callbackifyOnRejected","newReason","promisify","original","promiseResolve","promiseReject","Promise","callbackify","callbackified","maybeCb","then","rej","dropCursor","DropCursorView","color","cursorPos","updateOverlay","nodeRect","offsetParent","parentRect","pageXOffset","pageYOffset","scheduleRemoval","dragleave","relatedTarget","GapCursor","GapBookmark","closedBefore","closedAfter","allowGapCursor","mustMove","$cur","$cur$1","arrow","axis","dirStr","$found","handleClick","drawGapCursor","openPrompt","mouseOutside","domFields","submitButton","cancelButton","buttons","innerWidth","submit","read","bad","validate","reportInvalid","clean","getValues","callback","elements","offsetLeft","offsetTop","Field","validateType","_value","TextField","placeholder","canInsert","cmdItem","cmd","markActive","markItem","wrapListItem","buildMenuItems","toggleStrong","toggleEm","toggleCode","toggleLink","href","image","insertImage","src","wrapBulletList","wrapOrderedList","wrapBlockQuote","paragraph","makeParagraph","code_block","makeCodeBlock","heading","horizontal_rule","insertHorizontalRule","insertMenu","typeMenu","makeHead1","makeHead2","makeHead3","makeHead4","makeHead5","makeHead6","inlineMenu","blockMenu","fullMenu","buildKeymap","mapKeys","hard_break","br","buildInputRules","orderedListRule","bulletListRule","codeBlockRule","maxLevel","headingRule","exampleSetup","createSelectionBetween","floatingMenu","menuContent","registerImmediate","channel","messagePrefix","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","attachTo","handle","runIfPresent","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","MessageChannel","port1","port2","onreadystatechange","attachEvent","task","_arr","_n","_d","_e","_s","_i","iter","isObjectObject","ctor","prot","_setPrototypeOf","sham","Proxy","Comment","DOMText","DocumentFragment","proto","family","createComment","replaceData","substring","voidElements","escapeText","strings","tagname","isProperty","attribute","properties","ds","datasetify","innerText","serializeElement","tuple","stylify","cancelable","sourceKeys","readUInt8","superCtor","super_","TempCtor"],"mappings":"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","file":"js/vendors~formulier.e2a0ca7a75dfb5fd449b.chunk.js","sourcesContent":["import OrderedMap from 'orderedmap';\n\nfunction findDiffStart(a, b, pos) {\n  for (var i = 0;; i++) {\n    if (i == a.childCount || i == b.childCount)\n      { return a.childCount == b.childCount ? null : pos }\n\n    var childA = a.child(i), childB = b.child(i);\n    if (childA == childB) { pos += childA.nodeSize; continue }\n\n    if (!childA.sameMarkup(childB)) { return pos }\n\n    if (childA.isText && childA.text != childB.text) {\n      for (var j = 0; childA.text[j] == childB.text[j]; j++)\n        { pos++; }\n      return pos\n    }\n    if (childA.content.size || childB.content.size) {\n      var inner = findDiffStart(childA.content, childB.content, pos + 1);\n      if (inner != null) { return inner }\n    }\n    pos += childA.nodeSize;\n  }\n}\n\nfunction findDiffEnd(a, b, posA, posB) {\n  for (var iA = a.childCount, iB = b.childCount;;) {\n    if (iA == 0 || iB == 0)\n      { return iA == iB ? null : {a: posA, b: posB} }\n\n    var childA = a.child(--iA), childB = b.child(--iB), size = childA.nodeSize;\n    if (childA == childB) {\n      posA -= size; posB -= size;\n      continue\n    }\n\n    if (!childA.sameMarkup(childB)) { return {a: posA, b: posB} }\n\n    if (childA.isText && childA.text != childB.text) {\n      var same = 0, minSize = Math.min(childA.text.length, childB.text.length);\n      while (same < minSize && childA.text[childA.text.length - same - 1] == childB.text[childB.text.length - same - 1]) {\n        same++; posA--; posB--;\n      }\n      return {a: posA, b: posB}\n    }\n    if (childA.content.size || childB.content.size) {\n      var inner = findDiffEnd(childA.content, childB.content, posA - 1, posB - 1);\n      if (inner) { return inner }\n    }\n    posA -= size; posB -= size;\n  }\n}\n\n// ::- A fragment represents a node's collection of child nodes.\n//\n// Like nodes, fragments are persistent data structures, and you\n// should not mutate them or their content. Rather, you create new\n// instances whenever needed. The API tries to make this easy.\nvar Fragment = function Fragment(content, size) {\n  this.content = content;\n  // :: number\n  // The size of the fragment, which is the total of the size of its\n  // content nodes.\n  this.size = size || 0;\n  if (size == null) { for (var i = 0; i < content.length; i++)\n    { this.size += content[i].nodeSize; } }\n};\n\nvar prototypeAccessors = { firstChild: { configurable: true },lastChild: { configurable: true },childCount: { configurable: true } };\n\n// :: (number, number, (node: Node, start: number, parent: Node, index: number)  ?bool, ?number)\n// Invoke a callback for all descendant nodes between the given two\n// positions (relative to start of this fragment). Doesn't descend\n// into a node when the callback returns `false`.\nFragment.prototype.nodesBetween = function nodesBetween (from, to, f, nodeStart, parent) {\n    if ( nodeStart === void 0 ) nodeStart = 0;\n\n  for (var i = 0, pos = 0; pos < to; i++) {\n    var child = this.content[i], end = pos + child.nodeSize;\n    if (end > from && f(child, nodeStart + pos, parent, i) !== false && child.content.size) {\n      var start = pos + 1;\n      child.nodesBetween(Math.max(0, from - start),\n                         Math.min(child.content.size, to - start),\n                         f, nodeStart + start);\n    }\n    pos = end;\n  }\n};\n\n// :: ((node: Node, pos: number, parent: Node)  ?bool)\n// Call the given callback for every descendant node. The callback\n// may return `false` to prevent traversal of a given node's children.\nFragment.prototype.descendants = function descendants (f) {\n  this.nodesBetween(0, this.size, f);\n};\n\n// : (number, number, ?string, ?string)  string\nFragment.prototype.textBetween = function textBetween (from, to, blockSeparator, leafText) {\n  var text = \"\", separated = true;\n  this.nodesBetween(from, to, function (node, pos) {\n    if (node.isText) {\n      text += node.text.slice(Math.max(from, pos) - pos, to - pos);\n      separated = !blockSeparator;\n    } else if (node.isLeaf && leafText) {\n      text += leafText;\n      separated = !blockSeparator;\n    } else if (!separated && node.isBlock) {\n      text += blockSeparator;\n      separated = true;\n    }\n  }, 0);\n  return text\n};\n\n// :: (Fragment)  Fragment\n// Create a new fragment containing the combined content of this\n// fragment and the other.\nFragment.prototype.append = function append (other) {\n  if (!other.size) { return this }\n  if (!this.size) { return other }\n  var last = this.lastChild, first = other.firstChild, content = this.content.slice(), i = 0;\n  if (last.isText && last.sameMarkup(first)) {\n    content[content.length - 1] = last.withText(last.text + first.text);\n    i = 1;\n  }\n  for (; i < other.content.length; i++) { content.push(other.content[i]); }\n  return new Fragment(content, this.size + other.size)\n};\n\n// :: (number, ?number)  Fragment\n// Cut out the sub-fragment between the two given positions.\nFragment.prototype.cut = function cut (from, to) {\n  if (to == null) { to = this.size; }\n  if (from == 0 && to == this.size) { return this }\n  var result = [], size = 0;\n  if (to > from) { for (var i = 0, pos = 0; pos < to; i++) {\n    var child = this.content[i], end = pos + child.nodeSize;\n    if (end > from) {\n      if (pos < from || end > to) {\n        if (child.isText)\n          { child = child.cut(Math.max(0, from - pos), Math.min(child.text.length, to - pos)); }\n        else\n          { child = child.cut(Math.max(0, from - pos - 1), Math.min(child.content.size, to - pos - 1)); }\n      }\n      result.push(child);\n      size += child.nodeSize;\n    }\n    pos = end;\n  } }\n  return new Fragment(result, size)\n};\n\nFragment.prototype.cutByIndex = function cutByIndex (from, to) {\n  if (from == to) { return Fragment.empty }\n  if (from == 0 && to == this.content.length) { return this }\n  return new Fragment(this.content.slice(from, to))\n};\n\n// :: (number, Node)  Fragment\n// Create a new fragment in which the node at the given index is\n// replaced by the given node.\nFragment.prototype.replaceChild = function replaceChild (index, node) {\n  var current = this.content[index];\n  if (current == node) { return this }\n  var copy = this.content.slice();\n  var size = this.size + node.nodeSize - current.nodeSize;\n  copy[index] = node;\n  return new Fragment(copy, size)\n};\n\n// : (Node)  Fragment\n// Create a new fragment by prepending the given node to this\n// fragment.\nFragment.prototype.addToStart = function addToStart (node) {\n  return new Fragment([node].concat(this.content), this.size + node.nodeSize)\n};\n\n// : (Node)  Fragment\n// Create a new fragment by appending the given node to this\n// fragment.\nFragment.prototype.addToEnd = function addToEnd (node) {\n  return new Fragment(this.content.concat(node), this.size + node.nodeSize)\n};\n\n// :: (Fragment)  bool\n// Compare this fragment to another one.\nFragment.prototype.eq = function eq (other) {\n  if (this.content.length != other.content.length) { return false }\n  for (var i = 0; i < this.content.length; i++)\n    { if (!this.content[i].eq(other.content[i])) { return false } }\n  return true\n};\n\n// :: ?Node\n// The first child of the fragment, or `null` if it is empty.\nprototypeAccessors.firstChild.get = function () { return this.content.length ? this.content[0] : null };\n\n// :: ?Node\n// The last child of the fragment, or `null` if it is empty.\nprototypeAccessors.lastChild.get = function () { return this.content.length ? this.content[this.content.length - 1] : null };\n\n// :: number\n// The number of child nodes in this fragment.\nprototypeAccessors.childCount.get = function () { return this.content.length };\n\n// :: (number)  Node\n// Get the child node at the given index. Raise an error when the\n// index is out of range.\nFragment.prototype.child = function child (index) {\n  var found = this.content[index];\n  if (!found) { throw new RangeError(\"Index \" + index + \" out of range for \" + this) }\n  return found\n};\n\n// :: (number)  ?Node\n// Get the child node at the given index, if it exists.\nFragment.prototype.maybeChild = function maybeChild (index) {\n  return this.content[index]\n};\n\n// :: ((node: Node, offset: number, index: number))\n// Call `f` for every child node, passing the node, its offset\n// into this parent node, and its index.\nFragment.prototype.forEach = function forEach (f) {\n  for (var i = 0, p = 0; i < this.content.length; i++) {\n    var child = this.content[i];\n    f(child, p, i);\n    p += child.nodeSize;\n  }\n};\n\n// :: (Fragment)  ?number\n// Find the first position at which this fragment and another\n// fragment differ, or `null` if they are the same.\nFragment.prototype.findDiffStart = function findDiffStart$1 (other, pos) {\n    if ( pos === void 0 ) pos = 0;\n\n  return findDiffStart(this, other, pos)\n};\n\n// :: (Fragment)  ?{a: number, b: number}\n// Find the first position, searching from the end, at which this\n// fragment and the given fragment differ, or `null` if they are the\n// same. Since this position will not be the same in both nodes, an\n// object with two separate positions is returned.\nFragment.prototype.findDiffEnd = function findDiffEnd$1 (other, pos, otherPos) {\n    if ( pos === void 0 ) pos = this.size;\n    if ( otherPos === void 0 ) otherPos = other.size;\n\n  return findDiffEnd(this, other, pos, otherPos)\n};\n\n// : (number, ?number)  {index: number, offset: number}\n// Find the index and inner offset corresponding to a given relative\n// position in this fragment. The result object will be reused\n// (overwritten) the next time the function is called. (Not public.)\nFragment.prototype.findIndex = function findIndex (pos, round) {\n    if ( round === void 0 ) round = -1;\n\n  if (pos == 0) { return retIndex(0, pos) }\n  if (pos == this.size) { return retIndex(this.content.length, pos) }\n  if (pos > this.size || pos < 0) { throw new RangeError((\"Position \" + pos + \" outside of fragment (\" + (this) + \")\")) }\n  for (var i = 0, curPos = 0;; i++) {\n    var cur = this.child(i), end = curPos + cur.nodeSize;\n    if (end >= pos) {\n      if (end == pos || round > 0) { return retIndex(i + 1, end) }\n      return retIndex(i, curPos)\n    }\n    curPos = end;\n  }\n};\n\n// :: ()  string\n// Return a debugging string that describes this fragment.\nFragment.prototype.toString = function toString () { return \"<\" + this.toStringInner() + \">\" };\n\nFragment.prototype.toStringInner = function toStringInner () { return this.content.join(\", \") };\n\n// :: ()  ?Object\n// Create a JSON-serializeable representation of this fragment.\nFragment.prototype.toJSON = function toJSON () {\n  return this.content.length ? this.content.map(function (n) { return n.toJSON(); }) : null\n};\n\n// :: (Schema, ?Object)  Fragment\n// Deserialize a fragment from its JSON representation.\nFragment.fromJSON = function fromJSON (schema, value) {\n  if (!value) { return Fragment.empty }\n  if (!Array.isArray(value)) { throw new RangeError(\"Invalid input for Fragment.fromJSON\") }\n  return new Fragment(value.map(schema.nodeFromJSON))\n};\n\n// :: ([Node])  Fragment\n// Build a fragment from an array of nodes. Ensures that adjacent\n// text nodes with the same marks are joined together.\nFragment.fromArray = function fromArray (array) {\n  if (!array.length) { return Fragment.empty }\n  var joined, size = 0;\n  for (var i = 0; i < array.length; i++) {\n    var node = array[i];\n    size += node.nodeSize;\n    if (i && node.isText && array[i - 1].sameMarkup(node)) {\n      if (!joined) { joined = array.slice(0, i); }\n      joined[joined.length - 1] = node.withText(joined[joined.length - 1].text + node.text);\n    } else if (joined) {\n      joined.push(node);\n    }\n  }\n  return new Fragment(joined || array, size)\n};\n\n// :: (?union<Fragment, Node, [Node]>)  Fragment\n// Create a fragment from something that can be interpreted as a set\n// of nodes. For `null`, it returns the empty fragment. For a\n// fragment, the fragment itself. For a node or array of nodes, a\n// fragment containing those nodes.\nFragment.from = function from (nodes) {\n  if (!nodes) { return Fragment.empty }\n  if (nodes instanceof Fragment) { return nodes }\n  if (Array.isArray(nodes)) { return this.fromArray(nodes) }\n  if (nodes.attrs) { return new Fragment([nodes], nodes.nodeSize) }\n  throw new RangeError(\"Can not convert \" + nodes + \" to a Fragment\" +\n                       (nodes.nodesBetween ? \" (looks like multiple versions of prosemirror-model were loaded)\" : \"\"))\n};\n\nObject.defineProperties( Fragment.prototype, prototypeAccessors );\n\nvar found = {index: 0, offset: 0};\nfunction retIndex(index, offset) {\n  found.index = index;\n  found.offset = offset;\n  return found\n}\n\n// :: Fragment\n// An empty fragment. Intended to be reused whenever a node doesn't\n// contain anything (rather than allocating a new empty fragment for\n// each leaf node).\nFragment.empty = new Fragment([], 0);\n\nfunction compareDeep(a, b) {\n  if (a === b) { return true }\n  if (!(a && typeof a == \"object\") ||\n      !(b && typeof b == \"object\")) { return false }\n  var array = Array.isArray(a);\n  if (Array.isArray(b) != array) { return false }\n  if (array) {\n    if (a.length != b.length) { return false }\n    for (var i = 0; i < a.length; i++) { if (!compareDeep(a[i], b[i])) { return false } }\n  } else {\n    for (var p in a) { if (!(p in b) || !compareDeep(a[p], b[p])) { return false } }\n    for (var p$1 in b) { if (!(p$1 in a)) { return false } }\n  }\n  return true\n}\n\n// ::- A mark is a piece of information that can be attached to a node,\n// such as it being emphasized, in code font, or a link. It has a type\n// and optionally a set of attributes that provide further information\n// (such as the target of the link). Marks are created through a\n// `Schema`, which controls which types exist and which\n// attributes they have.\nvar Mark = function Mark(type, attrs) {\n  // :: MarkType\n  // The type of this mark.\n  this.type = type;\n  // :: Object\n  // The attributes associated with this mark.\n  this.attrs = attrs;\n};\n\n// :: ([Mark])  [Mark]\n// Given a set of marks, create a new set which contains this one as\n// well, in the right position. If this mark is already in the set,\n// the set itself is returned. If any marks that are set to be\n// [exclusive](#model.MarkSpec.excludes) with this mark are present,\n// those are replaced by this one.\nMark.prototype.addToSet = function addToSet (set) {\n  var copy, placed = false;\n  for (var i = 0; i < set.length; i++) {\n    var other = set[i];\n    if (this.eq(other)) { return set }\n    if (this.type.excludes(other.type)) {\n      if (!copy) { copy = set.slice(0, i); }\n    } else if (other.type.excludes(this.type)) {\n      return set\n    } else {\n      if (!placed && other.type.rank > this.type.rank) {\n        if (!copy) { copy = set.slice(0, i); }\n        copy.push(this);\n        placed = true;\n      }\n      if (copy) { copy.push(other); }\n    }\n  }\n  if (!copy) { copy = set.slice(); }\n  if (!placed) { copy.push(this); }\n  return copy\n};\n\n// :: ([Mark])  [Mark]\n// Remove this mark from the given set, returning a new set. If this\n// mark is not in the set, the set itself is returned.\nMark.prototype.removeFromSet = function removeFromSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (this.eq(set[i]))\n      { return set.slice(0, i).concat(set.slice(i + 1)) } }\n  return set\n};\n\n// :: ([Mark])  bool\n// Test whether this mark is in the given set of marks.\nMark.prototype.isInSet = function isInSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (this.eq(set[i])) { return true } }\n  return false\n};\n\n// :: (Mark)  bool\n// Test whether this mark has the same type and attributes as\n// another mark.\nMark.prototype.eq = function eq (other) {\n  return this == other ||\n    (this.type == other.type && compareDeep(this.attrs, other.attrs))\n};\n\n// :: ()  Object\n// Convert this mark to a JSON-serializeable representation.\nMark.prototype.toJSON = function toJSON () {\n  var obj = {type: this.type.name};\n  for (var _ in this.attrs) {\n    obj.attrs = this.attrs;\n    break\n  }\n  return obj\n};\n\n// :: (Schema, Object)  Mark\nMark.fromJSON = function fromJSON (schema, json) {\n  if (!json) { throw new RangeError(\"Invalid input for Mark.fromJSON\") }\n  var type = schema.marks[json.type];\n  if (!type) { throw new RangeError((\"There is no mark type \" + (json.type) + \" in this schema\")) }\n  return type.create(json.attrs)\n};\n\n// :: ([Mark], [Mark])  bool\n// Test whether two sets of marks are identical.\nMark.sameSet = function sameSet (a, b) {\n  if (a == b) { return true }\n  if (a.length != b.length) { return false }\n  for (var i = 0; i < a.length; i++)\n    { if (!a[i].eq(b[i])) { return false } }\n  return true\n};\n\n// :: (?union<Mark, [Mark]>)  [Mark]\n// Create a properly sorted mark set from null, a single mark, or an\n// unsorted array of marks.\nMark.setFrom = function setFrom (marks) {\n  if (!marks || marks.length == 0) { return Mark.none }\n  if (marks instanceof Mark) { return [marks] }\n  var copy = marks.slice();\n  copy.sort(function (a, b) { return a.type.rank - b.type.rank; });\n  return copy\n};\n\n// :: [Mark] The empty set of marks.\nMark.none = [];\n\n// ReplaceError:: class extends Error\n// Error type raised by [`Node.replace`](#model.Node.replace) when\n// given an invalid replacement.\n\nfunction ReplaceError(message) {\n  var err = Error.call(this, message);\n  err.__proto__ = ReplaceError.prototype;\n  return err\n}\n\nReplaceError.prototype = Object.create(Error.prototype);\nReplaceError.prototype.constructor = ReplaceError;\nReplaceError.prototype.name = \"ReplaceError\";\n\n// ::- A slice represents a piece cut out of a larger document. It\n// stores not only a fragment, but also the depth up to which nodes on\n// both side are open (cut through).\nvar Slice = function Slice(content, openStart, openEnd) {\n  // :: Fragment The slice's content.\n  this.content = content;\n  // :: number The open depth at the start.\n  this.openStart = openStart;\n  // :: number The open depth at the end.\n  this.openEnd = openEnd;\n};\n\nvar prototypeAccessors$1 = { size: { configurable: true } };\n\n// :: number\n// The size this slice would add when inserted into a document.\nprototypeAccessors$1.size.get = function () {\n  return this.content.size - this.openStart - this.openEnd\n};\n\nSlice.prototype.insertAt = function insertAt (pos, fragment) {\n  var content = insertInto(this.content, pos + this.openStart, fragment, null);\n  return content && new Slice(content, this.openStart, this.openEnd)\n};\n\nSlice.prototype.removeBetween = function removeBetween (from, to) {\n  return new Slice(removeRange(this.content, from + this.openStart, to + this.openStart), this.openStart, this.openEnd)\n};\n\n// :: (Slice)  bool\n// Tests whether this slice is equal to another slice.\nSlice.prototype.eq = function eq (other) {\n  return this.content.eq(other.content) && this.openStart == other.openStart && this.openEnd == other.openEnd\n};\n\nSlice.prototype.toString = function toString () {\n  return this.content + \"(\" + this.openStart + \",\" + this.openEnd + \")\"\n};\n\n// :: ()  ?Object\n// Convert a slice to a JSON-serializable representation.\nSlice.prototype.toJSON = function toJSON () {\n  if (!this.content.size) { return null }\n  var json = {content: this.content.toJSON()};\n  if (this.openStart > 0) { json.openStart = this.openStart; }\n  if (this.openEnd > 0) { json.openEnd = this.openEnd; }\n  return json\n};\n\n// :: (Schema, ?Object)  Slice\n// Deserialize a slice from its JSON representation.\nSlice.fromJSON = function fromJSON (schema, json) {\n  if (!json) { return Slice.empty }\n  var openStart = json.openStart || 0, openEnd = json.openEnd || 0;\n  if (typeof openStart != \"number\" || typeof openEnd != \"number\")\n    { throw new RangeError(\"Invalid input for Slice.fromJSON\") }\n  return new Slice(Fragment.fromJSON(schema, json.content), openStart, openEnd)\n};\n\n// :: (Fragment, ?bool)  Slice\n// Create a slice from a fragment by taking the maximum possible\n// open value on both side of the fragment.\nSlice.maxOpen = function maxOpen (fragment, openIsolating) {\n    if ( openIsolating === void 0 ) openIsolating=true;\n\n  var openStart = 0, openEnd = 0;\n  for (var n = fragment.firstChild; n && !n.isLeaf && (openIsolating || !n.type.spec.isolating); n = n.firstChild) { openStart++; }\n  for (var n$1 = fragment.lastChild; n$1 && !n$1.isLeaf && (openIsolating || !n$1.type.spec.isolating); n$1 = n$1.lastChild) { openEnd++; }\n  return new Slice(fragment, openStart, openEnd)\n};\n\nObject.defineProperties( Slice.prototype, prototypeAccessors$1 );\n\nfunction removeRange(content, from, to) {\n  var ref = content.findIndex(from);\n  var index = ref.index;\n  var offset = ref.offset;\n  var child = content.maybeChild(index);\n  var ref$1 = content.findIndex(to);\n  var indexTo = ref$1.index;\n  var offsetTo = ref$1.offset;\n  if (offset == from || child.isText) {\n    if (offsetTo != to && !content.child(indexTo).isText) { throw new RangeError(\"Removing non-flat range\") }\n    return content.cut(0, from).append(content.cut(to))\n  }\n  if (index != indexTo) { throw new RangeError(\"Removing non-flat range\") }\n  return content.replaceChild(index, child.copy(removeRange(child.content, from - offset - 1, to - offset - 1)))\n}\n\nfunction insertInto(content, dist, insert, parent) {\n  var ref = content.findIndex(dist);\n  var index = ref.index;\n  var offset = ref.offset;\n  var child = content.maybeChild(index);\n  if (offset == dist || child.isText) {\n    if (parent && !parent.canReplace(index, index, insert)) { return null }\n    return content.cut(0, dist).append(insert).append(content.cut(dist))\n  }\n  var inner = insertInto(child.content, dist - offset - 1, insert);\n  return inner && content.replaceChild(index, child.copy(inner))\n}\n\n// :: Slice\n// The empty slice.\nSlice.empty = new Slice(Fragment.empty, 0, 0);\n\nfunction replace($from, $to, slice) {\n  if (slice.openStart > $from.depth)\n    { throw new ReplaceError(\"Inserted content deeper than insertion position\") }\n  if ($from.depth - slice.openStart != $to.depth - slice.openEnd)\n    { throw new ReplaceError(\"Inconsistent open depths\") }\n  return replaceOuter($from, $to, slice, 0)\n}\n\nfunction replaceOuter($from, $to, slice, depth) {\n  var index = $from.index(depth), node = $from.node(depth);\n  if (index == $to.index(depth) && depth < $from.depth - slice.openStart) {\n    var inner = replaceOuter($from, $to, slice, depth + 1);\n    return node.copy(node.content.replaceChild(index, inner))\n  } else if (!slice.content.size) {\n    return close(node, replaceTwoWay($from, $to, depth))\n  } else if (!slice.openStart && !slice.openEnd && $from.depth == depth && $to.depth == depth) { // Simple, flat case\n    var parent = $from.parent, content = parent.content;\n    return close(parent, content.cut(0, $from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))\n  } else {\n    var ref = prepareSliceForReplace(slice, $from);\n    var start = ref.start;\n    var end = ref.end;\n    return close(node, replaceThreeWay($from, start, end, $to, depth))\n  }\n}\n\nfunction checkJoin(main, sub) {\n  if (!sub.type.compatibleContent(main.type))\n    { throw new ReplaceError(\"Cannot join \" + sub.type.name + \" onto \" + main.type.name) }\n}\n\nfunction joinable($before, $after, depth) {\n  var node = $before.node(depth);\n  checkJoin(node, $after.node(depth));\n  return node\n}\n\nfunction addNode(child, target) {\n  var last = target.length - 1;\n  if (last >= 0 && child.isText && child.sameMarkup(target[last]))\n    { target[last] = child.withText(target[last].text + child.text); }\n  else\n    { target.push(child); }\n}\n\nfunction addRange($start, $end, depth, target) {\n  var node = ($end || $start).node(depth);\n  var startIndex = 0, endIndex = $end ? $end.index(depth) : node.childCount;\n  if ($start) {\n    startIndex = $start.index(depth);\n    if ($start.depth > depth) {\n      startIndex++;\n    } else if ($start.textOffset) {\n      addNode($start.nodeAfter, target);\n      startIndex++;\n    }\n  }\n  for (var i = startIndex; i < endIndex; i++) { addNode(node.child(i), target); }\n  if ($end && $end.depth == depth && $end.textOffset)\n    { addNode($end.nodeBefore, target); }\n}\n\nfunction close(node, content) {\n  if (!node.type.validContent(content))\n    { throw new ReplaceError(\"Invalid content for node \" + node.type.name) }\n  return node.copy(content)\n}\n\nfunction replaceThreeWay($from, $start, $end, $to, depth) {\n  var openStart = $from.depth > depth && joinable($from, $start, depth + 1);\n  var openEnd = $to.depth > depth && joinable($end, $to, depth + 1);\n\n  var content = [];\n  addRange(null, $from, depth, content);\n  if (openStart && openEnd && $start.index(depth) == $end.index(depth)) {\n    checkJoin(openStart, openEnd);\n    addNode(close(openStart, replaceThreeWay($from, $start, $end, $to, depth + 1)), content);\n  } else {\n    if (openStart)\n      { addNode(close(openStart, replaceTwoWay($from, $start, depth + 1)), content); }\n    addRange($start, $end, depth, content);\n    if (openEnd)\n      { addNode(close(openEnd, replaceTwoWay($end, $to, depth + 1)), content); }\n  }\n  addRange($to, null, depth, content);\n  return new Fragment(content)\n}\n\nfunction replaceTwoWay($from, $to, depth) {\n  var content = [];\n  addRange(null, $from, depth, content);\n  if ($from.depth > depth) {\n    var type = joinable($from, $to, depth + 1);\n    addNode(close(type, replaceTwoWay($from, $to, depth + 1)), content);\n  }\n  addRange($to, null, depth, content);\n  return new Fragment(content)\n}\n\nfunction prepareSliceForReplace(slice, $along) {\n  var extra = $along.depth - slice.openStart, parent = $along.node(extra);\n  var node = parent.copy(slice.content);\n  for (var i = extra - 1; i >= 0; i--)\n    { node = $along.node(i).copy(Fragment.from(node)); }\n  return {start: node.resolveNoCache(slice.openStart + extra),\n          end: node.resolveNoCache(node.content.size - slice.openEnd - extra)}\n}\n\n// ::- You can [_resolve_](#model.Node.resolve) a position to get more\n// information about it. Objects of this class represent such a\n// resolved position, providing various pieces of context information,\n// and some helper methods.\n//\n// Throughout this interface, methods that take an optional `depth`\n// parameter will interpret undefined as `this.depth` and negative\n// numbers as `this.depth + value`.\nvar ResolvedPos = function ResolvedPos(pos, path, parentOffset) {\n  // :: number The position that was resolved.\n  this.pos = pos;\n  this.path = path;\n  // :: number\n  // The number of levels the parent node is from the root. If this\n  // position points directly into the root node, it is 0. If it\n  // points into a top-level paragraph, 1, and so on.\n  this.depth = path.length / 3 - 1;\n  // :: number The offset this position has into its parent node.\n  this.parentOffset = parentOffset;\n};\n\nvar prototypeAccessors$2 = { parent: { configurable: true },doc: { configurable: true },textOffset: { configurable: true },nodeAfter: { configurable: true },nodeBefore: { configurable: true } };\n\nResolvedPos.prototype.resolveDepth = function resolveDepth (val) {\n  if (val == null) { return this.depth }\n  if (val < 0) { return this.depth + val }\n  return val\n};\n\n// :: Node\n// The parent node that the position points into. Note that even if\n// a position points into a text node, that node is not considered\n// the parenttext nodes are flat in this model, and have no content.\nprototypeAccessors$2.parent.get = function () { return this.node(this.depth) };\n\n// :: Node\n// The root node in which the position was resolved.\nprototypeAccessors$2.doc.get = function () { return this.node(0) };\n\n// :: (?number)  Node\n// The ancestor node at the given level. `p.node(p.depth)` is the\n// same as `p.parent`.\nResolvedPos.prototype.node = function node (depth) { return this.path[this.resolveDepth(depth) * 3] };\n\n// :: (?number)  number\n// The index into the ancestor at the given level. If this points at\n// the 3rd node in the 2nd paragraph on the top level, for example,\n// `p.index(0)` is 1 and `p.index(1)` is 2.\nResolvedPos.prototype.index = function index (depth) { return this.path[this.resolveDepth(depth) * 3 + 1] };\n\n// :: (?number)  number\n// The index pointing after this position into the ancestor at the\n// given level.\nResolvedPos.prototype.indexAfter = function indexAfter (depth) {\n  depth = this.resolveDepth(depth);\n  return this.index(depth) + (depth == this.depth && !this.textOffset ? 0 : 1)\n};\n\n// :: (?number)  number\n// The (absolute) position at the start of the node at the given\n// level.\nResolvedPos.prototype.start = function start (depth) {\n  depth = this.resolveDepth(depth);\n  return depth == 0 ? 0 : this.path[depth * 3 - 1] + 1\n};\n\n// :: (?number)  number\n// The (absolute) position at the end of the node at the given\n// level.\nResolvedPos.prototype.end = function end (depth) {\n  depth = this.resolveDepth(depth);\n  return this.start(depth) + this.node(depth).content.size\n};\n\n// :: (?number)  number\n// The (absolute) position directly before the wrapping node at the\n// given level, or, when `depth` is `this.depth + 1`, the original\n// position.\nResolvedPos.prototype.before = function before (depth) {\n  depth = this.resolveDepth(depth);\n  if (!depth) { throw new RangeError(\"There is no position before the top-level node\") }\n  return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1]\n};\n\n// :: (?number)  number\n// The (absolute) position directly after the wrapping node at the\n// given level, or the original position when `depth` is `this.depth + 1`.\nResolvedPos.prototype.after = function after (depth) {\n  depth = this.resolveDepth(depth);\n  if (!depth) { throw new RangeError(\"There is no position after the top-level node\") }\n  return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1] + this.path[depth * 3].nodeSize\n};\n\n// :: number\n// When this position points into a text node, this returns the\n// distance between the position and the start of the text node.\n// Will be zero for positions that point between nodes.\nprototypeAccessors$2.textOffset.get = function () { return this.pos - this.path[this.path.length - 1] };\n\n// :: ?Node\n// Get the node directly after the position, if any. If the position\n// points into a text node, only the part of that node after the\n// position is returned.\nprototypeAccessors$2.nodeAfter.get = function () {\n  var parent = this.parent, index = this.index(this.depth);\n  if (index == parent.childCount) { return null }\n  var dOff = this.pos - this.path[this.path.length - 1], child = parent.child(index);\n  return dOff ? parent.child(index).cut(dOff) : child\n};\n\n// :: ?Node\n// Get the node directly before the position, if any. If the\n// position points into a text node, only the part of that node\n// before the position is returned.\nprototypeAccessors$2.nodeBefore.get = function () {\n  var index = this.index(this.depth);\n  var dOff = this.pos - this.path[this.path.length - 1];\n  if (dOff) { return this.parent.child(index).cut(0, dOff) }\n  return index == 0 ? null : this.parent.child(index - 1)\n};\n\n// :: (number, ?number)  number\n// Get the position at the given index in the parent node at the\n// given depth (which defaults to `this.depth`).\nResolvedPos.prototype.posAtIndex = function posAtIndex (index, depth) {\n  depth = this.resolveDepth(depth);\n  var node = this.path[depth * 3], pos = depth == 0 ? 0 : this.path[depth * 3 - 1] + 1;\n  for (var i = 0; i < index; i++) { pos += node.child(i).nodeSize; }\n  return pos\n};\n\n// :: ()  [Mark]\n// Get the marks at this position, factoring in the surrounding\n// marks' [`inclusive`](#model.MarkSpec.inclusive) property. If the\n// position is at the start of a non-empty node, the marks of the\n// node after it (if any) are returned.\nResolvedPos.prototype.marks = function marks () {\n  var parent = this.parent, index = this.index();\n\n  // In an empty parent, return the empty array\n  if (parent.content.size == 0) { return Mark.none }\n\n  // When inside a text node, just return the text node's marks\n  if (this.textOffset) { return parent.child(index).marks }\n\n  var main = parent.maybeChild(index - 1), other = parent.maybeChild(index);\n  // If the `after` flag is true of there is no node before, make\n  // the node after this position the main reference.\n  if (!main) { var tmp = main; main = other; other = tmp; }\n\n  // Use all marks in the main node, except those that have\n  // `inclusive` set to false and are not present in the other node.\n  var marks = main.marks;\n  for (var i = 0; i < marks.length; i++)\n    { if (marks[i].type.spec.inclusive === false && (!other || !marks[i].isInSet(other.marks)))\n      { marks = marks[i--].removeFromSet(marks); } }\n\n  return marks\n};\n\n// :: (ResolvedPos)  ?[Mark]\n// Get the marks after the current position, if any, except those\n// that are non-inclusive and not present at position `$end`. This\n// is mostly useful for getting the set of marks to preserve after a\n// deletion. Will return `null` if this position is at the end of\n// its parent node or its parent node isn't a textblock (in which\n// case no marks should be preserved).\nResolvedPos.prototype.marksAcross = function marksAcross ($end) {\n  var after = this.parent.maybeChild(this.index());\n  if (!after || !after.isInline) { return null }\n\n  var marks = after.marks, next = $end.parent.maybeChild($end.index());\n  for (var i = 0; i < marks.length; i++)\n    { if (marks[i].type.spec.inclusive === false && (!next || !marks[i].isInSet(next.marks)))\n      { marks = marks[i--].removeFromSet(marks); } }\n  return marks\n};\n\n// :: (number)  number\n// The depth up to which this position and the given (non-resolved)\n// position share the same parent nodes.\nResolvedPos.prototype.sharedDepth = function sharedDepth (pos) {\n  for (var depth = this.depth; depth > 0; depth--)\n    { if (this.start(depth) <= pos && this.end(depth) >= pos) { return depth } }\n  return 0\n};\n\n// :: (?ResolvedPos, ?(Node)  bool)  ?NodeRange\n// Returns a range based on the place where this position and the\n// given position diverge around block content. If both point into\n// the same textblock, for example, a range around that textblock\n// will be returned. If they point into different blocks, the range\n// around those blocks in their shared ancestor is returned. You can\n// pass in an optional predicate that will be called with a parent\n// node to see if a range into that parent is acceptable.\nResolvedPos.prototype.blockRange = function blockRange (other, pred) {\n    if ( other === void 0 ) other = this;\n\n  if (other.pos < this.pos) { return other.blockRange(this) }\n  for (var d = this.depth - (this.parent.inlineContent || this.pos == other.pos ? 1 : 0); d >= 0; d--)\n    { if (other.pos <= this.end(d) && (!pred || pred(this.node(d))))\n      { return new NodeRange(this, other, d) } }\n};\n\n// :: (ResolvedPos)  bool\n// Query whether the given position shares the same parent node.\nResolvedPos.prototype.sameParent = function sameParent (other) {\n  return this.pos - this.parentOffset == other.pos - other.parentOffset\n};\n\n// :: (ResolvedPos)  ResolvedPos\n// Return the greater of this and the given position.\nResolvedPos.prototype.max = function max (other) {\n  return other.pos > this.pos ? other : this\n};\n\n// :: (ResolvedPos)  ResolvedPos\n// Return the smaller of this and the given position.\nResolvedPos.prototype.min = function min (other) {\n  return other.pos < this.pos ? other : this\n};\n\nResolvedPos.prototype.toString = function toString () {\n  var str = \"\";\n  for (var i = 1; i <= this.depth; i++)\n    { str += (str ? \"/\" : \"\") + this.node(i).type.name + \"_\" + this.index(i - 1); }\n  return str + \":\" + this.parentOffset\n};\n\nResolvedPos.resolve = function resolve (doc, pos) {\n  if (!(pos >= 0 && pos <= doc.content.size)) { throw new RangeError(\"Position \" + pos + \" out of range\") }\n  var path = [];\n  var start = 0, parentOffset = pos;\n  for (var node = doc;;) {\n    var ref = node.content.findIndex(parentOffset);\n      var index = ref.index;\n      var offset = ref.offset;\n    var rem = parentOffset - offset;\n    path.push(node, index, start + offset);\n    if (!rem) { break }\n    node = node.child(index);\n    if (node.isText) { break }\n    parentOffset = rem - 1;\n    start += offset + 1;\n  }\n  return new ResolvedPos(pos, path, parentOffset)\n};\n\nResolvedPos.resolveCached = function resolveCached (doc, pos) {\n  for (var i = 0; i < resolveCache.length; i++) {\n    var cached = resolveCache[i];\n    if (cached.pos == pos && cached.doc == doc) { return cached }\n  }\n  var result = resolveCache[resolveCachePos] = ResolvedPos.resolve(doc, pos);\n  resolveCachePos = (resolveCachePos + 1) % resolveCacheSize;\n  return result\n};\n\nObject.defineProperties( ResolvedPos.prototype, prototypeAccessors$2 );\n\nvar resolveCache = [], resolveCachePos = 0, resolveCacheSize = 12;\n\n// ::- Represents a flat range of content, i.e. one that starts and\n// ends in the same node.\nvar NodeRange = function NodeRange($from, $to, depth) {\n  // :: ResolvedPos A resolved position along the start of the\n  // content. May have a `depth` greater than this object's `depth`\n  // property, since these are the positions that were used to\n  // compute the range, not re-resolved positions directly at its\n  // boundaries.\n  this.$from = $from;\n  // :: ResolvedPos A position along the end of the content. See\n  // caveat for [`$from`](#model.NodeRange.$from).\n  this.$to = $to;\n  // :: number The depth of the node that this range points into.\n  this.depth = depth;\n};\n\nvar prototypeAccessors$1$1 = { start: { configurable: true },end: { configurable: true },parent: { configurable: true },startIndex: { configurable: true },endIndex: { configurable: true } };\n\n// :: number The position at the start of the range.\nprototypeAccessors$1$1.start.get = function () { return this.$from.before(this.depth + 1) };\n// :: number The position at the end of the range.\nprototypeAccessors$1$1.end.get = function () { return this.$to.after(this.depth + 1) };\n\n// :: Node The parent node that the range points into.\nprototypeAccessors$1$1.parent.get = function () { return this.$from.node(this.depth) };\n// :: number The start index of the range in the parent node.\nprototypeAccessors$1$1.startIndex.get = function () { return this.$from.index(this.depth) };\n// :: number The end index of the range in the parent node.\nprototypeAccessors$1$1.endIndex.get = function () { return this.$to.indexAfter(this.depth) };\n\nObject.defineProperties( NodeRange.prototype, prototypeAccessors$1$1 );\n\nvar emptyAttrs = Object.create(null);\n\n// ::- This class represents a node in the tree that makes up a\n// ProseMirror document. So a document is an instance of `Node`, with\n// children that are also instances of `Node`.\n//\n// Nodes are persistent data structures. Instead of changing them, you\n// create new ones with the content you want. Old ones keep pointing\n// at the old document shape. This is made cheaper by sharing\n// structure between the old and new data as much as possible, which a\n// tree shape like this (without back pointers) makes easy.\n//\n// **Do not** directly mutate the properties of a `Node` object. See\n// [the guide](/docs/guide/#doc) for more information.\nvar Node = function Node(type, attrs, content, marks) {\n  // :: NodeType\n  // The type of node that this is.\n  this.type = type;\n\n  // :: Object\n  // An object mapping attribute names to values. The kind of\n  // attributes allowed and required are\n  // [determined](#model.NodeSpec.attrs) by the node type.\n  this.attrs = attrs;\n\n  // :: Fragment\n  // A container holding the node's children.\n  this.content = content || Fragment.empty;\n\n  // :: [Mark]\n  // The marks (things like whether it is emphasized or part of a\n  // link) applied to this node.\n  this.marks = marks || Mark.none;\n};\n\nvar prototypeAccessors$3 = { nodeSize: { configurable: true },childCount: { configurable: true },textContent: { configurable: true },firstChild: { configurable: true },lastChild: { configurable: true },isBlock: { configurable: true },isTextblock: { configurable: true },inlineContent: { configurable: true },isInline: { configurable: true },isText: { configurable: true },isLeaf: { configurable: true },isAtom: { configurable: true } };\n\n// text:: ?string\n// For text nodes, this contains the node's text content.\n\n// :: number\n// The size of this node, as defined by the integer-based [indexing\n// scheme](/docs/guide/#doc.indexing). For text nodes, this is the\n// amount of characters. For other leaf nodes, it is one. For\n// non-leaf nodes, it is the size of the content plus two (the start\n// and end token).\nprototypeAccessors$3.nodeSize.get = function () { return this.isLeaf ? 1 : 2 + this.content.size };\n\n// :: number\n// The number of children that the node has.\nprototypeAccessors$3.childCount.get = function () { return this.content.childCount };\n\n// :: (number)  Node\n// Get the child node at the given index. Raises an error when the\n// index is out of range.\nNode.prototype.child = function child (index) { return this.content.child(index) };\n\n// :: (number)  ?Node\n// Get the child node at the given index, if it exists.\nNode.prototype.maybeChild = function maybeChild (index) { return this.content.maybeChild(index) };\n\n// :: ((node: Node, offset: number, index: number))\n// Call `f` for every child node, passing the node, its offset\n// into this parent node, and its index.\nNode.prototype.forEach = function forEach (f) { this.content.forEach(f); };\n\n// :: (number, number, (node: Node, pos: number, parent: Node, index: number)  ?bool, ?number)\n// Invoke a callback for all descendant nodes recursively between\n// the given two positions that are relative to start of this node's\n// content. The callback is invoked with the node, its\n// parent-relative position, its parent node, and its child index.\n// When the callback returns false for a given node, that node's\n// children will not be recursed over. The last parameter can be\n// used to specify a starting position to count from.\nNode.prototype.nodesBetween = function nodesBetween (from, to, f, startPos) {\n    if ( startPos === void 0 ) startPos = 0;\n\n  this.content.nodesBetween(from, to, f, startPos, this);\n};\n\n// :: ((node: Node, pos: number, parent: Node)  ?bool)\n// Call the given callback for every descendant node. Doesn't\n// descend into a node when the callback returns `false`.\nNode.prototype.descendants = function descendants (f) {\n  this.nodesBetween(0, this.content.size, f);\n};\n\n// :: string\n// Concatenates all the text nodes found in this fragment and its\n// children.\nprototypeAccessors$3.textContent.get = function () { return this.textBetween(0, this.content.size, \"\") };\n\n// :: (number, number, ?string, ?string)  string\n// Get all text between positions `from` and `to`. When\n// `blockSeparator` is given, it will be inserted whenever a new\n// block node is started. When `leafText` is given, it'll be\n// inserted for every non-text leaf node encountered.\nNode.prototype.textBetween = function textBetween (from, to, blockSeparator, leafText) {\n  return this.content.textBetween(from, to, blockSeparator, leafText)\n};\n\n// :: ?Node\n// Returns this node's first child, or `null` if there are no\n// children.\nprototypeAccessors$3.firstChild.get = function () { return this.content.firstChild };\n\n// :: ?Node\n// Returns this node's last child, or `null` if there are no\n// children.\nprototypeAccessors$3.lastChild.get = function () { return this.content.lastChild };\n\n// :: (Node)  bool\n// Test whether two nodes represent the same piece of document.\nNode.prototype.eq = function eq (other) {\n  return this == other || (this.sameMarkup(other) && this.content.eq(other.content))\n};\n\n// :: (Node)  bool\n// Compare the markup (type, attributes, and marks) of this node to\n// those of another. Returns `true` if both have the same markup.\nNode.prototype.sameMarkup = function sameMarkup (other) {\n  return this.hasMarkup(other.type, other.attrs, other.marks)\n};\n\n// :: (NodeType, ?Object, ?[Mark])  bool\n// Check whether this node's markup correspond to the given type,\n// attributes, and marks.\nNode.prototype.hasMarkup = function hasMarkup (type, attrs, marks) {\n  return this.type == type &&\n    compareDeep(this.attrs, attrs || type.defaultAttrs || emptyAttrs) &&\n    Mark.sameSet(this.marks, marks || Mark.none)\n};\n\n// :: (?Fragment)  Node\n// Create a new node with the same markup as this node, containing\n// the given content (or empty, if no content is given).\nNode.prototype.copy = function copy (content) {\n    if ( content === void 0 ) content = null;\n\n  if (content == this.content) { return this }\n  return new this.constructor(this.type, this.attrs, content, this.marks)\n};\n\n// :: ([Mark])  Node\n// Create a copy of this node, with the given set of marks instead\n// of the node's own marks.\nNode.prototype.mark = function mark (marks) {\n  return marks == this.marks ? this : new this.constructor(this.type, this.attrs, this.content, marks)\n};\n\n// :: (number, ?number)  Node\n// Create a copy of this node with only the content between the\n// given positions. If `to` is not given, it defaults to the end of\n// the node.\nNode.prototype.cut = function cut (from, to) {\n  if (from == 0 && to == this.content.size) { return this }\n  return this.copy(this.content.cut(from, to))\n};\n\n// :: (number, ?number)  Slice\n// Cut out the part of the document between the given positions, and\n// return it as a `Slice` object.\nNode.prototype.slice = function slice (from, to, includeParents) {\n    if ( to === void 0 ) to = this.content.size;\n    if ( includeParents === void 0 ) includeParents = false;\n\n  if (from == to) { return Slice.empty }\n\n  var $from = this.resolve(from), $to = this.resolve(to);\n  var depth = includeParents ? 0 : $from.sharedDepth(to);\n  var start = $from.start(depth), node = $from.node(depth);\n  var content = node.content.cut($from.pos - start, $to.pos - start);\n  return new Slice(content, $from.depth - depth, $to.depth - depth)\n};\n\n// :: (number, number, Slice)  Node\n// Replace the part of the document between the given positions with\n// the given slice. The slice must 'fit', meaning its open sides\n// must be able to connect to the surrounding content, and its\n// content nodes must be valid children for the node they are placed\n// into. If any of this is violated, an error of type\n// [`ReplaceError`](#model.ReplaceError) is thrown.\nNode.prototype.replace = function replace$1 (from, to, slice) {\n  return replace(this.resolve(from), this.resolve(to), slice)\n};\n\n// :: (number)  ?Node\n// Find the node directly after the given position.\nNode.prototype.nodeAt = function nodeAt (pos) {\n  for (var node = this;;) {\n    var ref = node.content.findIndex(pos);\n      var index = ref.index;\n      var offset = ref.offset;\n    node = node.maybeChild(index);\n    if (!node) { return null }\n    if (offset == pos || node.isText) { return node }\n    pos -= offset + 1;\n  }\n};\n\n// :: (number)  {node: ?Node, index: number, offset: number}\n// Find the (direct) child node after the given offset, if any,\n// and return it along with its index and offset relative to this\n// node.\nNode.prototype.childAfter = function childAfter (pos) {\n  var ref = this.content.findIndex(pos);\n    var index = ref.index;\n    var offset = ref.offset;\n  return {node: this.content.maybeChild(index), index: index, offset: offset}\n};\n\n// :: (number)  {node: ?Node, index: number, offset: number}\n// Find the (direct) child node before the given offset, if any,\n// and return it along with its index and offset relative to this\n// node.\nNode.prototype.childBefore = function childBefore (pos) {\n  if (pos == 0) { return {node: null, index: 0, offset: 0} }\n  var ref = this.content.findIndex(pos);\n    var index = ref.index;\n    var offset = ref.offset;\n  if (offset < pos) { return {node: this.content.child(index), index: index, offset: offset} }\n  var node = this.content.child(index - 1);\n  return {node: node, index: index - 1, offset: offset - node.nodeSize}\n};\n\n// :: (number)  ResolvedPos\n// Resolve the given position in the document, returning an\n// [object](#model.ResolvedPos) with information about its context.\nNode.prototype.resolve = function resolve (pos) { return ResolvedPos.resolveCached(this, pos) };\n\nNode.prototype.resolveNoCache = function resolveNoCache (pos) { return ResolvedPos.resolve(this, pos) };\n\n// :: (number, number, union<Mark, MarkType>)  bool\n// Test whether a given mark or mark type occurs in this document\n// between the two given positions.\nNode.prototype.rangeHasMark = function rangeHasMark (from, to, type) {\n  var found = false;\n  if (to > from) { this.nodesBetween(from, to, function (node) {\n    if (type.isInSet(node.marks)) { found = true; }\n    return !found\n  }); }\n  return found\n};\n\n// :: bool\n// True when this is a block (non-inline node)\nprototypeAccessors$3.isBlock.get = function () { return this.type.isBlock };\n\n// :: bool\n// True when this is a textblock node, a block node with inline\n// content.\nprototypeAccessors$3.isTextblock.get = function () { return this.type.isTextblock };\n\n// :: bool\n// True when this node allows inline content.\nprototypeAccessors$3.inlineContent.get = function () { return this.type.inlineContent };\n\n// :: bool\n// True when this is an inline node (a text node or a node that can\n// appear among text).\nprototypeAccessors$3.isInline.get = function () { return this.type.isInline };\n\n// :: bool\n// True when this is a text node.\nprototypeAccessors$3.isText.get = function () { return this.type.isText };\n\n// :: bool\n// True when this is a leaf node.\nprototypeAccessors$3.isLeaf.get = function () { return this.type.isLeaf };\n\n// :: bool\n// True when this is an atom, i.e. when it does not have directly\n// editable content. This is usually the same as `isLeaf`, but can\n// be configured with the [`atom` property](#model.NodeSpec.atom) on\n// a node's spec (typically used when the node is displayed as an\n// uneditable [node view](#view.NodeView)).\nprototypeAccessors$3.isAtom.get = function () { return this.type.isAtom };\n\n// :: ()  string\n// Return a string representation of this node for debugging\n// purposes.\nNode.prototype.toString = function toString () {\n  if (this.type.spec.toDebugString) { return this.type.spec.toDebugString(this) }\n  var name = this.type.name;\n  if (this.content.size)\n    { name += \"(\" + this.content.toStringInner() + \")\"; }\n  return wrapMarks(this.marks, name)\n};\n\n// :: (number)  ContentMatch\n// Get the content match in this node at the given index.\nNode.prototype.contentMatchAt = function contentMatchAt (index) {\n  var match = this.type.contentMatch.matchFragment(this.content, 0, index);\n  if (!match) { throw new Error(\"Called contentMatchAt on a node with invalid content\") }\n  return match\n};\n\n// :: (number, number, ?Fragment, ?number, ?number)  bool\n// Test whether replacing the range between `from` and `to` (by\n// child index) with the given replacement fragment (which defaults\n// to the empty fragment) would leave the node's content valid. You\n// can optionally pass `start` and `end` indices into the\n// replacement fragment.\nNode.prototype.canReplace = function canReplace (from, to, replacement, start, end) {\n    if ( replacement === void 0 ) replacement = Fragment.empty;\n    if ( start === void 0 ) start = 0;\n    if ( end === void 0 ) end = replacement.childCount;\n\n  var one = this.contentMatchAt(from).matchFragment(replacement, start, end);\n  var two = one && one.matchFragment(this.content, to);\n  if (!two || !two.validEnd) { return false }\n  for (var i = start; i < end; i++) { if (!this.type.allowsMarks(replacement.child(i).marks)) { return false } }\n  return true\n};\n\n// :: (number, number, NodeType, ?[Mark])  bool\n// Test whether replacing the range `from` to `to` (by index) with a\n// node of the given type would leave the node's content valid.\nNode.prototype.canReplaceWith = function canReplaceWith (from, to, type, marks) {\n  if (marks && !this.type.allowsMarks(marks)) { return false }\n  var start = this.contentMatchAt(from).matchType(type);\n  var end = start && start.matchFragment(this.content, to);\n  return end ? end.validEnd : false\n};\n\n// :: (Node)  bool\n// Test whether the given node's content could be appended to this\n// node. If that node is empty, this will only return true if there\n// is at least one node type that can appear in both nodes (to avoid\n// merging completely incompatible nodes).\nNode.prototype.canAppend = function canAppend (other) {\n  if (other.content.size) { return this.canReplace(this.childCount, this.childCount, other.content) }\n  else { return this.type.compatibleContent(other.type) }\n};\n\n// :: ()\n// Check whether this node and its descendants conform to the\n// schema, and raise error when they do not.\nNode.prototype.check = function check () {\n  if (!this.type.validContent(this.content))\n    { throw new RangeError((\"Invalid content for node \" + (this.type.name) + \": \" + (this.content.toString().slice(0, 50)))) }\n  this.content.forEach(function (node) { return node.check(); });\n};\n\n// :: ()  Object\n// Return a JSON-serializeable representation of this node.\nNode.prototype.toJSON = function toJSON () {\n  var obj = {type: this.type.name};\n  for (var _ in this.attrs) {\n    obj.attrs = this.attrs;\n    break\n  }\n  if (this.content.size)\n    { obj.content = this.content.toJSON(); }\n  if (this.marks.length)\n    { obj.marks = this.marks.map(function (n) { return n.toJSON(); }); }\n  return obj\n};\n\n// :: (Schema, Object)  Node\n// Deserialize a node from its JSON representation.\nNode.fromJSON = function fromJSON (schema, json) {\n  if (!json) { throw new RangeError(\"Invalid input for Node.fromJSON\") }\n  var marks = null;\n  if (json.marks) {\n    if (!Array.isArray(json.marks)) { throw new RangeError(\"Invalid mark data for Node.fromJSON\") }\n    marks = json.marks.map(schema.markFromJSON);\n  }\n  if (json.type == \"text\") {\n    if (typeof json.text != \"string\") { throw new RangeError(\"Invalid text node in JSON\") }\n    return schema.text(json.text, marks)\n  }\n  var content = Fragment.fromJSON(schema, json.content);\n  return schema.nodeType(json.type).create(json.attrs, content, marks)\n};\n\nObject.defineProperties( Node.prototype, prototypeAccessors$3 );\n\nvar TextNode = /*@__PURE__*/(function (Node) {\n  function TextNode(type, attrs, content, marks) {\n    Node.call(this, type, attrs, null, marks);\n\n    if (!content) { throw new RangeError(\"Empty text nodes are not allowed\") }\n\n    this.text = content;\n  }\n\n  if ( Node ) TextNode.__proto__ = Node;\n  TextNode.prototype = Object.create( Node && Node.prototype );\n  TextNode.prototype.constructor = TextNode;\n\n  var prototypeAccessors$1 = { textContent: { configurable: true },nodeSize: { configurable: true } };\n\n  TextNode.prototype.toString = function toString () {\n    if (this.type.spec.toDebugString) { return this.type.spec.toDebugString(this) }\n    return wrapMarks(this.marks, JSON.stringify(this.text))\n  };\n\n  prototypeAccessors$1.textContent.get = function () { return this.text };\n\n  TextNode.prototype.textBetween = function textBetween (from, to) { return this.text.slice(from, to) };\n\n  prototypeAccessors$1.nodeSize.get = function () { return this.text.length };\n\n  TextNode.prototype.mark = function mark (marks) {\n    return marks == this.marks ? this : new TextNode(this.type, this.attrs, this.text, marks)\n  };\n\n  TextNode.prototype.withText = function withText (text) {\n    if (text == this.text) { return this }\n    return new TextNode(this.type, this.attrs, text, this.marks)\n  };\n\n  TextNode.prototype.cut = function cut (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.text.length;\n\n    if (from == 0 && to == this.text.length) { return this }\n    return this.withText(this.text.slice(from, to))\n  };\n\n  TextNode.prototype.eq = function eq (other) {\n    return this.sameMarkup(other) && this.text == other.text\n  };\n\n  TextNode.prototype.toJSON = function toJSON () {\n    var base = Node.prototype.toJSON.call(this);\n    base.text = this.text;\n    return base\n  };\n\n  Object.defineProperties( TextNode.prototype, prototypeAccessors$1 );\n\n  return TextNode;\n}(Node));\n\nfunction wrapMarks(marks, str) {\n  for (var i = marks.length - 1; i >= 0; i--)\n    { str = marks[i].type.name + \"(\" + str + \")\"; }\n  return str\n}\n\n// ::- Instances of this class represent a match state of a node\n// type's [content expression](#model.NodeSpec.content), and can be\n// used to find out whether further content matches here, and whether\n// a given position is a valid end of the node.\nvar ContentMatch = function ContentMatch(validEnd) {\n  // :: bool\n  // True when this match state represents a valid end of the node.\n  this.validEnd = validEnd;\n  this.next = [];\n  this.wrapCache = [];\n};\n\nvar prototypeAccessors$4 = { inlineContent: { configurable: true },defaultType: { configurable: true },edgeCount: { configurable: true } };\n\nContentMatch.parse = function parse (string, nodeTypes) {\n  var stream = new TokenStream(string, nodeTypes);\n  if (stream.next == null) { return ContentMatch.empty }\n  var expr = parseExpr(stream);\n  if (stream.next) { stream.err(\"Unexpected trailing text\"); }\n  var match = dfa(nfa(expr));\n  checkForDeadEnds(match, stream);\n  return match\n};\n\n// :: (NodeType)  ?ContentMatch\n// Match a node type, returning a match after that node if\n// successful.\nContentMatch.prototype.matchType = function matchType (type) {\n  for (var i = 0; i < this.next.length; i += 2)\n    { if (this.next[i] == type) { return this.next[i + 1] } }\n  return null\n};\n\n// :: (Fragment, ?number, ?number)  ?ContentMatch\n// Try to match a fragment. Returns the resulting match when\n// successful.\nContentMatch.prototype.matchFragment = function matchFragment (frag, start, end) {\n    if ( start === void 0 ) start = 0;\n    if ( end === void 0 ) end = frag.childCount;\n\n  var cur = this;\n  for (var i = start; cur && i < end; i++)\n    { cur = cur.matchType(frag.child(i).type); }\n  return cur\n};\n\nprototypeAccessors$4.inlineContent.get = function () {\n  var first = this.next[0];\n  return first ? first.isInline : false\n};\n\n// :: ?NodeType\n// Get the first matching node type at this match position that can\n// be generated.\nprototypeAccessors$4.defaultType.get = function () {\n  for (var i = 0; i < this.next.length; i += 2) {\n    var type = this.next[i];\n    if (!(type.isText || type.hasRequiredAttrs())) { return type }\n  }\n};\n\nContentMatch.prototype.compatible = function compatible (other) {\n  for (var i = 0; i < this.next.length; i += 2)\n    { for (var j = 0; j < other.next.length; j += 2)\n      { if (this.next[i] == other.next[j]) { return true } } }\n  return false\n};\n\n// :: (Fragment, bool, ?number)  ?Fragment\n// Try to match the given fragment, and if that fails, see if it can\n// be made to match by inserting nodes in front of it. When\n// successful, return a fragment of inserted nodes (which may be\n// empty if nothing had to be inserted). When `toEnd` is true, only\n// return a fragment if the resulting match goes to the end of the\n// content expression.\nContentMatch.prototype.fillBefore = function fillBefore (after, toEnd, startIndex) {\n    if ( toEnd === void 0 ) toEnd = false;\n    if ( startIndex === void 0 ) startIndex = 0;\n\n  var seen = [this];\n  function search(match, types) {\n    var finished = match.matchFragment(after, startIndex);\n    if (finished && (!toEnd || finished.validEnd))\n      { return Fragment.from(types.map(function (tp) { return tp.createAndFill(); })) }\n\n    for (var i = 0; i < match.next.length; i += 2) {\n      var type = match.next[i], next = match.next[i + 1];\n      if (!(type.isText || type.hasRequiredAttrs()) && seen.indexOf(next) == -1) {\n        seen.push(next);\n        var found = search(next, types.concat(type));\n        if (found) { return found }\n      }\n    }\n  }\n\n  return search(this, [])\n};\n\n// :: (NodeType)  ?[NodeType]\n// Find a set of wrapping node types that would allow a node of the\n// given type to appear at this position. The result may be empty\n// (when it fits directly) and will be null when no such wrapping\n// exists.\nContentMatch.prototype.findWrapping = function findWrapping (target) {\n  for (var i = 0; i < this.wrapCache.length; i += 2)\n    { if (this.wrapCache[i] == target) { return this.wrapCache[i + 1] } }\n  var computed = this.computeWrapping(target);\n  this.wrapCache.push(target, computed);\n  return computed\n};\n\nContentMatch.prototype.computeWrapping = function computeWrapping (target) {\n  var seen = Object.create(null), active = [{match: this, type: null, via: null}];\n  while (active.length) {\n    var current = active.shift(), match = current.match;\n    if (match.matchType(target)) {\n      var result = [];\n      for (var obj = current; obj.type; obj = obj.via)\n        { result.push(obj.type); }\n      return result.reverse()\n    }\n    for (var i = 0; i < match.next.length; i += 2) {\n      var type = match.next[i];\n      if (!type.isLeaf && !type.hasRequiredAttrs() && !(type.name in seen) && (!current.type || match.next[i + 1].validEnd)) {\n        active.push({match: type.contentMatch, type: type, via: current});\n        seen[type.name] = true;\n      }\n    }\n  }\n};\n\n// :: number\n// The number of outgoing edges this node has in the finite\n// automaton that describes the content expression.\nprototypeAccessors$4.edgeCount.get = function () {\n  return this.next.length >> 1\n};\n\n// :: (number)  {type: NodeType, next: ContentMatch}\n// Get the _n_th outgoing edge from this node in the finite\n// automaton that describes the content expression.\nContentMatch.prototype.edge = function edge (n) {\n  var i = n << 1;\n  if (i >= this.next.length) { throw new RangeError((\"There's no \" + n + \"th edge in this content match\")) }\n  return {type: this.next[i], next: this.next[i + 1]}\n};\n\nContentMatch.prototype.toString = function toString () {\n  var seen = [];\n  function scan(m) {\n    seen.push(m);\n    for (var i = 1; i < m.next.length; i += 2)\n      { if (seen.indexOf(m.next[i]) == -1) { scan(m.next[i]); } }\n  }\n  scan(this);\n  return seen.map(function (m, i) {\n    var out = i + (m.validEnd ? \"*\" : \" \") + \" \";\n    for (var i$1 = 0; i$1 < m.next.length; i$1 += 2)\n      { out += (i$1 ? \", \" : \"\") + m.next[i$1].name + \"->\" + seen.indexOf(m.next[i$1 + 1]); }\n    return out\n  }).join(\"\\n\")\n};\n\nObject.defineProperties( ContentMatch.prototype, prototypeAccessors$4 );\n\nContentMatch.empty = new ContentMatch(true);\n\nvar TokenStream = function TokenStream(string, nodeTypes) {\n  this.string = string;\n  this.nodeTypes = nodeTypes;\n  this.inline = null;\n  this.pos = 0;\n  this.tokens = string.split(/\\s*(?=\\b|\\W|$)/);\n  if (this.tokens[this.tokens.length - 1] == \"\") { this.tokens.pop(); }\n  if (this.tokens[0] == \"\") { this.tokens.shift(); }\n};\n\nvar prototypeAccessors$1$2 = { next: { configurable: true } };\n\nprototypeAccessors$1$2.next.get = function () { return this.tokens[this.pos] };\n\nTokenStream.prototype.eat = function eat (tok) { return this.next == tok && (this.pos++ || true) };\n\nTokenStream.prototype.err = function err (str) { throw new SyntaxError(str + \" (in content expression '\" + this.string + \"')\") };\n\nObject.defineProperties( TokenStream.prototype, prototypeAccessors$1$2 );\n\nfunction parseExpr(stream) {\n  var exprs = [];\n  do { exprs.push(parseExprSeq(stream)); }\n  while (stream.eat(\"|\"))\n  return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs: exprs}\n}\n\nfunction parseExprSeq(stream) {\n  var exprs = [];\n  do { exprs.push(parseExprSubscript(stream)); }\n  while (stream.next && stream.next != \")\" && stream.next != \"|\")\n  return exprs.length == 1 ? exprs[0] : {type: \"seq\", exprs: exprs}\n}\n\nfunction parseExprSubscript(stream) {\n  var expr = parseExprAtom(stream);\n  for (;;) {\n    if (stream.eat(\"+\"))\n      { expr = {type: \"plus\", expr: expr}; }\n    else if (stream.eat(\"*\"))\n      { expr = {type: \"star\", expr: expr}; }\n    else if (stream.eat(\"?\"))\n      { expr = {type: \"opt\", expr: expr}; }\n    else if (stream.eat(\"{\"))\n      { expr = parseExprRange(stream, expr); }\n    else { break }\n  }\n  return expr\n}\n\nfunction parseNum(stream) {\n  if (/\\D/.test(stream.next)) { stream.err(\"Expected number, got '\" + stream.next + \"'\"); }\n  var result = Number(stream.next);\n  stream.pos++;\n  return result\n}\n\nfunction parseExprRange(stream, expr) {\n  var min = parseNum(stream), max = min;\n  if (stream.eat(\",\")) {\n    if (stream.next != \"}\") { max = parseNum(stream); }\n    else { max = -1; }\n  }\n  if (!stream.eat(\"}\")) { stream.err(\"Unclosed braced range\"); }\n  return {type: \"range\", min: min, max: max, expr: expr}\n}\n\nfunction resolveName(stream, name) {\n  var types = stream.nodeTypes, type = types[name];\n  if (type) { return [type] }\n  var result = [];\n  for (var typeName in types) {\n    var type$1 = types[typeName];\n    if (type$1.groups.indexOf(name) > -1) { result.push(type$1); }\n  }\n  if (result.length == 0) { stream.err(\"No node type or group '\" + name + \"' found\"); }\n  return result\n}\n\nfunction parseExprAtom(stream) {\n  if (stream.eat(\"(\")) {\n    var expr = parseExpr(stream);\n    if (!stream.eat(\")\")) { stream.err(\"Missing closing paren\"); }\n    return expr\n  } else if (!/\\W/.test(stream.next)) {\n    var exprs = resolveName(stream, stream.next).map(function (type) {\n      if (stream.inline == null) { stream.inline = type.isInline; }\n      else if (stream.inline != type.isInline) { stream.err(\"Mixing inline and block content\"); }\n      return {type: \"name\", value: type}\n    });\n    stream.pos++;\n    return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs: exprs}\n  } else {\n    stream.err(\"Unexpected token '\" + stream.next + \"'\");\n  }\n}\n\n// The code below helps compile a regular-expression-like language\n// into a deterministic finite automaton. For a good introduction to\n// these concepts, see https://swtch.com/~rsc/regexp/regexp1.html\n\n// : (Object)  [[{term: ?any, to: number}]]\n// Construct an NFA from an expression as returned by the parser. The\n// NFA is represented as an array of states, which are themselves\n// arrays of edges, which are `{term, to}` objects. The first state is\n// the entry state and the last node is the success state.\n//\n// Note that unlike typical NFAs, the edge ordering in this one is\n// significant, in that it is used to contruct filler content when\n// necessary.\nfunction nfa(expr) {\n  var nfa = [[]];\n  connect(compile(expr, 0), node());\n  return nfa\n\n  function node() { return nfa.push([]) - 1 }\n  function edge(from, to, term) {\n    var edge = {term: term, to: to};\n    nfa[from].push(edge);\n    return edge\n  }\n  function connect(edges, to) { edges.forEach(function (edge) { return edge.to = to; }); }\n\n  function compile(expr, from) {\n    if (expr.type == \"choice\") {\n      return expr.exprs.reduce(function (out, expr) { return out.concat(compile(expr, from)); }, [])\n    } else if (expr.type == \"seq\") {\n      for (var i = 0;; i++) {\n        var next = compile(expr.exprs[i], from);\n        if (i == expr.exprs.length - 1) { return next }\n        connect(next, from = node());\n      }\n    } else if (expr.type == \"star\") {\n      var loop = node();\n      edge(from, loop);\n      connect(compile(expr.expr, loop), loop);\n      return [edge(loop)]\n    } else if (expr.type == \"plus\") {\n      var loop$1 = node();\n      connect(compile(expr.expr, from), loop$1);\n      connect(compile(expr.expr, loop$1), loop$1);\n      return [edge(loop$1)]\n    } else if (expr.type == \"opt\") {\n      return [edge(from)].concat(compile(expr.expr, from))\n    } else if (expr.type == \"range\") {\n      var cur = from;\n      for (var i$1 = 0; i$1 < expr.min; i$1++) {\n        var next$1 = node();\n        connect(compile(expr.expr, cur), next$1);\n        cur = next$1;\n      }\n      if (expr.max == -1) {\n        connect(compile(expr.expr, cur), cur);\n      } else {\n        for (var i$2 = expr.min; i$2 < expr.max; i$2++) {\n          var next$2 = node();\n          edge(cur, next$2);\n          connect(compile(expr.expr, cur), next$2);\n          cur = next$2;\n        }\n      }\n      return [edge(cur)]\n    } else if (expr.type == \"name\") {\n      return [edge(from, null, expr.value)]\n    }\n  }\n}\n\nfunction cmp(a, b) { return b - a }\n\n// Get the set of nodes reachable by null edges from `node`. Omit\n// nodes with only a single null-out-edge, since they may lead to\n// needless duplicated nodes.\nfunction nullFrom(nfa, node) {\n  var result = [];\n  scan(node);\n  return result.sort(cmp)\n\n  function scan(node) {\n    var edges = nfa[node];\n    if (edges.length == 1 && !edges[0].term) { return scan(edges[0].to) }\n    result.push(node);\n    for (var i = 0; i < edges.length; i++) {\n      var ref = edges[i];\n      var term = ref.term;\n      var to = ref.to;\n      if (!term && result.indexOf(to) == -1) { scan(to); }\n    }\n  }\n}\n\n// : ([[{term: ?any, to: number}]])  ContentMatch\n// Compiles an NFA as produced by `nfa` into a DFA, modeled as a set\n// of state objects (`ContentMatch` instances) with transitions\n// between them.\nfunction dfa(nfa) {\n  var labeled = Object.create(null);\n  return explore(nullFrom(nfa, 0))\n\n  function explore(states) {\n    var out = [];\n    states.forEach(function (node) {\n      nfa[node].forEach(function (ref) {\n        var term = ref.term;\n        var to = ref.to;\n\n        if (!term) { return }\n        var known = out.indexOf(term), set = known > -1 && out[known + 1];\n        nullFrom(nfa, to).forEach(function (node) {\n          if (!set) { out.push(term, set = []); }\n          if (set.indexOf(node) == -1) { set.push(node); }\n        });\n      });\n    });\n    var state = labeled[states.join(\",\")] = new ContentMatch(states.indexOf(nfa.length - 1) > -1);\n    for (var i = 0; i < out.length; i += 2) {\n      var states$1 = out[i + 1].sort(cmp);\n      state.next.push(out[i], labeled[states$1.join(\",\")] || explore(states$1));\n    }\n    return state\n  }\n}\n\nfunction checkForDeadEnds(match, stream) {\n  for (var i = 0, work = [match]; i < work.length; i++) {\n    var state = work[i], dead = !state.validEnd, nodes = [];\n    for (var j = 0; j < state.next.length; j += 2) {\n      var node = state.next[j], next = state.next[j + 1];\n      nodes.push(node.name);\n      if (dead && !(node.isText || node.hasRequiredAttrs())) { dead = false; }\n      if (work.indexOf(next) == -1) { work.push(next); }\n    }\n    if (dead) { stream.err(\"Only non-generatable nodes (\" + nodes.join(\", \") + \") in a required position (see https://prosemirror.net/docs/guide/#generatable)\"); }\n  }\n}\n\n// For node types where all attrs have a default value (or which don't\n// have any attributes), build up a single reusable default attribute\n// object, and use it for all nodes that don't specify specific\n// attributes.\nfunction defaultAttrs(attrs) {\n  var defaults = Object.create(null);\n  for (var attrName in attrs) {\n    var attr = attrs[attrName];\n    if (!attr.hasDefault) { return null }\n    defaults[attrName] = attr.default;\n  }\n  return defaults\n}\n\nfunction computeAttrs(attrs, value) {\n  var built = Object.create(null);\n  for (var name in attrs) {\n    var given = value && value[name];\n    if (given === undefined) {\n      var attr = attrs[name];\n      if (attr.hasDefault) { given = attr.default; }\n      else { throw new RangeError(\"No value supplied for attribute \" + name) }\n    }\n    built[name] = given;\n  }\n  return built\n}\n\nfunction initAttrs(attrs) {\n  var result = Object.create(null);\n  if (attrs) { for (var name in attrs) { result[name] = new Attribute(attrs[name]); } }\n  return result\n}\n\n// ::- Node types are objects allocated once per `Schema` and used to\n// [tag](#model.Node.type) `Node` instances. They contain information\n// about the node type, such as its name and what kind of node it\n// represents.\nvar NodeType = function NodeType(name, schema, spec) {\n  // :: string\n  // The name the node type has in this schema.\n  this.name = name;\n\n  // :: Schema\n  // A link back to the `Schema` the node type belongs to.\n  this.schema = schema;\n\n  // :: NodeSpec\n  // The spec that this type is based on\n  this.spec = spec;\n\n  this.groups = spec.group ? spec.group.split(\" \") : [];\n  this.attrs = initAttrs(spec.attrs);\n\n  this.defaultAttrs = defaultAttrs(this.attrs);\n\n  // :: ContentMatch\n  // The starting match of the node type's content expression.\n  this.contentMatch = null;\n\n  // : ?[MarkType]\n  // The set of marks allowed in this node. `null` means all marks\n  // are allowed.\n  this.markSet = null;\n\n  // :: bool\n  // True if this node type has inline content.\n  this.inlineContent = null;\n\n  // :: bool\n  // True if this is a block type\n  this.isBlock = !(spec.inline || name == \"text\");\n\n  // :: bool\n  // True if this is the text node type.\n  this.isText = name == \"text\";\n};\n\nvar prototypeAccessors$5 = { isInline: { configurable: true },isTextblock: { configurable: true },isLeaf: { configurable: true },isAtom: { configurable: true } };\n\n// :: bool\n// True if this is an inline type.\nprototypeAccessors$5.isInline.get = function () { return !this.isBlock };\n\n// :: bool\n// True if this is a textblock type, a block that contains inline\n// content.\nprototypeAccessors$5.isTextblock.get = function () { return this.isBlock && this.inlineContent };\n\n// :: bool\n// True for node types that allow no content.\nprototypeAccessors$5.isLeaf.get = function () { return this.contentMatch == ContentMatch.empty };\n\n// :: bool\n// True when this node is an atom, i.e. when it does not have\n// directly editable content.\nprototypeAccessors$5.isAtom.get = function () { return this.isLeaf || this.spec.atom };\n\n// :: ()  bool\n// Tells you whether this node type has any required attributes.\nNodeType.prototype.hasRequiredAttrs = function hasRequiredAttrs () {\n  for (var n in this.attrs) { if (this.attrs[n].isRequired) { return true } }\n  return false\n};\n\nNodeType.prototype.compatibleContent = function compatibleContent (other) {\n  return this == other || this.contentMatch.compatible(other.contentMatch)\n};\n\nNodeType.prototype.computeAttrs = function computeAttrs$1 (attrs) {\n  if (!attrs && this.defaultAttrs) { return this.defaultAttrs }\n  else { return computeAttrs(this.attrs, attrs) }\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark])  Node\n// Create a `Node` of this type. The given attributes are\n// checked and defaulted (you can pass `null` to use the type's\n// defaults entirely, if no required attributes exist). `content`\n// may be a `Fragment`, a node, an array of nodes, or\n// `null`. Similarly `marks` may be `null` to default to the empty\n// set of marks.\nNodeType.prototype.create = function create (attrs, content, marks) {\n  if (this.isText) { throw new Error(\"NodeType.create can't construct text nodes\") }\n  return new Node(this, this.computeAttrs(attrs), Fragment.from(content), Mark.setFrom(marks))\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark])  Node\n// Like [`create`](#model.NodeType.create), but check the given content\n// against the node type's content restrictions, and throw an error\n// if it doesn't match.\nNodeType.prototype.createChecked = function createChecked (attrs, content, marks) {\n  content = Fragment.from(content);\n  if (!this.validContent(content))\n    { throw new RangeError(\"Invalid content for node \" + this.name) }\n  return new Node(this, this.computeAttrs(attrs), content, Mark.setFrom(marks))\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark])  ?Node\n// Like [`create`](#model.NodeType.create), but see if it is necessary to\n// add nodes to the start or end of the given fragment to make it\n// fit the node. If no fitting wrapping can be found, return null.\n// Note that, due to the fact that required nodes can always be\n// created, this will always succeed if you pass null or\n// `Fragment.empty` as content.\nNodeType.prototype.createAndFill = function createAndFill (attrs, content, marks) {\n  attrs = this.computeAttrs(attrs);\n  content = Fragment.from(content);\n  if (content.size) {\n    var before = this.contentMatch.fillBefore(content);\n    if (!before) { return null }\n    content = before.append(content);\n  }\n  var after = this.contentMatch.matchFragment(content).fillBefore(Fragment.empty, true);\n  if (!after) { return null }\n  return new Node(this, attrs, content.append(after), Mark.setFrom(marks))\n};\n\n// :: (Fragment)  bool\n// Returns true if the given fragment is valid content for this node\n// type with the given attributes.\nNodeType.prototype.validContent = function validContent (content) {\n  var result = this.contentMatch.matchFragment(content);\n  if (!result || !result.validEnd) { return false }\n  for (var i = 0; i < content.childCount; i++)\n    { if (!this.allowsMarks(content.child(i).marks)) { return false } }\n  return true\n};\n\n// :: (MarkType)  bool\n// Check whether the given mark type is allowed in this node.\nNodeType.prototype.allowsMarkType = function allowsMarkType (markType) {\n  return this.markSet == null || this.markSet.indexOf(markType) > -1\n};\n\n// :: ([Mark])  bool\n// Test whether the given set of marks are allowed in this node.\nNodeType.prototype.allowsMarks = function allowsMarks (marks) {\n  if (this.markSet == null) { return true }\n  for (var i = 0; i < marks.length; i++) { if (!this.allowsMarkType(marks[i].type)) { return false } }\n  return true\n};\n\n// :: ([Mark])  [Mark]\n// Removes the marks that are not allowed in this node from the given set.\nNodeType.prototype.allowedMarks = function allowedMarks (marks) {\n  if (this.markSet == null) { return marks }\n  var copy;\n  for (var i = 0; i < marks.length; i++) {\n    if (!this.allowsMarkType(marks[i].type)) {\n      if (!copy) { copy = marks.slice(0, i); }\n    } else if (copy) {\n      copy.push(marks[i]);\n    }\n  }\n  return !copy ? marks : copy.length ? copy : Mark.empty\n};\n\nNodeType.compile = function compile (nodes, schema) {\n  var result = Object.create(null);\n  nodes.forEach(function (name, spec) { return result[name] = new NodeType(name, schema, spec); });\n\n  var topType = schema.spec.topNode || \"doc\";\n  if (!result[topType]) { throw new RangeError(\"Schema is missing its top node type ('\" + topType + \"')\") }\n  if (!result.text) { throw new RangeError(\"Every schema needs a 'text' type\") }\n  for (var _ in result.text.attrs) { throw new RangeError(\"The text node type should not have attributes\") }\n\n  return result\n};\n\nObject.defineProperties( NodeType.prototype, prototypeAccessors$5 );\n\n// Attribute descriptors\n\nvar Attribute = function Attribute(options) {\n  this.hasDefault = Object.prototype.hasOwnProperty.call(options, \"default\");\n  this.default = options.default;\n};\n\nvar prototypeAccessors$1$3 = { isRequired: { configurable: true } };\n\nprototypeAccessors$1$3.isRequired.get = function () {\n  return !this.hasDefault\n};\n\nObject.defineProperties( Attribute.prototype, prototypeAccessors$1$3 );\n\n// Marks\n\n// ::- Like nodes, marks (which are associated with nodes to signify\n// things like emphasis or being part of a link) are\n// [tagged](#model.Mark.type) with type objects, which are\n// instantiated once per `Schema`.\nvar MarkType = function MarkType(name, rank, schema, spec) {\n  // :: string\n  // The name of the mark type.\n  this.name = name;\n\n  // :: Schema\n  // The schema that this mark type instance is part of.\n  this.schema = schema;\n\n  // :: MarkSpec\n  // The spec on which the type is based.\n  this.spec = spec;\n\n  this.attrs = initAttrs(spec.attrs);\n\n  this.rank = rank;\n  this.excluded = null;\n  var defaults = defaultAttrs(this.attrs);\n  this.instance = defaults && new Mark(this, defaults);\n};\n\n// :: (?Object)  Mark\n// Create a mark of this type. `attrs` may be `null` or an object\n// containing only some of the mark's attributes. The others, if\n// they have defaults, will be added.\nMarkType.prototype.create = function create (attrs) {\n  if (!attrs && this.instance) { return this.instance }\n  return new Mark(this, computeAttrs(this.attrs, attrs))\n};\n\nMarkType.compile = function compile (marks, schema) {\n  var result = Object.create(null), rank = 0;\n  marks.forEach(function (name, spec) { return result[name] = new MarkType(name, rank++, schema, spec); });\n  return result\n};\n\n// :: ([Mark])  [Mark]\n// When there is a mark of this type in the given set, a new set\n// without it is returned. Otherwise, the input set is returned.\nMarkType.prototype.removeFromSet = function removeFromSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (set[i].type == this)\n      { return set.slice(0, i).concat(set.slice(i + 1)) } }\n  return set\n};\n\n// :: ([Mark])  ?Mark\n// Tests whether there is a mark of this type in the given set.\nMarkType.prototype.isInSet = function isInSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (set[i].type == this) { return set[i] } }\n};\n\n// :: (MarkType)  bool\n// Queries whether a given mark type is\n// [excluded](#model.MarkSpec.excludes) by this one.\nMarkType.prototype.excludes = function excludes (other) {\n  return this.excluded.indexOf(other) > -1\n};\n\n// SchemaSpec:: interface\n// An object describing a schema, as passed to the [`Schema`](#model.Schema)\n// constructor.\n//\n//   nodes:: union<Object<NodeSpec>, OrderedMap<NodeSpec>>\n//   The node types in this schema. Maps names to\n//   [`NodeSpec`](#model.NodeSpec) objects that describe the node type\n//   associated with that name. Their order is significantit\n//   determines which [parse rules](#model.NodeSpec.parseDOM) take\n//   precedence by default, and which nodes come first in a given\n//   [group](#model.NodeSpec.group).\n//\n//   marks:: ?union<Object<MarkSpec>, OrderedMap<MarkSpec>>\n//   The mark types that exist in this schema. The order in which they\n//   are provided determines the order in which [mark\n//   sets](#model.Mark.addToSet) are sorted and in which [parse\n//   rules](#model.MarkSpec.parseDOM) are tried.\n//\n//   topNode:: ?string\n//   The name of the default top-level node for the schema. Defaults\n//   to `\"doc\"`.\n\n// NodeSpec:: interface\n//\n//   content:: ?string\n//   The content expression for this node, as described in the [schema\n//   guide](/docs/guide/#schema.content_expressions). When not given,\n//   the node does not allow any content.\n//\n//   marks:: ?string\n//   The marks that are allowed inside of this node. May be a\n//   space-separated string referring to mark names or groups, `\"_\"`\n//   to explicitly allow all marks, or `\"\"` to disallow marks. When\n//   not given, nodes with inline content default to allowing all\n//   marks, other nodes default to not allowing marks.\n//\n//   group:: ?string\n//   The group or space-separated groups to which this node belongs,\n//   which can be referred to in the content expressions for the\n//   schema.\n//\n//   inline:: ?bool\n//   Should be set to true for inline nodes. (Implied for text nodes.)\n//\n//   atom:: ?bool\n//   Can be set to true to indicate that, though this isn't a [leaf\n//   node](#model.NodeType.isLeaf), it doesn't have directly editable\n//   content and should be treated as a single unit in the view.\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that nodes of this type get.\n//\n//   selectable:: ?bool\n//   Controls whether nodes of this type can be selected as a [node\n//   selection](#state.NodeSelection). Defaults to true for non-text\n//   nodes.\n//\n//   draggable:: ?bool\n//   Determines whether nodes of this type can be dragged without\n//   being selected. Defaults to false.\n//\n//   code:: ?bool\n//   Can be used to indicate that this node contains code, which\n//   causes some commands to behave differently.\n//\n//   defining:: ?bool\n//   Determines whether this node is considered an important parent\n//   node during replace operations (such as paste). Non-defining (the\n//   default) nodes get dropped when their entire content is replaced,\n//   whereas defining nodes persist and wrap the inserted content.\n//   Likewise, in _inserted_ content the defining parents of the\n//   content are preserved when possible. Typically,\n//   non-default-paragraph textblock types, and possibly list items,\n//   are marked as defining.\n//\n//   isolating:: ?bool\n//   When enabled (default is false), the sides of nodes of this type\n//   count as boundaries that regular editing operations, like\n//   backspacing or lifting, won't cross. An example of a node that\n//   should probably have this enabled is a table cell.\n//\n//   toDOM:: ?(node: Node)  DOMOutputSpec\n//   Defines the default way a node of this type should be serialized\n//   to DOM/HTML (as used by\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)).\n//   Should return a DOM node or an [array\n//   structure](#model.DOMOutputSpec) that describes one, with an\n//   optional number zero (hole) in it to indicate where the node's\n//   content should be inserted.\n//\n//   For text nodes, the default is to create a text DOM node. Though\n//   it is possible to create a serializer where text is rendered\n//   differently, this is not supported inside the editor, so you\n//   shouldn't override that in your text node spec.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this node, which can be\n//   used by [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) to\n//   automatically derive a parser. The `node` field in the rules is\n//   implied (the name of this node will be filled in automatically).\n//   If you supply your own parser, you do not need to also specify\n//   parsing rules in your schema.\n//\n//   toDebugString:: ?(node: Node) -> string\n//   Defines the default way a node of this type should be serialized\n//   to a string representation for debugging (e.g. in error messages).\n\n// MarkSpec:: interface\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that marks of this type get.\n//\n//   inclusive:: ?bool\n//   Whether this mark should be active when the cursor is positioned\n//   at its end (or at its start when that is also the start of the\n//   parent node). Defaults to true.\n//\n//   excludes:: ?string\n//   Determines which other marks this mark can coexist with. Should\n//   be a space-separated strings naming other marks or groups of marks.\n//   When a mark is [added](#model.Mark.addToSet) to a set, all marks\n//   that it excludes are removed in the process. If the set contains\n//   any mark that excludes the new mark but is not, itself, excluded\n//   by the new mark, the mark can not be added an the set. You can\n//   use the value `\"_\"` to indicate that the mark excludes all\n//   marks in the schema.\n//\n//   Defaults to only being exclusive with marks of the same type. You\n//   can set it to an empty string (or any string not containing the\n//   mark's own name) to allow multiple marks of a given type to\n//   coexist (as long as they have different attributes).\n//\n//   group:: ?string\n//   The group or space-separated groups to which this mark belongs.\n//\n//   spanning:: ?bool\n//   Determines whether marks of this type can span multiple adjacent\n//   nodes when serialized to DOM/HTML. Defaults to true.\n//\n//   toDOM:: ?(mark: Mark, inline: bool)  DOMOutputSpec\n//   Defines the default way marks of this type should be serialized\n//   to DOM/HTML. When the resulting spec contains a hole, that is\n//   where the marked content is placed. Otherwise, it is appended to\n//   the top node.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this mark (see the\n//   corresponding [node spec field](#model.NodeSpec.parseDOM)). The\n//   `mark` field in the rules is implied.\n\n// AttributeSpec:: interface\n//\n// Used to [define](#model.NodeSpec.attrs) attributes on nodes or\n// marks.\n//\n//   default:: ?any\n//   The default value for this attribute, to use when no explicit\n//   value is provided. Attributes that have no default must be\n//   provided whenever a node or mark of a type that has them is\n//   created.\n\n// ::- A document schema. Holds [node](#model.NodeType) and [mark\n// type](#model.MarkType) objects for the nodes and marks that may\n// occur in conforming documents, and provides functionality for\n// creating and deserializing such documents.\nvar Schema = function Schema(spec) {\n  // :: SchemaSpec\n  // The [spec](#model.SchemaSpec) on which the schema is based,\n  // with the added guarantee that its `nodes` and `marks`\n  // properties are\n  // [`OrderedMap`](https://github.com/marijnh/orderedmap) instances\n  // (not raw objects).\n  this.spec = {};\n  for (var prop in spec) { this.spec[prop] = spec[prop]; }\n  this.spec.nodes = OrderedMap.from(spec.nodes);\n  this.spec.marks = OrderedMap.from(spec.marks);\n\n  // :: Object<NodeType>\n  // An object mapping the schema's node names to node type objects.\n  this.nodes = NodeType.compile(this.spec.nodes, this);\n\n  // :: Object<MarkType>\n  // A map from mark names to mark type objects.\n  this.marks = MarkType.compile(this.spec.marks, this);\n\n  var contentExprCache = Object.create(null);\n  for (var prop$1 in this.nodes) {\n    if (prop$1 in this.marks)\n      { throw new RangeError(prop$1 + \" can not be both a node and a mark\") }\n    var type = this.nodes[prop$1], contentExpr = type.spec.content || \"\", markExpr = type.spec.marks;\n    type.contentMatch = contentExprCache[contentExpr] ||\n      (contentExprCache[contentExpr] = ContentMatch.parse(contentExpr, this.nodes));\n    type.inlineContent = type.contentMatch.inlineContent;\n    type.markSet = markExpr == \"_\" ? null :\n      markExpr ? gatherMarks(this, markExpr.split(\" \")) :\n      markExpr == \"\" || !type.inlineContent ? [] : null;\n  }\n  for (var prop$2 in this.marks) {\n    var type$1 = this.marks[prop$2], excl = type$1.spec.excludes;\n    type$1.excluded = excl == null ? [type$1] : excl == \"\" ? [] : gatherMarks(this, excl.split(\" \"));\n  }\n\n  this.nodeFromJSON = this.nodeFromJSON.bind(this);\n  this.markFromJSON = this.markFromJSON.bind(this);\n\n  // :: NodeType\n  // The type of the [default top node](#model.SchemaSpec.topNode)\n  // for this schema.\n  this.topNodeType = this.nodes[this.spec.topNode || \"doc\"];\n\n  // :: Object\n  // An object for storing whatever values modules may want to\n  // compute and cache per schema. (If you want to store something\n  // in it, try to use property names unlikely to clash.)\n  this.cached = Object.create(null);\n  this.cached.wrappings = Object.create(null);\n};\n\n// :: (union<string, NodeType>, ?Object, ?union<Fragment, Node, [Node]>, ?[Mark])  Node\n// Create a node in this schema. The `type` may be a string or a\n// `NodeType` instance. Attributes will be extended\n// with defaults, `content` may be a `Fragment`,\n// `null`, a `Node`, or an array of nodes.\nSchema.prototype.node = function node (type, attrs, content, marks) {\n  if (typeof type == \"string\")\n    { type = this.nodeType(type); }\n  else if (!(type instanceof NodeType))\n    { throw new RangeError(\"Invalid node type: \" + type) }\n  else if (type.schema != this)\n    { throw new RangeError(\"Node type from different schema used (\" + type.name + \")\") }\n\n  return type.createChecked(attrs, content, marks)\n};\n\n// :: (string, ?[Mark])  Node\n// Create a text node in the schema. Empty text nodes are not\n// allowed.\nSchema.prototype.text = function text (text$1, marks) {\n  var type = this.nodes.text;\n  return new TextNode(type, type.defaultAttrs, text$1, Mark.setFrom(marks))\n};\n\n// :: (union<string, MarkType>, ?Object)  Mark\n// Create a mark with the given type and attributes.\nSchema.prototype.mark = function mark (type, attrs) {\n  if (typeof type == \"string\") { type = this.marks[type]; }\n  return type.create(attrs)\n};\n\n// :: (Object)  Node\n// Deserialize a node from its JSON representation. This method is\n// bound.\nSchema.prototype.nodeFromJSON = function nodeFromJSON (json) {\n  return Node.fromJSON(this, json)\n};\n\n// :: (Object)  Mark\n// Deserialize a mark from its JSON representation. This method is\n// bound.\nSchema.prototype.markFromJSON = function markFromJSON (json) {\n  return Mark.fromJSON(this, json)\n};\n\nSchema.prototype.nodeType = function nodeType (name) {\n  var found = this.nodes[name];\n  if (!found) { throw new RangeError(\"Unknown node type: \" + name) }\n  return found\n};\n\nfunction gatherMarks(schema, marks) {\n  var found = [];\n  for (var i = 0; i < marks.length; i++) {\n    var name = marks[i], mark = schema.marks[name], ok = mark;\n    if (mark) {\n      found.push(mark);\n    } else {\n      for (var prop in schema.marks) {\n        var mark$1 = schema.marks[prop];\n        if (name == \"_\" || (mark$1.spec.group && mark$1.spec.group.split(\" \").indexOf(name) > -1))\n          { found.push(ok = mark$1); }\n      }\n    }\n    if (!ok) { throw new SyntaxError(\"Unknown mark type: '\" + marks[i] + \"'\") }\n  }\n  return found\n}\n\n// ParseOptions:: interface\n// These are the options recognized by the\n// [`parse`](#model.DOMParser.parse) and\n// [`parseSlice`](#model.DOMParser.parseSlice) methods.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   By default, whitespace is collapsed as per HTML's rules. Pass\n//   `true` to preserve whitespace, but normalize newlines to\n//   spaces, and `\"full\"` to preserve whitespace entirely.\n//\n//   findPositions:: ?[{node: dom.Node, offset: number}]\n//   When given, the parser will, beside parsing the content,\n//   record the document positions of the given DOM positions. It\n//   will do so by writing to the objects, adding a `pos` property\n//   that holds the document position. DOM positions that are not\n//   in the parsed content will not be written to.\n//\n//   from:: ?number\n//   The child node index to start parsing from.\n//\n//   to:: ?number\n//   The child node index to stop parsing at.\n//\n//   topNode:: ?Node\n//   By default, the content is parsed into the schema's default\n//   [top node type](#model.Schema.topNodeType). You can pass this\n//   option to use the type and attributes from a different node\n//   as the top container.\n//\n//   topMatch:: ?ContentMatch\n//   Provide the starting content match that content parsed into the\n//   top node is matched against.\n//\n//   context:: ?ResolvedPos\n//   A set of additional nodes to count as\n//   [context](#model.ParseRule.context) when parsing, above the\n//   given [top node](#model.ParseOptions.topNode).\n\n// ParseRule:: interface\n// A value that describes how to parse a given DOM node or inline\n// style as a ProseMirror node or mark.\n//\n//   tag:: ?string\n//   A CSS selector describing the kind of DOM elements to match. A\n//   single rule should have _either_ a `tag` or a `style` property.\n//\n//   namespace:: ?string\n//   The namespace to match. This should be used with `tag`.\n//   Nodes are only matched when the namespace matches or this property\n//   is null.\n//\n//   style:: ?string\n//   A CSS property name to match. When given, this rule matches\n//   inline styles that list that property. May also have the form\n//   `\"property=value\"`, in which case the rule only matches if the\n//   property's value exactly matches the given value. (For more\n//   complicated filters, use [`getAttrs`](#model.ParseRule.getAttrs)\n//   and return false to indicate that the match failed.)\n//\n//   priority:: ?number\n//   Can be used to change the order in which the parse rules in a\n//   schema are tried. Those with higher priority come first. Rules\n//   without a priority are counted as having priority 50. This\n//   property is only meaningful in a schemawhen directly\n//   constructing a parser, the order of the rule array is used.\n//\n//   consuming:: ?boolean\n//   By default, when a rule matches an element or style, no further\n//   rules get a chance to match it. By setting this to `false`, you\n//   indicate that even when this rule matches, other rules that come\n//   after it should also run.\n//\n//   context:: ?string\n//   When given, restricts this rule to only match when the current\n//   contextthe parent nodes into which the content is being\n//   parsedmatches this expression. Should contain one or more node\n//   names or node group names followed by single or double slashes.\n//   For example `\"paragraph/\"` means the rule only matches when the\n//   parent node is a paragraph, `\"blockquote/paragraph/\"` restricts\n//   it to be in a paragraph that is inside a blockquote, and\n//   `\"section//\"` matches any position inside a sectiona double\n//   slash matches any sequence of ancestor nodes. To allow multiple\n//   different contexts, they can be separated by a pipe (`|`)\n//   character, as in `\"blockquote/|list_item/\"`.\n//\n//   node:: ?string\n//   The name of the node type to create when this rule matches. Only\n//   valid for rules with a `tag` property, not for style rules. Each\n//   rule should have one of a `node`, `mark`, or `ignore` property\n//   (except when it appears in a [node](#model.NodeSpec.parseDOM) or\n//   [mark spec](#model.MarkSpec.parseDOM), in which case the `node`\n//   or `mark` property will be derived from its position).\n//\n//   mark:: ?string\n//   The name of the mark type to wrap the matched content in.\n//\n//   ignore:: ?bool\n//   When true, ignore content that matches this rule.\n//\n//   closeParent:: ?bool\n//   When true, finding an element that matches this rule will close\n//   the current node.\n//\n//   skip:: ?bool\n//   When true, ignore the node that matches this rule, but do parse\n//   its content.\n//\n//   attrs:: ?Object\n//   Attributes for the node or mark created by this rule. When\n//   `getAttrs` is provided, it takes precedence.\n//\n//   getAttrs:: ?(union<dom.Node, string>)  ?union<Object, false>\n//   A function used to compute the attributes for the node or mark\n//   created by this rule. Can also be used to describe further\n//   conditions the DOM element or style must match. When it returns\n//   `false`, the rule won't match. When it returns null or undefined,\n//   that is interpreted as an empty/default set of attributes.\n//\n//   Called with a DOM Element for `tag` rules, and with a string (the\n//   style's value) for `style` rules.\n//\n//   contentElement:: ?union<string, (dom.Node)  dom.Node>\n//   For `tag` rules that produce non-leaf nodes or marks, by default\n//   the content of the DOM element is parsed as content of the mark\n//   or node. If the child nodes are in a descendent node, this may be\n//   a CSS selector string that the parser must use to find the actual\n//   content element, or a function that returns the actual content\n//   element to the parser.\n//\n//   getContent:: ?(dom.Node, schema: Schema)  Fragment\n//   Can be used to override the content of a matched node. When\n//   present, instead of parsing the node's child nodes, the result of\n//   this function is used.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   Controls whether whitespace should be preserved when parsing the\n//   content inside the matched element. `false` means whitespace may\n//   be collapsed, `true` means that whitespace should be preserved\n//   but newlines normalized to spaces, and `\"full\"` means that\n//   newlines should also be preserved.\n\n// ::- A DOM parser represents a strategy for parsing DOM content into\n// a ProseMirror document conforming to a given schema. Its behavior\n// is defined by an array of [rules](#model.ParseRule).\nvar DOMParser = function DOMParser(schema, rules) {\n  var this$1 = this;\n\n  // :: Schema\n  // The schema into which the parser parses.\n  this.schema = schema;\n  // :: [ParseRule]\n  // The set of [parse rules](#model.ParseRule) that the parser\n  // uses, in order of precedence.\n  this.rules = rules;\n  this.tags = [];\n  this.styles = [];\n\n  rules.forEach(function (rule) {\n    if (rule.tag) { this$1.tags.push(rule); }\n    else if (rule.style) { this$1.styles.push(rule); }\n  });\n\n  // Only normalize list elements when lists in the schema can't directly contain themselves\n  this.normalizeLists = !this.tags.some(function (r) {\n    if (!/^(ul|ol)\\b/.test(r.tag) || !r.node) { return false }\n    var node = schema.nodes[r.node];\n    return node.contentMatch.matchType(node)\n  });\n};\n\n// :: (dom.Node, ?ParseOptions)  Node\n// Parse a document from the content of a DOM node.\nDOMParser.prototype.parse = function parse (dom, options) {\n    if ( options === void 0 ) options = {};\n\n  var context = new ParseContext(this, options, false);\n  context.addAll(dom, null, options.from, options.to);\n  return context.finish()\n};\n\n// :: (dom.Node, ?ParseOptions)  Slice\n// Parses the content of the given DOM node, like\n// [`parse`](#model.DOMParser.parse), and takes the same set of\n// options. But unlike that method, which produces a whole node,\n// this one returns a slice that is open at the sides, meaning that\n// the schema constraints aren't applied to the start of nodes to\n// the left of the input and the end of nodes at the end.\nDOMParser.prototype.parseSlice = function parseSlice (dom, options) {\n    if ( options === void 0 ) options = {};\n\n  var context = new ParseContext(this, options, true);\n  context.addAll(dom, null, options.from, options.to);\n  return Slice.maxOpen(context.finish())\n};\n\nDOMParser.prototype.matchTag = function matchTag (dom, context, after) {\n  for (var i = after ? this.tags.indexOf(after) + 1 : 0; i < this.tags.length; i++) {\n    var rule = this.tags[i];\n    if (matches(dom, rule.tag) &&\n        (rule.namespace === undefined || dom.namespaceURI == rule.namespace) &&\n        (!rule.context || context.matchesContext(rule.context))) {\n      if (rule.getAttrs) {\n        var result = rule.getAttrs(dom);\n        if (result === false) { continue }\n        rule.attrs = result;\n      }\n      return rule\n    }\n  }\n};\n\nDOMParser.prototype.matchStyle = function matchStyle (prop, value, context, after) {\n  for (var i = after ? this.styles.indexOf(after) + 1 : 0; i < this.styles.length; i++) {\n    var rule = this.styles[i];\n    if (rule.style.indexOf(prop) != 0 ||\n        rule.context && !context.matchesContext(rule.context) ||\n        // Test that the style string either precisely matches the prop,\n        // or has an '=' sign after the prop, followed by the given\n        // value.\n        rule.style.length > prop.length &&\n        (rule.style.charCodeAt(prop.length) != 61 || rule.style.slice(prop.length + 1) != value))\n      { continue }\n    if (rule.getAttrs) {\n      var result = rule.getAttrs(value);\n      if (result === false) { continue }\n      rule.attrs = result;\n    }\n    return rule\n  }\n};\n\n// : (Schema)  [ParseRule]\nDOMParser.schemaRules = function schemaRules (schema) {\n  var result = [];\n  function insert(rule) {\n    var priority = rule.priority == null ? 50 : rule.priority, i = 0;\n    for (; i < result.length; i++) {\n      var next = result[i], nextPriority = next.priority == null ? 50 : next.priority;\n      if (nextPriority < priority) { break }\n    }\n    result.splice(i, 0, rule);\n  }\n\n  var loop = function ( name ) {\n    var rules = schema.marks[name].spec.parseDOM;\n    if (rules) { rules.forEach(function (rule) {\n      insert(rule = copy(rule));\n      rule.mark = name;\n    }); }\n  };\n\n    for (var name in schema.marks) loop( name );\n  var loop$1 = function ( name ) {\n    var rules$1 = schema.nodes[name$1].spec.parseDOM;\n    if (rules$1) { rules$1.forEach(function (rule) {\n      insert(rule = copy(rule));\n      rule.node = name$1;\n    }); }\n  };\n\n    for (var name$1 in schema.nodes) loop$1();\n  return result\n};\n\n// :: (Schema)  DOMParser\n// Construct a DOM parser using the parsing rules listed in a\n// schema's [node specs](#model.NodeSpec.parseDOM), reordered by\n// [priority](#model.ParseRule.priority).\nDOMParser.fromSchema = function fromSchema (schema) {\n  return schema.cached.domParser ||\n    (schema.cached.domParser = new DOMParser(schema, DOMParser.schemaRules(schema)))\n};\n\n// : Object<bool> The block-level tags in HTML5\nvar blockTags = {\n  address: true, article: true, aside: true, blockquote: true, canvas: true,\n  dd: true, div: true, dl: true, fieldset: true, figcaption: true, figure: true,\n  footer: true, form: true, h1: true, h2: true, h3: true, h4: true, h5: true,\n  h6: true, header: true, hgroup: true, hr: true, li: true, noscript: true, ol: true,\n  output: true, p: true, pre: true, section: true, table: true, tfoot: true, ul: true\n};\n\n// : Object<bool> The tags that we normally ignore.\nvar ignoreTags = {\n  head: true, noscript: true, object: true, script: true, style: true, title: true\n};\n\n// : Object<bool> List tags.\nvar listTags = {ol: true, ul: true};\n\n// Using a bitfield for node context options\nvar OPT_PRESERVE_WS = 1, OPT_PRESERVE_WS_FULL = 2, OPT_OPEN_LEFT = 4;\n\nfunction wsOptionsFor(preserveWhitespace) {\n  return (preserveWhitespace ? OPT_PRESERVE_WS : 0) | (preserveWhitespace === \"full\" ? OPT_PRESERVE_WS_FULL : 0)\n}\n\nvar NodeContext = function NodeContext(type, attrs, marks, pendingMarks, solid, match, options) {\n  this.type = type;\n  this.attrs = attrs;\n  this.solid = solid;\n  this.match = match || (options & OPT_OPEN_LEFT ? null : type.contentMatch);\n  this.options = options;\n  this.content = [];\n  // Marks applied to this node itself\n  this.marks = marks;\n  // Marks applied to its children\n  this.activeMarks = Mark.none;\n  // Marks that can't apply here, but will be used in children if possible\n  this.pendingMarks = pendingMarks;\n  // Nested Marks with same type\n  this.stashMarks = [];\n};\n\nNodeContext.prototype.findWrapping = function findWrapping (node) {\n  if (!this.match) {\n    if (!this.type) { return [] }\n    var fill = this.type.contentMatch.fillBefore(Fragment.from(node));\n    if (fill) {\n      this.match = this.type.contentMatch.matchFragment(fill);\n    } else {\n      var start = this.type.contentMatch, wrap;\n      if (wrap = start.findWrapping(node.type)) {\n        this.match = start;\n        return wrap\n      } else {\n        return null\n      }\n    }\n  }\n  return this.match.findWrapping(node.type)\n};\n\nNodeContext.prototype.finish = function finish (openEnd) {\n  if (!(this.options & OPT_PRESERVE_WS)) { // Strip trailing whitespace\n    var last = this.content[this.content.length - 1], m;\n    if (last && last.isText && (m = /[ \\t\\r\\n\\u000c]+$/.exec(last.text))) {\n      if (last.text.length == m[0].length) { this.content.pop(); }\n      else { this.content[this.content.length - 1] = last.withText(last.text.slice(0, last.text.length - m[0].length)); }\n    }\n  }\n  var content = Fragment.from(this.content);\n  if (!openEnd && this.match)\n    { content = content.append(this.match.fillBefore(Fragment.empty, true)); }\n  return this.type ? this.type.create(this.attrs, content, this.marks) : content\n};\n\nNodeContext.prototype.popFromStashMark = function popFromStashMark (mark) {\n  for (var i = this.stashMarks.length - 1; i >= 0; i--)\n    { if (mark.eq(this.stashMarks[i])) { return this.stashMarks.splice(i, 1)[0] } }\n};\n\nNodeContext.prototype.applyPending = function applyPending (nextType) {\n  for (var i = 0, pending = this.pendingMarks; i < pending.length; i++) {\n    var mark = pending[i];\n    if ((this.type ? this.type.allowsMarkType(mark.type) : markMayApply(mark.type, nextType)) &&\n        !mark.isInSet(this.activeMarks)) {\n      this.activeMarks = mark.addToSet(this.activeMarks);\n      this.pendingMarks = mark.removeFromSet(this.pendingMarks);\n    }\n  }\n};\n\nvar ParseContext = function ParseContext(parser, options, open) {\n  // : DOMParser The parser we are using.\n  this.parser = parser;\n  // : Object The options passed to this parse.\n  this.options = options;\n  this.isOpen = open;\n  var topNode = options.topNode, topContext;\n  var topOptions = wsOptionsFor(options.preserveWhitespace) | (open ? OPT_OPEN_LEFT : 0);\n  if (topNode)\n    { topContext = new NodeContext(topNode.type, topNode.attrs, Mark.none, Mark.none, true,\n                                 options.topMatch || topNode.type.contentMatch, topOptions); }\n  else if (open)\n    { topContext = new NodeContext(null, null, Mark.none, Mark.none, true, null, topOptions); }\n  else\n    { topContext = new NodeContext(parser.schema.topNodeType, null, Mark.none, Mark.none, true, null, topOptions); }\n  this.nodes = [topContext];\n  // : [Mark] The current set of marks\n  this.open = 0;\n  this.find = options.findPositions;\n  this.needsBlock = false;\n};\n\nvar prototypeAccessors$6 = { top: { configurable: true },currentPos: { configurable: true } };\n\nprototypeAccessors$6.top.get = function () {\n  return this.nodes[this.open]\n};\n\n// : (dom.Node)\n// Add a DOM node to the content. Text is inserted as text node,\n// otherwise, the node is passed to `addElement` or, if it has a\n// `style` attribute, `addElementWithStyles`.\nParseContext.prototype.addDOM = function addDOM (dom) {\n  if (dom.nodeType == 3) {\n    this.addTextNode(dom);\n  } else if (dom.nodeType == 1) {\n    var style = dom.getAttribute(\"style\");\n    var marks = style ? this.readStyles(parseStyles(style)) : null, top = this.top;\n    if (marks != null) { for (var i = 0; i < marks.length; i++) { this.addPendingMark(marks[i]); } }\n    this.addElement(dom);\n    if (marks != null) { for (var i$1 = 0; i$1 < marks.length; i$1++) { this.removePendingMark(marks[i$1], top); } }\n  }\n};\n\nParseContext.prototype.addTextNode = function addTextNode (dom) {\n  var value = dom.nodeValue;\n  var top = this.top;\n  if ((top.type ? top.type.inlineContent : top.content.length && top.content[0].isInline) || /[^ \\t\\r\\n\\u000c]/.test(value)) {\n    if (!(top.options & OPT_PRESERVE_WS)) {\n      value = value.replace(/[ \\t\\r\\n\\u000c]+/g, \" \");\n      // If this starts with whitespace, and there is no node before it, or\n      // a hard break, or a text node that ends with whitespace, strip the\n      // leading space.\n      if (/^[ \\t\\r\\n\\u000c]/.test(value) && this.open == this.nodes.length - 1) {\n        var nodeBefore = top.content[top.content.length - 1];\n        var domNodeBefore = dom.previousSibling;\n        if (!nodeBefore ||\n            (domNodeBefore && domNodeBefore.nodeName == 'BR') ||\n            (nodeBefore.isText && /[ \\t\\r\\n\\u000c]$/.test(nodeBefore.text)))\n          { value = value.slice(1); }\n      }\n    } else if (!(top.options & OPT_PRESERVE_WS_FULL)) {\n      value = value.replace(/\\r?\\n|\\r/g, \" \");\n    }\n    if (value) { this.insertNode(this.parser.schema.text(value)); }\n    this.findInText(dom);\n  } else {\n    this.findInside(dom);\n  }\n};\n\n// : (dom.Element, ?ParseRule)\n// Try to find a handler for the given tag and use that to parse. If\n// none is found, the element's content nodes are added directly.\nParseContext.prototype.addElement = function addElement (dom, matchAfter) {\n  var name = dom.nodeName.toLowerCase(), ruleID;\n  if (listTags.hasOwnProperty(name) && this.parser.normalizeLists) { normalizeList(dom); }\n  var rule = (this.options.ruleFromNode && this.options.ruleFromNode(dom)) ||\n      (ruleID = this.parser.matchTag(dom, this, matchAfter));\n  if (rule ? rule.ignore : ignoreTags.hasOwnProperty(name)) {\n    this.findInside(dom);\n  } else if (!rule || rule.skip || rule.closeParent) {\n    if (rule && rule.closeParent) { this.open = Math.max(0, this.open - 1); }\n    else if (rule && rule.skip.nodeType) { dom = rule.skip; }\n    var sync, top = this.top, oldNeedsBlock = this.needsBlock;\n    if (blockTags.hasOwnProperty(name)) {\n      sync = true;\n      if (!top.type) { this.needsBlock = true; }\n    } else if (!dom.firstChild) {\n      this.leafFallback(dom);\n      return\n    }\n    this.addAll(dom);\n    if (sync) { this.sync(top); }\n    this.needsBlock = oldNeedsBlock;\n  } else {\n    this.addElementByRule(dom, rule, rule.consuming === false ? ruleID : null);\n  }\n};\n\n// Called for leaf DOM nodes that would otherwise be ignored\nParseContext.prototype.leafFallback = function leafFallback (dom) {\n  if (dom.nodeName == \"BR\" && this.top.type && this.top.type.inlineContent)\n    { this.addTextNode(dom.ownerDocument.createTextNode(\"\\n\")); }\n};\n\n// Run any style parser associated with the node's styles. Either\n// return an array of marks, or null to indicate some of the styles\n// had a rule with `ignore` set.\nParseContext.prototype.readStyles = function readStyles (styles) {\n  var marks = Mark.none;\n  style: for (var i = 0; i < styles.length; i += 2) {\n    for (var after = null;;) {\n      var rule = this.parser.matchStyle(styles[i], styles[i + 1], this, after);\n      if (!rule) { continue style }\n      if (rule.ignore) { return null }\n      marks = this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(marks);\n      if (rule.consuming === false) { after = rule; }\n      else { break }\n    }\n  }\n  return marks\n};\n\n// : (dom.Element, ParseRule)  bool\n// Look up a handler for the given node. If none are found, return\n// false. Otherwise, apply it, use its return value to drive the way\n// the node's content is wrapped, and return true.\nParseContext.prototype.addElementByRule = function addElementByRule (dom, rule, continueAfter) {\n    var this$1 = this;\n\n  var sync, nodeType, markType, mark;\n  if (rule.node) {\n    nodeType = this.parser.schema.nodes[rule.node];\n    if (!nodeType.isLeaf) {\n      sync = this.enter(nodeType, rule.attrs, rule.preserveWhitespace);\n    } else if (!this.insertNode(nodeType.create(rule.attrs))) {\n      this.leafFallback(dom);\n    }\n  } else {\n    markType = this.parser.schema.marks[rule.mark];\n    mark = markType.create(rule.attrs);\n    this.addPendingMark(mark);\n  }\n  var startIn = this.top;\n\n  if (nodeType && nodeType.isLeaf) {\n    this.findInside(dom);\n  } else if (continueAfter) {\n    this.addElement(dom, continueAfter);\n  } else if (rule.getContent) {\n    this.findInside(dom);\n    rule.getContent(dom, this.parser.schema).forEach(function (node) { return this$1.insertNode(node); });\n  } else {\n    var contentDOM = rule.contentElement;\n    if (typeof contentDOM == \"string\") { contentDOM = dom.querySelector(contentDOM); }\n    else if (typeof contentDOM == \"function\") { contentDOM = contentDOM(dom); }\n    if (!contentDOM) { contentDOM = dom; }\n    this.findAround(dom, contentDOM, true);\n    this.addAll(contentDOM, sync);\n  }\n  if (sync) { this.sync(startIn); this.open--; }\n  if (mark) { this.removePendingMark(mark, startIn); }\n};\n\n// : (dom.Node, ?NodeBuilder, ?number, ?number)\n// Add all child nodes between `startIndex` and `endIndex` (or the\n// whole node, if not given). If `sync` is passed, use it to\n// synchronize after every block element.\nParseContext.prototype.addAll = function addAll (parent, sync, startIndex, endIndex) {\n  var index = startIndex || 0;\n  for (var dom = startIndex ? parent.childNodes[startIndex] : parent.firstChild,\n           end = endIndex == null ? null : parent.childNodes[endIndex];\n       dom != end; dom = dom.nextSibling, ++index) {\n    this.findAtPoint(parent, index);\n    this.addDOM(dom);\n    if (sync && blockTags.hasOwnProperty(dom.nodeName.toLowerCase()))\n      { this.sync(sync); }\n  }\n  this.findAtPoint(parent, index);\n};\n\n// Try to find a way to fit the given node type into the current\n// context. May add intermediate wrappers and/or leave non-solid\n// nodes that we're in.\nParseContext.prototype.findPlace = function findPlace (node) {\n  var route, sync;\n  for (var depth = this.open; depth >= 0; depth--) {\n    var cx = this.nodes[depth];\n    var found = cx.findWrapping(node);\n    if (found && (!route || route.length > found.length)) {\n      route = found;\n      sync = cx;\n      if (!found.length) { break }\n    }\n    if (cx.solid) { break }\n  }\n  if (!route) { return false }\n  this.sync(sync);\n  for (var i = 0; i < route.length; i++)\n    { this.enterInner(route[i], null, false); }\n  return true\n};\n\n// : (Node)  ?Node\n// Try to insert the given node, adjusting the context when needed.\nParseContext.prototype.insertNode = function insertNode (node) {\n  if (node.isInline && this.needsBlock && !this.top.type) {\n    var block = this.textblockFromContext();\n    if (block) { this.enterInner(block); }\n  }\n  if (this.findPlace(node)) {\n    this.closeExtra();\n    var top = this.top;\n    top.applyPending(node.type);\n    if (top.match) { top.match = top.match.matchType(node.type); }\n    var marks = top.activeMarks;\n    for (var i = 0; i < node.marks.length; i++)\n      { if (!top.type || top.type.allowsMarkType(node.marks[i].type))\n        { marks = node.marks[i].addToSet(marks); } }\n    top.content.push(node.mark(marks));\n    return true\n  }\n  return false\n};\n\n// : (NodeType, ?Object)  bool\n// Try to start a node of the given type, adjusting the context when\n// necessary.\nParseContext.prototype.enter = function enter (type, attrs, preserveWS) {\n  var ok = this.findPlace(type.create(attrs));\n  if (ok) { this.enterInner(type, attrs, true, preserveWS); }\n  return ok\n};\n\n// Open a node of the given type\nParseContext.prototype.enterInner = function enterInner (type, attrs, solid, preserveWS) {\n  this.closeExtra();\n  var top = this.top;\n  top.applyPending(type);\n  top.match = top.match && top.match.matchType(type, attrs);\n  var options = preserveWS == null ? top.options & ~OPT_OPEN_LEFT : wsOptionsFor(preserveWS);\n  if ((top.options & OPT_OPEN_LEFT) && top.content.length == 0) { options |= OPT_OPEN_LEFT; }\n  this.nodes.push(new NodeContext(type, attrs, top.activeMarks, top.pendingMarks, solid, null, options));\n  this.open++;\n};\n\n// Make sure all nodes above this.open are finished and added to\n// their parents\nParseContext.prototype.closeExtra = function closeExtra (openEnd) {\n  var i = this.nodes.length - 1;\n  if (i > this.open) {\n    for (; i > this.open; i--) { this.nodes[i - 1].content.push(this.nodes[i].finish(openEnd)); }\n    this.nodes.length = this.open + 1;\n  }\n};\n\nParseContext.prototype.finish = function finish () {\n  this.open = 0;\n  this.closeExtra(this.isOpen);\n  return this.nodes[0].finish(this.isOpen || this.options.topOpen)\n};\n\nParseContext.prototype.sync = function sync (to) {\n  for (var i = this.open; i >= 0; i--) { if (this.nodes[i] == to) {\n    this.open = i;\n    return\n  } }\n};\n\nprototypeAccessors$6.currentPos.get = function () {\n  this.closeExtra();\n  var pos = 0;\n  for (var i = this.open; i >= 0; i--) {\n    var content = this.nodes[i].content;\n    for (var j = content.length - 1; j >= 0; j--)\n      { pos += content[j].nodeSize; }\n    if (i) { pos++; }\n  }\n  return pos\n};\n\nParseContext.prototype.findAtPoint = function findAtPoint (parent, offset) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].node == parent && this.find[i].offset == offset)\n      { this.find[i].pos = this.currentPos; }\n  } }\n};\n\nParseContext.prototype.findInside = function findInside (parent) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node))\n      { this.find[i].pos = this.currentPos; }\n  } }\n};\n\nParseContext.prototype.findAround = function findAround (parent, content, before) {\n  if (parent != content && this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node)) {\n      var pos = content.compareDocumentPosition(this.find[i].node);\n      if (pos & (before ? 2 : 4))\n        { this.find[i].pos = this.currentPos; }\n    }\n  } }\n};\n\nParseContext.prototype.findInText = function findInText (textNode) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].node == textNode)\n      { this.find[i].pos = this.currentPos - (textNode.nodeValue.length - this.find[i].offset); }\n  } }\n};\n\n// : (string)  bool\n// Determines whether the given [context\n// string](#ParseRule.context) matches this context.\nParseContext.prototype.matchesContext = function matchesContext (context) {\n    var this$1 = this;\n\n  if (context.indexOf(\"|\") > -1)\n    { return context.split(/\\s*\\|\\s*/).some(this.matchesContext, this) }\n\n  var parts = context.split(\"/\");\n  var option = this.options.context;\n  var useRoot = !this.isOpen && (!option || option.parent.type == this.nodes[0].type);\n  var minDepth = -(option ? option.depth + 1 : 0) + (useRoot ? 0 : 1);\n  var match = function (i, depth) {\n    for (; i >= 0; i--) {\n      var part = parts[i];\n      if (part == \"\") {\n        if (i == parts.length - 1 || i == 0) { continue }\n        for (; depth >= minDepth; depth--)\n          { if (match(i - 1, depth)) { return true } }\n        return false\n      } else {\n        var next = depth > 0 || (depth == 0 && useRoot) ? this$1.nodes[depth].type\n            : option && depth >= minDepth ? option.node(depth - minDepth).type\n            : null;\n        if (!next || (next.name != part && next.groups.indexOf(part) == -1))\n          { return false }\n        depth--;\n      }\n    }\n    return true\n  };\n  return match(parts.length - 1, this.open)\n};\n\nParseContext.prototype.textblockFromContext = function textblockFromContext () {\n  var $context = this.options.context;\n  if ($context) { for (var d = $context.depth; d >= 0; d--) {\n    var deflt = $context.node(d).contentMatchAt($context.indexAfter(d)).defaultType;\n    if (deflt && deflt.isTextblock && deflt.defaultAttrs) { return deflt }\n  } }\n  for (var name in this.parser.schema.nodes) {\n    var type = this.parser.schema.nodes[name];\n    if (type.isTextblock && type.defaultAttrs) { return type }\n  }\n};\n\nParseContext.prototype.addPendingMark = function addPendingMark (mark) {\n  var found = findSameMarkInSet(mark, this.top.pendingMarks);\n  if (found) { this.top.stashMarks.push(found); }\n  this.top.pendingMarks = mark.addToSet(this.top.pendingMarks);\n};\n\nParseContext.prototype.removePendingMark = function removePendingMark (mark, upto) {\n  for (var depth = this.open; depth >= 0; depth--) {\n    var level = this.nodes[depth];\n    var found = level.pendingMarks.lastIndexOf(mark);\n    if (found > -1) {\n      level.pendingMarks = mark.removeFromSet(level.pendingMarks);\n    } else {\n      level.activeMarks = mark.removeFromSet(level.activeMarks);\n      var stashMark = level.popFromStashMark(mark);\n      if (stashMark) { level.activeMarks = stashMark.addToSet(level.activeMarks); }\n    }\n    if (level == upto) { break }\n  }\n};\n\nObject.defineProperties( ParseContext.prototype, prototypeAccessors$6 );\n\n// Kludge to work around directly nested list nodes produced by some\n// tools and allowed by browsers to mean that the nested list is\n// actually part of the list item above it.\nfunction normalizeList(dom) {\n  for (var child = dom.firstChild, prevItem = null; child; child = child.nextSibling) {\n    var name = child.nodeType == 1 ? child.nodeName.toLowerCase() : null;\n    if (name && listTags.hasOwnProperty(name) && prevItem) {\n      prevItem.appendChild(child);\n      child = prevItem;\n    } else if (name == \"li\") {\n      prevItem = child;\n    } else if (name) {\n      prevItem = null;\n    }\n  }\n}\n\n// Apply a CSS selector.\nfunction matches(dom, selector) {\n  return (dom.matches || dom.msMatchesSelector || dom.webkitMatchesSelector || dom.mozMatchesSelector).call(dom, selector)\n}\n\n// : (string)  [string]\n// Tokenize a style attribute into property/value pairs.\nfunction parseStyles(style) {\n  var re = /\\s*([\\w-]+)\\s*:\\s*([^;]+)/g, m, result = [];\n  while (m = re.exec(style)) { result.push(m[1], m[2].trim()); }\n  return result\n}\n\nfunction copy(obj) {\n  var copy = {};\n  for (var prop in obj) { copy[prop] = obj[prop]; }\n  return copy\n}\n\n// Used when finding a mark at the top level of a fragment parse.\n// Checks whether it would be reasonable to apply a given mark type to\n// a given node, by looking at the way the mark occurs in the schema.\nfunction markMayApply(markType, nodeType) {\n  var nodes = nodeType.schema.nodes;\n  var loop = function ( name ) {\n    var parent = nodes[name];\n    if (!parent.allowsMarkType(markType)) { return }\n    var seen = [], scan = function (match) {\n      seen.push(match);\n      for (var i = 0; i < match.edgeCount; i++) {\n        var ref = match.edge(i);\n        var type = ref.type;\n        var next = ref.next;\n        if (type == nodeType) { return true }\n        if (seen.indexOf(next) < 0 && scan(next)) { return true }\n      }\n    };\n    if (scan(parent.contentMatch)) { return { v: true } }\n  };\n\n  for (var name in nodes) {\n    var returned = loop( name );\n\n    if ( returned ) return returned.v;\n  }\n}\n\nfunction findSameMarkInSet(mark, set) {\n  for (var i = 0; i < set.length; i++) {\n    if (mark.eq(set[i])) { return set[i] }\n  }\n}\n\n// DOMOutputSpec:: interface\n// A description of a DOM structure. Can be either a string, which is\n// interpreted as a text node, a DOM node, which is interpreted as\n// itself, a `{dom: Node, contentDOM: ?Node}` object, or an array.\n//\n// An array describes a DOM element. The first value in the array\n// should be a stringthe name of the DOM element, optionally prefixed\n// by a namespace URL and a space. If the second element is plain\n// object, it is interpreted as a set of attributes for the element.\n// Any elements after that (including the 2nd if it's not an attribute\n// object) are interpreted as children of the DOM elements, and must\n// either be valid `DOMOutputSpec` values, or the number zero.\n//\n// The number zero (pronounced hole) is used to indicate the place\n// where a node's child nodes should be inserted. If it occurs in an\n// output spec, it should be the only child element in its parent\n// node.\n\n// ::- A DOM serializer knows how to convert ProseMirror nodes and\n// marks of various types to DOM nodes.\nvar DOMSerializer = function DOMSerializer(nodes, marks) {\n  // :: Object<(node: Node)  DOMOutputSpec>\n  // The node serialization functions.\n  this.nodes = nodes || {};\n  // :: Object<?(mark: Mark, inline: bool)  DOMOutputSpec>\n  // The mark serialization functions.\n  this.marks = marks || {};\n};\n\n// :: (Fragment, ?Object)  dom.DocumentFragment\n// Serialize the content of this fragment to a DOM fragment. When\n// not in the browser, the `document` option, containing a DOM\n// document, should be passed so that the serializer can create\n// nodes.\nDOMSerializer.prototype.serializeFragment = function serializeFragment (fragment, options, target) {\n    var this$1 = this;\n    if ( options === void 0 ) options = {};\n\n  if (!target) { target = doc(options).createDocumentFragment(); }\n\n  var top = target, active = null;\n  fragment.forEach(function (node) {\n    if (active || node.marks.length) {\n      if (!active) { active = []; }\n      var keep = 0, rendered = 0;\n      while (keep < active.length && rendered < node.marks.length) {\n        var next = node.marks[rendered];\n        if (!this$1.marks[next.type.name]) { rendered++; continue }\n        if (!next.eq(active[keep]) || next.type.spec.spanning === false) { break }\n        keep += 2; rendered++;\n      }\n      while (keep < active.length) {\n        top = active.pop();\n        active.pop();\n      }\n      while (rendered < node.marks.length) {\n        var add = node.marks[rendered++];\n        var markDOM = this$1.serializeMark(add, node.isInline, options);\n        if (markDOM) {\n          active.push(add, top);\n          top.appendChild(markDOM.dom);\n          top = markDOM.contentDOM || markDOM.dom;\n        }\n      }\n    }\n    top.appendChild(this$1.serializeNode(node, options));\n  });\n\n  return target\n};\n\n// :: (Node, ?Object)  dom.Node\n// Serialize this node to a DOM node. This can be useful when you\n// need to serialize a part of a document, as opposed to the whole\n// document. To serialize a whole document, use\n// [`serializeFragment`](#model.DOMSerializer.serializeFragment) on\n// its [content](#model.Node.content).\nDOMSerializer.prototype.serializeNode = function serializeNode (node, options) {\n    if ( options === void 0 ) options = {};\n\n  var ref =\n      DOMSerializer.renderSpec(doc(options), this.nodes[node.type.name](node));\n    var dom = ref.dom;\n    var contentDOM = ref.contentDOM;\n  if (contentDOM) {\n    if (node.isLeaf)\n      { throw new RangeError(\"Content hole not allowed in a leaf node spec\") }\n    if (options.onContent)\n      { options.onContent(node, contentDOM, options); }\n    else\n      { this.serializeFragment(node.content, options, contentDOM); }\n  }\n  return dom\n};\n\nDOMSerializer.prototype.serializeNodeAndMarks = function serializeNodeAndMarks (node, options) {\n    if ( options === void 0 ) options = {};\n\n  var dom = this.serializeNode(node, options);\n  for (var i = node.marks.length - 1; i >= 0; i--) {\n    var wrap = this.serializeMark(node.marks[i], node.isInline, options);\n    if (wrap) {\n(wrap.contentDOM || wrap.dom).appendChild(dom);\n      dom = wrap.dom;\n    }\n  }\n  return dom\n};\n\nDOMSerializer.prototype.serializeMark = function serializeMark (mark, inline, options) {\n    if ( options === void 0 ) options = {};\n\n  var toDOM = this.marks[mark.type.name];\n  return toDOM && DOMSerializer.renderSpec(doc(options), toDOM(mark, inline))\n};\n\n// :: (dom.Document, DOMOutputSpec)  {dom: dom.Node, contentDOM: ?dom.Node}\n// Render an [output spec](#model.DOMOutputSpec) to a DOM node. If\n// the spec has a hole (zero) in it, `contentDOM` will point at the\n// node with the hole.\nDOMSerializer.renderSpec = function renderSpec (doc, structure, xmlNS) {\n    if ( xmlNS === void 0 ) xmlNS = null;\n\n  if (typeof structure == \"string\")\n    { return {dom: doc.createTextNode(structure)} }\n  if (structure.nodeType != null)\n    { return {dom: structure} }\n  if (structure.dom && structure.dom.nodeType != null)\n    { return structure }\n  var tagName = structure[0], space = tagName.indexOf(\" \");\n  if (space > 0) {\n    xmlNS = tagName.slice(0, space);\n    tagName = tagName.slice(space + 1);\n  }\n  var contentDOM = null, dom = xmlNS ? doc.createElementNS(xmlNS, tagName) : doc.createElement(tagName);\n  var attrs = structure[1], start = 1;\n  if (attrs && typeof attrs == \"object\" && attrs.nodeType == null && !Array.isArray(attrs)) {\n    start = 2;\n    for (var name in attrs) { if (attrs[name] != null) {\n      var space$1 = name.indexOf(\" \");\n      if (space$1 > 0) { dom.setAttributeNS(name.slice(0, space$1), name.slice(space$1 + 1), attrs[name]); }\n      else { dom.setAttribute(name, attrs[name]); }\n    } }\n  }\n  for (var i = start; i < structure.length; i++) {\n    var child = structure[i];\n    if (child === 0) {\n      if (i < structure.length - 1 || i > start)\n        { throw new RangeError(\"Content hole must be the only child of its parent node\") }\n      return {dom: dom, contentDOM: dom}\n    } else {\n      var ref = DOMSerializer.renderSpec(doc, child, xmlNS);\n        var inner = ref.dom;\n        var innerContent = ref.contentDOM;\n      dom.appendChild(inner);\n      if (innerContent) {\n        if (contentDOM) { throw new RangeError(\"Multiple content holes\") }\n        contentDOM = innerContent;\n      }\n    }\n  }\n  return {dom: dom, contentDOM: contentDOM}\n};\n\n// :: (Schema)  DOMSerializer\n// Build a serializer using the [`toDOM`](#model.NodeSpec.toDOM)\n// properties in a schema's node and mark specs.\nDOMSerializer.fromSchema = function fromSchema (schema) {\n  return schema.cached.domSerializer ||\n    (schema.cached.domSerializer = new DOMSerializer(this.nodesFromSchema(schema), this.marksFromSchema(schema)))\n};\n\n// : (Schema)  Object<(node: Node)  DOMOutputSpec>\n// Gather the serializers in a schema's node specs into an object.\n// This can be useful as a base to build a custom serializer from.\nDOMSerializer.nodesFromSchema = function nodesFromSchema (schema) {\n  var result = gatherToDOM(schema.nodes);\n  if (!result.text) { result.text = function (node) { return node.text; }; }\n  return result\n};\n\n// : (Schema)  Object<(mark: Mark)  DOMOutputSpec>\n// Gather the serializers in a schema's mark specs into an object.\nDOMSerializer.marksFromSchema = function marksFromSchema (schema) {\n  return gatherToDOM(schema.marks)\n};\n\nfunction gatherToDOM(obj) {\n  var result = {};\n  for (var name in obj) {\n    var toDOM = obj[name].spec.toDOM;\n    if (toDOM) { result[name] = toDOM; }\n  }\n  return result\n}\n\nfunction doc(options) {\n  // declare global: window\n  return options.document || window.document\n}\n\nexport { ContentMatch, DOMParser, DOMSerializer, Fragment, Mark, MarkType, Node, NodeRange, NodeType, ReplaceError, ResolvedPos, Schema, Slice };\n//# sourceMappingURL=index.es.js.map\n","import { Slice, Fragment, Mark, Node } from 'prosemirror-model';\nimport { ReplaceStep, ReplaceAroundStep, Transform } from 'prosemirror-transform';\n\nvar classesById = Object.create(null);\n\n// ::- Superclass for editor selections. Every selection type should\n// extend this. Should not be instantiated directly.\nvar Selection = function Selection($anchor, $head, ranges) {\n  // :: [SelectionRange]\n  // The ranges covered by the selection.\n  this.ranges = ranges || [new SelectionRange($anchor.min($head), $anchor.max($head))];\n  // :: ResolvedPos\n  // The resolved anchor of the selection (the side that stays in\n  // place when the selection is modified).\n  this.$anchor = $anchor;\n  // :: ResolvedPos\n  // The resolved head of the selection (the side that moves when\n  // the selection is modified).\n  this.$head = $head;\n};\n\nvar prototypeAccessors = { anchor: { configurable: true },head: { configurable: true },from: { configurable: true },to: { configurable: true },$from: { configurable: true },$to: { configurable: true },empty: { configurable: true } };\n\n// :: number\n// The selection's anchor, as an unresolved position.\nprototypeAccessors.anchor.get = function () { return this.$anchor.pos };\n\n// :: number\n// The selection's head.\nprototypeAccessors.head.get = function () { return this.$head.pos };\n\n// :: number\n// The lower bound of the selection's main range.\nprototypeAccessors.from.get = function () { return this.$from.pos };\n\n// :: number\n// The upper bound of the selection's main range.\nprototypeAccessors.to.get = function () { return this.$to.pos };\n\n// :: ResolvedPos\n// The resolved lowerbound of the selection's main range.\nprototypeAccessors.$from.get = function () {\n  return this.ranges[0].$from\n};\n\n// :: ResolvedPos\n// The resolved upper bound of the selection's main range.\nprototypeAccessors.$to.get = function () {\n  return this.ranges[0].$to\n};\n\n// :: bool\n// Indicates whether the selection contains any content.\nprototypeAccessors.empty.get = function () {\n  var ranges = this.ranges;\n  for (var i = 0; i < ranges.length; i++)\n    { if (ranges[i].$from.pos != ranges[i].$to.pos) { return false } }\n  return true\n};\n\n// eq:: (Selection)  bool\n// Test whether the selection is the same as another selection.\n\n// map:: (doc: Node, mapping: Mappable)  Selection\n// Map this selection through a [mappable](#transform.Mappable) thing. `doc`\n// should be the new document to which we are mapping.\n\n// :: ()  Slice\n// Get the content of this selection as a slice.\nSelection.prototype.content = function content () {\n  return this.$from.node(0).slice(this.from, this.to, true)\n};\n\n// :: (Transaction, ?Slice)\n// Replace the selection with a slice or, if no slice is given,\n// delete the selection. Will append to the given transaction.\nSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n  // Put the new selection at the position after the inserted\n  // content. When that ended in an inline node, search backwards,\n  // to get the position after that node. If not, search forward.\n  var lastNode = content.content.lastChild, lastParent = null;\n  for (var i = 0; i < content.openEnd; i++) {\n    lastParent = lastNode;\n    lastNode = lastNode.lastChild;\n  }\n\n  var mapFrom = tr.steps.length, ranges = this.ranges;\n  for (var i$1 = 0; i$1 < ranges.length; i$1++) {\n    var ref = ranges[i$1];\n      var $from = ref.$from;\n      var $to = ref.$to;\n      var mapping = tr.mapping.slice(mapFrom);\n    tr.replaceRange(mapping.map($from.pos), mapping.map($to.pos), i$1 ? Slice.empty : content);\n    if (i$1 == 0)\n      { selectionToInsertionEnd(tr, mapFrom, (lastNode ? lastNode.isInline : lastParent && lastParent.isTextblock) ? -1 : 1); }\n  }\n};\n\n// :: (Transaction, Node)\n// Replace the selection with the given node, appending the changes\n// to the given transaction.\nSelection.prototype.replaceWith = function replaceWith (tr, node) {\n  var mapFrom = tr.steps.length, ranges = this.ranges;\n  for (var i = 0; i < ranges.length; i++) {\n    var ref = ranges[i];\n      var $from = ref.$from;\n      var $to = ref.$to;\n      var mapping = tr.mapping.slice(mapFrom);\n    var from = mapping.map($from.pos), to = mapping.map($to.pos);\n    if (i) {\n      tr.deleteRange(from, to);\n    } else {\n      tr.replaceRangeWith(from, to, node);\n      selectionToInsertionEnd(tr, mapFrom, node.isInline ? -1 : 1);\n    }\n  }\n};\n\n// toJSON:: ()  Object\n// Convert the selection to a JSON representation. When implementing\n// this for a custom selection class, make sure to give the object a\n// `type` property whose value matches the ID under which you\n// [registered](#state.Selection^jsonID) your class.\n\n// :: (ResolvedPos, number, ?bool)  ?Selection\n// Find a valid cursor or leaf node selection starting at the given\n// position and searching back if `dir` is negative, and forward if\n// positive. When `textOnly` is true, only consider cursor\n// selections. Will return null when no valid selection position is\n// found.\nSelection.findFrom = function findFrom ($pos, dir, textOnly) {\n  var inner = $pos.parent.inlineContent ? new TextSelection($pos)\n      : findSelectionIn($pos.node(0), $pos.parent, $pos.pos, $pos.index(), dir, textOnly);\n  if (inner) { return inner }\n\n  for (var depth = $pos.depth - 1; depth >= 0; depth--) {\n    var found = dir < 0\n        ? findSelectionIn($pos.node(0), $pos.node(depth), $pos.before(depth + 1), $pos.index(depth), dir, textOnly)\n        : findSelectionIn($pos.node(0), $pos.node(depth), $pos.after(depth + 1), $pos.index(depth) + 1, dir, textOnly);\n    if (found) { return found }\n  }\n};\n\n// :: (ResolvedPos, ?number)  Selection\n// Find a valid cursor or leaf node selection near the given\n// position. Searches forward first by default, but if `bias` is\n// negative, it will search backwards first.\nSelection.near = function near ($pos, bias) {\n    if ( bias === void 0 ) bias = 1;\n\n  return this.findFrom($pos, bias) || this.findFrom($pos, -bias) || new AllSelection($pos.node(0))\n};\n\n// :: (Node)  Selection\n// Find the cursor or leaf node selection closest to the start of\n// the given document. Will return an\n// [`AllSelection`](#state.AllSelection) if no valid position\n// exists.\nSelection.atStart = function atStart (doc) {\n  return findSelectionIn(doc, doc, 0, 0, 1) || new AllSelection(doc)\n};\n\n// :: (Node)  Selection\n// Find the cursor or leaf node selection closest to the end of the\n// given document.\nSelection.atEnd = function atEnd (doc) {\n  return findSelectionIn(doc, doc, doc.content.size, doc.childCount, -1) || new AllSelection(doc)\n};\n\n// :: (Node, Object)  Selection\n// Deserialize the JSON representation of a selection. Must be\n// implemented for custom classes (as a static class method).\nSelection.fromJSON = function fromJSON (doc, json) {\n  if (!json || !json.type) { throw new RangeError(\"Invalid input for Selection.fromJSON\") }\n  var cls = classesById[json.type];\n  if (!cls) { throw new RangeError((\"No selection type \" + (json.type) + \" defined\")) }\n  return cls.fromJSON(doc, json)\n};\n\n// :: (string, constructor<Selection>)\n// To be able to deserialize selections from JSON, custom selection\n// classes must register themselves with an ID string, so that they\n// can be disambiguated. Try to pick something that's unlikely to\n// clash with classes from other modules.\nSelection.jsonID = function jsonID (id, selectionClass) {\n  if (id in classesById) { throw new RangeError(\"Duplicate use of selection JSON ID \" + id) }\n  classesById[id] = selectionClass;\n  selectionClass.prototype.jsonID = id;\n  return selectionClass\n};\n\n// :: ()  SelectionBookmark\n// Get a [bookmark](#state.SelectionBookmark) for this selection,\n// which is a value that can be mapped without having access to a\n// current document, and later resolved to a real selection for a\n// given document again. (This is used mostly by the history to\n// track and restore old selections.) The default implementation of\n// this method just converts the selection to a text selection and\n// returns the bookmark for that.\nSelection.prototype.getBookmark = function getBookmark () {\n  return TextSelection.between(this.$anchor, this.$head).getBookmark()\n};\n\nObject.defineProperties( Selection.prototype, prototypeAccessors );\n\n// :: bool\n// Controls whether, when a selection of this type is active in the\n// browser, the selected range should be visible to the user. Defaults\n// to `true`.\nSelection.prototype.visible = true;\n\n// SelectionBookmark:: interface\n// A lightweight, document-independent representation of a selection.\n// You can define a custom bookmark type for a custom selection class\n// to make the history handle it well.\n//\n//   map:: (mapping: Mapping)  SelectionBookmark\n//   Map the bookmark through a set of changes.\n//\n//   resolve:: (doc: Node)  Selection\n//   Resolve the bookmark to a real selection again. This may need to\n//   do some error checking and may fall back to a default (usually\n//   [`TextSelection.between`](#state.TextSelection^between)) if\n//   mapping made the bookmark invalid.\n\n// ::- Represents a selected range in a document.\nvar SelectionRange = function SelectionRange($from, $to) {\n  // :: ResolvedPos\n  // The lower bound of the range.\n  this.$from = $from;\n  // :: ResolvedPos\n  // The upper bound of the range.\n  this.$to = $to;\n};\n\n// ::- A text selection represents a classical editor selection, with\n// a head (the moving side) and anchor (immobile side), both of which\n// point into textblock nodes. It can be empty (a regular cursor\n// position).\nvar TextSelection = /*@__PURE__*/(function (Selection) {\n  function TextSelection($anchor, $head) {\n    if ( $head === void 0 ) $head = $anchor;\n\n    Selection.call(this, $anchor, $head);\n  }\n\n  if ( Selection ) TextSelection.__proto__ = Selection;\n  TextSelection.prototype = Object.create( Selection && Selection.prototype );\n  TextSelection.prototype.constructor = TextSelection;\n\n  var prototypeAccessors$1 = { $cursor: { configurable: true } };\n\n  // :: ?ResolvedPos\n  // Returns a resolved position if this is a cursor selection (an\n  // empty text selection), and null otherwise.\n  prototypeAccessors$1.$cursor.get = function () { return this.$anchor.pos == this.$head.pos ? this.$head : null };\n\n  TextSelection.prototype.map = function map (doc, mapping) {\n    var $head = doc.resolve(mapping.map(this.head));\n    if (!$head.parent.inlineContent) { return Selection.near($head) }\n    var $anchor = doc.resolve(mapping.map(this.anchor));\n    return new TextSelection($anchor.parent.inlineContent ? $anchor : $head, $head)\n  };\n\n  TextSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n    Selection.prototype.replace.call(this, tr, content);\n    if (content == Slice.empty) {\n      var marks = this.$from.marksAcross(this.$to);\n      if (marks) { tr.ensureMarks(marks); }\n    }\n  };\n\n  TextSelection.prototype.eq = function eq (other) {\n    return other instanceof TextSelection && other.anchor == this.anchor && other.head == this.head\n  };\n\n  TextSelection.prototype.getBookmark = function getBookmark () {\n    return new TextBookmark(this.anchor, this.head)\n  };\n\n  TextSelection.prototype.toJSON = function toJSON () {\n    return {type: \"text\", anchor: this.anchor, head: this.head}\n  };\n\n  TextSelection.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.anchor != \"number\" || typeof json.head != \"number\")\n      { throw new RangeError(\"Invalid input for TextSelection.fromJSON\") }\n    return new TextSelection(doc.resolve(json.anchor), doc.resolve(json.head))\n  };\n\n  // :: (Node, number, ?number)  TextSelection\n  // Create a text selection from non-resolved positions.\n  TextSelection.create = function create (doc, anchor, head) {\n    if ( head === void 0 ) head = anchor;\n\n    var $anchor = doc.resolve(anchor);\n    return new this($anchor, head == anchor ? $anchor : doc.resolve(head))\n  };\n\n  // :: (ResolvedPos, ResolvedPos, ?number)  Selection\n  // Return a text selection that spans the given positions or, if\n  // they aren't text positions, find a text selection near them.\n  // `bias` determines whether the method searches forward (default)\n  // or backwards (negative number) first. Will fall back to calling\n  // [`Selection.near`](#state.Selection^near) when the document\n  // doesn't contain a valid text position.\n  TextSelection.between = function between ($anchor, $head, bias) {\n    var dPos = $anchor.pos - $head.pos;\n    if (!bias || dPos) { bias = dPos >= 0 ? 1 : -1; }\n    if (!$head.parent.inlineContent) {\n      var found = Selection.findFrom($head, bias, true) || Selection.findFrom($head, -bias, true);\n      if (found) { $head = found.$head; }\n      else { return Selection.near($head, bias) }\n    }\n    if (!$anchor.parent.inlineContent) {\n      if (dPos == 0) {\n        $anchor = $head;\n      } else {\n        $anchor = (Selection.findFrom($anchor, -bias, true) || Selection.findFrom($anchor, bias, true)).$anchor;\n        if (($anchor.pos < $head.pos) != (dPos < 0)) { $anchor = $head; }\n      }\n    }\n    return new TextSelection($anchor, $head)\n  };\n\n  Object.defineProperties( TextSelection.prototype, prototypeAccessors$1 );\n\n  return TextSelection;\n}(Selection));\n\nSelection.jsonID(\"text\", TextSelection);\n\nvar TextBookmark = function TextBookmark(anchor, head) {\n  this.anchor = anchor;\n  this.head = head;\n};\nTextBookmark.prototype.map = function map (mapping) {\n  return new TextBookmark(mapping.map(this.anchor), mapping.map(this.head))\n};\nTextBookmark.prototype.resolve = function resolve (doc) {\n  return TextSelection.between(doc.resolve(this.anchor), doc.resolve(this.head))\n};\n\n// ::- A node selection is a selection that points at a single node.\n// All nodes marked [selectable](#model.NodeSpec.selectable) can be\n// the target of a node selection. In such a selection, `from` and\n// `to` point directly before and after the selected node, `anchor`\n// equals `from`, and `head` equals `to`..\nvar NodeSelection = /*@__PURE__*/(function (Selection) {\n  function NodeSelection($pos) {\n    var node = $pos.nodeAfter;\n    var $end = $pos.node(0).resolve($pos.pos + node.nodeSize);\n    Selection.call(this, $pos, $end);\n    // :: Node The selected node.\n    this.node = node;\n  }\n\n  if ( Selection ) NodeSelection.__proto__ = Selection;\n  NodeSelection.prototype = Object.create( Selection && Selection.prototype );\n  NodeSelection.prototype.constructor = NodeSelection;\n\n  NodeSelection.prototype.map = function map (doc, mapping) {\n    var ref = mapping.mapResult(this.anchor);\n    var deleted = ref.deleted;\n    var pos = ref.pos;\n    var $pos = doc.resolve(pos);\n    if (deleted) { return Selection.near($pos) }\n    return new NodeSelection($pos)\n  };\n\n  NodeSelection.prototype.content = function content () {\n    return new Slice(Fragment.from(this.node), 0, 0)\n  };\n\n  NodeSelection.prototype.eq = function eq (other) {\n    return other instanceof NodeSelection && other.anchor == this.anchor\n  };\n\n  NodeSelection.prototype.toJSON = function toJSON () {\n    return {type: \"node\", anchor: this.anchor}\n  };\n\n  NodeSelection.prototype.getBookmark = function getBookmark () { return new NodeBookmark(this.anchor) };\n\n  NodeSelection.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.anchor != \"number\")\n      { throw new RangeError(\"Invalid input for NodeSelection.fromJSON\") }\n    return new NodeSelection(doc.resolve(json.anchor))\n  };\n\n  // :: (Node, number)  NodeSelection\n  // Create a node selection from non-resolved positions.\n  NodeSelection.create = function create (doc, from) {\n    return new this(doc.resolve(from))\n  };\n\n  // :: (Node)  bool\n  // Determines whether the given node may be selected as a node\n  // selection.\n  NodeSelection.isSelectable = function isSelectable (node) {\n    return !node.isText && node.type.spec.selectable !== false\n  };\n\n  return NodeSelection;\n}(Selection));\n\nNodeSelection.prototype.visible = false;\n\nSelection.jsonID(\"node\", NodeSelection);\n\nvar NodeBookmark = function NodeBookmark(anchor) {\n  this.anchor = anchor;\n};\nNodeBookmark.prototype.map = function map (mapping) {\n  var ref = mapping.mapResult(this.anchor);\n    var deleted = ref.deleted;\n    var pos = ref.pos;\n  return deleted ? new TextBookmark(pos, pos) : new NodeBookmark(pos)\n};\nNodeBookmark.prototype.resolve = function resolve (doc) {\n  var $pos = doc.resolve(this.anchor), node = $pos.nodeAfter;\n  if (node && NodeSelection.isSelectable(node)) { return new NodeSelection($pos) }\n  return Selection.near($pos)\n};\n\n// ::- A selection type that represents selecting the whole document\n// (which can not necessarily be expressed with a text selection, when\n// there are for example leaf block nodes at the start or end of the\n// document).\nvar AllSelection = /*@__PURE__*/(function (Selection) {\n  function AllSelection(doc) {\n    Selection.call(this, doc.resolve(0), doc.resolve(doc.content.size));\n  }\n\n  if ( Selection ) AllSelection.__proto__ = Selection;\n  AllSelection.prototype = Object.create( Selection && Selection.prototype );\n  AllSelection.prototype.constructor = AllSelection;\n\n  AllSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n    if (content == Slice.empty) {\n      tr.delete(0, tr.doc.content.size);\n      var sel = Selection.atStart(tr.doc);\n      if (!sel.eq(tr.selection)) { tr.setSelection(sel); }\n    } else {\n      Selection.prototype.replace.call(this, tr, content);\n    }\n  };\n\n  AllSelection.prototype.toJSON = function toJSON () { return {type: \"all\"} };\n\n  AllSelection.fromJSON = function fromJSON (doc) { return new AllSelection(doc) };\n\n  AllSelection.prototype.map = function map (doc) { return new AllSelection(doc) };\n\n  AllSelection.prototype.eq = function eq (other) { return other instanceof AllSelection };\n\n  AllSelection.prototype.getBookmark = function getBookmark () { return AllBookmark };\n\n  return AllSelection;\n}(Selection));\n\nSelection.jsonID(\"all\", AllSelection);\n\nvar AllBookmark = {\n  map: function map() { return this },\n  resolve: function resolve(doc) { return new AllSelection(doc) }\n};\n\n// FIXME we'll need some awareness of text direction when scanning for selections\n\n// Try to find a selection inside the given node. `pos` points at the\n// position where the search starts. When `text` is true, only return\n// text selections.\nfunction findSelectionIn(doc, node, pos, index, dir, text) {\n  if (node.inlineContent) { return TextSelection.create(doc, pos) }\n  for (var i = index - (dir > 0 ? 0 : 1); dir > 0 ? i < node.childCount : i >= 0; i += dir) {\n    var child = node.child(i);\n    if (!child.isAtom) {\n      var inner = findSelectionIn(doc, child, pos + dir, dir < 0 ? child.childCount : 0, dir, text);\n      if (inner) { return inner }\n    } else if (!text && NodeSelection.isSelectable(child)) {\n      return NodeSelection.create(doc, pos - (dir < 0 ? child.nodeSize : 0))\n    }\n    pos += child.nodeSize * dir;\n  }\n}\n\nfunction selectionToInsertionEnd(tr, startLen, bias) {\n  var last = tr.steps.length - 1;\n  if (last < startLen) { return }\n  var step = tr.steps[last];\n  if (!(step instanceof ReplaceStep || step instanceof ReplaceAroundStep)) { return }\n  var map = tr.mapping.maps[last], end;\n  map.forEach(function (_from, _to, _newFrom, newTo) { if (end == null) { end = newTo; } });\n  tr.setSelection(Selection.near(tr.doc.resolve(end), bias));\n}\n\nvar UPDATED_SEL = 1, UPDATED_MARKS = 2, UPDATED_SCROLL = 4;\n\n// ::- An editor state transaction, which can be applied to a state to\n// create an updated state. Use\n// [`EditorState.tr`](#state.EditorState.tr) to create an instance.\n//\n// Transactions track changes to the document (they are a subclass of\n// [`Transform`](#transform.Transform)), but also other state changes,\n// like selection updates and adjustments of the set of [stored\n// marks](#state.EditorState.storedMarks). In addition, you can store\n// metadata properties in a transaction, which are extra pieces of\n// information that client code or plugins can use to describe what a\n// transacion represents, so that they can update their [own\n// state](#state.StateField) accordingly.\n//\n// The [editor view](#view.EditorView) uses a few metadata properties:\n// it will attach a property `\"pointer\"` with the value `true` to\n// selection transactions directly caused by mouse or touch input, and\n// a `\"uiEvent\"` property of that may be `\"paste\"`, `\"cut\"`, or `\"drop\"`.\nvar Transaction = /*@__PURE__*/(function (Transform) {\n  function Transaction(state) {\n    Transform.call(this, state.doc);\n    // :: number\n    // The timestamp associated with this transaction, in the same\n    // format as `Date.now()`.\n    this.time = Date.now();\n    this.curSelection = state.selection;\n    // The step count for which the current selection is valid.\n    this.curSelectionFor = 0;\n    // :: ?[Mark]\n    // The stored marks set by this transaction, if any.\n    this.storedMarks = state.storedMarks;\n    // Bitfield to track which aspects of the state were updated by\n    // this transaction.\n    this.updated = 0;\n    // Object used to store metadata properties for the transaction.\n    this.meta = Object.create(null);\n  }\n\n  if ( Transform ) Transaction.__proto__ = Transform;\n  Transaction.prototype = Object.create( Transform && Transform.prototype );\n  Transaction.prototype.constructor = Transaction;\n\n  var prototypeAccessors = { selection: { configurable: true },selectionSet: { configurable: true },storedMarksSet: { configurable: true },isGeneric: { configurable: true },scrolledIntoView: { configurable: true } };\n\n  // :: Selection\n  // The transaction's current selection. This defaults to the editor\n  // selection [mapped](#state.Selection.map) through the steps in the\n  // transaction, but can be overwritten with\n  // [`setSelection`](#state.Transaction.setSelection).\n  prototypeAccessors.selection.get = function () {\n    if (this.curSelectionFor < this.steps.length) {\n      this.curSelection = this.curSelection.map(this.doc, this.mapping.slice(this.curSelectionFor));\n      this.curSelectionFor = this.steps.length;\n    }\n    return this.curSelection\n  };\n\n  // :: (Selection)  Transaction\n  // Update the transaction's current selection. Will determine the\n  // selection that the editor gets when the transaction is applied.\n  Transaction.prototype.setSelection = function setSelection (selection) {\n    if (selection.$from.doc != this.doc)\n      { throw new RangeError(\"Selection passed to setSelection must point at the current document\") }\n    this.curSelection = selection;\n    this.curSelectionFor = this.steps.length;\n    this.updated = (this.updated | UPDATED_SEL) & ~UPDATED_MARKS;\n    this.storedMarks = null;\n    return this\n  };\n\n  // :: bool\n  // Whether the selection was explicitly updated by this transaction.\n  prototypeAccessors.selectionSet.get = function () {\n    return (this.updated & UPDATED_SEL) > 0\n  };\n\n  // :: (?[Mark])  Transaction\n  // Set the current stored marks.\n  Transaction.prototype.setStoredMarks = function setStoredMarks (marks) {\n    this.storedMarks = marks;\n    this.updated |= UPDATED_MARKS;\n    return this\n  };\n\n  // :: ([Mark])  Transaction\n  // Make sure the current stored marks or, if that is null, the marks\n  // at the selection, match the given set of marks. Does nothing if\n  // this is already the case.\n  Transaction.prototype.ensureMarks = function ensureMarks (marks) {\n    if (!Mark.sameSet(this.storedMarks || this.selection.$from.marks(), marks))\n      { this.setStoredMarks(marks); }\n    return this\n  };\n\n  // :: (Mark)  Transaction\n  // Add a mark to the set of stored marks.\n  Transaction.prototype.addStoredMark = function addStoredMark (mark) {\n    return this.ensureMarks(mark.addToSet(this.storedMarks || this.selection.$head.marks()))\n  };\n\n  // :: (union<Mark, MarkType>)  Transaction\n  // Remove a mark or mark type from the set of stored marks.\n  Transaction.prototype.removeStoredMark = function removeStoredMark (mark) {\n    return this.ensureMarks(mark.removeFromSet(this.storedMarks || this.selection.$head.marks()))\n  };\n\n  // :: bool\n  // Whether the stored marks were explicitly set for this transaction.\n  prototypeAccessors.storedMarksSet.get = function () {\n    return (this.updated & UPDATED_MARKS) > 0\n  };\n\n  Transaction.prototype.addStep = function addStep (step, doc) {\n    Transform.prototype.addStep.call(this, step, doc);\n    this.updated = this.updated & ~UPDATED_MARKS;\n    this.storedMarks = null;\n  };\n\n  // :: (number)  Transaction\n  // Update the timestamp for the transaction.\n  Transaction.prototype.setTime = function setTime (time) {\n    this.time = time;\n    return this\n  };\n\n  // :: (Slice)  Transaction\n  // Replace the current selection with the given slice.\n  Transaction.prototype.replaceSelection = function replaceSelection (slice) {\n    this.selection.replace(this, slice);\n    return this\n  };\n\n  // :: (Node, ?bool)  Transaction\n  // Replace the selection with the given node. When `inheritMarks` is\n  // true and the content is inline, it inherits the marks from the\n  // place where it is inserted.\n  Transaction.prototype.replaceSelectionWith = function replaceSelectionWith (node, inheritMarks) {\n    var selection = this.selection;\n    if (inheritMarks !== false)\n      { node = node.mark(this.storedMarks || (selection.empty ? selection.$from.marks() : (selection.$from.marksAcross(selection.$to) || Mark.none))); }\n    selection.replaceWith(this, node);\n    return this\n  };\n\n  // :: ()  Transaction\n  // Delete the selection.\n  Transaction.prototype.deleteSelection = function deleteSelection () {\n    this.selection.replace(this);\n    return this\n  };\n\n  // :: (string, from: ?number, to: ?number)  Transaction\n  // Replace the given range, or the selection if no range is given,\n  // with a text node containing the given string.\n  Transaction.prototype.insertText = function insertText (text, from, to) {\n    if ( to === void 0 ) to = from;\n\n    var schema = this.doc.type.schema;\n    if (from == null) {\n      if (!text) { return this.deleteSelection() }\n      return this.replaceSelectionWith(schema.text(text), true)\n    } else {\n      if (!text) { return this.deleteRange(from, to) }\n      var marks = this.storedMarks;\n      if (!marks) {\n        var $from = this.doc.resolve(from);\n        marks = to == from ? $from.marks() : $from.marksAcross(this.doc.resolve(to));\n      }\n      this.replaceRangeWith(from, to, schema.text(text, marks));\n      if (!this.selection.empty) { this.setSelection(Selection.near(this.selection.$to)); }\n      return this\n    }\n  };\n\n  // :: (union<string, Plugin, PluginKey>, any)  Transaction\n  // Store a metadata property in this transaction, keyed either by\n  // name or by plugin.\n  Transaction.prototype.setMeta = function setMeta (key, value) {\n    this.meta[typeof key == \"string\" ? key : key.key] = value;\n    return this\n  };\n\n  // :: (union<string, Plugin, PluginKey>)  any\n  // Retrieve a metadata property for a given name or plugin.\n  Transaction.prototype.getMeta = function getMeta (key) {\n    return this.meta[typeof key == \"string\" ? key : key.key]\n  };\n\n  // :: bool\n  // Returns true if this transaction doesn't contain any metadata,\n  // and can thus safely be extended.\n  prototypeAccessors.isGeneric.get = function () {\n    for (var _ in this.meta) { return false }\n    return true\n  };\n\n  // :: ()  Transaction\n  // Indicate that the editor should scroll the selection into view\n  // when updated to the state produced by this transaction.\n  Transaction.prototype.scrollIntoView = function scrollIntoView () {\n    this.updated |= UPDATED_SCROLL;\n    return this\n  };\n\n  prototypeAccessors.scrolledIntoView.get = function () {\n    return (this.updated & UPDATED_SCROLL) > 0\n  };\n\n  Object.defineProperties( Transaction.prototype, prototypeAccessors );\n\n  return Transaction;\n}(Transform));\n\nfunction bind(f, self) {\n  return !self || !f ? f : f.bind(self)\n}\n\nvar FieldDesc = function FieldDesc(name, desc, self) {\n  this.name = name;\n  this.init = bind(desc.init, self);\n  this.apply = bind(desc.apply, self);\n};\n\nvar baseFields = [\n  new FieldDesc(\"doc\", {\n    init: function init(config) { return config.doc || config.schema.topNodeType.createAndFill() },\n    apply: function apply(tr) { return tr.doc }\n  }),\n\n  new FieldDesc(\"selection\", {\n    init: function init(config, instance) { return config.selection || Selection.atStart(instance.doc) },\n    apply: function apply(tr) { return tr.selection }\n  }),\n\n  new FieldDesc(\"storedMarks\", {\n    init: function init(config) { return config.storedMarks || null },\n    apply: function apply(tr, _marks, _old, state) { return state.selection.$cursor ? tr.storedMarks : null }\n  }),\n\n  new FieldDesc(\"scrollToSelection\", {\n    init: function init() { return 0 },\n    apply: function apply(tr, prev) { return tr.scrolledIntoView ? prev + 1 : prev }\n  })\n];\n\n// Object wrapping the part of a state object that stays the same\n// across transactions. Stored in the state's `config` property.\nvar Configuration = function Configuration(schema, plugins) {\n  var this$1 = this;\n\n  this.schema = schema;\n  this.fields = baseFields.concat();\n  this.plugins = [];\n  this.pluginsByKey = Object.create(null);\n  if (plugins) { plugins.forEach(function (plugin) {\n    if (this$1.pluginsByKey[plugin.key])\n      { throw new RangeError(\"Adding different instances of a keyed plugin (\" + plugin.key + \")\") }\n    this$1.plugins.push(plugin);\n    this$1.pluginsByKey[plugin.key] = plugin;\n    if (plugin.spec.state)\n      { this$1.fields.push(new FieldDesc(plugin.key, plugin.spec.state, plugin)); }\n  }); }\n};\n\n// ::- The state of a ProseMirror editor is represented by an object\n// of this type. A state is a persistent data structureit isn't\n// updated, but rather a new state value is computed from an old one\n// using the [`apply`](#state.EditorState.apply) method.\n//\n// A state holds a number of built-in fields, and plugins can\n// [define](#state.PluginSpec.state) additional fields.\nvar EditorState = function EditorState(config) {\n  this.config = config;\n};\n\nvar prototypeAccessors$1 = { schema: { configurable: true },plugins: { configurable: true },tr: { configurable: true } };\n\n// doc:: Node\n// The current document.\n\n// selection:: Selection\n// The selection.\n\n// storedMarks:: ?[Mark]\n// A set of marks to apply to the next input. Will be null when\n// no explicit marks have been set.\n\n// :: Schema\n// The schema of the state's document.\nprototypeAccessors$1.schema.get = function () {\n  return this.config.schema\n};\n\n// :: [Plugin]\n// The plugins that are active in this state.\nprototypeAccessors$1.plugins.get = function () {\n  return this.config.plugins\n};\n\n// :: (Transaction)  EditorState\n// Apply the given transaction to produce a new state.\nEditorState.prototype.apply = function apply (tr) {\n  return this.applyTransaction(tr).state\n};\n\n// : (Transaction)  bool\nEditorState.prototype.filterTransaction = function filterTransaction (tr, ignore) {\n    if ( ignore === void 0 ) ignore = -1;\n\n  for (var i = 0; i < this.config.plugins.length; i++) { if (i != ignore) {\n    var plugin = this.config.plugins[i];\n    if (plugin.spec.filterTransaction && !plugin.spec.filterTransaction.call(plugin, tr, this))\n      { return false }\n  } }\n  return true\n};\n\n// :: (Transaction)  {state: EditorState, transactions: [Transaction]}\n// Verbose variant of [`apply`](#state.EditorState.apply) that\n// returns the precise transactions that were applied (which might\n// be influenced by the [transaction\n// hooks](#state.PluginSpec.filterTransaction) of\n// plugins) along with the new state.\nEditorState.prototype.applyTransaction = function applyTransaction (rootTr) {\n  if (!this.filterTransaction(rootTr)) { return {state: this, transactions: []} }\n\n  var trs = [rootTr], newState = this.applyInner(rootTr), seen = null;\n  // This loop repeatedly gives plugins a chance to respond to\n  // transactions as new transactions are added, making sure to only\n  // pass the transactions the plugin did not see before.\n   for (;;) {\n    var haveNew = false;\n    for (var i = 0; i < this.config.plugins.length; i++) {\n      var plugin = this.config.plugins[i];\n      if (plugin.spec.appendTransaction) {\n        var n = seen ? seen[i].n : 0, oldState = seen ? seen[i].state : this;\n        var tr = n < trs.length &&\n            plugin.spec.appendTransaction.call(plugin, n ? trs.slice(n) : trs, oldState, newState);\n        if (tr && newState.filterTransaction(tr, i)) {\n          tr.setMeta(\"appendedTransaction\", rootTr);\n          if (!seen) {\n            seen = [];\n            for (var j = 0; j < this.config.plugins.length; j++)\n              { seen.push(j < i ? {state: newState, n: trs.length} : {state: this, n: 0}); }\n          }\n          trs.push(tr);\n          newState = newState.applyInner(tr);\n          haveNew = true;\n        }\n        if (seen) { seen[i] = {state: newState, n: trs.length}; }\n      }\n    }\n    if (!haveNew) { return {state: newState, transactions: trs} }\n  }\n};\n\n// : (Transaction)  EditorState\nEditorState.prototype.applyInner = function applyInner (tr) {\n  if (!tr.before.eq(this.doc)) { throw new RangeError(\"Applying a mismatched transaction\") }\n  var newInstance = new EditorState(this.config), fields = this.config.fields;\n  for (var i = 0; i < fields.length; i++) {\n    var field = fields[i];\n    newInstance[field.name] = field.apply(tr, this[field.name], this, newInstance);\n  }\n  for (var i$1 = 0; i$1 < applyListeners.length; i$1++) { applyListeners[i$1](this, tr, newInstance); }\n  return newInstance\n};\n\n// :: Transaction\n// Start a [transaction](#state.Transaction) from this state.\nprototypeAccessors$1.tr.get = function () { return new Transaction(this) };\n\n// :: (Object)  EditorState\n// Create a new state.\n//\n// config::- Configuration options. Must contain `schema` or `doc` (or both).\n//\n//    schema:: ?Schema\n//    The schema to use (only relevant if no `doc` is specified).\n//\n//    doc:: ?Node\n//    The starting document.\n//\n//    selection:: ?Selection\n//    A valid selection in the document.\n//\n//    storedMarks:: ?[Mark]\n//    The initial set of [stored marks](#state.EditorState.storedMarks).\n//\n//    plugins:: ?[Plugin]\n//    The plugins that should be active in this state.\nEditorState.create = function create (config) {\n  var $config = new Configuration(config.doc ? config.doc.type.schema : config.schema, config.plugins);\n  var instance = new EditorState($config);\n  for (var i = 0; i < $config.fields.length; i++)\n    { instance[$config.fields[i].name] = $config.fields[i].init(config, instance); }\n  return instance\n};\n\n// :: (Object)  EditorState\n// Create a new state based on this one, but with an adjusted set of\n// active plugins. State fields that exist in both sets of plugins\n// are kept unchanged. Those that no longer exist are dropped, and\n// those that are new are initialized using their\n// [`init`](#state.StateField.init) method, passing in the new\n// configuration object..\n//\n// config::- configuration options\n//\n//   plugins:: [Plugin]\n//   New set of active plugins.\nEditorState.prototype.reconfigure = function reconfigure (config) {\n  var $config = new Configuration(this.schema, config.plugins);\n  var fields = $config.fields, instance = new EditorState($config);\n  for (var i = 0; i < fields.length; i++) {\n    var name = fields[i].name;\n    instance[name] = this.hasOwnProperty(name) ? this[name] : fields[i].init(config, instance);\n  }\n  return instance\n};\n\n// :: (?union<Object<Plugin>, string, number>)  Object\n// Serialize this state to JSON. If you want to serialize the state\n// of plugins, pass an object mapping property names to use in the\n// resulting JSON object to plugin objects. The argument may also be\n// a string or number, in which case it is ignored, to support the\n// way `JSON.stringify` calls `toString` methods.\nEditorState.prototype.toJSON = function toJSON (pluginFields) {\n  var result = {doc: this.doc.toJSON(), selection: this.selection.toJSON()};\n  if (this.storedMarks) { result.storedMarks = this.storedMarks.map(function (m) { return m.toJSON(); }); }\n  if (pluginFields && typeof pluginFields == 'object') { for (var prop in pluginFields) {\n    if (prop == \"doc\" || prop == \"selection\")\n      { throw new RangeError(\"The JSON fields `doc` and `selection` are reserved\") }\n    var plugin = pluginFields[prop], state = plugin.spec.state;\n    if (state && state.toJSON) { result[prop] = state.toJSON.call(plugin, this[plugin.key]); }\n  } }\n  return result\n};\n\n// :: (Object, Object, ?Object<Plugin>)  EditorState\n// Deserialize a JSON representation of a state. `config` should\n// have at least a `schema` field, and should contain array of\n// plugins to initialize the state with. `pluginFields` can be used\n// to deserialize the state of plugins, by associating plugin\n// instances with the property names they use in the JSON object.\n//\n// config::- configuration options\n//\n//   schema:: Schema\n//   The schema to use.\n//\n//   plugins:: ?[Plugin]\n//   The set of active plugins.\nEditorState.fromJSON = function fromJSON (config, json, pluginFields) {\n  if (!json) { throw new RangeError(\"Invalid input for EditorState.fromJSON\") }\n  if (!config.schema) { throw new RangeError(\"Required config field 'schema' missing\") }\n  var $config = new Configuration(config.schema, config.plugins);\n  var instance = new EditorState($config);\n  $config.fields.forEach(function (field) {\n    if (field.name == \"doc\") {\n      instance.doc = Node.fromJSON(config.schema, json.doc);\n    } else if (field.name == \"selection\") {\n      instance.selection = Selection.fromJSON(instance.doc, json.selection);\n    } else if (field.name == \"storedMarks\") {\n      if (json.storedMarks) { instance.storedMarks = json.storedMarks.map(config.schema.markFromJSON); }\n    } else {\n      if (pluginFields) { for (var prop in pluginFields) {\n        var plugin = pluginFields[prop], state = plugin.spec.state;\n        if (plugin.key == field.name && state && state.fromJSON &&\n            Object.prototype.hasOwnProperty.call(json, prop)) {\n          // This field belongs to a plugin mapped to a JSON field, read it from there.\n          instance[field.name] = state.fromJSON.call(plugin, config, json[prop], instance);\n          return\n        }\n      } }\n      instance[field.name] = field.init(config, instance);\n    }\n  });\n  return instance\n};\n\n// Kludge to allow the view to track mappings between different\n// instances of a state.\n//\n// FIXME this is no longer needed as of prosemirror-view 1.9.0,\n// though due to backwards-compat we should probably keep it around\n// for a while (if only as a no-op)\nEditorState.addApplyListener = function addApplyListener (f) {\n  applyListeners.push(f);\n};\nEditorState.removeApplyListener = function removeApplyListener (f) {\n  var found = applyListeners.indexOf(f);\n  if (found > -1) { applyListeners.splice(found, 1); }\n};\n\nObject.defineProperties( EditorState.prototype, prototypeAccessors$1 );\n\nvar applyListeners = [];\n\n// PluginSpec:: interface\n//\n// This is the type passed to the [`Plugin`](#state.Plugin)\n// constructor. It provides a definition for a plugin.\n//\n//   props:: ?EditorProps\n//   The [view props](#view.EditorProps) added by this plugin. Props\n//   that are functions will be bound to have the plugin instance as\n//   their `this` binding.\n//\n//   state:: ?StateField<any>\n//   Allows a plugin to define a [state field](#state.StateField), an\n//   extra slot in the state object in which it can keep its own data.\n//\n//   key:: ?PluginKey\n//   Can be used to make this a keyed plugin. You can have only one\n//   plugin with a given key in a given state, but it is possible to\n//   access the plugin's configuration and state through the key,\n//   without having access to the plugin instance object.\n//\n//   view:: ?(EditorView)  Object\n//   When the plugin needs to interact with the editor view, or\n//   set something up in the DOM, use this field. The function\n//   will be called when the plugin's state is associated with an\n//   editor view.\n//\n//     return::-\n//     Should return an object with the following optional\n//     properties:\n//\n//       update:: ?(view: EditorView, prevState: EditorState)\n//       Called whenever the view's state is updated.\n//\n//       destroy:: ?()\n//       Called when the view is destroyed or receives a state\n//       with different plugins.\n//\n//   filterTransaction:: ?(Transaction, EditorState)  bool\n//   When present, this will be called before a transaction is\n//   applied by the state, allowing the plugin to cancel it (by\n//   returning false).\n//\n//   appendTransaction:: ?(transactions: [Transaction], oldState: EditorState, newState: EditorState)  ?Transaction\n//   Allows the plugin to append another transaction to be applied\n//   after the given array of transactions. When another plugin\n//   appends a transaction after this was called, it is called again\n//   with the new state and new transactionsbut only the new\n//   transactions, i.e. it won't be passed transactions that it\n//   already saw.\n\nfunction bindProps(obj, self, target) {\n  for (var prop in obj) {\n    var val = obj[prop];\n    if (val instanceof Function) { val = val.bind(self); }\n    else if (prop == \"handleDOMEvents\") { val = bindProps(val, self, {}); }\n    target[prop] = val;\n  }\n  return target\n}\n\n// ::- Plugins bundle functionality that can be added to an editor.\n// They are part of the [editor state](#state.EditorState) and\n// may influence that state and the view that contains it.\nvar Plugin = function Plugin(spec) {\n  // :: EditorProps\n  // The [props](#view.EditorProps) exported by this plugin.\n  this.props = {};\n  if (spec.props) { bindProps(spec.props, this, this.props); }\n  // :: Object\n  // The plugin's [spec object](#state.PluginSpec).\n  this.spec = spec;\n  this.key = spec.key ? spec.key.key : createKey(\"plugin\");\n};\n\n// :: (EditorState)  any\n// Extract the plugin's state field from an editor state.\nPlugin.prototype.getState = function getState (state) { return state[this.key] };\n\n// StateField:: interface<T>\n// A plugin spec may provide a state field (under its\n// [`state`](#state.PluginSpec.state) property) of this type, which\n// describes the state it wants to keep. Functions provided here are\n// always called with the plugin instance as their `this` binding.\n//\n//   init:: (config: Object, instance: EditorState)  T\n//   Initialize the value of the field. `config` will be the object\n//   passed to [`EditorState.create`](#state.EditorState^create). Note\n//   that `instance` is a half-initialized state instance, and will\n//   not have values for plugin fields initialized after this one.\n//\n//   apply:: (tr: Transaction, value: T, oldState: EditorState, newState: EditorState)  T\n//   Apply the given transaction to this state field, producing a new\n//   field value. Note that the `newState` argument is again a partially\n//   constructed state does not yet contain the state from plugins\n//   coming after this one.\n//\n//   toJSON:: ?(value: T)  *\n//   Convert this field to JSON. Optional, can be left off to disable\n//   JSON serialization for the field.\n//\n//   fromJSON:: ?(config: Object, value: *, state: EditorState)  T\n//   Deserialize the JSON representation of this field. Note that the\n//   `state` argument is again a half-initialized state.\n\nvar keys = Object.create(null);\n\nfunction createKey(name) {\n  if (name in keys) { return name + \"$\" + ++keys[name] }\n  keys[name] = 0;\n  return name + \"$\"\n}\n\n// ::- A key is used to [tag](#state.PluginSpec.key)\n// plugins in a way that makes it possible to find them, given an\n// editor state. Assigning a key does mean only one plugin of that\n// type can be active in a state.\nvar PluginKey = function PluginKey(name) {\nif ( name === void 0 ) name = \"key\";\n this.key = createKey(name); };\n\n// :: (EditorState)  ?Plugin\n// Get the active plugin with this key, if any, from an editor\n// state.\nPluginKey.prototype.get = function get (state) { return state.config.pluginsByKey[this.key] };\n\n// :: (EditorState)  ?any\n// Get the plugin's state from an editor state.\nPluginKey.prototype.getState = function getState (state) { return state[this.key] };\n\nexport { AllSelection, EditorState, NodeSelection, Plugin, PluginKey, Selection, SelectionRange, TextSelection, Transaction };\n//# sourceMappingURL=index.es.js.map\n","import _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _typeof from '@babel/runtime/helpers/typeof';\nimport deepmerge from 'deepmerge';\nimport fastDeepEqual from 'fast-deep-equal';\nimport fastMemoize from 'fast-memoize';\nimport nano from 'nanoid';\nimport objectOmit from 'object.omit';\nimport objectPick from 'object.pick';\nexport * from 'throttle-debounce';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/**\n * Type cast an argument. If no type is provided it will default to any.\n *\n * @param arg - the arg to typecast\n */\nvar Cast = function Cast(arg) {\n  return arg;\n};\n/**\n * Shorthand for casting a value to it's boolean equivalent.\n *\n * @param value - the value to transform into a boolean\n *\n * @public\n */\n\nvar bool = function bool(value) {\n  return !!value;\n};\n/**\n * A type name matcher for object types.\n *\n * @private\n */\n\nvar TypeName;\n/**\n * Alias of toString for non-dom environments.\n *\n * @private\n */\n\n(function (TypeName) {\n  TypeName[\"Object\"] = \"Object\";\n  TypeName[\"RegExp\"] = \"RegExp\";\n  TypeName[\"Date\"] = \"Date\";\n  TypeName[\"Promise\"] = \"Promise\";\n  TypeName[\"Error\"] = \"Error\";\n  TypeName[\"Map\"] = \"Map\";\n  TypeName[\"Set\"] = \"Set\";\n})(TypeName || (TypeName = {}));\n\nvar toString = Object.prototype.toString;\n/**\n * Retrieve the object type of a value via it's string reference. This is safer\n * than relying on instanceof checks which fail on cross-frame values.\n *\n * @param value - the object to inspect\n */\n\nvar getObjectType = function getObjectType(value) {\n  var objectName = toString.call(value).slice(8, -1);\n  return objectName;\n};\n/**\n * A helper for building type predicates\n *\n * @param type -  the name of the type to check for\n * @returns a predicate function for checking the value type\n */\n\n\nvar isOfType = function isOfType(type, test) {\n  return function (value) {\n    return _typeof(value) === type ? test ? test(value) : true : false;\n  };\n};\n/**\n * Get the object type of passed in value. This avoids the reliance on\n * `instanceof` checks which are subject to cross frame issues as outlined in\n * this link https://bit.ly/1Qds27W\n *\n * @param type - the name of the object type to check for\n *\n * @private\n */\n\n\nvar isObjectOfType = function isObjectOfType(type) {\n  return function (value) {\n    return getObjectType(value) === type;\n  };\n};\n/**\n * Check if an instance is the direct instance of the provided class.\n */\n\n\nvar isDirectInstanceOf = function isDirectInstanceOf(instance, Constructor) {\n  return Object.getPrototypeOf(instance) === Constructor.prototype;\n};\n/**\n * Predicate check that value is undefined\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isUndefined = isOfType('undefined');\n/**\n * Predicate check that value is a string\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isString = isOfType('string');\n/**\n * Predicate check that value is a number.\n *\n * Also by default doesn't include NaN as a valid number.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNumber = isOfType('number', function (val) {\n  return !Number.isNaN(val);\n});\n/**\n * Predicate check that value is a function\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isFunction = isOfType('function');\n/**\n * Predicate check that value is null\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNull = function isNull(value) {\n  return value === null;\n};\n/**\n * Predicate check that value is a class\n *\n * @deprecated Due to the current build process stripping out classes\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isClass = function isClass(value) {\n  return isFunction(value) && value.toString().startsWith('class ');\n};\n/**\n * Predicate check that value is boolean\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isBoolean = function isBoolean(value) {\n  return value === true || value === false;\n};\n/**\n * Predicate check that value is a symbol\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isSymbol = isOfType('symbol');\n/**\n * Helper function for Number.isInteger check allowing non numbers to be tested\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isInteger = function isInteger(value) {\n  return Number.isInteger(value);\n};\n/**\n * Helper function for Number.isSafeInteger allowing for unknown values to be\n * tested\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isSafeInteger = function isSafeInteger(value) {\n  return Number.isSafeInteger(value);\n};\n/**\n * Predicate check for whether passed in value is a plain object\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isPlainObject = function isPlainObject(value) {\n  if (getObjectType(value) !== TypeName.Object) {\n    return false;\n  }\n\n  var prototype = Object.getPrototypeOf(value);\n  return prototype === null || prototype === Object.getPrototypeOf({});\n};\n/**\n * Utility predicate check that value is either null or undefined\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNullOrUndefined = function isNullOrUndefined(value) {\n  return isNull(value) || isUndefined(value);\n};\n/**\n * Predicate check that value is an object\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isObject = function isObject(value) {\n  return !isNullOrUndefined(value) && (isFunction(value) || isOfType('object')(value));\n};\n/**\n * A shorthand method for creating instance of checks.\n */\n\nvar isInstanceOf = function isInstanceOf(Constructor) {\n  return function (value) {\n    return isObject(value) && value instanceof Constructor;\n  };\n};\n/**\n * Predicate check that value is a native promise\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNativePromise = function isNativePromise(value) {\n  return isObjectOfType(TypeName.Promise)(value);\n};\n/**\n * Check to see if a value has the built in promise API.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar hasPromiseAPI = function hasPromiseAPI(value) {\n  return !isNull(value) && isObject(value) && isFunction(value.then) && isFunction(value[\"catch\"]);\n};\n/**\n * Predicate check that value has the promise api implemented\n *\n * @param value - the value to check\n *\n * @public\n */\n\n\nvar isPromise = function isPromise(value) {\n  return isNativePromise(value) || hasPromiseAPI(value);\n};\n/**\n * Predicate check that value is a RegExp\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isRegExp = isObjectOfType(TypeName.RegExp);\n/**\n * Predicate check that value is a date\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isDate = isObjectOfType(TypeName.Date);\n/**\n * Predicate check that value is an error\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isError = isObjectOfType(TypeName.Error);\n/**\n * Predicate check that value is a `Map`\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isMap = function isMap(value) {\n  return isObjectOfType(TypeName.Map)(value);\n};\n/**\n * Predicate check that value is a `Set`\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isSet = function isSet(value) {\n  return isObjectOfType(TypeName.Set)(value);\n};\n/**\n * Predicate check that value is an empty object\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isEmptyObject = function isEmptyObject(value) {\n  return isObject(value) && !isMap(value) && !isSet(value) && Object.keys(value).length === 0;\n};\n/**\n * Alias the isArray method.\n */\n\nvar isArray = Array.isArray;\n/**\n * Predicate check that value is an empty array\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isEmptyArray = function isEmptyArray(value) {\n  return isArray(value) && value.length === 0;\n};\n/**\n * Capitalizes a string value.\n *\n * @param str - the string to capitalize.\n * @public\n */\n\nvar capitalize = function capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n};\n/**\n * Removes leading and trailing whitespace from a string.\n *\n * @param str - the string to trim\n *\n * @public\n */\n\nvar trim = function trim(str) {\n  return str.replace(/^ +| +$/g, '');\n};\n/**\n * Trim and conditionally capitalize string values.\n *\n * @param str - the string to format.\n *\n * @public\n */\n\nvar format = function format(str) {\n  str = trim(str);\n  return /^(?:webOS|i(?:OS|P))/.test(str) ? str : capitalize(str);\n};\n/**\n * Calls a function if defined and provides compile time type checking for the\n * passed in parameters.\n *\n * @param fn - the function to call if it exists\n * @param args - the rest of the parameters with types\n */\n\nvar callIfDefined = function callIfDefined(fn) {\n  if (isFunction(fn)) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    fn.apply(void 0, args);\n  }\n};\n/**\n * Finds all the regex matches for a string\n *\n * @param text - the text to check against\n * @param regexp - the regex (which should include a 'g' flag)\n *\n * @public\n */\n\nvar findMatches = function findMatches(text, regexp) {\n  var results = [];\n  var flags = regexp.flags;\n  var match;\n\n  if (!flags.includes('g')) {\n    regexp = new RegExp(regexp.source, \"g\".concat(flags));\n  }\n\n  do {\n    match = regexp.exec(text);\n\n    if (match) {\n      results.push(match);\n    }\n  } while (match);\n\n  regexp.lastIndex = 0;\n  return results;\n};\n/**\n * A utility function to clean up the Operating System name.\n *\n * @param os - the OS name to clean up.\n * @param pattern - a `RegExp` pattern matching the OS name.\n * @param label - a label for the OS.\n * @returns a cleaned up Operating System name\n *\n * @public\n */\n\nvar cleanupOS = function cleanupOS(os, pattern, label) {\n  if (pattern && label) {\n    os = os.replace(RegExp(pattern, 'i'), label);\n  }\n\n  var val = format(os.replace(/ ce$/i, ' CE').replace(/\\bhpw/i, 'web').replace(/\\bMacintosh\\b/, 'Mac OS').replace(/_PowerPC\\b/i, ' OS').replace(/\\b(OS X) [^ \\d]+/i, '$1').replace(/\\bMac (OS X)\\b/, '$1').replace(/\\/(\\d)/, ' $1').replace(/_/g, '.').replace(/(?: BePC|[ .]*fc[ \\d.]+)$/i, '').replace(/\\bx86\\.64\\b/gi, 'x86_64').replace(/\\b(Windows Phone) OS\\b/, '$1').replace(/\\b(Chrome OS \\w+) [\\d.]+\\b/, '$1').split(' on ')[0]);\n  return val;\n};\n/**\n * A utility function to check whether the current browser is running on the\n * android platform.\n * @public\n */\n\nvar isAndroidOS = function isAndroidOS() {\n  var ua = navigator.userAgent;\n  var match = RegExp('\\\\b' + 'Android' + '(?:/[\\\\d.]+|[ \\\\w.]*)', 'i').exec(ua);\n\n  if (!match) {\n    return false;\n  }\n\n  return cleanupOS(match[0], 'Android', 'Android').includes('Android');\n};\n/**\n * Generate a random float between min and max. If only one parameter is\n * provided minimum is set to 0.\n *\n * @param min - the minimum value\n * @param max - the maximum value\n *\n * @public\n */\n\nvar randomFloat = function randomFloat(min, max) {\n  if (!max) {\n    max = min;\n    min = 0.0;\n  }\n\n  return Math.random() * (max - min + 1) + min;\n};\n/**\n * Generate a random integer between min and max. If only one parameter is\n * provided minimum is set to 0.\n *\n * @param min - the minimum value\n * @param max - the maximum value\n *\n * @public\n */\n\nvar randomInt = function randomInt(min, max) {\n  return Math.floor(randomFloat(min, max));\n};\n/**\n * Converts a string, including strings in camelCase or snake_case, into Start\n * Case (a variant of Title Case where all words start with a capital letter),\n * it keeps original single quote and hyphen in the word.\n *\n *   'management_companies' to 'Management Companies' 'managementCompanies' to\n *   'Management Companies' `hell's kitchen` to `Hell's Kitchen` `co-op` to\n *   `Co-op`\n *\n * @param str - the string to examine\n */\n\nvar startCase = function startCase(str) {\n  return str.replace(/_/g, ' ').replace(/([a-z])([A-Z])/g, function (_, $1, $2) {\n    return \"\".concat($1, \" \").concat($2);\n  }).replace(/(\\s|^)(\\w)/g, function (_, $1, $2) {\n    return \"\".concat($1).concat($2.toUpperCase());\n  });\n};\nvar wordSeparators = /[\\s\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,\\-./:;<=>?@[\\]^_`{|}~]+/;\nvar capitals = /[A-Z\\u00C0-\\u00D6\\u00D9-\\u00DD]/g;\n/**\n * Returns the kebab cased form of a string.\n *\n * Taken from\n * https://github.com/angus-c/just/blob/master/packages/string-kebab-case/index.js\n * kebabCase('the quick brown fox'); // 'the-quick-brown-fox'\n * kebabCase('the-quick-brown-fox'); // 'the-quick-brown-fox'\n * kebabCase('the_quick_brown_fox'); // 'the-quick-brown-fox'\n * kebabCase('theQuickBrownFox'); // 'the-quick-brown-fox'\n * kebabCase('theQuickBrown Fox'); // 'the-quick-brown-fox'\n * kebabCase('thequickbrownfox'); // 'thequickbrownfox' kebabCase('the - quick *\n * brown# fox'); // 'the-quick-brown-fox' kebabCase('theQUICKBrownFox'); //\n * 'the-q-u-i-c-k-brown-fox'\n */\n\nvar kebabCase = function kebabCase(str) {\n  // replace capitals with space + lower case equivalent for later parsing\n  return str.replace(capitals, function (match) {\n    return \" \".concat(match.toLowerCase() || match);\n  }).trim().split(wordSeparators).join('-');\n};\n/**\n * This is required since it is not exported from `fastMemomize`\n *\n * @internalRemarks\n * TODO create a pull request to fix this.\n */\n\n/**\n * Alias for caching function calls\n */\nvar memoize = fastMemoize;\n\n/**\n * Generate a unique id\n *\n * @param params - the destructured params\n * @returns a unique string of specified length\n *\n * @public\n */\nvar uniqueId = function uniqueId() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    prefix: ''\n  },\n      _ref$prefix = _ref.prefix,\n      prefix = _ref$prefix === void 0 ? '' : _ref$prefix,\n      size = _ref.size;\n\n  return \"\".concat(prefix).concat(nano(size));\n};\n/**\n * Takes a number of elements from the provided array starting from the\n * zero-index\n *\n * @param arr - the array to take from\n * @param num - the number of items to take\n *\n * @public\n */\n\nvar take = function take(arr, num) {\n  num = Math.max(Math.min(0, num), num);\n  return arr.slice(0, num);\n};\n/**\n * Alias for picking properties from an object\n */\n\nvar pick = objectPick;\n/**\n * Alias for excluding properties from an object\n */\n\nvar omit = objectOmit;\nvar omitUndefined = function omitUndefined(object) {\n  return omit(object, function (value) {\n    return !isUndefined(value);\n  });\n};\n/**\n * Clones a plain object using object spread notation\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar clone = function clone(value) {\n  if (!isPlainObject(value)) {\n    throw new Error('An invalid value was passed into this clone utility. Expected a plain object');\n  }\n\n  return _objectSpread({}, value);\n};\n/**\n * Alias for fast deep equal\n */\n\nvar isEqual = fastDeepEqual;\n/**\n * Create a unique array in a non-mutating manner\n *\n * @param array - the array which will be reduced to its unique elements\n * @param fromStart - when set to true the duplicates will be removed from the\n * beginning of the array. This defaults to false.\n * @return a new array containing only unique elements (by reference)\n *\n * @public\n */\n\nvar uniqueArray = function uniqueArray(array) {\n  var fromStart = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var arr = fromStart ? _toConsumableArray(array).reverse() : array;\n  var set = new Set(arr);\n  return fromStart ? Array.from(set).reverse() : Array.from(set);\n};\n/**\n * Flattens an array\n *\n * @param array\n *\n * @public\n */\n\nvar flattenArray = function flattenArray(array) {\n  return array.reduce(function (a, b) {\n    return a.concat(Array.isArray(b) ? flattenArray(b) : b);\n  }, []);\n};\n/**\n * Sometimes doing nothing is the best policy.\n */\n\nvar noop = function noop() {};\n/**\n * Use this to completely overwrite an object when merging.\n *\n * ```ts\n * const source = { awesome: { a: 'a' } }\n * const target = { awesome: { b: 'b' } }\n * const result = deepMerge(source, target) // => { awesome: { a: 'a', b: 'b' } }\n *\n * const overwriteTarget = { awesome: Merge.overwrite({ b: 'b' }) }\n * const overwriteResult = deepMerge(source, overwriteTarget) // => { awesome: { b: 'b' } }\n * ```\n *\n */\n\nvar Merge =\n/*#__PURE__*/\nfunction () {\n  _createClass(Merge, null, [{\n    key: \"overwrite\",\n\n    /**\n     * Create an object that will completely replace the key when merging.\n     *\n     * @param [obj] - the object to replace the key with. When blank an empty\n     * object is used.\n     */\n    value: function overwrite() {\n      var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Object.create(null);\n      return new Merge(obj);\n    }\n    /**\n     * Sets the key to undefined thus fully deleting the key.\n     */\n\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      return undefined;\n    }\n    /**\n     * This can be used to mimic any object shape.\n     */\n\n  }]);\n\n  function Merge() {\n    var _this = this;\n\n    var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Object.create(null);\n\n    _classCallCheck(this, Merge);\n\n    Object.keys(obj).forEach(function (key) {\n      _this[key] = obj[key];\n    });\n  }\n\n  return Merge;\n}();\n/**\n * A deep merge which only merges plain objects and Arrays. It clones the object\n * before the merge so will not mutate any of the passed in values.\n *\n * To completely remove a key you can use the `Merge` helper class which\n * replaces it's key with a completely new object\n */\n\nvar deepMerge = function deepMerge() {\n  for (var _len2 = arguments.length, objects = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    objects[_key2] = arguments[_key2];\n  }\n\n  return deepmerge.all(objects, {\n    isMergeableObject: isPlainObject\n  });\n};\n\n/**\n * Clamps the value to the provided range.\n */\nvar clamp = function clamp(_ref2) {\n  var min = _ref2.min,\n      max = _ref2.max,\n      value = _ref2.value;\n  return value < min ? min : value > max ? max : value;\n};\n/**\n * Get the last element of the array.\n */\n\nvar last = function last(array) {\n  return array[array.length - 1];\n};\n/**\n * Sorts an array while retaining the original order when the compare method\n * identifies the items as equal.\n *\n * `Array.prototype.sort()` is unstable and so values that are the same will\n * jump around in a non deterministic manner. Here I'm using the index as a\n * fallback. If two elements have the same priority the element with the lower\n * index is placed first hence retaining the original order.\n *\n * @param array - the array to sort\n * @param compareFn - compare the two value arguments `a` and `b` - return 0 for\n *                  equal - return number > 0 for a > b - return number < 0 for\n *                  b > a\n */\n\nvar sort = function sort(array, compareFn) {\n  return _toConsumableArray(array).map(function (value, index) {\n    return {\n      value: value,\n      index: index\n    };\n  }).sort(function (a, b) {\n    return compareFn(a.value, b.value) || a.index - b.index;\n  }).map(function (_ref3) {\n    var value = _ref3.value;\n    return value;\n  });\n};\n/**\n * Get a property from an object or array by a string path or an array path.\n *\n * @param path - path to property\n * @param obj - object to retrieve property from\n */\n\nvar get = function get(path, obj, fallback) {\n  if (!path || !path.length) {\n    return isUndefined(obj) ? fallback : obj;\n  }\n\n  if (isString(path)) {\n    path = path.split('.');\n  }\n\n  for (var ii = 0, len = path.length; ii < len && obj; ++ii) {\n    if (!isPlainObject(obj) && !isArray(obj)) {\n      return fallback;\n    }\n\n    obj = obj[path[ii]];\n  }\n\n  return isUndefined(obj) ? fallback : obj;\n};\n/**\n * Create a unique array of objects from a getter function or a property list.\n *\n * @param array - the array to extract unique values from\n * @param getValue - a getter function or a string with the path to the item\n * that is being used as a a test for uniqueness.\n * @param fromStart - when true will remove duplicates from the start rather\n * than from the end\n *\n * ```ts\n * import { uniqueBy } from '@remirror/core-helpers';\n *\n * const values = uniqueBy([{ id: 'a', value: 'Awesome' }, { id: 'a', value: 'ignored' }], item => item.id);\n * log(values) // => [{id: 'a', value: 'Awesome'}]\n *\n * const byKey = uniqueBy([{ id: 'a', value: 'Awesome' }, { id: 'a', value: 'ignored' }], 'id')\n * // Same as above\n * ```\n */\n\nvar uniqueBy = function uniqueBy(array, getValue) {\n  var fromStart = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var unique = [];\n  var found = new Set();\n\n  var makeFn = function makeFn(val) {\n    return function (item) {\n      return get(val, item);\n    };\n  };\n\n  var getter = isFunction(getValue) ? getValue : makeFn(getValue);\n  var arr = fromStart ? _toConsumableArray(array).reverse() : array;\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var _item = _step.value;\n\n      var _value = getter(_item);\n\n      if (!found.has(_value)) {\n        found.add(_value);\n        unique.push(_item);\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return fromStart ? unique.reverse() : unique;\n};\n/**\n * A typesafe implementation of `Object.entries`\n *\n * Taken from\n * https://github.com/biggyspender/ts-entries/blob/master/src/ts-entries.ts\n */\n\nvar entries = function entries(obj) {\n  return Object.entries(obj);\n};\n/**\n * A typesafe implementation of `Object.keys`\n */\n\nvar keys = function keys(obj) {\n  return Object.keys(obj);\n};\n/**\n * A more lenient typed version of `Array.prototype.includes` which allow less\n * specific types to be checked.\n */\n\nvar includes = function includes(array, item, fromIndex) {\n  return array.includes(item, fromIndex);\n};\n/**\n * Create a range from start to end.\n *\n * If only start is provided it creates an array of the size provided. if start\n * and end are provided it creates an array who's first position is start and\n * final position is end. i.e. `length = (end - start) + 1`\n */\n\nvar range = function range(start, end) {\n  return !isNumber(end) ? Array.from({\n    length: Math.abs(start)\n  }, function (_, index) {\n    return (start < 0 ? -1 : 1) * index;\n  }) : start <= end ? Array.from({\n    length: end + 1 - start\n  }, function (_, index) {\n    return index + start;\n  }) : Array.from({\n    length: start + 1 - end\n  }, function (_, index) {\n    return -1 * index + start;\n  });\n};\n/**\n * Check that a number is within the minimum and maximum bounds of a set of\n * numbers.\n *\n * @param value - the number to test\n */\n\nvar within = function within(value) {\n  for (var _len3 = arguments.length, rest = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n    rest[_key3 - 1] = arguments[_key3];\n  }\n\n  var numbers = rest.filter(isNumber);\n  return value >= Math.min.apply(Math, _toConsumableArray(numbers)) && value <= Math.max.apply(Math, _toConsumableArray(numbers));\n};\n/**\n * Safe implementation of hasOwnProperty with typechecking.\n *\n * @remarks\n *\n * See {@link https://eslint.org/docs/rules/no-prototype-builtins}\n *\n * @param obj - the object to check\n * @param key - the property to check\n *\n * @typeParam GObj - the object type\n * @typeParam GProperty - the property which can be a string | number | symbol\n */\n\nvar hasOwnProperty = function hasOwnProperty(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n};\n\nexport { Cast, Merge, bool, callIfDefined, capitalize, clamp, cleanupOS, clone, deepMerge, entries, findMatches, flattenArray, format, get, hasOwnProperty, includes, isAndroidOS, isArray, isBoolean, isClass, isDate, isDirectInstanceOf, isEmptyArray, isEmptyObject, isEqual, isError, isFunction, isInstanceOf, isInteger, isMap, isNativePromise, isNull, isNullOrUndefined, isNumber, isObject, isPlainObject, isPromise, isRegExp, isSafeInteger, isSet, isString, isSymbol, isUndefined, kebabCase, keys, last, memoize, noop, omit, omitUndefined, pick, randomFloat, randomInt, range, sort, startCase, take, trim, uniqueArray, uniqueBy, uniqueId, within };\n//# sourceMappingURL=core-helpers.esm.js.map\n","export default function crelt() {\n  var elt = arguments[0]\n  if (typeof elt == \"string\") elt = document.createElement(elt)\n  var i = 1, next = arguments[1]\n  if (next && typeof next == \"object\" && next.nodeType == null && !Array.isArray(next)) {\n    for (var name in next) if (Object.prototype.hasOwnProperty.call(next, name)) {\n      var value = next[name]\n      if (typeof value == \"string\") elt.setAttribute(name, value)\n      else if (value != null) elt[name] = value\n    }\n    i++\n  }\n  for (; i < arguments.length; i++) add(elt, arguments[i])\n  return elt\n}\n\nfunction add(elt, child) {\n  if (typeof child == \"string\") {\n    elt.appendChild(document.createTextNode(child))\n  } else if (child == null) {\n  } else if (child.nodeType != null) {\n    elt.appendChild(child)\n  } else if (Array.isArray(child)) {\n    for (var i = 0; i < child.length; i++) add(elt, child[i])\n  } else {\n    throw new RangeError(\"Unsupported child node: \" + child)\n  }\n}\n","import crel from 'crelt';\nimport { joinUp, lift, selectParentNode, setBlockType, wrapIn } from 'prosemirror-commands';\nimport { undo, redo } from 'prosemirror-history';\nimport { Plugin } from 'prosemirror-state';\n\nvar SVG = \"http://www.w3.org/2000/svg\";\nvar XLINK = \"http://www.w3.org/1999/xlink\";\n\nvar prefix = \"ProseMirror-icon\";\n\nfunction hashPath(path) {\n  var hash = 0;\n  for (var i = 0; i < path.length; i++)\n    { hash = (((hash << 5) - hash) + path.charCodeAt(i)) | 0; }\n  return hash\n}\n\nfunction getIcon(icon) {\n  var node = document.createElement(\"div\");\n  node.className = prefix;\n  if (icon.path) {\n    var name = \"pm-icon-\" + hashPath(icon.path).toString(16);\n    if (!document.getElementById(name)) { buildSVG(name, icon); }\n    var svg = node.appendChild(document.createElementNS(SVG, \"svg\"));\n    svg.style.width = (icon.width / icon.height) + \"em\";\n    var use = svg.appendChild(document.createElementNS(SVG, \"use\"));\n    use.setAttributeNS(XLINK, \"href\", /([^#]*)/.exec(document.location)[1] + \"#\" + name);\n  } else if (icon.dom) {\n    node.appendChild(icon.dom.cloneNode(true));\n  } else {\n    node.appendChild(document.createElement(\"span\")).textContent = icon.text || '';\n    if (icon.css) { node.firstChild.style.cssText = icon.css; }\n  }\n  return node\n}\n\nfunction buildSVG(name, data) {\n  var collection = document.getElementById(prefix + \"-collection\");\n  if (!collection) {\n    collection = document.createElementNS(SVG, \"svg\");\n    collection.id = prefix + \"-collection\";\n    collection.style.display = \"none\";\n    document.body.insertBefore(collection, document.body.firstChild);\n  }\n  var sym = document.createElementNS(SVG, \"symbol\");\n  sym.id = name;\n  sym.setAttribute(\"viewBox\", \"0 0 \" + data.width + \" \" + data.height);\n  var path = sym.appendChild(document.createElementNS(SVG, \"path\"));\n  path.setAttribute(\"d\", data.path);\n  collection.appendChild(sym);\n}\n\nvar prefix$1 = \"ProseMirror-menu\";\n\n// ::- An icon or label that, when clicked, executes a command.\nvar MenuItem = function MenuItem(spec) {\n  // :: MenuItemSpec\n  // The spec used to create the menu item.\n  this.spec = spec;\n};\n\n// :: (EditorView)  {dom: dom.Node, update: (EditorState)  bool}\n// Renders the icon according to its [display\n// spec](#menu.MenuItemSpec.display), and adds an event handler which\n// executes the command when the representation is clicked.\nMenuItem.prototype.render = function render (view) {\n  var spec = this.spec;\n  var dom = spec.render ? spec.render(view)\n      : spec.icon ? getIcon(spec.icon)\n      : spec.label ? crel(\"div\", null, translate(view, spec.label))\n      : null;\n  if (!dom) { throw new RangeError(\"MenuItem without icon or label property\") }\n  if (spec.title) {\n    var title = (typeof spec.title === \"function\" ? spec.title(view.state) : spec.title);\n    dom.setAttribute(\"title\", translate(view, title));\n  }\n  if (spec.class) { dom.classList.add(spec.class); }\n  if (spec.css) { dom.style.cssText += spec.css; }\n\n  dom.addEventListener(\"mousedown\", function (e) {\n    e.preventDefault();\n    if (!dom.classList.contains(prefix$1 + \"-disabled\"))\n      { spec.run(view.state, view.dispatch, view, e); }\n  });\n\n  function update(state) {\n    if (spec.select) {\n      var selected = spec.select(state);\n      dom.style.display = selected ? \"\" : \"none\";\n      if (!selected) { return false }\n    }\n    var enabled = true;\n    if (spec.enable) {\n      enabled = spec.enable(state) || false;\n      setClass(dom, prefix$1 + \"-disabled\", !enabled);\n    }\n    if (spec.active) {\n      var active = enabled && spec.active(state) || false;\n      setClass(dom, prefix$1 + \"-active\", active);\n    }\n    return true\n  }\n\n  return {dom: dom, update: update}\n};\n\nfunction translate(view, text) {\n  return view._props.translate ? view._props.translate(text) : text\n}\n\n// MenuItemSpec:: interface\n// The configuration object passed to the `MenuItem` constructor.\n//\n//   run:: (EditorState, (Transaction), EditorView, dom.Event)\n//   The function to execute when the menu item is activated.\n//\n//   select:: ?(EditorState)  bool\n//   Optional function that is used to determine whether the item is\n//   appropriate at the moment. Deselected items will be hidden.\n//\n//   enable:: ?(EditorState)  bool\n//   Function that is used to determine if the item is enabled. If\n//   given and returning false, the item will be given a disabled\n//   styling.\n//\n//   active:: ?(EditorState)  bool\n//   A predicate function to determine whether the item is 'active' (for\n//   example, the item for toggling the strong mark might be active then\n//   the cursor is in strong text).\n//\n//   render:: ?(EditorView)  dom.Node\n//   A function that renders the item. You must provide either this,\n//   [`icon`](#menu.MenuItemSpec.icon), or [`label`](#MenuItemSpec.label).\n//\n//   icon:: ?Object\n//   Describes an icon to show for this item. The object may specify\n//   an SVG icon, in which case its `path` property should be an [SVG\n//   path\n//   spec](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d),\n//   and `width` and `height` should provide the viewbox in which that\n//   path exists. Alternatively, it may have a `text` property\n//   specifying a string of text that makes up the icon, with an\n//   optional `css` property giving additional CSS styling for the\n//   text. _Or_ it may contain `dom` property containing a DOM node.\n//\n//   label:: ?string\n//   Makes the item show up as a text label. Mostly useful for items\n//   wrapped in a [drop-down](#menu.Dropdown) or similar menu. The object\n//   should have a `label` property providing the text to display.\n//\n//   title:: ?union<string, (EditorState)  string>\n//   Defines DOM title (mouseover) text for the item.\n//\n//   class:: ?string\n//   Optionally adds a CSS class to the item's DOM representation.\n//\n//   css:: ?string\n//   Optionally adds a string of inline CSS to the item's DOM\n//   representation.\n\nvar lastMenuEvent = {time: 0, node: null};\nfunction markMenuEvent(e) {\n  lastMenuEvent.time = Date.now();\n  lastMenuEvent.node = e.target;\n}\nfunction isMenuEvent(wrapper) {\n  return Date.now() - 100 < lastMenuEvent.time &&\n    lastMenuEvent.node && wrapper.contains(lastMenuEvent.node)\n}\n\n// ::- A drop-down menu, displayed as a label with a downwards-pointing\n// triangle to the right of it.\nvar Dropdown = function Dropdown(content, options) {\n  this.options = options || {};\n  this.content = Array.isArray(content) ? content : [content];\n};\n\n// :: (EditorView)  {dom: dom.Node, update: (EditorState)}\n// Render the dropdown menu and sub-items.\nDropdown.prototype.render = function render (view) {\n    var this$1 = this;\n\n  var content = renderDropdownItems(this.content, view);\n\n  var label = crel(\"div\", {class: prefix$1 + \"-dropdown \" + (this.options.class || \"\"),\n                           style: this.options.css},\n                   translate(view, this.options.label));\n  if (this.options.title) { label.setAttribute(\"title\", translate(view, this.options.title)); }\n  var wrap = crel(\"div\", {class: prefix$1 + \"-dropdown-wrap\"}, label);\n  var open = null, listeningOnClose = null;\n  var close = function () {\n    if (open && open.close()) {\n      open = null;\n      window.removeEventListener(\"mousedown\", listeningOnClose);\n    }\n  };\n  label.addEventListener(\"mousedown\", function (e) {\n    e.preventDefault();\n    markMenuEvent(e);\n    if (open) {\n      close();\n    } else {\n      open = this$1.expand(wrap, content.dom);\n      window.addEventListener(\"mousedown\", listeningOnClose = function () {\n        if (!isMenuEvent(wrap)) { close(); }\n      });\n    }\n  });\n\n  function update(state) {\n    var inner = content.update(state);\n    wrap.style.display = inner ? \"\" : \"none\";\n    return inner\n  }\n\n  return {dom: wrap, update: update}\n};\n\nDropdown.prototype.expand = function expand (dom, items) {\n  var menuDOM = crel(\"div\", {class: prefix$1 + \"-dropdown-menu \" + (this.options.class || \"\")}, items);\n\n  var done = false;\n  function close() {\n    if (done) { return }\n    done = true;\n    dom.removeChild(menuDOM);\n    return true\n  }\n  dom.appendChild(menuDOM);\n  return {close: close, node: menuDOM}\n};\n\nfunction renderDropdownItems(items, view) {\n  var rendered = [], updates = [];\n  for (var i = 0; i < items.length; i++) {\n    var ref = items[i].render(view);\n    var dom = ref.dom;\n    var update = ref.update;\n    rendered.push(crel(\"div\", {class: prefix$1 + \"-dropdown-item\"}, dom));\n    updates.push(update);\n  }\n  return {dom: rendered, update: combineUpdates(updates, rendered)}\n}\n\nfunction combineUpdates(updates, nodes) {\n  return function (state) {\n    var something = false;\n    for (var i = 0; i < updates.length; i++) {\n      var up = updates[i](state);\n      nodes[i].style.display = up ? \"\" : \"none\";\n      if (up) { something = true; }\n    }\n    return something\n  }\n}\n\n// ::- Represents a submenu wrapping a group of elements that start\n// hidden and expand to the right when hovered over or tapped.\nvar DropdownSubmenu = function DropdownSubmenu(content, options) {\n  this.options = options || {};\n  this.content = Array.isArray(content) ? content : [content];\n};\n\n// :: (EditorView)  {dom: dom.Node, update: (EditorState)  bool}\n// Renders the submenu.\nDropdownSubmenu.prototype.render = function render (view) {\n  var items = renderDropdownItems(this.content, view);\n\n  var label = crel(\"div\", {class: prefix$1 + \"-submenu-label\"}, translate(view, this.options.label));\n  var wrap = crel(\"div\", {class: prefix$1 + \"-submenu-wrap\"}, label,\n                 crel(\"div\", {class: prefix$1 + \"-submenu\"}, items.dom));\n  var listeningOnClose = null;\n  label.addEventListener(\"mousedown\", function (e) {\n    e.preventDefault();\n    markMenuEvent(e);\n    setClass(wrap, prefix$1 + \"-submenu-wrap-active\");\n    if (!listeningOnClose)\n      { window.addEventListener(\"mousedown\", listeningOnClose = function () {\n        if (!isMenuEvent(wrap)) {\n          wrap.classList.remove(prefix$1 + \"-submenu-wrap-active\");\n          window.removeEventListener(\"mousedown\", listeningOnClose);\n          listeningOnClose = null;\n        }\n      }); }\n  });\n\n  function update(state) {\n    var inner = items.update(state);\n    wrap.style.display = inner ? \"\" : \"none\";\n    return inner\n  }\n  return {dom: wrap, update: update}\n};\n\n// :: (EditorView, [union<MenuElement, [MenuElement]>])  {dom: ?dom.DocumentFragment, update: (EditorState)  bool}\n// Render the given, possibly nested, array of menu elements into a\n// document fragment, placing separators between them (and ensuring no\n// superfluous separators appear when some of the groups turn out to\n// be empty).\nfunction renderGrouped(view, content) {\n  var result = document.createDocumentFragment();\n  var updates = [], separators = [];\n  for (var i = 0; i < content.length; i++) {\n    var items = content[i], localUpdates = [], localNodes = [];\n    for (var j = 0; j < items.length; j++) {\n      var ref = items[j].render(view);\n      var dom = ref.dom;\n      var update$1 = ref.update;\n      var span = crel(\"span\", {class: prefix$1 + \"item\"}, dom);\n      result.appendChild(span);\n      localNodes.push(span);\n      localUpdates.push(update$1);\n    }\n    if (localUpdates.length) {\n      updates.push(combineUpdates(localUpdates, localNodes));\n      if (i < content.length - 1)\n        { separators.push(result.appendChild(separator())); }\n    }\n  }\n\n  function update(state) {\n    var something = false, needSep = false;\n    for (var i = 0; i < updates.length; i++) {\n      var hasContent = updates[i](state);\n      if (i) { separators[i - 1].style.display = needSep && hasContent ? \"\" : \"none\"; }\n      needSep = hasContent;\n      if (hasContent) { something = true; }\n    }\n    return something\n  }\n  return {dom: result, update: update}\n}\n\nfunction separator() {\n  return crel(\"span\", {class: prefix$1 + \"separator\"})\n}\n\n// :: Object\n// A set of basic editor-related icons. Contains the properties\n// `join`, `lift`, `selectParentNode`, `undo`, `redo`, `strong`, `em`,\n// `code`, `link`, `bulletList`, `orderedList`, and `blockquote`, each\n// holding an object that can be used as the `icon` option to\n// `MenuItem`.\nvar icons = {\n  join: {\n    width: 800, height: 900,\n    path: \"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z\"\n  },\n  lift: {\n    width: 1024, height: 1024,\n    path: \"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z\"\n  },\n  selectParentNode: {text: \"\\u2b1a\", css: \"font-weight: bold\"},\n  undo: {\n    width: 1024, height: 1024,\n    path: \"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z\"\n  },\n  redo: {\n    width: 1024, height: 1024,\n    path: \"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z\"\n  },\n  strong: {\n    width: 805, height: 1024,\n    path: \"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z\"\n  },\n  em: {\n    width: 585, height: 1024,\n    path: \"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z\"\n  },\n  code: {\n    width: 896, height: 1024,\n    path: \"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z\"\n  },\n  link: {\n    width: 951, height: 1024,\n    path: \"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z\"\n  },\n  bulletList: {\n    width: 768, height: 896,\n    path: \"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z\"\n  },\n  orderedList: {\n    width: 768, height: 896,\n    path: \"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z\"\n  },\n  blockquote: {\n    width: 640, height: 896,\n    path: \"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z\"\n  }\n};\n\n// :: MenuItem\n// Menu item for the `joinUp` command.\nvar joinUpItem = new MenuItem({\n  title: \"Join with above block\",\n  run: joinUp,\n  select: function (state) { return joinUp(state); },\n  icon: icons.join\n});\n\n// :: MenuItem\n// Menu item for the `lift` command.\nvar liftItem = new MenuItem({\n  title: \"Lift out of enclosing block\",\n  run: lift,\n  select: function (state) { return lift(state); },\n  icon: icons.lift\n});\n\n// :: MenuItem\n// Menu item for the `selectParentNode` command.\nvar selectParentNodeItem = new MenuItem({\n  title: \"Select parent node\",\n  run: selectParentNode,\n  select: function (state) { return selectParentNode(state); },\n  icon: icons.selectParentNode\n});\n\n// :: MenuItem\n// Menu item for the `undo` command.\nvar undoItem = new MenuItem({\n  title: \"Undo last change\",\n  run: undo,\n  enable: function (state) { return undo(state); },\n  icon: icons.undo\n});\n\n// :: MenuItem\n// Menu item for the `redo` command.\nvar redoItem = new MenuItem({\n  title: \"Redo last undone change\",\n  run: redo,\n  enable: function (state) { return redo(state); },\n  icon: icons.redo\n});\n\n// :: (NodeType, Object)  MenuItem\n// Build a menu item for wrapping the selection in a given node type.\n// Adds `run` and `select` properties to the ones present in\n// `options`. `options.attrs` may be an object or a function.\nfunction wrapItem(nodeType, options) {\n  var passedOptions = {\n    run: function run(state, dispatch) {\n      // FIXME if (options.attrs instanceof Function) options.attrs(state, attrs => wrapIn(nodeType, attrs)(state))\n      return wrapIn(nodeType, options.attrs)(state, dispatch)\n    },\n    select: function select(state) {\n      return wrapIn(nodeType, options.attrs instanceof Function ? null : options.attrs)(state)\n    }\n  };\n  for (var prop in options) { passedOptions[prop] = options[prop]; }\n  return new MenuItem(passedOptions)\n}\n\n// :: (NodeType, Object)  MenuItem\n// Build a menu item for changing the type of the textblock around the\n// selection to the given type. Provides `run`, `active`, and `select`\n// properties. Others must be given in `options`. `options.attrs` may\n// be an object to provide the attributes for the textblock node.\nfunction blockTypeItem(nodeType, options) {\n  var command = setBlockType(nodeType, options.attrs);\n  var passedOptions = {\n    run: command,\n    enable: function enable(state) { return command(state) },\n    active: function active(state) {\n      var ref = state.selection;\n      var $from = ref.$from;\n      var to = ref.to;\n      var node = ref.node;\n      if (node) { return node.hasMarkup(nodeType, options.attrs) }\n      return to <= $from.end() && $from.parent.hasMarkup(nodeType, options.attrs)\n    }\n  };\n  for (var prop in options) { passedOptions[prop] = options[prop]; }\n  return new MenuItem(passedOptions)\n}\n\n// Work around classList.toggle being broken in IE11\nfunction setClass(dom, cls, on) {\n  if (on) { dom.classList.add(cls); }\n  else { dom.classList.remove(cls); }\n}\n\nvar prefix$2 = \"ProseMirror-menubar\";\n\nfunction isIOS() {\n  if (typeof navigator == \"undefined\") { return false }\n  var agent = navigator.userAgent;\n  return !/Edge\\/\\d/.test(agent) && /AppleWebKit/.test(agent) && /Mobile\\/\\w+/.test(agent)\n}\n\n// :: (Object)  Plugin\n// A plugin that will place a menu bar above the editor. Note that\n// this involves wrapping the editor in an additional `<div>`.\n//\n//   options::-\n//   Supports the following options:\n//\n//     content:: [[MenuElement]]\n//     Provides the content of the menu, as a nested array to be\n//     passed to `renderGrouped`.\n//\n//     floating:: ?bool\n//     Determines whether the menu floats, i.e. whether it sticks to\n//     the top of the viewport when the editor is partially scrolled\n//     out of view.\nfunction menuBar(options) {\n  return new Plugin({\n    view: function view(editorView) { return new MenuBarView(editorView, options) }\n  })\n}\n\nvar MenuBarView = function MenuBarView(editorView, options) {\n  var this$1 = this;\n\n  this.editorView = editorView;\n  this.options = options;\n\n  this.wrapper = crel(\"div\", {class: prefix$2 + \"-wrapper\"});\n  this.menu = this.wrapper.appendChild(crel(\"div\", {class: prefix$2}));\n  this.menu.className = prefix$2;\n  this.spacer = null;\n\n  editorView.dom.parentNode.replaceChild(this.wrapper, editorView.dom);\n  this.wrapper.appendChild(editorView.dom);\n\n  this.maxHeight = 0;\n  this.widthForMaxHeight = 0;\n  this.floating = false;\n\n  var ref = renderGrouped(this.editorView, this.options.content);\n  var dom = ref.dom;\n  var update = ref.update;\n  this.contentUpdate = update;\n  this.menu.appendChild(dom);\n  this.update();\n\n  if (options.floating && !isIOS()) {\n    this.updateFloat();\n    var potentialScrollers = getAllWrapping(this.wrapper);\n    this.scrollFunc = function (e) {\n      var root = this$1.editorView.root;\n      if (!(root.body || root).contains(this$1.wrapper)) {\n          potentialScrollers.forEach(function (el) { return el.removeEventListener(\"scroll\", this$1.scrollFunc); });\n      } else {\n          this$1.updateFloat(e.target.getBoundingClientRect && e.target);\n      }\n    };\n    potentialScrollers.forEach(function (el) { return el.addEventListener('scroll', this$1.scrollFunc); });\n  }\n};\n\nMenuBarView.prototype.update = function update () {\n  this.contentUpdate(this.editorView.state);\n\n  if (this.floating) {\n    this.updateScrollCursor();\n  } else {\n    if (this.menu.offsetWidth != this.widthForMaxHeight) {\n      this.widthForMaxHeight = this.menu.offsetWidth;\n      this.maxHeight = 0;\n    }\n    if (this.menu.offsetHeight > this.maxHeight) {\n      this.maxHeight = this.menu.offsetHeight;\n      this.menu.style.minHeight = this.maxHeight + \"px\";\n    }\n  }\n};\n\nMenuBarView.prototype.updateScrollCursor = function updateScrollCursor () {\n  var selection = this.editorView.root.getSelection();\n  if (!selection.focusNode) { return }\n  var rects = selection.getRangeAt(0).getClientRects();\n  var selRect = rects[selectionIsInverted(selection) ? 0 : rects.length - 1];\n  if (!selRect) { return }\n  var menuRect = this.menu.getBoundingClientRect();\n  if (selRect.top < menuRect.bottom && selRect.bottom > menuRect.top) {\n    var scrollable = findWrappingScrollable(this.wrapper);\n    if (scrollable) { scrollable.scrollTop -= (menuRect.bottom - selRect.top); }\n  }\n};\n\nMenuBarView.prototype.updateFloat = function updateFloat (scrollAncestor) {\n  var parent = this.wrapper, editorRect = parent.getBoundingClientRect(),\n      top = scrollAncestor ? Math.max(0, scrollAncestor.getBoundingClientRect().top) : 0;\n\n  if (this.floating) {\n    if (editorRect.top >= top || editorRect.bottom < this.menu.offsetHeight + 10) {\n      this.floating = false;\n      this.menu.style.position = this.menu.style.left = this.menu.style.top = this.menu.style.width = \"\";\n      this.menu.style.display = \"\";\n      this.spacer.parentNode.removeChild(this.spacer);\n      this.spacer = null;\n    } else {\n      var border = (parent.offsetWidth - parent.clientWidth) / 2;\n      this.menu.style.left = (editorRect.left + border) + \"px\";\n      this.menu.style.display = (editorRect.top > window.innerHeight ? \"none\" : \"\");\n      if (scrollAncestor) { this.menu.style.top = top + \"px\"; }\n    }\n  } else {\n    if (editorRect.top < top && editorRect.bottom >= this.menu.offsetHeight + 10) {\n      this.floating = true;\n      var menuRect = this.menu.getBoundingClientRect();\n      this.menu.style.left = menuRect.left + \"px\";\n      this.menu.style.width = menuRect.width + \"px\";\n      if (scrollAncestor) { this.menu.style.top = top + \"px\"; }\n      this.menu.style.position = \"fixed\";\n      this.spacer = crel(\"div\", {class: prefix$2 + \"-spacer\", style: (\"height: \" + (menuRect.height) + \"px\")});\n      parent.insertBefore(this.spacer, this.menu);\n    }\n  }\n};\n\nMenuBarView.prototype.destroy = function destroy () {\n  if (this.wrapper.parentNode)\n    { this.wrapper.parentNode.replaceChild(this.editorView.dom, this.wrapper); }\n};\n\n// Not precise, but close enough\nfunction selectionIsInverted(selection) {\n  if (selection.anchorNode == selection.focusNode) { return selection.anchorOffset > selection.focusOffset }\n  return selection.anchorNode.compareDocumentPosition(selection.focusNode) == Node.DOCUMENT_POSITION_FOLLOWING\n}\n\nfunction findWrappingScrollable(node) {\n  for (var cur = node.parentNode; cur; cur = cur.parentNode)\n    { if (cur.scrollHeight > cur.clientHeight) { return cur } }\n}\n\nfunction getAllWrapping(node) {\n    var res = [window];\n    for (var cur = node.parentNode; cur; cur = cur.parentNode)\n        { res.push(cur); }\n    return res\n}\n\nexport { Dropdown, DropdownSubmenu, MenuItem, blockTypeItem, icons, joinUpItem, liftItem, menuBar, redoItem, renderGrouped, selectParentNodeItem, undoItem, wrapItem };\n//# sourceMappingURL=index.es.js.map\n","import { liftTarget, canJoin, joinPoint, canSplit, ReplaceAroundStep, findWrapping } from 'prosemirror-transform';\nimport { Fragment, Slice } from 'prosemirror-model';\nimport { NodeSelection, Selection, TextSelection, AllSelection } from 'prosemirror-state';\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Delete the selection, if there is one.\nfunction deleteSelection(state, dispatch) {\n  if (state.selection.empty) { return false }\n  if (dispatch) { dispatch(state.tr.deleteSelection().scrollIntoView()); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// If the selection is empty and at the start of a textblock, try to\n// reduce the distance between that block and the one before itif\n// there's a block directly before it that can be joined, join them.\n// If not, try to move the selected block closer to the next one in\n// the document structure by lifting it out of its parent or moving it\n// into a parent of the previous block. Will use the view for accurate\n// (bidi-aware) start-of-textblock detection if given.\nfunction joinBackward(state, dispatch, view) {\n  var ref = state.selection;\n  var $cursor = ref.$cursor;\n  if (!$cursor || (view ? !view.endOfTextblock(\"backward\", state)\n                        : $cursor.parentOffset > 0))\n    { return false }\n\n  var $cut = findCutBefore($cursor);\n\n  // If there is no node before this, try to lift\n  if (!$cut) {\n    var range = $cursor.blockRange(), target = range && liftTarget(range);\n    if (target == null) { return false }\n    if (dispatch) { dispatch(state.tr.lift(range, target).scrollIntoView()); }\n    return true\n  }\n\n  var before = $cut.nodeBefore;\n  // Apply the joining algorithm\n  if (!before.type.spec.isolating && deleteBarrier(state, $cut, dispatch))\n    { return true }\n\n  // If the node below has no content and the node above is\n  // selectable, delete the node below and select the one above.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(before, \"end\") || NodeSelection.isSelectable(before))) {\n    if (dispatch) {\n      var tr = state.tr.deleteRange($cursor.before(), $cursor.after());\n      tr.setSelection(textblockAt(before, \"end\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos, -1)), -1)\n                      : NodeSelection.create(tr.doc, $cut.pos - before.nodeSize));\n      dispatch(tr.scrollIntoView());\n    }\n    return true\n  }\n\n  // If the node before is an atom, delete it\n  if (before.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) { dispatch(state.tr.delete($cut.pos - before.nodeSize, $cut.pos).scrollIntoView()); }\n    return true\n  }\n\n  return false\n}\n\nfunction textblockAt(node, side) {\n  for (; node; node = (side == \"start\" ? node.firstChild : node.lastChild))\n    { if (node.isTextblock) { return true } }\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// When the selection is empty and at the start of a textblock, select\n// the node before that textblock, if possible. This is intended to be\n// bound to keys like backspace, after\n// [`joinBackward`](#commands.joinBackward) or other deleting\n// commands, as a fall-back behavior when the schema doesn't allow\n// deletion at the selected point.\nfunction selectNodeBackward(state, dispatch, view) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  var empty = ref.empty;\n  var $cut = $head;\n  if (!empty) { return false }\n\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"backward\", state) : $head.parentOffset > 0) { return false }\n    $cut = findCutBefore($head);\n  }\n  var node = $cut && $cut.nodeBefore;\n  if (!node || !NodeSelection.isSelectable(node)) { return false }\n  if (dispatch)\n    { dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos - node.nodeSize)).scrollIntoView()); }\n  return true\n}\n\nfunction findCutBefore($pos) {\n  if (!$pos.parent.type.spec.isolating) { for (var i = $pos.depth - 1; i >= 0; i--) {\n    if ($pos.index(i) > 0) { return $pos.doc.resolve($pos.before(i + 1)) }\n    if ($pos.node(i).type.spec.isolating) { break }\n  } }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// If the selection is empty and the cursor is at the end of a\n// textblock, try to reduce or remove the boundary between that block\n// and the one after it, either by joining them or by moving the other\n// block closer to this one in the tree structure. Will use the view\n// for accurate start-of-textblock detection if given.\nfunction joinForward(state, dispatch, view) {\n  var ref = state.selection;\n  var $cursor = ref.$cursor;\n  if (!$cursor || (view ? !view.endOfTextblock(\"forward\", state)\n                        : $cursor.parentOffset < $cursor.parent.content.size))\n    { return false }\n\n  var $cut = findCutAfter($cursor);\n\n  // If there is no node after this, there's nothing to do\n  if (!$cut) { return false }\n\n  var after = $cut.nodeAfter;\n  // Try the joining algorithm\n  if (deleteBarrier(state, $cut, dispatch)) { return true }\n\n  // If the node above has no content and the node below is\n  // selectable, delete the node above and select the one below.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(after, \"start\") || NodeSelection.isSelectable(after))) {\n    if (dispatch) {\n      var tr = state.tr.deleteRange($cursor.before(), $cursor.after());\n      tr.setSelection(textblockAt(after, \"start\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos)), 1)\n                      : NodeSelection.create(tr.doc, tr.mapping.map($cut.pos)));\n      dispatch(tr.scrollIntoView());\n    }\n    return true\n  }\n\n  // If the next node is an atom, delete it\n  if (after.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) { dispatch(state.tr.delete($cut.pos, $cut.pos + after.nodeSize).scrollIntoView()); }\n    return true\n  }\n\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// When the selection is empty and at the end of a textblock, select\n// the node coming after that textblock, if possible. This is intended\n// to be bound to keys like delete, after\n// [`joinForward`](#commands.joinForward) and similar deleting\n// commands, to provide a fall-back behavior when the schema doesn't\n// allow deletion at the selected point.\nfunction selectNodeForward(state, dispatch, view) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  var empty = ref.empty;\n  var $cut = $head;\n  if (!empty) { return false }\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"forward\", state) : $head.parentOffset < $head.parent.content.size)\n      { return false }\n    $cut = findCutAfter($head);\n  }\n  var node = $cut && $cut.nodeAfter;\n  if (!node || !NodeSelection.isSelectable(node)) { return false }\n  if (dispatch)\n    { dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos)).scrollIntoView()); }\n  return true\n}\n\nfunction findCutAfter($pos) {\n  if (!$pos.parent.type.spec.isolating) { for (var i = $pos.depth - 1; i >= 0; i--) {\n    var parent = $pos.node(i);\n    if ($pos.index(i) + 1 < parent.childCount) { return $pos.doc.resolve($pos.after(i + 1)) }\n    if (parent.type.spec.isolating) { break }\n  } }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Join the selected block or, if there is a text selection, the\n// closest ancestor block of the selection that can be joined, with\n// the sibling above it.\nfunction joinUp(state, dispatch) {\n  var sel = state.selection, nodeSel = sel instanceof NodeSelection, point;\n  if (nodeSel) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.from)) { return false }\n    point = sel.from;\n  } else {\n    point = joinPoint(state.doc, sel.from, -1);\n    if (point == null) { return false }\n  }\n  if (dispatch) {\n    var tr = state.tr.join(point);\n    if (nodeSel) { tr.setSelection(NodeSelection.create(tr.doc, point - state.doc.resolve(point).nodeBefore.nodeSize)); }\n    dispatch(tr.scrollIntoView());\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Join the selected block, or the closest ancestor of the selection\n// that can be joined, with the sibling after it.\nfunction joinDown(state, dispatch) {\n  var sel = state.selection, point;\n  if (sel instanceof NodeSelection) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.to)) { return false }\n    point = sel.to;\n  } else {\n    point = joinPoint(state.doc, sel.to, 1);\n    if (point == null) { return false }\n  }\n  if (dispatch)\n    { dispatch(state.tr.join(point).scrollIntoView()); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Lift the selected block, or the closest ancestor block of the\n// selection that can be lifted, out of its parent node.\nfunction lift(state, dispatch) {\n  var ref = state.selection;\n  var $from = ref.$from;\n  var $to = ref.$to;\n  var range = $from.blockRange($to), target = range && liftTarget(range);\n  if (target == null) { return false }\n  if (dispatch) { dispatch(state.tr.lift(range, target).scrollIntoView()); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// If the selection is in a node whose type has a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, replace the\n// selection with a newline character.\nfunction newlineInCode(state, dispatch) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) { return false }\n  if (dispatch) { dispatch(state.tr.insertText(\"\\n\").scrollIntoView()); }\n  return true\n}\n\nfunction defaultBlockAt(match) {\n  for (var i = 0; i < match.edgeCount; i++) {\n    var ref = match.edge(i);\n    var type = ref.type;\n    if (type.isTextblock && !type.hasRequiredAttrs()) { return type }\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// When the selection is in a node with a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, create a\n// default block after the code block, and move the cursor there.\nfunction exitCode(state, dispatch) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) { return false }\n  var above = $head.node(-1), after = $head.indexAfter(-1), type = defaultBlockAt(above.contentMatchAt(after));\n  if (!above.canReplaceWith(after, after, type)) { return false }\n  if (dispatch) {\n    var pos = $head.after(), tr = state.tr.replaceWith(pos, pos, type.createAndFill());\n    tr.setSelection(Selection.near(tr.doc.resolve(pos), 1));\n    dispatch(tr.scrollIntoView());\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// If a block node is selected, create an empty paragraph before (if\n// it is its parent's first child) or after it.\nfunction createParagraphNear(state, dispatch) {\n  var ref = state.selection;\n  var $from = ref.$from;\n  var $to = ref.$to;\n  if ($from.parent.inlineContent || $to.parent.inlineContent) { return false }\n  var type = defaultBlockAt($from.parent.contentMatchAt($to.indexAfter()));\n  if (!type || !type.isTextblock) { return false }\n  if (dispatch) {\n    var side = (!$from.parentOffset && $to.index() < $to.parent.childCount ? $from : $to).pos;\n    var tr = state.tr.insert(side, type.createAndFill());\n    tr.setSelection(TextSelection.create(tr.doc, side + 1));\n    dispatch(tr.scrollIntoView());\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// If the cursor is in an empty textblock that can be lifted, lift the\n// block.\nfunction liftEmptyBlock(state, dispatch) {\n  var ref = state.selection;\n  var $cursor = ref.$cursor;\n  if (!$cursor || $cursor.parent.content.size) { return false }\n  if ($cursor.depth > 1 && $cursor.after() != $cursor.end(-1)) {\n    var before = $cursor.before();\n    if (canSplit(state.doc, before)) {\n      if (dispatch) { dispatch(state.tr.split(before).scrollIntoView()); }\n      return true\n    }\n  }\n  var range = $cursor.blockRange(), target = range && liftTarget(range);\n  if (target == null) { return false }\n  if (dispatch) { dispatch(state.tr.lift(range, target).scrollIntoView()); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Split the parent block of the selection. If the selection is a text\n// selection, also delete its content.\nfunction splitBlock(state, dispatch) {\n  var ref = state.selection;\n  var $from = ref.$from;\n  var $to = ref.$to;\n  if (state.selection instanceof NodeSelection && state.selection.node.isBlock) {\n    if (!$from.parentOffset || !canSplit(state.doc, $from.pos)) { return false }\n    if (dispatch) { dispatch(state.tr.split($from.pos).scrollIntoView()); }\n    return true\n  }\n\n  if (!$from.parent.isBlock) { return false }\n\n  if (dispatch) {\n    var atEnd = $to.parentOffset == $to.parent.content.size;\n    var tr = state.tr;\n    if (state.selection instanceof TextSelection) { tr.deleteSelection(); }\n    var deflt = $from.depth == 0 ? null : defaultBlockAt($from.node(-1).contentMatchAt($from.indexAfter(-1)));\n    var types = atEnd && deflt ? [{type: deflt}] : null;\n    var can = canSplit(tr.doc, tr.mapping.map($from.pos), 1, types);\n    if (!types && !can && canSplit(tr.doc, tr.mapping.map($from.pos), 1, deflt && [{type: deflt}])) {\n      types = [{type: deflt}];\n      can = true;\n    }\n    if (can) {\n      tr.split(tr.mapping.map($from.pos), 1, types);\n      if (!atEnd && !$from.parentOffset && $from.parent.type != deflt &&\n          $from.node(-1).canReplace($from.index(-1), $from.indexAfter(-1), Fragment.from([deflt.create(), $from.parent])))\n        { tr.setNodeMarkup(tr.mapping.map($from.before()), deflt); }\n    }\n    dispatch(tr.scrollIntoView());\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Acts like [`splitBlock`](#commands.splitBlock), but without\n// resetting the set of active marks at the cursor.\nfunction splitBlockKeepMarks(state, dispatch) {\n  return splitBlock(state, dispatch && (function (tr) {\n    var marks = state.storedMarks || (state.selection.$to.parentOffset && state.selection.$from.marks());\n    if (marks) { tr.ensureMarks(marks); }\n    dispatch(tr);\n  }))\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Move the selection to the node wrapping the current selection, if\n// any. (Will not select the document node.)\nfunction selectParentNode(state, dispatch) {\n  var ref = state.selection;\n  var $from = ref.$from;\n  var to = ref.to;\n  var pos;\n  var same = $from.sharedDepth(to);\n  if (same == 0) { return false }\n  pos = $from.before(same);\n  if (dispatch) { dispatch(state.tr.setSelection(NodeSelection.create(state.doc, pos))); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Select the whole document.\nfunction selectAll(state, dispatch) {\n  if (dispatch) { dispatch(state.tr.setSelection(new AllSelection(state.doc))); }\n  return true\n}\n\nfunction joinMaybeClear(state, $pos, dispatch) {\n  var before = $pos.nodeBefore, after = $pos.nodeAfter, index = $pos.index();\n  if (!before || !after || !before.type.compatibleContent(after.type)) { return false }\n  if (!before.content.size && $pos.parent.canReplace(index - 1, index)) {\n    if (dispatch) { dispatch(state.tr.delete($pos.pos - before.nodeSize, $pos.pos).scrollIntoView()); }\n    return true\n  }\n  if (!$pos.parent.canReplace(index, index + 1) || !(after.isTextblock || canJoin(state.doc, $pos.pos)))\n    { return false }\n  if (dispatch)\n    { dispatch(state.tr\n             .clearIncompatible($pos.pos, before.type, before.contentMatchAt(before.childCount))\n             .join($pos.pos)\n             .scrollIntoView()); }\n  return true\n}\n\nfunction deleteBarrier(state, $cut, dispatch) {\n  var before = $cut.nodeBefore, after = $cut.nodeAfter, conn, match;\n  if (before.type.spec.isolating || after.type.spec.isolating) { return false }\n  if (joinMaybeClear(state, $cut, dispatch)) { return true }\n\n  var canDelAfter = $cut.parent.canReplace($cut.index(), $cut.index() + 1);\n  if (canDelAfter &&\n      (conn = (match = before.contentMatchAt(before.childCount)).findWrapping(after.type)) &&\n      match.matchType(conn[0] || after.type).validEnd) {\n    if (dispatch) {\n      var end = $cut.pos + after.nodeSize, wrap = Fragment.empty;\n      for (var i = conn.length - 1; i >= 0; i--)\n        { wrap = Fragment.from(conn[i].create(null, wrap)); }\n      wrap = Fragment.from(before.copy(wrap));\n      var tr = state.tr.step(new ReplaceAroundStep($cut.pos - 1, end, $cut.pos, end, new Slice(wrap, 1, 0), conn.length, true));\n      var joinAt = end + 2 * conn.length;\n      if (canJoin(tr.doc, joinAt)) { tr.join(joinAt); }\n      dispatch(tr.scrollIntoView());\n    }\n    return true\n  }\n\n  var selAfter = Selection.findFrom($cut, 1);\n  var range = selAfter && selAfter.$from.blockRange(selAfter.$to), target = range && liftTarget(range);\n  if (target != null && target >= $cut.depth) {\n    if (dispatch) { dispatch(state.tr.lift(range, target).scrollIntoView()); }\n    return true\n  }\n\n  if (canDelAfter && after.isTextblock && textblockAt(before, \"end\")) {\n    var at = before, wrap$1 = [];\n    for (;;) {\n      wrap$1.push(at);\n      if (at.isTextblock) { break }\n      at = at.lastChild;\n    }\n    if (at.canReplace(at.childCount, at.childCount, after.content)) {\n      if (dispatch) {\n        var end$1 = Fragment.empty;\n        for (var i$1 = wrap$1.length - 1; i$1 >= 0; i$1--) { end$1 = Fragment.from(wrap$1[i$1].copy(end$1)); }\n        var tr$1 = state.tr.step(new ReplaceAroundStep($cut.pos - wrap$1.length, $cut.pos + after.nodeSize,\n                                                     $cut.pos + 1, $cut.pos + after.nodeSize - 1,\n                                                     new Slice(end$1, wrap$1.length, 0), 0, true));\n        dispatch(tr$1.scrollIntoView());\n      }\n      return true\n    }\n  }\n\n  return false\n}\n\n// Parameterized commands\n\n// :: (NodeType, ?Object)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Wrap the selection in a node of the given type with the given\n// attributes.\nfunction wrapIn(nodeType, attrs) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var range = $from.blockRange($to), wrapping = range && findWrapping(range, nodeType, attrs);\n    if (!wrapping) { return false }\n    if (dispatch) { dispatch(state.tr.wrap(range, wrapping).scrollIntoView()); }\n    return true\n  }\n}\n\n// :: (NodeType, ?Object)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Returns a command that tries to set the selected textblocks to the\n// given node type with the given attributes.\nfunction setBlockType(nodeType, attrs) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var from = ref.from;\n    var to = ref.to;\n    var applicable = false;\n    state.doc.nodesBetween(from, to, function (node, pos) {\n      if (applicable) { return false }\n      if (!node.isTextblock || node.hasMarkup(nodeType, attrs)) { return }\n      if (node.type == nodeType) {\n        applicable = true;\n      } else {\n        var $pos = state.doc.resolve(pos), index = $pos.index();\n        applicable = $pos.parent.canReplaceWith(index, index + 1, nodeType);\n      }\n    });\n    if (!applicable) { return false }\n    if (dispatch) { dispatch(state.tr.setBlockType(from, to, nodeType, attrs).scrollIntoView()); }\n    return true\n  }\n}\n\nfunction markApplies(doc, ranges, type) {\n  var loop = function ( i ) {\n    var ref = ranges[i];\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var can = $from.depth == 0 ? doc.type.allowsMarkType(type) : false;\n    doc.nodesBetween($from.pos, $to.pos, function (node) {\n      if (can) { return false }\n      can = node.inlineContent && node.type.allowsMarkType(type);\n    });\n    if (can) { return { v: true } }\n  };\n\n  for (var i = 0; i < ranges.length; i++) {\n    var returned = loop( i );\n\n    if ( returned ) return returned.v;\n  }\n  return false\n}\n\n// :: (MarkType, ?Object)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Create a command function that toggles the given mark with the\n// given attributes. Will return `false` when the current selection\n// doesn't support that mark. This will remove the mark if any marks\n// of that type exist in the selection, or add it otherwise. If the\n// selection is empty, this applies to the [stored\n// marks](#state.EditorState.storedMarks) instead of a range of the\n// document.\nfunction toggleMark(markType, attrs) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var empty = ref.empty;\n    var $cursor = ref.$cursor;\n    var ranges = ref.ranges;\n    if ((empty && !$cursor) || !markApplies(state.doc, ranges, markType)) { return false }\n    if (dispatch) {\n      if ($cursor) {\n        if (markType.isInSet(state.storedMarks || $cursor.marks()))\n          { dispatch(state.tr.removeStoredMark(markType)); }\n        else\n          { dispatch(state.tr.addStoredMark(markType.create(attrs))); }\n      } else {\n        var has = false, tr = state.tr;\n        for (var i = 0; !has && i < ranges.length; i++) {\n          var ref$1 = ranges[i];\n          var $from = ref$1.$from;\n          var $to = ref$1.$to;\n          has = state.doc.rangeHasMark($from.pos, $to.pos, markType);\n        }\n        for (var i$1 = 0; i$1 < ranges.length; i$1++) {\n          var ref$2 = ranges[i$1];\n          var $from$1 = ref$2.$from;\n          var $to$1 = ref$2.$to;\n          if (has) {\n            tr.removeMark($from$1.pos, $to$1.pos, markType);\n          } else {\n            var from = $from$1.pos, to = $to$1.pos, start = $from$1.nodeAfter, end = $to$1.nodeBefore;\n            var spaceStart = start && start.isText ? /^\\s*/.exec(start.text)[0].length : 0;\n            var spaceEnd = end && end.isText ? /\\s*$/.exec(end.text)[0].length : 0;\n            if (from + spaceStart < to) { from += spaceStart; to -= spaceEnd; }\n            tr.addMark(from, to, markType.create(attrs));\n          }\n        }\n        dispatch(tr.scrollIntoView());\n      }\n    }\n    return true\n  }\n}\n\nfunction wrapDispatchForJoin(dispatch, isJoinable) {\n  return function (tr) {\n    if (!tr.isGeneric) { return dispatch(tr) }\n\n    var ranges = [];\n    for (var i = 0; i < tr.mapping.maps.length; i++) {\n      var map = tr.mapping.maps[i];\n      for (var j = 0; j < ranges.length; j++)\n        { ranges[j] = map.map(ranges[j]); }\n      map.forEach(function (_s, _e, from, to) { return ranges.push(from, to); });\n    }\n\n    // Figure out which joinable points exist inside those ranges,\n    // by checking all node boundaries in their parent nodes.\n    var joinable = [];\n    for (var i$1 = 0; i$1 < ranges.length; i$1 += 2) {\n      var from = ranges[i$1], to = ranges[i$1 + 1];\n      var $from = tr.doc.resolve(from), depth = $from.sharedDepth(to), parent = $from.node(depth);\n      for (var index = $from.indexAfter(depth), pos = $from.after(depth + 1); pos <= to; ++index) {\n        var after = parent.maybeChild(index);\n        if (!after) { break }\n        if (index && joinable.indexOf(pos) == -1) {\n          var before = parent.child(index - 1);\n          if (before.type == after.type && isJoinable(before, after))\n            { joinable.push(pos); }\n        }\n        pos += after.nodeSize;\n      }\n    }\n    // Join the joinable points\n    joinable.sort(function (a, b) { return a - b; });\n    for (var i$2 = joinable.length - 1; i$2 >= 0; i$2--) {\n      if (canJoin(tr.doc, joinable[i$2])) { tr.join(joinable[i$2]); }\n    }\n    dispatch(tr);\n  }\n}\n\n// :: ((state: EditorState, ?(tr: Transaction))  bool, union<(before: Node, after: Node)  bool, [string]>)  (state: EditorState, ?(tr: Transaction))  bool\n// Wrap a command so that, when it produces a transform that causes\n// two joinable nodes to end up next to each other, those are joined.\n// Nodes are considered joinable when they are of the same type and\n// when the `isJoinable` predicate returns true for them or, if an\n// array of strings was passed, if their node type name is in that\n// array.\nfunction autoJoin(command, isJoinable) {\n  if (Array.isArray(isJoinable)) {\n    var types = isJoinable;\n    isJoinable = function (node) { return types.indexOf(node.type.name) > -1; };\n  }\n  return function (state, dispatch) { return command(state, dispatch && wrapDispatchForJoin(dispatch, isJoinable)); }\n}\n\n// :: (...[(EditorState, ?(tr: Transaction), ?EditorView)  bool])  (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// Combine a number of command functions into a single function (which\n// calls them one by one until one returns true).\nfunction chainCommands() {\n  var commands = [], len = arguments.length;\n  while ( len-- ) commands[ len ] = arguments[ len ];\n\n  return function(state, dispatch, view) {\n    for (var i = 0; i < commands.length; i++)\n      { if (commands[i](state, dispatch, view)) { return true } }\n    return false\n  }\n}\n\nvar backspace = chainCommands(deleteSelection, joinBackward, selectNodeBackward);\nvar del = chainCommands(deleteSelection, joinForward, selectNodeForward);\n\n// :: Object\n// A basic keymap containing bindings not specific to any schema.\n// Binds the following keys (when multiple commands are listed, they\n// are chained with [`chainCommands`](#commands.chainCommands)):\n//\n// * **Enter** to `newlineInCode`, `createParagraphNear`, `liftEmptyBlock`, `splitBlock`\n// * **Mod-Enter** to `exitCode`\n// * **Backspace** and **Mod-Backspace** to `deleteSelection`, `joinBackward`, `selectNodeBackward`\n// * **Delete** and **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-a** to `selectAll`\nvar pcBaseKeymap = {\n  \"Enter\": chainCommands(newlineInCode, createParagraphNear, liftEmptyBlock, splitBlock),\n  \"Mod-Enter\": exitCode,\n  \"Backspace\": backspace,\n  \"Mod-Backspace\": backspace,\n  \"Delete\": del,\n  \"Mod-Delete\": del,\n  \"Mod-a\": selectAll\n};\n\n// :: Object\n// A copy of `pcBaseKeymap` that also binds **Ctrl-h** like Backspace,\n// **Ctrl-d** like Delete, **Alt-Backspace** like Ctrl-Backspace, and\n// **Ctrl-Alt-Backspace**, **Alt-Delete**, and **Alt-d** like\n// Ctrl-Delete.\nvar macBaseKeymap = {\n  \"Ctrl-h\": pcBaseKeymap[\"Backspace\"],\n  \"Alt-Backspace\": pcBaseKeymap[\"Mod-Backspace\"],\n  \"Ctrl-d\": pcBaseKeymap[\"Delete\"],\n  \"Ctrl-Alt-Backspace\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-Delete\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-d\": pcBaseKeymap[\"Mod-Delete\"]\n};\nfor (var key in pcBaseKeymap) { macBaseKeymap[key] = pcBaseKeymap[key]; }\n\n// declare global: os, navigator\nvar mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform)\n          : typeof os != \"undefined\" ? os.platform() == \"darwin\" : false;\n\n// :: Object\n// Depending on the detected platform, this will hold\n// [`pcBasekeymap`](#commands.pcBaseKeymap) or\n// [`macBaseKeymap`](#commands.macBaseKeymap).\nvar baseKeymap = mac ? macBaseKeymap : pcBaseKeymap;\n\nexport { autoJoin, baseKeymap, chainCommands, createParagraphNear, deleteSelection, exitCode, joinBackward, joinDown, joinForward, joinUp, lift, liftEmptyBlock, macBaseKeymap, newlineInCode, pcBaseKeymap, selectAll, selectNodeBackward, selectNodeForward, selectParentNode, setBlockType, splitBlock, splitBlockKeepMarks, toggleMark, wrapIn };\n//# sourceMappingURL=index.es.js.map\n","import { ReplaceError, Slice, Fragment, MarkType } from 'prosemirror-model';\n\n// Mappable:: interface\n// There are several things that positions can be mapped through.\n// Such objects conform to this interface.\n//\n//   map:: (pos: number, assoc: ?number)  number\n//   Map a position through this object. When given, `assoc` (should\n//   be -1 or 1, defaults to 1) determines with which side the\n//   position is associated, which determines in which direction to\n//   move when a chunk of content is inserted at the mapped position.\n//\n//   mapResult:: (pos: number, assoc: ?number)  MapResult\n//   Map a position, and return an object containing additional\n//   information about the mapping. The result's `deleted` field tells\n//   you whether the position was deleted (completely enclosed in a\n//   replaced range) during the mapping. When content on only one side\n//   is deleted, the position itself is only considered deleted when\n//   `assoc` points in the direction of the deleted content.\n\n// Recovery values encode a range index and an offset. They are\n// represented as numbers, because tons of them will be created when\n// mapping, for example, a large number of decorations. The number's\n// lower 16 bits provide the index, the remaining bits the offset.\n//\n// Note: We intentionally don't use bit shift operators to en- and\n// decode these, since those clip to 32 bits, which we might in rare\n// cases want to overflow. A 64-bit float can represent 48-bit\n// integers precisely.\n\nvar lower16 = 0xffff;\nvar factor16 = Math.pow(2, 16);\n\nfunction makeRecover(index, offset) { return index + offset * factor16 }\nfunction recoverIndex(value) { return value & lower16 }\nfunction recoverOffset(value) { return (value - (value & lower16)) / factor16 }\n\n// ::- An object representing a mapped position with extra\n// information.\nvar MapResult = function MapResult(pos, deleted, recover) {\n  if ( deleted === void 0 ) deleted = false;\n  if ( recover === void 0 ) recover = null;\n\n  // :: number The mapped version of the position.\n  this.pos = pos;\n  // :: bool Tells you whether the position was deleted, that is,\n  // whether the step removed its surroundings from the document.\n  this.deleted = deleted;\n  this.recover = recover;\n};\n\n// :: class extends Mappable\n// A map describing the deletions and insertions made by a step, which\n// can be used to find the correspondence between positions in the\n// pre-step version of a document and the same position in the\n// post-step version.\nvar StepMap = function StepMap(ranges, inverted) {\n  if ( inverted === void 0 ) inverted = false;\n\n  this.ranges = ranges;\n  this.inverted = inverted;\n};\n\nStepMap.prototype.recover = function recover (value) {\n  var diff = 0, index = recoverIndex(value);\n  if (!this.inverted) { for (var i = 0; i < index; i++)\n    { diff += this.ranges[i * 3 + 2] - this.ranges[i * 3 + 1]; } }\n  return this.ranges[index * 3] + diff + recoverOffset(value)\n};\n\n// : (number, ?number)  MapResult\nStepMap.prototype.mapResult = function mapResult (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, false) };\n\n// : (number, ?number)  number\nStepMap.prototype.map = function map (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, true) };\n\nStepMap.prototype._map = function _map (pos, assoc, simple) {\n  var diff = 0, oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i] - (this.inverted ? diff : 0);\n    if (start > pos) { break }\n    var oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex], end = start + oldSize;\n    if (pos <= end) {\n      var side = !oldSize ? assoc : pos == start ? -1 : pos == end ? 1 : assoc;\n      var result = start + diff + (side < 0 ? 0 : newSize);\n      if (simple) { return result }\n      var recover = pos == (assoc < 0 ? start : end) ? null : makeRecover(i / 3, pos - start);\n      return new MapResult(result, assoc < 0 ? pos != start : pos != end, recover)\n    }\n    diff += newSize - oldSize;\n  }\n  return simple ? pos + diff : new MapResult(pos + diff)\n};\n\nStepMap.prototype.touches = function touches (pos, recover) {\n  var diff = 0, index = recoverIndex(recover);\n  var oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i] - (this.inverted ? diff : 0);\n    if (start > pos) { break }\n    var oldSize = this.ranges[i + oldIndex], end = start + oldSize;\n    if (pos <= end && i == index * 3) { return true }\n    diff += this.ranges[i + newIndex] - oldSize;\n  }\n  return false\n};\n\n// :: ((oldStart: number, oldEnd: number, newStart: number, newEnd: number))\n// Calls the given function on each of the changed ranges included in\n// this map.\nStepMap.prototype.forEach = function forEach (f) {\n  var oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0, diff = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i], oldStart = start - (this.inverted ? diff : 0), newStart = start + (this.inverted ? 0 : diff);\n    var oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex];\n    f(oldStart, oldStart + oldSize, newStart, newStart + newSize);\n    diff += newSize - oldSize;\n  }\n};\n\n// :: ()  StepMap\n// Create an inverted version of this map. The result can be used to\n// map positions in the post-step document to the pre-step document.\nStepMap.prototype.invert = function invert () {\n  return new StepMap(this.ranges, !this.inverted)\n};\n\nStepMap.prototype.toString = function toString () {\n  return (this.inverted ? \"-\" : \"\") + JSON.stringify(this.ranges)\n};\n\n// :: (n: number)  StepMap\n// Create a map that moves all positions by offset `n` (which may be\n// negative). This can be useful when applying steps meant for a\n// sub-document to a larger document, or vice-versa.\nStepMap.offset = function offset (n) {\n  return n == 0 ? StepMap.empty : new StepMap(n < 0 ? [0, -n, 0] : [0, 0, n])\n};\n\nStepMap.empty = new StepMap([]);\n\n// :: class extends Mappable\n// A mapping represents a pipeline of zero or more [step\n// maps](#transform.StepMap). It has special provisions for losslessly\n// handling mapping positions through a series of steps in which some\n// steps are inverted versions of earlier steps. (This comes up when\n// [rebasing](/docs/guide/#transform.rebasing) steps for\n// collaboration or history management.)\nvar Mapping = function Mapping(maps, mirror, from, to) {\n  // :: [StepMap]\n  // The step maps in this mapping.\n  this.maps = maps || [];\n  // :: number\n  // The starting position in the `maps` array, used when `map` or\n  // `mapResult` is called.\n  this.from = from || 0;\n  // :: number\n  // The end position in the `maps` array.\n  this.to = to == null ? this.maps.length : to;\n  this.mirror = mirror;\n};\n\n// :: (?number, ?number)  Mapping\n// Create a mapping that maps only through a part of this one.\nMapping.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.maps.length;\n\n  return new Mapping(this.maps, this.mirror, from, to)\n};\n\nMapping.prototype.copy = function copy () {\n  return new Mapping(this.maps.slice(), this.mirror && this.mirror.slice(), this.from, this.to)\n};\n\n// :: (StepMap, ?number)\n// Add a step map to the end of this mapping. If `mirrors` is\n// given, it should be the index of the step map that is the mirror\n// image of this one.\nMapping.prototype.appendMap = function appendMap (map, mirrors) {\n  this.to = this.maps.push(map);\n  if (mirrors != null) { this.setMirror(this.maps.length - 1, mirrors); }\n};\n\n// :: (Mapping)\n// Add all the step maps in a given mapping to this one (preserving\n// mirroring information).\nMapping.prototype.appendMapping = function appendMapping (mapping) {\n  for (var i = 0, startSize = this.maps.length; i < mapping.maps.length; i++) {\n    var mirr = mapping.getMirror(i);\n    this.appendMap(mapping.maps[i], mirr != null && mirr < i ? startSize + mirr : null);\n  }\n};\n\n// :: (number)  ?number\n// Finds the offset of the step map that mirrors the map at the\n// given offset, in this mapping (as per the second argument to\n// `appendMap`).\nMapping.prototype.getMirror = function getMirror (n) {\n  if (this.mirror) { for (var i = 0; i < this.mirror.length; i++)\n    { if (this.mirror[i] == n) { return this.mirror[i + (i % 2 ? -1 : 1)] } } }\n};\n\nMapping.prototype.setMirror = function setMirror (n, m) {\n  if (!this.mirror) { this.mirror = []; }\n  this.mirror.push(n, m);\n};\n\n// :: (Mapping)\n// Append the inverse of the given mapping to this one.\nMapping.prototype.appendMappingInverted = function appendMappingInverted (mapping) {\n  for (var i = mapping.maps.length - 1, totalSize = this.maps.length + mapping.maps.length; i >= 0; i--) {\n    var mirr = mapping.getMirror(i);\n    this.appendMap(mapping.maps[i].invert(), mirr != null && mirr > i ? totalSize - mirr - 1 : null);\n  }\n};\n\n// :: ()  Mapping\n// Create an inverted version of this mapping.\nMapping.prototype.invert = function invert () {\n  var inverse = new Mapping;\n  inverse.appendMappingInverted(this);\n  return inverse\n};\n\n// : (number, ?number)  number\n// Map a position through this mapping.\nMapping.prototype.map = function map (pos, assoc) {\n    if ( assoc === void 0 ) assoc = 1;\n\n  if (this.mirror) { return this._map(pos, assoc, true) }\n  for (var i = this.from; i < this.to; i++)\n    { pos = this.maps[i].map(pos, assoc); }\n  return pos\n};\n\n// : (number, ?number)  MapResult\n// Map a position through this mapping, returning a mapping\n// result.\nMapping.prototype.mapResult = function mapResult (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, false) };\n\nMapping.prototype._map = function _map (pos, assoc, simple) {\n  var deleted = false;\n\n  for (var i = this.from; i < this.to; i++) {\n    var map = this.maps[i], result = map.mapResult(pos, assoc);\n    if (result.recover != null) {\n      var corr = this.getMirror(i);\n      if (corr != null && corr > i && corr < this.to) {\n        i = corr;\n        pos = this.maps[corr].recover(result.recover);\n        continue\n      }\n    }\n\n    if (result.deleted) { deleted = true; }\n    pos = result.pos;\n  }\n\n  return simple ? pos : new MapResult(pos, deleted)\n};\n\nfunction TransformError(message) {\n  var err = Error.call(this, message);\n  err.__proto__ = TransformError.prototype;\n  return err\n}\n\nTransformError.prototype = Object.create(Error.prototype);\nTransformError.prototype.constructor = TransformError;\nTransformError.prototype.name = \"TransformError\";\n\n// ::- Abstraction to build up and track an array of\n// [steps](#transform.Step) representing a document transformation.\n//\n// Most transforming methods return the `Transform` object itself, so\n// that they can be chained.\nvar Transform = function Transform(doc) {\n  // :: Node\n  // The current document (the result of applying the steps in the\n  // transform).\n  this.doc = doc;\n  // :: [Step]\n  // The steps in this transform.\n  this.steps = [];\n  // :: [Node]\n  // The documents before each of the steps.\n  this.docs = [];\n  // :: Mapping\n  // A mapping with the maps for each of the steps in this transform.\n  this.mapping = new Mapping;\n};\n\nvar prototypeAccessors = { before: { configurable: true },docChanged: { configurable: true } };\n\n// :: Node The starting document.\nprototypeAccessors.before.get = function () { return this.docs.length ? this.docs[0] : this.doc };\n\n// :: (step: Step)  this\n// Apply a new step in this transform, saving the result. Throws an\n// error when the step fails.\nTransform.prototype.step = function step (object) {\n  var result = this.maybeStep(object);\n  if (result.failed) { throw new TransformError(result.failed) }\n  return this\n};\n\n// :: (Step)  StepResult\n// Try to apply a step in this transformation, ignoring it if it\n// fails. Returns the step result.\nTransform.prototype.maybeStep = function maybeStep (step) {\n  var result = step.apply(this.doc);\n  if (!result.failed) { this.addStep(step, result.doc); }\n  return result\n};\n\n// :: bool\n// True when the document has been changed (when there are any\n// steps).\nprototypeAccessors.docChanged.get = function () {\n  return this.steps.length > 0\n};\n\nTransform.prototype.addStep = function addStep (step, doc) {\n  this.docs.push(this.doc);\n  this.steps.push(step);\n  this.mapping.appendMap(step.getMap());\n  this.doc = doc;\n};\n\nObject.defineProperties( Transform.prototype, prototypeAccessors );\n\nfunction mustOverride() { throw new Error(\"Override me\") }\n\nvar stepsByID = Object.create(null);\n\n// ::- A step object represents an atomic change. It generally applies\n// only to the document it was created for, since the positions\n// stored in it will only make sense for that document.\n//\n// New steps are defined by creating classes that extend `Step`,\n// overriding the `apply`, `invert`, `map`, `getMap` and `fromJSON`\n// methods, and registering your class with a unique\n// JSON-serialization identifier using\n// [`Step.jsonID`](#transform.Step^jsonID).\nvar Step = function Step () {};\n\nStep.prototype.apply = function apply (_doc) { return mustOverride() };\n\n// :: ()  StepMap\n// Get the step map that represents the changes made by this step,\n// and which can be used to transform between positions in the old\n// and the new document.\nStep.prototype.getMap = function getMap () { return StepMap.empty };\n\n// :: (doc: Node)  Step\n// Create an inverted version of this step. Needs the document as it\n// was before the step as argument.\nStep.prototype.invert = function invert (_doc) { return mustOverride() };\n\n// :: (mapping: Mappable)  ?Step\n// Map this step through a mappable thing, returning either a\n// version of that step with its positions adjusted, or `null` if\n// the step was entirely deleted by the mapping.\nStep.prototype.map = function map (_mapping) { return mustOverride() };\n\n// :: (other: Step)  ?Step\n// Try to merge this step with another one, to be applied directly\n// after it. Returns the merged step when possible, null if the\n// steps can't be merged.\nStep.prototype.merge = function merge (_other) { return null };\n\n// :: ()  Object\n// Create a JSON-serializeable representation of this step. When\n// defining this for a custom subclass, make sure the result object\n// includes the step type's [JSON id](#transform.Step^jsonID) under\n// the `stepType` property.\nStep.prototype.toJSON = function toJSON () { return mustOverride() };\n\n// :: (Schema, Object)  Step\n// Deserialize a step from its JSON representation. Will call\n// through to the step class' own implementation of this method.\nStep.fromJSON = function fromJSON (schema, json) {\n  if (!json || !json.stepType) { throw new RangeError(\"Invalid input for Step.fromJSON\") }\n  var type = stepsByID[json.stepType];\n  if (!type) { throw new RangeError((\"No step type \" + (json.stepType) + \" defined\")) }\n  return type.fromJSON(schema, json)\n};\n\n// :: (string, constructor<Step>)\n// To be able to serialize steps to JSON, each step needs a string\n// ID to attach to its JSON representation. Use this method to\n// register an ID for your step classes. Try to pick something\n// that's unlikely to clash with steps from other modules.\nStep.jsonID = function jsonID (id, stepClass) {\n  if (id in stepsByID) { throw new RangeError(\"Duplicate use of step JSON ID \" + id) }\n  stepsByID[id] = stepClass;\n  stepClass.prototype.jsonID = id;\n  return stepClass\n};\n\n// ::- The result of [applying](#transform.Step.apply) a step. Contains either a\n// new document or a failure value.\nvar StepResult = function StepResult(doc, failed) {\n  // :: ?Node The transformed document.\n  this.doc = doc;\n  // :: ?string Text providing information about a failed step.\n  this.failed = failed;\n};\n\n// :: (Node)  StepResult\n// Create a successful step result.\nStepResult.ok = function ok (doc) { return new StepResult(doc, null) };\n\n// :: (string)  StepResult\n// Create a failed step result.\nStepResult.fail = function fail (message) { return new StepResult(null, message) };\n\n// :: (Node, number, number, Slice)  StepResult\n// Call [`Node.replace`](#model.Node.replace) with the given\n// arguments. Create a successful result if it succeeds, and a\n// failed one if it throws a `ReplaceError`.\nStepResult.fromReplace = function fromReplace (doc, from, to, slice) {\n  try {\n    return StepResult.ok(doc.replace(from, to, slice))\n  } catch (e) {\n    if (e instanceof ReplaceError) { return StepResult.fail(e.message) }\n    throw e\n  }\n};\n\n// ::- Replace a part of the document with a slice of new content.\nvar ReplaceStep = /*@__PURE__*/(function (Step) {\n  function ReplaceStep(from, to, slice, structure) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.slice = slice;\n    this.structure = !!structure;\n  }\n\n  if ( Step ) ReplaceStep.__proto__ = Step;\n  ReplaceStep.prototype = Object.create( Step && Step.prototype );\n  ReplaceStep.prototype.constructor = ReplaceStep;\n\n  ReplaceStep.prototype.apply = function apply (doc) {\n    if (this.structure && contentBetween(doc, this.from, this.to))\n      { return StepResult.fail(\"Structure replace would overwrite content\") }\n    return StepResult.fromReplace(doc, this.from, this.to, this.slice)\n  };\n\n  ReplaceStep.prototype.getMap = function getMap () {\n    return new StepMap([this.from, this.to - this.from, this.slice.size])\n  };\n\n  ReplaceStep.prototype.invert = function invert (doc) {\n    return new ReplaceStep(this.from, this.from + this.slice.size, doc.slice(this.from, this.to))\n  };\n\n  ReplaceStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted) { return null }\n    return new ReplaceStep(from.pos, Math.max(from.pos, to.pos), this.slice)\n  };\n\n  ReplaceStep.prototype.merge = function merge (other) {\n    if (!(other instanceof ReplaceStep) || other.structure != this.structure) { return null }\n\n    if (this.from + this.slice.size == other.from && !this.slice.openEnd && !other.slice.openStart) {\n      var slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(this.slice.content.append(other.slice.content), this.slice.openStart, other.slice.openEnd);\n      return new ReplaceStep(this.from, this.to + (other.to - other.from), slice, this.structure)\n    } else if (other.to == this.from && !this.slice.openStart && !other.slice.openEnd) {\n      var slice$1 = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(other.slice.content.append(this.slice.content), other.slice.openStart, this.slice.openEnd);\n      return new ReplaceStep(other.from, this.to, slice$1, this.structure)\n    } else {\n      return null\n    }\n  };\n\n  ReplaceStep.prototype.toJSON = function toJSON () {\n    var json = {stepType: \"replace\", from: this.from, to: this.to};\n    if (this.slice.size) { json.slice = this.slice.toJSON(); }\n    if (this.structure) { json.structure = true; }\n    return json\n  };\n\n  ReplaceStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for ReplaceStep.fromJSON\") }\n    return new ReplaceStep(json.from, json.to, Slice.fromJSON(schema, json.slice), !!json.structure)\n  };\n\n  return ReplaceStep;\n}(Step));\n\nStep.jsonID(\"replace\", ReplaceStep);\n\n// ::- Replace a part of the document with a slice of content, but\n// preserve a range of the replaced content by moving it into the\n// slice.\nvar ReplaceAroundStep = /*@__PURE__*/(function (Step) {\n  function ReplaceAroundStep(from, to, gapFrom, gapTo, slice, insert, structure) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.gapFrom = gapFrom;\n    this.gapTo = gapTo;\n    this.slice = slice;\n    this.insert = insert;\n    this.structure = !!structure;\n  }\n\n  if ( Step ) ReplaceAroundStep.__proto__ = Step;\n  ReplaceAroundStep.prototype = Object.create( Step && Step.prototype );\n  ReplaceAroundStep.prototype.constructor = ReplaceAroundStep;\n\n  ReplaceAroundStep.prototype.apply = function apply (doc) {\n    if (this.structure && (contentBetween(doc, this.from, this.gapFrom) ||\n                           contentBetween(doc, this.gapTo, this.to)))\n      { return StepResult.fail(\"Structure gap-replace would overwrite content\") }\n\n    var gap = doc.slice(this.gapFrom, this.gapTo);\n    if (gap.openStart || gap.openEnd)\n      { return StepResult.fail(\"Gap is not a flat range\") }\n    var inserted = this.slice.insertAt(this.insert, gap.content);\n    if (!inserted) { return StepResult.fail(\"Content does not fit in gap\") }\n    return StepResult.fromReplace(doc, this.from, this.to, inserted)\n  };\n\n  ReplaceAroundStep.prototype.getMap = function getMap () {\n    return new StepMap([this.from, this.gapFrom - this.from, this.insert,\n                        this.gapTo, this.to - this.gapTo, this.slice.size - this.insert])\n  };\n\n  ReplaceAroundStep.prototype.invert = function invert (doc) {\n    var gap = this.gapTo - this.gapFrom;\n    return new ReplaceAroundStep(this.from, this.from + this.slice.size + gap,\n                                 this.from + this.insert, this.from + this.insert + gap,\n                                 doc.slice(this.from, this.to).removeBetween(this.gapFrom - this.from, this.gapTo - this.from),\n                                 this.gapFrom - this.from, this.structure)\n  };\n\n  ReplaceAroundStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    var gapFrom = mapping.map(this.gapFrom, -1), gapTo = mapping.map(this.gapTo, 1);\n    if ((from.deleted && to.deleted) || gapFrom < from.pos || gapTo > to.pos) { return null }\n    return new ReplaceAroundStep(from.pos, to.pos, gapFrom, gapTo, this.slice, this.insert, this.structure)\n  };\n\n  ReplaceAroundStep.prototype.toJSON = function toJSON () {\n    var json = {stepType: \"replaceAround\", from: this.from, to: this.to,\n                gapFrom: this.gapFrom, gapTo: this.gapTo, insert: this.insert};\n    if (this.slice.size) { json.slice = this.slice.toJSON(); }\n    if (this.structure) { json.structure = true; }\n    return json\n  };\n\n  ReplaceAroundStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\" ||\n        typeof json.gapFrom != \"number\" || typeof json.gapTo != \"number\" || typeof json.insert != \"number\")\n      { throw new RangeError(\"Invalid input for ReplaceAroundStep.fromJSON\") }\n    return new ReplaceAroundStep(json.from, json.to, json.gapFrom, json.gapTo,\n                                 Slice.fromJSON(schema, json.slice), json.insert, !!json.structure)\n  };\n\n  return ReplaceAroundStep;\n}(Step));\n\nStep.jsonID(\"replaceAround\", ReplaceAroundStep);\n\nfunction contentBetween(doc, from, to) {\n  var $from = doc.resolve(from), dist = to - from, depth = $from.depth;\n  while (dist > 0 && depth > 0 && $from.indexAfter(depth) == $from.node(depth).childCount) {\n    depth--;\n    dist--;\n  }\n  if (dist > 0) {\n    var next = $from.node(depth).maybeChild($from.indexAfter(depth));\n    while (dist > 0) {\n      if (!next || next.isLeaf) { return true }\n      next = next.firstChild;\n      dist--;\n    }\n  }\n  return false\n}\n\nfunction canCut(node, start, end) {\n  return (start == 0 || node.canReplace(start, node.childCount)) &&\n    (end == node.childCount || node.canReplace(0, end))\n}\n\n// :: (NodeRange)  ?number\n// Try to find a target depth to which the content in the given range\n// can be lifted. Will not go across\n// [isolating](#model.NodeSpec.isolating) parent nodes.\nfunction liftTarget(range) {\n  var parent = range.parent;\n  var content = parent.content.cutByIndex(range.startIndex, range.endIndex);\n  for (var depth = range.depth;; --depth) {\n    var node = range.$from.node(depth);\n    var index = range.$from.index(depth), endIndex = range.$to.indexAfter(depth);\n    if (depth < range.depth && node.canReplace(index, endIndex, content))\n      { return depth }\n    if (depth == 0 || node.type.spec.isolating || !canCut(node, index, endIndex)) { break }\n  }\n}\n\n// :: (NodeRange, number)  this\n// Split the content in the given range off from its parent, if there\n// is sibling content before or after it, and move it up the tree to\n// the depth specified by `target`. You'll probably want to use\n// [`liftTarget`](#transform.liftTarget) to compute `target`, to make\n// sure the lift is valid.\nTransform.prototype.lift = function(range, target) {\n  var $from = range.$from;\n  var $to = range.$to;\n  var depth = range.depth;\n\n  var gapStart = $from.before(depth + 1), gapEnd = $to.after(depth + 1);\n  var start = gapStart, end = gapEnd;\n\n  var before = Fragment.empty, openStart = 0;\n  for (var d = depth, splitting = false; d > target; d--)\n    { if (splitting || $from.index(d) > 0) {\n      splitting = true;\n      before = Fragment.from($from.node(d).copy(before));\n      openStart++;\n    } else {\n      start--;\n    } }\n  var after = Fragment.empty, openEnd = 0;\n  for (var d$1 = depth, splitting$1 = false; d$1 > target; d$1--)\n    { if (splitting$1 || $to.after(d$1 + 1) < $to.end(d$1)) {\n      splitting$1 = true;\n      after = Fragment.from($to.node(d$1).copy(after));\n      openEnd++;\n    } else {\n      end++;\n    } }\n\n  return this.step(new ReplaceAroundStep(start, end, gapStart, gapEnd,\n                                         new Slice(before.append(after), openStart, openEnd),\n                                         before.size - openStart, true))\n};\n\n// :: (NodeRange, NodeType, ?Object, ?NodeRange)  ?[{type: NodeType, attrs: ?Object}]\n// Try to find a valid way to wrap the content in the given range in a\n// node of the given type. May introduce extra nodes around and inside\n// the wrapper node, if necessary. Returns null if no valid wrapping\n// could be found. When `innerRange` is given, that range's content is\n// used as the content to fit into the wrapping, instead of the\n// content of `range`.\nfunction findWrapping(range, nodeType, attrs, innerRange) {\n  if ( innerRange === void 0 ) innerRange = range;\n\n  var around = findWrappingOutside(range, nodeType);\n  var inner = around && findWrappingInside(innerRange, nodeType);\n  if (!inner) { return null }\n  return around.map(withAttrs).concat({type: nodeType, attrs: attrs}).concat(inner.map(withAttrs))\n}\n\nfunction withAttrs(type) { return {type: type, attrs: null} }\n\nfunction findWrappingOutside(range, type) {\n  var parent = range.parent;\n  var startIndex = range.startIndex;\n  var endIndex = range.endIndex;\n  var around = parent.contentMatchAt(startIndex).findWrapping(type);\n  if (!around) { return null }\n  var outer = around.length ? around[0] : type;\n  return parent.canReplaceWith(startIndex, endIndex, outer) ? around : null\n}\n\nfunction findWrappingInside(range, type) {\n  var parent = range.parent;\n  var startIndex = range.startIndex;\n  var endIndex = range.endIndex;\n  var inner = parent.child(startIndex);\n  var inside = type.contentMatch.findWrapping(inner.type);\n  if (!inside) { return null }\n  var lastType = inside.length ? inside[inside.length - 1] : type;\n  var innerMatch = lastType.contentMatch;\n  for (var i = startIndex; innerMatch && i < endIndex; i++)\n    { innerMatch = innerMatch.matchType(parent.child(i).type); }\n  if (!innerMatch || !innerMatch.validEnd) { return null }\n  return inside\n}\n\n// :: (NodeRange, [{type: NodeType, attrs: ?Object}])  this\n// Wrap the given [range](#model.NodeRange) in the given set of wrappers.\n// The wrappers are assumed to be valid in this position, and should\n// probably be computed with [`findWrapping`](#transform.findWrapping).\nTransform.prototype.wrap = function(range, wrappers) {\n  var content = Fragment.empty;\n  for (var i = wrappers.length - 1; i >= 0; i--)\n    { content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content)); }\n\n  var start = range.start, end = range.end;\n  return this.step(new ReplaceAroundStep(start, end, start, end, new Slice(content, 0, 0), wrappers.length, true))\n};\n\n// :: (number, ?number, NodeType, ?Object)  this\n// Set the type of all textblocks (partly) between `from` and `to` to\n// the given node type with the given attributes.\nTransform.prototype.setBlockType = function(from, to, type, attrs) {\n  var this$1 = this;\n  if ( to === void 0 ) to = from;\n\n  if (!type.isTextblock) { throw new RangeError(\"Type given to setBlockType should be a textblock\") }\n  var mapFrom = this.steps.length;\n  this.doc.nodesBetween(from, to, function (node, pos) {\n    if (node.isTextblock && !node.hasMarkup(type, attrs) && canChangeType(this$1.doc, this$1.mapping.slice(mapFrom).map(pos), type)) {\n      // Ensure all markup that isn't allowed in the new node type is cleared\n      this$1.clearIncompatible(this$1.mapping.slice(mapFrom).map(pos, 1), type);\n      var mapping = this$1.mapping.slice(mapFrom);\n      var startM = mapping.map(pos, 1), endM = mapping.map(pos + node.nodeSize, 1);\n      this$1.step(new ReplaceAroundStep(startM, endM, startM + 1, endM - 1,\n                                      new Slice(Fragment.from(type.create(attrs, null, node.marks)), 0, 0), 1, true));\n      return false\n    }\n  });\n  return this\n};\n\nfunction canChangeType(doc, pos, type) {\n  var $pos = doc.resolve(pos), index = $pos.index();\n  return $pos.parent.canReplaceWith(index, index + 1, type)\n}\n\n// :: (number, ?NodeType, ?Object, ?[Mark])  this\n// Change the type, attributes, and/or marks of the node at `pos`.\n// When `type` isn't given, the existing node type is preserved,\nTransform.prototype.setNodeMarkup = function(pos, type, attrs, marks) {\n  var node = this.doc.nodeAt(pos);\n  if (!node) { throw new RangeError(\"No node at given position\") }\n  if (!type) { type = node.type; }\n  var newNode = type.create(attrs, null, marks || node.marks);\n  if (node.isLeaf)\n    { return this.replaceWith(pos, pos + node.nodeSize, newNode) }\n\n  if (!type.validContent(node.content))\n    { throw new RangeError(\"Invalid content for node type \" + type.name) }\n\n  return this.step(new ReplaceAroundStep(pos, pos + node.nodeSize, pos + 1, pos + node.nodeSize - 1,\n                                         new Slice(Fragment.from(newNode), 0, 0), 1, true))\n};\n\n// :: (Node, number, number, ?[?{type: NodeType, attrs: ?Object}])  bool\n// Check whether splitting at the given position is allowed.\nfunction canSplit(doc, pos, depth, typesAfter) {\n  if ( depth === void 0 ) depth = 1;\n\n  var $pos = doc.resolve(pos), base = $pos.depth - depth;\n  var innerType = (typesAfter && typesAfter[typesAfter.length - 1]) || $pos.parent;\n  if (base < 0 || $pos.parent.type.spec.isolating ||\n      !$pos.parent.canReplace($pos.index(), $pos.parent.childCount) ||\n      !innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(), $pos.parent.childCount)))\n    { return false }\n  for (var d = $pos.depth - 1, i = depth - 2; d > base; d--, i--) {\n    var node = $pos.node(d), index$1 = $pos.index(d);\n    if (node.type.spec.isolating) { return false }\n    var rest = node.content.cutByIndex(index$1, node.childCount);\n    var after = (typesAfter && typesAfter[i]) || node;\n    if (after != node) { rest = rest.replaceChild(0, after.type.create(after.attrs)); }\n    if (!node.canReplace(index$1 + 1, node.childCount) || !after.type.validContent(rest))\n      { return false }\n  }\n  var index = $pos.indexAfter(base);\n  var baseType = typesAfter && typesAfter[0];\n  return $pos.node(base).canReplaceWith(index, index, baseType ? baseType.type : $pos.node(base + 1).type)\n}\n\n// :: (number, ?number, ?[?{type: NodeType, attrs: ?Object}])  this\n// Split the node at the given position, and optionally, if `depth` is\n// greater than one, any number of nodes above that. By default, the\n// parts split off will inherit the node type of the original node.\n// This can be changed by passing an array of types and attributes to\n// use after the split.\nTransform.prototype.split = function(pos, depth, typesAfter) {\n  if ( depth === void 0 ) depth = 1;\n\n  var $pos = this.doc.resolve(pos), before = Fragment.empty, after = Fragment.empty;\n  for (var d = $pos.depth, e = $pos.depth - depth, i = depth - 1; d > e; d--, i--) {\n    before = Fragment.from($pos.node(d).copy(before));\n    var typeAfter = typesAfter && typesAfter[i];\n    after = Fragment.from(typeAfter ? typeAfter.type.create(typeAfter.attrs, after) : $pos.node(d).copy(after));\n  }\n  return this.step(new ReplaceStep(pos, pos, new Slice(before.append(after), depth, depth), true))\n};\n\n// :: (Node, number)  bool\n// Test whether the blocks before and after a given position can be\n// joined.\nfunction canJoin(doc, pos) {\n  var $pos = doc.resolve(pos), index = $pos.index();\n  return joinable($pos.nodeBefore, $pos.nodeAfter) &&\n    $pos.parent.canReplace(index, index + 1)\n}\n\nfunction joinable(a, b) {\n  return a && b && !a.isLeaf && a.canAppend(b)\n}\n\n// :: (Node, number, ?number)  ?number\n// Find an ancestor of the given position that can be joined to the\n// block before (or after if `dir` is positive). Returns the joinable\n// point, if any.\nfunction joinPoint(doc, pos, dir) {\n  if ( dir === void 0 ) dir = -1;\n\n  var $pos = doc.resolve(pos);\n  for (var d = $pos.depth;; d--) {\n    var before = (void 0), after = (void 0), index = $pos.index(d);\n    if (d == $pos.depth) {\n      before = $pos.nodeBefore;\n      after = $pos.nodeAfter;\n    } else if (dir > 0) {\n      before = $pos.node(d + 1);\n      index++;\n      after = $pos.node(d).maybeChild(index);\n    } else {\n      before = $pos.node(d).maybeChild(index - 1);\n      after = $pos.node(d + 1);\n    }\n    if (before && !before.isTextblock && joinable(before, after) &&\n        $pos.node(d).canReplace(index, index + 1)) { return pos }\n    if (d == 0) { break }\n    pos = dir < 0 ? $pos.before(d) : $pos.after(d);\n  }\n}\n\n// :: (number, ?number)  this\n// Join the blocks around the given position. If depth is 2, their\n// last and first siblings are also joined, and so on.\nTransform.prototype.join = function(pos, depth) {\n  if ( depth === void 0 ) depth = 1;\n\n  var step = new ReplaceStep(pos - depth, pos + depth, Slice.empty, true);\n  return this.step(step)\n};\n\n// :: (Node, number, NodeType)  ?number\n// Try to find a point where a node of the given type can be inserted\n// near `pos`, by searching up the node hierarchy when `pos` itself\n// isn't a valid place but is at the start or end of a node. Return\n// null if no position was found.\nfunction insertPoint(doc, pos, nodeType) {\n  var $pos = doc.resolve(pos);\n  if ($pos.parent.canReplaceWith($pos.index(), $pos.index(), nodeType)) { return pos }\n\n  if ($pos.parentOffset == 0)\n    { for (var d = $pos.depth - 1; d >= 0; d--) {\n      var index = $pos.index(d);\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) { return $pos.before(d + 1) }\n      if (index > 0) { return null }\n    } }\n  if ($pos.parentOffset == $pos.parent.content.size)\n    { for (var d$1 = $pos.depth - 1; d$1 >= 0; d$1--) {\n      var index$1 = $pos.indexAfter(d$1);\n      if ($pos.node(d$1).canReplaceWith(index$1, index$1, nodeType)) { return $pos.after(d$1 + 1) }\n      if (index$1 < $pos.node(d$1).childCount) { return null }\n    } }\n}\n\n// :: (Node, number, Slice)  ?number\n// Finds a position at or around the given position where the given\n// slice can be inserted. Will look at parent nodes' nearest boundary\n// and try there, even if the original position wasn't directly at the\n// start or end of that node. Returns null when no position was found.\nfunction dropPoint(doc, pos, slice) {\n  var $pos = doc.resolve(pos);\n  if (!slice.content.size) { return pos }\n  var content = slice.content;\n  for (var i = 0; i < slice.openStart; i++) { content = content.firstChild.content; }\n  for (var pass = 1; pass <= (slice.openStart == 0 && slice.size ? 2 : 1); pass++) {\n    for (var d = $pos.depth; d >= 0; d--) {\n      var bias = d == $pos.depth ? 0 : $pos.pos <= ($pos.start(d + 1) + $pos.end(d + 1)) / 2 ? -1 : 1;\n      var insertPos = $pos.index(d) + (bias > 0 ? 1 : 0);\n      if (pass == 1\n          ? $pos.node(d).canReplace(insertPos, insertPos, content)\n          : $pos.node(d).contentMatchAt(insertPos).findWrapping(content.firstChild.type))\n        { return bias == 0 ? $pos.pos : bias < 0 ? $pos.before(d + 1) : $pos.after(d + 1) }\n    }\n  }\n  return null\n}\n\nfunction mapFragment(fragment, f, parent) {\n  var mapped = [];\n  for (var i = 0; i < fragment.childCount; i++) {\n    var child = fragment.child(i);\n    if (child.content.size) { child = child.copy(mapFragment(child.content, f, child)); }\n    if (child.isInline) { child = f(child, parent, i); }\n    mapped.push(child);\n  }\n  return Fragment.fromArray(mapped)\n}\n\n// ::- Add a mark to all inline content between two positions.\nvar AddMarkStep = /*@__PURE__*/(function (Step) {\n  function AddMarkStep(from, to, mark) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.mark = mark;\n  }\n\n  if ( Step ) AddMarkStep.__proto__ = Step;\n  AddMarkStep.prototype = Object.create( Step && Step.prototype );\n  AddMarkStep.prototype.constructor = AddMarkStep;\n\n  AddMarkStep.prototype.apply = function apply (doc) {\n    var this$1 = this;\n\n    var oldSlice = doc.slice(this.from, this.to), $from = doc.resolve(this.from);\n    var parent = $from.node($from.sharedDepth(this.to));\n    var slice = new Slice(mapFragment(oldSlice.content, function (node, parent) {\n      if (!node.isAtom || !parent.type.allowsMarkType(this$1.mark.type)) { return node }\n      return node.mark(this$1.mark.addToSet(node.marks))\n    }, parent), oldSlice.openStart, oldSlice.openEnd);\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  };\n\n  AddMarkStep.prototype.invert = function invert () {\n    return new RemoveMarkStep(this.from, this.to, this.mark)\n  };\n\n  AddMarkStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted || from.pos >= to.pos) { return null }\n    return new AddMarkStep(from.pos, to.pos, this.mark)\n  };\n\n  AddMarkStep.prototype.merge = function merge (other) {\n    if (other instanceof AddMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      { return new AddMarkStep(Math.min(this.from, other.from),\n                             Math.max(this.to, other.to), this.mark) }\n  };\n\n  AddMarkStep.prototype.toJSON = function toJSON () {\n    return {stepType: \"addMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  };\n\n  AddMarkStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for AddMarkStep.fromJSON\") }\n    return new AddMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  };\n\n  return AddMarkStep;\n}(Step));\n\nStep.jsonID(\"addMark\", AddMarkStep);\n\n// ::- Remove a mark from all inline content between two positions.\nvar RemoveMarkStep = /*@__PURE__*/(function (Step) {\n  function RemoveMarkStep(from, to, mark) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.mark = mark;\n  }\n\n  if ( Step ) RemoveMarkStep.__proto__ = Step;\n  RemoveMarkStep.prototype = Object.create( Step && Step.prototype );\n  RemoveMarkStep.prototype.constructor = RemoveMarkStep;\n\n  RemoveMarkStep.prototype.apply = function apply (doc) {\n    var this$1 = this;\n\n    var oldSlice = doc.slice(this.from, this.to);\n    var slice = new Slice(mapFragment(oldSlice.content, function (node) {\n      return node.mark(this$1.mark.removeFromSet(node.marks))\n    }), oldSlice.openStart, oldSlice.openEnd);\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  };\n\n  RemoveMarkStep.prototype.invert = function invert () {\n    return new AddMarkStep(this.from, this.to, this.mark)\n  };\n\n  RemoveMarkStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted || from.pos >= to.pos) { return null }\n    return new RemoveMarkStep(from.pos, to.pos, this.mark)\n  };\n\n  RemoveMarkStep.prototype.merge = function merge (other) {\n    if (other instanceof RemoveMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      { return new RemoveMarkStep(Math.min(this.from, other.from),\n                                Math.max(this.to, other.to), this.mark) }\n  };\n\n  RemoveMarkStep.prototype.toJSON = function toJSON () {\n    return {stepType: \"removeMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  };\n\n  RemoveMarkStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for RemoveMarkStep.fromJSON\") }\n    return new RemoveMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  };\n\n  return RemoveMarkStep;\n}(Step));\n\nStep.jsonID(\"removeMark\", RemoveMarkStep);\n\n// :: (number, number, Mark)  this\n// Add the given mark to the inline content between `from` and `to`.\nTransform.prototype.addMark = function(from, to, mark) {\n  var this$1 = this;\n\n  var removed = [], added = [], removing = null, adding = null;\n  this.doc.nodesBetween(from, to, function (node, pos, parent) {\n    if (!node.isInline) { return }\n    var marks = node.marks;\n    if (!mark.isInSet(marks) && parent.type.allowsMarkType(mark.type)) {\n      var start = Math.max(pos, from), end = Math.min(pos + node.nodeSize, to);\n      var newSet = mark.addToSet(marks);\n\n      for (var i = 0; i < marks.length; i++) {\n        if (!marks[i].isInSet(newSet)) {\n          if (removing && removing.to == start && removing.mark.eq(marks[i]))\n            { removing.to = end; }\n          else\n            { removed.push(removing = new RemoveMarkStep(start, end, marks[i])); }\n        }\n      }\n\n      if (adding && adding.to == start)\n        { adding.to = end; }\n      else\n        { added.push(adding = new AddMarkStep(start, end, mark)); }\n    }\n  });\n\n  removed.forEach(function (s) { return this$1.step(s); });\n  added.forEach(function (s) { return this$1.step(s); });\n  return this\n};\n\n// :: (number, number, ?union<Mark, MarkType>)  this\n// Remove marks from inline nodes between `from` and `to`. When `mark`\n// is a single mark, remove precisely that mark. When it is a mark type,\n// remove all marks of that type. When it is null, remove all marks of\n// any type.\nTransform.prototype.removeMark = function(from, to, mark) {\n  var this$1 = this;\n  if ( mark === void 0 ) mark = null;\n\n  var matched = [], step = 0;\n  this.doc.nodesBetween(from, to, function (node, pos) {\n    if (!node.isInline) { return }\n    step++;\n    var toRemove = null;\n    if (mark instanceof MarkType) {\n      var found = mark.isInSet(node.marks);\n      if (found) { toRemove = [found]; }\n    } else if (mark) {\n      if (mark.isInSet(node.marks)) { toRemove = [mark]; }\n    } else {\n      toRemove = node.marks;\n    }\n    if (toRemove && toRemove.length) {\n      var end = Math.min(pos + node.nodeSize, to);\n      for (var i = 0; i < toRemove.length; i++) {\n        var style = toRemove[i], found$1 = (void 0);\n        for (var j = 0; j < matched.length; j++) {\n          var m = matched[j];\n          if (m.step == step - 1 && style.eq(matched[j].style)) { found$1 = m; }\n        }\n        if (found$1) {\n          found$1.to = end;\n          found$1.step = step;\n        } else {\n          matched.push({style: style, from: Math.max(pos, from), to: end, step: step});\n        }\n      }\n    }\n  });\n  matched.forEach(function (m) { return this$1.step(new RemoveMarkStep(m.from, m.to, m.style)); });\n  return this\n};\n\n// :: (number, NodeType, ?ContentMatch)  this\n// Removes all marks and nodes from the content of the node at `pos`\n// that don't match the given new parent node type. Accepts an\n// optional starting [content match](#model.ContentMatch) as third\n// argument.\nTransform.prototype.clearIncompatible = function(pos, parentType, match) {\n  if ( match === void 0 ) match = parentType.contentMatch;\n\n  var node = this.doc.nodeAt(pos);\n  var delSteps = [], cur = pos + 1;\n  for (var i = 0; i < node.childCount; i++) {\n    var child = node.child(i), end = cur + child.nodeSize;\n    var allowed = match.matchType(child.type, child.attrs);\n    if (!allowed) {\n      delSteps.push(new ReplaceStep(cur, end, Slice.empty));\n    } else {\n      match = allowed;\n      for (var j = 0; j < child.marks.length; j++) { if (!parentType.allowsMarkType(child.marks[j].type))\n        { this.step(new RemoveMarkStep(cur, end, child.marks[j])); } }\n    }\n    cur = end;\n  }\n  if (!match.validEnd) {\n    var fill = match.fillBefore(Fragment.empty, true);\n    this.replace(cur, cur, new Slice(fill, 0, 0));\n  }\n  for (var i$1 = delSteps.length - 1; i$1 >= 0; i$1--) { this.step(delSteps[i$1]); }\n  return this\n};\n\n// :: (Node, number, ?number, ?Slice)  ?Step\n// Fit a slice into a given position in the document, producing a\n// [step](#transform.Step) that inserts it. Will return null if\n// there's no meaningful way to insert the slice here, or inserting it\n// would be a no-op (an empty slice over an empty range).\nfunction replaceStep(doc, from, to, slice) {\n  if ( to === void 0 ) to = from;\n  if ( slice === void 0 ) slice = Slice.empty;\n\n  if (from == to && !slice.size) { return null }\n\n  var $from = doc.resolve(from), $to = doc.resolve(to);\n  // Optimization -- avoid work if it's obvious that it's not needed.\n  if (fitsTrivially($from, $to, slice)) { return new ReplaceStep(from, to, slice) }\n  return new Fitter($from, $to, slice).fit()\n}\n\n// :: (number, ?number, ?Slice)  this\n// Replace the part of the document between `from` and `to` with the\n// given `slice`.\nTransform.prototype.replace = function(from, to, slice) {\n  if ( to === void 0 ) to = from;\n  if ( slice === void 0 ) slice = Slice.empty;\n\n  var step = replaceStep(this.doc, from, to, slice);\n  if (step) { this.step(step); }\n  return this\n};\n\n// :: (number, number, union<Fragment, Node, [Node]>)  this\n// Replace the given range with the given content, which may be a\n// fragment, node, or array of nodes.\nTransform.prototype.replaceWith = function(from, to, content) {\n  return this.replace(from, to, new Slice(Fragment.from(content), 0, 0))\n};\n\n// :: (number, number)  this\n// Delete the content between the given positions.\nTransform.prototype.delete = function(from, to) {\n  return this.replace(from, to, Slice.empty)\n};\n\n// :: (number, union<Fragment, Node, [Node]>)  this\n// Insert the given content at the given position.\nTransform.prototype.insert = function(pos, content) {\n  return this.replaceWith(pos, pos, content)\n};\n\nfunction fitsTrivially($from, $to, slice) {\n  return !slice.openStart && !slice.openEnd && $from.start() == $to.start() &&\n    $from.parent.canReplace($from.index(), $to.index(), slice.content)\n}\n\n// Algorithm for 'placing' the elements of a slice into a gap:\n//\n// We consider the content of each node that is open to the left to be\n// independently placeable. I.e. in <p(\"foo\"), p(\"bar\")>, when the\n// paragraph on the left is open, \"foo\" can be placed (somewhere on\n// the left side of the replacement gap) independently from p(\"bar\").\n//\n// This class tracks the state of the placement progress in the\n// following properties:\n//\n//  - `frontier` holds a stack of `{type, match}` objects that\n//    represent the open side of the replacement. It starts at\n//    `$from`, then moves forward as content is placed, and is finally\n//    reconciled with `$to`.\n//\n//  - `unplaced` is a slice that represents the content that hasn't\n//    been placed yet.\n//\n//  - `placed` is a fragment of placed content. Its open-start value\n//    is implicit in `$from`, and its open-end value in `frontier`.\nvar Fitter = function Fitter($from, $to, slice) {\n  this.$to = $to;\n  this.$from = $from;\n  this.unplaced = slice;\n\n  this.frontier = [];\n  for (var i = 0; i <= $from.depth; i++) {\n    var node = $from.node(i);\n    this.frontier.push({\n      type: node.type,\n      match: node.contentMatchAt($from.indexAfter(i))\n    });\n  }\n\n  this.placed = Fragment.empty;\n  for (var i$1 = $from.depth; i$1 > 0; i$1--)\n    { this.placed = Fragment.from($from.node(i$1).copy(this.placed)); }\n};\n\nvar prototypeAccessors$1 = { depth: { configurable: true } };\n\nprototypeAccessors$1.depth.get = function () { return this.frontier.length - 1 };\n\nFitter.prototype.fit = function fit () {\n  // As long as there's unplaced content, try to place some of it.\n  // If that fails, either increase the open score of the unplaced\n  // slice, or drop nodes from it, and then try again.\n  while (this.unplaced.size) {\n    var fit = this.findFittable();\n    if (fit) { this.placeNodes(fit); }\n    else { this.openMore() || this.dropNode(); }\n  }\n  // When there's inline content directly after the frontier _and_\n  // directly after `this.$to`, we must generate a `ReplaceAround`\n  // step that pulls that content into the node after the frontier.\n  // That means the fitting must be done to the end of the textblock\n  // node after `this.$to`, not `this.$to` itself.\n  var moveInline = this.mustMoveInline(), placedSize = this.placed.size - this.depth - this.$from.depth;\n  var $from = this.$from, $to = this.close(moveInline < 0 ? this.$to : $from.doc.resolve(moveInline));\n  if (!$to) { return null }\n\n  // If closing to `$to` succeeded, create a step\n  var content = this.placed, openStart = $from.depth, openEnd = $to.depth;\n  while (openStart && openEnd && content.childCount == 1) { // Normalize by dropping open parent nodes\n    content = content.firstChild.content;\n    openStart--; openEnd--;\n  }\n  var slice = new Slice(content, openStart, openEnd);\n  if (moveInline > -1)\n    { return new ReplaceAroundStep($from.pos, moveInline, this.$to.pos, this.$to.end(), slice, placedSize) }\n  if (slice.size || $from.pos != this.$to.pos) // Don't generate no-op steps\n    { return new ReplaceStep($from.pos, $to.pos, slice) }\n};\n\n// Find a position on the start spine of `this.unplaced` that has\n// content that can be moved somewhere on the frontier. Returns two\n// depths, one for the slice and one for the frontier.\nFitter.prototype.findFittable = function findFittable () {\n  // Only try wrapping nodes (pass 2) after finding a place without\n  // wrapping failed.\n  for (var pass = 1; pass <= 2; pass++) {\n    for (var sliceDepth = this.unplaced.openStart; sliceDepth >= 0; sliceDepth--) {\n      var fragment = (void 0), parent = (void 0);\n      if (sliceDepth) {\n        parent = contentAt(this.unplaced.content, sliceDepth - 1).firstChild;\n        fragment = parent.content;\n      } else {\n        fragment = this.unplaced.content;\n      }\n      var first = fragment.firstChild;\n      for (var frontierDepth = this.depth; frontierDepth >= 0; frontierDepth--) {\n        var ref = this.frontier[frontierDepth];\n          var type = ref.type;\n          var match = ref.match;\n          var wrap = (void 0), inject = (void 0);\n        // In pass 1, if the next node matches, or there is no next\n        // node but the parents look compatible, we've found a\n        // place.\n        if (pass == 1 && (first ? match.matchType(first.type) || (inject = match.fillBefore(Fragment.from(first), false))\n                          : type.compatibleContent(parent.type)))\n          { return {sliceDepth: sliceDepth, frontierDepth: frontierDepth, parent: parent, inject: inject} }\n        // In pass 2, look for a set of wrapping nodes that make\n        // `first` fit here.\n        else if (pass == 2 && first && (wrap = match.findWrapping(first.type)))\n          { return {sliceDepth: sliceDepth, frontierDepth: frontierDepth, parent: parent, wrap: wrap} }\n        // Don't continue looking further up if the parent node\n        // would fit here.\n        if (parent && match.matchType(parent.type)) { break }\n      }\n    }\n  }\n};\n\nFitter.prototype.openMore = function openMore () {\n  var ref = this.unplaced;\n    var content = ref.content;\n    var openStart = ref.openStart;\n    var openEnd = ref.openEnd;\n  var inner = contentAt(content, openStart);\n  if (!inner.childCount || inner.firstChild.isLeaf) { return false }\n  this.unplaced = new Slice(content, openStart + 1,\n                            Math.max(openEnd, inner.size + openStart >= content.size - openEnd ? openStart + 1 : 0));\n  return true\n};\n\nFitter.prototype.dropNode = function dropNode () {\n  var ref = this.unplaced;\n    var content = ref.content;\n    var openStart = ref.openStart;\n    var openEnd = ref.openEnd;\n  var inner = contentAt(content, openStart);\n  if (inner.childCount <= 1 && openStart > 0) {\n    var openAtEnd = content.size - openStart <= openStart + inner.size;\n    this.unplaced = new Slice(dropFromFragment(content, openStart - 1, 1), openStart - 1,\n                              openAtEnd ? openStart - 1 : openEnd);\n  } else {\n    this.unplaced = new Slice(dropFromFragment(content, openStart, 1), openStart, openEnd);\n  }\n};\n\n// : ({sliceDepth: number, frontierDepth: number, parent: ?Node, wrap: ?[NodeType], inject: ?Fragment})\n// Move content from the unplaced slice at `sliceDepth` to the\n// frontier node at `frontierDepth`. Close that frontier node when\n// applicable.\nFitter.prototype.placeNodes = function placeNodes (ref) {\n    var sliceDepth = ref.sliceDepth;\n    var frontierDepth = ref.frontierDepth;\n    var parent = ref.parent;\n    var inject = ref.inject;\n    var wrap = ref.wrap;\n\n  while (this.depth > frontierDepth) { this.closeFrontierNode(); }\n  if (wrap) { for (var i = 0; i < wrap.length; i++) { this.openFrontierNode(wrap[i]); } }\n\n  var slice = this.unplaced, fragment = parent ? parent.content : slice.content;\n  var openStart = slice.openStart - sliceDepth;\n  var taken = 0, add = [];\n  var ref$1 = this.frontier[frontierDepth];\n    var match = ref$1.match;\n    var type = ref$1.type;\n  if (inject) {\n    for (var i$1 = 0; i$1 < inject.childCount; i$1++) { add.push(inject.child(i$1)); }\n    match = match.matchFragment(inject);\n  }\n  // Computes the amount of (end) open nodes at the end of the\n  // fragment. When 0, the parent is open, but no more. When\n  // negative, nothing is open.\n  var openEndCount = (fragment.size + sliceDepth) - (slice.content.size - slice.openEnd);\n  // Scan over the fragment, fitting as many child nodes as\n  // possible.\n  while (taken < fragment.childCount) {\n    var next = fragment.child(taken), matches = match.matchType(next.type);\n    if (!matches) { break }\n    taken++;\n    if (taken > 1 || openStart == 0 || next.content.size) { // Drop empty open nodes\n      match = matches;\n      add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)), taken == 1 ? openStart : 0,\n                              taken == fragment.childCount ? openEndCount : -1));\n    }\n  }\n  var toEnd = taken == fragment.childCount;\n  if (!toEnd) { openEndCount = -1; }\n\n  this.placed = addToFragment(this.placed, frontierDepth, Fragment.from(add));\n  this.frontier[frontierDepth].match = match;\n\n  // If the parent types match, and the entire node was moved, and\n  // it's not open, close this frontier node right away.\n  if (toEnd && openEndCount < 0 && parent && parent.type == this.frontier[this.depth].type && this.frontier.length > 1)\n    { this.closeFrontierNode(); }\n\n  // Add new frontier nodes for any open nodes at the end.\n  for (var i$2 = 0, cur = fragment; i$2 < openEndCount; i$2++) {\n    var node = cur.lastChild;\n    this.frontier.push({type: node.type, match: node.contentMatchAt(node.childCount)});\n    cur = node.content;\n  }\n\n  // Update `this.unplaced`. Drop the entire node from which we\n  // placed it we got to its end, otherwise just drop the placed\n  // nodes.\n  this.unplaced = !toEnd ? new Slice(dropFromFragment(slice.content, sliceDepth, taken), slice.openStart, slice.openEnd)\n    : sliceDepth == 0 ? Slice.empty\n    : new Slice(dropFromFragment(slice.content, sliceDepth - 1, 1),\n                sliceDepth - 1, openEndCount < 0 ? slice.openEnd : sliceDepth - 1);\n};\n\nFitter.prototype.mustMoveInline = function mustMoveInline () {\n  if (!this.$to.parent.isTextblock || this.$to.end() == this.$to.pos) { return -1 }\n  var top = this.frontier[this.depth], level;\n  if (!top.type.isTextblock || !contentAfterFits(this.$to, this.$to.depth, top.type, top.match, false) ||\n      (this.$to.depth == this.depth && (level = this.findCloseLevel(this.$to)) && level.depth == this.depth)) { return -1 }\n\n  var ref = this.$to;\n    var depth = ref.depth;\n    var after = this.$to.after(depth);\n  while (depth > 1 && after == this.$to.end(--depth)) { ++after; }\n  return after\n};\n\nFitter.prototype.findCloseLevel = function findCloseLevel ($to) {\n  scan: for (var i = Math.min(this.depth, $to.depth); i >= 0; i--) {\n    var ref = this.frontier[i];\n      var match = ref.match;\n      var type = ref.type;\n    var dropInner = i < $to.depth && $to.end(i + 1) == $to.pos + ($to.depth - (i + 1));\n    var fit = contentAfterFits($to, i, type, match, dropInner);\n    if (!fit) { continue }\n    for (var d = i - 1; d >= 0; d--) {\n      var ref$1 = this.frontier[d];\n        var match$1 = ref$1.match;\n        var type$1 = ref$1.type;\n      var matches = contentAfterFits($to, d, type$1, match$1, true);\n      if (!matches || matches.childCount) { continue scan }\n    }\n    return {depth: i, fit: fit, move: dropInner ? $to.doc.resolve($to.after(i + 1)) : $to}\n  }\n};\n\nFitter.prototype.close = function close ($to) {\n  var close = this.findCloseLevel($to);\n  if (!close) { return null }\n\n  while (this.depth > close.depth) { this.closeFrontierNode(); }\n  if (close.fit.childCount) { this.placed = addToFragment(this.placed, close.depth, close.fit); }\n  $to = close.move;\n  for (var d = close.depth + 1; d <= $to.depth; d++) {\n    var node = $to.node(d), add = node.type.contentMatch.fillBefore(node.content, true, $to.index(d));\n    this.openFrontierNode(node.type, node.attrs, add);\n  }\n  return $to\n};\n\nFitter.prototype.openFrontierNode = function openFrontierNode (type, attrs, content) {\n  var top = this.frontier[this.depth];\n  top.match = top.match.matchType(type);\n  this.placed = addToFragment(this.placed, this.depth, Fragment.from(type.create(attrs, content)));\n  this.frontier.push({type: type, match: type.contentMatch});\n};\n\nFitter.prototype.closeFrontierNode = function closeFrontierNode () {\n  var open = this.frontier.pop();\n  var add = open.match.fillBefore(Fragment.empty, true);\n  if (add.childCount) { this.placed = addToFragment(this.placed, this.frontier.length, add); }\n};\n\nObject.defineProperties( Fitter.prototype, prototypeAccessors$1 );\n\nfunction dropFromFragment(fragment, depth, count) {\n  if (depth == 0) { return fragment.cutByIndex(count) }\n  return fragment.replaceChild(0, fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content, depth - 1, count)))\n}\n\nfunction addToFragment(fragment, depth, content) {\n  if (depth == 0) { return fragment.append(content) }\n  return fragment.replaceChild(fragment.childCount - 1,\n                               fragment.lastChild.copy(addToFragment(fragment.lastChild.content, depth - 1, content)))\n}\n\nfunction contentAt(fragment, depth) {\n  for (var i = 0; i < depth; i++) { fragment = fragment.firstChild.content; }\n  return fragment\n}\n\nfunction closeNodeStart(node, openStart, openEnd) {\n  if (openStart <= 0) { return node }\n  var frag = node.content;\n  if (openStart > 1)\n    { frag = frag.replaceChild(0, closeNodeStart(frag.firstChild, openStart - 1, frag.childCount == 1 ? openEnd - 1 : 0)); }\n  if (openStart > 0) {\n    frag = node.type.contentMatch.fillBefore(frag).append(frag);\n    if (openEnd <= 0) { frag = frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(Fragment.empty, true)); }\n  }\n  return node.copy(frag)\n}\n\nfunction contentAfterFits($to, depth, type, match, open) {\n  var node = $to.node(depth), index = open ? $to.indexAfter(depth) : $to.index(depth);\n  if (index == node.childCount && !type.compatibleContent(node.type)) { return null }\n  var fit = match.fillBefore(node.content, true, index);\n  return fit && !invalidMarks(type, node.content, index) ? fit : null\n}\n\nfunction invalidMarks(type, fragment, start) {\n  for (var i = start; i < fragment.childCount; i++)\n    { if (!type.allowsMarks(fragment.child(i).marks)) { return true } }\n  return false\n}\n\n// :: (number, number, Slice)  this\n// Replace a range of the document with a given slice, using `from`,\n// `to`, and the slice's [`openStart`](#model.Slice.openStart) property\n// as hints, rather than fixed start and end points. This method may\n// grow the replaced area or close open nodes in the slice in order to\n// get a fit that is more in line with WYSIWYG expectations, by\n// dropping fully covered parent nodes of the replaced region when\n// they are marked [non-defining](#model.NodeSpec.defining), or\n// including an open parent node from the slice that _is_ marked as\n// [defining](#model.NodeSpec.defining).\n//\n// This is the method, for example, to handle paste. The similar\n// [`replace`](#transform.Transform.replace) method is a more\n// primitive tool which will _not_ move the start and end of its given\n// range, and is useful in situations where you need more precise\n// control over what happens.\nTransform.prototype.replaceRange = function(from, to, slice) {\n  if (!slice.size) { return this.deleteRange(from, to) }\n\n  var $from = this.doc.resolve(from), $to = this.doc.resolve(to);\n  if (fitsTrivially($from, $to, slice))\n    { return this.step(new ReplaceStep(from, to, slice)) }\n\n  var targetDepths = coveredDepths($from, this.doc.resolve(to));\n  // Can't replace the whole document, so remove 0 if it's present\n  if (targetDepths[targetDepths.length - 1] == 0) { targetDepths.pop(); }\n  // Negative numbers represent not expansion over the whole node at\n  // that depth, but replacing from $from.before(-D) to $to.pos.\n  var preferredTarget = -($from.depth + 1);\n  targetDepths.unshift(preferredTarget);\n  // This loop picks a preferred target depth, if one of the covering\n  // depths is not outside of a defining node, and adds negative\n  // depths for any depth that has $from at its start and does not\n  // cross a defining node.\n  for (var d = $from.depth, pos = $from.pos - 1; d > 0; d--, pos--) {\n    var spec = $from.node(d).type.spec;\n    if (spec.defining || spec.isolating) { break }\n    if (targetDepths.indexOf(d) > -1) { preferredTarget = d; }\n    else if ($from.before(d) == pos) { targetDepths.splice(1, 0, -d); }\n  }\n  // Try to fit each possible depth of the slice into each possible\n  // target depth, starting with the preferred depths.\n  var preferredTargetIndex = targetDepths.indexOf(preferredTarget);\n\n  var leftNodes = [], preferredDepth = slice.openStart;\n  for (var content = slice.content, i = 0;; i++) {\n    var node = content.firstChild;\n    leftNodes.push(node);\n    if (i == slice.openStart) { break }\n    content = node.content;\n  }\n  // Back up if the node directly above openStart, or the node above\n  // that separated only by a non-defining textblock node, is defining.\n  if (preferredDepth > 0 && leftNodes[preferredDepth - 1].type.spec.defining &&\n      $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 1].type)\n    { preferredDepth -= 1; }\n  else if (preferredDepth >= 2 && leftNodes[preferredDepth - 1].isTextblock && leftNodes[preferredDepth - 2].type.spec.defining &&\n           $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 2].type)\n    { preferredDepth -= 2; }\n\n  for (var j = slice.openStart; j >= 0; j--) {\n    var openDepth = (j + preferredDepth + 1) % (slice.openStart + 1);\n    var insert = leftNodes[openDepth];\n    if (!insert) { continue }\n    for (var i$1 = 0; i$1 < targetDepths.length; i$1++) {\n      // Loop over possible expansion levels, starting with the\n      // preferred one\n      var targetDepth = targetDepths[(i$1 + preferredTargetIndex) % targetDepths.length], expand = true;\n      if (targetDepth < 0) { expand = false; targetDepth = -targetDepth; }\n      var parent = $from.node(targetDepth - 1), index = $from.index(targetDepth - 1);\n      if (parent.canReplaceWith(index, index, insert.type, insert.marks))\n        { return this.replace($from.before(targetDepth), expand ? $to.after(targetDepth) : to,\n                            new Slice(closeFragment(slice.content, 0, slice.openStart, openDepth),\n                                      openDepth, slice.openEnd)) }\n    }\n  }\n\n  var startSteps = this.steps.length;\n  for (var i$2 = targetDepths.length - 1; i$2 >= 0; i$2--) {\n    this.replace(from, to, slice);\n    if (this.steps.length > startSteps) { break }\n    var depth = targetDepths[i$2];\n    if (i$2 < 0) { continue }\n    from = $from.before(depth); to = $to.after(depth);\n  }\n  return this\n};\n\nfunction closeFragment(fragment, depth, oldOpen, newOpen, parent) {\n  if (depth < oldOpen) {\n    var first = fragment.firstChild;\n    fragment = fragment.replaceChild(0, first.copy(closeFragment(first.content, depth + 1, oldOpen, newOpen, first)));\n  }\n  if (depth > newOpen) {\n    var match = parent.contentMatchAt(0);\n    var start = match.fillBefore(fragment).append(fragment);\n    fragment = start.append(match.matchFragment(start).fillBefore(Fragment.empty, true));\n  }\n  return fragment\n}\n\n// :: (number, number, Node)  this\n// Replace the given range with a node, but use `from` and `to` as\n// hints, rather than precise positions. When from and to are the same\n// and are at the start or end of a parent node in which the given\n// node doesn't fit, this method may _move_ them out towards a parent\n// that does allow the given node to be placed. When the given range\n// completely covers a parent node, this method may completely replace\n// that parent node.\nTransform.prototype.replaceRangeWith = function(from, to, node) {\n  if (!node.isInline && from == to && this.doc.resolve(from).parent.content.size) {\n    var point = insertPoint(this.doc, from, node.type);\n    if (point != null) { from = to = point; }\n  }\n  return this.replaceRange(from, to, new Slice(Fragment.from(node), 0, 0))\n};\n\n// :: (number, number)  this\n// Delete the given range, expanding it to cover fully covered\n// parent nodes until a valid replace is found.\nTransform.prototype.deleteRange = function(from, to) {\n  var $from = this.doc.resolve(from), $to = this.doc.resolve(to);\n  var covered = coveredDepths($from, $to);\n  for (var i = 0; i < covered.length; i++) {\n    var depth = covered[i], last = i == covered.length - 1;\n    if ((last && depth == 0) || $from.node(depth).type.contentMatch.validEnd)\n      { return this.delete($from.start(depth), $to.end(depth)) }\n    if (depth > 0 && (last || $from.node(depth - 1).canReplace($from.index(depth - 1), $to.indexAfter(depth - 1))))\n      { return this.delete($from.before(depth), $to.after(depth)) }\n  }\n  for (var d = 1; d <= $from.depth && d <= $to.depth; d++) {\n    if (from - $from.start(d) == $from.depth - d && to > $from.end(d) && $to.end(d) - to != $to.depth - d)\n      { return this.delete($from.before(d), to) }\n  }\n  return this.delete(from, to)\n};\n\n// : (ResolvedPos, ResolvedPos)  [number]\n// Returns an array of all depths for which $from - $to spans the\n// whole content of the nodes at that depth.\nfunction coveredDepths($from, $to) {\n  var result = [], minDepth = Math.min($from.depth, $to.depth);\n  for (var d = minDepth; d >= 0; d--) {\n    var start = $from.start(d);\n    if (start < $from.pos - ($from.depth - d) ||\n        $to.end(d) > $to.pos + ($to.depth - d) ||\n        $from.node(d).type.spec.isolating ||\n        $to.node(d).type.spec.isolating) { break }\n    if (start == $to.start(d)) { result.push(d); }\n  }\n  return result\n}\n\nexport { AddMarkStep, MapResult, Mapping, RemoveMarkStep, ReplaceAroundStep, ReplaceStep, Step, StepMap, StepResult, Transform, TransformError, canJoin, canSplit, dropPoint, findWrapping, insertPoint, joinPoint, liftTarget, replaceStep };\n//# sourceMappingURL=index.es.js.map\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","var GOOD_LEAF_SIZE = 200;\n\n// :: class<T> A rope sequence is a persistent sequence data structure\n// that supports appending, prepending, and slicing without doing a\n// full copy. It is represented as a mostly-balanced tree.\nvar RopeSequence = function RopeSequence () {};\n\nRopeSequence.prototype.append = function append (other) {\n  if (!other.length) { return this }\n  other = RopeSequence.from(other);\n\n  return (!this.length && other) ||\n    (other.length < GOOD_LEAF_SIZE && this.leafAppend(other)) ||\n    (this.length < GOOD_LEAF_SIZE && other.leafPrepend(this)) ||\n    this.appendInner(other)\n};\n\n// :: (union<[T], RopeSequence<T>>)  RopeSequence<T>\n// Prepend an array or other rope to this one, returning a new rope.\nRopeSequence.prototype.prepend = function prepend (other) {\n  if (!other.length) { return this }\n  return RopeSequence.from(other).append(this)\n};\n\nRopeSequence.prototype.appendInner = function appendInner (other) {\n  return new Append(this, other)\n};\n\n// :: (?number, ?number)  RopeSequence<T>\n// Create a rope repesenting a sub-sequence of this rope.\nRopeSequence.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from >= to) { return RopeSequence.empty }\n  return this.sliceInner(Math.max(0, from), Math.min(this.length, to))\n};\n\n// :: (number)  T\n// Retrieve the element at the given position from this rope.\nRopeSequence.prototype.get = function get (i) {\n  if (i < 0 || i >= this.length) { return undefined }\n  return this.getInner(i)\n};\n\n// :: ((element: T, index: number)  ?bool, ?number, ?number)\n// Call the given function for each element between the given\n// indices. This tends to be more efficient than looping over the\n// indices and calling `get`, because it doesn't have to descend the\n// tree for every element.\nRopeSequence.prototype.forEach = function forEach (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from <= to)\n    { this.forEachInner(f, from, to, 0); }\n  else\n    { this.forEachInvertedInner(f, from, to, 0); }\n};\n\n// :: ((element: T, index: number)  U, ?number, ?number)  [U]\n// Map the given functions over the elements of the rope, producing\n// a flat array.\nRopeSequence.prototype.map = function map (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  var result = [];\n  this.forEach(function (elt, i) { return result.push(f(elt, i)); }, from, to);\n  return result\n};\n\n// :: (?union<[T], RopeSequence<T>>)  RopeSequence<T>\n// Create a rope representing the given array, or return the rope\n// itself if a rope was given.\nRopeSequence.from = function from (values) {\n  if (values instanceof RopeSequence) { return values }\n  return values && values.length ? new Leaf(values) : RopeSequence.empty\n};\n\nvar Leaf = /*@__PURE__*/(function (RopeSequence) {\n  function Leaf(values) {\n    RopeSequence.call(this);\n    this.values = values;\n  }\n\n  if ( RopeSequence ) Leaf.__proto__ = RopeSequence;\n  Leaf.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Leaf.prototype.constructor = Leaf;\n\n  var prototypeAccessors = { length: { configurable: true },depth: { configurable: true } };\n\n  Leaf.prototype.flatten = function flatten () {\n    return this.values\n  };\n\n  Leaf.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    return new Leaf(this.values.slice(from, to))\n  };\n\n  Leaf.prototype.getInner = function getInner (i) {\n    return this.values[i]\n  };\n\n  Leaf.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    for (var i = from; i < to; i++)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    for (var i = from - 1; i >= to; i--)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.leafAppend = function leafAppend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(this.values.concat(other.flatten())) }\n  };\n\n  Leaf.prototype.leafPrepend = function leafPrepend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(other.flatten().concat(this.values)) }\n  };\n\n  prototypeAccessors.length.get = function () { return this.values.length };\n\n  prototypeAccessors.depth.get = function () { return 0 };\n\n  Object.defineProperties( Leaf.prototype, prototypeAccessors );\n\n  return Leaf;\n}(RopeSequence));\n\n// :: RopeSequence\n// The empty rope sequence.\nRopeSequence.empty = new Leaf([]);\n\nvar Append = /*@__PURE__*/(function (RopeSequence) {\n  function Append(left, right) {\n    RopeSequence.call(this);\n    this.left = left;\n    this.right = right;\n    this.length = left.length + right.length;\n    this.depth = Math.max(left.depth, right.depth) + 1;\n  }\n\n  if ( RopeSequence ) Append.__proto__ = RopeSequence;\n  Append.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Append.prototype.constructor = Append;\n\n  Append.prototype.flatten = function flatten () {\n    return this.left.flatten().concat(this.right.flatten())\n  };\n\n  Append.prototype.getInner = function getInner (i) {\n    return i < this.left.length ? this.left.get(i) : this.right.get(i - this.left.length)\n  };\n\n  Append.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from < leftLen &&\n        this.left.forEachInner(f, from, Math.min(to, leftLen), start) === false)\n      { return false }\n    if (to > leftLen &&\n        this.right.forEachInner(f, Math.max(from - leftLen, 0), Math.min(this.length, to) - leftLen, start + leftLen) === false)\n      { return false }\n  };\n\n  Append.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from > leftLen &&\n        this.right.forEachInvertedInner(f, from - leftLen, Math.max(to, leftLen) - leftLen, start + leftLen) === false)\n      { return false }\n    if (to < leftLen &&\n        this.left.forEachInvertedInner(f, Math.min(from, leftLen), to, start) === false)\n      { return false }\n  };\n\n  Append.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    var leftLen = this.left.length;\n    if (to <= leftLen) { return this.left.slice(from, to) }\n    if (from >= leftLen) { return this.right.slice(from - leftLen, to - leftLen) }\n    return this.left.slice(from, leftLen).append(this.right.slice(0, to - leftLen))\n  };\n\n  Append.prototype.leafAppend = function leafAppend (other) {\n    var inner = this.right.leafAppend(other);\n    if (inner) { return new Append(this.left, inner) }\n  };\n\n  Append.prototype.leafPrepend = function leafPrepend (other) {\n    var inner = this.left.leafPrepend(other);\n    if (inner) { return new Append(inner, this.right) }\n  };\n\n  Append.prototype.appendInner = function appendInner (other) {\n    if (this.left.depth >= Math.max(this.right.depth, other.depth) + 1)\n      { return new Append(this.left, new Append(this.right, other)) }\n    return new Append(this, other)\n  };\n\n  return Append;\n}(RopeSequence));\n\nvar ropeSequence = RopeSequence;\n\nexport default ropeSequence;\n","import RopeSequence from 'rope-sequence';\nimport { Mapping } from 'prosemirror-transform';\nimport { PluginKey, Plugin } from 'prosemirror-state';\n\n// ProseMirror's history isn't simply a way to roll back to a previous\n// state, because ProseMirror supports applying changes without adding\n// them to the history (for example during collaboration).\n//\n// To this end, each 'Branch' (one for the undo history and one for\n// the redo history) keeps an array of 'Items', which can optionally\n// hold a step (an actual undoable change), and always hold a position\n// map (which is needed to move changes below them to apply to the\n// current document).\n//\n// An item that has both a step and a selection bookmark is the start\n// of an 'event'  a group of changes that will be undone or redone at\n// once. (It stores only the bookmark, since that way we don't have to\n// provide a document until the selection is actually applied, which\n// is useful when compressing.)\n\n// Used to schedule history compression\nvar max_empty_items = 500;\n\nvar Branch = function Branch(items, eventCount) {\n  this.items = items;\n  this.eventCount = eventCount;\n};\n\n// : (EditorState, bool)  ?{transform: Transform, selection: ?SelectionBookmark, remaining: Branch}\n// Pop the latest event off the branch's history and apply it\n// to a document transform.\nBranch.prototype.popEvent = function popEvent (state, preserveItems) {\n    var this$1 = this;\n\n  if (this.eventCount == 0) { return null }\n\n  var end = this.items.length;\n  for (;; end--) {\n    var next = this.items.get(end - 1);\n    if (next.selection) { --end; break }\n  }\n\n  var remap, mapFrom;\n  if (preserveItems) {\n    remap = this.remapping(end, this.items.length);\n    mapFrom = remap.maps.length;\n  }\n  var transform = state.tr;\n  var selection, remaining;\n  var addAfter = [], addBefore = [];\n\n  this.items.forEach(function (item, i) {\n    if (!item.step) {\n      if (!remap) {\n        remap = this$1.remapping(end, i + 1);\n        mapFrom = remap.maps.length;\n      }\n      mapFrom--;\n      addBefore.push(item);\n      return\n    }\n\n    if (remap) {\n      addBefore.push(new Item(item.map));\n      var step = item.step.map(remap.slice(mapFrom)), map;\n\n      if (step && transform.maybeStep(step).doc) {\n        map = transform.mapping.maps[transform.mapping.maps.length - 1];\n        addAfter.push(new Item(map, null, null, addAfter.length + addBefore.length));\n      }\n      mapFrom--;\n      if (map) { remap.appendMap(map, mapFrom); }\n    } else {\n      transform.maybeStep(item.step);\n    }\n\n    if (item.selection) {\n      selection = remap ? item.selection.map(remap.slice(mapFrom)) : item.selection;\n      remaining = new Branch(this$1.items.slice(0, end).append(addBefore.reverse().concat(addAfter)), this$1.eventCount - 1);\n      return false\n    }\n  }, this.items.length, 0);\n\n  return {remaining: remaining, transform: transform, selection: selection}\n};\n\n// : (Transform, ?SelectionBookmark, Object)  Branch\n// Create a new branch with the given transform added.\nBranch.prototype.addTransform = function addTransform (transform, selection, histOptions, preserveItems) {\n  var newItems = [], eventCount = this.eventCount;\n  var oldItems = this.items, lastItem = !preserveItems && oldItems.length ? oldItems.get(oldItems.length - 1) : null;\n\n  for (var i = 0; i < transform.steps.length; i++) {\n    var step = transform.steps[i].invert(transform.docs[i]);\n    var item = new Item(transform.mapping.maps[i], step, selection), merged = (void 0);\n    if (merged = lastItem && lastItem.merge(item)) {\n      item = merged;\n      if (i) { newItems.pop(); }\n      else { oldItems = oldItems.slice(0, oldItems.length - 1); }\n    }\n    newItems.push(item);\n    if (selection) {\n      eventCount++;\n      selection = null;\n    }\n    if (!preserveItems) { lastItem = item; }\n  }\n  var overflow = eventCount - histOptions.depth;\n  if (overflow > DEPTH_OVERFLOW) {\n    oldItems = cutOffEvents(oldItems, overflow);\n    eventCount -= overflow;\n  }\n  return new Branch(oldItems.append(newItems), eventCount)\n};\n\nBranch.prototype.remapping = function remapping (from, to) {\n  var maps = new Mapping;\n  this.items.forEach(function (item, i) {\n    var mirrorPos = item.mirrorOffset != null && i - item.mirrorOffset >= from\n        ? maps.maps.length - item.mirrorOffset : null;\n    maps.appendMap(item.map, mirrorPos);\n  }, from, to);\n  return maps\n};\n\nBranch.prototype.addMaps = function addMaps (array) {\n  if (this.eventCount == 0) { return this }\n  return new Branch(this.items.append(array.map(function (map) { return new Item(map); })), this.eventCount)\n};\n\n// : (Transform, number)\n// When the collab module receives remote changes, the history has\n// to know about those, so that it can adjust the steps that were\n// rebased on top of the remote changes, and include the position\n// maps for the remote changes in its array of items.\nBranch.prototype.rebased = function rebased (rebasedTransform, rebasedCount) {\n  if (!this.eventCount) { return this }\n\n  var rebasedItems = [], start = Math.max(0, this.items.length - rebasedCount);\n\n  var mapping = rebasedTransform.mapping;\n  var newUntil = rebasedTransform.steps.length;\n  var eventCount = this.eventCount;\n  this.items.forEach(function (item) { if (item.selection) { eventCount--; } }, start);\n\n  var iRebased = rebasedCount;\n  this.items.forEach(function (item) {\n    var pos = mapping.getMirror(--iRebased);\n    if (pos == null) { return }\n    newUntil = Math.min(newUntil, pos);\n    var map = mapping.maps[pos];\n    if (item.step) {\n      var step = rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos]);\n      var selection = item.selection && item.selection.map(mapping.slice(iRebased + 1, pos));\n      if (selection) { eventCount++; }\n      rebasedItems.push(new Item(map, step, selection));\n    } else {\n      rebasedItems.push(new Item(map));\n    }\n  }, start);\n\n  var newMaps = [];\n  for (var i = rebasedCount; i < newUntil; i++)\n    { newMaps.push(new Item(mapping.maps[i])); }\n  var items = this.items.slice(0, start).append(newMaps).append(rebasedItems);\n  var branch = new Branch(items, eventCount);\n\n  if (branch.emptyItemCount() > max_empty_items)\n    { branch = branch.compress(this.items.length - rebasedItems.length); }\n  return branch\n};\n\nBranch.prototype.emptyItemCount = function emptyItemCount () {\n  var count = 0;\n  this.items.forEach(function (item) { if (!item.step) { count++; } });\n  return count\n};\n\n// Compressing a branch means rewriting it to push the air (map-only\n// items) out. During collaboration, these naturally accumulate\n// because each remote change adds one. The `upto` argument is used\n// to ensure that only the items below a given level are compressed,\n// because `rebased` relies on a clean, untouched set of items in\n// order to associate old items with rebased steps.\nBranch.prototype.compress = function compress (upto) {\n    if ( upto === void 0 ) upto = this.items.length;\n\n  var remap = this.remapping(0, upto), mapFrom = remap.maps.length;\n  var items = [], events = 0;\n  this.items.forEach(function (item, i) {\n    if (i >= upto) {\n      items.push(item);\n      if (item.selection) { events++; }\n    } else if (item.step) {\n      var step = item.step.map(remap.slice(mapFrom)), map = step && step.getMap();\n      mapFrom--;\n      if (map) { remap.appendMap(map, mapFrom); }\n      if (step) {\n        var selection = item.selection && item.selection.map(remap.slice(mapFrom));\n        if (selection) { events++; }\n        var newItem = new Item(map.invert(), step, selection), merged, last = items.length - 1;\n        if (merged = items.length && items[last].merge(newItem))\n          { items[last] = merged; }\n        else\n          { items.push(newItem); }\n      }\n    } else if (item.map) {\n      mapFrom--;\n    }\n  }, this.items.length, 0);\n  return new Branch(RopeSequence.from(items.reverse()), events)\n};\n\nBranch.empty = new Branch(RopeSequence.empty, 0);\n\nfunction cutOffEvents(items, n) {\n  var cutPoint;\n  items.forEach(function (item, i) {\n    if (item.selection && (n-- == 0)) {\n      cutPoint = i;\n      return false\n    }\n  });\n  return items.slice(cutPoint)\n}\n\nvar Item = function Item(map, step, selection, mirrorOffset) {\n  // The (forward) step map for this item.\n  this.map = map;\n  // The inverted step\n  this.step = step;\n  // If this is non-null, this item is the start of a group, and\n  // this selection is the starting selection for the group (the one\n  // that was active before the first step was applied)\n  this.selection = selection;\n  // If this item is the inverse of a previous mapping on the stack,\n  // this points at the inverse's offset\n  this.mirrorOffset = mirrorOffset;\n};\n\nItem.prototype.merge = function merge (other) {\n  if (this.step && other.step && !other.selection) {\n    var step = other.step.merge(this.step);\n    if (step) { return new Item(step.getMap().invert(), step, this.selection) }\n  }\n};\n\n// The value of the state field that tracks undo/redo history for that\n// state. Will be stored in the plugin state when the history plugin\n// is active.\nvar HistoryState = function HistoryState(done, undone, prevRanges, prevTime) {\n  this.done = done;\n  this.undone = undone;\n  this.prevRanges = prevRanges;\n  this.prevTime = prevTime;\n};\n\nvar DEPTH_OVERFLOW = 20;\n\n// : (HistoryState, EditorState, Transaction, Object)\n// Record a transformation in undo history.\nfunction applyTransaction(history, state, tr, options) {\n  var historyTr = tr.getMeta(historyKey), rebased;\n  if (historyTr) { return historyTr.historyState }\n\n  if (tr.getMeta(closeHistoryKey)) { history = new HistoryState(history.done, history.undone, null, 0); }\n\n  var appended = tr.getMeta(\"appendedTransaction\");\n\n  if (tr.steps.length == 0) {\n    return history\n  } else if (appended && appended.getMeta(historyKey)) {\n    if (appended.getMeta(historyKey).redo)\n      { return new HistoryState(history.done.addTransform(tr, null, options, mustPreserveItems(state)),\n                              history.undone, rangesFor(tr.mapping.maps[tr.steps.length - 1]), history.prevTime) }\n    else\n      { return new HistoryState(history.done, history.undone.addTransform(tr, null, options, mustPreserveItems(state)),\n                              null, history.prevTime) }\n  } else if (tr.getMeta(\"addToHistory\") !== false && !(appended && appended.getMeta(\"addToHistory\") === false)) {\n    // Group transforms that occur in quick succession into one event.\n    var newGroup = history.prevTime == 0 || !appended && (history.prevTime < (tr.time || 0) - options.newGroupDelay ||\n                                                          !isAdjacentTo(tr, history.prevRanges));\n    var prevRanges = appended ? mapRanges(history.prevRanges, tr.mapping) : rangesFor(tr.mapping.maps[tr.steps.length - 1]);\n    return new HistoryState(history.done.addTransform(tr, newGroup ? state.selection.getBookmark() : null,\n                                                      options, mustPreserveItems(state)),\n                            Branch.empty, prevRanges, tr.time)\n  } else if (rebased = tr.getMeta(\"rebased\")) {\n    // Used by the collab module to tell the history that some of its\n    // content has been rebased.\n    return new HistoryState(history.done.rebased(tr, rebased),\n                            history.undone.rebased(tr, rebased),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  } else {\n    return new HistoryState(history.done.addMaps(tr.mapping.maps),\n                            history.undone.addMaps(tr.mapping.maps),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  }\n}\n\nfunction isAdjacentTo(transform, prevRanges) {\n  if (!prevRanges) { return false }\n  if (!transform.docChanged) { return true }\n  var adjacent = false;\n  transform.mapping.maps[0].forEach(function (start, end) {\n    for (var i = 0; i < prevRanges.length; i += 2)\n      { if (start <= prevRanges[i + 1] && end >= prevRanges[i])\n        { adjacent = true; } }\n  });\n  return adjacent\n}\n\nfunction rangesFor(map) {\n  var result = [];\n  map.forEach(function (_from, _to, from, to) { return result.push(from, to); });\n  return result\n}\n\nfunction mapRanges(ranges, mapping) {\n  if (!ranges) { return null }\n  var result = [];\n  for (var i = 0; i < ranges.length; i += 2) {\n    var from = mapping.map(ranges[i], 1), to = mapping.map(ranges[i + 1], -1);\n    if (from <= to) { result.push(from, to); }\n  }\n  return result\n}\n\n// : (HistoryState, EditorState, (tr: Transaction), bool)\n// Apply the latest event from one branch to the document and shift the event\n// onto the other branch.\nfunction histTransaction(history, state, dispatch, redo) {\n  var preserveItems = mustPreserveItems(state), histOptions = historyKey.get(state).spec.config;\n  var pop = (redo ? history.undone : history.done).popEvent(state, preserveItems);\n  if (!pop) { return }\n\n  var selection = pop.selection.resolve(pop.transform.doc);\n  var added = (redo ? history.done : history.undone).addTransform(pop.transform, state.selection.getBookmark(),\n                                                                  histOptions, preserveItems);\n\n  var newHist = new HistoryState(redo ? added : pop.remaining, redo ? pop.remaining : added, null, 0);\n  dispatch(pop.transform.setSelection(selection).setMeta(historyKey, {redo: redo, historyState: newHist}).scrollIntoView());\n}\n\nvar cachedPreserveItems = false, cachedPreserveItemsPlugins = null;\n// Check whether any plugin in the given state has a\n// `historyPreserveItems` property in its spec, in which case we must\n// preserve steps exactly as they came in, so that they can be\n// rebased.\nfunction mustPreserveItems(state) {\n  var plugins = state.plugins;\n  if (cachedPreserveItemsPlugins != plugins) {\n    cachedPreserveItems = false;\n    cachedPreserveItemsPlugins = plugins;\n    for (var i = 0; i < plugins.length; i++) { if (plugins[i].spec.historyPreserveItems) {\n      cachedPreserveItems = true;\n      break\n    } }\n  }\n  return cachedPreserveItems\n}\n\n// :: (Transaction)  Transaction\n// Set a flag on the given transaction that will prevent further steps\n// from being appended to an existing history event (so that they\n// require a separate undo command to undo).\nfunction closeHistory(tr) {\n  return tr.setMeta(closeHistoryKey, true)\n}\n\nvar historyKey = new PluginKey(\"history\");\nvar closeHistoryKey = new PluginKey(\"closeHistory\");\n\n// :: (?Object)  Plugin\n// Returns a plugin that enables the undo history for an editor. The\n// plugin will track undo and redo stacks, which can be used with the\n// [`undo`](#history.undo) and [`redo`](#history.redo) commands.\n//\n// You can set an `\"addToHistory\"` [metadata\n// property](#state.Transaction.setMeta) of `false` on a transaction\n// to prevent it from being rolled back by undo.\n//\n//   config::-\n//   Supports the following configuration options:\n//\n//     depth:: ?number\n//     The amount of history events that are collected before the\n//     oldest events are discarded. Defaults to 100.\n//\n//     newGroupDelay:: ?number\n//     The delay between changes after which a new group should be\n//     started. Defaults to 500 (milliseconds). Note that when changes\n//     aren't adjacent, a new group is always started.\nfunction history(config) {\n  config = {depth: config && config.depth || 100,\n            newGroupDelay: config && config.newGroupDelay || 500};\n  return new Plugin({\n    key: historyKey,\n\n    state: {\n      init: function init() {\n        return new HistoryState(Branch.empty, Branch.empty, null, 0)\n      },\n      apply: function apply(tr, hist, state) {\n        return applyTransaction(hist, state, tr, config)\n      }\n    },\n\n    config: config\n  })\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// A command function that undoes the last change, if any.\nfunction undo(state, dispatch) {\n  var hist = historyKey.getState(state);\n  if (!hist || hist.done.eventCount == 0) { return false }\n  if (dispatch) { histTransaction(hist, state, dispatch, false); }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// A command function that redoes the last undone change, if any.\nfunction redo(state, dispatch) {\n  var hist = historyKey.getState(state);\n  if (!hist || hist.undone.eventCount == 0) { return false }\n  if (dispatch) { histTransaction(hist, state, dispatch, true); }\n  return true\n}\n\n// :: (EditorState)  number\n// The amount of undoable events available in a given state.\nfunction undoDepth(state) {\n  var hist = historyKey.getState(state);\n  return hist ? hist.done.eventCount : 0\n}\n\n// :: (EditorState)  number\n// The amount of redoable events available in a given editor state.\nfunction redoDepth(state) {\n  var hist = historyKey.getState(state);\n  return hist ? hist.undone.eventCount : 0\n}\n\nexport { HistoryState, closeHistory, history, redo, redoDepth, undo, undoDepth };\n//# sourceMappingURL=index.es.js.map\n","import { Plugin } from 'prosemirror-state';\nimport { findWrapping, canJoin } from 'prosemirror-transform';\n\n// ::- Input rules are regular expressions describing a piece of text\n// that, when typed, causes something to happen. This might be\n// changing two dashes into an emdash, wrapping a paragraph starting\n// with `\"> \"` into a blockquote, or something entirely different.\nvar InputRule = function InputRule(match, handler) {\n  this.match = match;\n  this.handler = typeof handler == \"string\" ? stringHandler(handler) : handler;\n};\n\nfunction stringHandler(string) {\n  return function(state, match, start, end) {\n    var insert = string;\n    if (match[1]) {\n      var offset = match[0].lastIndexOf(match[1]);\n      insert += match[0].slice(offset + match[1].length);\n      start += offset;\n      var cutOff = start - end;\n      if (cutOff > 0) {\n        insert = match[0].slice(offset - cutOff, offset) + insert;\n        start = end;\n      }\n    }\n    return state.tr.insertText(insert, start, end)\n  }\n}\n\nvar MAX_MATCH = 500;\n\n// :: (config: {rules: [InputRule]})  Plugin\n// Create an input rules plugin. When enabled, it will cause text\n// input that matches any of the given rules to trigger the rule's\n// action.\nfunction inputRules(ref) {\n  var rules = ref.rules;\n\n  var plugin = new Plugin({\n    state: {\n      init: function init() { return null },\n      apply: function apply(tr, prev) {\n        var stored = tr.getMeta(this);\n        if (stored) { return stored }\n        return tr.selectionSet || tr.docChanged ? null : prev\n      }\n    },\n\n    props: {\n      handleTextInput: function handleTextInput(view, from, to, text) {\n        return run(view, from, to, text, rules, plugin)\n      },\n      handleDOMEvents: {\n        compositionend: function (view) {\n          setTimeout(function () {\n            var ref = view.state.selection;\n            var $cursor = ref.$cursor;\n            if ($cursor) { run(view, $cursor.pos, $cursor.pos, \"\", rules, plugin); }\n          });\n        }\n      }\n    },\n\n    isInputRules: true\n  });\n  return plugin\n}\n\nfunction run(view, from, to, text, rules, plugin) {\n  if (view.composing) { return false }\n  var state = view.state, $from = state.doc.resolve(from);\n  if ($from.parent.type.spec.code) { return false }\n  var textBefore = $from.parent.textBetween(Math.max(0, $from.parentOffset - MAX_MATCH), $from.parentOffset,\n                                            null, \"\\ufffc\") + text;\n  for (var i = 0; i < rules.length; i++) {\n    var match = rules[i].match.exec(textBefore);\n    var tr = match && rules[i].handler(state, match, from - (match[0].length - text.length), to);\n    if (!tr) { continue }\n    view.dispatch(tr.setMeta(plugin, {transform: tr, from: from, to: to, text: text}));\n    return true\n  }\n  return false\n}\n\n// :: (EditorState, ?(Transaction))  bool\n// This is a command that will undo an input rule, if applying such a\n// rule was the last thing that the user did.\nfunction undoInputRule(state, dispatch) {\n  var plugins = state.plugins;\n  for (var i = 0; i < plugins.length; i++) {\n    var plugin = plugins[i], undoable = (void 0);\n    if (plugin.spec.isInputRules && (undoable = plugin.getState(state))) {\n      if (dispatch) {\n        var tr = state.tr, toUndo = undoable.transform;\n        for (var j = toUndo.steps.length - 1; j >= 0; j--)\n          { tr.step(toUndo.steps[j].invert(toUndo.docs[j])); }\n        if (undoable.text) {\n          var marks = tr.doc.resolve(undoable.from).marks();\n          tr.replaceWith(undoable.from, undoable.to, state.schema.text(undoable.text, marks));\n        } else {\n          tr.delete(undoable.from, undoable.to);\n        }\n        dispatch(tr);\n      }\n      return true\n    }\n  }\n  return false\n}\n\n// :: InputRule Converts double dashes to an emdash.\nvar emDash = new InputRule(/--$/, \"\");\n// :: InputRule Converts three dots to an ellipsis character.\nvar ellipsis = new InputRule(/\\.\\.\\.$/, \"\");\n// :: InputRule Smart opening double quotes.\nvar openDoubleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(\")$/, \"\");\n// :: InputRule Smart closing double quotes.\nvar closeDoubleQuote = new InputRule(/\"$/, \"\");\n// :: InputRule Smart opening single quotes.\nvar openSingleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(')$/, \"\");\n// :: InputRule Smart closing single quotes.\nvar closeSingleQuote = new InputRule(/'$/, \"\");\n\n// :: [InputRule] Smart-quote related input rules.\nvar smartQuotes = [openDoubleQuote, closeDoubleQuote, openSingleQuote, closeSingleQuote];\n\n// :: (RegExp, NodeType, ?union<Object, ([string])  ?Object>, ?([string], Node)  bool)  InputRule\n// Build an input rule for automatically wrapping a textblock when a\n// given string is typed. The `regexp` argument is\n// directly passed through to the `InputRule` constructor. You'll\n// probably want the regexp to start with `^`, so that the pattern can\n// only occur at the start of a textblock.\n//\n// `nodeType` is the type of node to wrap in. If it needs attributes,\n// you can either pass them directly, or pass a function that will\n// compute them from the regular expression match.\n//\n// By default, if there's a node with the same type above the newly\n// wrapped node, the rule will try to [join](#transform.Transform.join) those\n// two nodes. You can pass a join predicate, which takes a regular\n// expression match and the node before the wrapped node, and can\n// return a boolean to indicate whether a join should happen.\nfunction wrappingInputRule(regexp, nodeType, getAttrs, joinPredicate) {\n  return new InputRule(regexp, function (state, match, start, end) {\n    var attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    var tr = state.tr.delete(start, end);\n    var $start = tr.doc.resolve(start), range = $start.blockRange(), wrapping = range && findWrapping(range, nodeType, attrs);\n    if (!wrapping) { return null }\n    tr.wrap(range, wrapping);\n    var before = tr.doc.resolve(start - 1).nodeBefore;\n    if (before && before.type == nodeType && canJoin(tr.doc, start - 1) &&\n        (!joinPredicate || joinPredicate(match, before)))\n      { tr.join(start - 1); }\n    return tr\n  })\n}\n\n// :: (RegExp, NodeType, ?union<Object, ([string])  ?Object>)  InputRule\n// Build an input rule that changes the type of a textblock when the\n// matched text is typed into it. You'll usually want to start your\n// regexp with `^` to that it is only matched at the start of a\n// textblock. The optional `getAttrs` parameter can be used to compute\n// the new node's attributes, and works the same as in the\n// `wrappingInputRule` function.\nfunction textblockTypeInputRule(regexp, nodeType, getAttrs) {\n  return new InputRule(regexp, function (state, match, start, end) {\n    var $start = state.doc.resolve(start);\n    var attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    if (!$start.node(-1).canReplaceWith($start.index(-1), $start.indexAfter(-1), nodeType)) { return null }\n    return state.tr\n      .delete(start, end)\n      .setBlockType(start, start, nodeType, attrs)\n  })\n}\n\nexport { InputRule, closeDoubleQuote, closeSingleQuote, ellipsis, emDash, inputRules, openDoubleQuote, openSingleQuote, smartQuotes, textblockTypeInputRule, undoInputRule, wrappingInputRule };\n//# sourceMappingURL=index.es.js.map\n","import { findWrapping, ReplaceAroundStep, canSplit, liftTarget } from 'prosemirror-transform';\nimport { NodeRange, Fragment, Slice } from 'prosemirror-model';\n\nvar olDOM = [\"ol\", 0], ulDOM = [\"ul\", 0], liDOM = [\"li\", 0];\n\n// :: NodeSpec\n// An ordered list [node spec](#model.NodeSpec). Has a single\n// attribute, `order`, which determines the number at which the list\n// starts counting, and defaults to 1. Represented as an `<ol>`\n// element.\nvar orderedList = {\n  attrs: {order: {default: 1}},\n  parseDOM: [{tag: \"ol\", getAttrs: function getAttrs(dom) {\n    return {order: dom.hasAttribute(\"start\") ? +dom.getAttribute(\"start\") : 1}\n  }}],\n  toDOM: function toDOM(node) {\n    return node.attrs.order == 1 ? olDOM : [\"ol\", {start: node.attrs.order}, 0]\n  }\n};\n\n// :: NodeSpec\n// A bullet list node spec, represented in the DOM as `<ul>`.\nvar bulletList = {\n  parseDOM: [{tag: \"ul\"}],\n  toDOM: function toDOM() { return ulDOM }\n};\n\n// :: NodeSpec\n// A list item (`<li>`) spec.\nvar listItem = {\n  parseDOM: [{tag: \"li\"}],\n  toDOM: function toDOM() { return liDOM },\n  defining: true\n};\n\nfunction add(obj, props) {\n  var copy = {};\n  for (var prop in obj) { copy[prop] = obj[prop]; }\n  for (var prop$1 in props) { copy[prop$1] = props[prop$1]; }\n  return copy\n}\n\n// :: (OrderedMap<NodeSpec>, string, ?string)  OrderedMap<NodeSpec>\n// Convenience function for adding list-related node types to a map\n// specifying the nodes for a schema. Adds\n// [`orderedList`](#schema-list.orderedList) as `\"ordered_list\"`,\n// [`bulletList`](#schema-list.bulletList) as `\"bullet_list\"`, and\n// [`listItem`](#schema-list.listItem) as `\"list_item\"`.\n//\n// `itemContent` determines the content expression for the list items.\n// If you want the commands defined in this module to apply to your\n// list structure, it should have a shape like `\"paragraph block*\"` or\n// `\"paragraph (ordered_list | bullet_list)*\"`. `listGroup` can be\n// given to assign a group name to the list node types, for example\n// `\"block\"`.\nfunction addListNodes(nodes, itemContent, listGroup) {\n  return nodes.append({\n    ordered_list: add(orderedList, {content: \"list_item+\", group: listGroup}),\n    bullet_list: add(bulletList, {content: \"list_item+\", group: listGroup}),\n    list_item: add(listItem, {content: itemContent})\n  })\n}\n\n// :: (NodeType, ?Object)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Returns a command function that wraps the selection in a list with\n// the given type an attributes. If `dispatch` is null, only return a\n// value to indicate whether this is possible, but don't actually\n// perform the change.\nfunction wrapInList(listType, attrs) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var range = $from.blockRange($to), doJoin = false, outerRange = range;\n    if (!range) { return false }\n    // This is at the top of an existing list item\n    if (range.depth >= 2 && $from.node(range.depth - 1).type.compatibleContent(listType) && range.startIndex == 0) {\n      // Don't do anything if this is the top of the list\n      if ($from.index(range.depth - 1) == 0) { return false }\n      var $insert = state.doc.resolve(range.start - 2);\n      outerRange = new NodeRange($insert, $insert, range.depth);\n      if (range.endIndex < range.parent.childCount)\n        { range = new NodeRange($from, state.doc.resolve($to.end(range.depth)), range.depth); }\n      doJoin = true;\n    }\n    var wrap = findWrapping(outerRange, listType, attrs, range);\n    if (!wrap) { return false }\n    if (dispatch) { dispatch(doWrapInList(state.tr, range, wrap, doJoin, listType).scrollIntoView()); }\n    return true\n  }\n}\n\nfunction doWrapInList(tr, range, wrappers, joinBefore, listType) {\n  var content = Fragment.empty;\n  for (var i = wrappers.length - 1; i >= 0; i--)\n    { content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content)); }\n\n  tr.step(new ReplaceAroundStep(range.start - (joinBefore ? 2 : 0), range.end, range.start, range.end,\n                                new Slice(content, 0, 0), wrappers.length, true));\n\n  var found = 0;\n  for (var i$1 = 0; i$1 < wrappers.length; i$1++) { if (wrappers[i$1].type == listType) { found = i$1 + 1; } }\n  var splitDepth = wrappers.length - found;\n\n  var splitPos = range.start + wrappers.length - (joinBefore ? 2 : 0), parent = range.parent;\n  for (var i$2 = range.startIndex, e = range.endIndex, first = true; i$2 < e; i$2++, first = false) {\n    if (!first && canSplit(tr.doc, splitPos, splitDepth)) {\n      tr.split(splitPos, splitDepth);\n      splitPos += 2 * splitDepth;\n    }\n    splitPos += parent.child(i$2).nodeSize;\n  }\n  return tr\n}\n\n// :: (NodeType)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Build a command that splits a non-empty textblock at the top level\n// of a list item by also splitting that list item.\nfunction splitListItem(itemType) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var node = ref.node;\n    if ((node && node.isBlock) || $from.depth < 2 || !$from.sameParent($to)) { return false }\n    var grandParent = $from.node(-1);\n    if (grandParent.type != itemType) { return false }\n    if ($from.parent.content.size == 0 && $from.node(-1).childCount == $from.indexAfter(-1)) {\n      // In an empty block. If this is a nested list, the wrapping\n      // list item should be split. Otherwise, bail out and let next\n      // command handle lifting.\n      if ($from.depth == 2 || $from.node(-3).type != itemType ||\n          $from.index(-2) != $from.node(-2).childCount - 1) { return false }\n      if (dispatch) {\n        var wrap = Fragment.empty, keepItem = $from.index(-1) > 0;\n        // Build a fragment containing empty versions of the structure\n        // from the outer list item to the parent node of the cursor\n        for (var d = $from.depth - (keepItem ? 1 : 2); d >= $from.depth - 3; d--)\n          { wrap = Fragment.from($from.node(d).copy(wrap)); }\n        // Add a second list item with an empty default start node\n        wrap = wrap.append(Fragment.from(itemType.createAndFill()));\n        var tr$1 = state.tr.replace($from.before(keepItem ? null : -1), $from.after(-3), new Slice(wrap, keepItem ? 3 : 2, 2));\n        tr$1.setSelection(state.selection.constructor.near(tr$1.doc.resolve($from.pos + (keepItem ? 3 : 2))));\n        dispatch(tr$1.scrollIntoView());\n      }\n      return true\n    }\n    var nextType = $to.pos == $from.end() ? grandParent.contentMatchAt(0).defaultType : null;\n    var tr = state.tr.delete($from.pos, $to.pos);\n    var types = nextType && [null, {type: nextType}];\n    if (!canSplit(tr.doc, $from.pos, 2, types)) { return false }\n    if (dispatch) { dispatch(tr.split($from.pos, 2, types).scrollIntoView()); }\n    return true\n  }\n}\n\n// :: (NodeType)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Create a command to lift the list item around the selection up into\n// a wrapping list.\nfunction liftListItem(itemType) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var range = $from.blockRange($to, function (node) { return node.childCount && node.firstChild.type == itemType; });\n    if (!range) { return false }\n    if (!dispatch) { return true }\n    if ($from.node(range.depth - 1).type == itemType) // Inside a parent list\n      { return liftToOuterList(state, dispatch, itemType, range) }\n    else // Outer list node\n      { return liftOutOfList(state, dispatch, range) }\n  }\n}\n\nfunction liftToOuterList(state, dispatch, itemType, range) {\n  var tr = state.tr, end = range.end, endOfList = range.$to.end(range.depth);\n  if (end < endOfList) {\n    // There are siblings after the lifted items, which must become\n    // children of the last item\n    tr.step(new ReplaceAroundStep(end - 1, endOfList, end, endOfList,\n                                  new Slice(Fragment.from(itemType.create(null, range.parent.copy())), 1, 0), 1, true));\n    range = new NodeRange(tr.doc.resolve(range.$from.pos), tr.doc.resolve(endOfList), range.depth);\n  }\n  dispatch(tr.lift(range, liftTarget(range)).scrollIntoView());\n  return true\n}\n\nfunction liftOutOfList(state, dispatch, range) {\n  var tr = state.tr, list = range.parent;\n  // Merge the list items into a single big item\n  for (var pos = range.end, i = range.endIndex - 1, e = range.startIndex; i > e; i--) {\n    pos -= list.child(i).nodeSize;\n    tr.delete(pos - 1, pos + 1);\n  }\n  var $start = tr.doc.resolve(range.start), item = $start.nodeAfter;\n  var atStart = range.startIndex == 0, atEnd = range.endIndex == list.childCount;\n  var parent = $start.node(-1), indexBefore = $start.index(-1);\n  if (!parent.canReplace(indexBefore + (atStart ? 0 : 1), indexBefore + 1,\n                         item.content.append(atEnd ? Fragment.empty : Fragment.from(list))))\n    { return false }\n  var start = $start.pos, end = start + item.nodeSize;\n  // Strip off the surrounding list. At the sides where we're not at\n  // the end of the list, the existing list is closed. At sides where\n  // this is the end, it is overwritten to its end.\n  tr.step(new ReplaceAroundStep(start - (atStart ? 1 : 0), end + (atEnd ? 1 : 0), start + 1, end - 1,\n                                new Slice((atStart ? Fragment.empty : Fragment.from(list.copy(Fragment.empty)))\n                                          .append(atEnd ? Fragment.empty : Fragment.from(list.copy(Fragment.empty))),\n                                          atStart ? 0 : 1, atEnd ? 0 : 1), atStart ? 0 : 1));\n  dispatch(tr.scrollIntoView());\n  return true\n}\n\n// :: (NodeType)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Create a command to sink the list item around the selection down\n// into an inner list.\nfunction sinkListItem(itemType) {\n  return function(state, dispatch) {\n    var ref = state.selection;\n    var $from = ref.$from;\n    var $to = ref.$to;\n    var range = $from.blockRange($to, function (node) { return node.childCount && node.firstChild.type == itemType; });\n    if (!range) { return false }\n    var startIndex = range.startIndex;\n    if (startIndex == 0) { return false }\n    var parent = range.parent, nodeBefore = parent.child(startIndex - 1);\n    if (nodeBefore.type != itemType) { return false }\n\n    if (dispatch) {\n      var nestedBefore = nodeBefore.lastChild && nodeBefore.lastChild.type == parent.type;\n      var inner = Fragment.from(nestedBefore ? itemType.create() : null);\n      var slice = new Slice(Fragment.from(itemType.create(null, Fragment.from(parent.type.create(null, inner)))),\n                            nestedBefore ? 3 : 1, 0);\n      var before = range.start, after = range.end;\n      dispatch(state.tr.step(new ReplaceAroundStep(before - (nestedBefore ? 3 : 1), after,\n                                                   before, after, slice, 1, true))\n               .scrollIntoView());\n    }\n    return true\n  }\n}\n\nexport { addListNodes, bulletList, liftListItem, listItem, orderedList, sinkListItem, splitListItem, wrapInList };\n//# sourceMappingURL=index.es.js.map\n","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","import { TextSelection, NodeSelection, Selection } from 'prosemirror-state';\nimport { DOMSerializer, Fragment, Mark, DOMParser, Slice } from 'prosemirror-model';\nimport { dropPoint } from 'prosemirror-transform';\n\nvar result = {};\n\nif (typeof navigator != \"undefined\" && typeof document != \"undefined\") {\n  var ie_edge = /Edge\\/(\\d+)/.exec(navigator.userAgent);\n  var ie_upto10 = /MSIE \\d/.test(navigator.userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent);\n\n  result.mac = /Mac/.test(navigator.platform);\n  var ie = result.ie = !!(ie_upto10 || ie_11up || ie_edge);\n  result.ie_version = ie_upto10 ? document.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : null;\n  result.gecko = !ie && /gecko\\/(\\d+)/i.test(navigator.userAgent);\n  result.gecko_version = result.gecko && +(/Firefox\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n  var chrome = !ie && /Chrome\\/(\\d+)/.exec(navigator.userAgent);\n  result.chrome = !!chrome;\n  result.chrome_version = chrome && +chrome[1];\n  // Is true for both iOS and iPadOS for convenience\n  result.safari = !ie && /Apple Computer/.test(navigator.vendor);\n  result.ios = result.safari && (/Mobile\\/\\w+/.test(navigator.userAgent) || navigator.maxTouchPoints > 2);\n  result.android = /Android \\d/.test(navigator.userAgent);\n  result.webkit = \"webkitFontSmoothing\" in document.documentElement.style;\n  result.webkit_version = result.webkit && +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n}\n\nvar domIndex = function(node) {\n  for (var index = 0;; index++) {\n    node = node.previousSibling;\n    if (!node) { return index }\n  }\n};\n\nvar parentNode = function(node) {\n  var parent = node.parentNode;\n  return parent && parent.nodeType == 11 ? parent.host : parent\n};\n\nvar reusedRange = null;\n\n// Note that this will always return the same range, because DOM range\n// objects are every expensive, and keep slowing down subsequent DOM\n// updates, for some reason.\nvar textRange = function(node, from, to) {\n  var range = reusedRange || (reusedRange = document.createRange());\n  range.setEnd(node, to == null ? node.nodeValue.length : to);\n  range.setStart(node, from || 0);\n  return range\n};\n\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nvar isEquivalentPosition = function(node, off, targetNode, targetOff) {\n  return targetNode && (scanFor(node, off, targetNode, targetOff, -1) ||\n                        scanFor(node, off, targetNode, targetOff, 1))\n};\n\nvar atomElements = /^(img|br|input|textarea|hr)$/i;\n\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n  for (;;) {\n    if (node == targetNode && off == targetOff) { return true }\n    if (off == (dir < 0 ? 0 : nodeSize(node))) {\n      var parent = node.parentNode;\n      if (parent.nodeType != 1 || hasBlockDesc(node) || atomElements.test(node.nodeName) || node.contentEditable == \"false\")\n        { return false }\n      off = domIndex(node) + (dir < 0 ? 0 : 1);\n      node = parent;\n    } else if (node.nodeType == 1) {\n      node = node.childNodes[off + (dir < 0 ? -1 : 0)];\n      if (node.contentEditable == \"false\") { return false }\n      off = dir < 0 ? nodeSize(node) : 0;\n    } else {\n      return false\n    }\n  }\n}\n\nfunction nodeSize(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isOnEdge(node, offset, parent) {\n  for (var atStart = offset == 0, atEnd = offset == nodeSize(node); atStart || atEnd;) {\n    if (node == parent) { return true }\n    var index = domIndex(node);\n    node = node.parentNode;\n    if (!node) { return false }\n    atStart = atStart && index == 0;\n    atEnd = atEnd && index == nodeSize(node);\n  }\n}\n\nfunction hasBlockDesc(dom) {\n  var desc;\n  for (var cur = dom; cur; cur = cur.parentNode) { if (desc = cur.pmViewDesc) { break } }\n  return desc && desc.node && desc.node.isBlock && (desc.dom == dom || desc.contentDOM == dom)\n}\n\n// Work around Chrome issue https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n// (isCollapsed inappropriately returns true in shadow dom)\nvar selectionCollapsed = function(domSel) {\n  var collapsed = domSel.isCollapsed;\n  if (collapsed && result.chrome && domSel.rangeCount && !domSel.getRangeAt(0).collapsed)\n    { collapsed = false; }\n  return collapsed\n};\n\nfunction keyEvent(keyCode, key) {\n  var event = document.createEvent(\"Event\");\n  event.initEvent(\"keydown\", true, true);\n  event.keyCode = keyCode;\n  event.key = event.code = key;\n  return event\n}\n\nfunction windowRect(doc) {\n  return {left: 0, right: doc.documentElement.clientWidth,\n          top: 0, bottom: doc.documentElement.clientHeight}\n}\n\nfunction getSide(value, side) {\n  return typeof value == \"number\" ? value : value[side]\n}\n\nfunction clientRect(node) {\n  var rect = node.getBoundingClientRect();\n  // Make sure scrollbar width isn't included in the rectangle\n  return {left: rect.left, right: rect.left + node.clientWidth,\n          top: rect.top, bottom: rect.top + node.clientHeight}\n}\n\nfunction scrollRectIntoView(view, rect, startDOM) {\n  var scrollThreshold = view.someProp(\"scrollThreshold\") || 0, scrollMargin = view.someProp(\"scrollMargin\") || 5;\n  var doc = view.dom.ownerDocument;\n  for (var parent = startDOM || view.dom;; parent = parentNode(parent)) {\n    if (!parent) { break }\n    if (parent.nodeType != 1) { continue }\n    var atTop = parent == doc.body || parent.nodeType != 1;\n    var bounding = atTop ? windowRect(doc) : clientRect(parent);\n    var moveX = 0, moveY = 0;\n    if (rect.top < bounding.top + getSide(scrollThreshold, \"top\"))\n      { moveY = -(bounding.top - rect.top + getSide(scrollMargin, \"top\")); }\n    else if (rect.bottom > bounding.bottom - getSide(scrollThreshold, \"bottom\"))\n      { moveY = rect.bottom - bounding.bottom + getSide(scrollMargin, \"bottom\"); }\n    if (rect.left < bounding.left + getSide(scrollThreshold, \"left\"))\n      { moveX = -(bounding.left - rect.left + getSide(scrollMargin, \"left\")); }\n    else if (rect.right > bounding.right - getSide(scrollThreshold, \"right\"))\n      { moveX = rect.right - bounding.right + getSide(scrollMargin, \"right\"); }\n    if (moveX || moveY) {\n      if (atTop) {\n        doc.defaultView.scrollBy(moveX, moveY);\n      } else {\n        var startX = parent.scrollLeft, startY = parent.scrollTop;\n        if (moveY) { parent.scrollTop += moveY; }\n        if (moveX) { parent.scrollLeft += moveX; }\n        var dX = parent.scrollLeft - startX, dY = parent.scrollTop - startY;\n        rect = {left: rect.left - dX, top: rect.top - dY, right: rect.right - dX, bottom: rect.bottom - dY};\n      }\n    }\n    if (atTop) { break }\n  }\n}\n\n// Store the scroll position of the editor's parent nodes, along with\n// the top position of an element near the top of the editor, which\n// will be used to make sure the visible viewport remains stable even\n// when the size of the content above changes.\nfunction storeScrollPos(view) {\n  var rect = view.dom.getBoundingClientRect(), startY = Math.max(0, rect.top);\n  var refDOM, refTop;\n  for (var x = (rect.left + rect.right) / 2, y = startY + 1;\n       y < Math.min(innerHeight, rect.bottom); y += 5) {\n    var dom = view.root.elementFromPoint(x, y);\n    if (dom == view.dom || !view.dom.contains(dom)) { continue }\n    var localRect = dom.getBoundingClientRect();\n    if (localRect.top >= startY - 20) {\n      refDOM = dom;\n      refTop = localRect.top;\n      break\n    }\n  }\n  return {refDOM: refDOM, refTop: refTop, stack: scrollStack(view.dom)}\n}\n\nfunction scrollStack(dom) {\n  var stack = [], doc = dom.ownerDocument;\n  for (; dom; dom = parentNode(dom)) {\n    stack.push({dom: dom, top: dom.scrollTop, left: dom.scrollLeft});\n    if (dom == doc) { break }\n  }\n  return stack\n}\n\n// Reset the scroll position of the editor's parent nodes to that what\n// it was before, when storeScrollPos was called.\nfunction resetScrollPos(ref) {\n  var refDOM = ref.refDOM;\n  var refTop = ref.refTop;\n  var stack = ref.stack;\n\n  var newRefTop = refDOM ? refDOM.getBoundingClientRect().top : 0;\n  restoreScrollStack(stack, newRefTop == 0 ? 0 : newRefTop - refTop);\n}\n\nfunction restoreScrollStack(stack, dTop) {\n  for (var i = 0; i < stack.length; i++) {\n    var ref = stack[i];\n    var dom = ref.dom;\n    var top = ref.top;\n    var left = ref.left;\n    if (dom.scrollTop != top + dTop) { dom.scrollTop = top + dTop; }\n    if (dom.scrollLeft != left) { dom.scrollLeft = left; }\n  }\n}\n\nvar preventScrollSupported = null;\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nfunction focusPreventScroll(dom) {\n  if (dom.setActive) { return dom.setActive() } // in IE\n  if (preventScrollSupported) { return dom.focus(preventScrollSupported) }\n\n  var stored = scrollStack(dom);\n  dom.focus(preventScrollSupported == null ? {\n    get preventScroll() {\n      preventScrollSupported = {preventScroll: true};\n      return true\n    }\n  } : undefined);\n  if (!preventScrollSupported) {\n    preventScrollSupported = false;\n    restoreScrollStack(stored, 0);\n  }\n}\n\nfunction findOffsetInNode(node, coords) {\n  var closest, dxClosest = 2e8, coordsClosest, offset = 0;\n  var rowBot = coords.top, rowTop = coords.top;\n  for (var child = node.firstChild, childIndex = 0; child; child = child.nextSibling, childIndex++) {\n    var rects = (void 0);\n    if (child.nodeType == 1) { rects = child.getClientRects(); }\n    else if (child.nodeType == 3) { rects = textRange(child).getClientRects(); }\n    else { continue }\n\n    for (var i = 0; i < rects.length; i++) {\n      var rect = rects[i];\n      if (rect.top <= rowBot && rect.bottom >= rowTop) {\n        rowBot = Math.max(rect.bottom, rowBot);\n        rowTop = Math.min(rect.top, rowTop);\n        var dx = rect.left > coords.left ? rect.left - coords.left\n            : rect.right < coords.left ? coords.left - rect.right : 0;\n        if (dx < dxClosest) {\n          closest = child;\n          dxClosest = dx;\n          coordsClosest = dx && closest.nodeType == 3 ? {left: rect.right < coords.left ? rect.right : rect.left, top: coords.top} : coords;\n          if (child.nodeType == 1 && dx)\n            { offset = childIndex + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0); }\n          continue\n        }\n      }\n      if (!closest && (coords.left >= rect.right && coords.top >= rect.top ||\n                       coords.left >= rect.left && coords.top >= rect.bottom))\n        { offset = childIndex + 1; }\n    }\n  }\n  if (closest && closest.nodeType == 3) { return findOffsetInText(closest, coordsClosest) }\n  if (!closest || (dxClosest && closest.nodeType == 1)) { return {node: node, offset: offset} }\n  return findOffsetInNode(closest, coordsClosest)\n}\n\nfunction findOffsetInText(node, coords) {\n  var len = node.nodeValue.length;\n  var range = document.createRange();\n  for (var i = 0; i < len; i++) {\n    range.setEnd(node, i + 1);\n    range.setStart(node, i);\n    var rect = singleRect(range, 1);\n    if (rect.top == rect.bottom) { continue }\n    if (inRect(coords, rect))\n      { return {node: node, offset: i + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)} }\n  }\n  return {node: node, offset: 0}\n}\n\nfunction inRect(coords, rect) {\n  return coords.left >= rect.left - 1 && coords.left <= rect.right + 1&&\n    coords.top >= rect.top - 1 && coords.top <= rect.bottom + 1\n}\n\nfunction targetKludge(dom, coords) {\n  var parent = dom.parentNode;\n  if (parent && /^li$/i.test(parent.nodeName) && coords.left < dom.getBoundingClientRect().left)\n    { return parent }\n  return dom\n}\n\nfunction posFromElement(view, elt, coords) {\n  var ref = findOffsetInNode(elt, coords);\n  var node = ref.node;\n  var offset = ref.offset;\n  var bias = -1;\n  if (node.nodeType == 1 && !node.firstChild) {\n    var rect = node.getBoundingClientRect();\n    bias = rect.left != rect.right && coords.left > (rect.left + rect.right) / 2 ? 1 : -1;\n  }\n  return view.docView.posFromDOM(node, offset, bias)\n}\n\nfunction posFromCaret(view, node, offset, coords) {\n  // Browser (in caretPosition/RangeFromPoint) will agressively\n  // normalize towards nearby inline nodes. Since we are interested in\n  // positions between block nodes too, we first walk up the hierarchy\n  // of nodes to see if there are block nodes that the coordinates\n  // fall outside of. If so, we take the position before/after that\n  // block. If not, we call `posFromDOM` on the raw node/offset.\n  var outside = -1;\n  for (var cur = node;;) {\n    if (cur == view.dom) { break }\n    var desc = view.docView.nearestDesc(cur, true);\n    if (!desc) { return null }\n    if (desc.node.isBlock && desc.parent) {\n      var rect = desc.dom.getBoundingClientRect();\n      if (rect.left > coords.left || rect.top > coords.top) { outside = desc.posBefore; }\n      else if (rect.right < coords.left || rect.bottom < coords.top) { outside = desc.posAfter; }\n      else { break }\n    }\n    cur = desc.dom.parentNode;\n  }\n  return outside > -1 ? outside : view.docView.posFromDOM(node, offset)\n}\n\nfunction elementFromPoint(element, coords, box) {\n  var len = element.childNodes.length;\n  if (len && box.top < box.bottom) {\n    for (var startI = Math.max(0, Math.min(len - 1, Math.floor(len * (coords.top - box.top) / (box.bottom - box.top)) - 2)), i = startI;;) {\n      var child = element.childNodes[i];\n      if (child.nodeType == 1) {\n        var rects = child.getClientRects();\n        for (var j = 0; j < rects.length; j++) {\n          var rect = rects[j];\n          if (inRect(coords, rect)) { return elementFromPoint(child, coords, rect) }\n        }\n      }\n      if ((i = (i + 1) % len) == startI) { break }\n    }\n  }\n  return element\n}\n\n// Given an x,y position on the editor, get the position in the document.\nfunction posAtCoords(view, coords) {\n  var assign, assign$1;\n\n  var root = view.root, node, offset;\n  if (root.caretPositionFromPoint) {\n    try { // Firefox throws for this call in hard-to-predict circumstances (#994)\n      var pos$1 = root.caretPositionFromPoint(coords.left, coords.top);\n      if (pos$1) { ((assign = pos$1, node = assign.offsetNode, offset = assign.offset)); }\n    } catch (_) {}\n  }\n  if (!node && root.caretRangeFromPoint) {\n    var range = root.caretRangeFromPoint(coords.left, coords.top);\n    if (range) { ((assign$1 = range, node = assign$1.startContainer, offset = assign$1.startOffset)); }\n  }\n\n  var elt = root.elementFromPoint(coords.left, coords.top + 1), pos;\n  if (!elt || !view.dom.contains(elt.nodeType != 1 ? elt.parentNode : elt)) {\n    var box = view.dom.getBoundingClientRect();\n    if (!inRect(coords, box)) { return null }\n    elt = elementFromPoint(view.dom, coords, box);\n    if (!elt) { return null }\n  }\n  // Safari's caretRangeFromPoint returns nonsense when on a draggable element\n  if (result.safari && elt.draggable) { node = offset = null; }\n  elt = targetKludge(elt, coords);\n  if (node) {\n    if (result.gecko && node.nodeType == 1) {\n      // Firefox will sometimes return offsets into <input> nodes, which\n      // have no actual children, from caretPositionFromPoint (#953)\n      offset = Math.min(offset, node.childNodes.length);\n      // It'll also move the returned position before image nodes,\n      // even if those are behind it.\n      if (offset < node.childNodes.length) {\n        var next = node.childNodes[offset], box$1;\n        if (next.nodeName == \"IMG\" && (box$1 = next.getBoundingClientRect()).right <= coords.left &&\n            box$1.bottom > coords.top)\n          { offset++; }\n      }\n    }\n    // Suspiciously specific kludge to work around caret*FromPoint\n    // never returning a position at the end of the document\n    if (node == view.dom && offset == node.childNodes.length - 1 && node.lastChild.nodeType == 1 &&\n        coords.top > node.lastChild.getBoundingClientRect().bottom)\n      { pos = view.state.doc.content.size; }\n    // Ignore positions directly after a BR, since caret*FromPoint\n    // 'round up' positions that would be more accurately placed\n    // before the BR node.\n    else if (offset == 0 || node.nodeType != 1 || node.childNodes[offset - 1].nodeName != \"BR\")\n      { pos = posFromCaret(view, node, offset, coords); }\n  }\n  if (pos == null) { pos = posFromElement(view, elt, coords); }\n\n  var desc = view.docView.nearestDesc(elt, true);\n  return {pos: pos, inside: desc ? desc.posAtStart - desc.border : -1}\n}\n\nfunction singleRect(object, bias) {\n  var rects = object.getClientRects();\n  return !rects.length ? object.getBoundingClientRect() : rects[bias < 0 ? 0 : rects.length - 1]\n}\n\nvar BIDI = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n\n// : (EditorView, number, number)  {left: number, top: number, right: number, bottom: number}\n// Given a position in the document model, get a bounding box of the\n// character at that position, relative to the window.\nfunction coordsAtPos(view, pos, side) {\n  var ref = view.docView.domFromPos(pos, side < 0 ? -1 : 1);\n  var node = ref.node;\n  var offset = ref.offset;\n\n  var supportEmptyRange = result.webkit || result.gecko;\n  if (node.nodeType == 3) {\n    // These browsers support querying empty text ranges. Prefer that in\n    // bidi context or when at the end of a node.\n    if (supportEmptyRange && (BIDI.test(node.nodeValue) || (side < 0 ? !offset : offset == node.nodeValue.length))) {\n      var rect = singleRect(textRange(node, offset, offset), side);\n      // Firefox returns bad results (the position before the space)\n      // when querying a position directly after line-broken\n      // whitespace. Detect this situation and and kludge around it\n      if (result.gecko && offset && /\\s/.test(node.nodeValue[offset - 1]) && offset < node.nodeValue.length) {\n        var rectBefore = singleRect(textRange(node, offset - 1, offset - 1), -1);\n        if (rectBefore.top == rect.top) {\n          var rectAfter = singleRect(textRange(node, offset, offset + 1), -1);\n          if (rectAfter.top != rect.top)\n            { return flattenV(rectAfter, rectAfter.left < rectBefore.left) }\n        }\n      }\n      return rect\n    } else {\n      var from = offset, to = offset, takeSide = side < 0 ? 1 : -1;\n      if (side < 0 && !offset) { to++; takeSide = -1; }\n      else if (side >= 0 && offset == node.nodeValue.length) { from--; takeSide = 1; }\n      else if (side < 0) { from--; }\n      else { to ++; }\n      return flattenV(singleRect(textRange(node, from, to), takeSide), takeSide < 0)\n    }\n  }\n\n  // Return a horizontal line in block context\n  if (!view.state.doc.resolve(pos).parent.inlineContent) {\n    if (offset && (side < 0 || offset == nodeSize(node))) {\n      var before = node.childNodes[offset - 1];\n      if (before.nodeType == 1) { return flattenH(before.getBoundingClientRect(), false) }\n    }\n    if (offset < nodeSize(node)) {\n      var after = node.childNodes[offset];\n      if (after.nodeType == 1) { return flattenH(after.getBoundingClientRect(), true) }\n    }\n    return flattenH(node.getBoundingClientRect(), side >= 0)\n  }\n\n  // Inline, not in text node (this is not Bidi-safe)\n  if (offset && (side < 0 || offset == nodeSize(node))) {\n    var before$1 = node.childNodes[offset - 1];\n    var target = before$1.nodeType == 3 ? textRange(before$1, nodeSize(before$1) - (supportEmptyRange ? 0 : 1))\n        // BR nodes tend to only return the rectangle before them.\n        // Only use them if they are the last element in their parent\n        : before$1.nodeType == 1 && (before$1.nodeName != \"BR\" || !before$1.nextSibling) ? before$1 : null;\n    if (target) { return flattenV(singleRect(target, 1), false) }\n  }\n  if (offset < nodeSize(node)) {\n    var after$1 = node.childNodes[offset];\n    var target$1 = after$1.nodeType == 3 ? textRange(after$1, 0, (supportEmptyRange ? 0 : 1))\n        : after$1.nodeType == 1 ? after$1 : null;\n    if (target$1) { return flattenV(singleRect(target$1, -1), true) }\n  }\n  // All else failed, just try to get a rectangle for the target node\n  return flattenV(singleRect(node.nodeType == 3 ? textRange(node) : node, -side), side >= 0)\n}\n\nfunction flattenV(rect, left) {\n  if (rect.width == 0) { return rect }\n  var x = left ? rect.left : rect.right;\n  return {top: rect.top, bottom: rect.bottom, left: x, right: x}\n}\n\nfunction flattenH(rect, top) {\n  if (rect.height == 0) { return rect }\n  var y = top ? rect.top : rect.bottom;\n  return {top: y, bottom: y, left: rect.left, right: rect.right}\n}\n\nfunction withFlushedState(view, state, f) {\n  var viewState = view.state, active = view.root.activeElement;\n  if (viewState != state) { view.updateState(state); }\n  if (active != view.dom) { view.focus(); }\n  try {\n    return f()\n  } finally {\n    if (viewState != state) { view.updateState(viewState); }\n    if (active != view.dom && active) { active.focus(); }\n  }\n}\n\n// : (EditorView, number, number)\n// Whether vertical position motion in a given direction\n// from a position would leave a text block.\nfunction endOfTextblockVertical(view, state, dir) {\n  var sel = state.selection;\n  var $pos = dir == \"up\" ? sel.$from : sel.$to;\n  return withFlushedState(view, state, function () {\n    var ref = view.docView.domFromPos($pos.pos, dir == \"up\" ? -1 : 1);\n    var dom = ref.node;\n    for (;;) {\n      var nearest = view.docView.nearestDesc(dom, true);\n      if (!nearest) { break }\n      if (nearest.node.isBlock) { dom = nearest.dom; break }\n      dom = nearest.dom.parentNode;\n    }\n    var coords = coordsAtPos(view, $pos.pos, 1);\n    for (var child = dom.firstChild; child; child = child.nextSibling) {\n      var boxes = (void 0);\n      if (child.nodeType == 1) { boxes = child.getClientRects(); }\n      else if (child.nodeType == 3) { boxes = textRange(child, 0, child.nodeValue.length).getClientRects(); }\n      else { continue }\n      for (var i = 0; i < boxes.length; i++) {\n        var box = boxes[i];\n        if (box.bottom > box.top && (dir == \"up\" ? box.bottom < coords.top + 1 : box.top > coords.bottom - 1))\n          { return false }\n      }\n    }\n    return true\n  })\n}\n\nvar maybeRTL = /[\\u0590-\\u08ac]/;\n\nfunction endOfTextblockHorizontal(view, state, dir) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  if (!$head.parent.isTextblock) { return false }\n  var offset = $head.parentOffset, atStart = !offset, atEnd = offset == $head.parent.content.size;\n  var sel = getSelection();\n  // If the textblock is all LTR, or the browser doesn't support\n  // Selection.modify (Edge), fall back to a primitive approach\n  if (!maybeRTL.test($head.parent.textContent) || !sel.modify)\n    { return dir == \"left\" || dir == \"backward\" ? atStart : atEnd }\n\n  return withFlushedState(view, state, function () {\n    // This is a huge hack, but appears to be the best we can\n    // currently do: use `Selection.modify` to move the selection by\n    // one character, and see if that moves the cursor out of the\n    // textblock (or doesn't move it at all, when at the start/end of\n    // the document).\n    var oldRange = sel.getRangeAt(0), oldNode = sel.focusNode, oldOff = sel.focusOffset;\n    var oldBidiLevel = sel.caretBidiLevel; // Only for Firefox\n    sel.modify(\"move\", dir, \"character\");\n    var parentDOM = $head.depth ? view.docView.domAfterPos($head.before()) : view.dom;\n    var result = !parentDOM.contains(sel.focusNode.nodeType == 1 ? sel.focusNode : sel.focusNode.parentNode) ||\n        (oldNode == sel.focusNode && oldOff == sel.focusOffset);\n    // Restore the previous selection\n    sel.removeAllRanges();\n    sel.addRange(oldRange);\n    if (oldBidiLevel != null) { sel.caretBidiLevel = oldBidiLevel; }\n    return result\n  })\n}\n\nvar cachedState = null, cachedDir = null, cachedResult = false;\nfunction endOfTextblock(view, state, dir) {\n  if (cachedState == state && cachedDir == dir) { return cachedResult }\n  cachedState = state; cachedDir = dir;\n  return cachedResult = dir == \"up\" || dir == \"down\"\n    ? endOfTextblockVertical(view, state, dir)\n    : endOfTextblockHorizontal(view, state, dir)\n}\n\n// NodeView:: interface\n//\n// By default, document nodes are rendered using the result of the\n// [`toDOM`](#model.NodeSpec.toDOM) method of their spec, and managed\n// entirely by the editor. For some use cases, such as embedded\n// node-specific editing interfaces, you want more control over\n// the behavior of a node's in-editor representation, and need to\n// [define](#view.EditorProps.nodeViews) a custom node view.\n//\n// Mark views only support `dom` and `contentDOM`, and don't support\n// any of the node view methods.\n//\n// Objects returned as node views must conform to this interface.\n//\n//   dom:: ?dom.Node\n//   The outer DOM node that represents the document node. When not\n//   given, the default strategy is used to create a DOM node.\n//\n//   contentDOM:: ?dom.Node\n//   The DOM node that should hold the node's content. Only meaningful\n//   if the node view also defines a `dom` property and if its node\n//   type is not a leaf node type. When this is present, ProseMirror\n//   will take care of rendering the node's children into it. When it\n//   is not present, the node view itself is responsible for rendering\n//   (or deciding not to render) its child nodes.\n//\n//   update:: ?(node: Node, decorations: [Decoration])  bool\n//   When given, this will be called when the view is updating itself.\n//   It will be given a node (possibly of a different type), and an\n//   array of active decorations (which are automatically drawn, and\n//   the node view may ignore if it isn't interested in them), and\n//   should return true if it was able to update to that node, and\n//   false otherwise. If the node view has a `contentDOM` property (or\n//   no `dom` property), updating its child nodes will be handled by\n//   ProseMirror.\n//\n//   selectNode:: ?()\n//   Can be used to override the way the node's selected status (as a\n//   node selection) is displayed.\n//\n//   deselectNode:: ?()\n//   When defining a `selectNode` method, you should also provide a\n//   `deselectNode` method to remove the effect again.\n//\n//   setSelection:: ?(anchor: number, head: number, root: dom.Document)\n//   This will be called to handle setting the selection inside the\n//   node. The `anchor` and `head` positions are relative to the start\n//   of the node. By default, a DOM selection will be created between\n//   the DOM positions corresponding to those positions, but if you\n//   override it you can do something else.\n//\n//   stopEvent:: ?(event: dom.Event)  bool\n//   Can be used to prevent the editor view from trying to handle some\n//   or all DOM events that bubble up from the node view. Events for\n//   which this returns true are not handled by the editor.\n//\n//   ignoreMutation:: ?(dom.MutationRecord)  bool\n//   Called when a DOM\n//   [mutation](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)\n//   or a selection change happens within the view. When the change is\n//   a selection change, the record will have a `type` property of\n//   `\"selection\"` (which doesn't occur for native mutation records).\n//   Return false if the editor should re-read the selection or\n//   re-parse the range around the mutation, true if it can safely be\n//   ignored.\n//\n//   destroy:: ?()\n//   Called when the node view is removed from the editor or the whole\n//   editor is destroyed.\n\n// View descriptions are data structures that describe the DOM that is\n// used to represent the editor's content. They are used for:\n//\n// - Incremental redrawing when the document changes\n//\n// - Figuring out what part of the document a given DOM position\n//   corresponds to\n//\n// - Wiring in custom implementations of the editing interface for a\n//   given node\n//\n// They form a doubly-linked mutable tree, starting at `view.docView`.\n\nvar NOT_DIRTY = 0, CHILD_DIRTY = 1, CONTENT_DIRTY = 2, NODE_DIRTY = 3;\n\n// Superclass for the various kinds of descriptions. Defines their\n// basic structure and shared methods.\nvar ViewDesc = function ViewDesc(parent, children, dom, contentDOM) {\n  this.parent = parent;\n  this.children = children;\n  this.dom = dom;\n  // An expando property on the DOM node provides a link back to its\n  // description.\n  dom.pmViewDesc = this;\n  // This is the node that holds the child views. It may be null for\n  // descs that don't have children.\n  this.contentDOM = contentDOM;\n  this.dirty = NOT_DIRTY;\n};\n\nvar prototypeAccessors = { beforePosition: { configurable: true },size: { configurable: true },border: { configurable: true },posBefore: { configurable: true },posAtStart: { configurable: true },posAfter: { configurable: true },posAtEnd: { configurable: true },contentLost: { configurable: true },domAtom: { configurable: true } };\n\n// Used to check whether a given description corresponds to a\n// widget/mark/node.\nViewDesc.prototype.matchesWidget = function matchesWidget () { return false };\nViewDesc.prototype.matchesMark = function matchesMark () { return false };\nViewDesc.prototype.matchesNode = function matchesNode () { return false };\nViewDesc.prototype.matchesHack = function matchesHack () { return false };\n\nprototypeAccessors.beforePosition.get = function () { return false };\n\n// : ()  ?ParseRule\n// When parsing in-editor content (in domchange.js), we allow\n// descriptions to determine the parse rules that should be used to\n// parse them.\nViewDesc.prototype.parseRule = function parseRule () { return null };\n\n// : (dom.Event)  bool\n// Used by the editor's event handler to ignore events that come\n// from certain descs.\nViewDesc.prototype.stopEvent = function stopEvent () { return false };\n\n// The size of the content represented by this desc.\nprototypeAccessors.size.get = function () {\n  var size = 0;\n  for (var i = 0; i < this.children.length; i++) { size += this.children[i].size; }\n  return size\n};\n\n// For block nodes, this represents the space taken up by their\n// start/end tokens.\nprototypeAccessors.border.get = function () { return 0 };\n\nViewDesc.prototype.destroy = function destroy () {\n  this.parent = null;\n  if (this.dom.pmViewDesc == this) { this.dom.pmViewDesc = null; }\n  for (var i = 0; i < this.children.length; i++)\n    { this.children[i].destroy(); }\n};\n\nViewDesc.prototype.posBeforeChild = function posBeforeChild (child) {\n  for (var i = 0, pos = this.posAtStart; i < this.children.length; i++) {\n    var cur = this.children[i];\n    if (cur == child) { return pos }\n    pos += cur.size;\n  }\n};\n\nprototypeAccessors.posBefore.get = function () {\n  return this.parent.posBeforeChild(this)\n};\n\nprototypeAccessors.posAtStart.get = function () {\n  return this.parent ? this.parent.posBeforeChild(this) + this.border : 0\n};\n\nprototypeAccessors.posAfter.get = function () {\n  return this.posBefore + this.size\n};\n\nprototypeAccessors.posAtEnd.get = function () {\n  return this.posAtStart + this.size - 2 * this.border\n};\n\n// : (dom.Node, number, ?number)  number\nViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n  // If the DOM position is in the content, use the child desc after\n  // it to figure out a position.\n  if (this.contentDOM && this.contentDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode)) {\n    if (bias < 0) {\n      var domBefore, desc;\n      if (dom == this.contentDOM) {\n        domBefore = dom.childNodes[offset - 1];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domBefore = dom.previousSibling;\n      }\n      while (domBefore && !((desc = domBefore.pmViewDesc) && desc.parent == this)) { domBefore = domBefore.previousSibling; }\n      return domBefore ? this.posBeforeChild(desc) + desc.size : this.posAtStart\n    } else {\n      var domAfter, desc$1;\n      if (dom == this.contentDOM) {\n        domAfter = dom.childNodes[offset];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domAfter = dom.nextSibling;\n      }\n      while (domAfter && !((desc$1 = domAfter.pmViewDesc) && desc$1.parent == this)) { domAfter = domAfter.nextSibling; }\n      return domAfter ? this.posBeforeChild(desc$1) : this.posAtEnd\n    }\n  }\n  // Otherwise, use various heuristics, falling back on the bias\n  // parameter, to determine whether to return the position at the\n  // start or at the end of this view desc.\n  var atEnd;\n  if (this.contentDOM && this.contentDOM != this.dom && this.dom.contains(this.contentDOM)) {\n    atEnd = dom.compareDocumentPosition(this.contentDOM) & 2;\n  } else if (this.dom.firstChild) {\n    if (offset == 0) { for (var search = dom;; search = search.parentNode) {\n      if (search == this.dom) { atEnd = false; break }\n      if (search.parentNode.firstChild != search) { break }\n    } }\n    if (atEnd == null && offset == dom.childNodes.length) { for (var search$1 = dom;; search$1 = search$1.parentNode) {\n      if (search$1 == this.dom) { atEnd = true; break }\n      if (search$1.parentNode.lastChild != search$1) { break }\n    } }\n  }\n  return (atEnd == null ? bias > 0 : atEnd) ? this.posAtEnd : this.posAtStart\n};\n\n// Scan up the dom finding the first desc that is a descendant of\n// this one.\nViewDesc.prototype.nearestDesc = function nearestDesc (dom, onlyNodes) {\n  for (var first = true, cur = dom; cur; cur = cur.parentNode) {\n    var desc = this.getDesc(cur);\n    if (desc && (!onlyNodes || desc.node)) {\n      // If dom is outside of this desc's nodeDOM, don't count it.\n      if (first && desc.nodeDOM &&\n          !(desc.nodeDOM.nodeType == 1 ? desc.nodeDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode) : desc.nodeDOM == dom))\n        { first = false; }\n      else\n        { return desc }\n    }\n  }\n};\n\nViewDesc.prototype.getDesc = function getDesc (dom) {\n  var desc = dom.pmViewDesc;\n  for (var cur = desc; cur; cur = cur.parent) { if (cur == this) { return desc } }\n};\n\nViewDesc.prototype.posFromDOM = function posFromDOM (dom, offset, bias) {\n  for (var scan = dom; scan; scan = scan.parentNode) {\n    var desc = this.getDesc(scan);\n    if (desc) { return desc.localPosFromDOM(dom, offset, bias) }\n  }\n  return -1\n};\n\n// : (number)  ?NodeViewDesc\n// Find the desc for the node after the given pos, if any. (When a\n// parent node overrode rendering, there might not be one.)\nViewDesc.prototype.descAt = function descAt (pos) {\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == pos && end != offset) {\n      while (!child.border && child.children.length) { child = child.children[0]; }\n      return child\n    }\n    if (pos < end) { return child.descAt(pos - offset - child.border) }\n    offset = end;\n  }\n};\n\n// : (number, number)  {node: dom.Node, offset: number}\nViewDesc.prototype.domFromPos = function domFromPos (pos, side) {\n  if (!this.contentDOM) { return {node: this.dom, offset: 0} }\n  for (var offset = 0, i = 0, first = true;; i++, first = false) {\n    // Skip removed or always-before children\n    while (i < this.children.length && (this.children[i].beforePosition ||\n                                        this.children[i].dom.parentNode != this.contentDOM))\n      { offset += this.children[i++].size; }\n    var child = i == this.children.length ? null : this.children[i];\n    if (offset == pos && (side == 0 || !child || !child.size || child.border || (side < 0 && first)) ||\n        child && child.domAtom && pos < offset + child.size) { return {\n      node: this.contentDOM,\n      offset: child ? domIndex(child.dom) : this.contentDOM.childNodes.length\n    } }\n    if (!child) { throw new Error(\"Invalid position \" + pos) }\n    var end = offset + child.size;\n    if (!child.domAtom && (side < 0 && !child.border ? end >= pos : end > pos))\n      { return child.domFromPos(pos - offset - child.border, side) }\n    offset = end;\n  }\n};\n\n// Used to find a DOM range in a single parent for a given changed\n// range.\nViewDesc.prototype.parseRange = function parseRange (from, to, base) {\n    if ( base === void 0 ) base = 0;\n\n  if (this.children.length == 0)\n    { return {node: this.contentDOM, from: from, to: to, fromOffset: 0, toOffset: this.contentDOM.childNodes.length} }\n\n  var fromOffset = -1, toOffset = -1;\n  for (var offset = base, i = 0;; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (fromOffset == -1 && from <= end) {\n      var childBase = offset + child.border;\n      // FIXME maybe descend mark views to parse a narrower range?\n      if (from >= childBase && to <= end - child.border && child.node &&\n          child.contentDOM && this.contentDOM.contains(child.contentDOM))\n        { return child.parseRange(from, to, childBase) }\n\n      from = offset;\n      for (var j = i; j > 0; j--) {\n        var prev = this.children[j - 1];\n        if (prev.size && prev.dom.parentNode == this.contentDOM && !prev.emptyChildAt(1)) {\n          fromOffset = domIndex(prev.dom) + 1;\n          break\n        }\n        from -= prev.size;\n      }\n      if (fromOffset == -1) { fromOffset = 0; }\n    }\n    if (fromOffset > -1 && (end > to || i == this.children.length - 1)) {\n      to = end;\n      for (var j$1 = i + 1; j$1 < this.children.length; j$1++) {\n        var next = this.children[j$1];\n        if (next.size && next.dom.parentNode == this.contentDOM && !next.emptyChildAt(-1)) {\n          toOffset = domIndex(next.dom);\n          break\n        }\n        to += next.size;\n      }\n      if (toOffset == -1) { toOffset = this.contentDOM.childNodes.length; }\n      break\n    }\n    offset = end;\n  }\n  return {node: this.contentDOM, from: from, to: to, fromOffset: fromOffset, toOffset: toOffset}\n};\n\nViewDesc.prototype.emptyChildAt = function emptyChildAt (side) {\n  if (this.border || !this.contentDOM || !this.children.length) { return false }\n  var child = this.children[side < 0 ? 0 : this.children.length - 1];\n  return child.size == 0 || child.emptyChildAt(side)\n};\n\n// : (number)  dom.Node\nViewDesc.prototype.domAfterPos = function domAfterPos (pos) {\n  var ref = this.domFromPos(pos, 0);\n    var node = ref.node;\n    var offset = ref.offset;\n  if (node.nodeType != 1 || offset == node.childNodes.length)\n    { throw new RangeError(\"No node after pos \" + pos) }\n  return node.childNodes[offset]\n};\n\n// : (number, number, dom.Document)\n// View descs are responsible for setting any selection that falls\n// entirely inside of them, so that custom implementations can do\n// custom things with the selection. Note that this falls apart when\n// a selection starts in such a node and ends in another, in which\n// case we just use whatever domFromPos produces as a best effort.\nViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n  // If the selection falls entirely in a child, give it to that child\n  var from = Math.min(anchor, head), to = Math.max(anchor, head);\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (from > offset && to < end)\n      { return child.setSelection(anchor - offset - child.border, head - offset - child.border, root, force) }\n    offset = end;\n  }\n\n  var anchorDOM = this.domFromPos(anchor, anchor ? -1 : 1);\n  var headDOM = head == anchor ? anchorDOM : this.domFromPos(head, head ? -1 : 1);\n  var domSel = root.getSelection();\n\n  var brKludge = false;\n  // On Firefox, using Selection.collapse to put the cursor after a\n  // BR node for some reason doesn't always work (#1073). On Safari,\n  // the cursor sometimes inexplicable visually lags behind its\n  // reported position in such situations (#1092).\n  if ((result.gecko || result.safari) && anchor == head) {\n    var node = anchorDOM.node;\n      var offset$1 = anchorDOM.offset;\n    if (node.nodeType == 3) {\n      brKludge = offset$1 && node.nodeValue[offset$1 - 1] == \"\\n\";\n      // Issue #1128\n      if (brKludge && offset$1 == node.nodeValue.length &&\n          node.nextSibling && node.nextSibling.nodeName == \"BR\")\n        { anchorDOM = headDOM = {node: node.parentNode, offset: domIndex(node) + 1}; }\n    } else {\n      var prev = node.childNodes[offset$1 - 1];\n      brKludge = prev && (prev.nodeName == \"BR\" || prev.contentEditable == \"false\");\n    }\n  }\n\n  if (!(force || brKludge && result.safari) &&\n      isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset) &&\n      isEquivalentPosition(headDOM.node, headDOM.offset, domSel.focusNode, domSel.focusOffset))\n    { return }\n\n  // Selection.extend can be used to create an 'inverted' selection\n  // (one where the focus is before the anchor), but not all\n  // browsers support it yet.\n  var domSelExtended = false;\n  if ((domSel.extend || anchor == head) && !brKludge) {\n    domSel.collapse(anchorDOM.node, anchorDOM.offset);\n    try {\n      if (anchor != head) { domSel.extend(headDOM.node, headDOM.offset); }\n      domSelExtended = true;\n    } catch (err) {\n      // In some cases with Chrome the selection is empty after calling\n      // collapse, even when it should be valid. This appears to be a bug, but\n      // it is difficult to isolate. If this happens fallback to the old path\n      // without using extend.\n      if (!(err instanceof DOMException)) { throw err }\n      // declare global: DOMException\n    }\n  }\n  if (!domSelExtended) {\n    if (anchor > head) { var tmp = anchorDOM; anchorDOM = headDOM; headDOM = tmp; }\n    var range = document.createRange();\n    range.setEnd(headDOM.node, headDOM.offset);\n    range.setStart(anchorDOM.node, anchorDOM.offset);\n    domSel.removeAllRanges();\n    domSel.addRange(range);\n  }\n};\n\n// : (dom.MutationRecord)  bool\nViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n  return !this.contentDOM && mutation.type != \"selection\"\n};\n\nprototypeAccessors.contentLost.get = function () {\n  return this.contentDOM && this.contentDOM != this.dom && !this.dom.contains(this.contentDOM)\n};\n\n// Remove a subtree of the element tree that has been touched\n// by a DOM change, so that the next update will redraw it.\nViewDesc.prototype.markDirty = function markDirty (from, to) {\n  for (var offset = 0, i = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == end ? from <= end && to >= offset : from < end && to > offset) {\n      var startInside = offset + child.border, endInside = end - child.border;\n      if (from >= startInside && to <= endInside) {\n        this.dirty = from == offset || to == end ? CONTENT_DIRTY : CHILD_DIRTY;\n        if (from == startInside && to == endInside &&\n            (child.contentLost || child.dom.parentNode != this.contentDOM)) { child.dirty = NODE_DIRTY; }\n        else { child.markDirty(from - startInside, to - startInside); }\n        return\n      } else {\n        child.dirty = NODE_DIRTY;\n      }\n    }\n    offset = end;\n  }\n  this.dirty = CONTENT_DIRTY;\n};\n\nViewDesc.prototype.markParentsDirty = function markParentsDirty () {\n  var level = 1;\n  for (var node = this.parent; node; node = node.parent, level++) {\n    var dirty = level == 1 ? CONTENT_DIRTY : CHILD_DIRTY;\n    if (node.dirty < dirty) { node.dirty = dirty; }\n  }\n};\n\nprototypeAccessors.domAtom.get = function () { return false };\n\nObject.defineProperties( ViewDesc.prototype, prototypeAccessors );\n\n// Reused array to avoid allocating fresh arrays for things that will\n// stay empty anyway.\nvar nothing = [];\n\n// A widget desc represents a widget decoration, which is a DOM node\n// drawn between the document nodes.\nvar WidgetViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function WidgetViewDesc(parent, widget, view, pos) {\n    var self, dom = widget.type.toDOM;\n    if (typeof dom == \"function\") { dom = dom(view, function () {\n      if (!self) { return pos }\n      if (self.parent) { return self.parent.posBeforeChild(self) }\n    }); }\n    if (!widget.type.spec.raw) {\n      if (dom.nodeType != 1) {\n        var wrap = document.createElement(\"span\");\n        wrap.appendChild(dom);\n        dom = wrap;\n      }\n      dom.contentEditable = false;\n      dom.classList.add(\"ProseMirror-widget\");\n    }\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.widget = widget;\n    self = this;\n  }\n\n  if ( ViewDesc ) WidgetViewDesc.__proto__ = ViewDesc;\n  WidgetViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  WidgetViewDesc.prototype.constructor = WidgetViewDesc;\n\n  var prototypeAccessors$1 = { beforePosition: { configurable: true },domAtom: { configurable: true } };\n\n  prototypeAccessors$1.beforePosition.get = function () {\n    return this.widget.type.side < 0\n  };\n\n  WidgetViewDesc.prototype.matchesWidget = function matchesWidget (widget) {\n    return this.dirty == NOT_DIRTY && widget.type.eq(this.widget.type)\n  };\n\n  WidgetViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n\n  WidgetViewDesc.prototype.stopEvent = function stopEvent (event) {\n    var stop = this.widget.spec.stopEvent;\n    return stop ? stop(event) : false\n  };\n\n  WidgetViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"selection\" || this.widget.spec.ignoreSelection\n  };\n\n  prototypeAccessors$1.domAtom.get = function () { return true };\n\n  Object.defineProperties( WidgetViewDesc.prototype, prototypeAccessors$1 );\n\n  return WidgetViewDesc;\n}(ViewDesc));\n\nvar CompositionViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function CompositionViewDesc(parent, dom, textDOM, text) {\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.textDOM = textDOM;\n    this.text = text;\n  }\n\n  if ( ViewDesc ) CompositionViewDesc.__proto__ = ViewDesc;\n  CompositionViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  CompositionViewDesc.prototype.constructor = CompositionViewDesc;\n\n  var prototypeAccessors$2 = { size: { configurable: true } };\n\n  prototypeAccessors$2.size.get = function () { return this.text.length };\n\n  CompositionViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset) {\n    if (dom != this.textDOM) { return this.posAtStart + (offset ? this.size : 0) }\n    return this.posAtStart + offset\n  };\n\n  CompositionViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.textDOM, offset: pos}\n  };\n\n  CompositionViewDesc.prototype.ignoreMutation = function ignoreMutation (mut) {\n    return mut.type === 'characterData' && mut.target.nodeValue == mut.oldValue\n   };\n\n  Object.defineProperties( CompositionViewDesc.prototype, prototypeAccessors$2 );\n\n  return CompositionViewDesc;\n}(ViewDesc));\n\n// A mark desc represents a mark. May have multiple children,\n// depending on how the mark is split. Note that marks are drawn using\n// a fixed nesting order, for simplicity and predictability, so in\n// some cases they will be split more often than would appear\n// necessary.\nvar MarkViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function MarkViewDesc(parent, mark, dom, contentDOM) {\n    ViewDesc.call(this, parent, [], dom, contentDOM);\n    this.mark = mark;\n  }\n\n  if ( ViewDesc ) MarkViewDesc.__proto__ = ViewDesc;\n  MarkViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  MarkViewDesc.prototype.constructor = MarkViewDesc;\n\n  MarkViewDesc.create = function create (parent, mark, inline, view) {\n    var custom = view.nodeViews[mark.type.name];\n    var spec = custom && custom(mark, view, inline);\n    if (!spec || !spec.dom)\n      { spec = DOMSerializer.renderSpec(document, mark.type.spec.toDOM(mark, inline)); }\n    return new MarkViewDesc(parent, mark, spec.dom, spec.contentDOM || spec.dom)\n  };\n\n  MarkViewDesc.prototype.parseRule = function parseRule () { return {mark: this.mark.type.name, attrs: this.mark.attrs, contentElement: this.contentDOM} };\n\n  MarkViewDesc.prototype.matchesMark = function matchesMark (mark) { return this.dirty != NODE_DIRTY && this.mark.eq(mark) };\n\n  MarkViewDesc.prototype.markDirty = function markDirty (from, to) {\n    ViewDesc.prototype.markDirty.call(this, from, to);\n    // Move dirty info to nearest node view\n    if (this.dirty != NOT_DIRTY) {\n      var parent = this.parent;\n      while (!parent.node) { parent = parent.parent; }\n      if (parent.dirty < this.dirty) { parent.dirty = this.dirty; }\n      this.dirty = NOT_DIRTY;\n    }\n  };\n\n  MarkViewDesc.prototype.slice = function slice (from, to, view) {\n    var copy = MarkViewDesc.create(this.parent, this.mark, true, view);\n    var nodes = this.children, size = this.size;\n    if (to < size) { nodes = replaceNodes(nodes, to, size, view); }\n    if (from > 0) { nodes = replaceNodes(nodes, 0, from, view); }\n    for (var i = 0; i < nodes.length; i++) { nodes[i].parent = copy; }\n    copy.children = nodes;\n    return copy\n  };\n\n  return MarkViewDesc;\n}(ViewDesc));\n\n// Node view descs are the main, most common type of view desc, and\n// correspond to an actual node in the document. Unlike mark descs,\n// they populate their child array themselves.\nvar NodeViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos) {\n    ViewDesc.call(this, parent, node.isLeaf ? nothing : [], dom, contentDOM);\n    this.nodeDOM = nodeDOM;\n    this.node = node;\n    this.outerDeco = outerDeco;\n    this.innerDeco = innerDeco;\n    if (contentDOM) { this.updateChildren(view, pos); }\n  }\n\n  if ( ViewDesc ) NodeViewDesc.__proto__ = ViewDesc;\n  NodeViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  NodeViewDesc.prototype.constructor = NodeViewDesc;\n\n  var prototypeAccessors$3 = { size: { configurable: true },border: { configurable: true },domAtom: { configurable: true } };\n\n  // By default, a node is rendered using the `toDOM` method from the\n  // node type spec. But client code can use the `nodeViews` spec to\n  // supply a custom node view, which can influence various aspects of\n  // the way the node works.\n  //\n  // (Using subclassing for this was intentionally decided against,\n  // since it'd require exposing a whole slew of finnicky\n  // implementation details to the user code that they probably will\n  // never need.)\n  NodeViewDesc.create = function create (parent, node, outerDeco, innerDeco, view, pos) {\n    var assign;\n\n    var custom = view.nodeViews[node.type.name], descObj;\n    var spec = custom && custom(node, view, function () {\n      // (This is a function that allows the custom view to find its\n      // own position)\n      if (!descObj) { return pos }\n      if (descObj.parent) { return descObj.parent.posBeforeChild(descObj) }\n    }, outerDeco);\n\n    var dom = spec && spec.dom, contentDOM = spec && spec.contentDOM;\n    if (node.isText) {\n      if (!dom) { dom = document.createTextNode(node.text); }\n      else if (dom.nodeType != 3) { throw new RangeError(\"Text must be rendered as a DOM text node\") }\n    } else if (!dom) {\n((assign = DOMSerializer.renderSpec(document, node.type.spec.toDOM(node)), dom = assign.dom, contentDOM = assign.contentDOM));\n    }\n    if (!contentDOM && !node.isText && dom.nodeName != \"BR\") { // Chrome gets confused by <br contenteditable=false>\n      if (!dom.hasAttribute(\"contenteditable\")) { dom.contentEditable = false; }\n      if (node.type.spec.draggable) { dom.draggable = true; }\n    }\n\n    var nodeDOM = dom;\n    dom = applyOuterDeco(dom, outerDeco, node);\n\n    if (spec)\n      { return descObj = new CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM,\n                                              spec, view, pos + 1) }\n    else if (node.isText)\n      { return new TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) }\n    else\n      { return new NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos + 1) }\n  };\n\n  NodeViewDesc.prototype.parseRule = function parseRule () {\n    var this$1 = this;\n\n    // Experimental kludge to allow opt-in re-parsing of nodes\n    if (this.node.type.spec.reparseInView) { return null }\n    // FIXME the assumption that this can always return the current\n    // attrs means that if the user somehow manages to change the\n    // attrs in the dom, that won't be picked up. Not entirely sure\n    // whether this is a problem\n    var rule = {node: this.node.type.name, attrs: this.node.attrs};\n    if (this.node.type.spec.code) { rule.preserveWhitespace = \"full\"; }\n    if (this.contentDOM && !this.contentLost) { rule.contentElement = this.contentDOM; }\n    else { rule.getContent = function () { return this$1.contentDOM ? Fragment.empty : this$1.node.content; }; }\n    return rule\n  };\n\n  NodeViewDesc.prototype.matchesNode = function matchesNode (node, outerDeco, innerDeco) {\n    return this.dirty == NOT_DIRTY && node.eq(this.node) &&\n      sameOuterDeco(outerDeco, this.outerDeco) && innerDeco.eq(this.innerDeco)\n  };\n\n  prototypeAccessors$3.size.get = function () { return this.node.nodeSize };\n\n  prototypeAccessors$3.border.get = function () { return this.node.isLeaf ? 0 : 1 };\n\n  // Syncs `this.children` to match `this.node.content` and the local\n  // decorations, possibly introducing nesting for marks. Then, in a\n  // separate step, syncs the DOM inside `this.contentDOM` to\n  // `this.children`.\n  NodeViewDesc.prototype.updateChildren = function updateChildren (view, pos) {\n    var this$1 = this;\n\n    var inline = this.node.inlineContent, off = pos;\n    var composition = inline && view.composing && this.localCompositionNode(view, pos);\n    var updater = new ViewTreeUpdater(this, composition && composition.node);\n    iterDeco(this.node, this.innerDeco, function (widget, i, insideNode) {\n      if (widget.spec.marks)\n        { updater.syncToMarks(widget.spec.marks, inline, view); }\n      else if (widget.type.side >= 0 && !insideNode)\n        { updater.syncToMarks(i == this$1.node.childCount ? Mark.none : this$1.node.child(i).marks, inline, view); }\n      // If the next node is a desc matching this widget, reuse it,\n      // otherwise insert the widget as a new view desc.\n      updater.placeWidget(widget, view, off);\n    }, function (child, outerDeco, innerDeco, i) {\n      // Make sure the wrapping mark descs match the node's marks.\n      updater.syncToMarks(child.marks, inline, view);\n      // Either find an existing desc that exactly matches this node,\n      // and drop the descs before it.\n      updater.findNodeMatch(child, outerDeco, innerDeco, i) ||\n        // Or try updating the next desc to reflect this node.\n        updater.updateNextNode(child, outerDeco, innerDeco, view, i) ||\n        // Or just add it as a new desc.\n        updater.addNode(child, outerDeco, innerDeco, view, off);\n      off += child.nodeSize;\n    });\n    // Drop all remaining descs after the current position.\n    updater.syncToMarks(nothing, inline, view);\n    if (this.node.isTextblock) { updater.addTextblockHacks(); }\n    updater.destroyRest();\n\n    // Sync the DOM if anything changed\n    if (updater.changed || this.dirty == CONTENT_DIRTY) {\n      // May have to protect focused DOM from being changed if a composition is active\n      if (composition) { this.protectLocalComposition(view, composition); }\n      renderDescs(this.contentDOM, this.children, view);\n      if (result.ios) { iosHacks(this.dom); }\n    }\n  };\n\n  NodeViewDesc.prototype.localCompositionNode = function localCompositionNode (view, pos) {\n    // Only do something if both the selection and a focused text node\n    // are inside of this node, and the node isn't already part of a\n    // view that's a child of this view\n    var ref = view.state.selection;\n    var from = ref.from;\n    var to = ref.to;\n    if (!(view.state.selection instanceof TextSelection) || from < pos || to > pos + this.node.content.size) { return }\n    var sel = view.root.getSelection();\n    var textNode = nearbyTextNode(sel.focusNode, sel.focusOffset);\n    if (!textNode || !this.dom.contains(textNode.parentNode)) { return }\n\n    // Find the text in the focused node in the node, stop if it's not\n    // there (may have been modified through other means, in which\n    // case it should overwritten)\n    var text = textNode.nodeValue;\n    var textPos = findTextInFragment(this.node.content, text, from - pos, to - pos);\n\n    return textPos < 0 ? null : {node: textNode, pos: textPos, text: text}\n  };\n\n  NodeViewDesc.prototype.protectLocalComposition = function protectLocalComposition (view, ref) {\n    var node = ref.node;\n    var pos = ref.pos;\n    var text = ref.text;\n\n    // The node is already part of a local view desc, leave it there\n    if (this.getDesc(node)) { return }\n\n    // Create a composition view for the orphaned nodes\n    var topNode = node;\n    for (;; topNode = topNode.parentNode) {\n      if (topNode.parentNode == this.contentDOM) { break }\n      while (topNode.previousSibling) { topNode.parentNode.removeChild(topNode.previousSibling); }\n      while (topNode.nextSibling) { topNode.parentNode.removeChild(topNode.nextSibling); }\n      if (topNode.pmViewDesc) { topNode.pmViewDesc = null; }\n    }\n    var desc = new CompositionViewDesc(this, topNode, node, text);\n    view.compositionNodes.push(desc);\n\n    // Patch up this.children to contain the composition view\n    this.children = replaceNodes(this.children, pos, pos + text.length, view, desc);\n  };\n\n  // : (Node, [Decoration], DecorationSet, EditorView)  bool\n  // If this desc be updated to match the given node decoration,\n  // do so and return true.\n  NodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateInner(node, outerDeco, innerDeco, view);\n    return true\n  };\n\n  NodeViewDesc.prototype.updateInner = function updateInner (node, outerDeco, innerDeco, view) {\n    this.updateOuterDeco(outerDeco);\n    this.node = node;\n    this.innerDeco = innerDeco;\n    if (this.contentDOM) { this.updateChildren(view, this.posAtStart); }\n    this.dirty = NOT_DIRTY;\n  };\n\n  NodeViewDesc.prototype.updateOuterDeco = function updateOuterDeco (outerDeco) {\n    if (sameOuterDeco(outerDeco, this.outerDeco)) { return }\n    var needsWrap = this.nodeDOM.nodeType != 1;\n    var oldDOM = this.dom;\n    this.dom = patchOuterDeco(this.dom, this.nodeDOM,\n                              computeOuterDeco(this.outerDeco, this.node, needsWrap),\n                              computeOuterDeco(outerDeco, this.node, needsWrap));\n    if (this.dom != oldDOM) {\n      oldDOM.pmViewDesc = null;\n      this.dom.pmViewDesc = this;\n    }\n    this.outerDeco = outerDeco;\n  };\n\n  // Mark this node as being the selected node.\n  NodeViewDesc.prototype.selectNode = function selectNode () {\n    this.nodeDOM.classList.add(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.draggable = true; }\n  };\n\n  // Remove selected node marking from this node.\n  NodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.nodeDOM.classList.remove(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.removeAttribute(\"draggable\"); }\n  };\n\n  prototypeAccessors$3.domAtom.get = function () { return this.node.isAtom };\n\n  Object.defineProperties( NodeViewDesc.prototype, prototypeAccessors$3 );\n\n  return NodeViewDesc;\n}(ViewDesc));\n\n// Create a view desc for the top-level document node, to be exported\n// and used by the view class.\nfunction docViewDesc(doc, outerDeco, innerDeco, dom, view) {\n  applyOuterDeco(dom, outerDeco, doc);\n  return new NodeViewDesc(null, doc, outerDeco, innerDeco, dom, dom, dom, view, 0)\n}\n\nvar TextViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, null, nodeDOM, view);\n  }\n\n  if ( NodeViewDesc ) TextViewDesc.__proto__ = NodeViewDesc;\n  TextViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  TextViewDesc.prototype.constructor = TextViewDesc;\n\n  var prototypeAccessors$4 = { domAtom: { configurable: true } };\n\n  TextViewDesc.prototype.parseRule = function parseRule () {\n    var skip = this.nodeDOM.parentNode;\n    while (skip && skip != this.dom && !skip.pmIsDeco) { skip = skip.parentNode; }\n    return {skip: skip || true}\n  };\n\n  TextViewDesc.prototype.update = function update (node, outerDeco, _, view) {\n    if (this.dirty == NODE_DIRTY || (this.dirty != NOT_DIRTY && !this.inParent()) ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateOuterDeco(outerDeco);\n    if ((this.dirty != NOT_DIRTY || node.text != this.node.text) && node.text != this.nodeDOM.nodeValue) {\n      this.nodeDOM.nodeValue = node.text;\n      if (view.trackWrites == this.nodeDOM) { view.trackWrites = null; }\n    }\n    this.node = node;\n    this.dirty = NOT_DIRTY;\n    return true\n  };\n\n  TextViewDesc.prototype.inParent = function inParent () {\n    var parentDOM = this.parent.contentDOM;\n    for (var n = this.nodeDOM; n; n = n.parentNode) { if (n == parentDOM) { return true } }\n    return false\n  };\n\n  TextViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.nodeDOM, offset: pos}\n  };\n\n  TextViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n    if (dom == this.nodeDOM) { return this.posAtStart + Math.min(offset, this.node.text.length) }\n    return NodeViewDesc.prototype.localPosFromDOM.call(this, dom, offset, bias)\n  };\n\n  TextViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"characterData\" && mutation.type != \"selection\"\n  };\n\n  TextViewDesc.prototype.slice = function slice (from, to, view) {\n    var node = this.node.cut(from, to), dom = document.createTextNode(node.text);\n    return new TextViewDesc(this.parent, node, this.outerDeco, this.innerDeco, dom, dom, view)\n  };\n\n  prototypeAccessors$4.domAtom.get = function () { return false };\n\n  Object.defineProperties( TextViewDesc.prototype, prototypeAccessors$4 );\n\n  return TextViewDesc;\n}(NodeViewDesc));\n\n// A dummy desc used to tag trailing BR or span nodes created to work\n// around contentEditable terribleness.\nvar BRHackViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function BRHackViewDesc () {\n    ViewDesc.apply(this, arguments);\n  }\n\n  if ( ViewDesc ) BRHackViewDesc.__proto__ = ViewDesc;\n  BRHackViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  BRHackViewDesc.prototype.constructor = BRHackViewDesc;\n\n  var prototypeAccessors$5 = { domAtom: { configurable: true } };\n\n  BRHackViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n  BRHackViewDesc.prototype.matchesHack = function matchesHack () { return this.dirty == NOT_DIRTY };\n  prototypeAccessors$5.domAtom.get = function () { return true };\n\n  Object.defineProperties( BRHackViewDesc.prototype, prototypeAccessors$5 );\n\n  return BRHackViewDesc;\n}(ViewDesc));\n\n// A separate subclass is used for customized node views, so that the\n// extra checks only have to be made for nodes that are actually\n// customized.\nvar CustomNodeViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, spec, view, pos) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos);\n    this.spec = spec;\n  }\n\n  if ( NodeViewDesc ) CustomNodeViewDesc.__proto__ = NodeViewDesc;\n  CustomNodeViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  CustomNodeViewDesc.prototype.constructor = CustomNodeViewDesc;\n\n  // A custom `update` method gets to decide whether the update goes\n  // through. If it does, and there's a `contentDOM` node, our logic\n  // updates the children.\n  CustomNodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY) { return false }\n    if (this.spec.update) {\n      var result = this.spec.update(node, outerDeco);\n      if (result) { this.updateInner(node, outerDeco, innerDeco, view); }\n      return result\n    } else if (!this.contentDOM && !node.isLeaf) {\n      return false\n    } else {\n      return NodeViewDesc.prototype.update.call(this, node, outerDeco, innerDeco, view)\n    }\n  };\n\n  CustomNodeViewDesc.prototype.selectNode = function selectNode () {\n    this.spec.selectNode ? this.spec.selectNode() : NodeViewDesc.prototype.selectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.spec.deselectNode ? this.spec.deselectNode() : NodeViewDesc.prototype.deselectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n    this.spec.setSelection ? this.spec.setSelection(anchor, head, root)\n      : NodeViewDesc.prototype.setSelection.call(this, anchor, head, root, force);\n  };\n\n  CustomNodeViewDesc.prototype.destroy = function destroy () {\n    if (this.spec.destroy) { this.spec.destroy(); }\n    NodeViewDesc.prototype.destroy.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.stopEvent = function stopEvent (event) {\n    return this.spec.stopEvent ? this.spec.stopEvent(event) : false\n  };\n\n  CustomNodeViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return this.spec.ignoreMutation ? this.spec.ignoreMutation(mutation) : NodeViewDesc.prototype.ignoreMutation.call(this, mutation)\n  };\n\n  return CustomNodeViewDesc;\n}(NodeViewDesc));\n\n// : (dom.Node, [ViewDesc])\n// Sync the content of the given DOM node with the nodes associated\n// with the given array of view descs, recursing into mark descs\n// because this should sync the subtree for a whole node at a time.\nfunction renderDescs(parentDOM, descs, view) {\n  var dom = parentDOM.firstChild, written = false;\n  for (var i = 0; i < descs.length; i++) {\n    var desc = descs[i], childDOM = desc.dom;\n    if (childDOM.parentNode == parentDOM) {\n      while (childDOM != dom) { dom = rm(dom); written = true; }\n      dom = dom.nextSibling;\n    } else {\n      written = true;\n      parentDOM.insertBefore(childDOM, dom);\n    }\n    if (desc instanceof MarkViewDesc) {\n      var pos = dom ? dom.previousSibling : parentDOM.lastChild;\n      renderDescs(desc.contentDOM, desc.children, view);\n      dom = pos ? pos.nextSibling : parentDOM.firstChild;\n    }\n  }\n  while (dom) { dom = rm(dom); written = true; }\n  if (written && view.trackWrites == parentDOM) { view.trackWrites = null; }\n}\n\nfunction OuterDecoLevel(nodeName) {\n  if (nodeName) { this.nodeName = nodeName; }\n}\nOuterDecoLevel.prototype = Object.create(null);\n\nvar noDeco = [new OuterDecoLevel];\n\nfunction computeOuterDeco(outerDeco, node, needsWrap) {\n  if (outerDeco.length == 0) { return noDeco }\n\n  var top = needsWrap ? noDeco[0] : new OuterDecoLevel, result = [top];\n\n  for (var i = 0; i < outerDeco.length; i++) {\n    var attrs = outerDeco[i].type.attrs;\n    if (!attrs) { continue }\n    if (attrs.nodeName)\n      { result.push(top = new OuterDecoLevel(attrs.nodeName)); }\n\n    for (var name in attrs) {\n      var val = attrs[name];\n      if (val == null) { continue }\n      if (needsWrap && result.length == 1)\n        { result.push(top = new OuterDecoLevel(node.isInline ? \"span\" : \"div\")); }\n      if (name == \"class\") { top.class = (top.class ? top.class + \" \" : \"\") + val; }\n      else if (name == \"style\") { top.style = (top.style ? top.style + \";\" : \"\") + val; }\n      else if (name != \"nodeName\") { top[name] = val; }\n    }\n  }\n\n  return result\n}\n\nfunction patchOuterDeco(outerDOM, nodeDOM, prevComputed, curComputed) {\n  // Shortcut for trivial case\n  if (prevComputed == noDeco && curComputed == noDeco) { return nodeDOM }\n\n  var curDOM = nodeDOM;\n  for (var i = 0; i < curComputed.length; i++) {\n    var deco = curComputed[i], prev = prevComputed[i];\n    if (i) {\n      var parent = (void 0);\n      if (prev && prev.nodeName == deco.nodeName && curDOM != outerDOM &&\n          (parent = curDOM.parentNode) && parent.tagName.toLowerCase() == deco.nodeName) {\n        curDOM = parent;\n      } else {\n        parent = document.createElement(deco.nodeName);\n        parent.pmIsDeco = true;\n        parent.appendChild(curDOM);\n        prev = noDeco[0];\n        curDOM = parent;\n      }\n    }\n    patchAttributes(curDOM, prev || noDeco[0], deco);\n  }\n  return curDOM\n}\n\nfunction patchAttributes(dom, prev, cur) {\n  for (var name in prev)\n    { if (name != \"class\" && name != \"style\" && name != \"nodeName\" && !(name in cur))\n      { dom.removeAttribute(name); } }\n  for (var name$1 in cur)\n    { if (name$1 != \"class\" && name$1 != \"style\" && name$1 != \"nodeName\" && cur[name$1] != prev[name$1])\n      { dom.setAttribute(name$1, cur[name$1]); } }\n  if (prev.class != cur.class) {\n    var prevList = prev.class ? prev.class.split(\" \") : nothing;\n    var curList = cur.class ? cur.class.split(\" \") : nothing;\n    for (var i = 0; i < prevList.length; i++) { if (curList.indexOf(prevList[i]) == -1)\n      { dom.classList.remove(prevList[i]); } }\n    for (var i$1 = 0; i$1 < curList.length; i$1++) { if (prevList.indexOf(curList[i$1]) == -1)\n      { dom.classList.add(curList[i$1]); } }\n  }\n  if (prev.style != cur.style) {\n    if (prev.style) {\n      var prop = /\\s*([\\w\\-\\xa1-\\uffff]+)\\s*:(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|\\(.*?\\)|[^;])*/g, m;\n      while (m = prop.exec(prev.style))\n        { dom.style.removeProperty(m[1]); }\n    }\n    if (cur.style)\n      { dom.style.cssText += cur.style; }\n  }\n}\n\nfunction applyOuterDeco(dom, deco, node) {\n  return patchOuterDeco(dom, dom, noDeco, computeOuterDeco(deco, node, dom.nodeType != 1))\n}\n\n// : ([Decoration], [Decoration])  bool\nfunction sameOuterDeco(a, b) {\n  if (a.length != b.length) { return false }\n  for (var i = 0; i < a.length; i++) { if (!a[i].type.eq(b[i].type)) { return false } }\n  return true\n}\n\n// Remove a DOM node and return its next sibling.\nfunction rm(dom) {\n  var next = dom.nextSibling;\n  dom.parentNode.removeChild(dom);\n  return next\n}\n\n// Helper class for incrementally updating a tree of mark descs and\n// the widget and node descs inside of them.\nvar ViewTreeUpdater = function ViewTreeUpdater(top, lockedNode) {\n  this.top = top;\n  this.lock = lockedNode;\n  // Index into `this.top`'s child array, represents the current\n  // update position.\n  this.index = 0;\n  // When entering a mark, the current top and index are pushed\n  // onto this.\n  this.stack = [];\n  // Tracks whether anything was changed\n  this.changed = false;\n\n  var pre = preMatch(top.node.content, top.children);\n  this.preMatched = pre.nodes;\n  this.preMatchOffset = pre.offset;\n};\n\nViewTreeUpdater.prototype.getPreMatch = function getPreMatch (index) {\n  return index >= this.preMatchOffset ? this.preMatched[index - this.preMatchOffset] : null\n};\n\n// Destroy and remove the children between the given indices in\n// `this.top`.\nViewTreeUpdater.prototype.destroyBetween = function destroyBetween (start, end) {\n  if (start == end) { return }\n  for (var i = start; i < end; i++) { this.top.children[i].destroy(); }\n  this.top.children.splice(start, end - start);\n  this.changed = true;\n};\n\n// Destroy all remaining children in `this.top`.\nViewTreeUpdater.prototype.destroyRest = function destroyRest () {\n  this.destroyBetween(this.index, this.top.children.length);\n};\n\n// : ([Mark], EditorView)\n// Sync the current stack of mark descs with the given array of\n// marks, reusing existing mark descs when possible.\nViewTreeUpdater.prototype.syncToMarks = function syncToMarks (marks, inline, view) {\n  var keep = 0, depth = this.stack.length >> 1;\n  var maxKeep = Math.min(depth, marks.length);\n  while (keep < maxKeep &&\n         (keep == depth - 1 ? this.top : this.stack[(keep + 1) << 1]).matchesMark(marks[keep]) && marks[keep].type.spec.spanning !== false)\n    { keep++; }\n\n  while (keep < depth) {\n    this.destroyRest();\n    this.top.dirty = NOT_DIRTY;\n    this.index = this.stack.pop();\n    this.top = this.stack.pop();\n    depth--;\n  }\n  while (depth < marks.length) {\n    this.stack.push(this.top, this.index + 1);\n    var found = -1;\n    for (var i = this.index; i < Math.min(this.index + 3, this.top.children.length); i++) {\n      if (this.top.children[i].matchesMark(marks[depth])) { found = i; break }\n    }\n    if (found > -1) {\n      if (found > this.index) {\n        this.changed = true;\n        this.destroyBetween(this.index, found);\n      }\n      this.top = this.top.children[this.index];\n    } else {\n      var markDesc = MarkViewDesc.create(this.top, marks[depth], inline, view);\n      this.top.children.splice(this.index, 0, markDesc);\n      this.top = markDesc;\n      this.changed = true;\n    }\n    this.index = 0;\n    depth++;\n  }\n};\n\n// : (Node, [Decoration], DecorationSet)  bool\n// Try to find a node desc matching the given data. Skip over it and\n// return true when successful.\nViewTreeUpdater.prototype.findNodeMatch = function findNodeMatch (node, outerDeco, innerDeco, index) {\n  var found = -1, preMatch = index < 0 ? undefined : this.getPreMatch(index), children = this.top.children;\n  if (preMatch && preMatch.matchesNode(node, outerDeco, innerDeco)) {\n    found = children.indexOf(preMatch);\n  } else {\n    for (var i = this.index, e = Math.min(children.length, i + 5); i < e; i++) {\n      var child = children[i];\n      if (child.matchesNode(node, outerDeco, innerDeco) && this.preMatched.indexOf(child) < 0) {\n        found = i;\n        break\n      }\n    }\n  }\n  if (found < 0) { return false }\n  this.destroyBetween(this.index, found);\n  this.index++;\n  return true\n};\n\n// : (Node, [Decoration], DecorationSet, EditorView, Fragment, number)  bool\n// Try to update the next node, if any, to the given data. Checks\n// pre-matches to avoid overwriting nodes that could still be used.\nViewTreeUpdater.prototype.updateNextNode = function updateNextNode (node, outerDeco, innerDeco, view, index) {\n  for (var i = this.index; i < this.top.children.length; i++) {\n    var next = this.top.children[i];\n    if (next instanceof NodeViewDesc) {\n      var preMatch = this.preMatched.indexOf(next);\n      if (preMatch > -1 && preMatch + this.preMatchOffset != index) { return false }\n      var nextDOM = next.dom;\n\n      // Can't update if nextDOM is or contains this.lock, except if\n      // it's a text node whose content already matches the new text\n      // and whose decorations match the new ones.\n      var locked = this.lock && (nextDOM == this.lock || nextDOM.nodeType == 1 && nextDOM.contains(this.lock.parentNode)) &&\n          !(node.isText && next.node && next.node.isText && next.nodeDOM.nodeValue == node.text &&\n            next.dirty != NODE_DIRTY && sameOuterDeco(outerDeco, next.outerDeco));\n      if (!locked && next.update(node, outerDeco, innerDeco, view)) {\n        this.destroyBetween(this.index, i);\n        if (next.dom != nextDOM) { this.changed = true; }\n        this.index++;\n        return true\n      }\n      break\n    }\n  }\n  return false\n};\n\n// : (Node, [Decoration], DecorationSet, EditorView)\n// Insert the node as a newly created node desc.\nViewTreeUpdater.prototype.addNode = function addNode (node, outerDeco, innerDeco, view, pos) {\n  this.top.children.splice(this.index++, 0, NodeViewDesc.create(this.top, node, outerDeco, innerDeco, view, pos));\n  this.changed = true;\n};\n\nViewTreeUpdater.prototype.placeWidget = function placeWidget (widget, view, pos) {\n  var next = this.index < this.top.children.length ? this.top.children[this.index] : null;\n  if (next && next.matchesWidget(widget) && (widget == next.widget || !next.widget.type.toDOM.parentNode)) {\n    this.index++;\n  } else {\n    var desc = new WidgetViewDesc(this.top, widget, view, pos);\n    this.top.children.splice(this.index++, 0, desc);\n    this.changed = true;\n  }\n};\n\n// Make sure a textblock looks and behaves correctly in\n// contentEditable.\nViewTreeUpdater.prototype.addTextblockHacks = function addTextblockHacks () {\n  var lastChild = this.top.children[this.index - 1];\n  while (lastChild instanceof MarkViewDesc) { lastChild = lastChild.children[lastChild.children.length - 1]; }\n\n  if (!lastChild || // Empty textblock\n      !(lastChild instanceof TextViewDesc) ||\n      /\\n$/.test(lastChild.node.text)) {\n    if (this.index < this.top.children.length && this.top.children[this.index].matchesHack()) {\n      this.index++;\n    } else {\n      var dom = document.createElement(\"br\");\n      this.top.children.splice(this.index++, 0, new BRHackViewDesc(this.top, nothing, dom, null));\n      this.changed = true;\n    }\n  }\n};\n\n// : (Fragment, [ViewDesc])  [ViewDesc]\n// Iterate from the end of the fragment and array of descs to find\n// directly matching ones, in order to avoid overeagerly reusing\n// those for other nodes. Returns an array whose positions correspond\n// to node positions in the fragment, and whose elements are either\n// descs matched to the child at that index, or empty.\nfunction preMatch(frag, descs) {\n  var result = [], end = frag.childCount;\n  for (var i = descs.length - 1; end > 0 && i >= 0; i--) {\n    var desc = descs[i], node = desc.node;\n    if (!node) { continue }\n    if (node != frag.child(end - 1)) { break }\n    result.push(desc);\n    --end;\n  }\n  return {nodes: result.reverse(), offset: end}\n}\n\nfunction compareSide(a, b) { return a.type.side - b.type.side }\n\n// : (ViewDesc, DecorationSet, (Decoration, number), (Node, [Decoration], DecorationSet, number))\n// This function abstracts iterating over the nodes and decorations in\n// a fragment. Calls `onNode` for each node, with its local and child\n// decorations. Splits text nodes when there is a decoration starting\n// or ending inside of them. Calls `onWidget` for each widget.\nfunction iterDeco(parent, deco, onWidget, onNode) {\n  var locals = deco.locals(parent), offset = 0;\n  // Simple, cheap variant for when there are no local decorations\n  if (locals.length == 0) {\n    for (var i = 0; i < parent.childCount; i++) {\n      var child = parent.child(i);\n      onNode(child, locals, deco.forChild(offset, child), i);\n      offset += child.nodeSize;\n    }\n    return\n  }\n\n  var decoIndex = 0, active = [], restNode = null;\n  for (var parentIndex = 0;;) {\n    if (decoIndex < locals.length && locals[decoIndex].to == offset) {\n      var widget = locals[decoIndex++], widgets = (void 0);\n      while (decoIndex < locals.length && locals[decoIndex].to == offset)\n        { (widgets || (widgets = [widget])).push(locals[decoIndex++]); }\n      if (widgets) {\n        widgets.sort(compareSide);\n        for (var i$1 = 0; i$1 < widgets.length; i$1++) { onWidget(widgets[i$1], parentIndex, !!restNode); }\n      } else {\n        onWidget(widget, parentIndex, !!restNode);\n      }\n    }\n\n    var child$1 = (void 0), index = (void 0);\n    if (restNode) {\n      index = -1;\n      child$1 = restNode;\n      restNode = null;\n    } else if (parentIndex < parent.childCount) {\n      index = parentIndex;\n      child$1 = parent.child(parentIndex++);\n    } else {\n      break\n    }\n\n    for (var i$2 = 0; i$2 < active.length; i$2++) { if (active[i$2].to <= offset) { active.splice(i$2--, 1); } }\n    while (decoIndex < locals.length && locals[decoIndex].from <= offset && locals[decoIndex].to > offset)\n      { active.push(locals[decoIndex++]); }\n\n    var end = offset + child$1.nodeSize;\n    if (child$1.isText) {\n      var cutAt = end;\n      if (decoIndex < locals.length && locals[decoIndex].from < cutAt) { cutAt = locals[decoIndex].from; }\n      for (var i$3 = 0; i$3 < active.length; i$3++) { if (active[i$3].to < cutAt) { cutAt = active[i$3].to; } }\n      if (cutAt < end) {\n        restNode = child$1.cut(cutAt - offset);\n        child$1 = child$1.cut(0, cutAt - offset);\n        end = cutAt;\n        index = -1;\n      }\n    }\n\n    var outerDeco = !active.length ? nothing\n        : child$1.isInline && !child$1.isLeaf ? active.filter(function (d) { return !d.inline; })\n        : active.slice();\n    onNode(child$1, outerDeco, deco.forChild(offset, child$1), index);\n    offset = end;\n  }\n}\n\n// List markers in Mobile Safari will mysteriously disappear\n// sometimes. This works around that.\nfunction iosHacks(dom) {\n  if (dom.nodeName == \"UL\" || dom.nodeName == \"OL\") {\n    var oldCSS = dom.style.cssText;\n    dom.style.cssText = oldCSS + \"; list-style: square !important\";\n    window.getComputedStyle(dom).listStyle;\n    dom.style.cssText = oldCSS;\n  }\n}\n\nfunction nearbyTextNode(node, offset) {\n  for (;;) {\n    if (node.nodeType == 3) { return node }\n    if (node.nodeType == 1 && offset > 0) {\n      if (node.childNodes.length > offset && node.childNodes[offset].nodeType == 3)\n        { return node.childNodes[offset] }\n      node = node.childNodes[offset - 1];\n      offset = nodeSize(node);\n    } else if (node.nodeType == 1 && offset < node.childNodes.length) {\n      node = node.childNodes[offset];\n      offset = 0;\n    } else {\n      return null\n    }\n  }\n}\n\n// Find a piece of text in an inline fragment, overlapping from-to\nfunction findTextInFragment(frag, text, from, to) {\n  for (var i = 0, pos = 0; i < frag.childCount && pos <= to;) {\n    var child = frag.child(i++), childStart = pos;\n    pos += child.nodeSize;\n    if (!child.isText) { continue }\n    var str = child.text;\n    while (i < frag.childCount) {\n      var next = frag.child(i++);\n      pos += next.nodeSize;\n      if (!next.isText) { break }\n      str += next.text;\n    }\n    if (pos >= from) {\n      var found = str.lastIndexOf(text, to - childStart);\n      if (found >= 0 && found + text.length + childStart >= from)\n        { return childStart + found }\n    }\n  }\n  return -1\n}\n\n// Replace range from-to in an array of view descs with replacement\n// (may be null to just delete). This goes very much against the grain\n// of the rest of this code, which tends to create nodes with the\n// right shape in one go, rather than messing with them after\n// creation, but is necessary in the composition hack.\nfunction replaceNodes(nodes, from, to, view, replacement) {\n  var result = [];\n  for (var i = 0, off = 0; i < nodes.length; i++) {\n    var child = nodes[i], start = off, end = off += child.size;\n    if (start >= to || end <= from) {\n      result.push(child);\n    } else {\n      if (start < from) { result.push(child.slice(0, from - start, view)); }\n      if (replacement) {\n        result.push(replacement);\n        replacement = null;\n      }\n      if (end > to) { result.push(child.slice(to - start, child.size, view)); }\n    }\n  }\n  return result\n}\n\nfunction selectionFromDOM(view, origin) {\n  var domSel = view.root.getSelection(), doc = view.state.doc;\n  if (!domSel.focusNode) { return null }\n  var nearestDesc = view.docView.nearestDesc(domSel.focusNode), inWidget = nearestDesc && nearestDesc.size == 0;\n  var head = view.docView.posFromDOM(domSel.focusNode, domSel.focusOffset);\n  if (head < 0) { return null }\n  var $head = doc.resolve(head), $anchor, selection;\n  if (selectionCollapsed(domSel)) {\n    $anchor = $head;\n    while (nearestDesc && !nearestDesc.node) { nearestDesc = nearestDesc.parent; }\n    if (nearestDesc && nearestDesc.node.isAtom && NodeSelection.isSelectable(nearestDesc.node) && nearestDesc.parent\n        && !(nearestDesc.node.isInline && isOnEdge(domSel.focusNode, domSel.focusOffset, nearestDesc.dom))) {\n      var pos = nearestDesc.posBefore;\n      selection = new NodeSelection(head == pos ? $head : doc.resolve(pos));\n    }\n  } else {\n    var anchor = view.docView.posFromDOM(domSel.anchorNode, domSel.anchorOffset);\n    if (anchor < 0) { return null }\n    $anchor = doc.resolve(anchor);\n  }\n\n  if (!selection) {\n    var bias = origin == \"pointer\" || (view.state.selection.head < $head.pos && !inWidget) ? 1 : -1;\n    selection = selectionBetween(view, $anchor, $head, bias);\n  }\n  return selection\n}\n\nfunction selectionToDOM(view, force) {\n  var sel = view.state.selection;\n  syncNodeSelection(view, sel);\n\n  if (view.editable ? !view.hasFocus() :\n      !(hasSelection(view) && document.activeElement && document.activeElement.contains(view.dom))) { return }\n\n  view.domObserver.disconnectSelection();\n\n  if (view.cursorWrapper) {\n    selectCursorWrapper(view);\n  } else {\n    var anchor = sel.anchor;\n    var head = sel.head;\n    var resetEditableFrom, resetEditableTo;\n    if (brokenSelectBetweenUneditable && !(sel instanceof TextSelection)) {\n      if (!sel.$from.parent.inlineContent)\n        { resetEditableFrom = temporarilyEditableNear(view, sel.from); }\n      if (!sel.empty && !sel.$from.parent.inlineContent)\n        { resetEditableTo = temporarilyEditableNear(view, sel.to); }\n    }\n    view.docView.setSelection(anchor, head, view.root, force);\n    if (brokenSelectBetweenUneditable) {\n      if (resetEditableFrom) { resetEditable(resetEditableFrom); }\n      if (resetEditableTo) { resetEditable(resetEditableTo); }\n    }\n    if (sel.visible) {\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    } else {\n      view.dom.classList.add(\"ProseMirror-hideselection\");\n      if (\"onselectionchange\" in document) { removeClassOnSelectionChange(view); }\n    }\n  }\n\n  view.domObserver.setCurSelection();\n  view.domObserver.connectSelection();\n}\n\n// Kludge to work around Webkit not allowing a selection to start/end\n// between non-editable block nodes. We briefly make something\n// editable, set the selection, then set it uneditable again.\n\nvar brokenSelectBetweenUneditable = result.safari || result.chrome && result.chrome_version < 63;\n\nfunction temporarilyEditableNear(view, pos) {\n  var ref = view.docView.domFromPos(pos, 0);\n  var node = ref.node;\n  var offset = ref.offset;\n  var after = offset < node.childNodes.length ? node.childNodes[offset] : null;\n  var before = offset ? node.childNodes[offset - 1] : null;\n  if (result.safari && after && after.contentEditable == \"false\") { return setEditable(after) }\n  if ((!after || after.contentEditable == \"false\") && (!before || before.contentEditable == \"false\")) {\n    if (after) { return setEditable(after) }\n    else if (before) { return setEditable(before) }\n  }\n}\n\nfunction setEditable(element) {\n  element.contentEditable = \"true\";\n  if (result.safari && element.draggable) { element.draggable = false; element.wasDraggable = true; }\n  return element\n}\n\nfunction resetEditable(element) {\n  element.contentEditable = \"false\";\n  if (element.wasDraggable) { element.draggable = true; element.wasDraggable = null; }\n}\n\nfunction removeClassOnSelectionChange(view) {\n  var doc = view.dom.ownerDocument;\n  doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n  var domSel = view.root.getSelection();\n  var node = domSel.anchorNode, offset = domSel.anchorOffset;\n  doc.addEventListener(\"selectionchange\", view.hideSelectionGuard = function () {\n    if (domSel.anchorNode != node || domSel.anchorOffset != offset) {\n      doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    }\n  });\n}\n\nfunction selectCursorWrapper(view) {\n  var domSel = view.root.getSelection(), range = document.createRange();\n  var node = view.cursorWrapper.dom, img = node.nodeName == \"IMG\";\n  if (img) { range.setEnd(node.parentNode, domIndex(node) + 1); }\n  else { range.setEnd(node, 0); }\n  range.collapse(false);\n  domSel.removeAllRanges();\n  domSel.addRange(range);\n  // Kludge to kill 'control selection' in IE11 when selecting an\n  // invisible cursor wrapper, since that would result in those weird\n  // resize handles and a selection that considers the absolutely\n  // positioned wrapper, rather than the root editable node, the\n  // focused element.\n  if (!img && !view.state.selection.visible && result.ie && result.ie_version <= 11) {\n    node.disabled = true;\n    node.disabled = false;\n  }\n}\n\nfunction syncNodeSelection(view, sel) {\n  if (sel instanceof NodeSelection) {\n    var desc = view.docView.descAt(sel.from);\n    if (desc != view.lastSelectedViewDesc) {\n      clearNodeSelection(view);\n      if (desc) { desc.selectNode(); }\n      view.lastSelectedViewDesc = desc;\n    }\n  } else {\n    clearNodeSelection(view);\n  }\n}\n\n// Clear all DOM statefulness of the last node selection.\nfunction clearNodeSelection(view) {\n  if (view.lastSelectedViewDesc) {\n    if (view.lastSelectedViewDesc.parent)\n      { view.lastSelectedViewDesc.deselectNode(); }\n    view.lastSelectedViewDesc = null;\n  }\n}\n\nfunction selectionBetween(view, $anchor, $head, bias) {\n  return view.someProp(\"createSelectionBetween\", function (f) { return f(view, $anchor, $head); })\n    || TextSelection.between($anchor, $head, bias)\n}\n\nfunction hasFocusAndSelection(view) {\n  if (view.editable && view.root.activeElement != view.dom) { return false }\n  return hasSelection(view)\n}\n\nfunction hasSelection(view) {\n  var sel = view.root.getSelection();\n  if (!sel.anchorNode) { return false }\n  try {\n    // Firefox will raise 'permission denied' errors when accessing\n    // properties of `sel.anchorNode` when it's in a generated CSS\n    // element.\n    return view.dom.contains(sel.anchorNode.nodeType == 3 ? sel.anchorNode.parentNode : sel.anchorNode) &&\n      (view.editable || view.dom.contains(sel.focusNode.nodeType == 3 ? sel.focusNode.parentNode : sel.focusNode))\n  } catch(_) {\n    return false\n  }\n}\n\nfunction anchorInRightPlace(view) {\n  var anchorDOM = view.docView.domFromPos(view.state.selection.anchor, 0);\n  var domSel = view.root.getSelection();\n  return isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset)\n}\n\nfunction moveSelectionBlock(state, dir) {\n  var ref = state.selection;\n  var $anchor = ref.$anchor;\n  var $head = ref.$head;\n  var $side = dir > 0 ? $anchor.max($head) : $anchor.min($head);\n  var $start = !$side.parent.inlineContent ? $side : $side.depth ? state.doc.resolve(dir > 0 ? $side.after() : $side.before()) : null;\n  return $start && Selection.findFrom($start, dir)\n}\n\nfunction apply(view, sel) {\n  view.dispatch(view.state.tr.setSelection(sel).scrollIntoView());\n  return true\n}\n\nfunction selectHorizontally(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection) {\n    if (!sel.empty || mods.indexOf(\"s\") > -1) {\n      return false\n    } else if (view.endOfTextblock(dir > 0 ? \"right\" : \"left\")) {\n      var next = moveSelectionBlock(view.state, dir);\n      if (next && (next instanceof NodeSelection)) { return apply(view, next) }\n      return false\n    } else if (!(result.mac && mods.indexOf(\"m\") > -1)) {\n      var $head = sel.$head, node = $head.textOffset ? null : dir < 0 ? $head.nodeBefore : $head.nodeAfter, desc;\n      if (!node || node.isText) { return false }\n      var nodePos = dir < 0 ? $head.pos - node.nodeSize : $head.pos;\n      if (!(node.isAtom || (desc = view.docView.descAt(nodePos)) && !desc.contentDOM)) { return false }\n      if (NodeSelection.isSelectable(node)) {\n        return apply(view, new NodeSelection(dir < 0 ? view.state.doc.resolve($head.pos - node.nodeSize) : $head))\n      } else if (result.webkit) {\n        // Chrome and Safari will introduce extra pointless cursor\n        // positions around inline uneditable nodes, so we have to\n        // take over and move the cursor past them (#937)\n        return apply(view, new TextSelection(view.state.doc.resolve(dir < 0 ? nodePos : nodePos + node.nodeSize)))\n      } else {\n        return false\n      }\n    }\n  } else if (sel instanceof NodeSelection && sel.node.isInline) {\n    return apply(view, new TextSelection(dir > 0 ? sel.$to : sel.$from))\n  } else {\n    var next$1 = moveSelectionBlock(view.state, dir);\n    if (next$1) { return apply(view, next$1) }\n    return false\n  }\n}\n\nfunction nodeLen(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isIgnorable(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.size == 0 && (dom.nextSibling || dom.nodeName != \"BR\")\n}\n\n// Make sure the cursor isn't directly after one or more ignored\n// nodes, which will confuse the browser's cursor motion logic.\nfunction skipIgnoredNodesLeft(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var moveNode, moveOffset, force = false;\n  // Gecko will do odd things when the selection is directly in front\n  // of a non-editable node, so in that case, move it into the next\n  // node if possible. Issue prosemirror/prosemirror#832.\n  if (result.gecko && node.nodeType == 1 && offset < nodeLen(node) && isIgnorable(node.childNodes[offset])) { force = true; }\n  for (;;) {\n    if (offset > 0) {\n      if (node.nodeType != 1) {\n        break\n      } else {\n        var before = node.childNodes[offset - 1];\n        if (isIgnorable(before)) {\n          moveNode = node;\n          moveOffset = --offset;\n        } else if (before.nodeType == 3) {\n          node = before;\n          offset = node.nodeValue.length;\n        } else { break }\n      }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var prev = node.previousSibling;\n      while (prev && isIgnorable(prev)) {\n        moveNode = node.parentNode;\n        moveOffset = domIndex(prev);\n        prev = prev.previousSibling;\n      }\n      if (!prev) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = 0;\n      } else {\n        node = prev;\n        offset = nodeLen(node);\n      }\n    }\n  }\n  if (force) { setSelFocus(view, sel, node, offset); }\n  else if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\n// Make sure the cursor isn't directly before one or more ignored\n// nodes.\nfunction skipIgnoredNodesRight(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var len = nodeLen(node);\n  var moveNode, moveOffset;\n  for (;;) {\n    if (offset < len) {\n      if (node.nodeType != 1) { break }\n      var after = node.childNodes[offset];\n      if (isIgnorable(after)) {\n        moveNode = node;\n        moveOffset = ++offset;\n      }\n      else { break }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var next = node.nextSibling;\n      while (next && isIgnorable(next)) {\n        moveNode = next.parentNode;\n        moveOffset = domIndex(next) + 1;\n        next = next.nextSibling;\n      }\n      if (!next) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = len = 0;\n      } else {\n        node = next;\n        offset = 0;\n        len = nodeLen(node);\n      }\n    }\n  }\n  if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\nfunction isBlockNode(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.node && desc.node.isBlock\n}\n\nfunction setSelFocus(view, sel, node, offset) {\n  if (selectionCollapsed(sel)) {\n    var range = document.createRange();\n    range.setEnd(node, offset);\n    range.setStart(node, offset);\n    sel.removeAllRanges();\n    sel.addRange(range);\n  } else if (sel.extend) {\n    sel.extend(node, offset);\n  }\n  view.domObserver.setCurSelection();\n  var state = view.state;\n  // If no state update ends up happening, reset the selection.\n  setTimeout(function () {\n    if (view.state == state) { selectionToDOM(view); }\n  }, 50);\n}\n\n// : (EditorState, number)\n// Check whether vertical selection motion would involve node\n// selections. If so, apply it (if not, the result is left to the\n// browser)\nfunction selectVertically(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection && !sel.empty || mods.indexOf(\"s\") > -1) { return false }\n  if (result.mac && mods.indexOf(\"m\") > -1) { return false }\n  var $from = sel.$from;\n  var $to = sel.$to;\n\n  if (!$from.parent.inlineContent || view.endOfTextblock(dir < 0 ? \"up\" : \"down\")) {\n    var next = moveSelectionBlock(view.state, dir);\n    if (next && (next instanceof NodeSelection))\n      { return apply(view, next) }\n  }\n  if (!$from.parent.inlineContent) {\n    var beyond = Selection.findFrom(dir < 0 ? $from : $to, dir);\n    return beyond ? apply(view, beyond) : true\n  }\n  return false\n}\n\nfunction stopNativeHorizontalDelete(view, dir) {\n  if (!(view.state.selection instanceof TextSelection)) { return true }\n  var ref = view.state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  var empty = ref.empty;\n  if (!$head.sameParent($anchor)) { return true }\n  if (!empty) { return false }\n  if (view.endOfTextblock(dir > 0 ? \"forward\" : \"backward\")) { return true }\n  var nextNode = !$head.textOffset && (dir < 0 ? $head.nodeBefore : $head.nodeAfter);\n  if (nextNode && !nextNode.isText) {\n    var tr = view.state.tr;\n    if (dir < 0) { tr.delete($head.pos - nextNode.nodeSize, $head.pos); }\n    else { tr.delete($head.pos, $head.pos + nextNode.nodeSize); }\n    view.dispatch(tr);\n    return true\n  }\n  return false\n}\n\nfunction switchEditable(view, node, state) {\n  view.domObserver.stop();\n  node.contentEditable = state;\n  view.domObserver.start();\n}\n\n// Issue #867 / #1090 / https://bugs.chromium.org/p/chromium/issues/detail?id=903821\n// In which Safari (and at some point in the past, Chrome) does really\n// wrong things when the down arrow is pressed when the cursor is\n// directly at the start of a textblock and has an uneditable node\n// after it\nfunction safariDownArrowBug(view) {\n  if (!result.safari || view.state.selection.$head.parentOffset > 0) { return }\n  var ref = view.root.getSelection();\n  var focusNode = ref.focusNode;\n  var focusOffset = ref.focusOffset;\n  if (focusNode && focusNode.nodeType == 1 && focusOffset == 0 &&\n      focusNode.firstChild && focusNode.firstChild.contentEditable == \"false\") {\n    var child = focusNode.firstChild;\n    switchEditable(view, child, true);\n    setTimeout(function () { return switchEditable(view, child, false); }, 20);\n  }\n}\n\n// A backdrop key mapping used to make sure we always suppress keys\n// that have a dangerous default effect, even if the commands they are\n// bound to return false, and to make sure that cursor-motion keys\n// find a cursor (as opposed to a node selection) when pressed. For\n// cursor-motion keys, the code in the handlers also takes care of\n// block selections.\n\nfunction getMods(event) {\n  var result = \"\";\n  if (event.ctrlKey) { result += \"c\"; }\n  if (event.metaKey) { result += \"m\"; }\n  if (event.altKey) { result += \"a\"; }\n  if (event.shiftKey) { result += \"s\"; }\n  return result\n}\n\nfunction captureKeyDown(view, event) {\n  var code = event.keyCode, mods = getMods(event);\n  if (code == 8 || (result.mac && code == 72 && mods == \"c\")) { // Backspace, Ctrl-h on Mac\n    return stopNativeHorizontalDelete(view, -1) || skipIgnoredNodesLeft(view)\n  } else if (code == 46 || (result.mac && code == 68 && mods == \"c\")) { // Delete, Ctrl-d on Mac\n    return stopNativeHorizontalDelete(view, 1) || skipIgnoredNodesRight(view)\n  } else if (code == 13 || code == 27) { // Enter, Esc\n    return true\n  } else if (code == 37) { // Left arrow\n    return selectHorizontally(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 39) { // Right arrow\n    return selectHorizontally(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (code == 38) { // Up arrow\n    return selectVertically(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 40) { // Down arrow\n    return safariDownArrowBug(view) || selectVertically(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (mods == (result.mac ? \"m\" : \"c\") &&\n             (code == 66 || code == 73 || code == 89 || code == 90)) { // Mod-[biyz]\n    return true\n  }\n  return false\n}\n\n// Note that all referencing and parsing is done with the\n// start-of-operation selection and document, since that's the one\n// that the DOM represents. If any changes came in in the meantime,\n// the modification is mapped over those before it is applied, in\n// readDOMChange.\n\nfunction parseBetween(view, from_, to_) {\n  var ref = view.docView.parseRange(from_, to_);\n  var parent = ref.node;\n  var fromOffset = ref.fromOffset;\n  var toOffset = ref.toOffset;\n  var from = ref.from;\n  var to = ref.to;\n\n  var domSel = view.root.getSelection(), find = null, anchor = domSel.anchorNode;\n  if (anchor && view.dom.contains(anchor.nodeType == 1 ? anchor : anchor.parentNode)) {\n    find = [{node: anchor, offset: domSel.anchorOffset}];\n    if (!selectionCollapsed(domSel))\n      { find.push({node: domSel.focusNode, offset: domSel.focusOffset}); }\n  }\n  // Work around issue in Chrome where backspacing sometimes replaces\n  // the deleted content with a random BR node (issues #799, #831)\n  if (result.chrome && view.lastKeyCode === 8) {\n    for (var off = toOffset; off > fromOffset; off--) {\n      var node = parent.childNodes[off - 1], desc = node.pmViewDesc;\n      if (node.nodeType == \"BR\" && !desc) { toOffset = off; break }\n      if (!desc || desc.size) { break }\n    }\n  }\n  var startDoc = view.state.doc;\n  var parser = view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n  var $from = startDoc.resolve(from);\n\n  var sel = null, doc = parser.parse(parent, {\n    topNode: $from.parent,\n    topMatch: $from.parent.contentMatchAt($from.index()),\n    topOpen: true,\n    from: fromOffset,\n    to: toOffset,\n    preserveWhitespace: $from.parent.type.spec.code ? \"full\" : true,\n    editableContent: true,\n    findPositions: find,\n    ruleFromNode: ruleFromNode,\n    context: $from\n  });\n  if (find && find[0].pos != null) {\n    var anchor$1 = find[0].pos, head = find[1] && find[1].pos;\n    if (head == null) { head = anchor$1; }\n    sel = {anchor: anchor$1 + from, head: head + from};\n  }\n  return {doc: doc, sel: sel, from: from, to: to}\n}\n\nfunction ruleFromNode(dom) {\n  var desc = dom.pmViewDesc;\n  if (desc) {\n    return desc.parseRule()\n  } else if (dom.nodeName == \"BR\" && dom.parentNode) {\n    // Safari replaces the list item or table cell with a BR\n    // directly in the list node (?!) if you delete the last\n    // character in a list item or table cell (#708, #862)\n    if (result.safari && /^(ul|ol)$/i.test(dom.parentNode.nodeName)) {\n      var skip = document.createElement(\"div\");\n      skip.appendChild(document.createElement(\"li\"));\n      return {skip: skip}\n    } else if (dom.parentNode.lastChild == dom || result.safari && /^(tr|table)$/i.test(dom.parentNode.nodeName)) {\n      return {ignore: true}\n    }\n  } else if (dom.nodeName == \"IMG\" && dom.getAttribute(\"mark-placeholder\")) {\n    return {ignore: true}\n  }\n}\n\nfunction readDOMChange(view, from, to, typeOver, addedNodes) {\n  if (from < 0) {\n    var origin = view.lastSelectionTime > Date.now() - 50 ? view.lastSelectionOrigin : null;\n    var newSel = selectionFromDOM(view, origin);\n    if (newSel && !view.state.selection.eq(newSel)) {\n      var tr$1 = view.state.tr.setSelection(newSel);\n      if (origin == \"pointer\") { tr$1.setMeta(\"pointer\", true); }\n      else if (origin == \"key\") { tr$1.scrollIntoView(); }\n      view.dispatch(tr$1);\n    }\n    return\n  }\n\n  var $before = view.state.doc.resolve(from);\n  var shared = $before.sharedDepth(to);\n  from = $before.before(shared + 1);\n  to = view.state.doc.resolve(to).after(shared + 1);\n\n  var sel = view.state.selection;\n  var parse = parseBetween(view, from, to);\n  // Chrome sometimes leaves the cursor before the inserted text when\n  // composing after a cursor wrapper. This moves it forward.\n  if (result.chrome && view.cursorWrapper && parse.sel && parse.sel.anchor == view.cursorWrapper.deco.from) {\n    var text = view.cursorWrapper.deco.type.toDOM.nextSibling;\n    var size = text && text.nodeValue ? text.nodeValue.length : 1;\n    parse.sel = {anchor: parse.sel.anchor + size, head: parse.sel.anchor + size};\n  }\n\n  var doc = view.state.doc, compare = doc.slice(parse.from, parse.to);\n  var preferredPos, preferredSide;\n  // Prefer anchoring to end when Backspace is pressed\n  if (view.lastKeyCode === 8 && Date.now() - 100 < view.lastKeyCodeTime) {\n    preferredPos = view.state.selection.to;\n    preferredSide = \"end\";\n  } else {\n    preferredPos = view.state.selection.from;\n    preferredSide = \"start\";\n  }\n  view.lastKeyCode = null;\n\n  var change = findDiff(compare.content, parse.doc.content, parse.from, preferredPos, preferredSide);\n  if (!change) {\n    if (typeOver && sel instanceof TextSelection && !sel.empty && sel.$head.sameParent(sel.$anchor) &&\n        !view.composing && !(parse.sel && parse.sel.anchor != parse.sel.head)) {\n      change = {start: sel.from, endA: sel.to, endB: sel.to};\n    } else if (result.ios && view.lastIOSEnter > Date.now() - 225 &&\n               addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }) &&\n               view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n      view.lastIOSEnter = 0;\n      return\n    } else {\n      if (parse.sel) {\n        var sel$1 = resolveSelection(view, view.state.doc, parse.sel);\n        if (sel$1 && !sel$1.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel$1)); }\n      }\n      return\n    }\n  }\n  view.domChangeCount++;\n  // Handle the case where overwriting a selection by typing matches\n  // the start or end of the selected content, creating a change\n  // that's smaller than what was actually overwritten.\n  if (view.state.selection.from < view.state.selection.to &&\n      change.start == change.endB &&\n      view.state.selection instanceof TextSelection) {\n    if (change.start > view.state.selection.from && change.start <= view.state.selection.from + 2) {\n      change.start = view.state.selection.from;\n    } else if (change.endA < view.state.selection.to && change.endA >= view.state.selection.to - 2) {\n      change.endB += (view.state.selection.to - change.endA);\n      change.endA = view.state.selection.to;\n    }\n  }\n\n  // IE11 will insert a non-breaking space _ahead_ of the space after\n  // the cursor space when adding a space before another space. When\n  // that happened, adjust the change to cover the space instead.\n  if (result.ie && result.ie_version <= 11 && change.endB == change.start + 1 &&\n      change.endA == change.start && change.start > parse.from &&\n      parse.doc.textBetween(change.start - parse.from - 1, change.start - parse.from + 1) == \" \\u00a0\") {\n    change.start--;\n    change.endA--;\n    change.endB--;\n  }\n\n  var $from = parse.doc.resolveNoCache(change.start - parse.from);\n  var $to = parse.doc.resolveNoCache(change.endB - parse.from);\n  var inlineChange = $from.sameParent($to) && $from.parent.inlineContent;\n  var nextSel;\n  // If this looks like the effect of pressing Enter (or was recorded\n  // as being an iOS enter press), just dispatch an Enter key instead.\n  if (((result.ios && view.lastIOSEnter > Date.now() - 225 &&\n        (!inlineChange || addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }))) ||\n       (!inlineChange && $from.pos < parse.doc.content.size &&\n        (nextSel = Selection.findFrom(parse.doc.resolve($from.pos + 1), 1, true)) &&\n        nextSel.head == $to.pos)) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n    view.lastIOSEnter = 0;\n    return\n  }\n  // Same for backspace\n  if (view.state.selection.anchor > change.start &&\n      looksLikeJoin(doc, change.start, change.endA, $from, $to) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) {\n    if (result.android && result.chrome) { view.domObserver.suppressSelectionUpdates(); } // #820\n    return\n  }\n\n  // This tries to detect Android virtual keyboard\n  // enter-and-pick-suggestion action. That sometimes (see issue\n  // #1059) first fires a DOM mutation, before moving the selection to\n  // the newly created block. And then, because ProseMirror cleans up\n  // the DOM selection, it gives up moving the selection entirely,\n  // leaving the cursor in the wrong place. When that happens, we drop\n  // the new paragraph from the initial change, and fire a simulated\n  // enter key afterwards.\n  if (result.android && !inlineChange && $from.start() != $to.start() && $to.parentOffset == 0 && $from.depth == $to.depth &&\n      parse.sel && parse.sel.anchor == parse.sel.head && parse.sel.head == change.endA) {\n    change.endB -= 2;\n    $to = parse.doc.resolveNoCache(change.endB - parse.from);\n    setTimeout(function () {\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n    }, 20);\n  }\n\n  var chFrom = change.start, chTo = change.endA;\n\n  var tr, storedMarks, markChange, $from1;\n  if (inlineChange) {\n    if ($from.pos == $to.pos) { // Deletion\n      // IE11 sometimes weirdly moves the DOM selection around after\n      // backspacing out the first element in a textblock\n      if (result.ie && result.ie_version <= 11 && $from.parentOffset == 0) {\n        view.domObserver.suppressSelectionUpdates();\n        setTimeout(function () { return selectionToDOM(view); }, 20);\n      }\n      tr = view.state.tr.delete(chFrom, chTo);\n      storedMarks = doc.resolve(change.start).marksAcross(doc.resolve(change.endA));\n    } else if ( // Adding or removing a mark\n      change.endA == change.endB && ($from1 = doc.resolve(change.start)) &&\n      (markChange = isMarkChange($from.parent.content.cut($from.parentOffset, $to.parentOffset),\n                                 $from1.parent.content.cut($from1.parentOffset, change.endA - $from1.start())))\n    ) {\n      tr = view.state.tr;\n      if (markChange.type == \"add\") { tr.addMark(chFrom, chTo, markChange.mark); }\n      else { tr.removeMark(chFrom, chTo, markChange.mark); }\n    } else if ($from.parent.child($from.index()).isText && $from.index() == $to.index() - ($to.textOffset ? 0 : 1)) {\n      // Both positions in the same text node -- simply insert text\n      var text$1 = $from.parent.textBetween($from.parentOffset, $to.parentOffset);\n      if (view.someProp(\"handleTextInput\", function (f) { return f(view, chFrom, chTo, text$1); })) { return }\n      tr = view.state.tr.insertText(text$1, chFrom, chTo);\n    }\n  }\n\n  if (!tr)\n    { tr = view.state.tr.replace(chFrom, chTo, parse.doc.slice(change.start - parse.from, change.endB - parse.from)); }\n  if (parse.sel) {\n    var sel$2 = resolveSelection(view, tr.doc, parse.sel);\n    // Chrome Android will sometimes, during composition, report the\n    // selection in the wrong place. If it looks like that is\n    // happening, don't update the selection.\n    // Edge just doesn't move the cursor forward when you start typing\n    // in an empty block or between br nodes.\n    if (sel$2 && !(result.chrome && result.android && view.composing && sel$2.empty &&\n                   (sel$2.head == chFrom || sel$2.head == tr.mapping.map(chTo) - 1) ||\n                 result.ie && sel$2.empty && sel$2.head == chFrom))\n      { tr.setSelection(sel$2); }\n  }\n  if (storedMarks) { tr.ensureMarks(storedMarks); }\n  view.dispatch(tr.scrollIntoView());\n}\n\nfunction resolveSelection(view, doc, parsedSel) {\n  if (Math.max(parsedSel.anchor, parsedSel.head) > doc.content.size) { return null }\n  return selectionBetween(view, doc.resolve(parsedSel.anchor), doc.resolve(parsedSel.head))\n}\n\n// : (Fragment, Fragment)  ?{mark: Mark, type: string}\n// Given two same-length, non-empty fragments of inline content,\n// determine whether the first could be created from the second by\n// removing or adding a single mark type.\nfunction isMarkChange(cur, prev) {\n  var curMarks = cur.firstChild.marks, prevMarks = prev.firstChild.marks;\n  var added = curMarks, removed = prevMarks, type, mark, update;\n  for (var i = 0; i < prevMarks.length; i++) { added = prevMarks[i].removeFromSet(added); }\n  for (var i$1 = 0; i$1 < curMarks.length; i$1++) { removed = curMarks[i$1].removeFromSet(removed); }\n  if (added.length == 1 && removed.length == 0) {\n    mark = added[0];\n    type = \"add\";\n    update = function (node) { return node.mark(mark.addToSet(node.marks)); };\n  } else if (added.length == 0 && removed.length == 1) {\n    mark = removed[0];\n    type = \"remove\";\n    update = function (node) { return node.mark(mark.removeFromSet(node.marks)); };\n  } else {\n    return null\n  }\n  var updated = [];\n  for (var i$2 = 0; i$2 < prev.childCount; i$2++) { updated.push(update(prev.child(i$2))); }\n  if (Fragment.from(updated).eq(cur)) { return {mark: mark, type: type} }\n}\n\nfunction looksLikeJoin(old, start, end, $newStart, $newEnd) {\n  if (!$newStart.parent.isTextblock ||\n      // The content must have shrunk\n      end - start <= $newEnd.pos - $newStart.pos ||\n      // newEnd must point directly at or after the end of the block that newStart points into\n      skipClosingAndOpening($newStart, true, false) < $newEnd.pos)\n    { return false }\n\n  var $start = old.resolve(start);\n  // Start must be at the end of a block\n  if ($start.parentOffset < $start.parent.content.size || !$start.parent.isTextblock)\n    { return false }\n  var $next = old.resolve(skipClosingAndOpening($start, true, true));\n  // The next textblock must start before end and end near it\n  if (!$next.parent.isTextblock || $next.pos > end ||\n      skipClosingAndOpening($next, true, false) < end)\n    { return false }\n\n  // The fragments after the join point must match\n  return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)\n}\n\nfunction skipClosingAndOpening($pos, fromEnd, mayOpen) {\n  var depth = $pos.depth, end = fromEnd ? $pos.end() : $pos.pos;\n  while (depth > 0 && (fromEnd || $pos.indexAfter(depth) == $pos.node(depth).childCount)) {\n    depth--;\n    end++;\n    fromEnd = false;\n  }\n  if (mayOpen) {\n    var next = $pos.node(depth).maybeChild($pos.indexAfter(depth));\n    while (next && !next.isLeaf) {\n      next = next.firstChild;\n      end++;\n    }\n  }\n  return end\n}\n\nfunction findDiff(a, b, pos, preferredPos, preferredSide) {\n  var start = a.findDiffStart(b, pos);\n  if (start == null) { return null }\n  var ref = a.findDiffEnd(b, pos + a.size, pos + b.size);\n  var endA = ref.a;\n  var endB = ref.b;\n  if (preferredSide == \"end\") {\n    var adjust = Math.max(0, start - Math.min(endA, endB));\n    preferredPos -= endA + adjust - start;\n  }\n  if (endA < start && a.size < b.size) {\n    var move = preferredPos <= start && preferredPos >= endA ? start - preferredPos : 0;\n    start -= move;\n    endB = start + (endB - endA);\n    endA = start;\n  } else if (endB < start) {\n    var move$1 = preferredPos <= start && preferredPos >= endB ? start - preferredPos : 0;\n    start -= move$1;\n    endA = start + (endA - endB);\n    endB = start;\n  }\n  return {start: start, endA: endA, endB: endB}\n}\n\nfunction serializeForClipboard(view, slice) {\n  var context = [];\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  while (openStart > 1 && openEnd > 1 && content.childCount == 1 && content.firstChild.childCount == 1) {\n    openStart--;\n    openEnd--;\n    var node = content.firstChild;\n    context.push(node.type.name, node.attrs != node.type.defaultAttrs ? node.attrs : null);\n    content = node.content;\n  }\n\n  var serializer = view.someProp(\"clipboardSerializer\") || DOMSerializer.fromSchema(view.state.schema);\n  var doc = detachedDoc(), wrap = doc.createElement(\"div\");\n  wrap.appendChild(serializer.serializeFragment(content, {document: doc}));\n\n  var firstChild = wrap.firstChild, needsWrap;\n  while (firstChild && firstChild.nodeType == 1 && (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])) {\n    for (var i = needsWrap.length - 1; i >= 0; i--) {\n      var wrapper = doc.createElement(needsWrap[i]);\n      while (wrap.firstChild) { wrapper.appendChild(wrap.firstChild); }\n      wrap.appendChild(wrapper);\n    }\n    firstChild = wrap.firstChild;\n  }\n\n  if (firstChild && firstChild.nodeType == 1)\n    { firstChild.setAttribute(\"data-pm-slice\", (openStart + \" \" + openEnd + \" \" + (JSON.stringify(context)))); }\n\n  var text = view.someProp(\"clipboardTextSerializer\", function (f) { return f(slice); }) ||\n      slice.content.textBetween(0, slice.content.size, \"\\n\\n\");\n\n  return {dom: wrap, text: text}\n}\n\n// : (EditorView, string, string, ?bool, ResolvedPos)  ?Slice\n// Read a slice of content from the clipboard (or drop data).\nfunction parseFromClipboard(view, text, html, plainText, $context) {\n  var dom, inCode = $context.parent.type.spec.code, slice;\n  if (!html && !text) { return null }\n  var asText = text && (plainText || inCode || !html);\n  if (asText) {\n    view.someProp(\"transformPastedText\", function (f) { text = f(text, inCode || plainText); });\n    if (inCode) { return new Slice(Fragment.from(view.state.schema.text(text)), 0, 0) }\n    var parsed = view.someProp(\"clipboardTextParser\", function (f) { return f(text, $context, plainText); });\n    if (parsed) {\n      slice = parsed;\n    } else {\n      dom = document.createElement(\"div\");\n      text.trim().split(/(?:\\r\\n?|\\n)+/).forEach(function (block) {\n        dom.appendChild(document.createElement(\"p\")).textContent = block;\n      });\n    }\n  } else {\n    view.someProp(\"transformPastedHTML\", function (f) { html = f(html); });\n    dom = readHTML(html);\n  }\n\n  var contextNode = dom && dom.querySelector(\"[data-pm-slice]\");\n  var sliceData = contextNode && /^(\\d+) (\\d+) (.*)/.exec(contextNode.getAttribute(\"data-pm-slice\"));\n  if (!slice) {\n    var parser = view.someProp(\"clipboardParser\") || view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n    slice = parser.parseSlice(dom, {preserveWhitespace: !!(asText || sliceData), context: $context});\n  }\n  if (sliceData)\n    { slice = addContext(closeSlice(slice, +sliceData[1], +sliceData[2]), sliceData[3]); }\n  else // HTML wasn't created by ProseMirror. Make sure top-level siblings are coherent\n    { slice = Slice.maxOpen(normalizeSiblings(slice.content, $context), false); }\n\n  view.someProp(\"transformPasted\", function (f) { slice = f(slice); });\n  return slice\n}\n\n// Takes a slice parsed with parseSlice, which means there hasn't been\n// any content-expression checking done on the top nodes, tries to\n// find a parent node in the current context that might fit the nodes,\n// and if successful, rebuilds the slice so that it fits into that parent.\n//\n// This addresses the problem that Transform.replace expects a\n// coherent slice, and will fail to place a set of siblings that don't\n// fit anywhere in the schema.\nfunction normalizeSiblings(fragment, $context) {\n  if (fragment.childCount < 2) { return fragment }\n  var loop = function ( d ) {\n    var parent = $context.node(d);\n    var match = parent.contentMatchAt($context.index(d));\n    var lastWrap = (void 0), result = [];\n    fragment.forEach(function (node) {\n      if (!result) { return }\n      var wrap = match.findWrapping(node.type), inLast;\n      if (!wrap) { return result = null }\n      if (inLast = result.length && lastWrap.length && addToSibling(wrap, lastWrap, node, result[result.length - 1], 0)) {\n        result[result.length - 1] = inLast;\n      } else {\n        if (result.length) { result[result.length - 1] = closeRight(result[result.length - 1], lastWrap.length); }\n        var wrapped = withWrappers(node, wrap);\n        result.push(wrapped);\n        match = match.matchType(wrapped.type, wrapped.attrs);\n        lastWrap = wrap;\n      }\n    });\n    if (result) { return { v: Fragment.from(result) } }\n  };\n\n  for (var d = $context.depth; d >= 0; d--) {\n    var returned = loop( d );\n\n    if ( returned ) return returned.v;\n  }\n  return fragment\n}\n\nfunction withWrappers(node, wrap, from) {\n  if ( from === void 0 ) from = 0;\n\n  for (var i = wrap.length - 1; i >= from; i--)\n    { node = wrap[i].create(null, Fragment.from(node)); }\n  return node\n}\n\n// Used to group adjacent nodes wrapped in similar parents by\n// normalizeSiblings into the same parent node\nfunction addToSibling(wrap, lastWrap, node, sibling, depth) {\n  if (depth < wrap.length && depth < lastWrap.length && wrap[depth] == lastWrap[depth]) {\n    var inner = addToSibling(wrap, lastWrap, node, sibling.lastChild, depth + 1);\n    if (inner) { return sibling.copy(sibling.content.replaceChild(sibling.childCount - 1, inner)) }\n    var match = sibling.contentMatchAt(sibling.childCount);\n    if (match.matchType(depth == wrap.length - 1 ? node.type : wrap[depth + 1]))\n      { return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node, wrap, depth + 1)))) }\n  }\n}\n\nfunction closeRight(node, depth) {\n  if (depth == 0) { return node }\n  var fragment = node.content.replaceChild(node.childCount - 1, closeRight(node.lastChild, depth - 1));\n  var fill = node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true);\n  return node.copy(fragment.append(fill))\n}\n\nfunction closeRange(fragment, side, from, to, depth, openEnd) {\n  var node = side < 0 ? fragment.firstChild : fragment.lastChild, inner = node.content;\n  if (depth < to - 1) { inner = closeRange(inner, side, from, to, depth + 1, openEnd); }\n  if (depth >= from)\n    { inner = side < 0 ? node.contentMatchAt(0).fillBefore(inner, fragment.childCount > 1 || openEnd <= depth).append(inner)\n      : inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true)); }\n  return fragment.replaceChild(side < 0 ? 0 : fragment.childCount - 1, node.copy(inner))\n}\n\nfunction closeSlice(slice, openStart, openEnd) {\n  if (openStart < slice.openStart)\n    { slice = new Slice(closeRange(slice.content, -1, openStart, slice.openStart, 0, slice.openEnd), openStart, slice.openEnd); }\n  if (openEnd < slice.openEnd)\n    { slice = new Slice(closeRange(slice.content, 1, openEnd, slice.openEnd, 0, 0), slice.openStart, openEnd); }\n  return slice\n}\n\n// Trick from jQuery -- some elements must be wrapped in other\n// elements for innerHTML to work. I.e. if you do `div.innerHTML =\n// \"<td>..</td>\"` the table cells are ignored.\nvar wrapMap = {\n  thead: [\"table\"],\n  tbody: [\"table\"],\n  tfoot: [\"table\"],\n  caption: [\"table\"],\n  colgroup: [\"table\"],\n  col: [\"table\", \"colgroup\"],\n  tr: [\"table\", \"tbody\"],\n  td: [\"table\", \"tbody\", \"tr\"],\n  th: [\"table\", \"tbody\", \"tr\"]\n};\n\nvar _detachedDoc = null;\nfunction detachedDoc() {\n  return _detachedDoc || (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n}\n\nfunction readHTML(html) {\n  var metas = /(\\s*<meta [^>]*>)*/.exec(html);\n  if (metas) { html = html.slice(metas[0].length); }\n  var elt = detachedDoc().createElement(\"div\");\n  var firstTag = /(?:<meta [^>]*>)*<([a-z][^>\\s]+)/i.exec(html), wrap, depth = 0;\n  if (wrap = firstTag && wrapMap[firstTag[1].toLowerCase()]) {\n    html = wrap.map(function (n) { return \"<\" + n + \">\"; }).join(\"\") + html + wrap.map(function (n) { return \"</\" + n + \">\"; }).reverse().join(\"\");\n    depth = wrap.length;\n  }\n  elt.innerHTML = html;\n  for (var i = 0; i < depth; i++) { elt = elt.firstChild; }\n  return elt\n}\n\nfunction addContext(slice, context) {\n  if (!slice.size) { return slice }\n  var schema = slice.content.firstChild.type.schema, array;\n  try { array = JSON.parse(context); }\n  catch(e) { return slice }\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  for (var i = array.length - 2; i >= 0; i -= 2) {\n    var type = schema.nodes[array[i]];\n    if (!type || type.hasRequiredAttrs()) { break }\n    content = Fragment.from(type.create(array[i + 1], content));\n    openStart++; openEnd++;\n  }\n  return new Slice(content, openStart, openEnd)\n}\n\nvar observeOptions = {\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  attributes: true,\n  attributeOldValue: true,\n  subtree: true\n};\n// IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\nvar useCharData = result.ie && result.ie_version <= 11;\n\nvar SelectionState = function SelectionState() {\n  this.anchorNode = this.anchorOffset = this.focusNode = this.focusOffset = null;\n};\n\nSelectionState.prototype.set = function set (sel) {\n  this.anchorNode = sel.anchorNode; this.anchorOffset = sel.anchorOffset;\n  this.focusNode = sel.focusNode; this.focusOffset = sel.focusOffset;\n};\n\nSelectionState.prototype.eq = function eq (sel) {\n  return sel.anchorNode == this.anchorNode && sel.anchorOffset == this.anchorOffset &&\n    sel.focusNode == this.focusNode && sel.focusOffset == this.focusOffset\n};\n\nvar DOMObserver = function DOMObserver(view, handleDOMChange) {\n  var this$1 = this;\n\n  this.view = view;\n  this.handleDOMChange = handleDOMChange;\n  this.queue = [];\n  this.flushingSoon = -1;\n  this.observer = window.MutationObserver &&\n    new window.MutationObserver(function (mutations) {\n      for (var i = 0; i < mutations.length; i++) { this$1.queue.push(mutations[i]); }\n      // IE11 will sometimes (on backspacing out a single character\n      // text node after a BR node) call the observer callback\n      // before actually updating the DOM, which will cause\n      // ProseMirror to miss the change (see #930)\n      if (result.ie && result.ie_version <= 11 && mutations.some(\n        function (m) { return m.type == \"childList\" && m.removedNodes.length ||\n             m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length; }))\n        { this$1.flushSoon(); }\n      else\n        { this$1.flush(); }\n    });\n  this.currentSelection = new SelectionState;\n  if (useCharData) {\n    this.onCharData = function (e) {\n      this$1.queue.push({target: e.target, type: \"characterData\", oldValue: e.prevValue});\n      this$1.flushSoon();\n    };\n  }\n  this.onSelectionChange = this.onSelectionChange.bind(this);\n  this.suppressingSelectionUpdates = false;\n};\n\nDOMObserver.prototype.flushSoon = function flushSoon () {\n    var this$1 = this;\n\n  if (this.flushingSoon < 0)\n    { this.flushingSoon = window.setTimeout(function () { this$1.flushingSoon = -1; this$1.flush(); }, 20); }\n};\n\nDOMObserver.prototype.forceFlush = function forceFlush () {\n  if (this.flushingSoon > -1) {\n    window.clearTimeout(this.flushingSoon);\n    this.flushingSoon = -1;\n    this.flush();\n  }\n};\n\nDOMObserver.prototype.start = function start () {\n  if (this.observer)\n    { this.observer.observe(this.view.dom, observeOptions); }\n  if (useCharData)\n    { this.view.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.connectSelection();\n};\n\nDOMObserver.prototype.stop = function stop () {\n    var this$1 = this;\n\n  if (this.observer) {\n    var take = this.observer.takeRecords();\n    if (take.length) {\n      for (var i = 0; i < take.length; i++) { this.queue.push(take[i]); }\n      window.setTimeout(function () { return this$1.flush(); }, 20);\n    }\n    this.observer.disconnect();\n  }\n  if (useCharData) { this.view.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.disconnectSelection();\n};\n\nDOMObserver.prototype.connectSelection = function connectSelection () {\n  this.view.dom.ownerDocument.addEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.disconnectSelection = function disconnectSelection () {\n  this.view.dom.ownerDocument.removeEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.suppressSelectionUpdates = function suppressSelectionUpdates () {\n    var this$1 = this;\n\n  this.suppressingSelectionUpdates = true;\n  setTimeout(function () { return this$1.suppressingSelectionUpdates = false; }, 50);\n};\n\nDOMObserver.prototype.onSelectionChange = function onSelectionChange () {\n  if (!hasFocusAndSelection(this.view)) { return }\n  if (this.suppressingSelectionUpdates) { return selectionToDOM(this.view) }\n  // Deletions on IE11 fire their events in the wrong order, giving\n  // us a selection change event before the DOM changes are\n  // reported.\n  if (result.ie && result.ie_version <= 11 && !this.view.state.selection.empty) {\n    var sel = this.view.root.getSelection();\n    // Selection.isCollapsed isn't reliable on IE\n    if (sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n      { return this.flushSoon() }\n  }\n  this.flush();\n};\n\nDOMObserver.prototype.setCurSelection = function setCurSelection () {\n  this.currentSelection.set(this.view.root.getSelection());\n};\n\nDOMObserver.prototype.ignoreSelectionChange = function ignoreSelectionChange (sel) {\n  if (sel.rangeCount == 0) { return true }\n  var container = sel.getRangeAt(0).commonAncestorContainer;\n  var desc = this.view.docView.nearestDesc(container);\n  if (desc && desc.ignoreMutation({type: \"selection\", target: container.nodeType == 3 ? container.parentNode : container})) {\n    this.setCurSelection();\n    return true\n  }\n};\n\nDOMObserver.prototype.flush = function flush () {\n  if (!this.view.docView || this.flushingSoon > -1) { return }\n  var mutations = this.observer ? this.observer.takeRecords() : [];\n  if (this.queue.length) {\n    mutations = this.queue.concat(mutations);\n    this.queue.length = 0;\n  }\n\n  var sel = this.view.root.getSelection();\n  var newSel = !this.suppressingSelectionUpdates && !this.currentSelection.eq(sel) && hasSelection(this.view) && !this.ignoreSelectionChange(sel);\n\n  var from = -1, to = -1, typeOver = false, added = [];\n  if (this.view.editable) {\n    for (var i = 0; i < mutations.length; i++) {\n      var result$1 = this.registerMutation(mutations[i], added);\n      if (result$1) {\n        from = from < 0 ? result$1.from : Math.min(result$1.from, from);\n        to = to < 0 ? result$1.to : Math.max(result$1.to, to);\n        if (result$1.typeOver) { typeOver = true; }\n      }\n    }\n  }\n\n  if (result.gecko && added.length > 1) {\n    var brs = added.filter(function (n) { return n.nodeName == \"BR\"; });\n    if (brs.length == 2) {\n      var a = brs[0];\n        var b = brs[1];\n      if (a.parentNode && a.parentNode.parentNode == b.parentNode) { b.remove(); }\n      else { a.remove(); }\n    }\n  }\n\n  if (from > -1 || newSel) {\n    if (from > -1) {\n      this.view.docView.markDirty(from, to);\n      checkCSS(this.view);\n    }\n    this.handleDOMChange(from, to, typeOver, added);\n    if (this.view.docView.dirty) { this.view.updateState(this.view.state); }\n    else if (!this.currentSelection.eq(sel)) { selectionToDOM(this.view); }\n  }\n};\n\nDOMObserver.prototype.registerMutation = function registerMutation (mut, added) {\n  // Ignore mutations inside nodes that were already noted as inserted\n  if (added.indexOf(mut.target) > -1) { return null }\n  var desc = this.view.docView.nearestDesc(mut.target);\n  if (mut.type == \"attributes\" &&\n      (desc == this.view.docView || mut.attributeName == \"contenteditable\" ||\n       // Firefox sometimes fires spurious events for null/empty styles\n       (mut.attributeName == \"style\" && !mut.oldValue && !mut.target.getAttribute(\"style\"))))\n    { return null }\n  if (!desc || desc.ignoreMutation(mut)) { return null }\n\n  if (mut.type == \"childList\") {\n    var prev = mut.previousSibling, next = mut.nextSibling;\n    if (result.ie && result.ie_version <= 11 && mut.addedNodes.length) {\n      // IE11 gives us incorrect next/prev siblings for some\n      // insertions, so if there are added nodes, recompute those\n      for (var i = 0; i < mut.addedNodes.length; i++) {\n        var ref = mut.addedNodes[i];\n          var previousSibling = ref.previousSibling;\n          var nextSibling = ref.nextSibling;\n        if (!previousSibling || Array.prototype.indexOf.call(mut.addedNodes, previousSibling) < 0) { prev = previousSibling; }\n        if (!nextSibling || Array.prototype.indexOf.call(mut.addedNodes, nextSibling) < 0) { next = nextSibling; }\n      }\n    }\n    var fromOffset = prev && prev.parentNode == mut.target\n        ? domIndex(prev) + 1 : 0;\n    var from = desc.localPosFromDOM(mut.target, fromOffset, -1);\n    var toOffset = next && next.parentNode == mut.target\n        ? domIndex(next) : mut.target.childNodes.length;\n    for (var i$1 = 0; i$1 < mut.addedNodes.length; i$1++) { added.push(mut.addedNodes[i$1]); }\n    var to = desc.localPosFromDOM(mut.target, toOffset, 1);\n    return {from: from, to: to}\n  } else if (mut.type == \"attributes\") {\n    return {from: desc.posAtStart - desc.border, to: desc.posAtEnd + desc.border}\n  } else { // \"characterData\"\n    return {\n      from: desc.posAtStart,\n      to: desc.posAtEnd,\n      // An event was generated for a text change that didn't change\n      // any text. Mark the dom change to fall back to assuming the\n      // selection was typed over with an identical value if it can't\n      // find another change.\n      typeOver: mut.target.nodeValue == mut.oldValue\n    }\n  }\n};\n\nvar cssChecked = false;\n\nfunction checkCSS(view) {\n  if (cssChecked) { return }\n  cssChecked = true;\n  if (getComputedStyle(view.dom).whiteSpace == \"normal\")\n    { console[\"warn\"](\"ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.\"); }\n}\n\n// A collection of DOM events that occur within the editor, and callback functions\n// to invoke when the event fires.\nvar handlers = {}, editHandlers = {};\n\nfunction initInput(view) {\n  view.shiftKey = false;\n  view.mouseDown = null;\n  view.lastKeyCode = null;\n  view.lastKeyCodeTime = 0;\n  view.lastClick = {time: 0, x: 0, y: 0, type: \"\"};\n  view.lastSelectionOrigin = null;\n  view.lastSelectionTime = 0;\n\n  view.lastIOSEnter = 0;\n  view.lastIOSEnterFallbackTimeout = null;\n\n  view.composing = false;\n  view.composingTimeout = null;\n  view.compositionNodes = [];\n  view.compositionEndedAt = -2e8;\n\n  view.domObserver = new DOMObserver(view, function (from, to, typeOver, added) { return readDOMChange(view, from, to, typeOver, added); });\n  view.domObserver.start();\n  // Used by hacks like the beforeinput handler to check whether anything happened in the DOM\n  view.domChangeCount = 0;\n\n  view.eventHandlers = Object.create(null);\n  var loop = function ( event ) {\n    var handler = handlers[event];\n    view.dom.addEventListener(event, view.eventHandlers[event] = function (event) {\n      if (eventBelongsToView(view, event) && !runCustomHandler(view, event) &&\n          (view.editable || !(event.type in editHandlers)))\n        { handler(view, event); }\n    });\n  };\n\n  for (var event in handlers) loop( event );\n  // On Safari, for reasons beyond my understanding, adding an input\n  // event handler makes an issue where the composition vanishes when\n  // you press enter go away.\n  if (result.safari) { view.dom.addEventListener(\"input\", function () { return null; }); }\n\n  ensureListeners(view);\n}\n\nfunction setSelectionOrigin(view, origin) {\n  view.lastSelectionOrigin = origin;\n  view.lastSelectionTime = Date.now();\n}\n\nfunction destroyInput(view) {\n  view.domObserver.stop();\n  for (var type in view.eventHandlers)\n    { view.dom.removeEventListener(type, view.eventHandlers[type]); }\n  clearTimeout(view.composingTimeout);\n  clearTimeout(view.lastIOSEnterFallbackTimeout);\n}\n\nfunction ensureListeners(view) {\n  view.someProp(\"handleDOMEvents\", function (currentHandlers) {\n    for (var type in currentHandlers) { if (!view.eventHandlers[type])\n      { view.dom.addEventListener(type, view.eventHandlers[type] = function (event) { return runCustomHandler(view, event); }); } }\n  });\n}\n\nfunction runCustomHandler(view, event) {\n  return view.someProp(\"handleDOMEvents\", function (handlers) {\n    var handler = handlers[event.type];\n    return handler ? handler(view, event) || event.defaultPrevented : false\n  })\n}\n\nfunction eventBelongsToView(view, event) {\n  if (!event.bubbles) { return true }\n  if (event.defaultPrevented) { return false }\n  for (var node = event.target; node != view.dom; node = node.parentNode)\n    { if (!node || node.nodeType == 11 ||\n        (node.pmViewDesc && node.pmViewDesc.stopEvent(event)))\n      { return false } }\n  return true\n}\n\nfunction dispatchEvent(view, event) {\n  if (!runCustomHandler(view, event) && handlers[event.type] &&\n      (view.editable || !(event.type in editHandlers)))\n    { handlers[event.type](view, event); }\n}\n\neditHandlers.keydown = function (view, event) {\n  view.shiftKey = event.keyCode == 16 || event.shiftKey;\n  if (inOrNearComposition(view, event)) { return }\n  view.domObserver.forceFlush();\n  view.lastKeyCode = event.keyCode;\n  view.lastKeyCodeTime = Date.now();\n  // On iOS, if we preventDefault enter key presses, the virtual\n  // keyboard gets confused. So the hack here is to set a flag that\n  // makes the DOM change code recognize that what just happens should\n  // be replaced by whatever the Enter key handlers do.\n  if (result.ios && event.keyCode == 13 && !event.ctrlKey && !event.altKey && !event.metaKey) {\n    var now = Date.now();\n    view.lastIOSEnter = now;\n    view.lastIOSEnterFallbackTimeout = setTimeout(function () {\n      if (view.lastIOSEnter == now) {\n        view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n        view.lastIOSEnter = 0;\n      }\n    }, 200);\n  } else if (view.someProp(\"handleKeyDown\", function (f) { return f(view, event); }) || captureKeyDown(view, event)) {\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(view, \"key\");\n  }\n};\n\neditHandlers.keyup = function (view, e) {\n  if (e.keyCode == 16) { view.shiftKey = false; }\n};\n\neditHandlers.keypress = function (view, event) {\n  if (inOrNearComposition(view, event) || !event.charCode ||\n      event.ctrlKey && !event.altKey || result.mac && event.metaKey) { return }\n\n  if (view.someProp(\"handleKeyPress\", function (f) { return f(view, event); })) {\n    event.preventDefault();\n    return\n  }\n\n  var sel = view.state.selection;\n  if (!(sel instanceof TextSelection) || !sel.$from.sameParent(sel.$to)) {\n    var text = String.fromCharCode(event.charCode);\n    if (!view.someProp(\"handleTextInput\", function (f) { return f(view, sel.$from.pos, sel.$to.pos, text); }))\n      { view.dispatch(view.state.tr.insertText(text).scrollIntoView()); }\n    event.preventDefault();\n  }\n};\n\nfunction eventCoords(event) { return {left: event.clientX, top: event.clientY} }\n\nfunction isNear(event, click) {\n  var dx = click.x - event.clientX, dy = click.y - event.clientY;\n  return dx * dx + dy * dy < 100\n}\n\nfunction runHandlerOnContext(view, propName, pos, inside, event) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside);\n  var loop = function ( i ) {\n    if (view.someProp(propName, function (f) { return i > $pos.depth ? f(view, pos, $pos.nodeAfter, $pos.before(i), event, true)\n                                                    : f(view, pos, $pos.node(i), $pos.before(i), event, false); }))\n      { return { v: true } }\n  };\n\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var returned = loop( i );\n\n    if ( returned ) return returned.v;\n  }\n  return false\n}\n\nfunction updateSelection(view, selection, origin) {\n  if (!view.focused) { view.focus(); }\n  var tr = view.state.tr.setSelection(selection);\n  if (origin == \"pointer\") { tr.setMeta(\"pointer\", true); }\n  view.dispatch(tr);\n}\n\nfunction selectClickedLeaf(view, inside) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside), node = $pos.nodeAfter;\n  if (node && node.isAtom && NodeSelection.isSelectable(node)) {\n    updateSelection(view, new NodeSelection($pos), \"pointer\");\n    return true\n  }\n  return false\n}\n\nfunction selectClickedNode(view, inside) {\n  if (inside == -1) { return false }\n  var sel = view.state.selection, selectedNode, selectAt;\n  if (sel instanceof NodeSelection) { selectedNode = sel.node; }\n\n  var $pos = view.state.doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    if (NodeSelection.isSelectable(node)) {\n      if (selectedNode && sel.$from.depth > 0 &&\n          i >= sel.$from.depth && $pos.before(sel.$from.depth + 1) == sel.$from.pos)\n        { selectAt = $pos.before(sel.$from.depth); }\n      else\n        { selectAt = $pos.before(i); }\n      break\n    }\n  }\n\n  if (selectAt != null) {\n    updateSelection(view, NodeSelection.create(view.state.doc, selectAt), \"pointer\");\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction handleSingleClick(view, pos, inside, event, selectNode) {\n  return runHandlerOnContext(view, \"handleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleClick\", function (f) { return f(view, pos, event); }) ||\n    (selectNode ? selectClickedNode(view, inside) : selectClickedLeaf(view, inside))\n}\n\nfunction handleDoubleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleDoubleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleDoubleClick\", function (f) { return f(view, pos, event); })\n}\n\nfunction handleTripleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleTripleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleTripleClick\", function (f) { return f(view, pos, event); }) ||\n    defaultTripleClick(view, inside)\n}\n\nfunction defaultTripleClick(view, inside) {\n  var doc = view.state.doc;\n  if (inside == -1) {\n    if (doc.inlineContent) {\n      updateSelection(view, TextSelection.create(doc, 0, doc.content.size), \"pointer\");\n      return true\n    }\n    return false\n  }\n\n  var $pos = doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    var nodePos = $pos.before(i);\n    if (node.inlineContent)\n      { updateSelection(view, TextSelection.create(doc, nodePos + 1, nodePos + 1 + node.content.size), \"pointer\"); }\n    else if (NodeSelection.isSelectable(node))\n      { updateSelection(view, NodeSelection.create(doc, nodePos), \"pointer\"); }\n    else\n      { continue }\n    return true\n  }\n}\n\nfunction forceDOMFlush(view) {\n  return endComposition(view)\n}\n\nvar selectNodeModifier = result.mac ? \"metaKey\" : \"ctrlKey\";\n\nhandlers.mousedown = function (view, event) {\n  view.shiftKey = event.shiftKey;\n  var flushed = forceDOMFlush(view);\n  var now = Date.now(), type = \"singleClick\";\n  if (now - view.lastClick.time < 500 && isNear(event, view.lastClick) && !event[selectNodeModifier]) {\n    if (view.lastClick.type == \"singleClick\") { type = \"doubleClick\"; }\n    else if (view.lastClick.type == \"doubleClick\") { type = \"tripleClick\"; }\n  }\n  view.lastClick = {time: now, x: event.clientX, y: event.clientY, type: type};\n\n  var pos = view.posAtCoords(eventCoords(event));\n  if (!pos) { return }\n\n  if (type == \"singleClick\")\n    { view.mouseDown = new MouseDown(view, pos, event, flushed); }\n  else if ((type == \"doubleClick\" ? handleDoubleClick : handleTripleClick)(view, pos.pos, pos.inside, event))\n    { event.preventDefault(); }\n  else\n    { setSelectionOrigin(view, \"pointer\"); }\n};\n\nvar MouseDown = function MouseDown(view, pos, event, flushed) {\n  var this$1 = this;\n\n  this.view = view;\n  this.startDoc = view.state.doc;\n  this.pos = pos;\n  this.event = event;\n  this.flushed = flushed;\n  this.selectNode = event[selectNodeModifier];\n  this.allowDefault = event.shiftKey;\n\n  var targetNode, targetPos;\n  if (pos.inside > -1) {\n    targetNode = view.state.doc.nodeAt(pos.inside);\n    targetPos = pos.inside;\n  } else {\n    var $pos = view.state.doc.resolve(pos.pos);\n    targetNode = $pos.parent;\n    targetPos = $pos.depth ? $pos.before() : 0;\n  }\n\n  this.mightDrag = null;\n\n  var target = flushed ? null : event.target;\n  var targetDesc = target ? view.docView.nearestDesc(target, true) : null;\n  this.target = targetDesc ? targetDesc.dom : null;\n\n  if (targetNode.type.spec.draggable && targetNode.type.spec.selectable !== false ||\n      view.state.selection instanceof NodeSelection && targetPos == view.state.selection.from)\n    { this.mightDrag = {node: targetNode,\n                      pos: targetPos,\n                      addAttr: this.target && !this.target.draggable,\n                      setUneditable: this.target && result.gecko && !this.target.hasAttribute(\"contentEditable\")}; }\n\n  if (this.target && this.mightDrag && (this.mightDrag.addAttr || this.mightDrag.setUneditable)) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.draggable = true; }\n    if (this.mightDrag.setUneditable)\n      { setTimeout(function () { return this$1.target.setAttribute(\"contentEditable\", \"false\"); }, 20); }\n    this.view.domObserver.start();\n  }\n\n  view.root.addEventListener(\"mouseup\", this.up = this.up.bind(this));\n  view.root.addEventListener(\"mousemove\", this.move = this.move.bind(this));\n  setSelectionOrigin(view, \"pointer\");\n};\n\nMouseDown.prototype.done = function done () {\n  this.view.root.removeEventListener(\"mouseup\", this.up);\n  this.view.root.removeEventListener(\"mousemove\", this.move);\n  if (this.mightDrag && this.target) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.removeAttribute(\"draggable\"); }\n    if (this.mightDrag.setUneditable) { this.target.removeAttribute(\"contentEditable\"); }\n    this.view.domObserver.start();\n  }\n  this.view.mouseDown = null;\n};\n\nMouseDown.prototype.up = function up (event) {\n  this.done();\n\n  if (!this.view.dom.contains(event.target.nodeType == 3 ? event.target.parentNode : event.target))\n    { return }\n\n  var pos = this.pos;\n  if (this.view.state.doc != this.startDoc) { pos = this.view.posAtCoords(eventCoords(event)); }\n\n  if (this.allowDefault || !pos) {\n    setSelectionOrigin(this.view, \"pointer\");\n  } else if (handleSingleClick(this.view, pos.pos, pos.inside, event, this.selectNode)) {\n    event.preventDefault();\n  } else if (this.flushed ||\n             // Safari ignores clicks on draggable elements\n             (result.safari && this.mightDrag && !this.mightDrag.node.isAtom) ||\n             // Chrome will sometimes treat a node selection as a\n             // cursor, but still report that the node is selected\n             // when asked through getSelection. You'll then get a\n             // situation where clicking at the point where that\n             // (hidden) cursor is doesn't change the selection, and\n             // thus doesn't get a reaction from ProseMirror. This\n             // works around that.\n             (result.chrome && !(this.view.state.selection instanceof TextSelection) &&\n              (pos.pos == this.view.state.selection.from || pos.pos == this.view.state.selection.to))) {\n    updateSelection(this.view, Selection.near(this.view.state.doc.resolve(pos.pos)), \"pointer\");\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(this.view, \"pointer\");\n  }\n};\n\nMouseDown.prototype.move = function move (event) {\n  if (!this.allowDefault && (Math.abs(this.event.x - event.clientX) > 4 ||\n                             Math.abs(this.event.y - event.clientY) > 4))\n    { this.allowDefault = true; }\n  setSelectionOrigin(this.view, \"pointer\");\n};\n\nhandlers.touchdown = function (view) {\n  forceDOMFlush(view);\n  setSelectionOrigin(view, \"pointer\");\n};\n\nhandlers.contextmenu = function (view) { return forceDOMFlush(view); };\n\nfunction inOrNearComposition(view, event) {\n  if (view.composing) { return true }\n  // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n  // On Japanese input method editors (IMEs), the Enter key is used to confirm character\n  // selection. On Safari, when Enter is pressed, compositionend and keydown events are\n  // emitted. The keydown event triggers newline insertion, which we don't want.\n  // This method returns true if the keydown event should be ignored.\n  // We only ignore it once, as pressing Enter a second time *should* insert a newline.\n  // Furthermore, the keydown event timestamp must be close to the compositionEndedAt timestamp.\n  // This guards against the case where compositionend is triggered without the keyboard\n  // (e.g. character confirmation may be done with the mouse), and keydown is triggered\n  // afterwards- we wouldn't want to ignore the keydown event in this case.\n  if (result.safari && Math.abs(event.timeStamp - view.compositionEndedAt) < 500) {\n    view.compositionEndedAt = -2e8;\n    return true\n  }\n  return false\n}\n\n// Drop active composition after 5 seconds of inactivity on Android\nvar timeoutComposition = result.android ? 5000 : -1;\n\neditHandlers.compositionstart = editHandlers.compositionupdate = function (view) {\n  if (!view.composing) {\n    view.domObserver.flush();\n    var state = view.state;\n    var $pos = state.selection.$from;\n    if (state.selection.empty &&\n        (state.storedMarks ||\n         (!$pos.textOffset && $pos.parentOffset && $pos.nodeBefore.marks.some(function (m) { return m.type.spec.inclusive === false; })))) {\n      // Need to wrap the cursor in mark nodes different from the ones in the DOM context\n      view.markCursor = view.state.storedMarks || $pos.marks();\n      endComposition(view, true);\n      view.markCursor = null;\n    } else {\n      endComposition(view);\n      // In firefox, if the cursor is after but outside a marked node,\n      // the inserted text won't inherit the marks. So this moves it\n      // inside if necessary.\n      if (result.gecko && state.selection.empty && $pos.parentOffset && !$pos.textOffset && $pos.nodeBefore.marks.length) {\n        var sel = view.root.getSelection();\n        for (var node = sel.focusNode, offset = sel.focusOffset; node && node.nodeType == 1 && offset != 0;) {\n          var before = offset < 0 ? node.lastChild : node.childNodes[offset - 1];\n          if (!before) { break }\n          if (before.nodeType == 3) {\n            sel.collapse(before, before.nodeValue.length);\n            break\n          } else {\n            node = before;\n            offset = -1;\n          }\n        }\n      }\n    }\n    view.composing = true;\n  }\n  scheduleComposeEnd(view, timeoutComposition);\n};\n\neditHandlers.compositionend = function (view, event) {\n  if (view.composing) {\n    view.composing = false;\n    view.compositionEndedAt = event.timeStamp;\n    scheduleComposeEnd(view, 20);\n  }\n};\n\nfunction scheduleComposeEnd(view, delay) {\n  clearTimeout(view.composingTimeout);\n  if (delay > -1) { view.composingTimeout = setTimeout(function () { return endComposition(view); }, delay); }\n}\n\nfunction clearComposition(view) {\n  view.composing = false;\n  while (view.compositionNodes.length > 0) { view.compositionNodes.pop().markParentsDirty(); }\n}\n\nfunction endComposition(view, forceUpdate) {\n  view.domObserver.forceFlush();\n  clearComposition(view);\n  if (forceUpdate || view.docView.dirty) {\n    var sel = selectionFromDOM(view);\n    if (sel && !sel.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel)); }\n    else { view.updateState(view.state); }\n    return true\n  }\n  return false\n}\n\nfunction captureCopy(view, dom) {\n  // The extra wrapper is somehow necessary on IE/Edge to prevent the\n  // content from being mangled when it is put onto the clipboard\n  if (!view.dom.parentNode) { return }\n  var wrap = view.dom.parentNode.appendChild(document.createElement(\"div\"));\n  wrap.appendChild(dom);\n  wrap.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  var sel = getSelection(), range = document.createRange();\n  range.selectNodeContents(dom);\n  // Done because IE will fire a selectionchange moving the selection\n  // to its start when removeAllRanges is called and the editor still\n  // has focus (which will mess up the editor's selection state).\n  view.dom.blur();\n  sel.removeAllRanges();\n  sel.addRange(range);\n  setTimeout(function () {\n    if (wrap.parentNode) { wrap.parentNode.removeChild(wrap); }\n    view.focus();\n  }, 50);\n}\n\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard APIall the objects and methods are\n// there, they just don't work, and they are hard to test.\nvar brokenClipboardAPI = (result.ie && result.ie_version < 15) ||\n      (result.ios && result.webkit_version < 604);\n\nhandlers.copy = editHandlers.cut = function (view, e) {\n  var sel = view.state.selection, cut = e.type == \"cut\";\n  if (sel.empty) { return }\n\n  // IE and Edge's clipboard interface is completely broken\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  var slice = sel.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  if (data) {\n    e.preventDefault();\n    data.clearData();\n    data.setData(\"text/html\", dom.innerHTML);\n    data.setData(\"text/plain\", text);\n  } else {\n    captureCopy(view, dom);\n  }\n  if (cut) { view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta(\"uiEvent\", \"cut\")); }\n};\n\nfunction sliceSingleNode(slice) {\n  return slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1 ? slice.content.firstChild : null\n}\n\nfunction capturePaste(view, e) {\n  if (!view.dom.parentNode) { return }\n  var plainText = view.shiftKey || view.state.selection.$from.parent.type.spec.code;\n  var target = view.dom.parentNode.appendChild(document.createElement(plainText ? \"textarea\" : \"div\"));\n  if (!plainText) { target.contentEditable = \"true\"; }\n  target.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  target.focus();\n  setTimeout(function () {\n    view.focus();\n    if (target.parentNode) { target.parentNode.removeChild(target); }\n    if (plainText) { doPaste(view, target.value, null, e); }\n    else { doPaste(view, target.textContent, target.innerHTML, e); }\n  }, 50);\n}\n\nfunction doPaste(view, text, html, e) {\n  var slice = parseFromClipboard(view, text, html, view.shiftKey, view.state.selection.$from);\n  if (view.someProp(\"handlePaste\", function (f) { return f(view, e, slice || Slice.empty); })) { return true }\n  if (!slice) { return false }\n\n  var singleNode = sliceSingleNode(slice);\n  var tr = singleNode ? view.state.tr.replaceSelectionWith(singleNode, view.shiftKey) : view.state.tr.replaceSelection(slice);\n  view.dispatch(tr.scrollIntoView().setMeta(\"paste\", true).setMeta(\"uiEvent\", \"paste\"));\n  return true\n}\n\neditHandlers.paste = function (view, e) {\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  if (data && doPaste(view, data.getData(\"text/plain\"), data.getData(\"text/html\"), e)) { e.preventDefault(); }\n  else { capturePaste(view, e); }\n};\n\nvar Dragging = function Dragging(slice, move) {\n  this.slice = slice;\n  this.move = move;\n};\n\nvar dragCopyModifier = result.mac ? \"altKey\" : \"ctrlKey\";\n\nhandlers.dragstart = function (view, e) {\n  var mouseDown = view.mouseDown;\n  if (mouseDown) { mouseDown.done(); }\n  if (!e.dataTransfer) { return }\n\n  var sel = view.state.selection;\n  var pos = sel.empty ? null : view.posAtCoords(eventCoords(e));\n  if (pos && pos.pos >= sel.from && pos.pos <= (sel instanceof NodeSelection ? sel.to - 1: sel.to)) ; else if (mouseDown && mouseDown.mightDrag) {\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, mouseDown.mightDrag.pos)));\n  } else if (e.target && e.target.nodeType == 1) {\n    var desc = view.docView.nearestDesc(e.target, true);\n    if (!desc || !desc.node.type.spec.draggable || desc == view.docView) { return }\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, desc.posBefore)));\n  }\n  var slice = view.state.selection.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  e.dataTransfer.clearData();\n  e.dataTransfer.setData(brokenClipboardAPI ? \"Text\" : \"text/html\", dom.innerHTML);\n  if (!brokenClipboardAPI) { e.dataTransfer.setData(\"text/plain\", text); }\n  view.dragging = new Dragging(slice, !e[dragCopyModifier]);\n};\n\nhandlers.dragend = function (view) {\n  var dragging = view.dragging;\n  window.setTimeout(function () {\n    if (view.dragging == dragging)  { view.dragging = null; }\n  }, 50);\n};\n\neditHandlers.dragover = editHandlers.dragenter = function (_, e) { return e.preventDefault(); };\n\neditHandlers.drop = function (view, e) {\n  var dragging = view.dragging;\n  view.dragging = null;\n\n  if (!e.dataTransfer) { return }\n\n  var eventPos = view.posAtCoords(eventCoords(e));\n  if (!eventPos) { return }\n  var $mouse = view.state.doc.resolve(eventPos.pos);\n  if (!$mouse) { return }\n  var slice = dragging && dragging.slice ||\n      parseFromClipboard(view, e.dataTransfer.getData(brokenClipboardAPI ? \"Text\" : \"text/plain\"),\n                         brokenClipboardAPI ? null : e.dataTransfer.getData(\"text/html\"), false, $mouse);\n  var move = dragging && !e[dragCopyModifier];\n  if (view.someProp(\"handleDrop\", function (f) { return f(view, e, slice || Slice.empty, move); })) {\n    e.preventDefault();\n    return\n  }\n  if (!slice) { return }\n\n  e.preventDefault();\n  var insertPos = slice ? dropPoint(view.state.doc, $mouse.pos, slice) : $mouse.pos;\n  if (insertPos == null) { insertPos = $mouse.pos; }\n\n  var tr = view.state.tr;\n  if (move) { tr.deleteSelection(); }\n\n  var pos = tr.mapping.map(insertPos);\n  var isNode = slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1;\n  var beforeInsert = tr.doc;\n  if (isNode)\n    { tr.replaceRangeWith(pos, pos, slice.content.firstChild); }\n  else\n    { tr.replaceRange(pos, pos, slice); }\n  if (tr.doc.eq(beforeInsert)) { return }\n\n  var $pos = tr.doc.resolve(pos);\n  if (isNode && NodeSelection.isSelectable(slice.content.firstChild) &&\n      $pos.nodeAfter && $pos.nodeAfter.sameMarkup(slice.content.firstChild)) {\n    tr.setSelection(new NodeSelection($pos));\n  } else {\n    var end = tr.mapping.map(insertPos);\n    tr.mapping.maps[tr.mapping.maps.length - 1].forEach(function (_from, _to, _newFrom, newTo) { return end = newTo; });\n    tr.setSelection(selectionBetween(view, $pos, tr.doc.resolve(end)));\n  }\n  view.focus();\n  view.dispatch(tr.setMeta(\"uiEvent\", \"drop\"));\n};\n\nhandlers.focus = function (view) {\n  if (!view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.add(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.focused = true;\n    setTimeout(function () {\n      if (view.docView && view.hasFocus() && !view.domObserver.currentSelection.eq(view.root.getSelection()))\n        { selectionToDOM(view); }\n    }, 20);\n  }\n};\n\nhandlers.blur = function (view) {\n  if (view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.remove(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.domObserver.currentSelection.set({});\n    view.focused = false;\n  }\n};\n\nhandlers.beforeinput = function (view, event) {\n  // We should probably do more with beforeinput events, but support\n  // is so spotty that I'm still waiting to see where they are going.\n\n  // Very specific hack to deal with backspace sometimes failing on\n  // Chrome Android when after an uneditable node.\n  if (result.chrome && result.android && event.inputType == \"deleteContentBackward\") {\n    var domChangeCount = view.domChangeCount;\n    setTimeout(function () {\n      if (view.domChangeCount != domChangeCount) { return } // Event already had some effect\n      // This bug tends to close the virtual keyboard, so we refocus\n      view.dom.blur();\n      view.focus();\n      if (view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) { return }\n      var ref = view.state.selection;\n      var $cursor = ref.$cursor;\n      // Crude approximation of backspace behavior when no command handled it\n      if ($cursor && $cursor.pos > 0) { view.dispatch(view.state.tr.delete($cursor.pos - 1, $cursor.pos).scrollIntoView()); }\n    }, 50);\n  }\n};\n\n// Make sure all handlers get registered\nfor (var prop in editHandlers) { handlers[prop] = editHandlers[prop]; }\n\nfunction compareObjs(a, b) {\n  if (a == b) { return true }\n  for (var p in a) { if (a[p] !== b[p]) { return false } }\n  for (var p$1 in b) { if (!(p$1 in a)) { return false } }\n  return true\n}\n\nvar WidgetType = function WidgetType(toDOM, spec) {\n  this.spec = spec || noSpec;\n  this.side = this.spec.side || 0;\n  this.toDOM = toDOM;\n};\n\nWidgetType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var ref = mapping.mapResult(span.from + oldOffset, this.side < 0 ? -1 : 1);\n    var pos = ref.pos;\n    var deleted = ref.deleted;\n  return deleted ? null : new Decoration(pos - offset, pos - offset, this)\n};\n\nWidgetType.prototype.valid = function valid () { return true };\n\nWidgetType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof WidgetType &&\n     (this.spec.key && this.spec.key == other.spec.key ||\n      this.toDOM == other.toDOM && compareObjs(this.spec, other.spec)))\n};\n\nvar InlineType = function InlineType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nInlineType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.map(span.from + oldOffset, this.spec.inclusiveStart ? -1 : 1) - offset;\n  var to = mapping.map(span.to + oldOffset, this.spec.inclusiveEnd ? 1 : -1) - offset;\n  return from >= to ? null : new Decoration(from, to, this)\n};\n\nInlineType.prototype.valid = function valid (_, span) { return span.from < span.to };\n\nInlineType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof InlineType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\nInlineType.is = function is (span) { return span.type instanceof InlineType };\n\nvar NodeType = function NodeType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nNodeType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.mapResult(span.from + oldOffset, 1);\n  if (from.deleted) { return null }\n  var to = mapping.mapResult(span.to + oldOffset, -1);\n  if (to.deleted || to.pos <= from.pos) { return null }\n  return new Decoration(from.pos - offset, to.pos - offset, this)\n};\n\nNodeType.prototype.valid = function valid (node, span) {\n  var ref = node.content.findIndex(span.from);\n    var index = ref.index;\n    var offset = ref.offset;\n  return offset == span.from && offset + node.child(index).nodeSize == span.to\n};\n\nNodeType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof NodeType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\n// ::- Decoration objects can be provided to the view through the\n// [`decorations` prop](#view.EditorProps.decorations). They come in\n// several variantssee the static members of this class for details.\nvar Decoration = function Decoration(from, to, type) {\n  // :: number\n  // The start position of the decoration.\n  this.from = from;\n  // :: number\n  // The end position. Will be the same as `from` for [widget\n  // decorations](#view.Decoration^widget).\n  this.to = to;\n  this.type = type;\n};\n\nvar prototypeAccessors$1 = { spec: { configurable: true },inline: { configurable: true } };\n\nDecoration.prototype.copy = function copy (from, to) {\n  return new Decoration(from, to, this.type)\n};\n\nDecoration.prototype.eq = function eq (other, offset) {\n    if ( offset === void 0 ) offset = 0;\n\n  return this.type.eq(other.type) && this.from + offset == other.from && this.to + offset == other.to\n};\n\nDecoration.prototype.map = function map (mapping, offset, oldOffset) {\n  return this.type.map(mapping, this, offset, oldOffset)\n};\n\n// :: (number, union<(view: EditorView, getPos: ()  number)  dom.Node, dom.Node>, ?Object)  Decoration\n// Creates a widget decoration, which is a DOM node that's shown in\n// the document at the given position. It is recommended that you\n// delay rendering the widget by passing a function that will be\n// called when the widget is actually drawn in a view, but you can\n// also directly pass a DOM node. `getPos` can be used to find the\n// widget's current document position.\n//\n// spec::- These options are supported:\n//\n//   side:: ?number\n//   Controls which side of the document position this widget is\n//   associated with. When negative, it is drawn before a cursor\n//   at its position, and content inserted at that position ends\n//   up after the widget. When zero (the default) or positive, the\n//   widget is drawn after the cursor and content inserted there\n//   ends up before the widget.\n//\n//   When there are multiple widgets at a given position, their\n//   `side` values determine the order in which they appear. Those\n//   with lower values appear first. The ordering of widgets with\n//   the same `side` value is unspecified.\n//\n//   When `marks` is null, `side` also determines the marks that\n//   the widget is wrapped inthose of the node before when\n//   negative, those of the node after when positive.\n//\n//   marks:: ?[Mark]\n//   The precise set of marks to draw around the widget.\n//\n//   stopEvent:: ?(event: dom.Event)  bool\n//   Can be used to control which DOM events, when they bubble out\n//   of this widget, the editor view should ignore.\n//\n//   ignoreSelection:: ?bool\n//   When set (defaults to false), selection changes inside the\n//   widget are ignored, and don't cause ProseMirror to try and\n//   re-sync the selection with its selection state.\n//\n//   key:: ?string\n//   When comparing decorations of this type (in order to decide\n//   whether it needs to be redrawn), ProseMirror will by default\n//   compare the widget DOM node by identity. If you pass a key,\n//   that key will be compared instead, which can be useful when\n//   you generate decorations on the fly and don't want to store\n//   and reuse DOM nodes. Make sure that any widgets with the same\n//   key are interchangeableif widgets differ in, for example,\n//   the behavior of some event handler, they should get\n//   different keys.\nDecoration.widget = function widget (pos, toDOM, spec) {\n  return new Decoration(pos, pos, new WidgetType(toDOM, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object)  Decoration\n// Creates an inline decoration, which adds the given attributes to\n// each inline node between `from` and `to`.\n//\n// spec::- These options are recognized:\n//\n//   inclusiveStart:: ?bool\n//   Determines how the left side of the decoration is\n//   [mapped](#transform.Position_Mapping) when content is\n//   inserted directly at that position. By default, the decoration\n//   won't include the new content, but you can set this to `true`\n//   to make it inclusive.\n//\n//   inclusiveEnd:: ?bool\n//   Determines how the right side of the decoration is mapped.\n//   See\n//   [`inclusiveStart`](#view.Decoration^inline^spec.inclusiveStart).\nDecoration.inline = function inline (from, to, attrs, spec) {\n  return new Decoration(from, to, new InlineType(attrs, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object)  Decoration\n// Creates a node decoration. `from` and `to` should point precisely\n// before and after a node in the document. That node, and only that\n// node, will receive the given attributes.\n//\n// spec::-\n//\n// Optional information to store with the decoration. It\n// is also used when comparing decorators for equality.\nDecoration.node = function node (from, to, attrs, spec) {\n  return new Decoration(from, to, new NodeType(attrs, spec))\n};\n\n// :: Object\n// The spec provided when creating this decoration. Can be useful\n// if you've stored extra information in that object.\nprototypeAccessors$1.spec.get = function () { return this.type.spec };\n\nprototypeAccessors$1.inline.get = function () { return this.type instanceof InlineType };\n\nObject.defineProperties( Decoration.prototype, prototypeAccessors$1 );\n\n// DecorationAttrs:: interface\n// A set of attributes to add to a decorated node. Most properties\n// simply directly correspond to DOM attributes of the same name,\n// which will be set to the property's value. These are exceptions:\n//\n//   class:: ?string\n//   A CSS class name or a space-separated set of class names to be\n//   _added_ to the classes that the node already had.\n//\n//   style:: ?string\n//   A string of CSS to be _added_ to the node's existing `style` property.\n//\n//   nodeName:: ?string\n//   When non-null, the target node is wrapped in a DOM element of\n//   this type (and the other attributes are applied to this element).\n\nvar none = [], noSpec = {};\n\n// ::- A collection of [decorations](#view.Decoration), organized in\n// such a way that the drawing algorithm can efficiently use and\n// compare them. This is a persistent data structureit is not\n// modified, updates create a new value.\nvar DecorationSet = function DecorationSet(local, children) {\n  this.local = local && local.length ? local : none;\n  this.children = children && children.length ? children : none;\n};\n\n// :: (Node, [Decoration])  DecorationSet\n// Create a set of decorations, using the structure of the given\n// document.\nDecorationSet.create = function create (doc, decorations) {\n  return decorations.length ? buildTree(decorations, doc, 0, noSpec) : empty\n};\n\n// :: (?number, ?number, ?(spec: Object)  bool)  [Decoration]\n// Find all decorations in this set which touch the given range\n// (including decorations that start or end directly at the\n// boundaries) and match the given predicate on their spec. When\n// `start` and `end` are omitted, all decorations in the set are\n// considered. When `predicate` isn't given, all decorations are\n// assumed to match.\nDecorationSet.prototype.find = function find (start, end, predicate) {\n  var result = [];\n  this.findInner(start == null ? 0 : start, end == null ? 1e9 : end, result, 0, predicate);\n  return result\n};\n\nDecorationSet.prototype.findInner = function findInner (start, end, result, offset, predicate) {\n  for (var i = 0; i < this.local.length; i++) {\n    var span = this.local[i];\n    if (span.from <= end && span.to >= start && (!predicate || predicate(span.spec)))\n      { result.push(span.copy(span.from + offset, span.to + offset)); }\n  }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3) {\n    if (this.children[i$1] < end && this.children[i$1 + 1] > start) {\n      var childOff = this.children[i$1] + 1;\n      this.children[i$1 + 2].findInner(start - childOff, end - childOff, result, offset + childOff, predicate);\n    }\n  }\n};\n\n// :: (Mapping, Node, ?Object)  DecorationSet\n// Map the set of decorations in response to a change in the\n// document.\n//\n// options::- An optional set of options.\n//\n//   onRemove:: ?(decorationSpec: Object)\n//   When given, this function will be called for each decoration\n//   that gets dropped as a result of the mapping, passing the\n//   spec of that decoration.\nDecorationSet.prototype.map = function map (mapping, doc, options) {\n  if (this == empty || mapping.maps.length == 0) { return this }\n  return this.mapInner(mapping, doc, 0, 0, options || noSpec)\n};\n\nDecorationSet.prototype.mapInner = function mapInner (mapping, node, offset, oldOffset, options) {\n  var newLocal;\n  for (var i = 0; i < this.local.length; i++) {\n    var mapped = this.local[i].map(mapping, offset, oldOffset);\n    if (mapped && mapped.type.valid(node, mapped)) { (newLocal || (newLocal = [])).push(mapped); }\n    else if (options.onRemove) { options.onRemove(this.local[i].spec); }\n  }\n\n  if (this.children.length)\n    { return mapChildren(this.children, newLocal, mapping, node, offset, oldOffset, options) }\n  else\n    { return newLocal ? new DecorationSet(newLocal.sort(byPos)) : empty }\n};\n\n// :: (Node, [Decoration])  DecorationSet\n// Add the given array of decorations to the ones in the set,\n// producing a new set. Needs access to the current document to\n// create the appropriate tree structure.\nDecorationSet.prototype.add = function add (doc, decorations) {\n  if (!decorations.length) { return this }\n  if (this == empty) { return DecorationSet.create(doc, decorations) }\n  return this.addInner(doc, decorations, 0)\n};\n\nDecorationSet.prototype.addInner = function addInner (doc, decorations, offset) {\n    var this$1 = this;\n\n  var children, childIndex = 0;\n  doc.forEach(function (childNode, childOffset) {\n    var baseOffset = childOffset + offset, found;\n    if (!(found = takeSpansForNode(decorations, childNode, baseOffset))) { return }\n\n    if (!children) { children = this$1.children.slice(); }\n    while (childIndex < children.length && children[childIndex] < childOffset) { childIndex += 3; }\n    if (children[childIndex] == childOffset)\n      { children[childIndex + 2] = children[childIndex + 2].addInner(childNode, found, baseOffset + 1); }\n    else\n      { children.splice(childIndex, 0, childOffset, childOffset + childNode.nodeSize, buildTree(found, childNode, baseOffset + 1, noSpec)); }\n    childIndex += 3;\n  });\n\n  var local = moveSpans(childIndex ? withoutNulls(decorations) : decorations, -offset);\n  for (var i = 0; i < local.length; i++) { if (!local[i].type.valid(doc, local[i])) { local.splice(i--, 1); } }\n\n  return new DecorationSet(local.length ? this.local.concat(local).sort(byPos) : this.local,\n                           children || this.children)\n};\n\n// :: ([Decoration])  DecorationSet\n// Create a new set that contains the decorations in this set, minus\n// the ones in the given array.\nDecorationSet.prototype.remove = function remove (decorations) {\n  if (decorations.length == 0 || this == empty) { return this }\n  return this.removeInner(decorations, 0)\n};\n\nDecorationSet.prototype.removeInner = function removeInner (decorations, offset) {\n  var children = this.children, local = this.local;\n  for (var i = 0; i < children.length; i += 3) {\n    var found = (void 0), from = children[i] + offset, to = children[i + 1] + offset;\n    for (var j = 0, span = (void 0); j < decorations.length; j++) { if (span = decorations[j]) {\n      if (span.from > from && span.to < to) {\n        decorations[j] = null\n        ;(found || (found = [])).push(span);\n      }\n    } }\n    if (!found) { continue }\n    if (children == this.children) { children = this.children.slice(); }\n    var removed = children[i + 2].removeInner(found, from + 1);\n    if (removed != empty) {\n      children[i + 2] = removed;\n    } else {\n      children.splice(i, 3);\n      i -= 3;\n    }\n  }\n  if (local.length) { for (var i$1 = 0, span$1 = (void 0); i$1 < decorations.length; i$1++) { if (span$1 = decorations[i$1]) {\n    for (var j$1 = 0; j$1 < local.length; j$1++) { if (local[j$1].eq(span$1, offset)) {\n      if (local == this.local) { local = this.local.slice(); }\n      local.splice(j$1--, 1);\n    } }\n  } } }\n  if (children == this.children && local == this.local) { return this }\n  return local.length || children.length ? new DecorationSet(local, children) : empty\n};\n\nDecorationSet.prototype.forChild = function forChild (offset, node) {\n  if (this == empty) { return this }\n  if (node.isLeaf) { return DecorationSet.empty }\n\n  var child, local;\n  for (var i = 0; i < this.children.length; i += 3) { if (this.children[i] >= offset) {\n    if (this.children[i] == offset) { child = this.children[i + 2]; }\n    break\n  } }\n  var start = offset + 1, end = start + node.content.size;\n  for (var i$1 = 0; i$1 < this.local.length; i$1++) {\n    var dec = this.local[i$1];\n    if (dec.from < end && dec.to > start && (dec.type instanceof InlineType)) {\n      var from = Math.max(start, dec.from) - start, to = Math.min(end, dec.to) - start;\n      if (from < to) { (local || (local = [])).push(dec.copy(from, to)); }\n    }\n  }\n  if (local) {\n    var localSet = new DecorationSet(local.sort(byPos));\n    return child ? new DecorationGroup([localSet, child]) : localSet\n  }\n  return child || empty\n};\n\nDecorationSet.prototype.eq = function eq (other) {\n  if (this == other) { return true }\n  if (!(other instanceof DecorationSet) ||\n      this.local.length != other.local.length ||\n      this.children.length != other.children.length) { return false }\n  for (var i = 0; i < this.local.length; i++)\n    { if (!this.local[i].eq(other.local[i])) { return false } }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3)\n    { if (this.children[i$1] != other.children[i$1] ||\n        this.children[i$1 + 1] != other.children[i$1 + 1] ||\n        !this.children[i$1 + 2].eq(other.children[i$1 + 2])) { return false } }\n  return true\n};\n\nDecorationSet.prototype.locals = function locals (node) {\n  return removeOverlap(this.localsInner(node))\n};\n\nDecorationSet.prototype.localsInner = function localsInner (node) {\n  if (this == empty) { return none }\n  if (node.inlineContent || !this.local.some(InlineType.is)) { return this.local }\n  var result = [];\n  for (var i = 0; i < this.local.length; i++) {\n    if (!(this.local[i].type instanceof InlineType))\n      { result.push(this.local[i]); }\n  }\n  return result\n};\n\nvar empty = new DecorationSet();\n\n// :: DecorationSet\n// The empty set of decorations.\nDecorationSet.empty = empty;\n\nDecorationSet.removeOverlap = removeOverlap;\n\n// :- An abstraction that allows the code dealing with decorations to\n// treat multiple DecorationSet objects as if it were a single object\n// with (a subset of) the same interface.\nvar DecorationGroup = function DecorationGroup(members) {\n  this.members = members;\n};\n\nDecorationGroup.prototype.forChild = function forChild (offset, child) {\n  if (child.isLeaf) { return DecorationSet.empty }\n  var found = [];\n  for (var i = 0; i < this.members.length; i++) {\n    var result = this.members[i].forChild(offset, child);\n    if (result == empty) { continue }\n    if (result instanceof DecorationGroup) { found = found.concat(result.members); }\n    else { found.push(result); }\n  }\n  return DecorationGroup.from(found)\n};\n\nDecorationGroup.prototype.eq = function eq (other) {\n  if (!(other instanceof DecorationGroup) ||\n      other.members.length != this.members.length) { return false }\n  for (var i = 0; i < this.members.length; i++)\n    { if (!this.members[i].eq(other.members[i])) { return false } }\n  return true\n};\n\nDecorationGroup.prototype.locals = function locals (node) {\n  var result, sorted = true;\n  for (var i = 0; i < this.members.length; i++) {\n    var locals = this.members[i].localsInner(node);\n    if (!locals.length) { continue }\n    if (!result) {\n      result = locals;\n    } else {\n      if (sorted) {\n        result = result.slice();\n        sorted = false;\n      }\n      for (var j = 0; j < locals.length; j++) { result.push(locals[j]); }\n    }\n  }\n  return result ? removeOverlap(sorted ? result : result.sort(byPos)) : none\n};\n\n// : ([DecorationSet])  union<DecorationSet, DecorationGroup>\n// Create a group for the given array of decoration sets, or return\n// a single set when possible.\nDecorationGroup.from = function from (members) {\n  switch (members.length) {\n    case 0: return empty\n    case 1: return members[0]\n    default: return new DecorationGroup(members)\n  }\n};\n\nfunction mapChildren(oldChildren, newLocal, mapping, node, offset, oldOffset, options) {\n  var children = oldChildren.slice();\n\n  // Mark the children that are directly touched by changes, and\n  // move those that are after the changes.\n  var shift = function (oldStart, oldEnd, newStart, newEnd) {\n    for (var i = 0; i < children.length; i += 3) {\n      var end = children[i + 1], dSize = (void 0);\n      if (end == -1 || oldStart > end + oldOffset) { continue }\n      if (oldEnd >= children[i] + oldOffset) {\n        children[i + 1] = -1;\n      } else if (newStart >= offset && (dSize = (newEnd - newStart) - (oldEnd - oldStart))) {\n        children[i] += dSize;\n        children[i + 1] += dSize;\n      }\n    }\n  };\n  for (var i = 0; i < mapping.maps.length; i++) { mapping.maps[i].forEach(shift); }\n\n  // Find the child nodes that still correspond to a single node,\n  // recursively call mapInner on them and update their positions.\n  var mustRebuild = false;\n  for (var i$1 = 0; i$1 < children.length; i$1 += 3) { if (children[i$1 + 1] == -1) { // Touched nodes\n    var from = mapping.map(oldChildren[i$1] + oldOffset), fromLocal = from - offset;\n    if (fromLocal < 0 || fromLocal >= node.content.size) {\n      mustRebuild = true;\n      continue\n    }\n    // Must read oldChildren because children was tagged with -1\n    var to = mapping.map(oldChildren[i$1 + 1] + oldOffset, -1), toLocal = to - offset;\n    var ref = node.content.findIndex(fromLocal);\n    var index = ref.index;\n    var childOffset = ref.offset;\n    var childNode = node.maybeChild(index);\n    if (childNode && childOffset == fromLocal && childOffset + childNode.nodeSize == toLocal) {\n      var mapped = children[i$1 + 2].mapInner(mapping, childNode, from + 1, oldChildren[i$1] + oldOffset + 1, options);\n      if (mapped != empty) {\n        children[i$1] = fromLocal;\n        children[i$1 + 1] = toLocal;\n        children[i$1 + 2] = mapped;\n      } else {\n        children[i$1 + 1] = -2;\n        mustRebuild = true;\n      }\n    } else {\n      mustRebuild = true;\n    }\n  } }\n\n  // Remaining children must be collected and rebuilt into the appropriate structure\n  if (mustRebuild) {\n    var decorations = mapAndGatherRemainingDecorations(children, oldChildren, newLocal || [], mapping,\n                                                       offset, oldOffset, options);\n    var built = buildTree(decorations, node, 0, options);\n    newLocal = built.local;\n    for (var i$2 = 0; i$2 < children.length; i$2 += 3) { if (children[i$2 + 1] < 0) {\n      children.splice(i$2, 3);\n      i$2 -= 3;\n    } }\n    for (var i$3 = 0, j = 0; i$3 < built.children.length; i$3 += 3) {\n      var from$1 = built.children[i$3];\n      while (j < children.length && children[j] < from$1) { j += 3; }\n      children.splice(j, 0, built.children[i$3], built.children[i$3 + 1], built.children[i$3 + 2]);\n    }\n  }\n\n  return new DecorationSet(newLocal && newLocal.sort(byPos), children)\n}\n\nfunction moveSpans(spans, offset) {\n  if (!offset || !spans.length) { return spans }\n  var result = [];\n  for (var i = 0; i < spans.length; i++) {\n    var span = spans[i];\n    result.push(new Decoration(span.from + offset, span.to + offset, span.type));\n  }\n  return result\n}\n\nfunction mapAndGatherRemainingDecorations(children, oldChildren, decorations, mapping, offset, oldOffset, options) {\n  // Gather all decorations from the remaining marked children\n  function gather(set, oldOffset) {\n    for (var i = 0; i < set.local.length; i++) {\n      var mapped = set.local[i].map(mapping, offset, oldOffset);\n      if (mapped) { decorations.push(mapped); }\n      else if (options.onRemove) { options.onRemove(set.local[i].spec); }\n    }\n    for (var i$1 = 0; i$1 < set.children.length; i$1 += 3)\n      { gather(set.children[i$1 + 2], set.children[i$1] + oldOffset + 1); }\n  }\n  for (var i = 0; i < children.length; i += 3) { if (children[i + 1] == -1)\n    { gather(children[i + 2], oldChildren[i] + oldOffset + 1); } }\n\n  return decorations\n}\n\nfunction takeSpansForNode(spans, node, offset) {\n  if (node.isLeaf) { return null }\n  var end = offset + node.nodeSize, found = null;\n  for (var i = 0, span = (void 0); i < spans.length; i++) {\n    if ((span = spans[i]) && span.from > offset && span.to < end) {\n(found || (found = [])).push(span);\n      spans[i] = null;\n    }\n  }\n  return found\n}\n\nfunction withoutNulls(array) {\n  var result = [];\n  for (var i = 0; i < array.length; i++)\n    { if (array[i] != null) { result.push(array[i]); } }\n  return result\n}\n\n// : ([Decoration], Node, number)  DecorationSet\n// Build up a tree that corresponds to a set of decorations. `offset`\n// is a base offset that should be subtractet from the `from` and `to`\n// positions in the spans (so that we don't have to allocate new spans\n// for recursive calls).\nfunction buildTree(spans, node, offset, options) {\n  var children = [], hasNulls = false;\n  node.forEach(function (childNode, localStart) {\n    var found = takeSpansForNode(spans, childNode, localStart + offset);\n    if (found) {\n      hasNulls = true;\n      var subtree = buildTree(found, childNode, offset + localStart + 1, options);\n      if (subtree != empty)\n        { children.push(localStart, localStart + childNode.nodeSize, subtree); }\n    }\n  });\n  var locals = moveSpans(hasNulls ? withoutNulls(spans) : spans, -offset).sort(byPos);\n  for (var i = 0; i < locals.length; i++) { if (!locals[i].type.valid(node, locals[i])) {\n    if (options.onRemove) { options.onRemove(locals[i].spec); }\n    locals.splice(i--, 1);\n  } }\n  return locals.length || children.length ? new DecorationSet(locals, children) : empty\n}\n\n// : (Decoration, Decoration)  number\n// Used to sort decorations so that ones with a low start position\n// come first, and within a set with the same start position, those\n// with an smaller end position come first.\nfunction byPos(a, b) {\n  return a.from - b.from || a.to - b.to\n}\n\n// : ([Decoration])  [Decoration]\n// Scan a sorted array of decorations for partially overlapping spans,\n// and split those so that only fully overlapping spans are left (to\n// make subsequent rendering easier). Will return the input array if\n// no partially overlapping spans are found (the common case).\nfunction removeOverlap(spans) {\n  var working = spans;\n  for (var i = 0; i < working.length - 1; i++) {\n    var span = working[i];\n    if (span.from != span.to) { for (var j = i + 1; j < working.length; j++) {\n      var next = working[j];\n      if (next.from == span.from) {\n        if (next.to != span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // Followed by a partially overlapping larger span. Split that\n          // span.\n          working[j] = next.copy(next.from, span.to);\n          insertAhead(working, j + 1, next.copy(span.to, next.to));\n        }\n        continue\n      } else {\n        if (next.from < span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // The end of this one overlaps with a subsequent span. Split\n          // this one.\n          working[i] = span.copy(span.from, next.from);\n          insertAhead(working, j, span.copy(next.from, span.to));\n        }\n        break\n      }\n    } }\n  }\n  return working\n}\n\nfunction insertAhead(array, i, deco) {\n  while (i < array.length && byPos(deco, array[i]) > 0) { i++; }\n  array.splice(i, 0, deco);\n}\n\n// : (EditorView)  union<DecorationSet, DecorationGroup>\n// Get the decorations associated with the current props of a view.\nfunction viewDecorations(view) {\n  var found = [];\n  view.someProp(\"decorations\", function (f) {\n    var result = f(view.state);\n    if (result && result != empty) { found.push(result); }\n  });\n  if (view.cursorWrapper)\n    { found.push(DecorationSet.create(view.state.doc, [view.cursorWrapper.deco])); }\n  return DecorationGroup.from(found)\n}\n\n// ::- An editor view manages the DOM structure that represents an\n// editable document. Its state and behavior are determined by its\n// [props](#view.DirectEditorProps).\nvar EditorView = function EditorView(place, props) {\n  this._props = props;\n  // :: EditorState\n  // The view's current [state](#state.EditorState).\n  this.state = props.state;\n\n  this.dispatch = this.dispatch.bind(this);\n\n  this._root = null;\n  this.focused = false;\n  // Kludge used to work around a Chrome bug\n  this.trackWrites = null;\n\n  // :: dom.Element\n  // An editable DOM node containing the document. (You probably\n  // should not directly interfere with its content.)\n  this.dom = (place && place.mount) || document.createElement(\"div\");\n  if (place) {\n    if (place.appendChild) { place.appendChild(this.dom); }\n    else if (place.apply) { place(this.dom); }\n    else if (place.mount) { this.mounted = true; }\n  }\n\n  // :: bool\n  // Indicates whether the editor is currently [editable](#view.EditorProps.editable).\n  this.editable = getEditable(this);\n  this.markCursor = null;\n  this.cursorWrapper = null;\n  updateCursorWrapper(this);\n  this.nodeViews = buildNodeViews(this);\n  this.docView = docViewDesc(this.state.doc, computeDocDeco(this), viewDecorations(this), this.dom, this);\n\n  this.lastSelectedViewDesc = null;\n  // :: ?{slice: Slice, move: bool}\n  // When editor content is being dragged, this object contains\n  // information about the dragged slice and whether it is being\n  // copied or moved. At any other time, it is null.\n  this.dragging = null;\n\n  initInput(this);\n\n  this.pluginViews = [];\n  this.updatePluginViews();\n};\n\nvar prototypeAccessors$2 = { props: { configurable: true },root: { configurable: true } };\n\n// composing:: boolean\n// Holds `true` when a\n// [composition](https://developer.mozilla.org/en-US/docs/Mozilla/IME_handling_guide)\n// is active.\n\n// :: DirectEditorProps\n// The view's current [props](#view.EditorProps).\nprototypeAccessors$2.props.get = function () {\n  if (this._props.state != this.state) {\n    var prev = this._props;\n    this._props = {};\n    for (var name in prev) { this._props[name] = prev[name]; }\n    this._props.state = this.state;\n  }\n  return this._props\n};\n\n// :: (DirectEditorProps)\n// Update the view's props. Will immediately cause an update to\n// the DOM.\nEditorView.prototype.update = function update (props) {\n  if (props.handleDOMEvents != this._props.handleDOMEvents) { ensureListeners(this); }\n  this._props = props;\n  this.updateStateInner(props.state, true);\n};\n\n// :: (DirectEditorProps)\n// Update the view by updating existing props object with the object\n// given as argument. Equivalent to `view.update(Object.assign({},\n// view.props, props))`.\nEditorView.prototype.setProps = function setProps (props) {\n  var updated = {};\n  for (var name in this._props) { updated[name] = this._props[name]; }\n  updated.state = this.state;\n  for (var name$1 in props) { updated[name$1] = props[name$1]; }\n  this.update(updated);\n};\n\n// :: (EditorState)\n// Update the editor's `state` prop, without touching any of the\n// other props.\nEditorView.prototype.updateState = function updateState (state) {\n  this.updateStateInner(state, this.state.plugins != state.plugins);\n};\n\nEditorView.prototype.updateStateInner = function updateStateInner (state, reconfigured) {\n    var this$1 = this;\n\n  var prev = this.state, redraw = false, updateSel = false;\n  // When stored marks are added, stop composition, so that they can\n  // be displayed.\n  if (state.storedMarks && this.composing) {\n    clearComposition(this);\n    updateSel = true;\n  }\n  this.state = state;\n  if (reconfigured) {\n    var nodeViews = buildNodeViews(this);\n    if (changedNodeViews(nodeViews, this.nodeViews)) {\n      this.nodeViews = nodeViews;\n      redraw = true;\n    }\n    ensureListeners(this);\n  }\n\n  this.editable = getEditable(this);\n  updateCursorWrapper(this);\n  var innerDeco = viewDecorations(this), outerDeco = computeDocDeco(this);\n\n  var scroll = reconfigured ? \"reset\"\n      : state.scrollToSelection > prev.scrollToSelection ? \"to selection\" : \"preserve\";\n  var updateDoc = redraw || !this.docView.matchesNode(state.doc, outerDeco, innerDeco);\n  if (updateDoc || !state.selection.eq(prev.selection)) { updateSel = true; }\n  var oldScrollPos = scroll == \"preserve\" && updateSel && this.dom.style.overflowAnchor == null && storeScrollPos(this);\n\n  if (updateSel) {\n    this.domObserver.stop();\n    // Work around an issue in Chrome, IE, and Edge where changing\n    // the DOM around an active selection puts it into a broken\n    // state where the thing the user sees differs from the\n    // selection reported by the Selection object (#710, #973,\n    // #1011, #1013, #1035).\n    var forceSelUpdate = updateDoc && (result.ie || result.chrome) && !this.composing &&\n        !prev.selection.empty && !state.selection.empty && selectionContextChanged(prev.selection, state.selection);\n    if (updateDoc) {\n      // If the node that the selection points into is written to,\n      // Chrome sometimes starts misreporting the selection, so this\n      // tracks that and forces a selection reset when our update\n      // did write to the node.\n      var chromeKludge = result.chrome ? (this.trackWrites = this.root.getSelection().focusNode) : null;\n      if (redraw || !this.docView.update(state.doc, outerDeco, innerDeco, this)) {\n        this.docView.updateOuterDeco([]);\n        this.docView.destroy();\n        this.docView = docViewDesc(state.doc, outerDeco, innerDeco, this.dom, this);\n      }\n      if (chromeKludge && !this.trackWrites) { forceSelUpdate = true; }\n    }\n    // Work around for an issue where an update arriving right between\n    // a DOM selection change and the \"selectionchange\" event for it\n    // can cause a spurious DOM selection update, disrupting mouse\n    // drag selection.\n    if (forceSelUpdate ||\n        !(this.mouseDown && this.domObserver.currentSelection.eq(this.root.getSelection()) && anchorInRightPlace(this))) {\n      selectionToDOM(this, forceSelUpdate);\n    } else {\n      syncNodeSelection(this, state.selection);\n      this.domObserver.setCurSelection();\n    }\n    this.domObserver.start();\n  }\n\n  this.updatePluginViews(prev);\n\n  if (scroll == \"reset\") {\n    this.dom.scrollTop = 0;\n  } else if (scroll == \"to selection\") {\n    var startDOM = this.root.getSelection().focusNode;\n    if (this.someProp(\"handleScrollToSelection\", function (f) { return f(this$1); }))\n      ; // Handled\n    else if (state.selection instanceof NodeSelection)\n      { scrollRectIntoView(this, this.docView.domAfterPos(state.selection.from).getBoundingClientRect(), startDOM); }\n    else\n      { scrollRectIntoView(this, this.coordsAtPos(state.selection.head, 1), startDOM); }\n  } else if (oldScrollPos) {\n    resetScrollPos(oldScrollPos);\n  }\n};\n\nEditorView.prototype.destroyPluginViews = function destroyPluginViews () {\n  var view;\n  while (view = this.pluginViews.pop()) { if (view.destroy) { view.destroy(); } }\n};\n\nEditorView.prototype.updatePluginViews = function updatePluginViews (prevState) {\n  if (!prevState || prevState.plugins != this.state.plugins) {\n    this.destroyPluginViews();\n    for (var i = 0; i < this.state.plugins.length; i++) {\n      var plugin = this.state.plugins[i];\n      if (plugin.spec.view) { this.pluginViews.push(plugin.spec.view(this)); }\n    }\n  } else {\n    for (var i$1 = 0; i$1 < this.pluginViews.length; i$1++) {\n      var pluginView = this.pluginViews[i$1];\n      if (pluginView.update) { pluginView.update(this, prevState); }\n    }\n  }\n};\n\n// :: (string, ?(prop: *)  *)  *\n// Goes over the values of a prop, first those provided directly,\n// then those from plugins (in order), and calls `f` every time a\n// non-undefined value is found. When `f` returns a truthy value,\n// that is immediately returned. When `f` isn't provided, it is\n// treated as the identity function (the prop value is returned\n// directly).\nEditorView.prototype.someProp = function someProp (propName, f) {\n  var prop = this._props && this._props[propName], value;\n  if (prop != null && (value = f ? f(prop) : prop)) { return value }\n  var plugins = this.state.plugins;\n  if (plugins) { for (var i = 0; i < plugins.length; i++) {\n    var prop$1 = plugins[i].props[propName];\n    if (prop$1 != null && (value = f ? f(prop$1) : prop$1)) { return value }\n  } }\n};\n\n// :: ()  bool\n// Query whether the view has focus.\nEditorView.prototype.hasFocus = function hasFocus () {\n  return this.root.activeElement == this.dom\n};\n\n// :: ()\n// Focus the editor.\nEditorView.prototype.focus = function focus () {\n  this.domObserver.stop();\n  if (this.editable) { focusPreventScroll(this.dom); }\n  selectionToDOM(this);\n  this.domObserver.start();\n};\n\n// :: union<dom.Document, dom.DocumentFragment>\n// Get the document root in which the editor exists. This will\n// usually be the top-level `document`, but might be a [shadow\n// DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM)\n// root if the editor is inside one.\nprototypeAccessors$2.root.get = function () {\n  var cached = this._root;\n  if (cached == null) { for (var search = this.dom.parentNode; search; search = search.parentNode) {\n    if (search.nodeType == 9 || (search.nodeType == 11 && search.host)) {\n      if (!search.getSelection) { Object.getPrototypeOf(search).getSelection = function () { return document.getSelection(); }; }\n      return this._root = search\n    }\n  } }\n  return cached || document\n};\n\n// :: ({left: number, top: number})  ?{pos: number, inside: number}\n// Given a pair of viewport coordinates, return the document\n// position that corresponds to them. May return null if the given\n// coordinates aren't inside of the editor. When an object is\n// returned, its `pos` property is the position nearest to the\n// coordinates, and its `inside` property holds the position of the\n// inner node that the position falls inside of, or -1 if it is at\n// the top level, not in any node.\nEditorView.prototype.posAtCoords = function posAtCoords$1 (coords) {\n  return posAtCoords(this, coords)\n};\n\n// :: (number, number)  {left: number, right: number, top: number, bottom: number}\n// Returns the viewport rectangle at a given document position.\n// `left` and `right` will be the same number, as this returns a\n// flat cursor-ish rectangle. If the position is between two things\n// that aren't directly adjacent, `side` determines which element is\n// used. When < 0, the element before the position is used,\n// otherwise the element after.\nEditorView.prototype.coordsAtPos = function coordsAtPos$1 (pos, side) {\n    if ( side === void 0 ) side = 1;\n\n  return coordsAtPos(this, pos, side)\n};\n\n// :: (number, number)  {node: dom.Node, offset: number}\n// Find the DOM position that corresponds to the given document\n// position. When `side` is negative, find the position as close as\n// possible to the content before the position. When positive,\n// prefer positions close to the content after the position. When\n// zero, prefer as shallow a position as possible.\n//\n// Note that you should **not** mutate the editor's internal DOM,\n// only inspect it (and even that is usually not necessary).\nEditorView.prototype.domAtPos = function domAtPos (pos, side) {\n    if ( side === void 0 ) side = 0;\n\n  return this.docView.domFromPos(pos, side)\n};\n\n// :: (number)  ?dom.Node\n// Find the DOM node that represents the document node after the\n// given position. May return `null` when the position doesn't point\n// in front of a node or if the node is inside an opaque node view.\n//\n// This is intended to be able to call things like\n// `getBoundingClientRect` on that DOM node. Do **not** mutate the\n// editor DOM directly, or add styling this way, since that will be\n// immediately overriden by the editor as it redraws the node.\nEditorView.prototype.nodeDOM = function nodeDOM (pos) {\n  var desc = this.docView.descAt(pos);\n  return desc ? desc.nodeDOM : null\n};\n\n// :: (dom.Node, number, ?number)  number\n// Find the document position that corresponds to a given DOM\n// position. (Whenever possible, it is preferable to inspect the\n// document structure directly, rather than poking around in the\n// DOM, but sometimesfor example when interpreting an event\n// targetyou don't have a choice.)\n//\n// The `bias` parameter can be used to influence which side of a DOM\n// node to use when the position is inside a leaf node.\nEditorView.prototype.posAtDOM = function posAtDOM (node, offset, bias) {\n    if ( bias === void 0 ) bias = -1;\n\n  var pos = this.docView.posFromDOM(node, offset, bias);\n  if (pos == null) { throw new RangeError(\"DOM position not inside the editor\") }\n  return pos\n};\n\n// :: (union<\"up\", \"down\", \"left\", \"right\", \"forward\", \"backward\">, ?EditorState)  bool\n// Find out whether the selection is at the end of a textblock when\n// moving in a given direction. When, for example, given `\"left\"`,\n// it will return true if moving left from the current cursor\n// position would leave that position's parent textblock. Will apply\n// to the view's current state by default, but it is possible to\n// pass a different state.\nEditorView.prototype.endOfTextblock = function endOfTextblock$1 (dir, state) {\n  return endOfTextblock(this, state || this.state, dir)\n};\n\n// :: ()\n// Removes the editor from the DOM and destroys all [node\n// views](#view.NodeView).\nEditorView.prototype.destroy = function destroy () {\n  if (!this.docView) { return }\n  destroyInput(this);\n  this.destroyPluginViews();\n  if (this.mounted) {\n    this.docView.update(this.state.doc, [], viewDecorations(this), this);\n    this.dom.textContent = \"\";\n  } else if (this.dom.parentNode) {\n    this.dom.parentNode.removeChild(this.dom);\n  }\n  this.docView.destroy();\n  this.docView = null;\n};\n\n// Used for testing.\nEditorView.prototype.dispatchEvent = function dispatchEvent$1 (event) {\n  return dispatchEvent(this, event)\n};\n\n// :: (Transaction)\n// Dispatch a transaction. Will call\n// [`dispatchTransaction`](#view.DirectEditorProps.dispatchTransaction)\n// when given, and otherwise defaults to applying the transaction to\n// the current state and calling\n// [`updateState`](#view.EditorView.updateState) with the result.\n// This method is bound to the view instance, so that it can be\n// easily passed around.\nEditorView.prototype.dispatch = function dispatch (tr) {\n  var dispatchTransaction = this._props.dispatchTransaction;\n  if (dispatchTransaction) { dispatchTransaction.call(this, tr); }\n  else { this.updateState(this.state.apply(tr)); }\n};\n\nObject.defineProperties( EditorView.prototype, prototypeAccessors$2 );\n\nfunction computeDocDeco(view) {\n  var attrs = Object.create(null);\n  attrs.class = \"ProseMirror\";\n  attrs.contenteditable = String(view.editable);\n\n  view.someProp(\"attributes\", function (value) {\n    if (typeof value == \"function\") { value = value(view.state); }\n    if (value) { for (var attr in value) {\n      if (attr == \"class\")\n        { attrs.class += \" \" + value[attr]; }\n      else if (!attrs[attr] && attr != \"contenteditable\" && attr != \"nodeName\")\n        { attrs[attr] = String(value[attr]); }\n    } }\n  });\n\n  return [Decoration.node(0, view.state.doc.content.size, attrs)]\n}\n\nfunction updateCursorWrapper(view) {\n  if (view.markCursor) {\n    var dom = document.createElement(\"img\");\n    dom.setAttribute(\"mark-placeholder\", \"true\");\n    view.cursorWrapper = {dom: dom, deco: Decoration.widget(view.state.selection.head, dom, {raw: true, marks: view.markCursor})};\n  } else {\n    view.cursorWrapper = null;\n  }\n}\n\nfunction getEditable(view) {\n  return !view.someProp(\"editable\", function (value) { return value(view.state) === false; })\n}\n\nfunction selectionContextChanged(sel1, sel2) {\n  var depth = Math.min(sel1.$anchor.sharedDepth(sel1.head), sel2.$anchor.sharedDepth(sel2.head));\n  return sel1.$anchor.start(depth) != sel2.$anchor.start(depth)\n}\n\nfunction buildNodeViews(view) {\n  var result = {};\n  view.someProp(\"nodeViews\", function (obj) {\n    for (var prop in obj) { if (!Object.prototype.hasOwnProperty.call(result, prop))\n      { result[prop] = obj[prop]; } }\n  });\n  return result\n}\n\nfunction changedNodeViews(a, b) {\n  var nA = 0, nB = 0;\n  for (var prop in a) {\n    if (a[prop] != b[prop]) { return true }\n    nA++;\n  }\n  for (var _ in b) { nB++; }\n  return nA != nB\n}\n\n// EditorProps:: interface\n//\n// Props are configuration values that can be passed to an editor view\n// or included in a plugin. This interface lists the supported props.\n//\n// The various event-handling functions may all return `true` to\n// indicate that they handled the given event. The view will then take\n// care to call `preventDefault` on the event, except with\n// `handleDOMEvents`, where the handler itself is responsible for that.\n//\n// How a prop is resolved depends on the prop. Handler functions are\n// called one at a time, starting with the base props and then\n// searching through the plugins (in order of appearance) until one of\n// them returns true. For some props, the first plugin that yields a\n// value gets precedence.\n//\n//   handleDOMEvents:: ?Object<(view: EditorView, event: dom.Event)  bool>\n//   Can be an object mapping DOM event type names to functions that\n//   handle them. Such functions will be called before any handling\n//   ProseMirror does of events fired on the editable DOM element.\n//   Contrary to the other event handling props, when returning true\n//   from such a function, you are responsible for calling\n//   `preventDefault` yourself (or not, if you want to allow the\n//   default behavior).\n//\n//   handleKeyDown:: ?(view: EditorView, event: dom.KeyboardEvent)  bool\n//   Called when the editor receives a `keydown` event.\n//\n//   handleKeyPress:: ?(view: EditorView, event: dom.KeyboardEvent)  bool\n//   Handler for `keypress` events.\n//\n//   handleTextInput:: ?(view: EditorView, from: number, to: number, text: string)  bool\n//   Whenever the user directly input text, this handler is called\n//   before the input is applied. If it returns `true`, the default\n//   behavior of actually inserting the text is suppressed.\n//\n//   handleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool)  bool\n//   Called for each node around a click, from the inside out. The\n//   `direct` flag will be true for the inner node.\n//\n//   handleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent)  bool\n//   Called when the editor is clicked, after `handleClickOn` handlers\n//   have been called.\n//\n//   handleDoubleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool)  bool\n//   Called for each node around a double click.\n//\n//   handleDoubleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent)  bool\n//   Called when the editor is double-clicked, after `handleDoubleClickOn`.\n//\n//   handleTripleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool)  bool\n//   Called for each node around a triple click.\n//\n//   handleTripleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent)  bool\n//   Called when the editor is triple-clicked, after `handleTripleClickOn`.\n//\n//   handlePaste:: ?(view: EditorView, event: dom.ClipboardEvent, slice: Slice)  bool\n//   Can be used to override the behavior of pasting. `slice` is the\n//   pasted content parsed by the editor, but you can directly access\n//   the event to get at the raw content.\n//\n//   handleDrop:: ?(view: EditorView, event: dom.Event, slice: Slice, moved: bool)  bool\n//   Called when something is dropped on the editor. `moved` will be\n//   true if this drop moves from the current selection (which should\n//   thus be deleted).\n//\n//   handleScrollToSelection:: ?(view: EditorView)  bool\n//   Called when the view, after updating its state, tries to scroll\n//   the selection into view. A handler function may return false to\n//   indicate that it did not handle the scrolling and further\n//   handlers or the default behavior should be tried.\n//\n//   createSelectionBetween:: ?(view: EditorView, anchor: ResolvedPos, head: ResolvedPos)  ?Selection\n//   Can be used to override the way a selection is created when\n//   reading a DOM selection between the given anchor and head.\n//\n//   domParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading editor changes\n//   from the DOM. Defaults to calling\n//   [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) on the\n//   editor's schema.\n//\n//   transformPastedHTML:: ?(html: string)  string\n//   Can be used to transform pasted HTML text, _before_ it is parsed,\n//   for example to clean it up.\n//\n//   clipboardParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading content from\n//   the clipboard. When not given, the value of the\n//   [`domParser`](#view.EditorProps.domParser) prop is used.\n//\n//   transformPastedText:: ?(text: string, plain: bool)  string\n//   Transform pasted plain text. The `plain` flag will be true when\n//   the text is pasted as plain text.\n//\n//   clipboardTextParser:: ?(text: string, $context: ResolvedPos, plain: bool)  Slice\n//   A function to parse text from the clipboard into a document\n//   slice. Called after\n//   [`transformPastedText`](#view.EditorProps.transformPastedText).\n//   The default behavior is to split the text into lines, wrap them\n//   in `<p>` tags, and call\n//   [`clipboardParser`](#view.EditorProps.clipboardParser) on it.\n//   The `plain` flag will be true when the text is pasted as plain text.\n//\n//   transformPasted:: ?(Slice)  Slice\n//   Can be used to transform pasted content before it is applied to\n//   the document.\n//\n//   nodeViews:: ?Object<(node: Node, view: EditorView, getPos: ()  number, decorations: [Decoration])  NodeView>\n//   Allows you to pass custom rendering and behavior logic for nodes\n//   and marks. Should map node and mark names to constructor\n//   functions that produce a [`NodeView`](#view.NodeView) object\n//   implementing the node's display behavior. For nodes, the third\n//   argument `getPos` is a function that can be called to get the\n//   node's current position, which can be useful when creating\n//   transactions to update it. For marks, the third argument is a\n//   boolean that indicates whether the mark's content is inline.\n//\n//   `decorations` is an array of node or inline decorations that are\n//   active around the node. They are automatically drawn in the\n//   normal way, and you will usually just want to ignore this, but\n//   they can also be used as a way to provide context information to\n//   the node view without adding it to the document itself.\n//\n//   clipboardSerializer:: ?DOMSerializer\n//   The DOM serializer to use when putting content onto the\n//   clipboard. If not given, the result of\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)\n//   will be used.\n//\n//   clipboardTextSerializer:: ?(Slice)  string\n//   A function that will be called to get the text for the current\n//   selection when copying text to the clipboard. By default, the\n//   editor will use [`textBetween`](#model.Node.textBetween) on the\n//   selected range.\n//\n//   decorations:: ?(state: EditorState)  ?DecorationSet\n//   A set of [document decorations](#view.Decoration) to show in the\n//   view.\n//\n//   editable:: ?(state: EditorState)  bool\n//   When this returns false, the content of the view is not directly\n//   editable.\n//\n//   attributes:: ?union<Object<string>, (EditorState)  ?Object<string>>\n//   Control the DOM attributes of the editable element. May be either\n//   an object or a function going from an editor state to an object.\n//   By default, the element will get a class `\"ProseMirror\"`, and\n//   will have its `contentEditable` attribute determined by the\n//   [`editable` prop](#view.EditorProps.editable). Additional classes\n//   provided here will be added to the class. For other attributes,\n//   the value provided first (as in\n//   [`someProp`](#view.EditorView.someProp)) will be used.\n//\n//   scrollThreshold:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the distance (in pixels) between the cursor and the\n//   end of the visible viewport at which point, when scrolling the\n//   cursor into view, scrolling takes place. Defaults to 0.\n//\n//   scrollMargin:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the extra space (in pixels) that is left above or\n//   below the cursor when it is scrolled into view. Defaults to 5.\n\n// DirectEditorProps:: interface extends EditorProps\n//\n// The props object given directly to the editor view supports two\n// fields that can't be used in plugins:\n//\n//   state:: EditorState\n//   The current state of the editor.\n//\n//   dispatchTransaction:: ?(tr: Transaction)\n//   The callback over which to send transactions (state updates)\n//   produced by the view. If you specify this, you probably want to\n//   make sure this ends up calling the view's\n//   [`updateState`](#view.EditorView.updateState) method with a new\n//   state that has the transaction\n//   [applied](#state.EditorState.apply). The callback will be bound to have\n//   the view instance as its `this` binding.\n\nexport { Decoration, DecorationSet, EditorView, endComposition as __endComposition, parseFromClipboard as __parseFromClipboard, serializeForClipboard as __serializeForClipboard };\n//# sourceMappingURL=index.es.js.map\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","export var base = {\n  8: \"Backspace\",\n  9: \"Tab\",\n  10: \"Enter\",\n  12: \"NumLock\",\n  13: \"Enter\",\n  16: \"Shift\",\n  17: \"Control\",\n  18: \"Alt\",\n  20: \"CapsLock\",\n  27: \"Escape\",\n  32: \" \",\n  33: \"PageUp\",\n  34: \"PageDown\",\n  35: \"End\",\n  36: \"Home\",\n  37: \"ArrowLeft\",\n  38: \"ArrowUp\",\n  39: \"ArrowRight\",\n  40: \"ArrowDown\",\n  44: \"PrintScreen\",\n  45: \"Insert\",\n  46: \"Delete\",\n  59: \";\",\n  61: \"=\",\n  91: \"Meta\",\n  92: \"Meta\",\n  106: \"*\",\n  107: \"+\",\n  108: \",\",\n  109: \"-\",\n  110: \".\",\n  111: \"/\",\n  144: \"NumLock\",\n  145: \"ScrollLock\",\n  160: \"Shift\",\n  161: \"Shift\",\n  162: \"Control\",\n  163: \"Control\",\n  164: \"Alt\",\n  165: \"Alt\",\n  173: \"-\",\n  186: \";\",\n  187: \"=\",\n  188: \",\",\n  189: \"-\",\n  190: \".\",\n  191: \"/\",\n  192: \"`\",\n  219: \"[\",\n  220: \"\\\\\",\n  221: \"]\",\n  222: \"'\",\n  229: \"q\"\n}\n\nexport var shift = {\n  48: \")\",\n  49: \"!\",\n  50: \"@\",\n  51: \"#\",\n  52: \"$\",\n  53: \"%\",\n  54: \"^\",\n  55: \"&\",\n  56: \"*\",\n  57: \"(\",\n  59: \":\",\n  61: \"+\",\n  173: \"_\",\n  186: \":\",\n  187: \"+\",\n  188: \"<\",\n  189: \"_\",\n  190: \">\",\n  191: \"?\",\n  192: \"~\",\n  219: \"{\",\n  220: \"|\",\n  221: \"}\",\n  222: \"\\\"\",\n  229: \"Q\"\n}\n\nvar chrome = typeof navigator != \"undefined\" && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\nvar safari = typeof navigator != \"undefined\" && /Apple Computer/.test(navigator.vendor)\nvar gecko = typeof navigator != \"undefined\" && /Gecko\\/\\d+/.test(navigator.userAgent)\nvar mac = typeof navigator != \"undefined\" && /Mac/.test(navigator.platform)\nvar ie = typeof navigator != \"undefined\" && /MSIE \\d|Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\nvar brokenModifierNames = chrome && (mac || +chrome[1] < 57) || gecko && mac\n\n// Fill in the digit keys\nfor (var i = 0; i < 10; i++) base[48 + i] = base[96 + i] = String(i)\n\n// The function keys\nfor (var i = 1; i <= 24; i++) base[i + 111] = \"F\" + i\n\n// And the alphabetic keys\nfor (var i = 65; i <= 90; i++) {\n  base[i] = String.fromCharCode(i + 32)\n  shift[i] = String.fromCharCode(i)\n}\n\n// For each code that doesn't have a shift-equivalent, copy the base name\nfor (var code in base) if (!shift.hasOwnProperty(code)) shift[code] = base[code]\n\nexport function keyName(event) {\n  // Don't trust event.key in Chrome when there are modifiers until\n  // they fix https://bugs.chromium.org/p/chromium/issues/detail?id=633838\n  var ignoreKey = brokenModifierNames && (event.ctrlKey || event.altKey || event.metaKey) ||\n    (safari || ie) && event.shiftKey && event.key && event.key.length == 1\n  var name = (!ignoreKey && event.key) ||\n    (event.shiftKey ? shift : base)[event.keyCode] ||\n    event.key || \"Unidentified\"\n  // Edge sometimes produces wrong names (Issue #3)\n  if (name == \"Esc\") name = \"Escape\"\n  if (name == \"Del\") name = \"Delete\"\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8860571/\n  if (name == \"Left\") name = \"ArrowLeft\"\n  if (name == \"Up\") name = \"ArrowUp\"\n  if (name == \"Right\") name = \"ArrowRight\"\n  if (name == \"Down\") name = \"ArrowDown\"\n  return name\n}\n","import { keyName, base } from 'w3c-keyname';\nimport { Plugin } from 'prosemirror-state';\n\n// declare global: navigator\n\nvar mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform) : false;\n\nfunction normalizeKeyName(name) {\n  var parts = name.split(/-(?!$)/), result = parts[parts.length - 1];\n  if (result == \"Space\") { result = \" \"; }\n  var alt, ctrl, shift, meta;\n  for (var i = 0; i < parts.length - 1; i++) {\n    var mod = parts[i];\n    if (/^(cmd|meta|m)$/i.test(mod)) { meta = true; }\n    else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n    else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n    else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n    else if (/^mod$/i.test(mod)) { if (mac) { meta = true; } else { ctrl = true; } }\n    else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n  }\n  if (alt) { result = \"Alt-\" + result; }\n  if (ctrl) { result = \"Ctrl-\" + result; }\n  if (meta) { result = \"Meta-\" + result; }\n  if (shift) { result = \"Shift-\" + result; }\n  return result\n}\n\nfunction normalize(map) {\n  var copy = Object.create(null);\n  for (var prop in map) { copy[normalizeKeyName(prop)] = map[prop]; }\n  return copy\n}\n\nfunction modifiers(name, event, shift) {\n  if (event.altKey) { name = \"Alt-\" + name; }\n  if (event.ctrlKey) { name = \"Ctrl-\" + name; }\n  if (event.metaKey) { name = \"Meta-\" + name; }\n  if (shift !== false && event.shiftKey) { name = \"Shift-\" + name; }\n  return name\n}\n\n// :: (Object)  Plugin\n// Create a keymap plugin for the given set of bindings.\n//\n// Bindings should map key names to [command](#commands)-style\n// functions, which will be called with `(EditorState, dispatch,\n// EditorView)` arguments, and should return true when they've handled\n// the key. Note that the view argument isn't part of the command\n// protocol, but can be used as an escape hatch if a binding needs to\n// directly interact with the UI.\n//\n// Key names may be strings like `\"Shift-Ctrl-Enter\"`a key\n// identifier prefixed with zero or more modifiers. Key identifiers\n// are based on the strings that can appear in\n// [`KeyEvent.key`](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key).\n// Use lowercase letters to refer to letter keys (or uppercase letters\n// if you want shift to be held). You may use `\"Space\"` as an alias\n// for the `\" \"` name.\n//\n// Modifiers can be given in any order. `Shift-` (or `s-`), `Alt-` (or\n// `a-`), `Ctrl-` (or `c-` or `Control-`) and `Cmd-` (or `m-` or\n// `Meta-`) are recognized. For characters that are created by holding\n// shift, the `Shift-` prefix is implied, and should not be added\n// explicitly.\n//\n// You can use `Mod-` as a shorthand for `Cmd-` on Mac and `Ctrl-` on\n// other platforms.\n//\n// You can add multiple keymap plugins to an editor. The order in\n// which they appear determines their precedence (the ones early in\n// the array get to dispatch first).\nfunction keymap(bindings) {\n  return new Plugin({props: {handleKeyDown: keydownHandler(bindings)}})\n}\n\n// :: (Object)  (view: EditorView, event: dom.Event)  bool\n// Given a set of bindings (using the same format as\n// [`keymap`](#keymap.keymap), return a [keydown\n// handler](#view.EditorProps.handleKeyDown) that handles them.\nfunction keydownHandler(bindings) {\n  var map = normalize(bindings);\n  return function(view, event) {\n    var name = keyName(event), isChar = name.length == 1 && name != \" \", baseName;\n    var direct = map[modifiers(name, event, !isChar)];\n    if (direct && direct(view.state, view.dispatch, view)) { return true }\n    if (isChar && (event.shiftKey || event.altKey || event.metaKey || name.charCodeAt(0) > 127) &&\n        (baseName = base[event.keyCode]) && baseName != name) {\n      // Try falling back to the keyCode when there's a modifier\n      // active or the character produced isn't ASCII, and our table\n      // produces a different name from the the keyCode. See #668,\n      // #1060\n      var fromCode = map[modifiers(baseName, event, true)];\n      if (fromCode && fromCode(view.state, view.dispatch, view)) { return true }\n    } else if (isChar && event.shiftKey) {\n      // Otherwise, if shift is active, also try the binding with the\n      // Shift- prefix enabled. See #997\n      var withShift = map[modifiers(name, event, true)];\n      if (withShift && withShift(view.state, view.dispatch, view)) { return true }\n    }\n    return false\n  }\n}\n\nexport { keydownHandler, keymap };\n//# sourceMappingURL=index.es.js.map\n","/*!\n * typeahead.js 1.3.1\n * https://github.com/corejavascript/typeahead.js\n * Copyright 2013-2020 Twitter, Inc. and other contributors; Licensed MIT\n */\n\n\n(function(root, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define([ \"jquery\" ], function(a0) {\n            return root[\"Bloodhound\"] = factory(a0);\n        });\n    } else if (typeof module === \"object\" && module.exports) {\n        module.exports = factory(require(\"jquery\"));\n    } else {\n        root[\"Bloodhound\"] = factory(root[\"jQuery\"]);\n    }\n})(this, function($) {\n    var _ = function() {\n        \"use strict\";\n        return {\n            isMsie: function() {\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },\n            isBlankString: function(str) {\n                return !str || /^\\s*$/.test(str);\n            },\n            escapeRegExChars: function(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            },\n            isString: function(obj) {\n                return typeof obj === \"string\";\n            },\n            isNumber: function(obj) {\n                return typeof obj === \"number\";\n            },\n            isArray: $.isArray,\n            isFunction: $.isFunction,\n            isObject: $.isPlainObject,\n            isUndefined: function(obj) {\n                return typeof obj === \"undefined\";\n            },\n            isElement: function(obj) {\n                return !!(obj && obj.nodeType === 1);\n            },\n            isJQuery: function(obj) {\n                return obj instanceof $;\n            },\n            toStr: function toStr(s) {\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\n            },\n            bind: $.proxy,\n            each: function(collection, cb) {\n                $.each(collection, reverseArgs);\n                function reverseArgs(index, value) {\n                    return cb(value, index);\n                }\n            },\n            map: $.map,\n            filter: $.grep,\n            every: function(obj, test) {\n                var result = true;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (!(result = test.call(null, val, key, obj))) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            some: function(obj, test) {\n                var result = false;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (result = test.call(null, val, key, obj)) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            mixin: $.extend,\n            identity: function(x) {\n                return x;\n            },\n            clone: function(obj) {\n                return $.extend(true, {}, obj);\n            },\n            getIdGenerator: function() {\n                var counter = 0;\n                return function() {\n                    return counter++;\n                };\n            },\n            templatify: function templatify(obj) {\n                return $.isFunction(obj) ? obj : template;\n                function template() {\n                    return String(obj);\n                }\n            },\n            defer: function(fn) {\n                setTimeout(fn, 0);\n            },\n            debounce: function(func, wait, immediate) {\n                var timeout, result;\n                return function() {\n                    var context = this, args = arguments, later, callNow;\n                    later = function() {\n                        timeout = null;\n                        if (!immediate) {\n                            result = func.apply(context, args);\n                        }\n                    };\n                    callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) {\n                        result = func.apply(context, args);\n                    }\n                    return result;\n                };\n            },\n            throttle: function(func, wait) {\n                var context, args, timeout, result, previous, later;\n                previous = 0;\n                later = function() {\n                    previous = new Date();\n                    timeout = null;\n                    result = func.apply(context, args);\n                };\n                return function() {\n                    var now = new Date(), remaining = wait - (now - previous);\n                    context = this;\n                    args = arguments;\n                    if (remaining <= 0) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                        previous = now;\n                        result = func.apply(context, args);\n                    } else if (!timeout) {\n                        timeout = setTimeout(later, remaining);\n                    }\n                    return result;\n                };\n            },\n            stringify: function(val) {\n                return _.isString(val) ? val : JSON.stringify(val);\n            },\n            guid: function() {\n                function _p8(s) {\n                    var p = (Math.random().toString(16) + \"000000000\").substr(2, 8);\n                    return s ? \"-\" + p.substr(0, 4) + \"-\" + p.substr(4, 4) : p;\n                }\n                return \"tt-\" + _p8() + _p8(true) + _p8(true) + _p8();\n            },\n            noop: function() {}\n        };\n    }();\n    var VERSION = \"1.3.1\";\n    var tokenizers = function() {\n        \"use strict\";\n        return {\n            nonword: nonword,\n            whitespace: whitespace,\n            ngram: ngram,\n            obj: {\n                nonword: getObjTokenizer(nonword),\n                whitespace: getObjTokenizer(whitespace),\n                ngram: getObjTokenizer(ngram)\n            }\n        };\n        function whitespace(str) {\n            str = _.toStr(str);\n            return str ? str.split(/\\s+/) : [];\n        }\n        function nonword(str) {\n            str = _.toStr(str);\n            return str ? str.split(/\\W+/) : [];\n        }\n        function ngram(str) {\n            str = _.toStr(str);\n            var tokens = [], word = \"\";\n            _.each(str.split(\"\"), function(char) {\n                if (char.match(/\\s+/)) {\n                    word = \"\";\n                } else {\n                    tokens.push(word + char);\n                    word += char;\n                }\n            });\n            return tokens;\n        }\n        function getObjTokenizer(tokenizer) {\n            return function setKey(keys) {\n                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);\n                return function tokenize(o) {\n                    var tokens = [];\n                    _.each(keys, function(k) {\n                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));\n                    });\n                    return tokens;\n                };\n            };\n        }\n    }();\n    var LruCache = function() {\n        \"use strict\";\n        function LruCache(maxSize) {\n            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;\n            this.reset();\n            if (this.maxSize <= 0) {\n                this.set = this.get = $.noop;\n            }\n        }\n        _.mixin(LruCache.prototype, {\n            set: function set(key, val) {\n                var tailItem = this.list.tail, node;\n                if (this.size >= this.maxSize) {\n                    this.list.remove(tailItem);\n                    delete this.hash[tailItem.key];\n                    this.size--;\n                }\n                if (node = this.hash[key]) {\n                    node.val = val;\n                    this.list.moveToFront(node);\n                } else {\n                    node = new Node(key, val);\n                    this.list.add(node);\n                    this.hash[key] = node;\n                    this.size++;\n                }\n            },\n            get: function get(key) {\n                var node = this.hash[key];\n                if (node) {\n                    this.list.moveToFront(node);\n                    return node.val;\n                }\n            },\n            reset: function reset() {\n                this.size = 0;\n                this.hash = {};\n                this.list = new List();\n            }\n        });\n        function List() {\n            this.head = this.tail = null;\n        }\n        _.mixin(List.prototype, {\n            add: function add(node) {\n                if (this.head) {\n                    node.next = this.head;\n                    this.head.prev = node;\n                }\n                this.head = node;\n                this.tail = this.tail || node;\n            },\n            remove: function remove(node) {\n                node.prev ? node.prev.next = node.next : this.head = node.next;\n                node.next ? node.next.prev = node.prev : this.tail = node.prev;\n            },\n            moveToFront: function(node) {\n                this.remove(node);\n                this.add(node);\n            }\n        });\n        function Node(key, val) {\n            this.key = key;\n            this.val = val;\n            this.prev = this.next = null;\n        }\n        return LruCache;\n    }();\n    var PersistentStorage = function() {\n        \"use strict\";\n        var LOCAL_STORAGE;\n        try {\n            LOCAL_STORAGE = window.localStorage;\n            LOCAL_STORAGE.setItem(\"~~~\", \"!\");\n            LOCAL_STORAGE.removeItem(\"~~~\");\n        } catch (err) {\n            LOCAL_STORAGE = null;\n        }\n        function PersistentStorage(namespace, override) {\n            this.prefix = [ \"__\", namespace, \"__\" ].join(\"\");\n            this.ttlKey = \"__ttl__\";\n            this.keyMatcher = new RegExp(\"^\" + _.escapeRegExChars(this.prefix));\n            this.ls = override || LOCAL_STORAGE;\n            !this.ls && this._noop();\n        }\n        _.mixin(PersistentStorage.prototype, {\n            _prefix: function(key) {\n                return this.prefix + key;\n            },\n            _ttlKey: function(key) {\n                return this._prefix(key) + this.ttlKey;\n            },\n            _noop: function() {\n                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;\n            },\n            _safeSet: function(key, val) {\n                try {\n                    this.ls.setItem(key, val);\n                } catch (err) {\n                    if (err.name === \"QuotaExceededError\") {\n                        this.clear();\n                        this._noop();\n                    }\n                }\n            },\n            get: function(key) {\n                if (this.isExpired(key)) {\n                    this.remove(key);\n                }\n                return decode(this.ls.getItem(this._prefix(key)));\n            },\n            set: function(key, val, ttl) {\n                if (_.isNumber(ttl)) {\n                    this._safeSet(this._ttlKey(key), encode(now() + ttl));\n                } else {\n                    this.ls.removeItem(this._ttlKey(key));\n                }\n                return this._safeSet(this._prefix(key), encode(val));\n            },\n            remove: function(key) {\n                this.ls.removeItem(this._ttlKey(key));\n                this.ls.removeItem(this._prefix(key));\n                return this;\n            },\n            clear: function() {\n                var i, keys = gatherMatchingKeys(this.keyMatcher);\n                for (i = keys.length; i--; ) {\n                    this.remove(keys[i]);\n                }\n                return this;\n            },\n            isExpired: function(key) {\n                var ttl = decode(this.ls.getItem(this._ttlKey(key)));\n                return _.isNumber(ttl) && now() > ttl ? true : false;\n            }\n        });\n        return PersistentStorage;\n        function now() {\n            return new Date().getTime();\n        }\n        function encode(val) {\n            return JSON.stringify(_.isUndefined(val) ? null : val);\n        }\n        function decode(val) {\n            return $.parseJSON(val);\n        }\n        function gatherMatchingKeys(keyMatcher) {\n            var i, key, keys = [], len = LOCAL_STORAGE.length;\n            for (i = 0; i < len; i++) {\n                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {\n                    keys.push(key.replace(keyMatcher, \"\"));\n                }\n            }\n            return keys;\n        }\n    }();\n    var Transport = function() {\n        \"use strict\";\n        var pendingRequestsCount = 0, pendingRequests = {}, sharedCache = new LruCache(10);\n        function Transport(o) {\n            o = o || {};\n            this.maxPendingRequests = o.maxPendingRequests || 6;\n            this.cancelled = false;\n            this.lastReq = null;\n            this._send = o.transport;\n            this._get = o.limiter ? o.limiter(this._get) : this._get;\n            this._cache = o.cache === false ? new LruCache(0) : sharedCache;\n        }\n        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {\n            this.maxPendingRequests = num;\n        };\n        Transport.resetCache = function resetCache() {\n            sharedCache.reset();\n        };\n        _.mixin(Transport.prototype, {\n            _fingerprint: function fingerprint(o) {\n                o = o || {};\n                return o.url + o.type + $.param(o.data || {});\n            },\n            _get: function(o, cb) {\n                var that = this, fingerprint, jqXhr;\n                fingerprint = this._fingerprint(o);\n                if (this.cancelled || fingerprint !== this.lastReq) {\n                    return;\n                }\n                if (jqXhr = pendingRequests[fingerprint]) {\n                    jqXhr.done(done).fail(fail);\n                } else if (pendingRequestsCount < this.maxPendingRequests) {\n                    pendingRequestsCount++;\n                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);\n                } else {\n                    this.onDeckRequestArgs = [].slice.call(arguments, 0);\n                }\n                function done(resp) {\n                    cb(null, resp);\n                    that._cache.set(fingerprint, resp);\n                }\n                function fail() {\n                    cb(true);\n                }\n                function always() {\n                    pendingRequestsCount--;\n                    delete pendingRequests[fingerprint];\n                    if (that.onDeckRequestArgs) {\n                        that._get.apply(that, that.onDeckRequestArgs);\n                        that.onDeckRequestArgs = null;\n                    }\n                }\n            },\n            get: function(o, cb) {\n                var resp, fingerprint;\n                cb = cb || $.noop;\n                o = _.isString(o) ? {\n                    url: o\n                } : o || {};\n                fingerprint = this._fingerprint(o);\n                this.cancelled = false;\n                this.lastReq = fingerprint;\n                if (resp = this._cache.get(fingerprint)) {\n                    cb(null, resp);\n                } else {\n                    this._get(o, cb);\n                }\n            },\n            cancel: function() {\n                this.cancelled = true;\n            }\n        });\n        return Transport;\n    }();\n    var SearchIndex = window.SearchIndex = function() {\n        \"use strict\";\n        var CHILDREN = \"c\", IDS = \"i\";\n        function SearchIndex(o) {\n            o = o || {};\n            if (!o.datumTokenizer || !o.queryTokenizer) {\n                $.error(\"datumTokenizer and queryTokenizer are both required\");\n            }\n            this.identify = o.identify || _.stringify;\n            this.datumTokenizer = o.datumTokenizer;\n            this.queryTokenizer = o.queryTokenizer;\n            this.matchAnyQueryToken = o.matchAnyQueryToken;\n            this.reset();\n        }\n        _.mixin(SearchIndex.prototype, {\n            bootstrap: function bootstrap(o) {\n                this.datums = o.datums;\n                this.trie = o.trie;\n            },\n            add: function(data) {\n                var that = this;\n                data = _.isArray(data) ? data : [ data ];\n                _.each(data, function(datum) {\n                    var id, tokens;\n                    that.datums[id = that.identify(datum)] = datum;\n                    tokens = normalizeTokens(that.datumTokenizer(datum));\n                    _.each(tokens, function(token) {\n                        var node, chars, ch;\n                        node = that.trie;\n                        chars = token.split(\"\");\n                        while (ch = chars.shift()) {\n                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());\n                            node[IDS].push(id);\n                        }\n                    });\n                });\n            },\n            get: function get(ids) {\n                var that = this;\n                return _.map(ids, function(id) {\n                    return that.datums[id];\n                });\n            },\n            search: function search(query) {\n                var that = this, tokens, matches;\n                tokens = normalizeTokens(this.queryTokenizer(query));\n                _.each(tokens, function(token) {\n                    var node, chars, ch, ids;\n                    if (matches && matches.length === 0 && !that.matchAnyQueryToken) {\n                        return false;\n                    }\n                    node = that.trie;\n                    chars = token.split(\"\");\n                    while (node && (ch = chars.shift())) {\n                        node = node[CHILDREN][ch];\n                    }\n                    if (node && chars.length === 0) {\n                        ids = node[IDS].slice(0);\n                        matches = matches ? getIntersection(matches, ids) : ids;\n                    } else {\n                        if (!that.matchAnyQueryToken) {\n                            matches = [];\n                            return false;\n                        }\n                    }\n                });\n                return matches ? _.map(unique(matches), function(id) {\n                    return that.datums[id];\n                }) : [];\n            },\n            all: function all() {\n                var values = [];\n                for (var key in this.datums) {\n                    values.push(this.datums[key]);\n                }\n                return values;\n            },\n            reset: function reset() {\n                this.datums = {};\n                this.trie = newNode();\n            },\n            serialize: function serialize() {\n                return {\n                    datums: this.datums,\n                    trie: this.trie\n                };\n            }\n        });\n        return SearchIndex;\n        function normalizeTokens(tokens) {\n            tokens = _.filter(tokens, function(token) {\n                return !!token;\n            });\n            tokens = _.map(tokens, function(token) {\n                return token.toLowerCase();\n            });\n            return tokens;\n        }\n        function newNode() {\n            var node = {};\n            node[IDS] = [];\n            node[CHILDREN] = {};\n            return node;\n        }\n        function unique(array) {\n            var seen = {}, uniques = [];\n            for (var i = 0, len = array.length; i < len; i++) {\n                if (!seen[array[i]]) {\n                    seen[array[i]] = true;\n                    uniques.push(array[i]);\n                }\n            }\n            return uniques;\n        }\n        function getIntersection(arrayA, arrayB) {\n            var ai = 0, bi = 0, intersection = [];\n            arrayA = arrayA.sort();\n            arrayB = arrayB.sort();\n            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;\n            while (ai < lenArrayA && bi < lenArrayB) {\n                if (arrayA[ai] < arrayB[bi]) {\n                    ai++;\n                } else if (arrayA[ai] > arrayB[bi]) {\n                    bi++;\n                } else {\n                    intersection.push(arrayA[ai]);\n                    ai++;\n                    bi++;\n                }\n            }\n            return intersection;\n        }\n    }();\n    var Prefetch = function() {\n        \"use strict\";\n        var keys;\n        keys = {\n            data: \"data\",\n            protocol: \"protocol\",\n            thumbprint: \"thumbprint\"\n        };\n        function Prefetch(o) {\n            this.url = o.url;\n            this.ttl = o.ttl;\n            this.cache = o.cache;\n            this.prepare = o.prepare;\n            this.transform = o.transform;\n            this.transport = o.transport;\n            this.thumbprint = o.thumbprint;\n            this.storage = new PersistentStorage(o.cacheKey);\n        }\n        _.mixin(Prefetch.prototype, {\n            _settings: function settings() {\n                return {\n                    url: this.url,\n                    type: \"GET\",\n                    dataType: \"json\"\n                };\n            },\n            store: function store(data) {\n                if (!this.cache) {\n                    return;\n                }\n                this.storage.set(keys.data, data, this.ttl);\n                this.storage.set(keys.protocol, location.protocol, this.ttl);\n                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);\n            },\n            fromCache: function fromCache() {\n                var stored = {}, isExpired;\n                if (!this.cache) {\n                    return null;\n                }\n                stored.data = this.storage.get(keys.data);\n                stored.protocol = this.storage.get(keys.protocol);\n                stored.thumbprint = this.storage.get(keys.thumbprint);\n                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;\n                return stored.data && !isExpired ? stored.data : null;\n            },\n            fromNetwork: function(cb) {\n                var that = this, settings;\n                if (!cb) {\n                    return;\n                }\n                settings = this.prepare(this._settings());\n                this.transport(settings).fail(onError).done(onResponse);\n                function onError() {\n                    cb(true);\n                }\n                function onResponse(resp) {\n                    cb(null, that.transform(resp));\n                }\n            },\n            clear: function clear() {\n                this.storage.clear();\n                return this;\n            }\n        });\n        return Prefetch;\n    }();\n    var Remote = function() {\n        \"use strict\";\n        function Remote(o) {\n            this.url = o.url;\n            this.prepare = o.prepare;\n            this.transform = o.transform;\n            this.indexResponse = o.indexResponse;\n            this.transport = new Transport({\n                cache: o.cache,\n                limiter: o.limiter,\n                transport: o.transport,\n                maxPendingRequests: o.maxPendingRequests\n            });\n        }\n        _.mixin(Remote.prototype, {\n            _settings: function settings() {\n                return {\n                    url: this.url,\n                    type: \"GET\",\n                    dataType: \"json\"\n                };\n            },\n            get: function get(query, cb) {\n                var that = this, settings;\n                if (!cb) {\n                    return;\n                }\n                query = query || \"\";\n                settings = this.prepare(query, this._settings());\n                return this.transport.get(settings, onResponse);\n                function onResponse(err, resp) {\n                    err ? cb([]) : cb(that.transform(resp));\n                }\n            },\n            cancelLastRequest: function cancelLastRequest() {\n                this.transport.cancel();\n            }\n        });\n        return Remote;\n    }();\n    var oParser = function() {\n        \"use strict\";\n        return function parse(o) {\n            var defaults, sorter;\n            defaults = {\n                initialize: true,\n                identify: _.stringify,\n                datumTokenizer: null,\n                queryTokenizer: null,\n                matchAnyQueryToken: false,\n                sufficient: 5,\n                indexRemote: false,\n                sorter: null,\n                local: [],\n                prefetch: null,\n                remote: null\n            };\n            o = _.mixin(defaults, o || {});\n            !o.datumTokenizer && $.error(\"datumTokenizer is required\");\n            !o.queryTokenizer && $.error(\"queryTokenizer is required\");\n            sorter = o.sorter;\n            o.sorter = sorter ? function(x) {\n                return x.sort(sorter);\n            } : _.identity;\n            o.local = _.isFunction(o.local) ? o.local() : o.local;\n            o.prefetch = parsePrefetch(o.prefetch);\n            o.remote = parseRemote(o.remote);\n            return o;\n        };\n        function parsePrefetch(o) {\n            var defaults;\n            if (!o) {\n                return null;\n            }\n            defaults = {\n                url: null,\n                ttl: 24 * 60 * 60 * 1e3,\n                cache: true,\n                cacheKey: null,\n                thumbprint: \"\",\n                prepare: _.identity,\n                transform: _.identity,\n                transport: null\n            };\n            o = _.isString(o) ? {\n                url: o\n            } : o;\n            o = _.mixin(defaults, o);\n            !o.url && $.error(\"prefetch requires url to be set\");\n            o.transform = o.filter || o.transform;\n            o.cacheKey = o.cacheKey || o.url;\n            o.thumbprint = VERSION + o.thumbprint;\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\n            return o;\n        }\n        function parseRemote(o) {\n            var defaults;\n            if (!o) {\n                return;\n            }\n            defaults = {\n                url: null,\n                cache: true,\n                prepare: null,\n                replace: null,\n                wildcard: null,\n                limiter: null,\n                rateLimitBy: \"debounce\",\n                rateLimitWait: 300,\n                transform: _.identity,\n                transport: null\n            };\n            o = _.isString(o) ? {\n                url: o\n            } : o;\n            o = _.mixin(defaults, o);\n            !o.url && $.error(\"remote requires url to be set\");\n            o.transform = o.filter || o.transform;\n            o.prepare = toRemotePrepare(o);\n            o.limiter = toLimiter(o);\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\n            delete o.replace;\n            delete o.wildcard;\n            delete o.rateLimitBy;\n            delete o.rateLimitWait;\n            return o;\n        }\n        function toRemotePrepare(o) {\n            var prepare, replace, wildcard;\n            prepare = o.prepare;\n            replace = o.replace;\n            wildcard = o.wildcard;\n            if (prepare) {\n                return prepare;\n            }\n            if (replace) {\n                prepare = prepareByReplace;\n            } else if (o.wildcard) {\n                prepare = prepareByWildcard;\n            } else {\n                prepare = identityPrepare;\n            }\n            return prepare;\n            function prepareByReplace(query, settings) {\n                settings.url = replace(settings.url, query);\n                return settings;\n            }\n            function prepareByWildcard(query, settings) {\n                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));\n                return settings;\n            }\n            function identityPrepare(query, settings) {\n                return settings;\n            }\n        }\n        function toLimiter(o) {\n            var limiter, method, wait;\n            limiter = o.limiter;\n            method = o.rateLimitBy;\n            wait = o.rateLimitWait;\n            if (!limiter) {\n                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);\n            }\n            return limiter;\n            function debounce(wait) {\n                return function debounce(fn) {\n                    return _.debounce(fn, wait);\n                };\n            }\n            function throttle(wait) {\n                return function throttle(fn) {\n                    return _.throttle(fn, wait);\n                };\n            }\n        }\n        function callbackToDeferred(fn) {\n            return function wrapper(o) {\n                var deferred = $.Deferred();\n                fn(o, onSuccess, onError);\n                return deferred;\n                function onSuccess(resp) {\n                    _.defer(function() {\n                        deferred.resolve(resp);\n                    });\n                }\n                function onError(err) {\n                    _.defer(function() {\n                        deferred.reject(err);\n                    });\n                }\n            };\n        }\n    }();\n    var Bloodhound = function() {\n        \"use strict\";\n        var old;\n        old = window && window.Bloodhound;\n        function Bloodhound(o) {\n            o = oParser(o);\n            this.sorter = o.sorter;\n            this.identify = o.identify;\n            this.sufficient = o.sufficient;\n            this.indexRemote = o.indexRemote;\n            this.local = o.local;\n            this.remote = o.remote ? new Remote(o.remote) : null;\n            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;\n            this.index = new SearchIndex({\n                identify: this.identify,\n                datumTokenizer: o.datumTokenizer,\n                queryTokenizer: o.queryTokenizer\n            });\n            o.initialize !== false && this.initialize();\n        }\n        Bloodhound.noConflict = function noConflict() {\n            window && (window.Bloodhound = old);\n            return Bloodhound;\n        };\n        Bloodhound.tokenizers = tokenizers;\n        _.mixin(Bloodhound.prototype, {\n            __ttAdapter: function ttAdapter() {\n                var that = this;\n                return this.remote ? withAsync : withoutAsync;\n                function withAsync(query, sync, async) {\n                    return that.search(query, sync, async);\n                }\n                function withoutAsync(query, sync) {\n                    return that.search(query, sync);\n                }\n            },\n            _loadPrefetch: function loadPrefetch() {\n                var that = this, deferred, serialized;\n                deferred = $.Deferred();\n                if (!this.prefetch) {\n                    deferred.resolve();\n                } else if (serialized = this.prefetch.fromCache()) {\n                    this.index.bootstrap(serialized);\n                    deferred.resolve();\n                } else {\n                    this.prefetch.fromNetwork(done);\n                }\n                return deferred.promise();\n                function done(err, data) {\n                    if (err) {\n                        return deferred.reject();\n                    }\n                    that.add(data);\n                    that.prefetch.store(that.index.serialize());\n                    deferred.resolve();\n                }\n            },\n            _initialize: function initialize() {\n                var that = this, deferred;\n                this.clear();\n                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);\n                return this.initPromise;\n                function addLocalToIndex() {\n                    that.add(that.local);\n                }\n            },\n            initialize: function initialize(force) {\n                return !this.initPromise || force ? this._initialize() : this.initPromise;\n            },\n            add: function add(data) {\n                this.index.add(data);\n                return this;\n            },\n            get: function get(ids) {\n                ids = _.isArray(ids) ? ids : [].slice.call(arguments);\n                return this.index.get(ids);\n            },\n            search: function search(query, sync, async) {\n                var that = this, local;\n                sync = sync || _.noop;\n                async = async || _.noop;\n                local = this.sorter(this.index.search(query));\n                sync(this.remote ? local.slice() : local);\n                if (this.remote && local.length < this.sufficient) {\n                    this.remote.get(query, processRemote);\n                } else if (this.remote) {\n                    this.remote.cancelLastRequest();\n                }\n                return this;\n                function processRemote(remote) {\n                    var nonDuplicates = [];\n                    _.each(remote, function(r) {\n                        !_.some(local, function(l) {\n                            return that.identify(r) === that.identify(l);\n                        }) && nonDuplicates.push(r);\n                    });\n                    that.indexRemote && that.add(nonDuplicates);\n                    async(nonDuplicates);\n                }\n            },\n            all: function all() {\n                return this.index.all();\n            },\n            clear: function clear() {\n                this.index.reset();\n                return this;\n            },\n            clearPrefetchCache: function clearPrefetchCache() {\n                this.prefetch && this.prefetch.clear();\n                return this;\n            },\n            clearRemoteCache: function clearRemoteCache() {\n                Transport.resetCache();\n                return this;\n            },\n            ttAdapter: function ttAdapter() {\n                return this.__ttAdapter();\n            }\n        });\n        return Bloodhound;\n    }();\n    return Bloodhound;\n});\n\n(function(root, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define([ \"jquery\" ], function(a0) {\n            return factory(a0);\n        });\n    } else if (typeof module === \"object\" && module.exports) {\n        module.exports = factory(require(\"jquery\"));\n    } else {\n        factory(root[\"jQuery\"]);\n    }\n})(this, function($) {\n    var _ = function() {\n        \"use strict\";\n        return {\n            isMsie: function() {\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },\n            isBlankString: function(str) {\n                return !str || /^\\s*$/.test(str);\n            },\n            escapeRegExChars: function(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            },\n            isString: function(obj) {\n                return typeof obj === \"string\";\n            },\n            isNumber: function(obj) {\n                return typeof obj === \"number\";\n            },\n            isArray: $.isArray,\n            isFunction: $.isFunction,\n            isObject: $.isPlainObject,\n            isUndefined: function(obj) {\n                return typeof obj === \"undefined\";\n            },\n            isElement: function(obj) {\n                return !!(obj && obj.nodeType === 1);\n            },\n            isJQuery: function(obj) {\n                return obj instanceof $;\n            },\n            toStr: function toStr(s) {\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\n            },\n            bind: $.proxy,\n            each: function(collection, cb) {\n                $.each(collection, reverseArgs);\n                function reverseArgs(index, value) {\n                    return cb(value, index);\n                }\n            },\n            map: $.map,\n            filter: $.grep,\n            every: function(obj, test) {\n                var result = true;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (!(result = test.call(null, val, key, obj))) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            some: function(obj, test) {\n                var result = false;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (result = test.call(null, val, key, obj)) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            mixin: $.extend,\n            identity: function(x) {\n                return x;\n            },\n            clone: function(obj) {\n                return $.extend(true, {}, obj);\n            },\n            getIdGenerator: function() {\n                var counter = 0;\n                return function() {\n                    return counter++;\n                };\n            },\n            templatify: function templatify(obj) {\n                return $.isFunction(obj) ? obj : template;\n                function template() {\n                    return String(obj);\n                }\n            },\n            defer: function(fn) {\n                setTimeout(fn, 0);\n            },\n            debounce: function(func, wait, immediate) {\n                var timeout, result;\n                return function() {\n                    var context = this, args = arguments, later, callNow;\n                    later = function() {\n                        timeout = null;\n                        if (!immediate) {\n                            result = func.apply(context, args);\n                        }\n                    };\n                    callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) {\n                        result = func.apply(context, args);\n                    }\n                    return result;\n                };\n            },\n            throttle: function(func, wait) {\n                var context, args, timeout, result, previous, later;\n                previous = 0;\n                later = function() {\n                    previous = new Date();\n                    timeout = null;\n                    result = func.apply(context, args);\n                };\n                return function() {\n                    var now = new Date(), remaining = wait - (now - previous);\n                    context = this;\n                    args = arguments;\n                    if (remaining <= 0) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                        previous = now;\n                        result = func.apply(context, args);\n                    } else if (!timeout) {\n                        timeout = setTimeout(later, remaining);\n                    }\n                    return result;\n                };\n            },\n            stringify: function(val) {\n                return _.isString(val) ? val : JSON.stringify(val);\n            },\n            guid: function() {\n                function _p8(s) {\n                    var p = (Math.random().toString(16) + \"000000000\").substr(2, 8);\n                    return s ? \"-\" + p.substr(0, 4) + \"-\" + p.substr(4, 4) : p;\n                }\n                return \"tt-\" + _p8() + _p8(true) + _p8(true) + _p8();\n            },\n            noop: function() {}\n        };\n    }();\n    var WWW = function() {\n        \"use strict\";\n        var defaultClassNames = {\n            wrapper: \"twitter-typeahead\",\n            input: \"tt-input\",\n            hint: \"tt-hint\",\n            menu: \"tt-menu\",\n            dataset: \"tt-dataset\",\n            suggestion: \"tt-suggestion\",\n            selectable: \"tt-selectable\",\n            empty: \"tt-empty\",\n            open: \"tt-open\",\n            cursor: \"tt-cursor\",\n            highlight: \"tt-highlight\"\n        };\n        return build;\n        function build(o) {\n            var www, classes;\n            classes = _.mixin({}, defaultClassNames, o);\n            www = {\n                css: buildCss(),\n                classes: classes,\n                html: buildHtml(classes),\n                selectors: buildSelectors(classes)\n            };\n            return {\n                css: www.css,\n                html: www.html,\n                classes: www.classes,\n                selectors: www.selectors,\n                mixin: function(o) {\n                    _.mixin(o, www);\n                }\n            };\n        }\n        function buildHtml(c) {\n            return {\n                wrapper: '<span class=\"' + c.wrapper + '\"></span>',\n                menu: '<div role=\"listbox\" class=\"' + c.menu + '\"></div>'\n            };\n        }\n        function buildSelectors(classes) {\n            var selectors = {};\n            _.each(classes, function(v, k) {\n                selectors[k] = \".\" + v;\n            });\n            return selectors;\n        }\n        function buildCss() {\n            var css = {\n                wrapper: {\n                    position: \"relative\",\n                    display: \"inline-block\"\n                },\n                hint: {\n                    position: \"absolute\",\n                    top: \"0\",\n                    left: \"0\",\n                    borderColor: \"transparent\",\n                    boxShadow: \"none\",\n                    opacity: \"1\"\n                },\n                input: {\n                    position: \"relative\",\n                    verticalAlign: \"top\",\n                    backgroundColor: \"transparent\"\n                },\n                inputWithNoHint: {\n                    position: \"relative\",\n                    verticalAlign: \"top\"\n                },\n                menu: {\n                    position: \"absolute\",\n                    top: \"100%\",\n                    left: \"0\",\n                    zIndex: \"100\",\n                    display: \"none\"\n                },\n                ltr: {\n                    left: \"0\",\n                    right: \"auto\"\n                },\n                rtl: {\n                    left: \"auto\",\n                    right: \" 0\"\n                }\n            };\n            if (_.isMsie()) {\n                _.mixin(css.input, {\n                    backgroundImage: \"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)\"\n                });\n            }\n            return css;\n        }\n    }();\n    var EventBus = function() {\n        \"use strict\";\n        var namespace, deprecationMap;\n        namespace = \"typeahead:\";\n        deprecationMap = {\n            render: \"rendered\",\n            cursorchange: \"cursorchanged\",\n            select: \"selected\",\n            autocomplete: \"autocompleted\"\n        };\n        function EventBus(o) {\n            if (!o || !o.el) {\n                $.error(\"EventBus initialized without el\");\n            }\n            this.$el = $(o.el);\n        }\n        _.mixin(EventBus.prototype, {\n            _trigger: function(type, args) {\n                var $e = $.Event(namespace + type);\n                this.$el.trigger.call(this.$el, $e, args || []);\n                return $e;\n            },\n            before: function(type) {\n                var args, $e;\n                args = [].slice.call(arguments, 1);\n                $e = this._trigger(\"before\" + type, args);\n                return $e.isDefaultPrevented();\n            },\n            trigger: function(type) {\n                var deprecatedType;\n                this._trigger(type, [].slice.call(arguments, 1));\n                if (deprecatedType = deprecationMap[type]) {\n                    this._trigger(deprecatedType, [].slice.call(arguments, 1));\n                }\n            }\n        });\n        return EventBus;\n    }();\n    var EventEmitter = function() {\n        \"use strict\";\n        var splitter = /\\s+/, nextTick = getNextTick();\n        return {\n            onSync: onSync,\n            onAsync: onAsync,\n            off: off,\n            trigger: trigger\n        };\n        function on(method, types, cb, context) {\n            var type;\n            if (!cb) {\n                return this;\n            }\n            types = types.split(splitter);\n            cb = context ? bindContext(cb, context) : cb;\n            this._callbacks = this._callbacks || {};\n            while (type = types.shift()) {\n                this._callbacks[type] = this._callbacks[type] || {\n                    sync: [],\n                    async: []\n                };\n                this._callbacks[type][method].push(cb);\n            }\n            return this;\n        }\n        function onAsync(types, cb, context) {\n            return on.call(this, \"async\", types, cb, context);\n        }\n        function onSync(types, cb, context) {\n            return on.call(this, \"sync\", types, cb, context);\n        }\n        function off(types) {\n            var type;\n            if (!this._callbacks) {\n                return this;\n            }\n            types = types.split(splitter);\n            while (type = types.shift()) {\n                delete this._callbacks[type];\n            }\n            return this;\n        }\n        function trigger(types) {\n            var type, callbacks, args, syncFlush, asyncFlush;\n            if (!this._callbacks) {\n                return this;\n            }\n            types = types.split(splitter);\n            args = [].slice.call(arguments, 1);\n            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {\n                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));\n                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));\n                syncFlush() && nextTick(asyncFlush);\n            }\n            return this;\n        }\n        function getFlush(callbacks, context, args) {\n            return flush;\n            function flush() {\n                var cancelled;\n                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {\n                    cancelled = callbacks[i].apply(context, args) === false;\n                }\n                return !cancelled;\n            }\n        }\n        function getNextTick() {\n            var nextTickFn;\n            if (window.setImmediate) {\n                nextTickFn = function nextTickSetImmediate(fn) {\n                    setImmediate(function() {\n                        fn();\n                    });\n                };\n            } else {\n                nextTickFn = function nextTickSetTimeout(fn) {\n                    setTimeout(function() {\n                        fn();\n                    }, 0);\n                };\n            }\n            return nextTickFn;\n        }\n        function bindContext(fn, context) {\n            return fn.bind ? fn.bind(context) : function() {\n                fn.apply(context, [].slice.call(arguments, 0));\n            };\n        }\n    }();\n    var highlight = function(doc) {\n        \"use strict\";\n        var defaults = {\n            node: null,\n            pattern: null,\n            tagName: \"strong\",\n            className: null,\n            wordsOnly: false,\n            caseSensitive: false,\n            diacriticInsensitive: false\n        };\n        var accented = {\n            A: \"[Aa--------]\",\n            B: \"[Bb--]\",\n            C: \"[Cc--]\",\n            D: \"[Dd-----]\",\n            E: \"[Ee------]\",\n            F: \"[Ff--]\",\n            G: \"[Gg--]\",\n            H: \"[Hh---]\",\n            I: \"[Ii---------]\",\n            J: \"[Jj--]\",\n            K: \"[Kk--]\",\n            L: \"[Ll----]\",\n            M: \"[Mm----]\",\n            N: \"[Nn---]\",\n            O: \"[Oo-----]\",\n            P: \"[Pp---]\",\n            Q: \"[Qq]\",\n            R: \"[Rr-----]\",\n            S: \"[Ss---]\",\n            T: \"[Tt--]\",\n            U: \"[Uu------]\",\n            V: \"[Vv----]\",\n            W: \"[Ww--]\",\n            X: \"[Xx---]\",\n            Y: \"[Yy--]\",\n            Z: \"[Zz----]\"\n        };\n        return function hightlight(o) {\n            var regex;\n            o = _.mixin({}, defaults, o);\n            if (!o.node || !o.pattern) {\n                return;\n            }\n            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];\n            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly, o.diacriticInsensitive);\n            traverse(o.node, hightlightTextNode);\n            function hightlightTextNode(textNode) {\n                var match, patternNode, wrapperNode;\n                if (match = regex.exec(textNode.data)) {\n                    wrapperNode = doc.createElement(o.tagName);\n                    o.className && (wrapperNode.className = o.className);\n                    patternNode = textNode.splitText(match.index);\n                    patternNode.splitText(match[0].length);\n                    wrapperNode.appendChild(patternNode.cloneNode(true));\n                    textNode.parentNode.replaceChild(wrapperNode, patternNode);\n                }\n                return !!match;\n            }\n            function traverse(el, hightlightTextNode) {\n                var childNode, TEXT_NODE_TYPE = 3;\n                for (var i = 0; i < el.childNodes.length; i++) {\n                    childNode = el.childNodes[i];\n                    if (childNode.nodeType === TEXT_NODE_TYPE) {\n                        i += hightlightTextNode(childNode) ? 1 : 0;\n                    } else {\n                        traverse(childNode, hightlightTextNode);\n                    }\n                }\n            }\n        };\n        function accent_replacer(chr) {\n            return accented[chr.toUpperCase()] || chr;\n        }\n        function getRegex(patterns, caseSensitive, wordsOnly, diacriticInsensitive) {\n            var escapedPatterns = [], regexStr;\n            for (var i = 0, len = patterns.length; i < len; i++) {\n                var escapedWord = _.escapeRegExChars(patterns[i]);\n                if (diacriticInsensitive) {\n                    escapedWord = escapedWord.replace(/\\S/g, accent_replacer);\n                }\n                escapedPatterns.push(escapedWord);\n            }\n            regexStr = wordsOnly ? \"\\\\b(\" + escapedPatterns.join(\"|\") + \")\\\\b\" : \"(\" + escapedPatterns.join(\"|\") + \")\";\n            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, \"i\");\n        }\n    }(window.document);\n    var Input = function() {\n        \"use strict\";\n        var specialKeyCodeMap;\n        specialKeyCodeMap = {\n            9: \"tab\",\n            27: \"esc\",\n            37: \"left\",\n            39: \"right\",\n            13: \"enter\",\n            38: \"up\",\n            40: \"down\"\n        };\n        function Input(o, www) {\n            var id;\n            o = o || {};\n            if (!o.input) {\n                $.error(\"input is missing\");\n            }\n            www.mixin(this);\n            this.$hint = $(o.hint);\n            this.$input = $(o.input);\n            this.$menu = $(o.menu);\n            id = this.$input.attr(\"id\") || _.guid();\n            this.$menu.attr(\"id\", id + \"_listbox\");\n            this.$hint.attr({\n                \"aria-hidden\": true\n            });\n            this.$input.attr({\n                \"aria-owns\": id + \"_listbox\",\n                role: \"combobox\",\n                \"aria-autocomplete\": \"list\",\n                \"aria-expanded\": false\n            });\n            this.query = this.$input.val();\n            this.queryWhenFocused = this.hasFocus() ? this.query : null;\n            this.$overflowHelper = buildOverflowHelper(this.$input);\n            this._checkLanguageDirection();\n            if (this.$hint.length === 0) {\n                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;\n            }\n            this.onSync(\"cursorchange\", this._updateDescendent);\n        }\n        Input.normalizeQuery = function(str) {\n            return _.toStr(str).replace(/^\\s*/g, \"\").replace(/\\s{2,}/g, \" \");\n        };\n        _.mixin(Input.prototype, EventEmitter, {\n            _onBlur: function onBlur() {\n                this.resetInputValue();\n                this.trigger(\"blurred\");\n            },\n            _onFocus: function onFocus() {\n                this.queryWhenFocused = this.query;\n                this.trigger(\"focused\");\n            },\n            _onKeydown: function onKeydown($e) {\n                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];\n                this._managePreventDefault(keyName, $e);\n                if (keyName && this._shouldTrigger(keyName, $e)) {\n                    this.trigger(keyName + \"Keyed\", $e);\n                }\n            },\n            _onInput: function onInput() {\n                this._setQuery(this.getInputValue());\n                this.clearHintIfInvalid();\n                this._checkLanguageDirection();\n            },\n            _managePreventDefault: function managePreventDefault(keyName, $e) {\n                var preventDefault;\n                switch (keyName) {\n                  case \"up\":\n                  case \"down\":\n                    preventDefault = !withModifier($e);\n                    break;\n\n                  default:\n                    preventDefault = false;\n                }\n                preventDefault && $e.preventDefault();\n            },\n            _shouldTrigger: function shouldTrigger(keyName, $e) {\n                var trigger;\n                switch (keyName) {\n                  case \"tab\":\n                    trigger = !withModifier($e);\n                    break;\n\n                  default:\n                    trigger = true;\n                }\n                return trigger;\n            },\n            _checkLanguageDirection: function checkLanguageDirection() {\n                var dir = (this.$input.css(\"direction\") || \"ltr\").toLowerCase();\n                if (this.dir !== dir) {\n                    this.dir = dir;\n                    this.$hint.attr(\"dir\", dir);\n                    this.trigger(\"langDirChanged\", dir);\n                }\n            },\n            _setQuery: function setQuery(val, silent) {\n                var areEquivalent, hasDifferentWhitespace;\n                areEquivalent = areQueriesEquivalent(val, this.query);\n                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;\n                this.query = val;\n                if (!silent && !areEquivalent) {\n                    this.trigger(\"queryChanged\", this.query);\n                } else if (!silent && hasDifferentWhitespace) {\n                    this.trigger(\"whitespaceChanged\", this.query);\n                }\n            },\n            _updateDescendent: function updateDescendent(event, id) {\n                this.$input.attr(\"aria-activedescendant\", id);\n            },\n            bind: function() {\n                var that = this, onBlur, onFocus, onKeydown, onInput;\n                onBlur = _.bind(this._onBlur, this);\n                onFocus = _.bind(this._onFocus, this);\n                onKeydown = _.bind(this._onKeydown, this);\n                onInput = _.bind(this._onInput, this);\n                this.$input.on(\"blur.tt\", onBlur).on(\"focus.tt\", onFocus).on(\"keydown.tt\", onKeydown);\n                if (!_.isMsie() || _.isMsie() > 9) {\n                    this.$input.on(\"input.tt\", onInput);\n                } else {\n                    this.$input.on(\"keydown.tt keypress.tt cut.tt paste.tt\", function($e) {\n                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {\n                            return;\n                        }\n                        _.defer(_.bind(that._onInput, that, $e));\n                    });\n                }\n                return this;\n            },\n            focus: function focus() {\n                this.$input.focus();\n            },\n            blur: function blur() {\n                this.$input.blur();\n            },\n            getLangDir: function getLangDir() {\n                return this.dir;\n            },\n            getQuery: function getQuery() {\n                return this.query || \"\";\n            },\n            setQuery: function setQuery(val, silent) {\n                this.setInputValue(val);\n                this._setQuery(val, silent);\n            },\n            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {\n                return this.query !== this.queryWhenFocused;\n            },\n            getInputValue: function getInputValue() {\n                return this.$input.val();\n            },\n            setInputValue: function setInputValue(value) {\n                this.$input.val(value);\n                this.clearHintIfInvalid();\n                this._checkLanguageDirection();\n            },\n            resetInputValue: function resetInputValue() {\n                this.setInputValue(this.query);\n            },\n            getHint: function getHint() {\n                return this.$hint.val();\n            },\n            setHint: function setHint(value) {\n                this.$hint.val(value);\n            },\n            clearHint: function clearHint() {\n                this.setHint(\"\");\n            },\n            clearHintIfInvalid: function clearHintIfInvalid() {\n                var val, hint, valIsPrefixOfHint, isValid;\n                val = this.getInputValue();\n                hint = this.getHint();\n                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;\n                isValid = val !== \"\" && valIsPrefixOfHint && !this.hasOverflow();\n                !isValid && this.clearHint();\n            },\n            hasFocus: function hasFocus() {\n                return this.$input.is(\":focus\");\n            },\n            hasOverflow: function hasOverflow() {\n                var constraint = this.$input.width() - 2;\n                this.$overflowHelper.text(this.getInputValue());\n                return this.$overflowHelper.width() >= constraint;\n            },\n            isCursorAtEnd: function() {\n                var valueLength, selectionStart, range;\n                valueLength = this.$input.val().length;\n                selectionStart = this.$input[0].selectionStart;\n                if (_.isNumber(selectionStart)) {\n                    return selectionStart === valueLength;\n                } else if (document.selection) {\n                    range = document.selection.createRange();\n                    range.moveStart(\"character\", -valueLength);\n                    return valueLength === range.text.length;\n                }\n                return true;\n            },\n            destroy: function destroy() {\n                this.$hint.off(\".tt\");\n                this.$input.off(\".tt\");\n                this.$overflowHelper.remove();\n                this.$hint = this.$input = this.$overflowHelper = $(\"<div>\");\n            },\n            setAriaExpanded: function setAriaExpanded(value) {\n                this.$input.attr(\"aria-expanded\", value);\n            }\n        });\n        return Input;\n        function buildOverflowHelper($input) {\n            return $('<pre aria-hidden=\"true\"></pre>').css({\n                position: \"absolute\",\n                visibility: \"hidden\",\n                whiteSpace: \"pre\",\n                fontFamily: $input.css(\"font-family\"),\n                fontSize: $input.css(\"font-size\"),\n                fontStyle: $input.css(\"font-style\"),\n                fontVariant: $input.css(\"font-variant\"),\n                fontWeight: $input.css(\"font-weight\"),\n                wordSpacing: $input.css(\"word-spacing\"),\n                letterSpacing: $input.css(\"letter-spacing\"),\n                textIndent: $input.css(\"text-indent\"),\n                textRendering: $input.css(\"text-rendering\"),\n                textTransform: $input.css(\"text-transform\")\n            }).insertAfter($input);\n        }\n        function areQueriesEquivalent(a, b) {\n            return Input.normalizeQuery(a) === Input.normalizeQuery(b);\n        }\n        function withModifier($e) {\n            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;\n        }\n    }();\n    var Dataset = function() {\n        \"use strict\";\n        var keys, nameGenerator;\n        keys = {\n            dataset: \"tt-selectable-dataset\",\n            val: \"tt-selectable-display\",\n            obj: \"tt-selectable-object\"\n        };\n        nameGenerator = _.getIdGenerator();\n        function Dataset(o, www) {\n            o = o || {};\n            o.templates = o.templates || {};\n            o.templates.notFound = o.templates.notFound || o.templates.empty;\n            if (!o.source) {\n                $.error(\"missing source\");\n            }\n            if (!o.node) {\n                $.error(\"missing node\");\n            }\n            if (o.name && !isValidName(o.name)) {\n                $.error(\"invalid dataset name: \" + o.name);\n            }\n            www.mixin(this);\n            this.highlight = !!o.highlight;\n            this.name = _.toStr(o.name || nameGenerator());\n            this.limit = o.limit || 5;\n            this.displayFn = getDisplayFn(o.display || o.displayKey);\n            this.templates = getTemplates(o.templates, this.displayFn);\n            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;\n            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;\n            this._resetLastSuggestion();\n            this.$el = $(o.node).attr(\"role\", \"presentation\").addClass(this.classes.dataset).addClass(this.classes.dataset + \"-\" + this.name);\n        }\n        Dataset.extractData = function extractData(el) {\n            var $el = $(el);\n            if ($el.data(keys.obj)) {\n                return {\n                    dataset: $el.data(keys.dataset) || \"\",\n                    val: $el.data(keys.val) || \"\",\n                    obj: $el.data(keys.obj) || null\n                };\n            }\n            return null;\n        };\n        _.mixin(Dataset.prototype, EventEmitter, {\n            _overwrite: function overwrite(query, suggestions) {\n                suggestions = suggestions || [];\n                if (suggestions.length) {\n                    this._renderSuggestions(query, suggestions);\n                } else if (this.async && this.templates.pending) {\n                    this._renderPending(query);\n                } else if (!this.async && this.templates.notFound) {\n                    this._renderNotFound(query);\n                } else {\n                    this._empty();\n                }\n                this.trigger(\"rendered\", suggestions, false, this.name);\n            },\n            _append: function append(query, suggestions) {\n                suggestions = suggestions || [];\n                if (suggestions.length && this.$lastSuggestion.length) {\n                    this._appendSuggestions(query, suggestions);\n                } else if (suggestions.length) {\n                    this._renderSuggestions(query, suggestions);\n                } else if (!this.$lastSuggestion.length && this.templates.notFound) {\n                    this._renderNotFound(query);\n                }\n                this.trigger(\"rendered\", suggestions, true, this.name);\n            },\n            _renderSuggestions: function renderSuggestions(query, suggestions) {\n                var $fragment;\n                $fragment = this._getSuggestionsFragment(query, suggestions);\n                this.$lastSuggestion = $fragment.children().last();\n                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));\n            },\n            _appendSuggestions: function appendSuggestions(query, suggestions) {\n                var $fragment, $lastSuggestion;\n                $fragment = this._getSuggestionsFragment(query, suggestions);\n                $lastSuggestion = $fragment.children().last();\n                this.$lastSuggestion.after($fragment);\n                this.$lastSuggestion = $lastSuggestion;\n            },\n            _renderPending: function renderPending(query) {\n                var template = this.templates.pending;\n                this._resetLastSuggestion();\n                template && this.$el.html(template({\n                    query: query,\n                    dataset: this.name\n                }));\n            },\n            _renderNotFound: function renderNotFound(query) {\n                var template = this.templates.notFound;\n                this._resetLastSuggestion();\n                template && this.$el.html(template({\n                    query: query,\n                    dataset: this.name\n                }));\n            },\n            _empty: function empty() {\n                this.$el.empty();\n                this._resetLastSuggestion();\n            },\n            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {\n                var that = this, fragment;\n                fragment = document.createDocumentFragment();\n                _.each(suggestions, function getSuggestionNode(suggestion) {\n                    var $el, context;\n                    context = that._injectQuery(query, suggestion);\n                    $el = $(that.templates.suggestion(context)).data(keys.dataset, that.name).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + \" \" + that.classes.selectable);\n                    fragment.appendChild($el[0]);\n                });\n                this.highlight && highlight({\n                    className: this.classes.highlight,\n                    node: fragment,\n                    pattern: query\n                });\n                return $(fragment);\n            },\n            _getFooter: function getFooter(query, suggestions) {\n                return this.templates.footer ? this.templates.footer({\n                    query: query,\n                    suggestions: suggestions,\n                    dataset: this.name\n                }) : null;\n            },\n            _getHeader: function getHeader(query, suggestions) {\n                return this.templates.header ? this.templates.header({\n                    query: query,\n                    suggestions: suggestions,\n                    dataset: this.name\n                }) : null;\n            },\n            _resetLastSuggestion: function resetLastSuggestion() {\n                this.$lastSuggestion = $();\n            },\n            _injectQuery: function injectQuery(query, obj) {\n                return _.isObject(obj) ? _.mixin({\n                    _query: query\n                }, obj) : obj;\n            },\n            update: function update(query) {\n                var that = this, canceled = false, syncCalled = false, rendered = 0;\n                this.cancel();\n                this.cancel = function cancel() {\n                    canceled = true;\n                    that.cancel = $.noop;\n                    that.async && that.trigger(\"asyncCanceled\", query, that.name);\n                };\n                this.source(query, sync, async);\n                !syncCalled && sync([]);\n                function sync(suggestions) {\n                    if (syncCalled) {\n                        return;\n                    }\n                    syncCalled = true;\n                    suggestions = (suggestions || []).slice(0, that.limit);\n                    rendered = suggestions.length;\n                    that._overwrite(query, suggestions);\n                    if (rendered < that.limit && that.async) {\n                        that.trigger(\"asyncRequested\", query, that.name);\n                    }\n                }\n                function async(suggestions) {\n                    suggestions = suggestions || [];\n                    if (!canceled && rendered < that.limit) {\n                        that.cancel = $.noop;\n                        var idx = Math.abs(rendered - that.limit);\n                        rendered += idx;\n                        that._append(query, suggestions.slice(0, idx));\n                        that.async && that.trigger(\"asyncReceived\", query, that.name);\n                    }\n                }\n            },\n            cancel: $.noop,\n            clear: function clear() {\n                this._empty();\n                this.cancel();\n                this.trigger(\"cleared\");\n            },\n            isEmpty: function isEmpty() {\n                return this.$el.is(\":empty\");\n            },\n            destroy: function destroy() {\n                this.$el = $(\"<div>\");\n            }\n        });\n        return Dataset;\n        function getDisplayFn(display) {\n            display = display || _.stringify;\n            return _.isFunction(display) ? display : displayFn;\n            function displayFn(obj) {\n                return obj[display];\n            }\n        }\n        function getTemplates(templates, displayFn) {\n            return {\n                notFound: templates.notFound && _.templatify(templates.notFound),\n                pending: templates.pending && _.templatify(templates.pending),\n                header: templates.header && _.templatify(templates.header),\n                footer: templates.footer && _.templatify(templates.footer),\n                suggestion: templates.suggestion ? userSuggestionTemplate : suggestionTemplate\n            };\n            function userSuggestionTemplate(context) {\n                var template = templates.suggestion;\n                return $(template(context)).attr(\"id\", _.guid());\n            }\n            function suggestionTemplate(context) {\n                return $('<div role=\"option\">').attr(\"id\", _.guid()).text(displayFn(context));\n            }\n        }\n        function isValidName(str) {\n            return /^[_a-zA-Z0-9-]+$/.test(str);\n        }\n    }();\n    var Menu = function() {\n        \"use strict\";\n        function Menu(o, www) {\n            var that = this;\n            o = o || {};\n            if (!o.node) {\n                $.error(\"node is required\");\n            }\n            www.mixin(this);\n            this.$node = $(o.node);\n            this.query = null;\n            this.datasets = _.map(o.datasets, initializeDataset);\n            function initializeDataset(oDataset) {\n                var node = that.$node.find(oDataset.node).first();\n                oDataset.node = node.length ? node : $(\"<div>\").appendTo(that.$node);\n                return new Dataset(oDataset, www);\n            }\n        }\n        _.mixin(Menu.prototype, EventEmitter, {\n            _onSelectableClick: function onSelectableClick($e) {\n                this.trigger(\"selectableClicked\", $($e.currentTarget));\n            },\n            _onRendered: function onRendered(type, dataset, suggestions, async) {\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\n                this.trigger(\"datasetRendered\", dataset, suggestions, async);\n            },\n            _onCleared: function onCleared() {\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\n                this.trigger(\"datasetCleared\");\n            },\n            _propagate: function propagate() {\n                this.trigger.apply(this, arguments);\n            },\n            _allDatasetsEmpty: function allDatasetsEmpty() {\n                return _.every(this.datasets, _.bind(function isDatasetEmpty(dataset) {\n                    var isEmpty = dataset.isEmpty();\n                    this.$node.attr(\"aria-expanded\", !isEmpty);\n                    return isEmpty;\n                }, this));\n            },\n            _getSelectables: function getSelectables() {\n                return this.$node.find(this.selectors.selectable);\n            },\n            _removeCursor: function _removeCursor() {\n                var $selectable = this.getActiveSelectable();\n                $selectable && $selectable.removeClass(this.classes.cursor);\n            },\n            _ensureVisible: function ensureVisible($el) {\n                var elTop, elBottom, nodeScrollTop, nodeHeight;\n                elTop = $el.position().top;\n                elBottom = elTop + $el.outerHeight(true);\n                nodeScrollTop = this.$node.scrollTop();\n                nodeHeight = this.$node.height() + parseInt(this.$node.css(\"paddingTop\"), 10) + parseInt(this.$node.css(\"paddingBottom\"), 10);\n                if (elTop < 0) {\n                    this.$node.scrollTop(nodeScrollTop + elTop);\n                } else if (nodeHeight < elBottom) {\n                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));\n                }\n            },\n            bind: function() {\n                var that = this, onSelectableClick;\n                onSelectableClick = _.bind(this._onSelectableClick, this);\n                this.$node.on(\"click.tt\", this.selectors.selectable, onSelectableClick);\n                this.$node.on(\"mouseover\", this.selectors.selectable, function() {\n                    that.setCursor($(this));\n                });\n                this.$node.on(\"mouseleave\", function() {\n                    that._removeCursor();\n                });\n                _.each(this.datasets, function(dataset) {\n                    dataset.onSync(\"asyncRequested\", that._propagate, that).onSync(\"asyncCanceled\", that._propagate, that).onSync(\"asyncReceived\", that._propagate, that).onSync(\"rendered\", that._onRendered, that).onSync(\"cleared\", that._onCleared, that);\n                });\n                return this;\n            },\n            isOpen: function isOpen() {\n                return this.$node.hasClass(this.classes.open);\n            },\n            open: function open() {\n                this.$node.scrollTop(0);\n                this.$node.addClass(this.classes.open);\n            },\n            close: function close() {\n                this.$node.attr(\"aria-expanded\", false);\n                this.$node.removeClass(this.classes.open);\n                this._removeCursor();\n            },\n            setLanguageDirection: function setLanguageDirection(dir) {\n                this.$node.attr(\"dir\", dir);\n            },\n            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {\n                var $selectables, $oldCursor, oldIndex, newIndex;\n                $oldCursor = this.getActiveSelectable();\n                $selectables = this._getSelectables();\n                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;\n                newIndex = oldIndex + delta;\n                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;\n                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;\n                return newIndex === -1 ? null : $selectables.eq(newIndex);\n            },\n            setCursor: function setCursor($selectable) {\n                this._removeCursor();\n                if ($selectable = $selectable && $selectable.first()) {\n                    $selectable.addClass(this.classes.cursor);\n                    this._ensureVisible($selectable);\n                }\n            },\n            getSelectableData: function getSelectableData($el) {\n                return $el && $el.length ? Dataset.extractData($el) : null;\n            },\n            getActiveSelectable: function getActiveSelectable() {\n                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();\n                return $selectable.length ? $selectable : null;\n            },\n            getTopSelectable: function getTopSelectable() {\n                var $selectable = this._getSelectables().first();\n                return $selectable.length ? $selectable : null;\n            },\n            update: function update(query) {\n                var isValidUpdate = query !== this.query;\n                if (isValidUpdate) {\n                    this.query = query;\n                    _.each(this.datasets, updateDataset);\n                }\n                return isValidUpdate;\n                function updateDataset(dataset) {\n                    dataset.update(query);\n                }\n            },\n            empty: function empty() {\n                _.each(this.datasets, clearDataset);\n                this.query = null;\n                this.$node.addClass(this.classes.empty);\n                function clearDataset(dataset) {\n                    dataset.clear();\n                }\n            },\n            destroy: function destroy() {\n                this.$node.off(\".tt\");\n                this.$node = $(\"<div>\");\n                _.each(this.datasets, destroyDataset);\n                function destroyDataset(dataset) {\n                    dataset.destroy();\n                }\n            }\n        });\n        return Menu;\n    }();\n    var Status = function() {\n        \"use strict\";\n        function Status(options) {\n            this.$el = $(\"<span></span>\", {\n                role: \"status\",\n                \"aria-live\": \"polite\"\n            }).css({\n                position: \"absolute\",\n                padding: \"0\",\n                border: \"0\",\n                height: \"1px\",\n                width: \"1px\",\n                \"margin-bottom\": \"-1px\",\n                \"margin-right\": \"-1px\",\n                overflow: \"hidden\",\n                clip: \"rect(0 0 0 0)\",\n                \"white-space\": \"nowrap\"\n            });\n            options.$input.after(this.$el);\n            _.each(options.menu.datasets, _.bind(function(dataset) {\n                if (dataset.onSync) {\n                    dataset.onSync(\"rendered\", _.bind(this.update, this));\n                    dataset.onSync(\"cleared\", _.bind(this.cleared, this));\n                }\n            }, this));\n        }\n        _.mixin(Status.prototype, {\n            update: function update(event, suggestions) {\n                var length = suggestions.length;\n                var words;\n                if (length === 1) {\n                    words = {\n                        result: \"result\",\n                        is: \"is\"\n                    };\n                } else {\n                    words = {\n                        result: \"results\",\n                        is: \"are\"\n                    };\n                }\n                this.$el.text(length + \" \" + words.result + \" \" + words.is + \" available, use up and down arrow keys to navigate.\");\n            },\n            cleared: function() {\n                this.$el.text(\"\");\n            }\n        });\n        return Status;\n    }();\n    var DefaultMenu = function() {\n        \"use strict\";\n        var s = Menu.prototype;\n        function DefaultMenu() {\n            Menu.apply(this, [].slice.call(arguments, 0));\n        }\n        _.mixin(DefaultMenu.prototype, Menu.prototype, {\n            open: function open() {\n                !this._allDatasetsEmpty() && this._show();\n                return s.open.apply(this, [].slice.call(arguments, 0));\n            },\n            close: function close() {\n                this._hide();\n                return s.close.apply(this, [].slice.call(arguments, 0));\n            },\n            _onRendered: function onRendered() {\n                if (this._allDatasetsEmpty()) {\n                    this._hide();\n                } else {\n                    this.isOpen() && this._show();\n                }\n                return s._onRendered.apply(this, [].slice.call(arguments, 0));\n            },\n            _onCleared: function onCleared() {\n                if (this._allDatasetsEmpty()) {\n                    this._hide();\n                } else {\n                    this.isOpen() && this._show();\n                }\n                return s._onCleared.apply(this, [].slice.call(arguments, 0));\n            },\n            setLanguageDirection: function setLanguageDirection(dir) {\n                this.$node.css(dir === \"ltr\" ? this.css.ltr : this.css.rtl);\n                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));\n            },\n            _hide: function hide() {\n                this.$node.hide();\n            },\n            _show: function show() {\n                this.$node.css(\"display\", \"block\");\n            }\n        });\n        return DefaultMenu;\n    }();\n    var Typeahead = function() {\n        \"use strict\";\n        function Typeahead(o, www) {\n            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;\n            o = o || {};\n            if (!o.input) {\n                $.error(\"missing input\");\n            }\n            if (!o.menu) {\n                $.error(\"missing menu\");\n            }\n            if (!o.eventBus) {\n                $.error(\"missing event bus\");\n            }\n            www.mixin(this);\n            this.eventBus = o.eventBus;\n            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;\n            this.input = o.input;\n            this.menu = o.menu;\n            this.enabled = true;\n            this.autoselect = !!o.autoselect;\n            this.active = false;\n            this.input.hasFocus() && this.activate();\n            this.dir = this.input.getLangDir();\n            this._hacks();\n            this.menu.bind().onSync(\"selectableClicked\", this._onSelectableClicked, this).onSync(\"asyncRequested\", this._onAsyncRequested, this).onSync(\"asyncCanceled\", this._onAsyncCanceled, this).onSync(\"asyncReceived\", this._onAsyncReceived, this).onSync(\"datasetRendered\", this._onDatasetRendered, this).onSync(\"datasetCleared\", this._onDatasetCleared, this);\n            onFocused = c(this, \"activate\", \"open\", \"_onFocused\");\n            onBlurred = c(this, \"deactivate\", \"_onBlurred\");\n            onEnterKeyed = c(this, \"isActive\", \"isOpen\", \"_onEnterKeyed\");\n            onTabKeyed = c(this, \"isActive\", \"isOpen\", \"_onTabKeyed\");\n            onEscKeyed = c(this, \"isActive\", \"_onEscKeyed\");\n            onUpKeyed = c(this, \"isActive\", \"open\", \"_onUpKeyed\");\n            onDownKeyed = c(this, \"isActive\", \"open\", \"_onDownKeyed\");\n            onLeftKeyed = c(this, \"isActive\", \"isOpen\", \"_onLeftKeyed\");\n            onRightKeyed = c(this, \"isActive\", \"isOpen\", \"_onRightKeyed\");\n            onQueryChanged = c(this, \"_openIfActive\", \"_onQueryChanged\");\n            onWhitespaceChanged = c(this, \"_openIfActive\", \"_onWhitespaceChanged\");\n            this.input.bind().onSync(\"focused\", onFocused, this).onSync(\"blurred\", onBlurred, this).onSync(\"enterKeyed\", onEnterKeyed, this).onSync(\"tabKeyed\", onTabKeyed, this).onSync(\"escKeyed\", onEscKeyed, this).onSync(\"upKeyed\", onUpKeyed, this).onSync(\"downKeyed\", onDownKeyed, this).onSync(\"leftKeyed\", onLeftKeyed, this).onSync(\"rightKeyed\", onRightKeyed, this).onSync(\"queryChanged\", onQueryChanged, this).onSync(\"whitespaceChanged\", onWhitespaceChanged, this).onSync(\"langDirChanged\", this._onLangDirChanged, this);\n        }\n        _.mixin(Typeahead.prototype, {\n            _hacks: function hacks() {\n                var $input, $menu;\n                $input = this.input.$input || $(\"<div>\");\n                $menu = this.menu.$node || $(\"<div>\");\n                $input.on(\"blur.tt\", function($e) {\n                    var active, isActive, hasActive;\n                    active = document.activeElement;\n                    isActive = $menu.is(active);\n                    hasActive = $menu.has(active).length > 0;\n                    if (_.isMsie() && (isActive || hasActive)) {\n                        $e.preventDefault();\n                        $e.stopImmediatePropagation();\n                        _.defer(function() {\n                            $input.focus();\n                        });\n                    }\n                });\n                $menu.on(\"mousedown.tt\", function($e) {\n                    $e.preventDefault();\n                });\n            },\n            _onSelectableClicked: function onSelectableClicked(type, $el) {\n                this.select($el);\n            },\n            _onDatasetCleared: function onDatasetCleared() {\n                this._updateHint();\n            },\n            _onDatasetRendered: function onDatasetRendered(type, suggestions, async, dataset) {\n                this._updateHint();\n                if (this.autoselect) {\n                    var cursorClass = this.selectors.cursor.substr(1);\n                    this.menu.$node.find(this.selectors.suggestion).first().addClass(cursorClass);\n                }\n                this.eventBus.trigger(\"render\", suggestions, async, dataset);\n            },\n            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {\n                this.eventBus.trigger(\"asyncrequest\", query, dataset);\n            },\n            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {\n                this.eventBus.trigger(\"asynccancel\", query, dataset);\n            },\n            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {\n                this.eventBus.trigger(\"asyncreceive\", query, dataset);\n            },\n            _onFocused: function onFocused() {\n                this._minLengthMet() && this.menu.update(this.input.getQuery());\n            },\n            _onBlurred: function onBlurred() {\n                if (this.input.hasQueryChangedSinceLastFocus()) {\n                    this.eventBus.trigger(\"change\", this.input.getQuery());\n                }\n            },\n            _onEnterKeyed: function onEnterKeyed(type, $e) {\n                var $selectable;\n                if ($selectable = this.menu.getActiveSelectable()) {\n                    if (this.select($selectable)) {\n                        $e.preventDefault();\n                        $e.stopPropagation();\n                    }\n                } else if (this.autoselect) {\n                    if (this.select(this.menu.getTopSelectable())) {\n                        $e.preventDefault();\n                        $e.stopPropagation();\n                    }\n                }\n            },\n            _onTabKeyed: function onTabKeyed(type, $e) {\n                var $selectable;\n                if ($selectable = this.menu.getActiveSelectable()) {\n                    this.select($selectable) && $e.preventDefault();\n                } else if (this.autoselect) {\n                    if ($selectable = this.menu.getTopSelectable()) {\n                        this.autocomplete($selectable) && $e.preventDefault();\n                    }\n                }\n            },\n            _onEscKeyed: function onEscKeyed() {\n                this.close();\n            },\n            _onUpKeyed: function onUpKeyed() {\n                this.moveCursor(-1);\n            },\n            _onDownKeyed: function onDownKeyed() {\n                this.moveCursor(+1);\n            },\n            _onLeftKeyed: function onLeftKeyed() {\n                if (this.dir === \"rtl\" && this.input.isCursorAtEnd()) {\n                    this.autocomplete(this.menu.getActiveSelectable() || this.menu.getTopSelectable());\n                }\n            },\n            _onRightKeyed: function onRightKeyed() {\n                if (this.dir === \"ltr\" && this.input.isCursorAtEnd()) {\n                    this.autocomplete(this.menu.getActiveSelectable() || this.menu.getTopSelectable());\n                }\n            },\n            _onQueryChanged: function onQueryChanged(e, query) {\n                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();\n            },\n            _onWhitespaceChanged: function onWhitespaceChanged() {\n                this._updateHint();\n            },\n            _onLangDirChanged: function onLangDirChanged(e, dir) {\n                if (this.dir !== dir) {\n                    this.dir = dir;\n                    this.menu.setLanguageDirection(dir);\n                }\n            },\n            _openIfActive: function openIfActive() {\n                this.isActive() && this.open();\n            },\n            _minLengthMet: function minLengthMet(query) {\n                query = _.isString(query) ? query : this.input.getQuery() || \"\";\n                return query.length >= this.minLength;\n            },\n            _updateHint: function updateHint() {\n                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;\n                $selectable = this.menu.getTopSelectable();\n                data = this.menu.getSelectableData($selectable);\n                val = this.input.getInputValue();\n                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {\n                    query = Input.normalizeQuery(val);\n                    escapedQuery = _.escapeRegExChars(query);\n                    frontMatchRegEx = new RegExp(\"^(?:\" + escapedQuery + \")(.+$)\", \"i\");\n                    match = frontMatchRegEx.exec(data.val);\n                    match && this.input.setHint(val + match[1]);\n                } else {\n                    this.input.clearHint();\n                }\n            },\n            isEnabled: function isEnabled() {\n                return this.enabled;\n            },\n            enable: function enable() {\n                this.enabled = true;\n            },\n            disable: function disable() {\n                this.enabled = false;\n            },\n            isActive: function isActive() {\n                return this.active;\n            },\n            activate: function activate() {\n                if (this.isActive()) {\n                    return true;\n                } else if (!this.isEnabled() || this.eventBus.before(\"active\")) {\n                    return false;\n                } else {\n                    this.active = true;\n                    this.eventBus.trigger(\"active\");\n                    return true;\n                }\n            },\n            deactivate: function deactivate() {\n                if (!this.isActive()) {\n                    return true;\n                } else if (this.eventBus.before(\"idle\")) {\n                    return false;\n                } else {\n                    this.active = false;\n                    this.close();\n                    this.eventBus.trigger(\"idle\");\n                    return true;\n                }\n            },\n            isOpen: function isOpen() {\n                return this.menu.isOpen();\n            },\n            open: function open() {\n                if (!this.isOpen() && !this.eventBus.before(\"open\")) {\n                    this.input.setAriaExpanded(true);\n                    this.menu.open();\n                    this._updateHint();\n                    this.eventBus.trigger(\"open\");\n                }\n                return this.isOpen();\n            },\n            close: function close() {\n                if (this.isOpen() && !this.eventBus.before(\"close\")) {\n                    this.input.setAriaExpanded(false);\n                    this.menu.close();\n                    this.input.clearHint();\n                    this.input.resetInputValue();\n                    this.eventBus.trigger(\"close\");\n                }\n                return !this.isOpen();\n            },\n            setVal: function setVal(val) {\n                this.input.setQuery(_.toStr(val));\n            },\n            getVal: function getVal() {\n                return this.input.getQuery();\n            },\n            select: function select($selectable) {\n                var data = this.menu.getSelectableData($selectable);\n                if (data && !this.eventBus.before(\"select\", data.obj, data.dataset)) {\n                    this.input.setQuery(data.val, true);\n                    this.eventBus.trigger(\"select\", data.obj, data.dataset);\n                    this.close();\n                    return true;\n                }\n                return false;\n            },\n            autocomplete: function autocomplete($selectable) {\n                var query, data, isValid;\n                query = this.input.getQuery();\n                data = this.menu.getSelectableData($selectable);\n                isValid = data && query !== data.val;\n                if (isValid && !this.eventBus.before(\"autocomplete\", data.obj, data.dataset)) {\n                    this.input.setQuery(data.val);\n                    this.eventBus.trigger(\"autocomplete\", data.obj, data.dataset);\n                    return true;\n                }\n                return false;\n            },\n            moveCursor: function moveCursor(delta) {\n                var query, $candidate, data, suggestion, datasetName, cancelMove, id;\n                query = this.input.getQuery();\n                $candidate = this.menu.selectableRelativeToCursor(delta);\n                data = this.menu.getSelectableData($candidate);\n                suggestion = data ? data.obj : null;\n                datasetName = data ? data.dataset : null;\n                id = $candidate ? $candidate.attr(\"id\") : null;\n                this.input.trigger(\"cursorchange\", id);\n                cancelMove = this._minLengthMet() && this.menu.update(query);\n                if (!cancelMove && !this.eventBus.before(\"cursorchange\", suggestion, datasetName)) {\n                    this.menu.setCursor($candidate);\n                    if (data) {\n                        if (typeof data.val === \"string\") {\n                            this.input.setInputValue(data.val);\n                        }\n                    } else {\n                        this.input.resetInputValue();\n                        this._updateHint();\n                    }\n                    this.eventBus.trigger(\"cursorchange\", suggestion, datasetName);\n                    return true;\n                }\n                return false;\n            },\n            destroy: function destroy() {\n                this.input.destroy();\n                this.menu.destroy();\n            }\n        });\n        return Typeahead;\n        function c(ctx) {\n            var methods = [].slice.call(arguments, 1);\n            return function() {\n                var args = [].slice.call(arguments);\n                _.each(methods, function(method) {\n                    return ctx[method].apply(ctx, args);\n                });\n            };\n        }\n    }();\n    (function() {\n        \"use strict\";\n        var old, keys, methods;\n        old = $.fn.typeahead;\n        keys = {\n            www: \"tt-www\",\n            attrs: \"tt-attrs\",\n            typeahead: \"tt-typeahead\"\n        };\n        methods = {\n            initialize: function initialize(o, datasets) {\n                var www;\n                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);\n                o = o || {};\n                www = WWW(o.classNames);\n                return this.each(attach);\n                function attach() {\n                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, status, typeahead, MenuConstructor;\n                    _.each(datasets, function(d) {\n                        d.highlight = !!o.highlight;\n                    });\n                    $input = $(this);\n                    $wrapper = $(www.html.wrapper);\n                    $hint = $elOrNull(o.hint);\n                    $menu = $elOrNull(o.menu);\n                    defaultHint = o.hint !== false && !$hint;\n                    defaultMenu = o.menu !== false && !$menu;\n                    defaultHint && ($hint = buildHintFromInput($input, www));\n                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));\n                    $hint && $hint.val(\"\");\n                    $input = prepInput($input, www);\n                    if (defaultHint || defaultMenu) {\n                        $wrapper.css(www.css.wrapper);\n                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);\n                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);\n                    }\n                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;\n                    eventBus = new EventBus({\n                        el: $input\n                    });\n                    input = new Input({\n                        hint: $hint,\n                        input: $input,\n                        menu: $menu\n                    }, www);\n                    menu = new MenuConstructor({\n                        node: $menu,\n                        datasets: datasets\n                    }, www);\n                    status = new Status({\n                        $input: $input,\n                        menu: menu\n                    });\n                    typeahead = new Typeahead({\n                        input: input,\n                        menu: menu,\n                        eventBus: eventBus,\n                        minLength: o.minLength,\n                        autoselect: o.autoselect\n                    }, www);\n                    $input.data(keys.www, www);\n                    $input.data(keys.typeahead, typeahead);\n                }\n            },\n            isEnabled: function isEnabled() {\n                var enabled;\n                ttEach(this.first(), function(t) {\n                    enabled = t.isEnabled();\n                });\n                return enabled;\n            },\n            enable: function enable() {\n                ttEach(this, function(t) {\n                    t.enable();\n                });\n                return this;\n            },\n            disable: function disable() {\n                ttEach(this, function(t) {\n                    t.disable();\n                });\n                return this;\n            },\n            isActive: function isActive() {\n                var active;\n                ttEach(this.first(), function(t) {\n                    active = t.isActive();\n                });\n                return active;\n            },\n            activate: function activate() {\n                ttEach(this, function(t) {\n                    t.activate();\n                });\n                return this;\n            },\n            deactivate: function deactivate() {\n                ttEach(this, function(t) {\n                    t.deactivate();\n                });\n                return this;\n            },\n            isOpen: function isOpen() {\n                var open;\n                ttEach(this.first(), function(t) {\n                    open = t.isOpen();\n                });\n                return open;\n            },\n            open: function open() {\n                ttEach(this, function(t) {\n                    t.open();\n                });\n                return this;\n            },\n            close: function close() {\n                ttEach(this, function(t) {\n                    t.close();\n                });\n                return this;\n            },\n            select: function select(el) {\n                var success = false, $el = $(el);\n                ttEach(this.first(), function(t) {\n                    success = t.select($el);\n                });\n                return success;\n            },\n            autocomplete: function autocomplete(el) {\n                var success = false, $el = $(el);\n                ttEach(this.first(), function(t) {\n                    success = t.autocomplete($el);\n                });\n                return success;\n            },\n            moveCursor: function moveCursoe(delta) {\n                var success = false;\n                ttEach(this.first(), function(t) {\n                    success = t.moveCursor(delta);\n                });\n                return success;\n            },\n            val: function val(newVal) {\n                var query;\n                if (!arguments.length) {\n                    ttEach(this.first(), function(t) {\n                        query = t.getVal();\n                    });\n                    return query;\n                } else {\n                    ttEach(this, function(t) {\n                        t.setVal(_.toStr(newVal));\n                    });\n                    return this;\n                }\n            },\n            destroy: function destroy() {\n                ttEach(this, function(typeahead, $input) {\n                    revert($input);\n                    typeahead.destroy();\n                });\n                return this;\n            }\n        };\n        $.fn.typeahead = function(method) {\n            if (methods[method]) {\n                return methods[method].apply(this, [].slice.call(arguments, 1));\n            } else {\n                return methods.initialize.apply(this, arguments);\n            }\n        };\n        $.fn.typeahead.noConflict = function noConflict() {\n            $.fn.typeahead = old;\n            return this;\n        };\n        function ttEach($els, fn) {\n            $els.each(function() {\n                var $input = $(this), typeahead;\n                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);\n            });\n        }\n        function buildHintFromInput($input, www) {\n            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop({\n                readonly: true,\n                required: false\n            }).removeAttr(\"id name placeholder\").removeClass(\"required\").attr({\n                spellcheck: \"false\",\n                tabindex: -1\n            });\n        }\n        function prepInput($input, www) {\n            $input.data(keys.attrs, {\n                dir: $input.attr(\"dir\"),\n                autocomplete: $input.attr(\"autocomplete\"),\n                spellcheck: $input.attr(\"spellcheck\"),\n                style: $input.attr(\"style\")\n            });\n            $input.addClass(www.classes.input).attr({\n                spellcheck: false\n            });\n            try {\n                !$input.attr(\"dir\") && $input.attr(\"dir\", \"auto\");\n            } catch (e) {}\n            return $input;\n        }\n        function getBackgroundStyles($el) {\n            return {\n                backgroundAttachment: $el.css(\"background-attachment\"),\n                backgroundClip: $el.css(\"background-clip\"),\n                backgroundColor: $el.css(\"background-color\"),\n                backgroundImage: $el.css(\"background-image\"),\n                backgroundOrigin: $el.css(\"background-origin\"),\n                backgroundPosition: $el.css(\"background-position\"),\n                backgroundRepeat: $el.css(\"background-repeat\"),\n                backgroundSize: $el.css(\"background-size\")\n            };\n        }\n        function revert($input) {\n            var www, $wrapper;\n            www = $input.data(keys.www);\n            $wrapper = $input.parent().filter(www.selectors.wrapper);\n            _.each($input.data(keys.attrs), function(val, key) {\n                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);\n            });\n            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);\n            if ($wrapper.length) {\n                $input.detach().insertAfter($wrapper);\n                $wrapper.remove();\n            }\n        }\n        function $elOrNull(obj) {\n            var isValid, $el;\n            isValid = _.isJQuery(obj) || _.isElement(obj);\n            $el = isValid ? $(obj).first() : [];\n            return $el.length ? $el : null;\n        }\n    })();\n});","// ::- Persistent data structure representing an ordered mapping from\n// strings to values, with some convenient update methods.\nfunction OrderedMap(content) {\n  this.content = content;\n}\n\nOrderedMap.prototype = {\n  constructor: OrderedMap,\n\n  find: function(key) {\n    for (var i = 0; i < this.content.length; i += 2)\n      if (this.content[i] === key) return i\n    return -1\n  },\n\n  // :: (string)  ?any\n  // Retrieve the value stored under `key`, or return undefined when\n  // no such key exists.\n  get: function(key) {\n    var found = this.find(key);\n    return found == -1 ? undefined : this.content[found + 1]\n  },\n\n  // :: (string, any, ?string)  OrderedMap\n  // Create a new map by replacing the value of `key` with a new\n  // value, or adding a binding to the end of the map. If `newKey` is\n  // given, the key of the binding will be replaced with that key.\n  update: function(key, value, newKey) {\n    var self = newKey && newKey != key ? this.remove(newKey) : this;\n    var found = self.find(key), content = self.content.slice();\n    if (found == -1) {\n      content.push(newKey || key, value);\n    } else {\n      content[found + 1] = value;\n      if (newKey) content[found] = newKey;\n    }\n    return new OrderedMap(content)\n  },\n\n  // :: (string)  OrderedMap\n  // Return a map with the given key removed, if it existed.\n  remove: function(key) {\n    var found = this.find(key);\n    if (found == -1) return this\n    var content = this.content.slice();\n    content.splice(found, 2);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, any)  OrderedMap\n  // Add a new key to the start of the map.\n  addToStart: function(key, value) {\n    return new OrderedMap([key, value].concat(this.remove(key).content))\n  },\n\n  // :: (string, any)  OrderedMap\n  // Add a new key to the end of the map.\n  addToEnd: function(key, value) {\n    var content = this.remove(key).content.slice();\n    content.push(key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, string, any)  OrderedMap\n  // Add a key after the given key. If `place` is not found, the new\n  // key is added to the end.\n  addBefore: function(place, key, value) {\n    var without = this.remove(key), content = without.content.slice();\n    var found = without.find(place);\n    content.splice(found == -1 ? content.length : found, 0, key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: ((key: string, value: any))\n  // Call the given function for each key/value pair in the map, in\n  // order.\n  forEach: function(f) {\n    for (var i = 0; i < this.content.length; i += 2)\n      f(this.content[i], this.content[i + 1]);\n  },\n\n  // :: (union<Object, OrderedMap>)  OrderedMap\n  // Create a new map by prepending the keys in this map that don't\n  // appear in `map` before the keys in `map`.\n  prepend: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(map.content.concat(this.subtract(map).content))\n  },\n\n  // :: (union<Object, OrderedMap>)  OrderedMap\n  // Create a new map by appending the keys in this map that don't\n  // appear in `map` after the keys in `map`.\n  append: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(this.subtract(map).content.concat(map.content))\n  },\n\n  // :: (union<Object, OrderedMap>)  OrderedMap\n  // Create a map containing all the keys in this map that don't\n  // appear in `map`.\n  subtract: function(map) {\n    var result = this;\n    map = OrderedMap.from(map);\n    for (var i = 0; i < map.content.length; i += 2)\n      result = result.remove(map.content[i]);\n    return result\n  },\n\n  // :: number\n  // The amount of keys in this map.\n  get size() {\n    return this.content.length >> 1\n  }\n};\n\n// :: (?union<Object, OrderedMap>)  OrderedMap\n// Return a map with the given content. If null, create an empty\n// map. If given an ordered map, return that map itself. If given an\n// object, create a map from the object's properties.\nOrderedMap.from = function(value) {\n  if (value instanceof OrderedMap) return value\n  var content = [];\n  if (value) for (var prop in value) content.push(prop, value[prop]);\n  return new OrderedMap(content)\n};\n\nvar orderedmap = OrderedMap;\n\nexport default orderedmap;\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","/**\n * The editor class name\n */\nvar EDITOR_CLASS_NAME = 'remirror-editor';\n/**\n * The editor class selector\n */\n\nvar EDITOR_CLASS_SELECTOR = \".\".concat(EDITOR_CLASS_NAME);\n/**\n * The css class added to a node that is selected.\n */\n\nvar SELECTED_NODE_CLASS_NAME = 'ProseMirror-selectednode';\n/**\n * The css selector for a selected node.\n */\n\nvar SELECTED_NODE_CLASS_SELECTOR = \".\".concat(SELECTED_NODE_CLASS_NAME);\n/**\n * Explanation from `@atlaskit` ProseMirror uses the Unicode Character 'OBJECT\n * REPLACEMENT CHARACTER' (U+FFFC) as text representation for leaf nodes, i.e.\n * nodes that don't have any content or text property (e.g. hardBreak, emoji,\n * mention, rule) It was introduced because of\n * https://github.com/ProseMirror/prosemirror/issues/262 This can be used in an\n * input rule regex to be able to include or exclude such nodes.\n */\n\nvar LEAF_NODE_REPLACING_CHARACTER = \"\\uFFFC\";\n/**\n * The null character.\n *\n * See {@link https://stackoverflow.com/a/6380172}\n */\n\nvar NULL_CHARACTER = '\\0';\n/**\n * A character useful for separating inline nodes.\n *\n * @remarks\n * Typically used in decorations as follows.\n *\n * ```ts\n * document.createTextNode(ZERO_WIDTH_SPACE_CHAR)\n * ```\n *\n * This produces the html entity '8203'\n */\n\nvar ZERO_WIDTH_SPACE_CHAR = \"\\u200B\";\n/**\n * Used to determine the side where a gap-cursor is drawn\n */\n\nvar Side;\n/**\n * A default empty object node. Useful for resetting the content of a\n * prosemirror document.\n */\n\n(function (Side) {\n  Side[\"LEFT\"] = \"left\";\n  Side[\"RIGHT\"] = \"right\";\n})(Side || (Side = {}));\n\nvar EMPTY_PARAGRAPH_NODE = {\n  type: 'doc',\n  content: [{\n    type: 'paragraph'\n  }]\n};\n/**\n * The default extension priority level\n */\n\nvar DEFAULT_EXTENSION_PRIORITY = 3;\n/**\n * Marks are categorized into different groups. One motivation for this was to\n * allow the `code` mark to exclude other marks, without needing to explicitly\n * name them. Explicit naming requires the named mark to exist in the schema.\n * This is undesirable because we want to construct different schemas that have\n * different sets of nodes/marks.\n */\n\nvar MarkGroup;\n\n(function (MarkGroup) {\n  MarkGroup[\"FontStyle\"] = \"fontStyle\";\n  MarkGroup[\"Link\"] = \"link\";\n  MarkGroup[\"Color\"] = \"color\";\n  MarkGroup[\"Alignment\"] = \"alignment\";\n  MarkGroup[\"Indentation\"] = \"indentation\";\n  MarkGroup[\"Behavior\"] = \"behavior\";\n  MarkGroup[\"Code\"] = \"code\";\n})(MarkGroup || (MarkGroup = {}));\n\nvar NodeGroup;\n/**\n * Defines the type of the extension.\n */\n\n(function (NodeGroup) {\n  NodeGroup[\"Inline\"] = \"inline\";\n  NodeGroup[\"Block\"] = \"block\";\n})(NodeGroup || (NodeGroup = {}));\n\nvar ExtensionType;\n/**\n * These are the default supported tag strings which help categorize different\n * behaviors that extensions can exhibit.\n *\n * @remarks\n *\n * Any extension can register itself with multiple such behaviors and these\n * categorizations can be used by other extensions when running commands and\n * updating the document.\n */\n\n(function (ExtensionType) {\n  ExtensionType[\"Node\"] = \"node\";\n  ExtensionType[\"Mark\"] = \"mark\";\n  ExtensionType[\"Plain\"] = \"plain\";\n})(ExtensionType || (ExtensionType = {}));\n\nvar Tags;\n/**\n * The toString return value for any created remirror class.\n */\n\n(function (Tags) {\n  Tags[\"LastNodeCompatible\"] = \"lastNodeCompatible\";\n  Tags[\"FormattingMark\"] = \"formattingMark\";\n  Tags[\"FormattingNode\"] = \"formattingNode\";\n  Tags[\"NodeCursor\"] = \"nodeCursor\";\n})(Tags || (Tags = {}));\n\nvar RemirrorClassName;\n\n(function (RemirrorClassName) {\n  RemirrorClassName[\"Extension\"] = \"$$RemirrorExtension\";\n})(RemirrorClassName || (RemirrorClassName = {}));\n\nexport { DEFAULT_EXTENSION_PRIORITY, EDITOR_CLASS_NAME, EDITOR_CLASS_SELECTOR, EMPTY_PARAGRAPH_NODE, ExtensionType, LEAF_NODE_REPLACING_CHARACTER, MarkGroup, NULL_CHARACTER, NodeGroup, RemirrorClassName, SELECTED_NODE_CLASS_NAME, SELECTED_NODE_CLASS_SELECTOR, Side, Tags, ZERO_WIDTH_SPACE_CHAR };\n//# sourceMappingURL=core-constants.esm.js.map\n","import _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport { bool, isObject, isNullOrUndefined, isNumber, Cast, isString, isFunction, keys, findMatches } from '@remirror/core-helpers';\nimport { lift, wrapIn, setBlockType } from 'prosemirror-commands';\nimport { liftListItem, wrapInList } from 'prosemirror-schema-list';\nimport _construct from '@babel/runtime/helpers/construct';\nimport { EMPTY_PARAGRAPH_NODE } from '@remirror/core-constants';\nimport minDocument from 'min-document';\nimport { NodeType, MarkType, Node as Node$1, Schema, ResolvedPos, Fragment, DOMSerializer, DOMParser, Slice } from 'prosemirror-model';\nimport { EditorState, TextSelection, Selection, NodeSelection, Plugin } from 'prosemirror-state';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { isUndefined } from 'util';\nimport { InputRule } from 'prosemirror-inputrules';\n\n/// <reference types=\"node\" />\n/**\n * A object with flags identifying the current environment.\n *\n * @public\n */\n\nvar environment = {\n  /**\n   * Verifies that the environment has both a window and window.document\n   */\n  get isBrowser() {\n    return bool(typeof window !== 'undefined' && typeof window.document !== 'undefined' && window.navigator && window.navigator.userAgent);\n  },\n\n  /**\n   * Verifies that the environment is JSDOM\n   */\n  get isJSDOM() {\n    return environment.isBrowser && window.navigator.userAgent.includes('jsdom');\n  },\n\n  /**\n   * Verifies that the environment has a nodejs process and is therefore a node environment\n   */\n  get isNode() {\n    return typeof process !== 'undefined' && process.versions != null && process.versions.node != null;\n  },\n\n  /**\n   * True when running on macOS\n   */\n  get isMac() {\n    return environment.isBrowser && /Mac|iPod|iPhone|iPad/.test(navigator.platform);\n  },\n\n  /**\n   * Verify that this is an apple device either on the client or server.\n   */\n  get isApple() {\n    return environment.isNode ? process.platform === 'darwin' : environment.isBrowser ? /Mac|iPod|iPhone|iPad/.test(window.navigator.platform) : false;\n  },\n\n  /**\n   * True when running in DEVELOPMENT environment\n   */\n  get isDevelopment() {\n    return process.env.NODE_ENV === 'development';\n  },\n\n  /**\n   * True when running unit tests\n   */\n  get isTest() {\n    return process.env.NODE_ENV === 'test';\n  },\n\n  /**\n   * True when running in PRODUCTION environment\n   */\n  get isProduction() {\n    return process.env.NODE_ENV === 'production';\n  }\n\n};\n\n/**\n * Check to see if the passed value is a NodeType.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNodeType = function isNodeType(value) {\n  return isObject(value) && value instanceof NodeType;\n};\n/**\n * Check to see if the passed value is a MarkType.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isMarkType = function isMarkType(value) {\n  return isObject(value) && value instanceof MarkType;\n};\n/**\n * Checks to see if the passed value is a ProsemirrorNode\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isProsemirrorNode = function isProsemirrorNode(value) {\n  return isObject(value) && value instanceof Node$1;\n};\n/**\n * Checks to see if the passed value is a Prosemirror Editor State\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isEditorState = function isEditorState(value) {\n  return isObject(value) && value instanceof EditorState;\n};\n/**\n * Checks to see if the passed value is an instance of the editor schema\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isEditorSchema = function isEditorSchema(value) {\n  return isObject(value) && value instanceof Schema;\n};\n/**\n * Predicate checking whether the selection is a TextSelection\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isTextSelection = function isTextSelection(value) {\n  return isObject(value) && value instanceof TextSelection;\n};\n/**\n * Predicate checking whether the value is a Selection\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isSelection = function isSelection(value) {\n  return isObject(value) && value instanceof Selection;\n};\n/**\n * Predicate checking whether the value is a ResolvedPosition.\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isResolvedPos = function isResolvedPos(value) {\n  return isObject(value) && value instanceof ResolvedPos;\n};\n/**\n * Predicate checking whether the selection is a NodeSelection\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isNodeSelection = function isNodeSelection(value) {\n  return isObject(value) && value instanceof NodeSelection;\n};\n\n/**\n * Checks that a mark is active within the selected region, or the current selection point is within a\n * region with the mark active. Used by extensions to implement their active methods.\n *\n * @remarks\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param state - the editor state\n * @param type - the mark type\n *\n * @public\n */\nvar isMarkActive = function isMarkActive(_ref) {\n  var state = _ref.state,\n      type = _ref.type,\n      from = _ref.from,\n      to = _ref.to;\n  var selection = state.selection,\n      doc = state.doc,\n      storedMarks = state.storedMarks;\n  var $from = selection.$from,\n      empty = selection.empty;\n\n  if (from && to) {\n    try {\n      return Math.max(from, to) < doc.nodeSize && doc.rangeHasMark(from, to, type);\n    } catch (_unused) {\n      return false;\n    }\n  }\n\n  if (empty) {\n    return bool(type.isInSet(storedMarks !== null && storedMarks !== void 0 ? storedMarks : $from.marks()));\n  }\n\n  return doc.rangeHasMark(selection.from, selection.to, type);\n};\n/**\n * Check if the specified type (NodeType) can be inserted at the current selection point.\n *\n * @remarks\n *\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param state - the editor state\n * @param type - the node type\n *\n * @public\n */\n\nvar canInsertNode = function canInsertNode(state, type) {\n  var $from = state.selection.$from;\n\n  for (var depth = $from.depth; depth >= 0; depth--) {\n    var index = $from.index(depth);\n\n    try {\n      if ($from.node(depth).canReplaceWith(index, index, type)) {\n        return true;\n      }\n    } catch (_unused2) {\n      return false;\n    }\n  }\n\n  return false;\n};\n/**\n * Checks if a node looks like an empty document\n *\n * @param node - the prosemirror node\n *\n * @public\n */\n\nvar isDocNodeEmpty = function isDocNodeEmpty(node) {\n  var nodeChild = node.content.firstChild;\n\n  if (node.childCount !== 1 || !nodeChild) {\n    return false;\n  }\n\n  return nodeChild.type.isBlock && !nodeChild.childCount && nodeChild.nodeSize === 2 && (isNullOrUndefined(nodeChild.marks) || nodeChild.marks.length === 0);\n};\n/**\n * Checks if the current node a paragraph node and empty\n *\n * @param node - the prosemirror node\n *\n * @public\n */\n\nvar isEmptyParagraphNode = function isEmptyParagraphNode(node) {\n  return !isProsemirrorNode(node) || node.type.name === 'paragraph' && !node.textContent && !node.childCount;\n};\n/**\n * Retrieve the attributes for a mark.\n *\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param state - the editor state\n * @param type - the mark type\n */\n\nvar getMarkAttrs = function getMarkAttrs(state, type) {\n  var _state$selection = state.selection,\n      from = _state$selection.from,\n      to = _state$selection.to;\n  var marks = [];\n  state.doc.nodesBetween(from, to, function (node) {\n    marks = [].concat(_toConsumableArray(marks), _toConsumableArray(node.marks));\n  });\n  var mark = marks.find(function (markItem) {\n    return markItem.type.name === type.name;\n  });\n\n  if (mark) {\n    return mark.attrs;\n  }\n\n  return {};\n};\n/**\n * Retrieve the start and end position of a mark\n *\n * @remarks\n *\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param pmPosition - the resolved prosemirror position\n * @param type - the mark type\n */\n\nvar getMarkRange = function getMarkRange() {\n  var pmPosition = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n  if (!pmPosition || !type) {\n    return false;\n  }\n\n  var start = pmPosition.parent.childAfter(pmPosition.parentOffset);\n\n  if (!start.node) {\n    return false;\n  }\n\n  var mark = start.node.marks.find(function (_ref2) {\n    var markType = _ref2.type;\n    return markType === type;\n  });\n\n  if (!mark) {\n    return false;\n  }\n\n  var startIndex = pmPosition.index();\n  var startPos = pmPosition.start() + start.offset;\n\n  while (startIndex > 0 && mark.isInSet(pmPosition.parent.child(startIndex - 1).marks)) {\n    startIndex -= 1;\n    startPos -= pmPosition.parent.child(startIndex).nodeSize;\n  }\n\n  var endPos = startPos + start.node.nodeSize;\n  return {\n    from: startPos,\n    to: endPos\n  };\n};\n/**\n * Retrieves the text content from a slice\n *\n * @remarks\n * A utility that's useful for pulling text content from a slice which is usually created via `selection.content()`\n *\n * @param slice - the prosemirror slice\n *\n * @public\n */\n\nvar getTextContentFromSlice = function getTextContentFromSlice(slice) {\n  var node = slice.content.firstChild;\n  return node ? node.textContent : '';\n};\n/**\n * Takes an empty selection and expands it out to the nearest group not matching the excluded characters.\n *\n * @remarks\n *\n * Can be used to find the nearest selected word. See {@link getSelectedWord}\n *\n * @param state - the editor state\n * @param exclude - the regex pattern to exclude\n * @returns false if not a text selection or if no expansion available\n *\n * @public\n */\n\nvar getSelectedGroup = function getSelectedGroup(state, exclude) {\n  if (!isTextSelection(state.selection)) {\n    return false;\n  }\n\n  var _state$selection2 = state.selection,\n      from = _state$selection2.from,\n      to = _state$selection2.to;\n\n  var getChar = function getChar(start, end) {\n    return getTextContentFromSlice(TextSelection.create(state.doc, start, end).content());\n  };\n\n  for (var _char = getChar(from - 1, from); _char && !exclude.test(_char); from--, _char = getChar(from - 1, from)) {// Step backwards until reaching first excluded character or empty text content.\n  }\n\n  for (var _char2 = getChar(to, to + 1); _char2 && !exclude.test(_char2); to++, _char2 = getChar(to, to + 1)) {// Step forwards until reaching the first excluded character or empty text content\n  }\n\n  if (from === to) {\n    return false;\n  }\n\n  return {\n    from: from,\n    to: to\n  };\n};\n/**\n * Retrieves the nearest space separated word from the current selection.\n *\n * @remarks\n *\n * This always expands outward so that given:\n * `The tw<start>o words<end>`\n * The selection would become\n * `The <start>two words<end>`\n *\n * In other words it expands until it meets an invalid character.\n *\n * @param state - the editor state\n *\n * @public\n */\n\nvar getSelectedWord = function getSelectedWord(state) {\n  return getSelectedGroup(state, /[\\s\\0]/);\n};\n/**\n * Retrieve plugin state of specified type\n *\n * @param plugin - the plugin or plugin key\n * @param state - the editor state\n *\n * @public\n */\n\nvar getPluginState = function getPluginState(plugin, state) {\n  return plugin.getState(state);\n};\n/**\n * Retrieve plugin meta data of specified type\n *\n * @param key - the plugin key\n * @param tr - the transaction to retrieve from\n *\n * @public\n */\n\nvar getPluginMeta = function getPluginMeta(key, tr) {\n  return tr.getMeta(key);\n};\n/**\n * Set the plugin meta data\n *\n * @param key - the plugin key\n * @param tr - the transaction\n * @param data - the data to set\n *\n * @public\n */\n\nvar setPluginMeta = function setPluginMeta(key, tr, data) {\n  return tr.setMeta(key, data);\n};\n/**\n * Get matching string from a list or single value\n *\n * @remarks\n * Get attrs can be called with a direct match string or array of string matches.\n * This method should be used to retrieve the required string.\n *\n * The index of the matched array used defaults to 0 but can be updated via the second parameter.\n *\n * @param match - the match(es)\n * @param index - the zero-index point from which to start\n *\n * @public\n */\n\nvar getMatchString = function getMatchString(match) {\n  var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  return Array.isArray(match) ? match[index] : match;\n};\n/**\n * Checks whether the passed value is a valid dom node\n *\n * @param domNode - the dom node\n *\n * @public\n */\n\nvar isDOMNode = function isDOMNode(domNode) {\n  return isObject(Node) ? domNode instanceof Node : isObject(domNode) && isNumber(Cast(domNode).nodeType) && isString(Cast(domNode).nodeName);\n};\n/**\n * Checks for an element node like `<p>` or `<div>`.\n *\n * @param domNode - the dom node\n *\n * @public\n */\n\nvar isElementDOMNode = function isElementDOMNode(domNode) {\n  return isDOMNode(domNode) && domNode.nodeType === Node.ELEMENT_NODE;\n};\n/**\n * Finds the closest element which matches the passed selector\n *\n * @param domNode - the dom node\n * @param selector - the selector\n *\n * @public\n */\n\nvar closestElement = function closestElement(domNode, selector) {\n  if (!isElementDOMNode(domNode)) {\n    return null;\n  }\n\n  if (isNullOrUndefined(document.documentElement) || !document.documentElement.contains(domNode)) {\n    return null;\n  }\n\n  var matches = isFunction(domNode.matches) ? 'matches' : Cast('msMatchesSelector');\n\n  do {\n    var _domNode$parentElemen;\n\n    if (isFunction(domNode[matches]) && domNode[matches](selector)) {\n      return domNode;\n    }\n\n    domNode = (_domNode$parentElemen = domNode.parentElement) !== null && _domNode$parentElemen !== void 0 ? _domNode$parentElemen : domNode.parentNode;\n  } while (isElementDOMNode(domNode));\n\n  return null;\n};\n/**\n * Checks for a text node.\n *\n * @param domNode - the dom node\n *\n * @public\n */\n\nvar isTextDOMNode = function isTextDOMNode(domNode) {\n  return isDOMNode(domNode) && domNode.nodeType === Node.TEXT_NODE;\n};\nvar getOffsetParent = function getOffsetParent(_ref3) {\n  var view = _ref3.view,\n      element = _ref3.element;\n  return isNullOrUndefined(element) ? view.dom.offsetParent : element.offsetParent;\n};\n/**\n * Retrieve the line height from a an element\n *\n * @param params - the element params\n */\n\nvar getLineHeight = function getLineHeight(_ref4) {\n  var element = _ref4.element;\n  return parseFloat(window.getComputedStyle(element, undefined).lineHeight || '');\n};\n\n/**\n * Retrieve the absolute coordinates\n *\n * @remarks\n *\n * We need to translate the co-ordinates because `coordsAtPos` returns co-ordinates\n * relative to `window`. And, also need to adjust the cursor container height.\n * (0, 0)\n *\n * ```\n * +--------------------- [window] ---------------------+\n * |   (left, top) +-------- [Offset Parent] --------+  |\n * | {coordsAtPos} | [Cursor]   <- cursorHeight      |  |\n * |               | [FloatingToolbar]               |  |\n * ```\n *\n * @param params - see {@link AbsoluteCoordinatesParams}.\n */\nvar absoluteCoordinates = function absoluteCoordinates(_ref5) {\n  var view = _ref5.view,\n      element = _ref5.element,\n      position = _ref5.position,\n      _ref5$cursorHeight = _ref5.cursorHeight,\n      cursorHeight = _ref5$cursorHeight === void 0 ? getLineHeight({\n    element: element\n  }) : _ref5$cursorHeight;\n  var offsetParent = getOffsetParent({\n    view: view,\n    element: element\n  });\n  var box = offsetParent.getBoundingClientRect();\n  return {\n    left: position.left - box.left,\n    right: position.right - box.left,\n    top: position.top - (box.top - cursorHeight) + offsetParent.scrollTop,\n    bottom: box.height - (position.top - (box.top - cursorHeight) - offsetParent.scrollTop)\n  };\n};\n/**\n * Retrieve the nearest non-text node\n *\n * @param domNode - the dom node\n */\n\nvar getNearestNonTextNode = function getNearestNonTextNode(domNode) {\n  return isTextDOMNode(domNode) ? domNode.parentNode : domNode;\n};\n/**\n * Checks whether the cursor is at the end of the state.doc\n *\n * @param state - the editor state\n */\n\nvar atDocEnd = function atDocEnd(state) {\n  return state.doc.nodeSize - state.selection.$to.pos - 2 === state.selection.$to.depth;\n};\n/**\n * Checks whether the cursor is at the beginning of the state.doc\n *\n * @param state - the editor state\n */\n\nvar atDocStart = function atDocStart(state) {\n  return state.selection.$from.pos === state.selection.$from.depth;\n};\n/**\n * Get the start position of the parent of the current resolve position\n *\n * @param pmPosition - the resolved prosemirror position\n */\n\nvar startPositionOfParent = function startPositionOfParent(pmPosition) {\n  return pmPosition.start(pmPosition.depth);\n};\n/**\n * Get the end position of the parent of the current resolve position\n *\n * @param pmPosition - the resolved prosemirror position\n *\n * @public\n */\n\nvar endPositionOfParent = function endPositionOfParent(pmPosition) {\n  return pmPosition.end(pmPosition.depth) + 1;\n};\n/**\n * Retrieve the current position of the cursor\n *\n * @param selection - the editor selection\n * @returns a resolved position only when the selection is a text selection\n *\n * @public\n */\n\nvar getCursor = function getCursor(selection) {\n  return isTextSelection(selection) ? selection.$cursor : undefined;\n};\n/**\n * Checks to see whether a nodeMatch checker is a tuple\n *\n * @remarks\n * A node matcher can either be a string, a function a regex or a regex tuple. This check for the latter two.\n *\n * @param nodeMatch - the node match\n *\n * @public\n */\n\nvar isRegexTuple = function isRegexTuple(nodeMatch) {\n  return Array.isArray(nodeMatch) && nodeMatch.length > 0 && nodeMatch.length <= 2;\n};\n/**\n * Test the passed in regexp tuple\n *\n * @param tuple - a regex tuple\n * @param value - the string to test against\n *\n * @public\n */\n\n\nvar regexTest = function regexTest(tuple, value) {\n  var regex = _construct(RegExp, _toConsumableArray(tuple));\n\n  return regex.test(value);\n};\n/**\n * Checks to see whether the name of the passed node matches anything in the list provided.\n *\n * @param node - the prosemirror node\n * @param nodeMatches - the node matches array\n * @returns true if the node name is a match to any of the items in the nodeMatches array\n *\n * @public\n */\n\n\nvar nodeNameMatchesList = function nodeNameMatchesList(node, nodeMatches) {\n  var outcome = false;\n\n  if (!node) {\n    return outcome;\n  }\n\n  var name = node.type.name;\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = nodeMatches[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var checker = _step.value;\n      outcome = isRegexTuple(checker) ? regexTest(checker, name) : isFunction(checker) ? checker(name, node) : checker === name;\n\n      if (outcome) {\n        return outcome;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return outcome;\n};\n/**\n * Checks whether a Prosemirror node is the top level `doc` node\n *\n * @param node - the prosemirror node\n * @param schema - the prosemirror schema\n *\n * @public\n */\n\nvar isDocNode = function isDocNode(node, schema) {\n  return isProsemirrorNode(node) && (schema ? node.type === schema.nodes.doc : node.type.name === 'doc');\n};\n/**\n * Checks whether the passed in JSON is a valid object node\n *\n * @param value - the value to check\n *\n * @public\n */\n\nvar isObjectNode = function isObjectNode(value) {\n  return isObject(value) && value.type === 'doc' && Array.isArray(value.content);\n};\n\nvar fallbackContent = function fallbackContent(_ref6) {\n  var fallback = _ref6.fallback,\n      schema = _ref6.schema;\n  return isProsemirrorNode(fallback) ? fallback : schema.nodeFromJSON(fallback);\n};\n/**\n * Creates a document node from the passed in content and schema.\n *\n * @param params - the destructured create document node params\n *\n * @public\n */\n\n\nvar createDocumentNode = function createDocumentNode(_ref7) {\n  var content = _ref7.content,\n      schema = _ref7.schema,\n      doc = _ref7.doc,\n      stringHandler = _ref7.stringHandler,\n      _ref7$fallback = _ref7.fallback,\n      fallback = _ref7$fallback === void 0 ? EMPTY_PARAGRAPH_NODE : _ref7$fallback;\n\n  if (isProsemirrorNode(content)) {\n    return content;\n  }\n\n  if (isObjectNode(content)) {\n    try {\n      return schema.nodeFromJSON(content);\n    } catch (e) {\n      console.error(e);\n      return fallbackContent({\n        fallback: fallback,\n        schema: schema\n      });\n    }\n  }\n\n  if (isString(content) && stringHandler) {\n    return stringHandler({\n      doc: doc,\n      content: content,\n      schema: schema\n    });\n  }\n\n  return fallbackContent({\n    fallback: fallback,\n    schema: schema\n  });\n};\n/**\n * Checks which environment should be used. Returns true when we are in the dom environment.\n *\n * @param forceEnvironment - force a specific environment to override the outcome\n */\n\nvar shouldUseDOMEnvironment = function shouldUseDOMEnvironment(forceEnvironment) {\n  return forceEnvironment === 'dom' || environment.isBrowser && !forceEnvironment;\n};\n/**\n * Retrieves the document based on the environment we are currently in.\n *\n * @param forceEnvironment - force a specific environment\n */\n\nvar getDocument = function getDocument(forceEnvironment) {\n  return shouldUseDOMEnvironment(forceEnvironment) ? document : minDocument;\n};\n\n/**\n * Convert a node into its DOM representative\n *\n * @param params - the from node params\n *\n * @public\n */\nvar toDOM = function toDOM(_ref8) {\n  var node = _ref8.node,\n      schema = _ref8.schema,\n      doc = _ref8.doc;\n  var fragment = isDocNode(node, schema) ? node.content : Fragment.from(node);\n  return DOMSerializer.fromSchema(schema).serializeFragment(fragment, {\n    document: doc\n  });\n};\n\n/**\n * Convert a prosemirror node into it's HTML contents\n *\n * @param params - the from node params\n *\n * @public\n */\nvar toHTML = function toHTML(_ref9) {\n  var node = _ref9.node,\n      schema = _ref9.schema,\n      _ref9$doc = _ref9.doc,\n      doc = _ref9$doc === void 0 ? getDocument() : _ref9$doc;\n  var element = doc.createElement('div');\n  element.appendChild(toDOM({\n    node: node,\n    schema: schema,\n    doc: doc\n  }));\n  return element.innerHTML;\n};\n\n/**\n * Convert a HTML string into Prosemirror node\n *\n * @param params - the from html params\n *\n * @public\n */\nvar fromHTML = function fromHTML(_ref10) {\n  var content = _ref10.content,\n      schema = _ref10.schema,\n      _ref10$doc = _ref10.doc,\n      doc = _ref10$doc === void 0 ? getDocument() : _ref10$doc;\n  var element = doc.createElement('div');\n  element.innerHTML = content.trim();\n  return DOMParser.fromSchema(schema).parse(element);\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n/* \"Borrowed\" from prosemirror-utils in order to avoid requirement of\n`@prosemirror-tables`*/\n\n/**\n * Checks if the type a given `node` equals to a given `nodeType`.\n */\nvar nodeEqualsType = function nodeEqualsType(_ref) {\n  var types = _ref.types,\n      node = _ref.node;\n  return node ? Array.isArray(types) && types.includes(node.type) || node.type === types : false;\n};\n/**\n * Creates a new transaction object from a given transaction\n *\n * @param tr - the prosemirror transaction\n *\n * @public\n */\n\nvar cloneTransaction = function cloneTransaction(tr) {\n  return Object.assign(Object.create(tr), tr).setTime(Date.now());\n};\n\n/**\n * Returns a `delete` transaction that removes a node at a given position with\n * the given `node`. `position` should point at the position immediately before\n * the node.\n *\n * @param position - the prosemirror position\n *\n * @public\n */\nvar removeNodeAtPosition = function removeNodeAtPosition(_ref2) {\n  var pos = _ref2.pos,\n      tr = _ref2.tr;\n  var node = tr.doc.nodeAt(pos);\n\n  if (!node) {\n    return tr;\n  }\n\n  return cloneTransaction(tr[\"delete\"](pos, pos + node.nodeSize));\n};\n/**\n * Returns DOM reference of a node at a given `position`.\n *\n * @remarks\n *\n * If the node type is of type `TEXT_NODE` it will return the reference of the\n * parent node.\n *\n * A simple use case\n *\n * ```ts\n * const element = findElementAtPosition($from.pos, view);\n * ```\n *\n * @param position - the prosemirror position\n * @param view - the editor view\n *\n * @public\n */\n\nvar findElementAtPosition = function findElementAtPosition(position, view) {\n  var dom = view.domAtPos(position);\n  var node = dom.node.childNodes[dom.offset];\n\n  if (isTextDOMNode(dom.node)) {\n    return dom.node.parentNode;\n  }\n\n  if (isNullOrUndefined(node) || isTextDOMNode(node)) {\n    return dom.node;\n  }\n\n  return node;\n};\n/**\n * Iterates over parent nodes, returning the closest node and its start position\n * that the `predicate` returns truthy for. `start` points to the start position\n * of the node, `pos` points directly before the node.\n *\n * ```ts\n * const predicate = node => node.type === schema.nodes.blockquote;\n * const parent = findParentNode({predicate, selection});\n * ```\n */\n\nvar findParentNode = function findParentNode(_ref3) {\n  var predicate = _ref3.predicate,\n      selection = _ref3.selection;\n  var $from = selection.$from;\n\n  for (var depth = $from.depth; depth > 0; depth--) {\n    var node = $from.node(depth);\n\n    if (predicate(node)) {\n      var pos = depth > 0 ? $from.before(depth) : 0;\n      var start = $from.start(depth);\n      var end = pos + node.nodeSize;\n      return {\n        pos: pos,\n        depth: depth,\n        node: node,\n        start: start,\n        end: end\n      };\n    }\n  }\n\n  return;\n};\n/**\n * Finds the node at the resolved position.\n *\n * @param $pos - the resolve position in the document\n */\n\nvar findNodeAtPosition = function findNodeAtPosition($pos) {\n  var depth = $pos.depth;\n  var pos = depth > 0 ? $pos.before(depth) : 0;\n  var node = $pos.node(depth);\n  var start = $pos.start(depth);\n  var end = pos + node.nodeSize;\n  return {\n    pos: pos,\n    start: start,\n    node: node,\n    end: end,\n    depth: depth\n  };\n};\n/**\n * Finds the node at the passed selection.\n */\n\nvar findNodeAtSelection = function findNodeAtSelection(selection) {\n  var parentNode = findParentNode({\n    predicate: function predicate() {\n      return true;\n    },\n    selection: selection\n  });\n\n  if (isUndefined(parentNode)) {\n    throw new Error('No parent node found for the selection provided.');\n  }\n\n  return parentNode;\n};\n/**\n * Finds the node at the end of the Prosemirror document.\n *\n * @param doc - the parent doc node of the editor which contains all the other\n * nodes.\n *\n * @deprecated use `doc.lastChild` instead\n */\n\nvar findNodeAtEndOfDoc = function findNodeAtEndOfDoc(doc) {\n  return findNodeAtPosition(Selection.atEnd(doc).$from);\n};\n/**\n * Finds the node at the start of the prosemirror.\n *\n * @param doc - the parent doc node of the editor which contains all the other\n * nodes.\n *\n * @deprecated use `doc.firstChild` instead\n */\n\nvar findNodeAtStartOfDoc = function findNodeAtStartOfDoc(doc) {\n  return findNodeAtPosition(Selection.atStart(doc).$from);\n};\n\n/**\n *  Iterates over parent nodes, returning closest node of a given `nodeType`.\n *  `start` points to the start position of the node, `pos` points directly\n *  before the node.\n *\n *  ```ts\n *  const parent = findParentNodeOfType({types: schema.nodes.paragraph, selection});\n *  ```\n */\nvar findParentNodeOfType = function findParentNodeOfType(_ref4) {\n  var types = _ref4.types,\n      selection = _ref4.selection;\n  return findParentNode({\n    predicate: function predicate(node) {\n      return nodeEqualsType({\n        types: types,\n        node: node\n      });\n    },\n    selection: selection\n  });\n};\n/**\n * Returns position of the previous node.\n *\n * ```ts\n * const pos = findPositionOfNodeBefore(tr.selection);\n * ```\n *\n * @param selection - the prosemirror selection\n */\n\nvar findPositionOfNodeBefore = function findPositionOfNodeBefore(value) {\n  var $pos = isResolvedPos(value) ? value : isSelection(value) ? value.$from : value.selection.$from;\n\n  if (isNullOrUndefined($pos)) {\n    throw new Error('Invalid value passed in.');\n  }\n\n  var nodeBefore = $pos.nodeBefore;\n  var selection = Selection.findFrom($pos, -1);\n\n  if (!selection || !nodeBefore) {\n    return;\n  }\n\n  var parent = findParentNodeOfType({\n    types: nodeBefore.type,\n    selection: selection\n  });\n  return parent ? parent : {\n    node: nodeBefore,\n    pos: selection.$from.pos,\n    end: selection.$from.end(),\n    depth: selection.$from.depth + 1,\n    start: selection.$from.start(selection.$from.depth + 1)\n  };\n};\n/**\n * Returns a new transaction that deletes previous node.\n *\n * ```ts\n * dispatch(\n *    removeNodeBefore(state.tr)\n * );\n * ```\n *\n * @param tr\n *\n * @public\n */\n\nvar removeNodeBefore = function removeNodeBefore(tr) {\n  var result = findPositionOfNodeBefore(tr.selection);\n\n  if (result) {\n    return removeNodeAtPosition({\n      pos: result.pos,\n      tr: tr\n    });\n  }\n\n  return tr;\n};\n\n/**\n * Returns a node of a given `nodeType` if it is selected. `start` points to the\n * start position of the node, `pos` points directly before the node.\n *\n * ```ts\n * const { extension, inlineExtension, bodiedExtension } = schema.nodes;\n *\n * const selectedNode = findSelectedNodeOfType({\n *   types: [extension, inlineExtension, bodiedExtension],\n *   selection,\n * });\n * ```\n */\nvar findSelectedNodeOfType = function findSelectedNodeOfType(_ref5) {\n  var types = _ref5.types,\n      selection = _ref5.selection;\n\n  if (isNodeSelection(selection)) {\n    var node = selection.node,\n        $from = selection.$from;\n\n    if (nodeEqualsType({\n      types: types,\n      node: node\n    })) {\n      return {\n        node: node,\n        pos: $from.pos,\n        depth: $from.depth,\n        start: $from.start(),\n        end: $from.pos + node.nodeSize\n      };\n    }\n  }\n\n  return undefined;\n};\n\n/**\n * Returns the position of the node after the current position, selection or state.\n *\n * ```ts\n * const pos = findPositionOfNodeBefore(tr.selection);\n * ```\n *\n * @param selection - the prosemirror selection\n */\nvar findPositionOfNodeAfter = function findPositionOfNodeAfter(value) {\n  var $pos = isResolvedPos(value) ? value : isSelection(value) ? value.$from : value.selection.$from;\n\n  if (isNullOrUndefined($pos)) {\n    throw new Error('Invalid value passed in.');\n  }\n\n  var nodeAfter = $pos.nodeAfter;\n  var selection = Selection.findFrom($pos, 1);\n\n  if (!selection || !nodeAfter) {\n    return;\n  }\n\n  var parent = findParentNodeOfType({\n    types: nodeAfter.type,\n    selection: selection\n  });\n  return parent ? parent : {\n    node: nodeAfter,\n    pos: selection.$from.pos,\n    end: selection.$from.end(),\n    depth: selection.$from.depth + 1,\n    start: selection.$from.start(selection.$from.depth + 1)\n  };\n};\n/**\n * Returns a new transaction that deletes the node after.\n *\n * ```ts\n * dispatch(\n *    removeNodeBefore(state.tr)\n * );\n * ```\n *\n * @param tr\n *\n * @public\n */\n\nvar removeNodeAfter = function removeNodeAfter(tr) {\n  var result = findPositionOfNodeAfter(tr.selection);\n\n  if (result) {\n    return removeNodeAtPosition({\n      pos: result.pos,\n      tr: tr\n    });\n  }\n\n  return tr;\n};\n/**\n * Checks whether the selection or state is currently empty.\n *\n * @param value - the current selection or state\n */\n\nvar selectionEmpty = function selectionEmpty(value) {\n  return isSelection(value) ? value.empty : isEditorState(value) ? value.selection.empty : true;\n};\n/**\n * Check to see if a transaction has changed either the document or the current\n * selection.\n *\n * @param params - the TransactionChangeParams object\n */\n\nvar transactionChanged = function transactionChanged(tr) {\n  return tr.docChanged || tr.selectionSet;\n};\n\n/**\n * Checks whether the node type passed in is active within the region. Used by\n * extensions to implement the `#active` method.\n *\n * To ignore attrs just leave the attrs object empty or undefined.\n *\n * \"Borrowed\" from [tiptap](https://github.com/scrumpy/tiptap)\n *\n * @param params - the destructured node active parameters\n */\nvar isNodeActive = function isNodeActive(_ref6) {\n  var _findSelectedNodeOfTy;\n\n  var state = _ref6.state,\n      type = _ref6.type,\n      _ref6$attrs = _ref6.attrs,\n      attrs = _ref6$attrs === void 0 ? Object.create(null) : _ref6$attrs;\n  var selection = state.selection;\n\n  var predicate = function predicate(node) {\n    return node.type === type;\n  };\n\n  var parent = (_findSelectedNodeOfTy = findSelectedNodeOfType({\n    selection: selection,\n    types: type\n  })) !== null && _findSelectedNodeOfTy !== void 0 ? _findSelectedNodeOfTy : findParentNode({\n    predicate: predicate,\n    selection: selection\n  });\n\n  if (!Object.keys(attrs).length || !parent) {\n    return bool(parent);\n  }\n\n  return parent.node.hasMarkup(type, attrs);\n};\n\n/**\n * Converts a schema to a simple json compatible object.\n */\nvar schemaToJSON = function schemaToJSON(schema) {\n  var nodes = keys(schema.nodes).reduce(function (acc, key) {\n    var spec = schema.nodes[key].spec;\n    return _objectSpread({}, acc, _defineProperty({}, key, spec));\n  }, Object.create(null));\n  var marks = keys(schema.marks).reduce(function (acc, key) {\n    var spec = schema.marks[key].spec;\n    return _objectSpread({}, acc, _defineProperty({}, key, spec));\n  }, Object.create(null));\n  return {\n    nodes: nodes,\n    marks: marks\n  };\n};\n/**\n * Wraps the default {@link ProsemirrorCommandFunction} and makes it compatible with the default **remirror**\n * {@link CommandFunction} call signature.\n */\n\nvar convertCommand = function convertCommand(commandFunction) {\n  return function (_ref7) {\n    var state = _ref7.state,\n        dispatch = _ref7.dispatch,\n        view = _ref7.view;\n    return commandFunction(state, dispatch, view);\n  };\n};\n/**\n * Similar to the chainCommands from the `prosemirror-commands` library. Allows multiple commands to be\n * chained together and runs until one of them returns true.\n */\n\nvar chainCommands = function chainCommands() {\n  for (var _len = arguments.length, commands = new Array(_len), _key = 0; _key < _len; _key++) {\n    commands[_key] = arguments[_key];\n  }\n\n  return function (_ref8) {\n    var state = _ref8.state,\n        dispatch = _ref8.dispatch,\n        view = _ref8.view,\n        rest = _objectWithoutProperties(_ref8, [\"state\", \"dispatch\", \"view\"]);\n\n    for (var commandIndex = 0; commandIndex < commands.length; commandIndex++) {\n      if (commands[commandIndex](_objectSpread({\n        state: state,\n        dispatch: dispatch,\n        view: view\n      }, rest))) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n};\n/**\n * Chains together keybindings.\n *\n * @remarks\n *\n * When `next` hands over full control of the keybindings to the caller.\n */\n\nvar chainKeyBindingCommands = function chainKeyBindingCommands() {\n  for (var _len2 = arguments.length, commands = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    commands[_key2] = arguments[_key2];\n  }\n\n  return function (params) {\n    if (!commands.length) {\n      return false;\n    }\n\n    var command = commands[0],\n        rest = commands.slice(1);\n    var calledNext = false;\n\n    var createNext = function createNext() {\n      for (var _len3 = arguments.length, nextCommands = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        nextCommands[_key3] = arguments[_key3];\n      }\n\n      return function () {\n        if (!nextCommands.length) {\n          return false;\n        }\n\n        calledNext = true;\n        var nextRest = nextCommands.slice(1);\n        return chainKeyBindingCommands.apply(void 0, nextCommands)(_objectSpread({}, params, {\n          next: createNext.apply(void 0, _toConsumableArray(nextRest))\n        }));\n      };\n    };\n\n    var next = createNext.apply(void 0, _toConsumableArray(rest));\n    var status = command(_objectSpread({}, params, {\n      next: next\n    }));\n\n    if (calledNext || status) {\n      return status;\n    }\n\n    return next();\n  };\n};\n\n/**\n * Update the selection with the provided MarkType\n *\n * @param type - the type to update the mark to\n * @param attrs - attrs to use for the mark\n *\n * @public\n */\nvar updateMark = function updateMark(_ref) {\n  var type = _ref.type,\n      _ref$attrs = _ref.attrs,\n      attrs = _ref$attrs === void 0 ? Object.create(null) : _ref$attrs,\n      appendText = _ref.appendText,\n      range = _ref.range;\n  return function (state, dispatch) {\n    var selection = state.selection;\n    var tr = state.tr;\n\n    var _ref2 = range !== null && range !== void 0 ? range : selection,\n        from = _ref2.from,\n        to = _ref2.to;\n\n    tr.addMark(from, to, type.create(attrs));\n\n    if (appendText) {\n      tr.insertText(appendText);\n    }\n\n    if (dispatch) {\n      dispatch(tr);\n    }\n\n    return true;\n  };\n};\n/**\n * Toggle between wrapping an inactive node with the provided node type, and lifting it up into it's parent.\n *\n * @param type - the node type to toggle\n * @param attrs - the attrs to use for the node\n *\n * @public\n */\n\nvar toggleWrap = function toggleWrap(type, attrs) {\n  return function (state, dispatch) {\n    var isActive = isNodeActive({\n      state: state,\n      type: type\n    });\n\n    if (isActive) {\n      return lift(state, dispatch);\n    }\n\n    return wrapIn(type, attrs)(state, dispatch);\n  };\n};\n/**\n * Toggles a list item.\n *\n * @remarks\n * When the provided list wrapper is inactive (e.g. ul) then wrap the list with this type.\n * When it is active then remove the selected line from the list.\n *\n * @param type - the list node type\n * @param itemType - the list item type (must be in the schema)\n *\n * @public\n */\n\nvar toggleList = function toggleList(type, itemType) {\n  return function (state, dispatch) {\n    var schema = state.schema,\n        selection = state.selection;\n    var $from = selection.$from,\n        $to = selection.$to;\n    var range = $from.blockRange($to);\n\n    if (!range) {\n      return false;\n    }\n\n    function isList(node, schema) {\n      return node.type === schema.nodes.bulletList || node.type === schema.nodes.orderedList;\n    }\n\n    var parentList = findParentNode({\n      predicate: function predicate(node) {\n        return isList(node, schema);\n      },\n      selection: selection\n    });\n\n    if (range.depth >= 1 && parentList && range.depth - parentList.depth <= 1) {\n      if (parentList.node.type === type) {\n        return liftListItem(itemType)(state, dispatch);\n      }\n\n      if (isList(parentList.node, schema) && type.validContent(parentList.node.content)) {\n        var tr = state.tr;\n        tr.setNodeMarkup(parentList.pos, type);\n\n        if (dispatch) {\n          dispatch(tr);\n        }\n\n        return true;\n      }\n    }\n\n    return wrapInList(type)(state, dispatch);\n  };\n};\n\n/**\n * Toggle a block between the provided type and toggleType.\n *\n * @param params - the destructured params\n *\n * @public\n */\nvar toggleBlockItem = function toggleBlockItem(_ref3) {\n  var type = _ref3.type,\n      toggleType = _ref3.toggleType,\n      _ref3$attrs = _ref3.attrs,\n      attrs = _ref3$attrs === void 0 ? Object.create(null) : _ref3$attrs;\n  return function (state, dispatch) {\n    var isActive = isNodeActive({\n      state: state,\n      type: type,\n      attrs: attrs\n    });\n\n    if (isActive) {\n      return setBlockType(toggleType)(state, dispatch);\n    }\n\n    return setBlockType(type, attrs)(state, dispatch);\n  };\n};\n\n/**\n * A utility for calling option functions that may not exist\n */\nvar callMethod = function callMethod(_ref4, args) {\n  var fn = _ref4.fn,\n      defaultReturn = _ref4.defaultReturn;\n  return isFunction(fn) ? fn.apply(void 0, _toConsumableArray(args)) : defaultReturn;\n};\n/**\n * Taken from https://stackoverflow.com/a/4900484\n *\n * Check that the browser is chrome. Supports passing a minimum version to check that it is a greater than or equal version.\n */\n\n\nvar isChrome = function isChrome() {\n  var minVersion = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  var parsedAgent = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n  return parsedAgent ? parseInt(parsedAgent[2], 10) >= minVersion : false;\n};\n/**\n * Replaces text with an optional appended string at the end\n *\n * @param params - the destructured params\n *\n * @public\n */\n\n\nvar replaceText = function replaceText(_ref5) {\n  var range = _ref5.range,\n      type = _ref5.type,\n      _ref5$attrs = _ref5.attrs,\n      attrs = _ref5$attrs === void 0 ? Object.create(null) : _ref5$attrs,\n      _ref5$appendText = _ref5.appendText,\n      appendText = _ref5$appendText === void 0 ? '' : _ref5$appendText,\n      _ref5$content = _ref5.content,\n      content = _ref5$content === void 0 ? '' : _ref5$content,\n      startTransaction = _ref5.startTransaction,\n      endTransaction = _ref5.endTransaction;\n  return function (state, dispatch) {\n    var schema = state.schema,\n        selection = state.selection; // const { $from, $to } = selection;\n\n    var index = selection.$from.index();\n\n    var _ref6 = range !== null && range !== void 0 ? range : selection,\n        from = _ref6.from,\n        to = _ref6.to; // Run the pre transaction hook\n\n\n    var tr = callMethod({\n      fn: startTransaction,\n      defaultReturn: state.tr\n    }, [state.tr, state]);\n\n    if (isNodeType(type)) {\n      if (!selection.$from.parent.canReplaceWith(index, index, type)) {\n        return false;\n      }\n\n      tr.replaceWith(from, to, type.create(attrs, content ? schema.text(content) : undefined));\n    } else {\n      if (!content) {\n        throw new Error('`replaceText` cannot be called without content when using a mark type');\n      }\n\n      tr.replaceWith(from, to, schema.text(content, isMarkType(type) ? [type.create(attrs)] : undefined));\n    }\n    /** Only append the text if when text is provided. */\n\n\n    if (appendText) {\n      tr.insertText(appendText);\n    }\n\n    if (dispatch) {\n      if (isChrome(60)) {\n        var _document$getSelectio;\n\n        // A workaround for a chrome bug\n        // https://github.com/ProseMirror/prosemirror/issues/710#issuecomment-338047650\n        (_document$getSelectio = document.getSelection()) === null || _document$getSelectio === void 0 ? void 0 : _document$getSelectio.empty();\n      }\n\n      dispatch(callMethod({\n        fn: endTransaction,\n        defaultReturn: tr\n      }, [tr, state]));\n    }\n\n    return true;\n  };\n};\n\n/**\n * Removes a mark from the current selection or provided from to\n *\n * @param params - the destructured params\n *\n * @public\n */\nvar removeMark = function removeMark(_ref7) {\n  var type = _ref7.type,\n      _ref7$expand = _ref7.expand,\n      expand = _ref7$expand === void 0 ? false : _ref7$expand,\n      range = _ref7.range,\n      endTransaction = _ref7.endTransaction,\n      startTransaction = _ref7.startTransaction;\n  return function (state, dispatch) {\n    var selection = state.selection;\n    var tr = callMethod({\n      fn: startTransaction,\n      defaultReturn: state.tr\n    }, [state.tr, state]);\n\n    var _ref8 = range !== null && range !== void 0 ? range : selection,\n        from = _ref8.from,\n        to = _ref8.to;\n\n    if (expand) {\n      var _ref9 = range ? getMarkRange(state.doc.resolve(range.from), type) || isNumber(range.to) && getMarkRange(state.doc.resolve(range.to), type) || {\n        from: from,\n        to: to\n      } : selectionEmpty(state) ? getMarkRange(state.selection.$anchor, type) || {\n        from: from,\n        to: to\n      } : {\n        from: from,\n        to: to\n      };\n\n      from = _ref9.from;\n      to = _ref9.to;\n    }\n\n    tr.removeMark(from, isNumber(to) ? to : from, type);\n\n    if (dispatch) {\n      dispatch(callMethod({\n        fn: endTransaction,\n        defaultReturn: tr\n      }, [tr, state]));\n    }\n\n    return true;\n  };\n};\n/**\n * An empty (noop) command function.\n *\n * @remarks\n *\n * This is typically to represent the default _do nothing_ action.\n */\n\nvar emptyCommandFunction = function emptyCommandFunction() {\n  return false;\n};\n\n/**\n * Keycode for ALT key.\n */\n\nvar ALT = ['Alt', ''];\n/**\n * Keycode for CTRL key.\n */\n\nvar CTRL = ['Control', ''];\n/**\n * Keycode for COMMAND/META key.\n */\n\nvar COMMAND = ['Meta', ''];\n/**\n * Keycode for SHIFT key.\n */\n\nvar SHIFT = ['Shift', ''];\n/**\n * Keycode for the windows key\n */\n\nvar WINDOWS = ['Windows', '', ''];\n/**\n * Keycode and symbols for caps lock\n */\n\nvar CAPS_LOCK = ['CapsLock', '', ''];\n/**\n * Shorthand names for common modifier key combinations which should `just` work on Apple and PC.\n */\n\nvar Modifier = {\n  Primary: function Primary(isMac) {\n    return isMac ? [COMMAND[0]] : [CTRL[0]];\n  },\n  PrimaryShift: function PrimaryShift(isMac) {\n    return isMac ? [SHIFT[0], COMMAND[0]] : [CTRL[0], SHIFT[0]];\n  },\n  PrimaryAlt: function PrimaryAlt(isMac) {\n    return isMac ? [ALT[0], COMMAND[0]] : [CTRL[0], ALT[0]];\n  },\n  Secondary: function Secondary(isMac) {\n    return isMac ? [SHIFT[0], ALT[0], COMMAND[0]] : [CTRL[0], SHIFT[0], ALT[0]];\n  },\n  Access: function Access(isMac) {\n    return isMac ? [CTRL[0], ALT[0]] : [SHIFT[0], ALT[0]];\n  },\n  Ctrl: function Ctrl() {\n    return [CTRL[0]];\n  },\n  Alt: function Alt() {\n    return [ALT[0]];\n  },\n  CtrlShift: function CtrlShift() {\n    return [CTRL[0], SHIFT[0]];\n  },\n  Shift: function Shift() {\n    return [SHIFT[0]];\n  },\n  ShiftAlt: function ShiftAlt() {\n    return [SHIFT[0], ALT[0]];\n  }\n};\n/**\n * The cross platform modifier key combination names.\n */\n\n/**\n * Returns true if this is an apple environment either on the server or the client.\n */\nvar isApple = function isApple() {\n  return environment.isApple;\n};\n/**\n * Create a consistent cross platform modifier string pattern.\n *\n * This can be used with the pressKeyWithModifier.\n *\n * ```ts\n * mod('Primary', 'A')\n * // => 'Control-A' // on PC\n * // => 'Cmd-A' // on Mac\n * ```\n *\n * @param modifier - A named modifier which is consistent across platforms\n *                  e.g. 'Primary' refers to 'Meta' on a mac and 'Control' on a PC\n * @param key - the key to press with the modifier. e.g. `Space` | `Enter`\n * @param [isApple] - a method which returns true when this is an apple device.\n */\n\nvar mod = function mod(modifier, key) {\n  var isMacFn = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : isApple;\n\n  switch (modifier) {\n    case 'Primary':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'PrimaryShift':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'PrimaryAlt':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'Secondary':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'Access':\n      return \"\".concat(Modifier[modifier](isMacFn()).join('-'), \"-\").concat(key);\n\n    case 'Ctrl':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    case 'Alt':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    case 'CtrlShift':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    case 'Shift':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    case 'ShiftAlt':\n      return \"\".concat(Modifier[modifier]().join('-'), \"-\").concat(key);\n\n    default:\n      throw new Error('Invalid modifier name passed in');\n  }\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/**\n * Flattens descendants of a given `node`.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const children = flatten(node);\n * ```\n */\nvar flatten = function flatten(_ref) {\n  var node = _ref.node,\n      _ref$descend = _ref.descend,\n      descend = _ref$descend === void 0 ? true : _ref$descend;\n\n  if (!isProsemirrorNode(node)) {\n    throw new Error('Invalid \"node\" parameter');\n  }\n\n  var result = [];\n  node.descendants(function (child, pos) {\n    result.push({\n      node: child,\n      pos: pos\n    });\n\n    if (!descend) {\n      return false;\n    }\n\n    return;\n  });\n  return result;\n};\n\n/**\n * Iterates over descendants of a given `node`, returning child nodes predicate returns truthy for.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const textNodes = findChildren(node, child => child.isText, false);\n * ```\n */\nvar findChildren = function findChildren(_ref2) {\n  var node = _ref2.node,\n      predicate = _ref2.predicate,\n      descend = _ref2.descend;\n\n  if (!node) {\n    throw new Error('Invalid \"node\" parameter');\n  } else if (!isFunction(predicate)) {\n    throw new Error('Invalid \"predicate\" parameter');\n  }\n\n  return flatten({\n    node: node,\n    descend: descend\n  }).filter(function (child) {\n    return predicate(child.node);\n  });\n};\n\nvar findNodeByPredicate = function findNodeByPredicate(_ref3) {\n  var predicate = _ref3.predicate;\n  return function (params) {\n    return findChildren(_objectSpread$1({}, params, {\n      predicate: predicate\n    }));\n  };\n};\n/**\n * Returns text nodes of a given `node`.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const textNodes = findTextNodes(node);\n * ```\n */\n\n\nvar findTextNodes = findNodeByPredicate({\n  predicate: function predicate(child) {\n    return child.isText;\n  }\n});\n/**\n * Returns inline nodes of a given `node`.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const inlineNodes = findInlineNodes(node);\n * ```\n */\n\nvar findInlineNodes = findNodeByPredicate({\n  predicate: function predicate(child) {\n    return child.isInline;\n  }\n});\n/**\n * Returns block descendants of a given `node`.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const blockNodes = findBlockNodes(node);\n * ```\n */\n\nvar findBlockNodes = findNodeByPredicate({\n  predicate: function predicate(child) {\n    return child.isBlock;\n  }\n});\n\n/**\n * Iterates over descendants of a given `node`, returning child nodes predicate returns truthy for.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const mergedCells = findChildrenByAttr(table, attrs => attrs.colspan === 2);\n * ```\n */\nvar findChildrenByAttr = function findChildrenByAttr(_ref4) {\n  var node = _ref4.node,\n      predicate = _ref4.predicate,\n      descend = _ref4.descend;\n  return findChildren({\n    node: node,\n    predicate: function (_predicate) {\n      function predicate(_x) {\n        return _predicate.apply(this, arguments);\n      }\n\n      predicate.toString = function () {\n        return _predicate.toString();\n      };\n\n      return predicate;\n    }(function (child) {\n      return predicate(child.attrs);\n    }),\n    descend: descend\n  });\n};\n\n/**\n * Iterates over descendants of a given `node`, returning child nodes of a given nodeType.\n *\n * @remarks\n * It doesn't descend into a node when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const cells = findChildrenByNode(table, schema.nodes.tableCell);\n * ```\n */\nvar findChildrenByNode = function findChildrenByNode(_ref5) {\n  var node = _ref5.node,\n      type = _ref5.type,\n      descend = _ref5.descend;\n  return findChildren({\n    node: node,\n    predicate: function predicate(child) {\n      return child.type === type;\n    },\n    descend: descend\n  });\n};\n\n/**\n * Iterates over descendants of a given `node`, returning child nodes that have a mark of a given markType.\n *\n * @remarks\n * It doesn't descend into a `node` when descend argument is `false` (defaults to `true`).\n *\n * ```ts\n * const nodes = findChildrenByMark(state.doc, schema.marks.strong);\n * ```\n */\nvar findChildrenByMark = function findChildrenByMark(_ref6) {\n  var node = _ref6.node,\n      type = _ref6.type,\n      descend = _ref6.descend;\n  return findChildren({\n    node: node,\n    predicate: function predicate(child) {\n      return bool(type.isInSet(child.marks));\n    },\n    descend: descend\n  });\n};\n\n/**\n * Returns `true` if a given node contains nodes of a given `nodeType`\n *\n * @remarks\n * ```ts\n * if (contains(panel, schema.nodes.listItem)) {\n *\n * }\n * ```\n */\nvar contains = function contains(_ref7) {\n  var node = _ref7.node,\n      type = _ref7.type;\n  return findChildrenByNode({\n    node: node,\n    type: type\n  }).length > 0;\n};\n\n/**\n * Creates an input rule based on the provided regex for the provided mark type\n */\n\nvar markInputRule = function markInputRule(_ref) {\n  var regexp = _ref.regexp,\n      type = _ref.type,\n      getAttrs = _ref.getAttrs;\n  return new InputRule(regexp, function (state, match, start, end) {\n    var tr = state.tr;\n    var attrs = isFunction(getAttrs) ? getAttrs(match) : getAttrs;\n    var markEnd = end;\n\n    if (match[1]) {\n      var startSpaces = match[0].search(/\\S/);\n      var textStart = start + match[0].indexOf(match[1]);\n      var textEnd = textStart + match[1].length;\n\n      if (textEnd < end) {\n        tr[\"delete\"](textEnd, end);\n      }\n\n      if (textStart > start) {\n        tr[\"delete\"](start + startSpaces, textStart);\n      }\n\n      markEnd = start + startSpaces + match[1].length;\n    }\n\n    return tr.addMark(start, markEnd, type.create(attrs)) // Make sure not to continue with any ongoing marks\n    .removeStoredMark(type);\n  });\n};\n/**\n * Creates a paste rule based on the provided regex for the provided mark type\n */\n\nvar markPasteRule = function markPasteRule(_ref2) {\n  var regexp = _ref2.regexp,\n      type = _ref2.type,\n      getAttrs = _ref2.getAttrs;\n\n  var handler = function handler(fragment) {\n    var nodes = [];\n    fragment.forEach(function (child) {\n      if (child.isText) {\n        var _child$text;\n\n        var text = (_child$text = child.text) !== null && _child$text !== void 0 ? _child$text : '';\n        var pos = 0; // ? For some reason including the index param makes this work. I'm not sure why...?\n\n        findMatches(text, regexp).forEach(function (match, _) {\n          if (!match[1]) {\n            return;\n          }\n\n          var start = match.index;\n          var end = start + match[0].length;\n          var attrs = isFunction(getAttrs) ? getAttrs(match) : getAttrs;\n\n          if (start > 0) {\n            nodes.push(child.cut(pos, start));\n          }\n\n          nodes.push(child.cut(start, end).mark(type.create(attrs).addToSet(child.marks)));\n          pos = end;\n        });\n\n        if (text && pos < text.length) {\n          nodes.push(child.cut(pos));\n        }\n      } else {\n        nodes.push(child.copy(handler(child.content)));\n      }\n    });\n    return Fragment.fromArray(nodes);\n  };\n\n  return new Plugin({\n    props: {\n      transformPasted: function transformPasted(slice) {\n        return new Slice(handler(slice.content), slice.openStart, slice.openEnd);\n      }\n    }\n  });\n};\n/**\n * Creates an node input rule based on the provided regex for the provided node type\n */\n\nvar nodeInputRule = function nodeInputRule(_ref3) {\n  var regexp = _ref3.regexp,\n      type = _ref3.type,\n      getAttrs = _ref3.getAttrs,\n      _ref3$updateSelection = _ref3.updateSelection,\n      updateSelection = _ref3$updateSelection === void 0 ? false : _ref3$updateSelection;\n  return new InputRule(regexp, function (state, match, start, end) {\n    var attrs = isFunction(getAttrs) ? getAttrs(match) : getAttrs;\n    var tr = state.tr;\n    tr.replaceWith(start - 1, end, type.create(attrs));\n\n    if (updateSelection) {\n      var $pos = tr.doc.resolve(start);\n      tr.setSelection(new TextSelection($pos));\n    }\n\n    return tr;\n  });\n};\n/**\n * Creates an node input rule based on the provided regex for the provided node type\n */\n\nvar plainInputRule = function plainInputRule(_ref4) {\n  var regexp = _ref4.regexp,\n      transformMatch = _ref4.transformMatch,\n      _ref4$updateSelection = _ref4.updateSelection,\n      updateSelection = _ref4$updateSelection === void 0 ? false : _ref4$updateSelection;\n  return new InputRule(regexp, function (state, match, start, end) {\n    var value = transformMatch(match);\n\n    if (isNullOrUndefined(value)) {\n      return null;\n    }\n\n    var tr = state.tr;\n\n    if (value === '') {\n      tr[\"delete\"](start, end);\n    } else {\n      tr.replaceWith(start, end, state.schema.text(value));\n    }\n\n    if (updateSelection) {\n      var $pos = tr.doc.resolve(start);\n      tr.setSelection(new TextSelection($pos));\n    }\n\n    return tr;\n  });\n};\n\nexport { ALT, CAPS_LOCK, COMMAND, CTRL, Modifier, SHIFT, WINDOWS, absoluteCoordinates, atDocEnd, atDocStart, canInsertNode, chainCommands, chainKeyBindingCommands, cloneTransaction, closestElement, contains, convertCommand, createDocumentNode, emptyCommandFunction, endPositionOfParent, environment, findBlockNodes, findChildren, findChildrenByAttr, findChildrenByMark, findChildrenByNode, findElementAtPosition, findInlineNodes, findNodeAtEndOfDoc, findNodeAtPosition, findNodeAtSelection, findNodeAtStartOfDoc, findParentNode, findParentNodeOfType, findPositionOfNodeAfter, findPositionOfNodeBefore, findSelectedNodeOfType, findTextNodes, flatten, fromHTML, getCursor, getDocument, getLineHeight, getMarkAttrs, getMarkRange, getMatchString, getNearestNonTextNode, getOffsetParent, getPluginMeta, getPluginState, getSelectedGroup, getSelectedWord, getTextContentFromSlice, isApple, isDOMNode, isDocNode, isDocNodeEmpty, isEditorSchema, isEditorState, isElementDOMNode, isEmptyParagraphNode, isMarkActive, isMarkType, isNodeActive, isNodeSelection, isNodeType, isObjectNode, isProsemirrorNode, isResolvedPos, isSelection, isTextDOMNode, isTextSelection, markInputRule, markPasteRule, mod, nodeEqualsType, nodeInputRule, nodeNameMatchesList, plainInputRule, removeMark, removeNodeAfter, removeNodeAtPosition, removeNodeBefore, replaceText, schemaToJSON, selectionEmpty, setPluginMeta, shouldUseDOMEnvironment, startPositionOfParent, toDOM, toHTML, toggleBlockItem, toggleList, toggleWrap, transactionChanged, updateMark };\n//# sourceMappingURL=core-utils.esm.js.map\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n","var slice = Array.prototype.slice\n\nmodule.exports = iterativelyWalk\n\nfunction iterativelyWalk(nodes, cb) {\n    if (!('length' in nodes)) {\n        nodes = [nodes]\n    }\n    \n    nodes = slice.call(nodes)\n\n    while(nodes.length) {\n        var node = nodes.shift(),\n            ret = cb(node)\n\n        if (ret) {\n            return ret\n        }\n\n        if (node.childNodes && node.childNodes.length) {\n            nodes = slice.call(node.childNodes).concat(nodes)\n        }\n    }\n}\n","var domWalk = require(\"dom-walk\")\nvar dispatchEvent = require(\"./event/dispatch-event.js\")\nvar addEventListener = require(\"./event/add-event-listener.js\")\nvar removeEventListener = require(\"./event/remove-event-listener.js\")\nvar serializeNode = require(\"./serialize.js\")\n\nvar htmlns = \"http://www.w3.org/1999/xhtml\"\n\nmodule.exports = DOMElement\n\nfunction DOMElement(tagName, owner, namespace) {\n    if (!(this instanceof DOMElement)) {\n        return new DOMElement(tagName)\n    }\n\n    var ns = namespace === undefined ? htmlns : (namespace || null)\n\n    this.tagName = ns === htmlns ? String(tagName).toUpperCase() : tagName\n    this.nodeName = this.tagName\n    this.className = \"\"\n    this.dataset = {}\n    this.childNodes = []\n    this.parentNode = null\n    this.style = {}\n    this.ownerDocument = owner || null\n    this.namespaceURI = ns\n    this._attributes = {}\n\n    if (this.tagName === 'INPUT') {\n      this.type = 'text'\n    }\n}\n\nDOMElement.prototype.type = \"DOMElement\"\nDOMElement.prototype.nodeType = 1\n\nDOMElement.prototype.appendChild = function _Element_appendChild(child) {\n    if (child.parentNode) {\n        child.parentNode.removeChild(child)\n    }\n\n    this.childNodes.push(child)\n    child.parentNode = this\n\n    return child\n}\n\nDOMElement.prototype.replaceChild =\n    function _Element_replaceChild(elem, needle) {\n        // TODO: Throw NotFoundError if needle.parentNode !== this\n\n        if (elem.parentNode) {\n            elem.parentNode.removeChild(elem)\n        }\n\n        var index = this.childNodes.indexOf(needle)\n\n        needle.parentNode = null\n        this.childNodes[index] = elem\n        elem.parentNode = this\n\n        return needle\n    }\n\nDOMElement.prototype.removeChild = function _Element_removeChild(elem) {\n    // TODO: Throw NotFoundError if elem.parentNode !== this\n\n    var index = this.childNodes.indexOf(elem)\n    this.childNodes.splice(index, 1)\n\n    elem.parentNode = null\n    return elem\n}\n\nDOMElement.prototype.insertBefore =\n    function _Element_insertBefore(elem, needle) {\n        // TODO: Throw NotFoundError if referenceElement is a dom node\n        // and parentNode !== this\n\n        if (elem.parentNode) {\n            elem.parentNode.removeChild(elem)\n        }\n\n        var index = needle === null || needle === undefined ?\n            -1 :\n            this.childNodes.indexOf(needle)\n\n        if (index > -1) {\n            this.childNodes.splice(index, 0, elem)\n        } else {\n            this.childNodes.push(elem)\n        }\n\n        elem.parentNode = this\n        return elem\n    }\n\nDOMElement.prototype.setAttributeNS =\n    function _Element_setAttributeNS(namespace, name, value) {\n        var prefix = null\n        var localName = name\n        var colonPosition = name.indexOf(\":\")\n        if (colonPosition > -1) {\n            prefix = name.substr(0, colonPosition)\n            localName = name.substr(colonPosition + 1)\n        }\n        if (this.tagName === 'INPUT' && name === 'type') {\n          this.type = value;\n        }\n        else {\n          var attributes = this._attributes[namespace] || (this._attributes[namespace] = {})\n          attributes[localName] = {value: value, prefix: prefix}\n        }\n    }\n\nDOMElement.prototype.getAttributeNS =\n    function _Element_getAttributeNS(namespace, name) {\n        var attributes = this._attributes[namespace];\n        var value = attributes && attributes[name] && attributes[name].value\n        if (this.tagName === 'INPUT' && name === 'type') {\n          return this.type;\n        }\n        if (typeof value !== \"string\") {\n            return null\n        }\n        return value\n    }\n\nDOMElement.prototype.removeAttributeNS =\n    function _Element_removeAttributeNS(namespace, name) {\n        var attributes = this._attributes[namespace];\n        if (attributes) {\n            delete attributes[name]\n        }\n    }\n\nDOMElement.prototype.hasAttributeNS =\n    function _Element_hasAttributeNS(namespace, name) {\n        var attributes = this._attributes[namespace]\n        return !!attributes && name in attributes;\n    }\n\nDOMElement.prototype.setAttribute = function _Element_setAttribute(name, value) {\n    return this.setAttributeNS(null, name, value)\n}\n\nDOMElement.prototype.getAttribute = function _Element_getAttribute(name) {\n    return this.getAttributeNS(null, name)\n}\n\nDOMElement.prototype.removeAttribute = function _Element_removeAttribute(name) {\n    return this.removeAttributeNS(null, name)\n}\n\nDOMElement.prototype.hasAttribute = function _Element_hasAttribute(name) {\n    return this.hasAttributeNS(null, name)\n}\n\nDOMElement.prototype.removeEventListener = removeEventListener\nDOMElement.prototype.addEventListener = addEventListener\nDOMElement.prototype.dispatchEvent = dispatchEvent\n\n// Un-implemented\nDOMElement.prototype.focus = function _Element_focus() {\n    return void 0\n}\n\nDOMElement.prototype.toString = function _Element_toString() {\n    return serializeNode(this)\n}\n\nDOMElement.prototype.getElementsByClassName = function _Element_getElementsByClassName(classNames) {\n    var classes = classNames.split(\" \");\n    var elems = []\n\n    domWalk(this, function (node) {\n        if (node.nodeType === 1) {\n            var nodeClassName = node.className || \"\"\n            var nodeClasses = nodeClassName.split(\" \")\n\n            if (classes.every(function (item) {\n                return nodeClasses.indexOf(item) !== -1\n            })) {\n                elems.push(node)\n            }\n        }\n    })\n\n    return elems\n}\n\nDOMElement.prototype.getElementsByTagName = function _Element_getElementsByTagName(tagName) {\n    tagName = tagName.toLowerCase()\n    var elems = []\n\n    domWalk(this.childNodes, function (node) {\n        if (node.nodeType === 1 && (tagName === '*' || node.tagName.toLowerCase() === tagName)) {\n            elems.push(node)\n        }\n    })\n\n    return elems\n}\n\nDOMElement.prototype.contains = function _Element_contains(element) {\n    return domWalk(this, function (node) {\n        return element === node\n    }) || false\n}\n","module.exports = dispatchEvent\n\nfunction dispatchEvent(ev) {\n    var elem = this\n    var type = ev.type\n\n    if (!ev.target) {\n        ev.target = elem\n    }\n\n    if (!elem.listeners) {\n        elem.listeners = {}\n    }\n\n    var listeners = elem.listeners[type]\n\n    if (listeners) {\n        return listeners.forEach(function (listener) {\n            ev.currentTarget = elem\n            if (typeof listener === 'function') {\n                listener(ev)\n            } else {\n                listener.handleEvent(ev)\n            }\n        })\n    }\n\n    if (elem.parentNode) {\n        elem.parentNode.dispatchEvent(ev)\n    }\n}\n","module.exports = addEventListener\n\nfunction addEventListener(type, listener) {\n    var elem = this\n\n    if (!elem.listeners) {\n        elem.listeners = {}\n    }\n\n    if (!elem.listeners[type]) {\n        elem.listeners[type] = []\n    }\n\n    if (elem.listeners[type].indexOf(listener) === -1) {\n        elem.listeners[type].push(listener)\n    }\n}\n","module.exports = removeEventListener\n\nfunction removeEventListener(type, listener) {\n    var elem = this\n\n    if (!elem.listeners) {\n        return\n    }\n\n    if (!elem.listeners[type]) {\n        return\n    }\n\n    var list = elem.listeners[type]\n    var index = list.indexOf(listener)\n    if (index !== -1) {\n        list.splice(index, 1)\n    }\n}\n","import { selectionEmpty, transactionChanged, getPluginState } from '@remirror/core-utils';\nimport { PluginKey, Plugin } from 'prosemirror-state';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { noop, bool, isString, isRegExp, findMatches, isUndefined } from '@remirror/core-helpers';\nimport { DecorationSet, Decoration } from 'prosemirror-view';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport { NULL_CHARACTER } from '@remirror/core-constants';\nimport { keydownHandler } from 'prosemirror-keymap';\nimport escapeStringRegex from 'escape-string-regexp';\n\nvar DEFAULT_SUGGEST_ACTIONS = {\n  command: noop,\n  create: noop,\n  remove: noop,\n  update: noop\n};\n\nvar defaultHandler = function defaultHandler() {\n  return false;\n};\n\nvar DEFAULT_SUGGESTER = {\n  appendText: '',\n  createCommand: function createCommand() {\n    return noop;\n  },\n  ignoredClassName: undefined,\n  ignoredTag: 'span',\n  invalidPrefixCharacters: undefined,\n  keyBindings: {},\n  matchOffset: 0,\n  noDecorations: false,\n  onChange: defaultHandler,\n  onCharacterEntry: defaultHandler,\n  onExit: defaultHandler,\n  startOfLine: false,\n  suggestClassName: 'suggest',\n  suggestTag: 'span',\n  supportedCharacters: /[\\w\\d_]+/,\n  validPrefixCharacters: /^[\\s\\0]?$/\n};\n/**\n * The potential reasons for an exit of a mention.\n */\n\nvar ExitReason;\n/**\n * The potential reason for changes\n */\n\n(function (ExitReason) {\n  ExitReason[\"End\"] = \"exit-end\";\n  ExitReason[\"Removed\"] = \"delete\";\n  ExitReason[\"Split\"] = \"exit-split\";\n  ExitReason[\"InvalidSplit\"] = \"invalid-exit-split\";\n  ExitReason[\"MoveEnd\"] = \"move-end\";\n  ExitReason[\"MoveStart\"] = \"move-start\";\n  ExitReason[\"JumpForward\"] = \"jump-forward-exit\";\n  ExitReason[\"JumpBackward\"] = \"jump-backward-exit\";\n  ExitReason[\"SelectionOutside\"] = \"selection-outside\";\n})(ExitReason || (ExitReason = {}));\n\nvar ChangeReason;\n\n(function (ChangeReason) {\n  ChangeReason[\"Start\"] = \"start\";\n  ChangeReason[\"Text\"] = \"change-character\";\n  ChangeReason[\"SelectionInside\"] = \"selection-inside\";\n  ChangeReason[\"Move\"] = \"move\";\n  ChangeReason[\"JumpBackward\"] = \"jump-backward-change\";\n  ChangeReason[\"JumpForward\"] = \"jump-forward-change\";\n})(ChangeReason || (ChangeReason = {}));\n\n/**\n * Is this a change in the current suggestion (added or deleted characters)?\n */\nvar isChange = function isChange(compare) {\n  return bool(compare.prev && compare.next && compare.prev.queryText.full !== compare.next.queryText.full);\n};\n/**\n * Has the cursor moved within the current suggestion (added or deleted\n * characters)?\n */\n\nvar isMove = function isMove(compare) {\n  return bool(compare.prev && compare.next && compare.prev.range.to !== compare.next.range.to);\n};\n/**\n * Are we entering a new suggestion?\n */\n\nvar isEntry = function isEntry(compare) {\n  return bool(!compare.prev && compare.next);\n};\n/**\n * Are we exiting a suggestion?\n */\n\nvar isExit = function isExit(compare) {\n  return bool(compare.prev && !compare.next);\n};\n/**\n * Is this a jump from one suggestion to another?\n */\n\nvar isJump = function isJump(compare) {\n  return bool(compare.prev && compare.next && compare.prev.range.from !== compare.next.range.from);\n};\n/**\n * Check that the passed in value is an ExitReason\n */\n\nvar isExitReason = function isExitReason(value) {\n  return isString(value) && Object.values(ExitReason).includes(value);\n};\nvar isChangeReason = function isChangeReason(value) {\n  return isString(value) && Object.values(ChangeReason).includes(value);\n};\n/**\n * Checks that the reason passed is a split reason. This typically means that we\n * should default to a partial update / creation of the mention.\n */\n\nvar isSplitReason = function isSplitReason(value) {\n  return value === ExitReason.Split;\n};\n/**\n * Checks that the reason was caused by a split at a point where there is no\n * query.\n */\n\nvar isInvalidSplitReason = function isInvalidSplitReason(value) {\n  return value === ExitReason.InvalidSplit;\n};\n/**\n * Checks that the reason was caused by a deletion.\n */\n\nvar isRemovedReason = function isRemovedReason(value) {\n  return value === ExitReason.Removed;\n};\n/**\n * Checks to see if this is a jump reason.\n */\n\nvar isJumpReason = function isJumpReason(map) {\n  return map.exit ? [ExitReason.JumpBackward, ExitReason.JumpForward].includes(map.exit.reason) : map.change ? [ChangeReason.JumpBackward, ChangeReason.JumpForward].includes(map.change.reason) : false;\n};\n/**\n * True when the match is currently active (i.e. it's query has a value)\n */\n\nvar isValidMatch = function isValidMatch(match) {\n  return bool(match && match.queryText.full.length >= match.suggester.matchOffset);\n};\n/**\n * True when the current selection is outside the match.\n */\n\nvar selectionOutsideMatch = function selectionOutsideMatch(_ref) {\n  var match = _ref.match,\n      selection = _ref.selection;\n  return match && (selection.from < match.range.from || selection.from > match.range.end);\n};\n\nvar escapeChar = function escapeChar(_char) {\n  return escapeStringRegex(_char);\n};\n/**\n * Convert a RegExp into a string\n *\n * @param regexOrString\n */\n\nvar regexToString = function regexToString(regexOrString) {\n  return isRegExp(regexOrString) ? regexOrString.source : regexOrString;\n};\n/**\n * Find regex prefix when depending on whether the mention only supports the\n * start of a line or not\n *\n * @param onlyStartOfLine\n */\n\nvar getRegexPrefix = function getRegexPrefix(onlyStartOfLine) {\n  return onlyStartOfLine ? '^' : '';\n};\n/**\n * Get the supported characters regex string.\n */\n\nvar getRegexSupportedCharacters = function getRegexSupportedCharacters(supportedCharacters, matchOffset) {\n  return \"(?:\".concat(regexToString(supportedCharacters), \"){\").concat(matchOffset, \",}\");\n};\n/**\n * Create a regex expression to evaluate matches directly from the suggester properties.\n */\n\n\nvar createRegexFromSuggester = function createRegexFromSuggester(_ref) {\n  var _char2 = _ref[\"char\"],\n      matchOffset = _ref.matchOffset,\n      startOfLine = _ref.startOfLine,\n      supportedCharacters = _ref.supportedCharacters;\n  var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'gm';\n  return new RegExp(\"\".concat(getRegexPrefix(startOfLine)).concat(escapeChar(_char2)).concat(getRegexSupportedCharacters(supportedCharacters, matchOffset)), flags);\n};\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/**\n * Small utility method for creating a match with the reason property available.\n */\nvar createMatchWithReason = function createMatchWithReason(_ref) {\n  var match = _ref.match,\n      reason = _ref.reason;\n  return _objectSpread({}, match, {\n    reason: reason\n  });\n};\n/**\n * Checks to see if the text before the matching character is a valid prefix.\n *\n * @param prefix - the prefix to test\n * @param params - an object with the regex testing values\n */\n\n\nvar isPrefixValid = function isPrefixValid(prefix, _ref2) {\n  var invalidPrefixCharacters = _ref2.invalidPrefixCharacters,\n      validPrefixCharacters = _ref2.validPrefixCharacters;\n\n  if (!isUndefined(invalidPrefixCharacters)) {\n    var regex = new RegExp(regexToString(invalidPrefixCharacters));\n    return !regex.test(prefix);\n  }\n\n  {\n    var _regex = new RegExp(regexToString(validPrefixCharacters));\n\n    return _regex.test(prefix);\n  }\n};\n/**\n * Find the position of a mention for a given selection and character\n *\n * @param params\n */\n\n\nvar findPosition = function findPosition(_ref3) {\n  var text = _ref3.text,\n      regexp = _ref3.regexp,\n      $pos = _ref3.$pos,\n      _char = _ref3[\"char\"],\n      suggester = _ref3.suggester;\n  var position;\n  var cursor = $pos.pos; // The current cursor position\n\n  var start = $pos.start(); // The starting position for matches\n\n  findMatches(text, regexp).forEach(function (match) {\n    // Check the character before the current match to ensure it is not one of\n    // the supported characters\n    var matchPrefix = match.input.slice(Math.max(0, match.index - 1), match.index);\n\n    if (isPrefixValid(matchPrefix, suggester)) {\n      var from = match.index + start; // The absolute position of the match wrapper node\n\n      var end = from + match[0].length; // The position where the match ends\n\n      var to = Math.min(end, cursor); // The cursor position (or end position whichever is greater)\n\n      var matchLength = to - from; // The length of the current match\n      // If the $position is located within the matched substring, return that\n      // range\n\n      if (from < cursor && end >= cursor) {\n        position = {\n          range: {\n            from: from,\n            end: end,\n            to: to\n          },\n          queryText: {\n            partial: match[0].slice(_char.length, matchLength),\n            full: match[0].slice(_char.length)\n          },\n          matchText: {\n            partial: match[0].slice(0, matchLength),\n            full: match[0]\n          },\n          suggester: suggester\n        };\n      }\n    }\n  });\n  return position;\n};\n/**\n * Checks if any matches exist at the current selection for so that the\n * suggestions be activated or deactivated.\n */\n\n\nvar findMatch = function findMatch(_ref4) {\n  var $pos = _ref4.$pos,\n      suggester = _ref4.suggester;\n  var _char2 = suggester[\"char\"],\n      name = suggester.name,\n      startOfLine = suggester.startOfLine,\n      supportedCharacters = suggester.supportedCharacters,\n      matchOffset = suggester.matchOffset; // Create the regular expression to match the text against\n\n  var regexp = createRegexFromSuggester({\n    \"char\": _char2,\n    matchOffset: matchOffset,\n    startOfLine: startOfLine,\n    supportedCharacters: supportedCharacters\n  }); // All the text in the current node\n\n  var text = $pos.doc.textBetween($pos.before(), $pos.end(), NULL_CHARACTER, NULL_CHARACTER); // Find the position and return it\n\n  return findPosition({\n    suggester: suggester,\n    text: text,\n    regexp: regexp,\n    $pos: $pos,\n    \"char\": _char2,\n    name: name\n  });\n};\n/**\n * Checks the provided match and generates a new match. This is useful for\n * determining the kind of change that has happened.\n *\n * If the match still exists and it is different then it's likely a split has\n * occurred.\n */\n\n\nvar recheckMatch = function recheckMatch(_ref5) {\n  var state = _ref5.state,\n      match = _ref5.match;\n\n  try {\n    // Wrapped in try catch because it's possible for everything to be deleted\n    // and the doc.resolve will fail.\n    return findMatch({\n      $pos: state.doc.resolve(match.range.to),\n      suggester: match.suggester\n    });\n  } catch (_unused) {\n    return undefined;\n  }\n};\n/**\n * Check whether the insert action occurred at the end, in the middle or caused\n * the suggestion to be invalid.\n *\n * Prev refers to the original previous and next refers to the updated version\n * after the split\n */\n\n\nvar createInsertReason = function createInsertReason(_ref6) {\n  var prev = _ref6.prev,\n      next = _ref6.next,\n      state = _ref6.state;\n\n  // Has the text been removed? TODO how to tests for deletions mid document?\n  if (!next && prev.range.from >= state.doc.nodeSize) {\n    return {\n      exit: createMatchWithReason({\n        match: prev,\n        reason: ExitReason.Removed\n      })\n    };\n  } // Are we within an invalid split?\n\n\n  if (!next || !prev.queryText.partial) {\n    return {\n      exit: createMatchWithReason({\n        match: prev,\n        reason: ExitReason.InvalidSplit\n      })\n    };\n  } // Are we at the end position?\n\n\n  if (prev.range.end === next.range.to) {\n    return {\n      exit: createMatchWithReason({\n        match: next,\n        reason: ExitReason.End\n      })\n    };\n  } // Are we in the middle of the mention\n\n\n  if (prev.queryText.partial) {\n    return {\n      exit: createMatchWithReason({\n        match: next,\n        reason: ExitReason.Split\n      })\n    };\n  }\n\n  return {};\n};\n/**\n * Find the reason for the Jump\n */\n\n\nvar findJumpReason = function findJumpReason(_ref7) {\n  var prev = _ref7.prev,\n      next = _ref7.next,\n      state = _ref7.state;\n  var value = Object.create(null);\n  var updatedPrev = recheckMatch({\n    state: state,\n    match: prev\n  });\n\n  var _ref8 = updatedPrev && updatedPrev.queryText.full !== prev.queryText.full // has query changed\n  ? createInsertReason({\n    prev: prev,\n    next: updatedPrev,\n    state: state\n  }) : value,\n      exit = _ref8.exit;\n\n  var isJumpForward = prev.range.from < next.range.from;\n\n  if (isJumpForward) {\n    return {\n      exit: exit !== null && exit !== void 0 ? exit : createMatchWithReason({\n        match: prev,\n        reason: ExitReason.JumpForward\n      }),\n      change: createMatchWithReason({\n        match: next,\n        reason: ChangeReason.JumpForward\n      })\n    };\n  }\n\n  return {\n    exit: exit !== null && exit !== void 0 ? exit : createMatchWithReason({\n      match: prev,\n      reason: ExitReason.JumpBackward\n    }),\n    change: createMatchWithReason({\n      match: next,\n      reason: ChangeReason.JumpBackward\n    })\n  };\n};\n/**\n * Find the reason for the exit.\n *\n * This provides some context and helps sets up a helper command with sane\n * defaults.\n */\n\n\nvar findExitReason = function findExitReason(_ref9) {\n  var match = _ref9.match,\n      state = _ref9.state,\n      $pos = _ref9.$pos;\n  var selection = state.selection;\n  var updatedPrev = recheckMatch({\n    match: match,\n    state: state\n  }); // Exit created a split\n\n  if (!updatedPrev || updatedPrev.queryText.full !== match.queryText.full) {\n    return createInsertReason({\n      prev: match,\n      next: updatedPrev,\n      state: state\n    });\n  } // Exit caused by a selection\n\n\n  if (!selectionEmpty(state) && (selection.from <= match.range.from || selection.to >= match.range.end)) {\n    return {\n      exit: createMatchWithReason({\n        match: match,\n        reason: ExitReason.SelectionOutside\n      })\n    };\n  } // Exit happened at the end of previous suggestion\n\n\n  if ($pos.pos > match.range.end) {\n    return {\n      exit: createMatchWithReason({\n        match: match,\n        reason: ExitReason.MoveEnd\n      })\n    };\n  } // Exit happened at the start of previous suggestion\n\n\n  if ($pos.pos <= match.range.from) {\n    return {\n      exit: createMatchWithReason({\n        match: match,\n        reason: ExitReason.MoveStart\n      })\n    };\n  }\n\n  return {};\n};\n\n/**\n * Transforms the keybindings into an object that can be consumed by the\n * prosemirror keydownHandler method.\n */\nvar transformKeyBindings = function transformKeyBindings(_ref10) {\n  var bindings = _ref10.bindings,\n      params = _ref10.params;\n  var keys = Object.create(null);\n  return Object.entries(bindings).reduce(function (prev, _ref11) {\n    var _ref12 = _slicedToArray(_ref11, 2),\n        key = _ref12[0],\n        method = _ref12[1];\n\n    return _objectSpread({}, prev, _defineProperty({}, key, function () {\n      return bool(method(params));\n    }));\n  }, keys);\n};\n/**\n * Run the keyBindings when a key is pressed to perform actions.\n *\n * When return value is `true` no further actions should be taken for this key\n * event. When `false` the event will be passed up the chain to the next key\n * handler.\n *\n * This is useful for intercepting events.\n */\n\nvar runKeyBindings = function runKeyBindings(bindings, params) {\n  return keydownHandler(transformKeyBindings({\n    bindings: bindings,\n    params: params\n  }))(params.view, params.event);\n};\n\n/**\n * Creates an array of the actions taken based on the current prev and next\n * state field\n */\nvar findReason = function findReason(_ref13) {\n  var prev = _ref13.prev,\n      next = _ref13.next,\n      state = _ref13.state,\n      $pos = _ref13.$pos;\n  var value = Object.create(null);\n\n  if (!prev && !next) {\n    return value;\n  }\n\n  var compare = {\n    prev: prev,\n    next: next\n  }; // Check for a Jump\n\n  if (isJump(compare)) {\n    return findJumpReason({\n      prev: compare.prev,\n      next: compare.next,\n      state: state\n    });\n  } // Entered into a new suggestion\n\n\n  if (isEntry(compare)) {\n    return {\n      change: createMatchWithReason({\n        match: compare.next,\n        reason: ChangeReason.Start\n      })\n    };\n  } // Exited a suggestion\n\n\n  if (isExit(compare)) {\n    return findExitReason({\n      $pos: $pos,\n      match: compare.prev,\n      state: state\n    });\n  }\n\n  if (isChange(compare)) {\n    return {\n      change: createMatchWithReason({\n        match: compare.next,\n        reason: ChangeReason.Text\n      })\n    };\n  }\n\n  if (isMove(compare)) {\n    return {\n      change: createMatchWithReason({\n        match: compare.next,\n        reason: selectionEmpty(state) ? ChangeReason.Move : ChangeReason.SelectionInside\n      })\n    };\n  }\n\n  return value;\n};\n/**\n * Find a match for the provided matchers\n */\n\nvar findFromSuggesters = function findFromSuggesters(_ref14) {\n  var suggesters = _ref14.suggesters,\n      $pos = _ref14.$pos;\n  // Find the first match and break when done\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = suggesters[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var suggester = _step.value;\n\n      try {\n        var match = findMatch({\n          suggester: suggester,\n          $pos: $pos\n        });\n\n        if (match) {\n          return match;\n        }\n      } catch (_unused2) {\n        console.warn('Error while finding match.');\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return undefined;\n};\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n/**\n * The suggestion state which manages the list of suggestions.\n */\n\nvar SuggestState =\n/*#__PURE__*/\nfunction () {\n  _createClass(SuggestState, [{\n    key: \"getCommand\",\n\n    /**\n     * The actions created by the extension.\n     */\n    value: function getCommand(match, reason) {\n      return match.suggester.createCommand({\n        match: match,\n        reason: reason,\n        view: this.view,\n        setMarkRemoved: this.setRemovedTrue,\n        addIgnored: this.addIgnored,\n        clearIgnored: this.clearIgnored\n      });\n    }\n    /**\n     * Returns the current active suggestion state field if one exists\n     */\n\n  }, {\n    key: \"match\",\n    get: function get() {\n      return this.next ? this.next : this.prev && this.handlerMatches.exit ? this.prev : undefined;\n    }\n    /**\n     * Create the state for the `prosemirror-suggest` plugin.\n     *\n     * @remarks\n     *\n     * Each suggester must provide a name value which is globally unique since it\n     * acts as the identifier.\n     *\n     * It is possible to register multiple suggesters with identical `char`\n     * properties. The matched suggester is based on the specificity of the\n     * `regex` and the order in which they are passed in. Earlier suggesters are\n     * prioritized.\n     */\n\n  }], [{\n    key: \"create\",\n\n    /**\n     * Create an instance of the SuggestState class.\n     */\n    value: function create(suggesters) {\n      return new SuggestState(suggesters);\n    }\n    /**\n     * The suggesters that have been registered for the suggestions plugin.\n     */\n\n  }]);\n\n  function SuggestState(suggesters) {\n    var _this = this;\n\n    _classCallCheck(this, SuggestState);\n\n    _defineProperty(this, \"handlerMatches\", Object.create(null));\n\n    _defineProperty(this, \"ignored\", DecorationSet.empty);\n\n    _defineProperty(this, \"removed\", false);\n\n    _defineProperty(this, \"setRemovedTrue\", function () {\n      _this.removed = true;\n    });\n\n    _defineProperty(this, \"onViewUpdate\", function () {\n      var match = _this.match,\n          _this$handlerMatches = _this.handlerMatches,\n          change = _this$handlerMatches.change,\n          exit = _this$handlerMatches.exit; // Cancel update when a suggestion isn't active\n\n      if (!change && !exit || !isValidMatch(match)) {\n        return;\n      } // Call Handlers\n      // When a jump happens run the action that involves the position that occurs\n      // later in the document. This is so that changes don't affect previous\n      // positions.\n\n\n      if (change && exit && isJumpReason({\n        change: change,\n        exit: exit\n      })) {\n        var exitParams = _this.createReasonParams(exit);\n\n        var changeParams = _this.createReasonParams(change);\n\n        var movedForwards = exit.range.from < change.range.from;\n        movedForwards ? change.suggester.onChange(changeParams) : exit.suggester.onExit(exitParams);\n        movedForwards ? exit.suggester.onExit(exitParams) : change.suggester.onChange(changeParams);\n        _this.removed = false;\n        return;\n      }\n\n      if (change) {\n        change.suggester.onChange(_this.createReasonParams(change));\n      }\n\n      if (exit) {\n        exit.suggester.onExit(_this.createReasonParams(exit));\n        _this.removed = false;\n\n        if (isInvalidSplitReason(exit.reason)) {\n          _this.handlerMatches = Object.create(null);\n        }\n      }\n    });\n\n    _defineProperty(this, \"addIgnored\", function (_ref) {\n      var from = _ref.from,\n          _char = _ref[\"char\"],\n          name = _ref.name,\n          _ref$specific = _ref.specific,\n          specific = _ref$specific === void 0 ? false : _ref$specific;\n      var to = from + _char.length;\n\n      var suggester = _this.suggesters.find(function (val) {\n        return val.name === name;\n      });\n\n      if (!suggester) {\n        throw new Error(\"No suggester exists for the name provided: \".concat(name));\n      }\n\n      var attrs = suggester.ignoredClassName ? {\n        \"class\": suggester.ignoredClassName\n      } : {};\n      var decoration = Decoration.inline(from, to, _objectSpread$1({\n        nodeName: suggester.ignoredTag\n      }, attrs), {\n        \"char\": _char,\n        name: name,\n        specific: specific\n      });\n      _this.ignored = _this.ignored.add(_this.view.state.doc, [decoration]);\n    });\n\n    _defineProperty(this, \"removeIgnored\", function (_ref2) {\n      var from = _ref2.from,\n          _char2 = _ref2[\"char\"],\n          name = _ref2.name;\n\n      var decorations = _this.ignored.find(from, from + _char2.length);\n\n      var decoration = decorations[0];\n\n      if (!bool(decoration) || decoration.spec.name !== name) {\n        return;\n      }\n\n      _this.ignored = _this.ignored.remove([decoration]);\n    });\n\n    _defineProperty(this, \"clearIgnored\", function (name) {\n      if (name) {\n        var decorations = _this.ignored.find();\n\n        var decorationsToClear = decorations.filter(function (_ref3) {\n          var spec = _ref3.spec;\n          return spec.name === name;\n        });\n        _this.ignored = _this.ignored.remove(decorationsToClear);\n      } else {\n        _this.ignored = DecorationSet.empty;\n      }\n    });\n\n    var names = [];\n    this.suggesters = suggesters.map(function (suggester) {\n      if (names.includes(suggester.name)) {\n        throw new Error(\"A suggester already exists with the name '\".concat(suggester.name, \"'. The name provided must be unique.\"));\n      }\n\n      names.push(suggester.name);\n      return _objectSpread$1({}, DEFAULT_SUGGESTER, {}, suggester);\n    });\n  }\n  /**\n   * Initialize the SuggestState with a view which is stored for use later.\n   */\n\n\n  _createClass(SuggestState, [{\n    key: \"init\",\n    value: function init(view) {\n      this.view = view;\n      return this;\n    }\n    /**\n     * Create the props which should be passed into each action handler\n     */\n\n  }, {\n    key: \"createParams\",\n    value: function createParams(match) {\n      return _objectSpread$1({\n        view: this.view,\n        addIgnored: this.addIgnored,\n        clearIgnored: this.clearIgnored,\n        command: this.getCommand(match)\n      }, match);\n    }\n    /**\n     * Create the prop to be passed into the `onChange` or `onExit` handler.\n     */\n\n  }, {\n    key: \"createReasonParams\",\n    value: function createReasonParams(match) {\n      return _objectSpread$1({}, this.createParams(match), {\n        command: this.getCommand(match, match.reason)\n      }, match);\n    }\n    /**\n     * Manages the view updates.\n     */\n\n  }, {\n    key: \"mapIgnoredDecorations\",\n\n    /**\n     * Update the current ignored decorations based on the latest changes to the\n     * prosemirror document.\n     */\n    value: function mapIgnoredDecorations(tr) {\n      // Map over and update the ignored decorations.\n      var ignored = this.ignored.map(tr.mapping, tr.doc);\n      var decorations = ignored.find(); // For suggesters with multiple characters it is possible for a `paste` or\n      // any edit action within the decoration to expand the ignored section. We check for\n      // that here and if the section size has changed it should be marked as\n      // invalid and removed from the ignored `DecorationSet`.\n\n      var invalid = decorations.filter(function (_ref4) {\n        var from = _ref4.from,\n            to = _ref4.to,\n            spec = _ref4.spec;\n\n        if (to - from !== spec[\"char\"].length) {\n          return true;\n        }\n\n        return false;\n      });\n      this.ignored = ignored.remove(invalid);\n    }\n    /**\n     * Ignores the match specified. Until the match is deleted no more `onChange`,\n     * `onExit` handlers will be triggered. It will be like the match doesn't\n     * exist.\n     *\n     * @remarks\n     *\n     * All we need to ignore is the match character. This means that any further\n     * matches from the activation character will be ignored.\n     */\n\n  }, {\n    key: \"shouldIgnoreMatch\",\n    value: function shouldIgnoreMatch(_ref5) {\n      var range = _ref5.range,\n          name = _ref5.suggester.name;\n      var decorations = this.ignored.find();\n      return decorations.some(function (_ref6) {\n        var spec = _ref6.spec,\n            from = _ref6.from;\n\n        if (from !== range.from) {\n          return false;\n        }\n\n        var shouldIgnore = spec.specific ? spec.name === name : true;\n        return shouldIgnore;\n      });\n    }\n    /**\n     * Reset the state.\n     */\n\n  }, {\n    key: \"resetState\",\n    value: function resetState() {\n      this.handlerMatches = Object.create(null);\n      this.next = undefined;\n      this.removed = false;\n    }\n    /**\n     * Update the next state value.\n     */\n\n  }, {\n    key: \"updateReasons\",\n    value: function updateReasons(_ref7) {\n      var $pos = _ref7.$pos,\n          state = _ref7.state;\n      var match = findFromSuggesters({\n        suggesters: this.suggesters,\n        $pos: $pos\n      });\n      this.next = match && this.shouldIgnoreMatch(match) ? undefined : match; // Store the matches with reasons\n\n      this.handlerMatches = findReason({\n        next: this.next,\n        prev: this.prev,\n        state: state,\n        $pos: $pos\n      });\n    }\n    /**\n     * Used to handle the view property of the plugin spec.\n     */\n\n  }, {\n    key: \"viewHandler\",\n    value: function viewHandler() {\n      return {\n        update: this.onViewUpdate\n      };\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return this.match;\n    }\n    /**\n     * Applies updates to the state to be used within the plugins apply method.\n     *\n     * @param - params\n     */\n\n  }, {\n    key: \"apply\",\n    value: function apply(_ref8) {\n      var tr = _ref8.tr,\n          newState = _ref8.newState;\n      var exit = this.handlerMatches.exit;\n\n      if (!transactionChanged(tr) && !this.removed) {\n        return this;\n      }\n\n      this.mapIgnoredDecorations(tr); // If the previous run was an exit reset the suggestion matches\n\n      if (exit) {\n        this.resetState();\n      }\n\n      this.prev = this.next; // Match against the current selection position\n\n      this.updateReasons({\n        $pos: tr.selection.$from,\n        state: newState\n      });\n      return this;\n    }\n    /**\n     * Manages the keyDown event within the plugin props\n     *\n     * @param event\n     */\n\n  }, {\n    key: \"handleKeyDown\",\n    value: function handleKeyDown(event) {\n      var match = this.match;\n\n      if (!isValidMatch(match)) {\n        return false;\n      }\n\n      var keyBindings = match.suggester.keyBindings;\n\n      var params = _objectSpread$1({\n        event: event,\n        setMarkRemoved: this.setRemovedTrue\n      }, this.createParams(match));\n\n      return runKeyBindings(keyBindings, params);\n    }\n    /**\n     * Handle any key presses of non supported characters\n     */\n\n  }, {\n    key: \"handleTextInput\",\n    value: function handleTextInput(_ref9) {\n      var text = _ref9.text,\n          from = _ref9.from,\n          to = _ref9.to;\n      var match = this.match;\n\n      if (!isValidMatch(match)) {\n        return false;\n      }\n\n      var onCharacterEntry = match.suggester.onCharacterEntry;\n      return onCharacterEntry(_objectSpread$1({}, this.createParams(match), {\n        from: from,\n        to: to,\n        text: text\n      }));\n    }\n    /**\n     * Handle the decorations which wrap the mention while it is active and not\n     * yet complete.\n     */\n\n  }, {\n    key: \"decorations\",\n    value: function decorations(state) {\n      var match = this.match;\n\n      if (!isValidMatch(match)) {\n        return this.ignored;\n      }\n\n      if (match.suggester.noDecorations) {\n        return this.ignored;\n      }\n\n      var range = match.range,\n          _match$suggester = match.suggester,\n          name = _match$suggester.name,\n          decorationsTag = _match$suggester.suggestTag,\n          suggestionClassName = _match$suggester.suggestClassName;\n      var from = range.from,\n          end = range.end;\n      return this.shouldIgnoreMatch(match) ? this.ignored : this.ignored.add(state.doc, [Decoration.inline(from, end, {\n        nodeName: decorationsTag,\n        \"class\": name ? \"\".concat(suggestionClassName, \" \").concat(suggestionClassName, \"-\").concat(name) : suggestionClassName\n      })]);\n    }\n  }]);\n\n  return SuggestState;\n}();\n\nvar suggestPluginKey = new PluginKey('suggest');\n/**\n * Get the state of the suggest plugin.\n *\n * @param state - the editor state.\n */\n\nvar getSuggestPluginState = function getSuggestPluginState(state) {\n  return getPluginState(suggestPluginKey, state);\n};\n/**\n * This creates a suggestion plugin with all the suggestions provided.\n *\n * @remarks\n *\n * In the following example we're creating an emoji suggestion plugin that\n * responds to the colon character with a query and presents a list of matching\n * emojis based on the query typed so far.\n *\n * ```ts\n * import { Suggester, suggest } from 'prosemirror-suggest';\n *\n * const maxResults = 10;\n * let selectedIndex = 0;\n * let emojiList: string[] = [];\n * let showSuggestions = false;\n *\n * const suggestEmojis: Suggester = {\n *   // By default decorations are used to highlight the currently matched\n *   // suggestion in the dom.\n *   // In this example we don't need decorations (in fact they cause problems when the\n *   // emoji string replaces the query text in the dom).\n *   noDecorations: true,\n *   char: ':', // The character to match against\n *   name: 'emoji-suggestion', // a unique name\n *   appendText: '', // Text to append to the created match\n *\n *   // Keybindings are similar to prosemirror keymaps with a few extra niceties.\n *   // The key identifier can also include modifiers (e.g.) `Cmd-Space: () => false`\n *   // Return true to prevent any further keyboard handlers from running.\n *   keyBindings: {\n *     ArrowUp: () => {\n *       selectedIndex = rotateSelectionBackwards(selectedIndex, emojiList.length);\n *     },\n *     ArrowDown: () => {\n *       selectedIndex = rotateSelectionForwards(selectedIndex, emojiList.length);\n *     },\n *     Enter: ({ command }) => {\n *       if (showSuggestions) {\n *         command(emojiList[selectedIndex]);\n *       }\n *     },\n *     Esc: () => {\n *       showSuggestions = false;\n *     },\n *   },\n *\n *   onChange: params => {\n *     const query = params.query.full;\n *     emojiList = sortEmojiMatches({ query, maxResults });\n *     selectedIndex = 0;\n *     showSuggestions = true;\n *   },\n *\n *   onExit: () => {\n *     showSuggestions = false;\n *     emojiList = [];\n *     selectedIndex = 0;\n *   },\n *\n *   // Create a  function that is passed into the change, exit and keybinding handlers.\n *   // This is useful when these handlers are called in a different part of the app.\n *   createCommand: ({ match, view }) => {\n *     return (emoji,skinVariation) => {\n *       if (!emoji) {\n *         throw new Error('An emoji is required when calling the emoji suggestions command');\n *       }\n *\n *       const tr = view.state.tr; const { from, end: to } = match.range;\n *       tr.insertText(emoji, from, to); view.dispatch(tr);\n *     };\n *   },\n * };\n *\n *  // Create the plugin with the above configuration. It also supports multiple plugins being added.\n * const suggestionPlugin = suggest(suggestEmojis);\n *\n *  // Include the plugin in the created editor state.\n * const state = EditorState.create({schema,\n *   plugins: [suggestionPlugin],\n * });\n * ```\n *\n * The priority of the suggestions is the order in which they are passed into\n * this function.\n *\n * - `const plugin = suggest(two, one, three)` - Here `two` will be checked\n *   first, then `one` and then `three`.\n *\n * Only one suggestion can match at any given time. The order and specificity of\n * the regex parameters help determines which suggestion will be active.\n *\n * @param suggesters - a list of suggesters in the order they should be\n * evaluated.\n */\n\nvar suggest = function suggest() {\n  for (var _len = arguments.length, suggesters = new Array(_len), _key = 0; _key < _len; _key++) {\n    suggesters[_key] = arguments[_key];\n  }\n\n  var pluginState = SuggestState.create(suggesters);\n  return new Plugin({\n    key: suggestPluginKey,\n    // Handle the plugin view\n    view: function view(_view) {\n      return pluginState.init(_view).viewHandler();\n    },\n    state: {\n      // Initialize the state\n      init: function init() {\n        return pluginState;\n      },\n      // Apply changes to the state\n      apply: function apply(tr, _, oldState, newState) {\n        return pluginState.apply({\n          tr: tr,\n          oldState: oldState,\n          newState: newState\n        });\n      }\n    },\n    props: {\n      // Call the keydown hook if suggestion is active.\n      handleKeyDown: function handleKeyDown(_, event) {\n        return pluginState.handleKeyDown(event);\n      },\n      // Defer to the pluginState handler\n      handleTextInput: function handleTextInput(_, from, to, text) {\n        return pluginState.handleTextInput({\n          text: text,\n          from: from,\n          to: to\n        });\n      },\n      // Sets up a decoration (styling options) on the currently active\n      // decoration\n      decorations: function decorations(state) {\n        return pluginState.decorations(state);\n      }\n    }\n  });\n};\n\nexport { ChangeReason, DEFAULT_SUGGESTER, DEFAULT_SUGGEST_ACTIONS, ExitReason, createRegexFromSuggester, escapeChar, getRegexPrefix, getSuggestPluginState, isChange, isChangeReason, isEntry, isExit, isExitReason, isInvalidSplitReason, isJump, isJumpReason, isMove, isRemovedReason, isSplitReason, isValidMatch, regexToString, selectionOutsideMatch, suggest };\n//# sourceMappingURL=prosemirror-suggest.esm.js.map\n","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","'use strict';\n\nconst matchOperatorsRegex = /[|\\\\{}()[\\]^$+*?.-]/g;\n\nmodule.exports = string => {\n\tif (typeof string !== 'string') {\n\t\tthrow new TypeError('Expected a string');\n\t}\n\n\treturn string.replace(matchOperatorsRegex, '\\\\$&');\n};\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction propertyIsOnObject(object, property) {\n\ttry {\n\t\treturn property in object\n\t} catch(_) {\n\t\treturn false\n\t}\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\treturn propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,\n\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","'use strict';\n\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nvar hasProp = Object.prototype.hasOwnProperty;\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    var arrA = isArray(a)\n      , arrB = isArray(b)\n      , i\n      , length\n      , key;\n\n    if (arrA && arrB) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n    if (arrA != arrB) return false;\n\n    var dateA = a instanceof Date\n      , dateB = b instanceof Date;\n    if (dateA != dateB) return false;\n    if (dateA && dateB) return a.getTime() == b.getTime();\n\n    var regexpA = a instanceof RegExp\n      , regexpB = b instanceof RegExp;\n    if (regexpA != regexpB) return false;\n    if (regexpA && regexpB) return a.toString() == b.toString();\n\n    var keys = keyList(a);\n    length = keys.length;\n\n    if (length !== keyList(b).length)\n      return false;\n\n    for (i = length; i-- !== 0;)\n      if (!hasProp.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  return a!==a && b!==b;\n};\n","//\n// Main\n//\n\nfunction memoize (fn, options) {\n  var cache = options && options.cache\n    ? options.cache\n    : cacheDefault\n\n  var serializer = options && options.serializer\n    ? options.serializer\n    : serializerDefault\n\n  var strategy = options && options.strategy\n    ? options.strategy\n    : strategyDefault\n\n  return strategy(fn, {\n    cache: cache,\n    serializer: serializer\n  })\n}\n\n//\n// Strategy\n//\n\nfunction isPrimitive (value) {\n  return value == null || typeof value === 'number' || typeof value === 'boolean' // || typeof value === \"string\" 'unsafe' primitive for our needs\n}\n\nfunction monadic (fn, cache, serializer, arg) {\n  var cacheKey = isPrimitive(arg) ? arg : serializer(arg)\n\n  var computedValue = cache.get(cacheKey)\n  if (typeof computedValue === 'undefined') {\n    computedValue = fn.call(this, arg)\n    cache.set(cacheKey, computedValue)\n  }\n\n  return computedValue\n}\n\nfunction variadic (fn, cache, serializer) {\n  var args = Array.prototype.slice.call(arguments, 3)\n  var cacheKey = serializer(args)\n\n  var computedValue = cache.get(cacheKey)\n  if (typeof computedValue === 'undefined') {\n    computedValue = fn.apply(this, args)\n    cache.set(cacheKey, computedValue)\n  }\n\n  return computedValue\n}\n\nfunction assemble (fn, context, strategy, cache, serialize) {\n  return strategy.bind(\n    context,\n    fn,\n    cache,\n    serialize\n  )\n}\n\nfunction strategyDefault (fn, options) {\n  var strategy = fn.length === 1 ? monadic : variadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\nfunction strategyVariadic (fn, options) {\n  var strategy = variadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\nfunction strategyMonadic (fn, options) {\n  var strategy = monadic\n\n  return assemble(\n    fn,\n    this,\n    strategy,\n    options.cache.create(),\n    options.serializer\n  )\n}\n\n//\n// Serializer\n//\n\nfunction serializerDefault () {\n  return JSON.stringify(arguments)\n}\n\n//\n// Cache\n//\n\nfunction ObjectWithoutPrototypeCache () {\n  this.cache = Object.create(null)\n}\n\nObjectWithoutPrototypeCache.prototype.has = function (key) {\n  return (key in this.cache)\n}\n\nObjectWithoutPrototypeCache.prototype.get = function (key) {\n  return this.cache[key]\n}\n\nObjectWithoutPrototypeCache.prototype.set = function (key, value) {\n  this.cache[key] = value\n}\n\nvar cacheDefault = {\n  create: function create () {\n    return new ObjectWithoutPrototypeCache()\n  }\n}\n\n//\n// API\n//\n\nmodule.exports = memoize\nmodule.exports.strategies = {\n  variadic: strategyVariadic,\n  monadic: strategyMonadic\n}\n","/*!\n * object.omit <https://github.com/jonschlinkert/object.omit>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isObject = require('is-extendable');\n\nmodule.exports = function omit(obj, props, fn) {\n  if (!isObject(obj)) return {};\n\n  if (typeof props === 'function') {\n    fn = props;\n    props = [];\n  }\n\n  if (typeof props === 'string') {\n    props = [props];\n  }\n\n  var isFunction = typeof fn === 'function';\n  var keys = Object.keys(obj);\n  var res = {};\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var val = obj[key];\n\n    if (!props || (props.indexOf(key) === -1 && (!isFunction || fn(val, key, obj)))) {\n      res[key] = val;\n    }\n  }\n  return res;\n};\n","/*!\n * object.pick <https://github.com/jonschlinkert/object.pick>\n *\n * Copyright (c) 2014-2015 Jon Schlinkert, contributors.\n * Licensed under the MIT License\n */\n\n'use strict';\n\nvar isObject = require('isobject');\n\nmodule.exports = function pick(obj, keys) {\n  if (!isObject(obj) && typeof obj !== 'function') {\n    return {};\n  }\n\n  var res = {};\n  if (typeof keys === 'string') {\n    if (keys in obj) {\n      res[keys] = obj[keys];\n    }\n    return res;\n  }\n\n  var len = keys.length;\n  var idx = -1;\n\n  while (++idx < len) {\n    var key = keys[idx];\n    if (key in obj) {\n      res[key] = obj[key];\n    }\n  }\n  return res;\n};\n","// This file replaces `index.js` in bundlers like webpack or Rollup,\n// according to `browser` config in `package.json`.\n\nif (process.env.NODE_ENV !== 'production') {\n  // All bundlers will remove this block in production bundle\n  if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    throw new Error(\n      'React Native does not have a built-in secure random generator. ' +\n      'If you dont need unpredictable IDs, you can use `nanoid/non-secure`. ' +\n      'For secure ID install `expo-random` locally and use `nanoid/async`.'\n    )\n  }\n  if (typeof self === 'undefined' || (!self.crypto && !self.msCrypto)) {\n    throw new Error(\n      'Your browser does not have secure random generator. ' +\n      'If you dont need unpredictable IDs, you can use nanoid/non-secure.'\n    )\n  }\n}\n\nvar crypto = self.crypto || self.msCrypto\n\n// This alphabet uses a-z A-Z 0-9 _- symbols.\n// Symbols are generated for smaller size.\n// -_zyxwvutsrqponmlkjihgfedcba9876543210ZYXWVUTSRQPONMLKJIHGFEDCBA\nvar url = '-_'\n// Loop from 36 to 0 (from z to a and 9 to 0 in Base36).\nvar i = 36\nwhile (i--) {\n  // 36 is radix. Number.prototype.toString(36) returns number\n  // in Base36 representation. Base36 is like hex, but it uses 09 and a-z.\n  url += i.toString(36)\n}\n// Loop from 36 to 10 (from Z to A in Base36).\ni = 36\nwhile (i-- - 10) {\n  url += i.toString(36).toUpperCase()\n}\n\nmodule.exports = function (size) {\n  var id = ''\n  var bytes = crypto.getRandomValues(new Uint8Array(size || 21))\n  i = size || 21\n\n  // Compact alternative for `for (var i = 0; i < size; i++)`\n  while (i--) {\n    // We cant use bytes bigger than the alphabet. 63 is 00111111 bitmask.\n    // This mask reduces random byte 0-255 to 0-63 values.\n    // There is no need in `|| ''` and `* 1.6` hacks in here,\n    // because bitmask trim bytes exact to alphabet size.\n    id += url[bytes[i] & 63]\n  }\n  return id\n}\n","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeReflectConstruct = require(\"./isNativeReflectConstruct\");\n\nfunction _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    module.exports = _construct = Reflect.construct;\n  } else {\n    module.exports = _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nmodule.exports = _construct;","var Document = require('./document.js');\n\nmodule.exports = new Document();\n","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","import { Plugin } from 'prosemirror-state';\nimport { dropPoint } from 'prosemirror-transform';\n\n// :: (options: ?Object)  Plugin\n// Create a plugin that, when added to a ProseMirror instance,\n// causes a decoration to show up at the drop position when something\n// is dragged over the editor.\n//\n//   options::- These options are supported:\n//\n//     color:: ?string\n//     The color of the cursor. Defaults to `black`.\n//\n//     width:: ?number\n//     The precise width of the cursor in pixels. Defaults to 1.\n//\n//     class:: ?string\n//     A CSS class name to add to the cursor element.\nfunction dropCursor(options) {\n  if ( options === void 0 ) options = {};\n\n  return new Plugin({\n    view: function view(editorView) { return new DropCursorView(editorView, options) }\n  })\n}\n\nvar DropCursorView = function DropCursorView(editorView, options) {\n  var this$1 = this;\n\n  this.editorView = editorView;\n  this.width = options.width || 1;\n  this.color = options.color || \"black\";\n  this.class = options.class;\n  this.cursorPos = null;\n  this.element = null;\n  this.timeout = null;\n\n  this.handlers = [\"dragover\", \"dragend\", \"drop\", \"dragleave\"].map(function (name) {\n    var handler = function (e) { return this$1[name](e); };\n    editorView.dom.addEventListener(name, handler);\n    return {name: name, handler: handler}\n  });\n};\n\nDropCursorView.prototype.destroy = function destroy () {\n    var this$1 = this;\n\n  this.handlers.forEach(function (ref) {\n      var name = ref.name;\n      var handler = ref.handler;\n\n      return this$1.editorView.dom.removeEventListener(name, handler);\n    });\n};\n\nDropCursorView.prototype.update = function update (editorView, prevState) {\n  if (this.cursorPos != null && prevState.doc != editorView.state.doc) { this.updateOverlay(); }\n};\n\nDropCursorView.prototype.setCursor = function setCursor (pos) {\n  if (pos == this.cursorPos) { return }\n  this.cursorPos = pos;\n  if (pos == null) {\n    this.element.parentNode.removeChild(this.element);\n    this.element = null;\n  } else {\n    this.updateOverlay();\n  }\n};\n\nDropCursorView.prototype.updateOverlay = function updateOverlay () {\n  var $pos = this.editorView.state.doc.resolve(this.cursorPos), rect;\n  if (!$pos.parent.inlineContent) {\n    var before = $pos.nodeBefore, after = $pos.nodeAfter;\n    if (before || after) {\n      var nodeRect = this.editorView.nodeDOM(this.cursorPos - (before ?before.nodeSize : 0)).getBoundingClientRect();\n      var top = before ? nodeRect.bottom : nodeRect.top;\n      if (before && after)\n        { top = (top + this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top) / 2; }\n      rect = {left: nodeRect.left, right: nodeRect.right, top: top - this.width / 2, bottom: top + this.width / 2};\n    }\n  }\n  if (!rect) {\n    var coords = this.editorView.coordsAtPos(this.cursorPos);\n    rect = {left: coords.left - this.width / 2, right: coords.left + this.width / 2, top: coords.top, bottom: coords.bottom};\n  }\n\n  var parent = this.editorView.dom.offsetParent;\n  if (!this.element) {\n    this.element = parent.appendChild(document.createElement(\"div\"));\n    if (this.class) { this.element.className = this.class; }\n    this.element.style.cssText = \"position: absolute; z-index: 50; pointer-events: none; background-color: \" + this.color;\n  }\n  var parentRect = !parent || parent == document.body && getComputedStyle(parent).position == \"static\"\n      ? {left: -pageXOffset, top: -pageYOffset} : parent.getBoundingClientRect();\n  this.element.style.left = (rect.left - parentRect.left) + \"px\";\n  this.element.style.top = (rect.top - parentRect.top) + \"px\";\n  this.element.style.width = (rect.right - rect.left) + \"px\";\n  this.element.style.height = (rect.bottom - rect.top) + \"px\";\n};\n\nDropCursorView.prototype.scheduleRemoval = function scheduleRemoval (timeout) {\n    var this$1 = this;\n\n  clearTimeout(this.timeout);\n  this.timeout = setTimeout(function () { return this$1.setCursor(null); }, timeout);\n};\n\nDropCursorView.prototype.dragover = function dragover (event) {\n  if (!this.editorView.editable) { return }\n  var pos = this.editorView.posAtCoords({left: event.clientX, top: event.clientY});\n  if (pos) {\n    var target = pos.pos;\n    if (this.editorView.dragging && this.editorView.dragging.slice) {\n      target = dropPoint(this.editorView.state.doc, target, this.editorView.dragging.slice);\n      if (target == null) { target = pos.pos; }\n    }\n    this.setCursor(target);\n    this.scheduleRemoval(5000);\n  }\n};\n\nDropCursorView.prototype.dragend = function dragend () {\n  this.scheduleRemoval(20);\n};\n\nDropCursorView.prototype.drop = function drop () {\n  this.scheduleRemoval(20);\n};\n\nDropCursorView.prototype.dragleave = function dragleave (event) {\n  if (event.target == this.editorView.dom || !this.editorView.dom.contains(event.relatedTarget))\n    { this.setCursor(null); }\n};\n\nexport { dropCursor };\n//# sourceMappingURL=index.es.js.map\n","import { TextSelection, NodeSelection, Selection } from 'prosemirror-state';\nimport { DOMSerializer, Fragment, Mark, DOMParser, Slice } from 'prosemirror-model';\nimport { dropPoint } from 'prosemirror-transform';\n\nvar result = {};\n\nif (typeof navigator != \"undefined\" && typeof document != \"undefined\") {\n  var ie_edge = /Edge\\/(\\d+)/.exec(navigator.userAgent);\n  var ie_upto10 = /MSIE \\d/.test(navigator.userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent);\n\n  result.mac = /Mac/.test(navigator.platform);\n  var ie = result.ie = !!(ie_upto10 || ie_11up || ie_edge);\n  result.ie_version = ie_upto10 ? document.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : null;\n  result.gecko = !ie && /gecko\\/(\\d+)/i.test(navigator.userAgent);\n  result.gecko_version = result.gecko && +(/Firefox\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n  var chrome = !ie && /Chrome\\/(\\d+)/.exec(navigator.userAgent);\n  result.chrome = !!chrome;\n  result.chrome_version = chrome && +chrome[1];\n  // Is true for both iOS and iPadOS for convenience\n  result.safari = !ie && /Apple Computer/.test(navigator.vendor);\n  result.ios = result.safari && (/Mobile\\/\\w+/.test(navigator.userAgent) || navigator.maxTouchPoints > 2);\n  result.android = /Android \\d/.test(navigator.userAgent);\n  result.webkit = \"webkitFontSmoothing\" in document.documentElement.style;\n  result.webkit_version = result.webkit && +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n}\n\nvar domIndex = function(node) {\n  for (var index = 0;; index++) {\n    node = node.previousSibling;\n    if (!node) { return index }\n  }\n};\n\nvar parentNode = function(node) {\n  var parent = node.parentNode;\n  return parent && parent.nodeType == 11 ? parent.host : parent\n};\n\nvar reusedRange = null;\n\n// Note that this will always return the same range, because DOM range\n// objects are every expensive, and keep slowing down subsequent DOM\n// updates, for some reason.\nvar textRange = function(node, from, to) {\n  var range = reusedRange || (reusedRange = document.createRange());\n  range.setEnd(node, to == null ? node.nodeValue.length : to);\n  range.setStart(node, from || 0);\n  return range\n};\n\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nvar isEquivalentPosition = function(node, off, targetNode, targetOff) {\n  return targetNode && (scanFor(node, off, targetNode, targetOff, -1) ||\n                        scanFor(node, off, targetNode, targetOff, 1))\n};\n\nvar atomElements = /^(img|br|input|textarea|hr)$/i;\n\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n  for (;;) {\n    if (node == targetNode && off == targetOff) { return true }\n    if (off == (dir < 0 ? 0 : nodeSize(node))) {\n      var parent = node.parentNode;\n      if (parent.nodeType != 1 || hasBlockDesc(node) || atomElements.test(node.nodeName) || node.contentEditable == \"false\")\n        { return false }\n      off = domIndex(node) + (dir < 0 ? 0 : 1);\n      node = parent;\n    } else if (node.nodeType == 1) {\n      node = node.childNodes[off + (dir < 0 ? -1 : 0)];\n      if (node.contentEditable == \"false\") { return false }\n      off = dir < 0 ? nodeSize(node) : 0;\n    } else {\n      return false\n    }\n  }\n}\n\nfunction nodeSize(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isOnEdge(node, offset, parent) {\n  for (var atStart = offset == 0, atEnd = offset == nodeSize(node); atStart || atEnd;) {\n    if (node == parent) { return true }\n    var index = domIndex(node);\n    node = node.parentNode;\n    if (!node) { return false }\n    atStart = atStart && index == 0;\n    atEnd = atEnd && index == nodeSize(node);\n  }\n}\n\nfunction hasBlockDesc(dom) {\n  var desc;\n  for (var cur = dom; cur; cur = cur.parentNode) { if (desc = cur.pmViewDesc) { break } }\n  return desc && desc.node && desc.node.isBlock && (desc.dom == dom || desc.contentDOM == dom)\n}\n\n// Work around Chrome issue https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n// (isCollapsed inappropriately returns true in shadow dom)\nvar selectionCollapsed = function(domSel) {\n  var collapsed = domSel.isCollapsed;\n  if (collapsed && result.chrome && domSel.rangeCount && !domSel.getRangeAt(0).collapsed)\n    { collapsed = false; }\n  return collapsed\n};\n\nfunction keyEvent(keyCode, key) {\n  var event = document.createEvent(\"Event\");\n  event.initEvent(\"keydown\", true, true);\n  event.keyCode = keyCode;\n  event.key = event.code = key;\n  return event\n}\n\nfunction windowRect(doc) {\n  return {left: 0, right: doc.documentElement.clientWidth,\n          top: 0, bottom: doc.documentElement.clientHeight}\n}\n\nfunction getSide(value, side) {\n  return typeof value == \"number\" ? value : value[side]\n}\n\nfunction clientRect(node) {\n  var rect = node.getBoundingClientRect();\n  // Make sure scrollbar width isn't included in the rectangle\n  return {left: rect.left, right: rect.left + node.clientWidth,\n          top: rect.top, bottom: rect.top + node.clientHeight}\n}\n\nfunction scrollRectIntoView(view, rect, startDOM) {\n  var scrollThreshold = view.someProp(\"scrollThreshold\") || 0, scrollMargin = view.someProp(\"scrollMargin\") || 5;\n  var doc = view.dom.ownerDocument;\n  for (var parent = startDOM || view.dom;; parent = parentNode(parent)) {\n    if (!parent) { break }\n    if (parent.nodeType != 1) { continue }\n    var atTop = parent == doc.body || parent.nodeType != 1;\n    var bounding = atTop ? windowRect(doc) : clientRect(parent);\n    var moveX = 0, moveY = 0;\n    if (rect.top < bounding.top + getSide(scrollThreshold, \"top\"))\n      { moveY = -(bounding.top - rect.top + getSide(scrollMargin, \"top\")); }\n    else if (rect.bottom > bounding.bottom - getSide(scrollThreshold, \"bottom\"))\n      { moveY = rect.bottom - bounding.bottom + getSide(scrollMargin, \"bottom\"); }\n    if (rect.left < bounding.left + getSide(scrollThreshold, \"left\"))\n      { moveX = -(bounding.left - rect.left + getSide(scrollMargin, \"left\")); }\n    else if (rect.right > bounding.right - getSide(scrollThreshold, \"right\"))\n      { moveX = rect.right - bounding.right + getSide(scrollMargin, \"right\"); }\n    if (moveX || moveY) {\n      if (atTop) {\n        doc.defaultView.scrollBy(moveX, moveY);\n      } else {\n        var startX = parent.scrollLeft, startY = parent.scrollTop;\n        if (moveY) { parent.scrollTop += moveY; }\n        if (moveX) { parent.scrollLeft += moveX; }\n        var dX = parent.scrollLeft - startX, dY = parent.scrollTop - startY;\n        rect = {left: rect.left - dX, top: rect.top - dY, right: rect.right - dX, bottom: rect.bottom - dY};\n      }\n    }\n    if (atTop) { break }\n  }\n}\n\n// Store the scroll position of the editor's parent nodes, along with\n// the top position of an element near the top of the editor, which\n// will be used to make sure the visible viewport remains stable even\n// when the size of the content above changes.\nfunction storeScrollPos(view) {\n  var rect = view.dom.getBoundingClientRect(), startY = Math.max(0, rect.top);\n  var refDOM, refTop;\n  for (var x = (rect.left + rect.right) / 2, y = startY + 1;\n       y < Math.min(innerHeight, rect.bottom); y += 5) {\n    var dom = view.root.elementFromPoint(x, y);\n    if (dom == view.dom || !view.dom.contains(dom)) { continue }\n    var localRect = dom.getBoundingClientRect();\n    if (localRect.top >= startY - 20) {\n      refDOM = dom;\n      refTop = localRect.top;\n      break\n    }\n  }\n  return {refDOM: refDOM, refTop: refTop, stack: scrollStack(view.dom)}\n}\n\nfunction scrollStack(dom) {\n  var stack = [], doc = dom.ownerDocument;\n  for (; dom; dom = parentNode(dom)) {\n    stack.push({dom: dom, top: dom.scrollTop, left: dom.scrollLeft});\n    if (dom == doc) { break }\n  }\n  return stack\n}\n\n// Reset the scroll position of the editor's parent nodes to that what\n// it was before, when storeScrollPos was called.\nfunction resetScrollPos(ref) {\n  var refDOM = ref.refDOM;\n  var refTop = ref.refTop;\n  var stack = ref.stack;\n\n  var newRefTop = refDOM ? refDOM.getBoundingClientRect().top : 0;\n  restoreScrollStack(stack, newRefTop == 0 ? 0 : newRefTop - refTop);\n}\n\nfunction restoreScrollStack(stack, dTop) {\n  for (var i = 0; i < stack.length; i++) {\n    var ref = stack[i];\n    var dom = ref.dom;\n    var top = ref.top;\n    var left = ref.left;\n    if (dom.scrollTop != top + dTop) { dom.scrollTop = top + dTop; }\n    if (dom.scrollLeft != left) { dom.scrollLeft = left; }\n  }\n}\n\nvar preventScrollSupported = null;\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nfunction focusPreventScroll(dom) {\n  if (dom.setActive) { return dom.setActive() } // in IE\n  if (preventScrollSupported) { return dom.focus(preventScrollSupported) }\n\n  var stored = scrollStack(dom);\n  dom.focus(preventScrollSupported == null ? {\n    get preventScroll() {\n      preventScrollSupported = {preventScroll: true};\n      return true\n    }\n  } : undefined);\n  if (!preventScrollSupported) {\n    preventScrollSupported = false;\n    restoreScrollStack(stored, 0);\n  }\n}\n\nfunction findOffsetInNode(node, coords) {\n  var closest, dxClosest = 2e8, coordsClosest, offset = 0;\n  var rowBot = coords.top, rowTop = coords.top;\n  for (var child = node.firstChild, childIndex = 0; child; child = child.nextSibling, childIndex++) {\n    var rects = (void 0);\n    if (child.nodeType == 1) { rects = child.getClientRects(); }\n    else if (child.nodeType == 3) { rects = textRange(child).getClientRects(); }\n    else { continue }\n\n    for (var i = 0; i < rects.length; i++) {\n      var rect = rects[i];\n      if (rect.top <= rowBot && rect.bottom >= rowTop) {\n        rowBot = Math.max(rect.bottom, rowBot);\n        rowTop = Math.min(rect.top, rowTop);\n        var dx = rect.left > coords.left ? rect.left - coords.left\n            : rect.right < coords.left ? coords.left - rect.right : 0;\n        if (dx < dxClosest) {\n          closest = child;\n          dxClosest = dx;\n          coordsClosest = dx && closest.nodeType == 3 ? {left: rect.right < coords.left ? rect.right : rect.left, top: coords.top} : coords;\n          if (child.nodeType == 1 && dx)\n            { offset = childIndex + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0); }\n          continue\n        }\n      }\n      if (!closest && (coords.left >= rect.right && coords.top >= rect.top ||\n                       coords.left >= rect.left && coords.top >= rect.bottom))\n        { offset = childIndex + 1; }\n    }\n  }\n  if (closest && closest.nodeType == 3) { return findOffsetInText(closest, coordsClosest) }\n  if (!closest || (dxClosest && closest.nodeType == 1)) { return {node: node, offset: offset} }\n  return findOffsetInNode(closest, coordsClosest)\n}\n\nfunction findOffsetInText(node, coords) {\n  var len = node.nodeValue.length;\n  var range = document.createRange();\n  for (var i = 0; i < len; i++) {\n    range.setEnd(node, i + 1);\n    range.setStart(node, i);\n    var rect = singleRect(range, 1);\n    if (rect.top == rect.bottom) { continue }\n    if (inRect(coords, rect))\n      { return {node: node, offset: i + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)} }\n  }\n  return {node: node, offset: 0}\n}\n\nfunction inRect(coords, rect) {\n  return coords.left >= rect.left - 1 && coords.left <= rect.right + 1&&\n    coords.top >= rect.top - 1 && coords.top <= rect.bottom + 1\n}\n\nfunction targetKludge(dom, coords) {\n  var parent = dom.parentNode;\n  if (parent && /^li$/i.test(parent.nodeName) && coords.left < dom.getBoundingClientRect().left)\n    { return parent }\n  return dom\n}\n\nfunction posFromElement(view, elt, coords) {\n  var ref = findOffsetInNode(elt, coords);\n  var node = ref.node;\n  var offset = ref.offset;\n  var bias = -1;\n  if (node.nodeType == 1 && !node.firstChild) {\n    var rect = node.getBoundingClientRect();\n    bias = rect.left != rect.right && coords.left > (rect.left + rect.right) / 2 ? 1 : -1;\n  }\n  return view.docView.posFromDOM(node, offset, bias)\n}\n\nfunction posFromCaret(view, node, offset, coords) {\n  // Browser (in caretPosition/RangeFromPoint) will agressively\n  // normalize towards nearby inline nodes. Since we are interested in\n  // positions between block nodes too, we first walk up the hierarchy\n  // of nodes to see if there are block nodes that the coordinates\n  // fall outside of. If so, we take the position before/after that\n  // block. If not, we call `posFromDOM` on the raw node/offset.\n  var outside = -1;\n  for (var cur = node;;) {\n    if (cur == view.dom) { break }\n    var desc = view.docView.nearestDesc(cur, true);\n    if (!desc) { return null }\n    if (desc.node.isBlock && desc.parent) {\n      var rect = desc.dom.getBoundingClientRect();\n      if (rect.left > coords.left || rect.top > coords.top) { outside = desc.posBefore; }\n      else if (rect.right < coords.left || rect.bottom < coords.top) { outside = desc.posAfter; }\n      else { break }\n    }\n    cur = desc.dom.parentNode;\n  }\n  return outside > -1 ? outside : view.docView.posFromDOM(node, offset)\n}\n\nfunction elementFromPoint(element, coords, box) {\n  var len = element.childNodes.length;\n  if (len && box.top < box.bottom) {\n    for (var startI = Math.max(0, Math.min(len - 1, Math.floor(len * (coords.top - box.top) / (box.bottom - box.top)) - 2)), i = startI;;) {\n      var child = element.childNodes[i];\n      if (child.nodeType == 1) {\n        var rects = child.getClientRects();\n        for (var j = 0; j < rects.length; j++) {\n          var rect = rects[j];\n          if (inRect(coords, rect)) { return elementFromPoint(child, coords, rect) }\n        }\n      }\n      if ((i = (i + 1) % len) == startI) { break }\n    }\n  }\n  return element\n}\n\n// Given an x,y position on the editor, get the position in the document.\nfunction posAtCoords(view, coords) {\n  var assign, assign$1;\n\n  var root = view.root, node, offset;\n  if (root.caretPositionFromPoint) {\n    try { // Firefox throws for this call in hard-to-predict circumstances (#994)\n      var pos$1 = root.caretPositionFromPoint(coords.left, coords.top);\n      if (pos$1) { ((assign = pos$1, node = assign.offsetNode, offset = assign.offset)); }\n    } catch (_) {}\n  }\n  if (!node && root.caretRangeFromPoint) {\n    var range = root.caretRangeFromPoint(coords.left, coords.top);\n    if (range) { ((assign$1 = range, node = assign$1.startContainer, offset = assign$1.startOffset)); }\n  }\n\n  var elt = root.elementFromPoint(coords.left, coords.top + 1), pos;\n  if (!elt || !view.dom.contains(elt.nodeType != 1 ? elt.parentNode : elt)) {\n    var box = view.dom.getBoundingClientRect();\n    if (!inRect(coords, box)) { return null }\n    elt = elementFromPoint(view.dom, coords, box);\n    if (!elt) { return null }\n  }\n  // Safari's caretRangeFromPoint returns nonsense when on a draggable element\n  if (result.safari && elt.draggable) { node = offset = null; }\n  elt = targetKludge(elt, coords);\n  if (node) {\n    if (result.gecko && node.nodeType == 1) {\n      // Firefox will sometimes return offsets into <input> nodes, which\n      // have no actual children, from caretPositionFromPoint (#953)\n      offset = Math.min(offset, node.childNodes.length);\n      // It'll also move the returned position before image nodes,\n      // even if those are behind it.\n      if (offset < node.childNodes.length) {\n        var next = node.childNodes[offset], box$1;\n        if (next.nodeName == \"IMG\" && (box$1 = next.getBoundingClientRect()).right <= coords.left &&\n            box$1.bottom > coords.top)\n          { offset++; }\n      }\n    }\n    // Suspiciously specific kludge to work around caret*FromPoint\n    // never returning a position at the end of the document\n    if (node == view.dom && offset == node.childNodes.length - 1 && node.lastChild.nodeType == 1 &&\n        coords.top > node.lastChild.getBoundingClientRect().bottom)\n      { pos = view.state.doc.content.size; }\n    // Ignore positions directly after a BR, since caret*FromPoint\n    // 'round up' positions that would be more accurately placed\n    // before the BR node.\n    else if (offset == 0 || node.nodeType != 1 || node.childNodes[offset - 1].nodeName != \"BR\")\n      { pos = posFromCaret(view, node, offset, coords); }\n  }\n  if (pos == null) { pos = posFromElement(view, elt, coords); }\n\n  var desc = view.docView.nearestDesc(elt, true);\n  return {pos: pos, inside: desc ? desc.posAtStart - desc.border : -1}\n}\n\nfunction singleRect(object, bias) {\n  var rects = object.getClientRects();\n  return !rects.length ? object.getBoundingClientRect() : rects[bias < 0 ? 0 : rects.length - 1]\n}\n\nvar BIDI = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n\n// : (EditorView, number, number)  {left: number, top: number, right: number, bottom: number}\n// Given a position in the document model, get a bounding box of the\n// character at that position, relative to the window.\nfunction coordsAtPos(view, pos, side) {\n  var ref = view.docView.domFromPos(pos, side < 0 ? -1 : 1);\n  var node = ref.node;\n  var offset = ref.offset;\n\n  var supportEmptyRange = result.webkit || result.gecko;\n  if (node.nodeType == 3) {\n    // These browsers support querying empty text ranges. Prefer that in\n    // bidi context or when at the end of a node.\n    if (supportEmptyRange && (BIDI.test(node.nodeValue) || (side < 0 ? !offset : offset == node.nodeValue.length))) {\n      var rect = singleRect(textRange(node, offset, offset), side);\n      // Firefox returns bad results (the position before the space)\n      // when querying a position directly after line-broken\n      // whitespace. Detect this situation and and kludge around it\n      if (result.gecko && offset && /\\s/.test(node.nodeValue[offset - 1]) && offset < node.nodeValue.length) {\n        var rectBefore = singleRect(textRange(node, offset - 1, offset - 1), -1);\n        if (rectBefore.top == rect.top) {\n          var rectAfter = singleRect(textRange(node, offset, offset + 1), -1);\n          if (rectAfter.top != rect.top)\n            { return flattenV(rectAfter, rectAfter.left < rectBefore.left) }\n        }\n      }\n      return rect\n    } else {\n      var from = offset, to = offset, takeSide = side < 0 ? 1 : -1;\n      if (side < 0 && !offset) { to++; takeSide = -1; }\n      else if (side >= 0 && offset == node.nodeValue.length) { from--; takeSide = 1; }\n      else if (side < 0) { from--; }\n      else { to ++; }\n      return flattenV(singleRect(textRange(node, from, to), takeSide), takeSide < 0)\n    }\n  }\n\n  // Return a horizontal line in block context\n  if (!view.state.doc.resolve(pos).parent.inlineContent) {\n    if (offset && (side < 0 || offset == nodeSize(node))) {\n      var before = node.childNodes[offset - 1];\n      if (before.nodeType == 1) { return flattenH(before.getBoundingClientRect(), false) }\n    }\n    if (offset < nodeSize(node)) {\n      var after = node.childNodes[offset];\n      if (after.nodeType == 1) { return flattenH(after.getBoundingClientRect(), true) }\n    }\n    return flattenH(node.getBoundingClientRect(), side >= 0)\n  }\n\n  // Inline, not in text node (this is not Bidi-safe)\n  if (offset && (side < 0 || offset == nodeSize(node))) {\n    var before$1 = node.childNodes[offset - 1];\n    var target = before$1.nodeType == 3 ? textRange(before$1, nodeSize(before$1) - (supportEmptyRange ? 0 : 1))\n        // BR nodes tend to only return the rectangle before them.\n        // Only use them if they are the last element in their parent\n        : before$1.nodeType == 1 && (before$1.nodeName != \"BR\" || !before$1.nextSibling) ? before$1 : null;\n    if (target) { return flattenV(singleRect(target, 1), false) }\n  }\n  if (offset < nodeSize(node)) {\n    var after$1 = node.childNodes[offset];\n    var target$1 = after$1.nodeType == 3 ? textRange(after$1, 0, (supportEmptyRange ? 0 : 1))\n        : after$1.nodeType == 1 ? after$1 : null;\n    if (target$1) { return flattenV(singleRect(target$1, -1), true) }\n  }\n  // All else failed, just try to get a rectangle for the target node\n  return flattenV(singleRect(node.nodeType == 3 ? textRange(node) : node, -side), side >= 0)\n}\n\nfunction flattenV(rect, left) {\n  if (rect.width == 0) { return rect }\n  var x = left ? rect.left : rect.right;\n  return {top: rect.top, bottom: rect.bottom, left: x, right: x}\n}\n\nfunction flattenH(rect, top) {\n  if (rect.height == 0) { return rect }\n  var y = top ? rect.top : rect.bottom;\n  return {top: y, bottom: y, left: rect.left, right: rect.right}\n}\n\nfunction withFlushedState(view, state, f) {\n  var viewState = view.state, active = view.root.activeElement;\n  if (viewState != state) { view.updateState(state); }\n  if (active != view.dom) { view.focus(); }\n  try {\n    return f()\n  } finally {\n    if (viewState != state) { view.updateState(viewState); }\n    if (active != view.dom && active) { active.focus(); }\n  }\n}\n\n// : (EditorView, number, number)\n// Whether vertical position motion in a given direction\n// from a position would leave a text block.\nfunction endOfTextblockVertical(view, state, dir) {\n  var sel = state.selection;\n  var $pos = dir == \"up\" ? sel.$from : sel.$to;\n  return withFlushedState(view, state, function () {\n    var ref = view.docView.domFromPos($pos.pos, dir == \"up\" ? -1 : 1);\n    var dom = ref.node;\n    for (;;) {\n      var nearest = view.docView.nearestDesc(dom, true);\n      if (!nearest) { break }\n      if (nearest.node.isBlock) { dom = nearest.dom; break }\n      dom = nearest.dom.parentNode;\n    }\n    var coords = coordsAtPos(view, $pos.pos, 1);\n    for (var child = dom.firstChild; child; child = child.nextSibling) {\n      var boxes = (void 0);\n      if (child.nodeType == 1) { boxes = child.getClientRects(); }\n      else if (child.nodeType == 3) { boxes = textRange(child, 0, child.nodeValue.length).getClientRects(); }\n      else { continue }\n      for (var i = 0; i < boxes.length; i++) {\n        var box = boxes[i];\n        if (box.bottom > box.top && (dir == \"up\" ? box.bottom < coords.top + 1 : box.top > coords.bottom - 1))\n          { return false }\n      }\n    }\n    return true\n  })\n}\n\nvar maybeRTL = /[\\u0590-\\u08ac]/;\n\nfunction endOfTextblockHorizontal(view, state, dir) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  if (!$head.parent.isTextblock) { return false }\n  var offset = $head.parentOffset, atStart = !offset, atEnd = offset == $head.parent.content.size;\n  var sel = getSelection();\n  // If the textblock is all LTR, or the browser doesn't support\n  // Selection.modify (Edge), fall back to a primitive approach\n  if (!maybeRTL.test($head.parent.textContent) || !sel.modify)\n    { return dir == \"left\" || dir == \"backward\" ? atStart : atEnd }\n\n  return withFlushedState(view, state, function () {\n    // This is a huge hack, but appears to be the best we can\n    // currently do: use `Selection.modify` to move the selection by\n    // one character, and see if that moves the cursor out of the\n    // textblock (or doesn't move it at all, when at the start/end of\n    // the document).\n    var oldRange = sel.getRangeAt(0), oldNode = sel.focusNode, oldOff = sel.focusOffset;\n    var oldBidiLevel = sel.caretBidiLevel; // Only for Firefox\n    sel.modify(\"move\", dir, \"character\");\n    var parentDOM = $head.depth ? view.docView.domAfterPos($head.before()) : view.dom;\n    var result = !parentDOM.contains(sel.focusNode.nodeType == 1 ? sel.focusNode : sel.focusNode.parentNode) ||\n        (oldNode == sel.focusNode && oldOff == sel.focusOffset);\n    // Restore the previous selection\n    sel.removeAllRanges();\n    sel.addRange(oldRange);\n    if (oldBidiLevel != null) { sel.caretBidiLevel = oldBidiLevel; }\n    return result\n  })\n}\n\nvar cachedState = null, cachedDir = null, cachedResult = false;\nfunction endOfTextblock(view, state, dir) {\n  if (cachedState == state && cachedDir == dir) { return cachedResult }\n  cachedState = state; cachedDir = dir;\n  return cachedResult = dir == \"up\" || dir == \"down\"\n    ? endOfTextblockVertical(view, state, dir)\n    : endOfTextblockHorizontal(view, state, dir)\n}\n\n// NodeView:: interface\n//\n// By default, document nodes are rendered using the result of the\n// [`toDOM`](#model.NodeSpec.toDOM) method of their spec, and managed\n// entirely by the editor. For some use cases, such as embedded\n// node-specific editing interfaces, you want more control over\n// the behavior of a node's in-editor representation, and need to\n// [define](#view.EditorProps.nodeViews) a custom node view.\n//\n// Mark views only support `dom` and `contentDOM`, and don't support\n// any of the node view methods.\n//\n// Objects returned as node views must conform to this interface.\n//\n//   dom:: ?dom.Node\n//   The outer DOM node that represents the document node. When not\n//   given, the default strategy is used to create a DOM node.\n//\n//   contentDOM:: ?dom.Node\n//   The DOM node that should hold the node's content. Only meaningful\n//   if the node view also defines a `dom` property and if its node\n//   type is not a leaf node type. When this is present, ProseMirror\n//   will take care of rendering the node's children into it. When it\n//   is not present, the node view itself is responsible for rendering\n//   (or deciding not to render) its child nodes.\n//\n//   update:: ?(node: Node, decorations: [Decoration])  bool\n//   When given, this will be called when the view is updating itself.\n//   It will be given a node (possibly of a different type), and an\n//   array of active decorations (which are automatically drawn, and\n//   the node view may ignore if it isn't interested in them), and\n//   should return true if it was able to update to that node, and\n//   false otherwise. If the node view has a `contentDOM` property (or\n//   no `dom` property), updating its child nodes will be handled by\n//   ProseMirror.\n//\n//   selectNode:: ?()\n//   Can be used to override the way the node's selected status (as a\n//   node selection) is displayed.\n//\n//   deselectNode:: ?()\n//   When defining a `selectNode` method, you should also provide a\n//   `deselectNode` method to remove the effect again.\n//\n//   setSelection:: ?(anchor: number, head: number, root: dom.Document)\n//   This will be called to handle setting the selection inside the\n//   node. The `anchor` and `head` positions are relative to the start\n//   of the node. By default, a DOM selection will be created between\n//   the DOM positions corresponding to those positions, but if you\n//   override it you can do something else.\n//\n//   stopEvent:: ?(event: dom.Event)  bool\n//   Can be used to prevent the editor view from trying to handle some\n//   or all DOM events that bubble up from the node view. Events for\n//   which this returns true are not handled by the editor.\n//\n//   ignoreMutation:: ?(dom.MutationRecord)  bool\n//   Called when a DOM\n//   [mutation](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)\n//   or a selection change happens within the view. When the change is\n//   a selection change, the record will have a `type` property of\n//   `\"selection\"` (which doesn't occur for native mutation records).\n//   Return false if the editor should re-read the selection or\n//   re-parse the range around the mutation, true if it can safely be\n//   ignored.\n//\n//   destroy:: ?()\n//   Called when the node view is removed from the editor or the whole\n//   editor is destroyed.\n\n// View descriptions are data structures that describe the DOM that is\n// used to represent the editor's content. They are used for:\n//\n// - Incremental redrawing when the document changes\n//\n// - Figuring out what part of the document a given DOM position\n//   corresponds to\n//\n// - Wiring in custom implementations of the editing interface for a\n//   given node\n//\n// They form a doubly-linked mutable tree, starting at `view.docView`.\n\nvar NOT_DIRTY = 0, CHILD_DIRTY = 1, CONTENT_DIRTY = 2, NODE_DIRTY = 3;\n\n// Superclass for the various kinds of descriptions. Defines their\n// basic structure and shared methods.\nvar ViewDesc = function ViewDesc(parent, children, dom, contentDOM) {\n  this.parent = parent;\n  this.children = children;\n  this.dom = dom;\n  // An expando property on the DOM node provides a link back to its\n  // description.\n  dom.pmViewDesc = this;\n  // This is the node that holds the child views. It may be null for\n  // descs that don't have children.\n  this.contentDOM = contentDOM;\n  this.dirty = NOT_DIRTY;\n};\n\nvar prototypeAccessors = { beforePosition: { configurable: true },size: { configurable: true },border: { configurable: true },posBefore: { configurable: true },posAtStart: { configurable: true },posAfter: { configurable: true },posAtEnd: { configurable: true },contentLost: { configurable: true },domAtom: { configurable: true } };\n\n// Used to check whether a given description corresponds to a\n// widget/mark/node.\nViewDesc.prototype.matchesWidget = function matchesWidget () { return false };\nViewDesc.prototype.matchesMark = function matchesMark () { return false };\nViewDesc.prototype.matchesNode = function matchesNode () { return false };\nViewDesc.prototype.matchesHack = function matchesHack () { return false };\n\nprototypeAccessors.beforePosition.get = function () { return false };\n\n// : ()  ?ParseRule\n// When parsing in-editor content (in domchange.js), we allow\n// descriptions to determine the parse rules that should be used to\n// parse them.\nViewDesc.prototype.parseRule = function parseRule () { return null };\n\n// : (dom.Event)  bool\n// Used by the editor's event handler to ignore events that come\n// from certain descs.\nViewDesc.prototype.stopEvent = function stopEvent () { return false };\n\n// The size of the content represented by this desc.\nprototypeAccessors.size.get = function () {\n  var size = 0;\n  for (var i = 0; i < this.children.length; i++) { size += this.children[i].size; }\n  return size\n};\n\n// For block nodes, this represents the space taken up by their\n// start/end tokens.\nprototypeAccessors.border.get = function () { return 0 };\n\nViewDesc.prototype.destroy = function destroy () {\n  this.parent = null;\n  if (this.dom.pmViewDesc == this) { this.dom.pmViewDesc = null; }\n  for (var i = 0; i < this.children.length; i++)\n    { this.children[i].destroy(); }\n};\n\nViewDesc.prototype.posBeforeChild = function posBeforeChild (child) {\n  for (var i = 0, pos = this.posAtStart; i < this.children.length; i++) {\n    var cur = this.children[i];\n    if (cur == child) { return pos }\n    pos += cur.size;\n  }\n};\n\nprototypeAccessors.posBefore.get = function () {\n  return this.parent.posBeforeChild(this)\n};\n\nprototypeAccessors.posAtStart.get = function () {\n  return this.parent ? this.parent.posBeforeChild(this) + this.border : 0\n};\n\nprototypeAccessors.posAfter.get = function () {\n  return this.posBefore + this.size\n};\n\nprototypeAccessors.posAtEnd.get = function () {\n  return this.posAtStart + this.size - 2 * this.border\n};\n\n// : (dom.Node, number, ?number)  number\nViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n  // If the DOM position is in the content, use the child desc after\n  // it to figure out a position.\n  if (this.contentDOM && this.contentDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode)) {\n    if (bias < 0) {\n      var domBefore, desc;\n      if (dom == this.contentDOM) {\n        domBefore = dom.childNodes[offset - 1];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domBefore = dom.previousSibling;\n      }\n      while (domBefore && !((desc = domBefore.pmViewDesc) && desc.parent == this)) { domBefore = domBefore.previousSibling; }\n      return domBefore ? this.posBeforeChild(desc) + desc.size : this.posAtStart\n    } else {\n      var domAfter, desc$1;\n      if (dom == this.contentDOM) {\n        domAfter = dom.childNodes[offset];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domAfter = dom.nextSibling;\n      }\n      while (domAfter && !((desc$1 = domAfter.pmViewDesc) && desc$1.parent == this)) { domAfter = domAfter.nextSibling; }\n      return domAfter ? this.posBeforeChild(desc$1) : this.posAtEnd\n    }\n  }\n  // Otherwise, use various heuristics, falling back on the bias\n  // parameter, to determine whether to return the position at the\n  // start or at the end of this view desc.\n  var atEnd;\n  if (this.contentDOM && this.contentDOM != this.dom && this.dom.contains(this.contentDOM)) {\n    atEnd = dom.compareDocumentPosition(this.contentDOM) & 2;\n  } else if (this.dom.firstChild) {\n    if (offset == 0) { for (var search = dom;; search = search.parentNode) {\n      if (search == this.dom) { atEnd = false; break }\n      if (search.parentNode.firstChild != search) { break }\n    } }\n    if (atEnd == null && offset == dom.childNodes.length) { for (var search$1 = dom;; search$1 = search$1.parentNode) {\n      if (search$1 == this.dom) { atEnd = true; break }\n      if (search$1.parentNode.lastChild != search$1) { break }\n    } }\n  }\n  return (atEnd == null ? bias > 0 : atEnd) ? this.posAtEnd : this.posAtStart\n};\n\n// Scan up the dom finding the first desc that is a descendant of\n// this one.\nViewDesc.prototype.nearestDesc = function nearestDesc (dom, onlyNodes) {\n  for (var first = true, cur = dom; cur; cur = cur.parentNode) {\n    var desc = this.getDesc(cur);\n    if (desc && (!onlyNodes || desc.node)) {\n      // If dom is outside of this desc's nodeDOM, don't count it.\n      if (first && desc.nodeDOM &&\n          !(desc.nodeDOM.nodeType == 1 ? desc.nodeDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode) : desc.nodeDOM == dom))\n        { first = false; }\n      else\n        { return desc }\n    }\n  }\n};\n\nViewDesc.prototype.getDesc = function getDesc (dom) {\n  var desc = dom.pmViewDesc;\n  for (var cur = desc; cur; cur = cur.parent) { if (cur == this) { return desc } }\n};\n\nViewDesc.prototype.posFromDOM = function posFromDOM (dom, offset, bias) {\n  for (var scan = dom; scan; scan = scan.parentNode) {\n    var desc = this.getDesc(scan);\n    if (desc) { return desc.localPosFromDOM(dom, offset, bias) }\n  }\n  return -1\n};\n\n// : (number)  ?NodeViewDesc\n// Find the desc for the node after the given pos, if any. (When a\n// parent node overrode rendering, there might not be one.)\nViewDesc.prototype.descAt = function descAt (pos) {\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == pos && end != offset) {\n      while (!child.border && child.children.length) { child = child.children[0]; }\n      return child\n    }\n    if (pos < end) { return child.descAt(pos - offset - child.border) }\n    offset = end;\n  }\n};\n\n// : (number, number)  {node: dom.Node, offset: number}\nViewDesc.prototype.domFromPos = function domFromPos (pos, side) {\n  if (!this.contentDOM) { return {node: this.dom, offset: 0} }\n  for (var offset = 0, i = 0, first = true;; i++, first = false) {\n    // Skip removed or always-before children\n    while (i < this.children.length && (this.children[i].beforePosition ||\n                                        this.children[i].dom.parentNode != this.contentDOM))\n      { offset += this.children[i++].size; }\n    var child = i == this.children.length ? null : this.children[i];\n    if (offset == pos && (side == 0 || !child || child.border || (side < 0 && first)) ||\n        child && child.domAtom && pos < offset + child.size) { return {\n      node: this.contentDOM,\n      offset: child ? domIndex(child.dom) : this.contentDOM.childNodes.length\n    } }\n    if (!child) { throw new Error(\"Invalid position \" + pos) }\n    var end = offset + child.size;\n    if (!child.domAtom && (side < 0 && !child.border ? end >= pos : end > pos))\n      { return child.domFromPos(pos - offset - child.border, side) }\n    offset = end;\n  }\n};\n\n// Used to find a DOM range in a single parent for a given changed\n// range.\nViewDesc.prototype.parseRange = function parseRange (from, to, base) {\n    if ( base === void 0 ) base = 0;\n\n  if (this.children.length == 0)\n    { return {node: this.contentDOM, from: from, to: to, fromOffset: 0, toOffset: this.contentDOM.childNodes.length} }\n\n  var fromOffset = -1, toOffset = -1;\n  for (var offset = base, i = 0;; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (fromOffset == -1 && from <= end) {\n      var childBase = offset + child.border;\n      // FIXME maybe descend mark views to parse a narrower range?\n      if (from >= childBase && to <= end - child.border && child.node &&\n          child.contentDOM && this.contentDOM.contains(child.contentDOM))\n        { return child.parseRange(from, to, childBase) }\n\n      from = offset;\n      for (var j = i; j > 0; j--) {\n        var prev = this.children[j - 1];\n        if (prev.size && prev.dom.parentNode == this.contentDOM && !prev.emptyChildAt(1)) {\n          fromOffset = domIndex(prev.dom) + 1;\n          break\n        }\n        from -= prev.size;\n      }\n      if (fromOffset == -1) { fromOffset = 0; }\n    }\n    if (fromOffset > -1 && (end > to || i == this.children.length - 1)) {\n      to = end;\n      for (var j$1 = i + 1; j$1 < this.children.length; j$1++) {\n        var next = this.children[j$1];\n        if (next.size && next.dom.parentNode == this.contentDOM && !next.emptyChildAt(-1)) {\n          toOffset = domIndex(next.dom);\n          break\n        }\n        to += next.size;\n      }\n      if (toOffset == -1) { toOffset = this.contentDOM.childNodes.length; }\n      break\n    }\n    offset = end;\n  }\n  return {node: this.contentDOM, from: from, to: to, fromOffset: fromOffset, toOffset: toOffset}\n};\n\nViewDesc.prototype.emptyChildAt = function emptyChildAt (side) {\n  if (this.border || !this.contentDOM || !this.children.length) { return false }\n  var child = this.children[side < 0 ? 0 : this.children.length - 1];\n  return child.size == 0 || child.emptyChildAt(side)\n};\n\n// : (number)  dom.Node\nViewDesc.prototype.domAfterPos = function domAfterPos (pos) {\n  var ref = this.domFromPos(pos, 0);\n    var node = ref.node;\n    var offset = ref.offset;\n  if (node.nodeType != 1 || offset == node.childNodes.length)\n    { throw new RangeError(\"No node after pos \" + pos) }\n  return node.childNodes[offset]\n};\n\n// : (number, number, dom.Document)\n// View descs are responsible for setting any selection that falls\n// entirely inside of them, so that custom implementations can do\n// custom things with the selection. Note that this falls apart when\n// a selection starts in such a node and ends in another, in which\n// case we just use whatever domFromPos produces as a best effort.\nViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n  // If the selection falls entirely in a child, give it to that child\n  var from = Math.min(anchor, head), to = Math.max(anchor, head);\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (from > offset && to < end)\n      { return child.setSelection(anchor - offset - child.border, head - offset - child.border, root, force) }\n    offset = end;\n  }\n\n  var anchorDOM = this.domFromPos(anchor, anchor ? -1 : 1);\n  var headDOM = head == anchor ? anchorDOM : this.domFromPos(head, head ? -1 : 1);\n  var domSel = root.getSelection();\n\n  var brKludge = false;\n  // On Firefox, using Selection.collapse to put the cursor after a\n  // BR node for some reason doesn't always work (#1073). On Safari,\n  // the cursor sometimes inexplicable visually lags behind its\n  // reported position in such situations (#1092).\n  if ((result.gecko || result.safari) && anchor == head) {\n    if (anchorDOM.node.nodeType == 3) {\n      brKludge = anchorDOM.offset && anchorDOM.node.nodeValue[anchorDOM.offset - 1] == \"\\n\";\n    } else {\n      var prev = anchorDOM.node.childNodes[anchorDOM.offset - 1];\n      brKludge = prev && (prev.nodeName == \"BR\" || prev.contentEditable == \"false\");\n    }\n  }\n\n  if (!(force || brKludge && result.safari) &&\n      isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset) &&\n      isEquivalentPosition(headDOM.node, headDOM.offset, domSel.focusNode, domSel.focusOffset))\n    { return }\n\n  // Selection.extend can be used to create an 'inverted' selection\n  // (one where the focus is before the anchor), but not all\n  // browsers support it yet.\n  var domSelExtended = false;\n  if ((domSel.extend || anchor == head) && !brKludge) {\n    domSel.collapse(anchorDOM.node, anchorDOM.offset);\n    try {\n      if (anchor != head) { domSel.extend(headDOM.node, headDOM.offset); }\n      domSelExtended = true;\n    } catch (err) {\n      // In some cases with Chrome the selection is empty after calling\n      // collapse, even when it should be valid. This appears to be a bug, but\n      // it is difficult to isolate. If this happens fallback to the old path\n      // without using extend.\n      if (!(err instanceof DOMException)) { throw err }\n      // declare global: DOMException\n    }\n  }\n  if (!domSelExtended) {\n    if (anchor > head) { var tmp = anchorDOM; anchorDOM = headDOM; headDOM = tmp; }\n    var range = document.createRange();\n    range.setEnd(headDOM.node, headDOM.offset);\n    range.setStart(anchorDOM.node, anchorDOM.offset);\n    domSel.removeAllRanges();\n    domSel.addRange(range);\n  }\n};\n\n// : (dom.MutationRecord)  bool\nViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n  return !this.contentDOM && mutation.type != \"selection\"\n};\n\nprototypeAccessors.contentLost.get = function () {\n  return this.contentDOM && this.contentDOM != this.dom && !this.dom.contains(this.contentDOM)\n};\n\n// Remove a subtree of the element tree that has been touched\n// by a DOM change, so that the next update will redraw it.\nViewDesc.prototype.markDirty = function markDirty (from, to) {\n  for (var offset = 0, i = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == end ? from <= end && to >= offset : from < end && to > offset) {\n      var startInside = offset + child.border, endInside = end - child.border;\n      if (from >= startInside && to <= endInside) {\n        this.dirty = from == offset || to == end ? CONTENT_DIRTY : CHILD_DIRTY;\n        if (from == startInside && to == endInside &&\n            (child.contentLost || child.dom.parentNode != this.contentDOM)) { child.dirty = NODE_DIRTY; }\n        else { child.markDirty(from - startInside, to - startInside); }\n        return\n      } else {\n        child.dirty = NODE_DIRTY;\n      }\n    }\n    offset = end;\n  }\n  this.dirty = CONTENT_DIRTY;\n};\n\nViewDesc.prototype.markParentsDirty = function markParentsDirty () {\n  var level = 1;\n  for (var node = this.parent; node; node = node.parent, level++) {\n    var dirty = level == 1 ? CONTENT_DIRTY : CHILD_DIRTY;\n    if (node.dirty < dirty) { node.dirty = dirty; }\n  }\n};\n\nprototypeAccessors.domAtom.get = function () { return false };\n\nObject.defineProperties( ViewDesc.prototype, prototypeAccessors );\n\n// Reused array to avoid allocating fresh arrays for things that will\n// stay empty anyway.\nvar nothing = [];\n\n// A widget desc represents a widget decoration, which is a DOM node\n// drawn between the document nodes.\nvar WidgetViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function WidgetViewDesc(parent, widget, view, pos) {\n    var self, dom = widget.type.toDOM;\n    if (typeof dom == \"function\") { dom = dom(view, function () {\n      if (!self) { return pos }\n      if (self.parent) { return self.parent.posBeforeChild(self) }\n    }); }\n    if (!widget.type.spec.raw) {\n      if (dom.nodeType != 1) {\n        var wrap = document.createElement(\"span\");\n        wrap.appendChild(dom);\n        dom = wrap;\n      }\n      dom.contentEditable = false;\n      dom.classList.add(\"ProseMirror-widget\");\n    }\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.widget = widget;\n    self = this;\n  }\n\n  if ( ViewDesc ) WidgetViewDesc.__proto__ = ViewDesc;\n  WidgetViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  WidgetViewDesc.prototype.constructor = WidgetViewDesc;\n\n  var prototypeAccessors$1 = { beforePosition: { configurable: true },domAtom: { configurable: true } };\n\n  prototypeAccessors$1.beforePosition.get = function () {\n    return this.widget.type.side < 0\n  };\n\n  WidgetViewDesc.prototype.matchesWidget = function matchesWidget (widget) {\n    return this.dirty == NOT_DIRTY && widget.type.eq(this.widget.type)\n  };\n\n  WidgetViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n\n  WidgetViewDesc.prototype.stopEvent = function stopEvent (event) {\n    var stop = this.widget.spec.stopEvent;\n    return stop ? stop(event) : false\n  };\n\n  WidgetViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"selection\" || this.widget.spec.ignoreSelection\n  };\n\n  prototypeAccessors$1.domAtom.get = function () { return true };\n\n  Object.defineProperties( WidgetViewDesc.prototype, prototypeAccessors$1 );\n\n  return WidgetViewDesc;\n}(ViewDesc));\n\nvar CompositionViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function CompositionViewDesc(parent, dom, textDOM, text) {\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.textDOM = textDOM;\n    this.text = text;\n  }\n\n  if ( ViewDesc ) CompositionViewDesc.__proto__ = ViewDesc;\n  CompositionViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  CompositionViewDesc.prototype.constructor = CompositionViewDesc;\n\n  var prototypeAccessors$2 = { size: { configurable: true } };\n\n  prototypeAccessors$2.size.get = function () { return this.text.length };\n\n  CompositionViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset) {\n    if (dom != this.textDOM) { return this.posAtStart + (offset ? this.size : 0) }\n    return this.posAtStart + offset\n  };\n\n  CompositionViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.textDOM, offset: pos}\n  };\n\n  CompositionViewDesc.prototype.ignoreMutation = function ignoreMutation (mut) {\n    return mut.type === 'characterData' && mut.target.nodeValue == mut.oldValue\n   };\n\n  Object.defineProperties( CompositionViewDesc.prototype, prototypeAccessors$2 );\n\n  return CompositionViewDesc;\n}(ViewDesc));\n\n// A mark desc represents a mark. May have multiple children,\n// depending on how the mark is split. Note that marks are drawn using\n// a fixed nesting order, for simplicity and predictability, so in\n// some cases they will be split more often than would appear\n// necessary.\nvar MarkViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function MarkViewDesc(parent, mark, dom, contentDOM) {\n    ViewDesc.call(this, parent, [], dom, contentDOM);\n    this.mark = mark;\n  }\n\n  if ( ViewDesc ) MarkViewDesc.__proto__ = ViewDesc;\n  MarkViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  MarkViewDesc.prototype.constructor = MarkViewDesc;\n\n  MarkViewDesc.create = function create (parent, mark, inline, view) {\n    var custom = view.nodeViews[mark.type.name];\n    var spec = custom && custom(mark, view, inline);\n    if (!spec || !spec.dom)\n      { spec = DOMSerializer.renderSpec(document, mark.type.spec.toDOM(mark, inline)); }\n    return new MarkViewDesc(parent, mark, spec.dom, spec.contentDOM || spec.dom)\n  };\n\n  MarkViewDesc.prototype.parseRule = function parseRule () { return {mark: this.mark.type.name, attrs: this.mark.attrs, contentElement: this.contentDOM} };\n\n  MarkViewDesc.prototype.matchesMark = function matchesMark (mark) { return this.dirty != NODE_DIRTY && this.mark.eq(mark) };\n\n  MarkViewDesc.prototype.markDirty = function markDirty (from, to) {\n    ViewDesc.prototype.markDirty.call(this, from, to);\n    // Move dirty info to nearest node view\n    if (this.dirty != NOT_DIRTY) {\n      var parent = this.parent;\n      while (!parent.node) { parent = parent.parent; }\n      if (parent.dirty < this.dirty) { parent.dirty = this.dirty; }\n      this.dirty = NOT_DIRTY;\n    }\n  };\n\n  MarkViewDesc.prototype.slice = function slice (from, to, view) {\n    var copy = MarkViewDesc.create(this.parent, this.mark, true, view);\n    var nodes = this.children, size = this.size;\n    if (to < size) { nodes = replaceNodes(nodes, to, size, view); }\n    if (from > 0) { nodes = replaceNodes(nodes, 0, from, view); }\n    for (var i = 0; i < nodes.length; i++) { nodes[i].parent = copy; }\n    copy.children = nodes;\n    return copy\n  };\n\n  return MarkViewDesc;\n}(ViewDesc));\n\n// Node view descs are the main, most common type of view desc, and\n// correspond to an actual node in the document. Unlike mark descs,\n// they populate their child array themselves.\nvar NodeViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos) {\n    ViewDesc.call(this, parent, node.isLeaf ? nothing : [], dom, contentDOM);\n    this.nodeDOM = nodeDOM;\n    this.node = node;\n    this.outerDeco = outerDeco;\n    this.innerDeco = innerDeco;\n    if (contentDOM) { this.updateChildren(view, pos); }\n  }\n\n  if ( ViewDesc ) NodeViewDesc.__proto__ = ViewDesc;\n  NodeViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  NodeViewDesc.prototype.constructor = NodeViewDesc;\n\n  var prototypeAccessors$3 = { size: { configurable: true },border: { configurable: true },domAtom: { configurable: true } };\n\n  // By default, a node is rendered using the `toDOM` method from the\n  // node type spec. But client code can use the `nodeViews` spec to\n  // supply a custom node view, which can influence various aspects of\n  // the way the node works.\n  //\n  // (Using subclassing for this was intentionally decided against,\n  // since it'd require exposing a whole slew of finnicky\n  // implementation details to the user code that they probably will\n  // never need.)\n  NodeViewDesc.create = function create (parent, node, outerDeco, innerDeco, view, pos) {\n    var assign;\n\n    var custom = view.nodeViews[node.type.name], descObj;\n    var spec = custom && custom(node, view, function () {\n      // (This is a function that allows the custom view to find its\n      // own position)\n      if (!descObj) { return pos }\n      if (descObj.parent) { return descObj.parent.posBeforeChild(descObj) }\n    }, outerDeco);\n\n    var dom = spec && spec.dom, contentDOM = spec && spec.contentDOM;\n    if (node.isText) {\n      if (!dom) { dom = document.createTextNode(node.text); }\n      else if (dom.nodeType != 3) { throw new RangeError(\"Text must be rendered as a DOM text node\") }\n    } else if (!dom) {\n((assign = DOMSerializer.renderSpec(document, node.type.spec.toDOM(node)), dom = assign.dom, contentDOM = assign.contentDOM));\n    }\n    if (!contentDOM && !node.isText && dom.nodeName != \"BR\") { // Chrome gets confused by <br contenteditable=false>\n      if (!dom.hasAttribute(\"contenteditable\")) { dom.contentEditable = false; }\n      if (node.type.spec.draggable) { dom.draggable = true; }\n    }\n\n    var nodeDOM = dom;\n    dom = applyOuterDeco(dom, outerDeco, node);\n\n    if (spec)\n      { return descObj = new CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM,\n                                              spec, view, pos + 1) }\n    else if (node.isText)\n      { return new TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) }\n    else\n      { return new NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos + 1) }\n  };\n\n  NodeViewDesc.prototype.parseRule = function parseRule () {\n    var this$1 = this;\n\n    // Experimental kludge to allow opt-in re-parsing of nodes\n    if (this.node.type.spec.reparseInView) { return null }\n    // FIXME the assumption that this can always return the current\n    // attrs means that if the user somehow manages to change the\n    // attrs in the dom, that won't be picked up. Not entirely sure\n    // whether this is a problem\n    var rule = {node: this.node.type.name, attrs: this.node.attrs};\n    if (this.node.type.spec.code) { rule.preserveWhitespace = \"full\"; }\n    if (this.contentDOM && !this.contentLost) { rule.contentElement = this.contentDOM; }\n    else { rule.getContent = function () { return this$1.contentDOM ? Fragment.empty : this$1.node.content; }; }\n    return rule\n  };\n\n  NodeViewDesc.prototype.matchesNode = function matchesNode (node, outerDeco, innerDeco) {\n    return this.dirty == NOT_DIRTY && node.eq(this.node) &&\n      sameOuterDeco(outerDeco, this.outerDeco) && innerDeco.eq(this.innerDeco)\n  };\n\n  prototypeAccessors$3.size.get = function () { return this.node.nodeSize };\n\n  prototypeAccessors$3.border.get = function () { return this.node.isLeaf ? 0 : 1 };\n\n  // Syncs `this.children` to match `this.node.content` and the local\n  // decorations, possibly introducing nesting for marks. Then, in a\n  // separate step, syncs the DOM inside `this.contentDOM` to\n  // `this.children`.\n  NodeViewDesc.prototype.updateChildren = function updateChildren (view, pos) {\n    var this$1 = this;\n\n    var inline = this.node.inlineContent, off = pos;\n    var composition = inline && view.composing && this.localCompositionNode(view, pos);\n    var updater = new ViewTreeUpdater(this, composition && composition.node);\n    iterDeco(this.node, this.innerDeco, function (widget, i, insideNode) {\n      if (widget.spec.marks)\n        { updater.syncToMarks(widget.spec.marks, inline, view); }\n      else if (widget.type.side >= 0 && !insideNode)\n        { updater.syncToMarks(i == this$1.node.childCount ? Mark.none : this$1.node.child(i).marks, inline, view); }\n      // If the next node is a desc matching this widget, reuse it,\n      // otherwise insert the widget as a new view desc.\n      updater.placeWidget(widget, view, off);\n    }, function (child, outerDeco, innerDeco, i) {\n      // Make sure the wrapping mark descs match the node's marks.\n      updater.syncToMarks(child.marks, inline, view);\n      // Either find an existing desc that exactly matches this node,\n      // and drop the descs before it.\n      updater.findNodeMatch(child, outerDeco, innerDeco, i) ||\n        // Or try updating the next desc to reflect this node.\n        updater.updateNextNode(child, outerDeco, innerDeco, view, i) ||\n        // Or just add it as a new desc.\n        updater.addNode(child, outerDeco, innerDeco, view, off);\n      off += child.nodeSize;\n    });\n    // Drop all remaining descs after the current position.\n    updater.syncToMarks(nothing, inline, view);\n    if (this.node.isTextblock) { updater.addTextblockHacks(); }\n    updater.destroyRest();\n\n    // Sync the DOM if anything changed\n    if (updater.changed || this.dirty == CONTENT_DIRTY) {\n      // May have to protect focused DOM from being changed if a composition is active\n      if (composition) { this.protectLocalComposition(view, composition); }\n      renderDescs(this.contentDOM, this.children, view);\n      if (result.ios) { iosHacks(this.dom); }\n    }\n  };\n\n  NodeViewDesc.prototype.localCompositionNode = function localCompositionNode (view, pos) {\n    // Only do something if both the selection and a focused text node\n    // are inside of this node, and the node isn't already part of a\n    // view that's a child of this view\n    var ref = view.state.selection;\n    var from = ref.from;\n    var to = ref.to;\n    if (!(view.state.selection instanceof TextSelection) || from < pos || to > pos + this.node.content.size) { return }\n    var sel = view.root.getSelection();\n    var textNode = nearbyTextNode(sel.focusNode, sel.focusOffset);\n    if (!textNode || !this.dom.contains(textNode.parentNode)) { return }\n\n    // Find the text in the focused node in the node, stop if it's not\n    // there (may have been modified through other means, in which\n    // case it should overwritten)\n    var text = textNode.nodeValue;\n    var textPos = findTextInFragment(this.node.content, text, from - pos, to - pos);\n\n    return textPos < 0 ? null : {node: textNode, pos: textPos, text: text}\n  };\n\n  NodeViewDesc.prototype.protectLocalComposition = function protectLocalComposition (view, ref) {\n    var node = ref.node;\n    var pos = ref.pos;\n    var text = ref.text;\n\n    // The node is already part of a local view desc, leave it there\n    if (this.getDesc(node)) { return }\n\n    // Create a composition view for the orphaned nodes\n    var topNode = node;\n    for (;; topNode = topNode.parentNode) {\n      if (topNode.parentNode == this.contentDOM) { break }\n      while (topNode.previousSibling) { topNode.parentNode.removeChild(topNode.previousSibling); }\n      while (topNode.nextSibling) { topNode.parentNode.removeChild(topNode.nextSibling); }\n      if (topNode.pmViewDesc) { topNode.pmViewDesc = null; }\n    }\n    var desc = new CompositionViewDesc(this, topNode, node, text);\n    view.compositionNodes.push(desc);\n\n    // Patch up this.children to contain the composition view\n    this.children = replaceNodes(this.children, pos, pos + text.length, view, desc);\n  };\n\n  // : (Node, [Decoration], DecorationSet, EditorView)  bool\n  // If this desc be updated to match the given node decoration,\n  // do so and return true.\n  NodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateInner(node, outerDeco, innerDeco, view);\n    return true\n  };\n\n  NodeViewDesc.prototype.updateInner = function updateInner (node, outerDeco, innerDeco, view) {\n    this.updateOuterDeco(outerDeco);\n    this.node = node;\n    this.innerDeco = innerDeco;\n    if (this.contentDOM) { this.updateChildren(view, this.posAtStart); }\n    this.dirty = NOT_DIRTY;\n  };\n\n  NodeViewDesc.prototype.updateOuterDeco = function updateOuterDeco (outerDeco) {\n    if (sameOuterDeco(outerDeco, this.outerDeco)) { return }\n    var needsWrap = this.nodeDOM.nodeType != 1;\n    var oldDOM = this.dom;\n    this.dom = patchOuterDeco(this.dom, this.nodeDOM,\n                              computeOuterDeco(this.outerDeco, this.node, needsWrap),\n                              computeOuterDeco(outerDeco, this.node, needsWrap));\n    if (this.dom != oldDOM) {\n      oldDOM.pmViewDesc = null;\n      this.dom.pmViewDesc = this;\n    }\n    this.outerDeco = outerDeco;\n  };\n\n  // Mark this node as being the selected node.\n  NodeViewDesc.prototype.selectNode = function selectNode () {\n    this.nodeDOM.classList.add(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.draggable = true; }\n  };\n\n  // Remove selected node marking from this node.\n  NodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.nodeDOM.classList.remove(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.removeAttribute(\"draggable\"); }\n  };\n\n  prototypeAccessors$3.domAtom.get = function () { return this.node.isAtom };\n\n  Object.defineProperties( NodeViewDesc.prototype, prototypeAccessors$3 );\n\n  return NodeViewDesc;\n}(ViewDesc));\n\n// Create a view desc for the top-level document node, to be exported\n// and used by the view class.\nfunction docViewDesc(doc, outerDeco, innerDeco, dom, view) {\n  applyOuterDeco(dom, outerDeco, doc);\n  return new NodeViewDesc(null, doc, outerDeco, innerDeco, dom, dom, dom, view, 0)\n}\n\nvar TextViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, null, nodeDOM, view);\n  }\n\n  if ( NodeViewDesc ) TextViewDesc.__proto__ = NodeViewDesc;\n  TextViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  TextViewDesc.prototype.constructor = TextViewDesc;\n\n  var prototypeAccessors$4 = { domAtom: { configurable: true } };\n\n  TextViewDesc.prototype.parseRule = function parseRule () {\n    var skip = this.nodeDOM.parentNode;\n    while (skip && skip != this.dom && !skip.pmIsDeco) { skip = skip.parentNode; }\n    return {skip: skip || true}\n  };\n\n  TextViewDesc.prototype.update = function update (node, outerDeco, _, view) {\n    if (this.dirty == NODE_DIRTY || (this.dirty != NOT_DIRTY && !this.inParent()) ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateOuterDeco(outerDeco);\n    if ((this.dirty != NOT_DIRTY || node.text != this.node.text) && node.text != this.nodeDOM.nodeValue) {\n      this.nodeDOM.nodeValue = node.text;\n      if (view.trackWrites == this.nodeDOM) { view.trackWrites = null; }\n    }\n    this.node = node;\n    this.dirty = NOT_DIRTY;\n    return true\n  };\n\n  TextViewDesc.prototype.inParent = function inParent () {\n    var parentDOM = this.parent.contentDOM;\n    for (var n = this.nodeDOM; n; n = n.parentNode) { if (n == parentDOM) { return true } }\n    return false\n  };\n\n  TextViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.nodeDOM, offset: pos}\n  };\n\n  TextViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n    if (dom == this.nodeDOM) { return this.posAtStart + Math.min(offset, this.node.text.length) }\n    return NodeViewDesc.prototype.localPosFromDOM.call(this, dom, offset, bias)\n  };\n\n  TextViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"characterData\" && mutation.type != \"selection\"\n  };\n\n  TextViewDesc.prototype.slice = function slice (from, to, view) {\n    var node = this.node.cut(from, to), dom = document.createTextNode(node.text);\n    return new TextViewDesc(this.parent, node, this.outerDeco, this.innerDeco, dom, dom, view)\n  };\n\n  prototypeAccessors$4.domAtom.get = function () { return false };\n\n  Object.defineProperties( TextViewDesc.prototype, prototypeAccessors$4 );\n\n  return TextViewDesc;\n}(NodeViewDesc));\n\n// A dummy desc used to tag trailing BR or span nodes created to work\n// around contentEditable terribleness.\nvar BRHackViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function BRHackViewDesc () {\n    ViewDesc.apply(this, arguments);\n  }\n\n  if ( ViewDesc ) BRHackViewDesc.__proto__ = ViewDesc;\n  BRHackViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  BRHackViewDesc.prototype.constructor = BRHackViewDesc;\n\n  var prototypeAccessors$5 = { domAtom: { configurable: true } };\n\n  BRHackViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n  BRHackViewDesc.prototype.matchesHack = function matchesHack () { return this.dirty == NOT_DIRTY };\n  prototypeAccessors$5.domAtom.get = function () { return true };\n\n  Object.defineProperties( BRHackViewDesc.prototype, prototypeAccessors$5 );\n\n  return BRHackViewDesc;\n}(ViewDesc));\n\n// A separate subclass is used for customized node views, so that the\n// extra checks only have to be made for nodes that are actually\n// customized.\nvar CustomNodeViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, spec, view, pos) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos);\n    this.spec = spec;\n  }\n\n  if ( NodeViewDesc ) CustomNodeViewDesc.__proto__ = NodeViewDesc;\n  CustomNodeViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  CustomNodeViewDesc.prototype.constructor = CustomNodeViewDesc;\n\n  // A custom `update` method gets to decide whether the update goes\n  // through. If it does, and there's a `contentDOM` node, our logic\n  // updates the children.\n  CustomNodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY) { return false }\n    if (this.spec.update) {\n      var result = this.spec.update(node, outerDeco);\n      if (result) { this.updateInner(node, outerDeco, innerDeco, view); }\n      return result\n    } else if (!this.contentDOM && !node.isLeaf) {\n      return false\n    } else {\n      return NodeViewDesc.prototype.update.call(this, node, outerDeco, innerDeco, view)\n    }\n  };\n\n  CustomNodeViewDesc.prototype.selectNode = function selectNode () {\n    this.spec.selectNode ? this.spec.selectNode() : NodeViewDesc.prototype.selectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.spec.deselectNode ? this.spec.deselectNode() : NodeViewDesc.prototype.deselectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n    this.spec.setSelection ? this.spec.setSelection(anchor, head, root)\n      : NodeViewDesc.prototype.setSelection.call(this, anchor, head, root, force);\n  };\n\n  CustomNodeViewDesc.prototype.destroy = function destroy () {\n    if (this.spec.destroy) { this.spec.destroy(); }\n    NodeViewDesc.prototype.destroy.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.stopEvent = function stopEvent (event) {\n    return this.spec.stopEvent ? this.spec.stopEvent(event) : false\n  };\n\n  CustomNodeViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return this.spec.ignoreMutation ? this.spec.ignoreMutation(mutation) : NodeViewDesc.prototype.ignoreMutation.call(this, mutation)\n  };\n\n  return CustomNodeViewDesc;\n}(NodeViewDesc));\n\n// : (dom.Node, [ViewDesc])\n// Sync the content of the given DOM node with the nodes associated\n// with the given array of view descs, recursing into mark descs\n// because this should sync the subtree for a whole node at a time.\nfunction renderDescs(parentDOM, descs, view) {\n  var dom = parentDOM.firstChild, written = false;\n  for (var i = 0; i < descs.length; i++) {\n    var desc = descs[i], childDOM = desc.dom;\n    if (childDOM.parentNode == parentDOM) {\n      while (childDOM != dom) { dom = rm(dom); written = true; }\n      dom = dom.nextSibling;\n    } else {\n      written = true;\n      parentDOM.insertBefore(childDOM, dom);\n    }\n    if (desc instanceof MarkViewDesc) {\n      var pos = dom ? dom.previousSibling : parentDOM.lastChild;\n      renderDescs(desc.contentDOM, desc.children, view);\n      dom = pos ? pos.nextSibling : parentDOM.firstChild;\n    }\n  }\n  while (dom) { dom = rm(dom); written = true; }\n  if (written && view.trackWrites == parentDOM) { view.trackWrites = null; }\n}\n\nfunction OuterDecoLevel(nodeName) {\n  if (nodeName) { this.nodeName = nodeName; }\n}\nOuterDecoLevel.prototype = Object.create(null);\n\nvar noDeco = [new OuterDecoLevel];\n\nfunction computeOuterDeco(outerDeco, node, needsWrap) {\n  if (outerDeco.length == 0) { return noDeco }\n\n  var top = needsWrap ? noDeco[0] : new OuterDecoLevel, result = [top];\n\n  for (var i = 0; i < outerDeco.length; i++) {\n    var attrs = outerDeco[i].type.attrs;\n    if (!attrs) { continue }\n    if (attrs.nodeName)\n      { result.push(top = new OuterDecoLevel(attrs.nodeName)); }\n\n    for (var name in attrs) {\n      var val = attrs[name];\n      if (val == null) { continue }\n      if (needsWrap && result.length == 1)\n        { result.push(top = new OuterDecoLevel(node.isInline ? \"span\" : \"div\")); }\n      if (name == \"class\") { top.class = (top.class ? top.class + \" \" : \"\") + val; }\n      else if (name == \"style\") { top.style = (top.style ? top.style + \";\" : \"\") + val; }\n      else if (name != \"nodeName\") { top[name] = val; }\n    }\n  }\n\n  return result\n}\n\nfunction patchOuterDeco(outerDOM, nodeDOM, prevComputed, curComputed) {\n  // Shortcut for trivial case\n  if (prevComputed == noDeco && curComputed == noDeco) { return nodeDOM }\n\n  var curDOM = nodeDOM;\n  for (var i = 0; i < curComputed.length; i++) {\n    var deco = curComputed[i], prev = prevComputed[i];\n    if (i) {\n      var parent = (void 0);\n      if (prev && prev.nodeName == deco.nodeName && curDOM != outerDOM &&\n          (parent = curDOM.parentNode) && parent.tagName.toLowerCase() == deco.nodeName) {\n        curDOM = parent;\n      } else {\n        parent = document.createElement(deco.nodeName);\n        parent.pmIsDeco = true;\n        parent.appendChild(curDOM);\n        prev = noDeco[0];\n        curDOM = parent;\n      }\n    }\n    patchAttributes(curDOM, prev || noDeco[0], deco);\n  }\n  return curDOM\n}\n\nfunction patchAttributes(dom, prev, cur) {\n  for (var name in prev)\n    { if (name != \"class\" && name != \"style\" && name != \"nodeName\" && !(name in cur))\n      { dom.removeAttribute(name); } }\n  for (var name$1 in cur)\n    { if (name$1 != \"class\" && name$1 != \"style\" && name$1 != \"nodeName\" && cur[name$1] != prev[name$1])\n      { dom.setAttribute(name$1, cur[name$1]); } }\n  if (prev.class != cur.class) {\n    var prevList = prev.class ? prev.class.split(\" \") : nothing;\n    var curList = cur.class ? cur.class.split(\" \") : nothing;\n    for (var i = 0; i < prevList.length; i++) { if (curList.indexOf(prevList[i]) == -1)\n      { dom.classList.remove(prevList[i]); } }\n    for (var i$1 = 0; i$1 < curList.length; i$1++) { if (prevList.indexOf(curList[i$1]) == -1)\n      { dom.classList.add(curList[i$1]); } }\n  }\n  if (prev.style != cur.style) {\n    if (prev.style) {\n      var prop = /\\s*([\\w\\-\\xa1-\\uffff]+)\\s*:(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|\\(.*?\\)|[^;])*/g, m;\n      while (m = prop.exec(prev.style))\n        { dom.style.removeProperty(m[1]); }\n    }\n    if (cur.style)\n      { dom.style.cssText += cur.style; }\n  }\n}\n\nfunction applyOuterDeco(dom, deco, node) {\n  return patchOuterDeco(dom, dom, noDeco, computeOuterDeco(deco, node, dom.nodeType != 1))\n}\n\n// : ([Decoration], [Decoration])  bool\nfunction sameOuterDeco(a, b) {\n  if (a.length != b.length) { return false }\n  for (var i = 0; i < a.length; i++) { if (!a[i].type.eq(b[i].type)) { return false } }\n  return true\n}\n\n// Remove a DOM node and return its next sibling.\nfunction rm(dom) {\n  var next = dom.nextSibling;\n  dom.parentNode.removeChild(dom);\n  return next\n}\n\n// Helper class for incrementally updating a tree of mark descs and\n// the widget and node descs inside of them.\nvar ViewTreeUpdater = function ViewTreeUpdater(top, lockedNode) {\n  this.top = top;\n  this.lock = lockedNode;\n  // Index into `this.top`'s child array, represents the current\n  // update position.\n  this.index = 0;\n  // When entering a mark, the current top and index are pushed\n  // onto this.\n  this.stack = [];\n  // Tracks whether anything was changed\n  this.changed = false;\n\n  var pre = preMatch(top.node.content, top.children);\n  this.preMatched = pre.nodes;\n  this.preMatchOffset = pre.offset;\n};\n\nViewTreeUpdater.prototype.getPreMatch = function getPreMatch (index) {\n  return index >= this.preMatchOffset ? this.preMatched[index - this.preMatchOffset] : null\n};\n\n// Destroy and remove the children between the given indices in\n// `this.top`.\nViewTreeUpdater.prototype.destroyBetween = function destroyBetween (start, end) {\n  if (start == end) { return }\n  for (var i = start; i < end; i++) { this.top.children[i].destroy(); }\n  this.top.children.splice(start, end - start);\n  this.changed = true;\n};\n\n// Destroy all remaining children in `this.top`.\nViewTreeUpdater.prototype.destroyRest = function destroyRest () {\n  this.destroyBetween(this.index, this.top.children.length);\n};\n\n// : ([Mark], EditorView)\n// Sync the current stack of mark descs with the given array of\n// marks, reusing existing mark descs when possible.\nViewTreeUpdater.prototype.syncToMarks = function syncToMarks (marks, inline, view) {\n  var keep = 0, depth = this.stack.length >> 1;\n  var maxKeep = Math.min(depth, marks.length);\n  while (keep < maxKeep &&\n         (keep == depth - 1 ? this.top : this.stack[(keep + 1) << 1]).matchesMark(marks[keep]) && marks[keep].type.spec.spanning !== false)\n    { keep++; }\n\n  while (keep < depth) {\n    this.destroyRest();\n    this.top.dirty = NOT_DIRTY;\n    this.index = this.stack.pop();\n    this.top = this.stack.pop();\n    depth--;\n  }\n  while (depth < marks.length) {\n    this.stack.push(this.top, this.index + 1);\n    var found = -1;\n    for (var i = this.index; i < Math.min(this.index + 3, this.top.children.length); i++) {\n      if (this.top.children[i].matchesMark(marks[depth])) { found = i; break }\n    }\n    if (found > -1) {\n      if (found > this.index) {\n        this.changed = true;\n        this.destroyBetween(this.index, found);\n      }\n      this.top = this.top.children[this.index];\n    } else {\n      var markDesc = MarkViewDesc.create(this.top, marks[depth], inline, view);\n      this.top.children.splice(this.index, 0, markDesc);\n      this.top = markDesc;\n      this.changed = true;\n    }\n    this.index = 0;\n    depth++;\n  }\n};\n\n// : (Node, [Decoration], DecorationSet)  bool\n// Try to find a node desc matching the given data. Skip over it and\n// return true when successful.\nViewTreeUpdater.prototype.findNodeMatch = function findNodeMatch (node, outerDeco, innerDeco, index) {\n  var found = -1, preMatch = index < 0 ? undefined : this.getPreMatch(index), children = this.top.children;\n  if (preMatch && preMatch.matchesNode(node, outerDeco, innerDeco)) {\n    found = children.indexOf(preMatch);\n  } else {\n    for (var i = this.index, e = Math.min(children.length, i + 5); i < e; i++) {\n      var child = children[i];\n      if (child.matchesNode(node, outerDeco, innerDeco) && this.preMatched.indexOf(child) < 0) {\n        found = i;\n        break\n      }\n    }\n  }\n  if (found < 0) { return false }\n  this.destroyBetween(this.index, found);\n  this.index++;\n  return true\n};\n\n// : (Node, [Decoration], DecorationSet, EditorView, Fragment, number)  bool\n// Try to update the next node, if any, to the given data. Checks\n// pre-matches to avoid overwriting nodes that could still be used.\nViewTreeUpdater.prototype.updateNextNode = function updateNextNode (node, outerDeco, innerDeco, view, index) {\n  for (var i = this.index; i < this.top.children.length; i++) {\n    var next = this.top.children[i];\n    if (next instanceof NodeViewDesc) {\n      var preMatch = this.preMatched.indexOf(next);\n      if (preMatch > -1 && preMatch + this.preMatchOffset != index) { return false }\n      var nextDOM = next.dom;\n\n      // Can't update if nextDOM is or contains this.lock, except if\n      // it's a text node whose content already matches the new text\n      // and whose decorations match the new ones.\n      var locked = this.lock && (nextDOM == this.lock || nextDOM.nodeType == 1 && nextDOM.contains(this.lock.parentNode)) &&\n          !(node.isText && next.node && next.node.isText && next.nodeDOM.nodeValue == node.text &&\n            next.dirty != NODE_DIRTY && sameOuterDeco(outerDeco, next.outerDeco));\n      if (!locked && next.update(node, outerDeco, innerDeco, view)) {\n        this.destroyBetween(this.index, i);\n        if (next.dom != nextDOM) { this.changed = true; }\n        this.index++;\n        return true\n      }\n      break\n    }\n  }\n  return false\n};\n\n// : (Node, [Decoration], DecorationSet, EditorView)\n// Insert the node as a newly created node desc.\nViewTreeUpdater.prototype.addNode = function addNode (node, outerDeco, innerDeco, view, pos) {\n  this.top.children.splice(this.index++, 0, NodeViewDesc.create(this.top, node, outerDeco, innerDeco, view, pos));\n  this.changed = true;\n};\n\nViewTreeUpdater.prototype.placeWidget = function placeWidget (widget, view, pos) {\n  var next = this.index < this.top.children.length ? this.top.children[this.index] : null;\n  if (next && next.matchesWidget(widget) && (widget == next.widget || !next.widget.type.toDOM.parentNode)) {\n    this.index++;\n  } else {\n    var desc = new WidgetViewDesc(this.top, widget, view, pos);\n    this.top.children.splice(this.index++, 0, desc);\n    this.changed = true;\n  }\n};\n\n// Make sure a textblock looks and behaves correctly in\n// contentEditable.\nViewTreeUpdater.prototype.addTextblockHacks = function addTextblockHacks () {\n  var lastChild = this.top.children[this.index - 1];\n  while (lastChild instanceof MarkViewDesc) { lastChild = lastChild.children[lastChild.children.length - 1]; }\n\n  if (!lastChild || // Empty textblock\n      !(lastChild instanceof TextViewDesc) ||\n      /\\n$/.test(lastChild.node.text)) {\n    if (this.index < this.top.children.length && this.top.children[this.index].matchesHack()) {\n      this.index++;\n    } else {\n      var dom = document.createElement(\"br\");\n      this.top.children.splice(this.index++, 0, new BRHackViewDesc(this.top, nothing, dom, null));\n      this.changed = true;\n    }\n  }\n};\n\n// : (Fragment, [ViewDesc])  [ViewDesc]\n// Iterate from the end of the fragment and array of descs to find\n// directly matching ones, in order to avoid overeagerly reusing\n// those for other nodes. Returns an array whose positions correspond\n// to node positions in the fragment, and whose elements are either\n// descs matched to the child at that index, or empty.\nfunction preMatch(frag, descs) {\n  var result = [], end = frag.childCount;\n  for (var i = descs.length - 1; end > 0 && i >= 0; i--) {\n    var desc = descs[i], node = desc.node;\n    if (!node) { continue }\n    if (node != frag.child(end - 1)) { break }\n    result.push(desc);\n    --end;\n  }\n  return {nodes: result.reverse(), offset: end}\n}\n\nfunction compareSide(a, b) { return a.type.side - b.type.side }\n\n// : (ViewDesc, DecorationSet, (Decoration, number), (Node, [Decoration], DecorationSet, number))\n// This function abstracts iterating over the nodes and decorations in\n// a fragment. Calls `onNode` for each node, with its local and child\n// decorations. Splits text nodes when there is a decoration starting\n// or ending inside of them. Calls `onWidget` for each widget.\nfunction iterDeco(parent, deco, onWidget, onNode) {\n  var locals = deco.locals(parent), offset = 0;\n  // Simple, cheap variant for when there are no local decorations\n  if (locals.length == 0) {\n    for (var i = 0; i < parent.childCount; i++) {\n      var child = parent.child(i);\n      onNode(child, locals, deco.forChild(offset, child), i);\n      offset += child.nodeSize;\n    }\n    return\n  }\n\n  var decoIndex = 0, active = [], restNode = null;\n  for (var parentIndex = 0;;) {\n    if (decoIndex < locals.length && locals[decoIndex].to == offset) {\n      var widget = locals[decoIndex++], widgets = (void 0);\n      while (decoIndex < locals.length && locals[decoIndex].to == offset)\n        { (widgets || (widgets = [widget])).push(locals[decoIndex++]); }\n      if (widgets) {\n        widgets.sort(compareSide);\n        for (var i$1 = 0; i$1 < widgets.length; i$1++) { onWidget(widgets[i$1], parentIndex, !!restNode); }\n      } else {\n        onWidget(widget, parentIndex, !!restNode);\n      }\n    }\n\n    var child$1 = (void 0), index = (void 0);\n    if (restNode) {\n      index = -1;\n      child$1 = restNode;\n      restNode = null;\n    } else if (parentIndex < parent.childCount) {\n      index = parentIndex;\n      child$1 = parent.child(parentIndex++);\n    } else {\n      break\n    }\n\n    for (var i$2 = 0; i$2 < active.length; i$2++) { if (active[i$2].to <= offset) { active.splice(i$2--, 1); } }\n    while (decoIndex < locals.length && locals[decoIndex].from <= offset && locals[decoIndex].to > offset)\n      { active.push(locals[decoIndex++]); }\n\n    var end = offset + child$1.nodeSize;\n    if (child$1.isText) {\n      var cutAt = end;\n      if (decoIndex < locals.length && locals[decoIndex].from < cutAt) { cutAt = locals[decoIndex].from; }\n      for (var i$3 = 0; i$3 < active.length; i$3++) { if (active[i$3].to < cutAt) { cutAt = active[i$3].to; } }\n      if (cutAt < end) {\n        restNode = child$1.cut(cutAt - offset);\n        child$1 = child$1.cut(0, cutAt - offset);\n        end = cutAt;\n        index = -1;\n      }\n    }\n\n    var outerDeco = !active.length ? nothing\n        : child$1.isInline && !child$1.isLeaf ? active.filter(function (d) { return !d.inline; })\n        : active.slice();\n    onNode(child$1, outerDeco, deco.forChild(offset, child$1), index);\n    offset = end;\n  }\n}\n\n// List markers in Mobile Safari will mysteriously disappear\n// sometimes. This works around that.\nfunction iosHacks(dom) {\n  if (dom.nodeName == \"UL\" || dom.nodeName == \"OL\") {\n    var oldCSS = dom.style.cssText;\n    dom.style.cssText = oldCSS + \"; list-style: square !important\";\n    window.getComputedStyle(dom).listStyle;\n    dom.style.cssText = oldCSS;\n  }\n}\n\nfunction nearbyTextNode(node, offset) {\n  for (;;) {\n    if (node.nodeType == 3) { return node }\n    if (node.nodeType == 1 && offset > 0) {\n      if (node.childNodes.length > offset && node.childNodes[offset].nodeType == 3)\n        { return node.childNodes[offset] }\n      node = node.childNodes[offset - 1];\n      offset = nodeSize(node);\n    } else if (node.nodeType == 1 && offset < node.childNodes.length) {\n      node = node.childNodes[offset];\n      offset = 0;\n    } else {\n      return null\n    }\n  }\n}\n\n// Find a piece of text in an inline fragment, overlapping from-to\nfunction findTextInFragment(frag, text, from, to) {\n  for (var i = 0, pos = 0; i < frag.childCount && pos <= to;) {\n    var child = frag.child(i++), childStart = pos;\n    pos += child.nodeSize;\n    if (!child.isText) { continue }\n    var str = child.text;\n    while (i < frag.childCount) {\n      var next = frag.child(i++);\n      pos += next.nodeSize;\n      if (!next.isText) { break }\n      str += next.text;\n    }\n    if (pos >= from) {\n      var found = str.lastIndexOf(text, to - childStart);\n      if (found >= 0 && found + text.length + childStart >= from)\n        { return childStart + found }\n    }\n  }\n  return -1\n}\n\n// Replace range from-to in an array of view descs with replacement\n// (may be null to just delete). This goes very much against the grain\n// of the rest of this code, which tends to create nodes with the\n// right shape in one go, rather than messing with them after\n// creation, but is necessary in the composition hack.\nfunction replaceNodes(nodes, from, to, view, replacement) {\n  var result = [];\n  for (var i = 0, off = 0; i < nodes.length; i++) {\n    var child = nodes[i], start = off, end = off += child.size;\n    if (start >= to || end <= from) {\n      result.push(child);\n    } else {\n      if (start < from) { result.push(child.slice(0, from - start, view)); }\n      if (replacement) {\n        result.push(replacement);\n        replacement = null;\n      }\n      if (end > to) { result.push(child.slice(to - start, child.size, view)); }\n    }\n  }\n  return result\n}\n\nfunction selectionFromDOM(view, origin) {\n  var domSel = view.root.getSelection(), doc = view.state.doc;\n  if (!domSel.focusNode) { return null }\n  var nearestDesc = view.docView.nearestDesc(domSel.focusNode), inWidget = nearestDesc && nearestDesc.size == 0;\n  var head = view.docView.posFromDOM(domSel.focusNode, domSel.focusOffset);\n  if (head < 0) { return null }\n  var $head = doc.resolve(head), $anchor, selection;\n  if (selectionCollapsed(domSel)) {\n    $anchor = $head;\n    while (nearestDesc && !nearestDesc.node) { nearestDesc = nearestDesc.parent; }\n    if (nearestDesc && nearestDesc.node.isAtom && NodeSelection.isSelectable(nearestDesc.node) && nearestDesc.parent\n        && !(nearestDesc.node.isInline && isOnEdge(domSel.focusNode, domSel.focusOffset, nearestDesc.dom))) {\n      var pos = nearestDesc.posBefore;\n      selection = new NodeSelection(head == pos ? $head : doc.resolve(pos));\n    }\n  } else {\n    var anchor = view.docView.posFromDOM(domSel.anchorNode, domSel.anchorOffset);\n    if (anchor < 0) { return null }\n    $anchor = doc.resolve(anchor);\n  }\n\n  if (!selection) {\n    var bias = origin == \"pointer\" || (view.state.selection.head < $head.pos && !inWidget) ? 1 : -1;\n    selection = selectionBetween(view, $anchor, $head, bias);\n  }\n  return selection\n}\n\nfunction selectionToDOM(view, force) {\n  var sel = view.state.selection;\n  syncNodeSelection(view, sel);\n\n  if (view.editable ? !view.hasFocus() :\n      !(hasSelection(view) && document.activeElement && document.activeElement.contains(view.dom))) { return }\n\n  view.domObserver.disconnectSelection();\n\n  if (view.cursorWrapper) {\n    selectCursorWrapper(view);\n  } else {\n    var anchor = sel.anchor;\n    var head = sel.head;\n    var resetEditableFrom, resetEditableTo;\n    if (brokenSelectBetweenUneditable && !(sel instanceof TextSelection)) {\n      if (!sel.$from.parent.inlineContent)\n        { resetEditableFrom = temporarilyEditableNear(view, sel.from); }\n      if (!sel.empty && !sel.$from.parent.inlineContent)\n        { resetEditableTo = temporarilyEditableNear(view, sel.to); }\n    }\n    view.docView.setSelection(anchor, head, view.root, force);\n    if (brokenSelectBetweenUneditable) {\n      if (resetEditableFrom) { resetEditable(resetEditableFrom); }\n      if (resetEditableTo) { resetEditable(resetEditableTo); }\n    }\n    if (sel.visible) {\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    } else {\n      view.dom.classList.add(\"ProseMirror-hideselection\");\n      if (\"onselectionchange\" in document) { removeClassOnSelectionChange(view); }\n    }\n  }\n\n  view.domObserver.setCurSelection();\n  view.domObserver.connectSelection();\n}\n\n// Kludge to work around Webkit not allowing a selection to start/end\n// between non-editable block nodes. We briefly make something\n// editable, set the selection, then set it uneditable again.\n\nvar brokenSelectBetweenUneditable = result.safari || result.chrome && result.chrome_version < 63;\n\nfunction temporarilyEditableNear(view, pos) {\n  var ref = view.docView.domFromPos(pos, 0);\n  var node = ref.node;\n  var offset = ref.offset;\n  var after = offset < node.childNodes.length ? node.childNodes[offset] : null;\n  var before = offset ? node.childNodes[offset - 1] : null;\n  if (result.safari && after && after.contentEditable == \"false\") { return setEditable(after) }\n  if ((!after || after.contentEditable == \"false\") && (!before || before.contentEditable == \"false\")) {\n    if (after) { return setEditable(after) }\n    else if (before) { return setEditable(before) }\n  }\n}\n\nfunction setEditable(element) {\n  element.contentEditable = \"true\";\n  if (result.safari && element.draggable) { element.draggable = false; element.wasDraggable = true; }\n  return element\n}\n\nfunction resetEditable(element) {\n  element.contentEditable = \"false\";\n  if (element.wasDraggable) { element.draggable = true; element.wasDraggable = null; }\n}\n\nfunction removeClassOnSelectionChange(view) {\n  var doc = view.dom.ownerDocument;\n  doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n  var domSel = view.root.getSelection();\n  var node = domSel.anchorNode, offset = domSel.anchorOffset;\n  doc.addEventListener(\"selectionchange\", view.hideSelectionGuard = function () {\n    if (domSel.anchorNode != node || domSel.anchorOffset != offset) {\n      doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    }\n  });\n}\n\nfunction selectCursorWrapper(view) {\n  var domSel = view.root.getSelection(), range = document.createRange();\n  var node = view.cursorWrapper.dom, img = node.nodeName == \"IMG\";\n  if (img) { range.setEnd(node.parentNode, domIndex(node) + 1); }\n  else { range.setEnd(node, 0); }\n  range.collapse(false);\n  domSel.removeAllRanges();\n  domSel.addRange(range);\n  // Kludge to kill 'control selection' in IE11 when selecting an\n  // invisible cursor wrapper, since that would result in those weird\n  // resize handles and a selection that considers the absolutely\n  // positioned wrapper, rather than the root editable node, the\n  // focused element.\n  if (!img && !view.state.selection.visible && result.ie && result.ie_version <= 11) {\n    node.disabled = true;\n    node.disabled = false;\n  }\n}\n\nfunction syncNodeSelection(view, sel) {\n  if (sel instanceof NodeSelection) {\n    var desc = view.docView.descAt(sel.from);\n    if (desc != view.lastSelectedViewDesc) {\n      clearNodeSelection(view);\n      if (desc) { desc.selectNode(); }\n      view.lastSelectedViewDesc = desc;\n    }\n  } else {\n    clearNodeSelection(view);\n  }\n}\n\n// Clear all DOM statefulness of the last node selection.\nfunction clearNodeSelection(view) {\n  if (view.lastSelectedViewDesc) {\n    if (view.lastSelectedViewDesc.parent)\n      { view.lastSelectedViewDesc.deselectNode(); }\n    view.lastSelectedViewDesc = null;\n  }\n}\n\nfunction selectionBetween(view, $anchor, $head, bias) {\n  return view.someProp(\"createSelectionBetween\", function (f) { return f(view, $anchor, $head); })\n    || TextSelection.between($anchor, $head, bias)\n}\n\nfunction hasFocusAndSelection(view) {\n  if (view.editable && view.root.activeElement != view.dom) { return false }\n  return hasSelection(view)\n}\n\nfunction hasSelection(view) {\n  var sel = view.root.getSelection();\n  if (!sel.anchorNode) { return false }\n  try {\n    // Firefox will raise 'permission denied' errors when accessing\n    // properties of `sel.anchorNode` when it's in a generated CSS\n    // element.\n    return view.dom.contains(sel.anchorNode.nodeType == 3 ? sel.anchorNode.parentNode : sel.anchorNode) &&\n      (view.editable || view.dom.contains(sel.focusNode.nodeType == 3 ? sel.focusNode.parentNode : sel.focusNode))\n  } catch(_) {\n    return false\n  }\n}\n\nfunction anchorInRightPlace(view) {\n  var anchorDOM = view.docView.domFromPos(view.state.selection.anchor, 0);\n  var domSel = view.root.getSelection();\n  return isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset)\n}\n\nfunction moveSelectionBlock(state, dir) {\n  var ref = state.selection;\n  var $anchor = ref.$anchor;\n  var $head = ref.$head;\n  var $side = dir > 0 ? $anchor.max($head) : $anchor.min($head);\n  var $start = !$side.parent.inlineContent ? $side : $side.depth ? state.doc.resolve(dir > 0 ? $side.after() : $side.before()) : null;\n  return $start && Selection.findFrom($start, dir)\n}\n\nfunction apply(view, sel) {\n  view.dispatch(view.state.tr.setSelection(sel).scrollIntoView());\n  return true\n}\n\nfunction selectHorizontally(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection) {\n    if (!sel.empty || mods.indexOf(\"s\") > -1) {\n      return false\n    } else if (view.endOfTextblock(dir > 0 ? \"right\" : \"left\")) {\n      var next = moveSelectionBlock(view.state, dir);\n      if (next && (next instanceof NodeSelection)) { return apply(view, next) }\n      return false\n    } else if (!(result.mac && mods.indexOf(\"m\") > -1)) {\n      var $head = sel.$head, node = $head.textOffset ? null : dir < 0 ? $head.nodeBefore : $head.nodeAfter, desc;\n      if (!node || node.isText) { return false }\n      var nodePos = dir < 0 ? $head.pos - node.nodeSize : $head.pos;\n      if (!(node.isAtom || (desc = view.docView.descAt(nodePos)) && !desc.contentDOM)) { return false }\n      if (NodeSelection.isSelectable(node)) {\n        return apply(view, new NodeSelection(dir < 0 ? view.state.doc.resolve($head.pos - node.nodeSize) : $head))\n      } else if (result.webkit) {\n        // Chrome and Safari will introduce extra pointless cursor\n        // positions around inline uneditable nodes, so we have to\n        // take over and move the cursor past them (#937)\n        return apply(view, new TextSelection(view.state.doc.resolve(dir < 0 ? nodePos : nodePos + node.nodeSize)))\n      } else {\n        return false\n      }\n    }\n  } else if (sel instanceof NodeSelection && sel.node.isInline) {\n    return apply(view, new TextSelection(dir > 0 ? sel.$to : sel.$from))\n  } else {\n    var next$1 = moveSelectionBlock(view.state, dir);\n    if (next$1) { return apply(view, next$1) }\n    return false\n  }\n}\n\nfunction nodeLen(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isIgnorable(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.size == 0 && (dom.nextSibling || dom.nodeName != \"BR\")\n}\n\n// Make sure the cursor isn't directly after one or more ignored\n// nodes, which will confuse the browser's cursor motion logic.\nfunction skipIgnoredNodesLeft(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var moveNode, moveOffset, force = false;\n  // Gecko will do odd things when the selection is directly in front\n  // of a non-editable node, so in that case, move it into the next\n  // node if possible. Issue prosemirror/prosemirror#832.\n  if (result.gecko && node.nodeType == 1 && offset < nodeLen(node) && isIgnorable(node.childNodes[offset])) { force = true; }\n  for (;;) {\n    if (offset > 0) {\n      if (node.nodeType != 1) {\n        break\n      } else {\n        var before = node.childNodes[offset - 1];\n        if (isIgnorable(before)) {\n          moveNode = node;\n          moveOffset = --offset;\n        } else if (before.nodeType == 3) {\n          node = before;\n          offset = node.nodeValue.length;\n        } else { break }\n      }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var prev = node.previousSibling;\n      while (prev && isIgnorable(prev)) {\n        moveNode = node.parentNode;\n        moveOffset = domIndex(prev);\n        prev = prev.previousSibling;\n      }\n      if (!prev) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = 0;\n      } else {\n        node = prev;\n        offset = nodeLen(node);\n      }\n    }\n  }\n  if (force) { setSelFocus(view, sel, node, offset); }\n  else if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\n// Make sure the cursor isn't directly before one or more ignored\n// nodes.\nfunction skipIgnoredNodesRight(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var len = nodeLen(node);\n  var moveNode, moveOffset;\n  for (;;) {\n    if (offset < len) {\n      if (node.nodeType != 1) { break }\n      var after = node.childNodes[offset];\n      if (isIgnorable(after)) {\n        moveNode = node;\n        moveOffset = ++offset;\n      }\n      else { break }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var next = node.nextSibling;\n      while (next && isIgnorable(next)) {\n        moveNode = next.parentNode;\n        moveOffset = domIndex(next) + 1;\n        next = next.nextSibling;\n      }\n      if (!next) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = len = 0;\n      } else {\n        node = next;\n        offset = 0;\n        len = nodeLen(node);\n      }\n    }\n  }\n  if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\nfunction isBlockNode(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.node && desc.node.isBlock\n}\n\nfunction setSelFocus(view, sel, node, offset) {\n  if (selectionCollapsed(sel)) {\n    var range = document.createRange();\n    range.setEnd(node, offset);\n    range.setStart(node, offset);\n    sel.removeAllRanges();\n    sel.addRange(range);\n  } else if (sel.extend) {\n    sel.extend(node, offset);\n  }\n  view.domObserver.setCurSelection();\n  var state = view.state;\n  // If no state update ends up happening, reset the selection.\n  setTimeout(function () {\n    if (view.state == state) { selectionToDOM(view); }\n  }, 50);\n}\n\n// : (EditorState, number)\n// Check whether vertical selection motion would involve node\n// selections. If so, apply it (if not, the result is left to the\n// browser)\nfunction selectVertically(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection && !sel.empty || mods.indexOf(\"s\") > -1) { return false }\n  if (result.mac && mods.indexOf(\"m\") > -1) { return false }\n  var $from = sel.$from;\n  var $to = sel.$to;\n\n  if (!$from.parent.inlineContent || view.endOfTextblock(dir < 0 ? \"up\" : \"down\")) {\n    var next = moveSelectionBlock(view.state, dir);\n    if (next && (next instanceof NodeSelection))\n      { return apply(view, next) }\n  }\n  if (!$from.parent.inlineContent) {\n    var beyond = Selection.findFrom(dir < 0 ? $from : $to, dir);\n    return beyond ? apply(view, beyond) : true\n  }\n  return false\n}\n\nfunction stopNativeHorizontalDelete(view, dir) {\n  if (!(view.state.selection instanceof TextSelection)) { return true }\n  var ref = view.state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  var empty = ref.empty;\n  if (!$head.sameParent($anchor)) { return true }\n  if (!empty) { return false }\n  if (view.endOfTextblock(dir > 0 ? \"forward\" : \"backward\")) { return true }\n  var nextNode = !$head.textOffset && (dir < 0 ? $head.nodeBefore : $head.nodeAfter);\n  if (nextNode && !nextNode.isText) {\n    var tr = view.state.tr;\n    if (dir < 0) { tr.delete($head.pos - nextNode.nodeSize, $head.pos); }\n    else { tr.delete($head.pos, $head.pos + nextNode.nodeSize); }\n    view.dispatch(tr);\n    return true\n  }\n  return false\n}\n\nfunction switchEditable(view, node, state) {\n  view.domObserver.stop();\n  node.contentEditable = state;\n  view.domObserver.start();\n}\n\n// Issue #867 / #1090 / https://bugs.chromium.org/p/chromium/issues/detail?id=903821\n// In which Safari (and at some point in the past, Chrome) does really\n// wrong things when the down arrow is pressed when the cursor is\n// directly at the start of a textblock and has an uneditable node\n// after it\nfunction safariDownArrowBug(view) {\n  if (!result.safari || view.state.selection.$head.parentOffset > 0) { return }\n  var ref = view.root.getSelection();\n  var focusNode = ref.focusNode;\n  var focusOffset = ref.focusOffset;\n  if (focusNode && focusNode.nodeType == 1 && focusOffset == 0 &&\n      focusNode.firstChild && focusNode.firstChild.contentEditable == \"false\") {\n    var child = focusNode.firstChild;\n    switchEditable(view, child, true);\n    setTimeout(function () { return switchEditable(view, child, false); }, 20);\n  }\n}\n\n// A backdrop key mapping used to make sure we always suppress keys\n// that have a dangerous default effect, even if the commands they are\n// bound to return false, and to make sure that cursor-motion keys\n// find a cursor (as opposed to a node selection) when pressed. For\n// cursor-motion keys, the code in the handlers also takes care of\n// block selections.\n\nfunction getMods(event) {\n  var result = \"\";\n  if (event.ctrlKey) { result += \"c\"; }\n  if (event.metaKey) { result += \"m\"; }\n  if (event.altKey) { result += \"a\"; }\n  if (event.shiftKey) { result += \"s\"; }\n  return result\n}\n\nfunction captureKeyDown(view, event) {\n  var code = event.keyCode, mods = getMods(event);\n  if (code == 8 || (result.mac && code == 72 && mods == \"c\")) { // Backspace, Ctrl-h on Mac\n    return stopNativeHorizontalDelete(view, -1) || skipIgnoredNodesLeft(view)\n  } else if (code == 46 || (result.mac && code == 68 && mods == \"c\")) { // Delete, Ctrl-d on Mac\n    return stopNativeHorizontalDelete(view, 1) || skipIgnoredNodesRight(view)\n  } else if (code == 13 || code == 27) { // Enter, Esc\n    return true\n  } else if (code == 37) { // Left arrow\n    return selectHorizontally(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 39) { // Right arrow\n    return selectHorizontally(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (code == 38) { // Up arrow\n    return selectVertically(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 40) { // Down arrow\n    return safariDownArrowBug(view) || selectVertically(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (mods == (result.mac ? \"m\" : \"c\") &&\n             (code == 66 || code == 73 || code == 89 || code == 90)) { // Mod-[biyz]\n    return true\n  }\n  return false\n}\n\n// Note that all referencing and parsing is done with the\n// start-of-operation selection and document, since that's the one\n// that the DOM represents. If any changes came in in the meantime,\n// the modification is mapped over those before it is applied, in\n// readDOMChange.\n\nfunction parseBetween(view, from_, to_) {\n  var ref = view.docView.parseRange(from_, to_);\n  var parent = ref.node;\n  var fromOffset = ref.fromOffset;\n  var toOffset = ref.toOffset;\n  var from = ref.from;\n  var to = ref.to;\n\n  var domSel = view.root.getSelection(), find = null, anchor = domSel.anchorNode;\n  if (anchor && view.dom.contains(anchor.nodeType == 1 ? anchor : anchor.parentNode)) {\n    find = [{node: anchor, offset: domSel.anchorOffset}];\n    if (!selectionCollapsed(domSel))\n      { find.push({node: domSel.focusNode, offset: domSel.focusOffset}); }\n  }\n  // Work around issue in Chrome where backspacing sometimes replaces\n  // the deleted content with a random BR node (issues #799, #831)\n  if (result.chrome && view.lastKeyCode === 8) {\n    for (var off = toOffset; off > fromOffset; off--) {\n      var node = parent.childNodes[off - 1], desc = node.pmViewDesc;\n      if (node.nodeType == \"BR\" && !desc) { toOffset = off; break }\n      if (!desc || desc.size) { break }\n    }\n  }\n  var startDoc = view.state.doc;\n  var parser = view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n  var $from = startDoc.resolve(from);\n\n  var sel = null, doc = parser.parse(parent, {\n    topNode: $from.parent,\n    topMatch: $from.parent.contentMatchAt($from.index()),\n    topOpen: true,\n    from: fromOffset,\n    to: toOffset,\n    preserveWhitespace: $from.parent.type.spec.code ? \"full\" : true,\n    editableContent: true,\n    findPositions: find,\n    ruleFromNode: ruleFromNode,\n    context: $from\n  });\n  if (find && find[0].pos != null) {\n    var anchor$1 = find[0].pos, head = find[1] && find[1].pos;\n    if (head == null) { head = anchor$1; }\n    sel = {anchor: anchor$1 + from, head: head + from};\n  }\n  return {doc: doc, sel: sel, from: from, to: to}\n}\n\nfunction ruleFromNode(dom) {\n  var desc = dom.pmViewDesc;\n  if (desc) {\n    return desc.parseRule()\n  } else if (dom.nodeName == \"BR\" && dom.parentNode) {\n    // Safari replaces the list item or table cell with a BR\n    // directly in the list node (?!) if you delete the last\n    // character in a list item or table cell (#708, #862)\n    if (result.safari && /^(ul|ol)$/i.test(dom.parentNode.nodeName)) {\n      var skip = document.createElement(\"div\");\n      skip.appendChild(document.createElement(\"li\"));\n      return {skip: skip}\n    } else if (dom.parentNode.lastChild == dom || result.safari && /^(tr|table)$/i.test(dom.parentNode.nodeName)) {\n      return {ignore: true}\n    }\n  } else if (dom.nodeName == \"IMG\" && dom.getAttribute(\"mark-placeholder\")) {\n    return {ignore: true}\n  }\n}\n\nfunction readDOMChange(view, from, to, typeOver, addedNodes) {\n  if (from < 0) {\n    var origin = view.lastSelectionTime > Date.now() - 50 ? view.lastSelectionOrigin : null;\n    var newSel = selectionFromDOM(view, origin);\n    if (newSel && !view.state.selection.eq(newSel)) {\n      var tr$1 = view.state.tr.setSelection(newSel);\n      if (origin == \"pointer\") { tr$1.setMeta(\"pointer\", true); }\n      else if (origin == \"key\") { tr$1.scrollIntoView(); }\n      view.dispatch(tr$1);\n    }\n    return\n  }\n\n  var $before = view.state.doc.resolve(from);\n  var shared = $before.sharedDepth(to);\n  from = $before.before(shared + 1);\n  to = view.state.doc.resolve(to).after(shared + 1);\n\n  var sel = view.state.selection;\n  var parse = parseBetween(view, from, to);\n  // Chrome sometimes leaves the cursor before the inserted text when\n  // composing after a cursor wrapper. This moves it forward.\n  if (result.chrome && view.cursorWrapper && parse.sel && parse.sel.anchor == view.cursorWrapper.deco.from) {\n    var text = view.cursorWrapper.deco.type.toDOM.nextSibling;\n    var size = text && text.nodeValue ? text.nodeValue.length : 1;\n    parse.sel = {anchor: parse.sel.anchor + size, head: parse.sel.anchor + size};\n  }\n\n  var doc = view.state.doc, compare = doc.slice(parse.from, parse.to);\n  var preferredPos, preferredSide;\n  // Prefer anchoring to end when Backspace is pressed\n  if (view.lastKeyCode === 8 && Date.now() - 100 < view.lastKeyCodeTime) {\n    preferredPos = view.state.selection.to;\n    preferredSide = \"end\";\n  } else {\n    preferredPos = view.state.selection.from;\n    preferredSide = \"start\";\n  }\n  view.lastKeyCode = null;\n\n  var change = findDiff(compare.content, parse.doc.content, parse.from, preferredPos, preferredSide);\n  if (!change) {\n    if (typeOver && sel instanceof TextSelection && !sel.empty && sel.$head.sameParent(sel.$anchor) &&\n        !view.composing && !(parse.sel && parse.sel.anchor != parse.sel.head)) {\n      change = {start: sel.from, endA: sel.to, endB: sel.to};\n    } else if (result.ios && view.lastIOSEnter > Date.now() - 225 &&\n               addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }) &&\n               view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n      view.lastIOSEnter = 0;\n      return\n    } else {\n      if (parse.sel) {\n        var sel$1 = resolveSelection(view, view.state.doc, parse.sel);\n        if (sel$1 && !sel$1.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel$1)); }\n      }\n      return\n    }\n  }\n  view.domChangeCount++;\n  // Handle the case where overwriting a selection by typing matches\n  // the start or end of the selected content, creating a change\n  // that's smaller than what was actually overwritten.\n  if (view.state.selection.from < view.state.selection.to &&\n      change.start == change.endB &&\n      view.state.selection instanceof TextSelection) {\n    if (change.start > view.state.selection.from && change.start <= view.state.selection.from + 2) {\n      change.start = view.state.selection.from;\n    } else if (change.endA < view.state.selection.to && change.endA >= view.state.selection.to - 2) {\n      change.endB += (view.state.selection.to - change.endA);\n      change.endA = view.state.selection.to;\n    }\n  }\n\n  // IE11 will insert a non-breaking space _ahead_ of the space after\n  // the cursor space when adding a space before another space. When\n  // that happened, adjust the change to cover the space instead.\n  if (result.ie && result.ie_version <= 11 && change.endB == change.start + 1 &&\n      change.endA == change.start && change.start > parse.from &&\n      parse.doc.textBetween(change.start - parse.from - 1, change.start - parse.from + 1) == \" \\u00a0\") {\n    change.start--;\n    change.endA--;\n    change.endB--;\n  }\n\n  var $from = parse.doc.resolveNoCache(change.start - parse.from);\n  var $to = parse.doc.resolveNoCache(change.endB - parse.from);\n  var inlineChange = $from.sameParent($to) && $from.parent.inlineContent;\n  var nextSel;\n  // If this looks like the effect of pressing Enter (or was recorded\n  // as being an iOS enter press), just dispatch an Enter key instead.\n  if (((result.ios && view.lastIOSEnter > Date.now() - 225 &&\n        (!inlineChange || addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }))) ||\n       (!inlineChange && $from.pos < parse.doc.content.size &&\n        (nextSel = Selection.findFrom(parse.doc.resolve($from.pos + 1), 1, true)) &&\n        nextSel.head == $to.pos)) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n    view.lastIOSEnter = 0;\n    return\n  }\n  // Same for backspace\n  if (view.state.selection.anchor > change.start &&\n      looksLikeJoin(doc, change.start, change.endA, $from, $to) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) {\n    if (result.android && result.chrome) { view.domObserver.suppressSelectionUpdates(); } // #820\n    return\n  }\n\n  // This tries to detect Android virtual keyboard\n  // enter-and-pick-suggestion action. That sometimes (see issue\n  // #1059) first fires a DOM mutation, before moving the selection to\n  // the newly created block. And then, because ProseMirror cleans up\n  // the DOM selection, it gives up moving the selection entirely,\n  // leaving the cursor in the wrong place. When that happens, we drop\n  // the new paragraph from the initial change, and fire a simulated\n  // enter key afterwards.\n  if (result.android && !inlineChange && $from.start() != $to.start() && $to.parentOffset == 0 && $from.depth == $to.depth &&\n      parse.sel && parse.sel.anchor == parse.sel.head && parse.sel.head == change.endA) {\n    change.endB -= 2;\n    $to = parse.doc.resolveNoCache(change.endB - parse.from);\n    setTimeout(function () {\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n    }, 20);\n  }\n\n  var chFrom = change.start, chTo = change.endA;\n\n  var tr, storedMarks, markChange, $from1;\n  if (inlineChange) {\n    if ($from.pos == $to.pos) { // Deletion\n      // IE11 sometimes weirdly moves the DOM selection around after\n      // backspacing out the first element in a textblock\n      if (result.ie && result.ie_version <= 11 && $from.parentOffset == 0) {\n        view.domObserver.suppressSelectionUpdates();\n        setTimeout(function () { return selectionToDOM(view); }, 20);\n      }\n      tr = view.state.tr.delete(chFrom, chTo);\n      storedMarks = doc.resolve(change.start).marksAcross(doc.resolve(change.endA));\n    } else if ( // Adding or removing a mark\n      change.endA == change.endB && ($from1 = doc.resolve(change.start)) &&\n      (markChange = isMarkChange($from.parent.content.cut($from.parentOffset, $to.parentOffset),\n                                 $from1.parent.content.cut($from1.parentOffset, change.endA - $from1.start())))\n    ) {\n      tr = view.state.tr;\n      if (markChange.type == \"add\") { tr.addMark(chFrom, chTo, markChange.mark); }\n      else { tr.removeMark(chFrom, chTo, markChange.mark); }\n    } else if ($from.parent.child($from.index()).isText && $from.index() == $to.index() - ($to.textOffset ? 0 : 1)) {\n      // Both positions in the same text node -- simply insert text\n      var text$1 = $from.parent.textBetween($from.parentOffset, $to.parentOffset);\n      if (view.someProp(\"handleTextInput\", function (f) { return f(view, chFrom, chTo, text$1); })) { return }\n      tr = view.state.tr.insertText(text$1, chFrom, chTo);\n    }\n  }\n\n  if (!tr)\n    { tr = view.state.tr.replace(chFrom, chTo, parse.doc.slice(change.start - parse.from, change.endB - parse.from)); }\n  if (parse.sel) {\n    var sel$2 = resolveSelection(view, tr.doc, parse.sel);\n    // Chrome Android will sometimes, during composition, report the\n    // selection in the wrong place. If it looks like that is\n    // happening, don't update the selection.\n    // Edge just doesn't move the cursor forward when you start typing\n    // in an empty block or between br nodes.\n    if (sel$2 && !(result.chrome && result.android && view.composing && sel$2.empty &&\n                   (sel$2.head == chFrom || sel$2.head == tr.mapping.map(chTo) - 1) ||\n                 result.ie && sel$2.empty && sel$2.head == chFrom))\n      { tr.setSelection(sel$2); }\n  }\n  if (storedMarks) { tr.ensureMarks(storedMarks); }\n  view.dispatch(tr.scrollIntoView());\n}\n\nfunction resolveSelection(view, doc, parsedSel) {\n  if (Math.max(parsedSel.anchor, parsedSel.head) > doc.content.size) { return null }\n  return selectionBetween(view, doc.resolve(parsedSel.anchor), doc.resolve(parsedSel.head))\n}\n\n// : (Fragment, Fragment)  ?{mark: Mark, type: string}\n// Given two same-length, non-empty fragments of inline content,\n// determine whether the first could be created from the second by\n// removing or adding a single mark type.\nfunction isMarkChange(cur, prev) {\n  var curMarks = cur.firstChild.marks, prevMarks = prev.firstChild.marks;\n  var added = curMarks, removed = prevMarks, type, mark, update;\n  for (var i = 0; i < prevMarks.length; i++) { added = prevMarks[i].removeFromSet(added); }\n  for (var i$1 = 0; i$1 < curMarks.length; i$1++) { removed = curMarks[i$1].removeFromSet(removed); }\n  if (added.length == 1 && removed.length == 0) {\n    mark = added[0];\n    type = \"add\";\n    update = function (node) { return node.mark(mark.addToSet(node.marks)); };\n  } else if (added.length == 0 && removed.length == 1) {\n    mark = removed[0];\n    type = \"remove\";\n    update = function (node) { return node.mark(mark.removeFromSet(node.marks)); };\n  } else {\n    return null\n  }\n  var updated = [];\n  for (var i$2 = 0; i$2 < prev.childCount; i$2++) { updated.push(update(prev.child(i$2))); }\n  if (Fragment.from(updated).eq(cur)) { return {mark: mark, type: type} }\n}\n\nfunction looksLikeJoin(old, start, end, $newStart, $newEnd) {\n  if (!$newStart.parent.isTextblock ||\n      // The content must have shrunk\n      end - start <= $newEnd.pos - $newStart.pos ||\n      // newEnd must point directly at or after the end of the block that newStart points into\n      skipClosingAndOpening($newStart, true, false) < $newEnd.pos)\n    { return false }\n\n  var $start = old.resolve(start);\n  // Start must be at the end of a block\n  if ($start.parentOffset < $start.parent.content.size || !$start.parent.isTextblock)\n    { return false }\n  var $next = old.resolve(skipClosingAndOpening($start, true, true));\n  // The next textblock must start before end and end near it\n  if (!$next.parent.isTextblock || $next.pos > end ||\n      skipClosingAndOpening($next, true, false) < end)\n    { return false }\n\n  // The fragments after the join point must match\n  return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)\n}\n\nfunction skipClosingAndOpening($pos, fromEnd, mayOpen) {\n  var depth = $pos.depth, end = fromEnd ? $pos.end() : $pos.pos;\n  while (depth > 0 && (fromEnd || $pos.indexAfter(depth) == $pos.node(depth).childCount)) {\n    depth--;\n    end++;\n    fromEnd = false;\n  }\n  if (mayOpen) {\n    var next = $pos.node(depth).maybeChild($pos.indexAfter(depth));\n    while (next && !next.isLeaf) {\n      next = next.firstChild;\n      end++;\n    }\n  }\n  return end\n}\n\nfunction findDiff(a, b, pos, preferredPos, preferredSide) {\n  var start = a.findDiffStart(b, pos);\n  if (start == null) { return null }\n  var ref = a.findDiffEnd(b, pos + a.size, pos + b.size);\n  var endA = ref.a;\n  var endB = ref.b;\n  if (preferredSide == \"end\") {\n    var adjust = Math.max(0, start - Math.min(endA, endB));\n    preferredPos -= endA + adjust - start;\n  }\n  if (endA < start && a.size < b.size) {\n    var move = preferredPos <= start && preferredPos >= endA ? start - preferredPos : 0;\n    start -= move;\n    endB = start + (endB - endA);\n    endA = start;\n  } else if (endB < start) {\n    var move$1 = preferredPos <= start && preferredPos >= endB ? start - preferredPos : 0;\n    start -= move$1;\n    endA = start + (endA - endB);\n    endB = start;\n  }\n  return {start: start, endA: endA, endB: endB}\n}\n\nfunction serializeForClipboard(view, slice) {\n  var context = [];\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  while (openStart > 1 && openEnd > 1 && content.childCount == 1 && content.firstChild.childCount == 1) {\n    openStart--;\n    openEnd--;\n    var node = content.firstChild;\n    context.push(node.type.name, node.attrs != node.type.defaultAttrs ? node.attrs : null);\n    content = node.content;\n  }\n\n  var serializer = view.someProp(\"clipboardSerializer\") || DOMSerializer.fromSchema(view.state.schema);\n  var doc = detachedDoc(), wrap = doc.createElement(\"div\");\n  wrap.appendChild(serializer.serializeFragment(content, {document: doc}));\n\n  var firstChild = wrap.firstChild, needsWrap;\n  while (firstChild && firstChild.nodeType == 1 && (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])) {\n    for (var i = needsWrap.length - 1; i >= 0; i--) {\n      var wrapper = doc.createElement(needsWrap[i]);\n      while (wrap.firstChild) { wrapper.appendChild(wrap.firstChild); }\n      wrap.appendChild(wrapper);\n    }\n    firstChild = wrap.firstChild;\n  }\n\n  if (firstChild && firstChild.nodeType == 1)\n    { firstChild.setAttribute(\"data-pm-slice\", (openStart + \" \" + openEnd + \" \" + (JSON.stringify(context)))); }\n\n  var text = view.someProp(\"clipboardTextSerializer\", function (f) { return f(slice); }) ||\n      slice.content.textBetween(0, slice.content.size, \"\\n\\n\");\n\n  return {dom: wrap, text: text}\n}\n\n// : (EditorView, string, string, ?bool, ResolvedPos)  ?Slice\n// Read a slice of content from the clipboard (or drop data).\nfunction parseFromClipboard(view, text, html, plainText, $context) {\n  var dom, inCode = $context.parent.type.spec.code, slice;\n  if (!html && !text) { return null }\n  var asText = text && (plainText || inCode || !html);\n  if (asText) {\n    view.someProp(\"transformPastedText\", function (f) { text = f(text, inCode || plainText); });\n    if (inCode) { return new Slice(Fragment.from(view.state.schema.text(text)), 0, 0) }\n    var parsed = view.someProp(\"clipboardTextParser\", function (f) { return f(text, $context, plainText); });\n    if (parsed) {\n      slice = parsed;\n    } else {\n      dom = document.createElement(\"div\");\n      text.trim().split(/(?:\\r\\n?|\\n)+/).forEach(function (block) {\n        dom.appendChild(document.createElement(\"p\")).textContent = block;\n      });\n    }\n  } else {\n    view.someProp(\"transformPastedHTML\", function (f) { html = f(html); });\n    dom = readHTML(html);\n  }\n\n  var contextNode = dom && dom.querySelector(\"[data-pm-slice]\");\n  var sliceData = contextNode && /^(\\d+) (\\d+) (.*)/.exec(contextNode.getAttribute(\"data-pm-slice\"));\n  if (!slice) {\n    var parser = view.someProp(\"clipboardParser\") || view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n    slice = parser.parseSlice(dom, {preserveWhitespace: !!(asText || sliceData), context: $context});\n  }\n  if (sliceData)\n    { slice = addContext(closeSlice(slice, +sliceData[1], +sliceData[2]), sliceData[3]); }\n  else // HTML wasn't created by ProseMirror. Make sure top-level siblings are coherent\n    { slice = Slice.maxOpen(normalizeSiblings(slice.content, $context), false); }\n\n  view.someProp(\"transformPasted\", function (f) { slice = f(slice); });\n  return slice\n}\n\n// Takes a slice parsed with parseSlice, which means there hasn't been\n// any content-expression checking done on the top nodes, tries to\n// find a parent node in the current context that might fit the nodes,\n// and if successful, rebuilds the slice so that it fits into that parent.\n//\n// This addresses the problem that Transform.replace expects a\n// coherent slice, and will fail to place a set of siblings that don't\n// fit anywhere in the schema.\nfunction normalizeSiblings(fragment, $context) {\n  if (fragment.childCount < 2) { return fragment }\n  var loop = function ( d ) {\n    var parent = $context.node(d);\n    var match = parent.contentMatchAt($context.index(d));\n    var lastWrap = (void 0), result = [];\n    fragment.forEach(function (node) {\n      if (!result) { return }\n      var wrap = match.findWrapping(node.type), inLast;\n      if (!wrap) { return result = null }\n      if (inLast = result.length && lastWrap.length && addToSibling(wrap, lastWrap, node, result[result.length - 1], 0)) {\n        result[result.length - 1] = inLast;\n      } else {\n        if (result.length) { result[result.length - 1] = closeRight(result[result.length - 1], lastWrap.length); }\n        var wrapped = withWrappers(node, wrap);\n        result.push(wrapped);\n        match = match.matchType(wrapped.type, wrapped.attrs);\n        lastWrap = wrap;\n      }\n    });\n    if (result) { return { v: Fragment.from(result) } }\n  };\n\n  for (var d = $context.depth; d >= 0; d--) {\n    var returned = loop( d );\n\n    if ( returned ) return returned.v;\n  }\n  return fragment\n}\n\nfunction withWrappers(node, wrap, from) {\n  if ( from === void 0 ) from = 0;\n\n  for (var i = wrap.length - 1; i >= from; i--)\n    { node = wrap[i].create(null, Fragment.from(node)); }\n  return node\n}\n\n// Used to group adjacent nodes wrapped in similar parents by\n// normalizeSiblings into the same parent node\nfunction addToSibling(wrap, lastWrap, node, sibling, depth) {\n  if (depth < wrap.length && depth < lastWrap.length && wrap[depth] == lastWrap[depth]) {\n    var inner = addToSibling(wrap, lastWrap, node, sibling.lastChild, depth + 1);\n    if (inner) { return sibling.copy(sibling.content.replaceChild(sibling.childCount - 1, inner)) }\n    var match = sibling.contentMatchAt(sibling.childCount);\n    if (match.matchType(depth == wrap.length - 1 ? node.type : wrap[depth + 1]))\n      { return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node, wrap, depth + 1)))) }\n  }\n}\n\nfunction closeRight(node, depth) {\n  if (depth == 0) { return node }\n  var fragment = node.content.replaceChild(node.childCount - 1, closeRight(node.lastChild, depth - 1));\n  var fill = node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true);\n  return node.copy(fragment.append(fill))\n}\n\nfunction closeRange(fragment, side, from, to, depth, openEnd) {\n  var node = side < 0 ? fragment.firstChild : fragment.lastChild, inner = node.content;\n  if (depth < to - 1) { inner = closeRange(inner, side, from, to, depth + 1, openEnd); }\n  if (depth >= from)\n    { inner = side < 0 ? node.contentMatchAt(0).fillBefore(inner, fragment.childCount > 1 || openEnd <= depth).append(inner)\n      : inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true)); }\n  return fragment.replaceChild(side < 0 ? 0 : fragment.childCount - 1, node.copy(inner))\n}\n\nfunction closeSlice(slice, openStart, openEnd) {\n  if (openStart < slice.openStart)\n    { slice = new Slice(closeRange(slice.content, -1, openStart, slice.openStart, 0, slice.openEnd), openStart, slice.openEnd); }\n  if (openEnd < slice.openEnd)\n    { slice = new Slice(closeRange(slice.content, 1, openEnd, slice.openEnd, 0, 0), slice.openStart, openEnd); }\n  return slice\n}\n\n// Trick from jQuery -- some elements must be wrapped in other\n// elements for innerHTML to work. I.e. if you do `div.innerHTML =\n// \"<td>..</td>\"` the table cells are ignored.\nvar wrapMap = {\n  thead: [\"table\"],\n  tbody: [\"table\"],\n  tfoot: [\"table\"],\n  caption: [\"table\"],\n  colgroup: [\"table\"],\n  col: [\"table\", \"colgroup\"],\n  tr: [\"table\", \"tbody\"],\n  td: [\"table\", \"tbody\", \"tr\"],\n  th: [\"table\", \"tbody\", \"tr\"]\n};\n\nvar _detachedDoc = null;\nfunction detachedDoc() {\n  return _detachedDoc || (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n}\n\nfunction readHTML(html) {\n  var metas = /(\\s*<meta [^>]*>)*/.exec(html);\n  if (metas) { html = html.slice(metas[0].length); }\n  var elt = detachedDoc().createElement(\"div\");\n  var firstTag = /(?:<meta [^>]*>)*<([a-z][^>\\s]+)/i.exec(html), wrap, depth = 0;\n  if (wrap = firstTag && wrapMap[firstTag[1].toLowerCase()]) {\n    html = wrap.map(function (n) { return \"<\" + n + \">\"; }).join(\"\") + html + wrap.map(function (n) { return \"</\" + n + \">\"; }).reverse().join(\"\");\n    depth = wrap.length;\n  }\n  elt.innerHTML = html;\n  for (var i = 0; i < depth; i++) { elt = elt.firstChild; }\n  return elt\n}\n\nfunction addContext(slice, context) {\n  if (!slice.size) { return slice }\n  var schema = slice.content.firstChild.type.schema, array;\n  try { array = JSON.parse(context); }\n  catch(e) { return slice }\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  for (var i = array.length - 2; i >= 0; i -= 2) {\n    var type = schema.nodes[array[i]];\n    if (!type || type.hasRequiredAttrs()) { break }\n    content = Fragment.from(type.create(array[i + 1], content));\n    openStart++; openEnd++;\n  }\n  return new Slice(content, openStart, openEnd)\n}\n\nvar observeOptions = {\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  attributes: true,\n  attributeOldValue: true,\n  subtree: true\n};\n// IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\nvar useCharData = result.ie && result.ie_version <= 11;\n\nvar SelectionState = function SelectionState() {\n  this.anchorNode = this.anchorOffset = this.focusNode = this.focusOffset = null;\n};\n\nSelectionState.prototype.set = function set (sel) {\n  this.anchorNode = sel.anchorNode; this.anchorOffset = sel.anchorOffset;\n  this.focusNode = sel.focusNode; this.focusOffset = sel.focusOffset;\n};\n\nSelectionState.prototype.eq = function eq (sel) {\n  return sel.anchorNode == this.anchorNode && sel.anchorOffset == this.anchorOffset &&\n    sel.focusNode == this.focusNode && sel.focusOffset == this.focusOffset\n};\n\nvar DOMObserver = function DOMObserver(view, handleDOMChange) {\n  var this$1 = this;\n\n  this.view = view;\n  this.handleDOMChange = handleDOMChange;\n  this.queue = [];\n  this.flushingSoon = -1;\n  this.observer = window.MutationObserver &&\n    new window.MutationObserver(function (mutations) {\n      for (var i = 0; i < mutations.length; i++) { this$1.queue.push(mutations[i]); }\n      // IE11 will sometimes (on backspacing out a single character\n      // text node after a BR node) call the observer callback\n      // before actually updating the DOM, which will cause\n      // ProseMirror to miss the change (see #930)\n      if (result.ie && result.ie_version <= 11 && mutations.some(\n        function (m) { return m.type == \"childList\" && m.removedNodes.length ||\n             m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length; }))\n        { this$1.flushSoon(); }\n      else\n        { this$1.flush(); }\n    });\n  this.currentSelection = new SelectionState;\n  if (useCharData) {\n    this.onCharData = function (e) {\n      this$1.queue.push({target: e.target, type: \"characterData\", oldValue: e.prevValue});\n      this$1.flushSoon();\n    };\n  }\n  this.onSelectionChange = this.onSelectionChange.bind(this);\n  this.suppressingSelectionUpdates = false;\n};\n\nDOMObserver.prototype.flushSoon = function flushSoon () {\n    var this$1 = this;\n\n  if (this.flushingSoon < 0)\n    { this.flushingSoon = window.setTimeout(function () { this$1.flushingSoon = -1; this$1.flush(); }, 20); }\n};\n\nDOMObserver.prototype.forceFlush = function forceFlush () {\n  if (this.flushingSoon > -1) {\n    window.clearTimeout(this.flushingSoon);\n    this.flushingSoon = -1;\n    this.flush();\n  }\n};\n\nDOMObserver.prototype.start = function start () {\n  if (this.observer)\n    { this.observer.observe(this.view.dom, observeOptions); }\n  if (useCharData)\n    { this.view.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.connectSelection();\n};\n\nDOMObserver.prototype.stop = function stop () {\n    var this$1 = this;\n\n  if (this.observer) {\n    var take = this.observer.takeRecords();\n    if (take.length) {\n      for (var i = 0; i < take.length; i++) { this.queue.push(take[i]); }\n      window.setTimeout(function () { return this$1.flush(); }, 20);\n    }\n    this.observer.disconnect();\n  }\n  if (useCharData) { this.view.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.disconnectSelection();\n};\n\nDOMObserver.prototype.connectSelection = function connectSelection () {\n  this.view.dom.ownerDocument.addEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.disconnectSelection = function disconnectSelection () {\n  this.view.dom.ownerDocument.removeEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.suppressSelectionUpdates = function suppressSelectionUpdates () {\n    var this$1 = this;\n\n  this.suppressingSelectionUpdates = true;\n  setTimeout(function () { return this$1.suppressingSelectionUpdates = false; }, 50);\n};\n\nDOMObserver.prototype.onSelectionChange = function onSelectionChange () {\n  if (!hasFocusAndSelection(this.view)) { return }\n  if (this.suppressingSelectionUpdates) { return selectionToDOM(this.view) }\n  // Deletions on IE11 fire their events in the wrong order, giving\n  // us a selection change event before the DOM changes are\n  // reported.\n  if (result.ie && result.ie_version <= 11 && !this.view.state.selection.empty) {\n    var sel = this.view.root.getSelection();\n    // Selection.isCollapsed isn't reliable on IE\n    if (sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n      { return this.flushSoon() }\n  }\n  this.flush();\n};\n\nDOMObserver.prototype.setCurSelection = function setCurSelection () {\n  this.currentSelection.set(this.view.root.getSelection());\n};\n\nDOMObserver.prototype.ignoreSelectionChange = function ignoreSelectionChange (sel) {\n  if (sel.rangeCount == 0) { return true }\n  var container = sel.getRangeAt(0).commonAncestorContainer;\n  var desc = this.view.docView.nearestDesc(container);\n  if (desc && desc.ignoreMutation({type: \"selection\", target: container.nodeType == 3 ? container.parentNode : container})) {\n    this.setCurSelection();\n    return true\n  }\n};\n\nDOMObserver.prototype.flush = function flush () {\n  if (!this.view.docView || this.flushingSoon > -1) { return }\n  var mutations = this.observer ? this.observer.takeRecords() : [];\n  if (this.queue.length) {\n    mutations = this.queue.concat(mutations);\n    this.queue.length = 0;\n  }\n\n  var sel = this.view.root.getSelection();\n  var newSel = !this.suppressingSelectionUpdates && !this.currentSelection.eq(sel) && hasSelection(this.view) && !this.ignoreSelectionChange(sel);\n\n  var from = -1, to = -1, typeOver = false, added = [];\n  if (this.view.editable) {\n    for (var i = 0; i < mutations.length; i++) {\n      var result$1 = this.registerMutation(mutations[i], added);\n      if (result$1) {\n        from = from < 0 ? result$1.from : Math.min(result$1.from, from);\n        to = to < 0 ? result$1.to : Math.max(result$1.to, to);\n        if (result$1.typeOver) { typeOver = true; }\n      }\n    }\n  }\n\n  if (result.gecko && added.length > 1) {\n    var brs = added.filter(function (n) { return n.nodeName == \"BR\"; });\n    if (brs.length == 2) {\n      var a = brs[0];\n        var b = brs[1];\n      if (a.parentNode && a.parentNode.parentNode == b.parentNode) { b.remove(); }\n      else { a.remove(); }\n    }\n  }\n\n  if (from > -1 || newSel) {\n    if (from > -1) {\n      this.view.docView.markDirty(from, to);\n      checkCSS(this.view);\n    }\n    this.handleDOMChange(from, to, typeOver, added);\n    if (this.view.docView.dirty) { this.view.updateState(this.view.state); }\n    else if (!this.currentSelection.eq(sel)) { selectionToDOM(this.view); }\n  }\n};\n\nDOMObserver.prototype.registerMutation = function registerMutation (mut, added) {\n  // Ignore mutations inside nodes that were already noted as inserted\n  if (added.indexOf(mut.target) > -1) { return null }\n  var desc = this.view.docView.nearestDesc(mut.target);\n  if (mut.type == \"attributes\" &&\n      (desc == this.view.docView || mut.attributeName == \"contenteditable\" ||\n       // Firefox sometimes fires spurious events for null/empty styles\n       (mut.attributeName == \"style\" && !mut.oldValue && !mut.target.getAttribute(\"style\"))))\n    { return null }\n  if (!desc || desc.ignoreMutation(mut)) { return null }\n\n  if (mut.type == \"childList\") {\n    var prev = mut.previousSibling, next = mut.nextSibling;\n    if (result.ie && result.ie_version <= 11 && mut.addedNodes.length) {\n      // IE11 gives us incorrect next/prev siblings for some\n      // insertions, so if there are added nodes, recompute those\n      for (var i = 0; i < mut.addedNodes.length; i++) {\n        var ref = mut.addedNodes[i];\n          var previousSibling = ref.previousSibling;\n          var nextSibling = ref.nextSibling;\n        if (!previousSibling || Array.prototype.indexOf.call(mut.addedNodes, previousSibling) < 0) { prev = previousSibling; }\n        if (!nextSibling || Array.prototype.indexOf.call(mut.addedNodes, nextSibling) < 0) { next = nextSibling; }\n      }\n    }\n    var fromOffset = prev && prev.parentNode == mut.target\n        ? domIndex(prev) + 1 : 0;\n    var from = desc.localPosFromDOM(mut.target, fromOffset, -1);\n    var toOffset = next && next.parentNode == mut.target\n        ? domIndex(next) : mut.target.childNodes.length;\n    for (var i$1 = 0; i$1 < mut.addedNodes.length; i$1++) { added.push(mut.addedNodes[i$1]); }\n    var to = desc.localPosFromDOM(mut.target, toOffset, 1);\n    return {from: from, to: to}\n  } else if (mut.type == \"attributes\") {\n    return {from: desc.posAtStart - desc.border, to: desc.posAtEnd + desc.border}\n  } else { // \"characterData\"\n    return {\n      from: desc.posAtStart,\n      to: desc.posAtEnd,\n      // An event was generated for a text change that didn't change\n      // any text. Mark the dom change to fall back to assuming the\n      // selection was typed over with an identical value if it can't\n      // find another change.\n      typeOver: mut.target.nodeValue == mut.oldValue\n    }\n  }\n};\n\nvar cssChecked = false;\n\nfunction checkCSS(view) {\n  if (cssChecked) { return }\n  cssChecked = true;\n  if (getComputedStyle(view.dom).whiteSpace == \"normal\")\n    { console[\"warn\"](\"ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.\"); }\n}\n\n// A collection of DOM events that occur within the editor, and callback functions\n// to invoke when the event fires.\nvar handlers = {}, editHandlers = {};\n\nfunction initInput(view) {\n  view.shiftKey = false;\n  view.mouseDown = null;\n  view.lastKeyCode = null;\n  view.lastKeyCodeTime = 0;\n  view.lastClick = {time: 0, x: 0, y: 0, type: \"\"};\n  view.lastSelectionOrigin = null;\n  view.lastSelectionTime = 0;\n\n  view.lastIOSEnter = 0;\n  view.lastIOSEnterFallbackTimeout = null;\n\n  view.composing = false;\n  view.composingTimeout = null;\n  view.compositionNodes = [];\n  view.compositionEndedAt = -2e8;\n\n  view.domObserver = new DOMObserver(view, function (from, to, typeOver, added) { return readDOMChange(view, from, to, typeOver, added); });\n  view.domObserver.start();\n  // Used by hacks like the beforeinput handler to check whether anything happened in the DOM\n  view.domChangeCount = 0;\n\n  view.eventHandlers = Object.create(null);\n  var loop = function ( event ) {\n    var handler = handlers[event];\n    view.dom.addEventListener(event, view.eventHandlers[event] = function (event) {\n      if (eventBelongsToView(view, event) && !runCustomHandler(view, event) &&\n          (view.editable || !(event.type in editHandlers)))\n        { handler(view, event); }\n    });\n  };\n\n  for (var event in handlers) loop( event );\n  // On Safari, for reasons beyond my understanding, adding an input\n  // event handler makes an issue where the composition vanishes when\n  // you press enter go away.\n  if (result.safari) { view.dom.addEventListener(\"input\", function () { return null; }); }\n\n  ensureListeners(view);\n}\n\nfunction setSelectionOrigin(view, origin) {\n  view.lastSelectionOrigin = origin;\n  view.lastSelectionTime = Date.now();\n}\n\nfunction destroyInput(view) {\n  view.domObserver.stop();\n  for (var type in view.eventHandlers)\n    { view.dom.removeEventListener(type, view.eventHandlers[type]); }\n  clearTimeout(view.composingTimeout);\n  clearTimeout(view.lastIOSEnterFallbackTimeout);\n}\n\nfunction ensureListeners(view) {\n  view.someProp(\"handleDOMEvents\", function (currentHandlers) {\n    for (var type in currentHandlers) { if (!view.eventHandlers[type])\n      { view.dom.addEventListener(type, view.eventHandlers[type] = function (event) { return runCustomHandler(view, event); }); } }\n  });\n}\n\nfunction runCustomHandler(view, event) {\n  return view.someProp(\"handleDOMEvents\", function (handlers) {\n    var handler = handlers[event.type];\n    return handler ? handler(view, event) || event.defaultPrevented : false\n  })\n}\n\nfunction eventBelongsToView(view, event) {\n  if (!event.bubbles) { return true }\n  if (event.defaultPrevented) { return false }\n  for (var node = event.target; node != view.dom; node = node.parentNode)\n    { if (!node || node.nodeType == 11 ||\n        (node.pmViewDesc && node.pmViewDesc.stopEvent(event)))\n      { return false } }\n  return true\n}\n\nfunction dispatchEvent(view, event) {\n  if (!runCustomHandler(view, event) && handlers[event.type] &&\n      (view.editable || !(event.type in editHandlers)))\n    { handlers[event.type](view, event); }\n}\n\neditHandlers.keydown = function (view, event) {\n  view.shiftKey = event.keyCode == 16 || event.shiftKey;\n  if (inOrNearComposition(view, event)) { return }\n  view.domObserver.forceFlush();\n  view.lastKeyCode = event.keyCode;\n  view.lastKeyCodeTime = Date.now();\n  // On iOS, if we preventDefault enter key presses, the virtual\n  // keyboard gets confused. So the hack here is to set a flag that\n  // makes the DOM change code recognize that what just happens should\n  // be replaced by whatever the Enter key handlers do.\n  if (result.ios && event.keyCode == 13 && !event.ctrlKey && !event.altKey && !event.metaKey) {\n    var now = Date.now();\n    view.lastIOSEnter = now;\n    view.lastIOSEnterFallbackTimeout = setTimeout(function () {\n      if (view.lastIOSEnter == now) {\n        view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n        view.lastIOSEnter = 0;\n      }\n    }, 200);\n  } else if (view.someProp(\"handleKeyDown\", function (f) { return f(view, event); }) || captureKeyDown(view, event)) {\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(view, \"key\");\n  }\n};\n\neditHandlers.keyup = function (view, e) {\n  if (e.keyCode == 16) { view.shiftKey = false; }\n};\n\neditHandlers.keypress = function (view, event) {\n  if (inOrNearComposition(view, event) || !event.charCode ||\n      event.ctrlKey && !event.altKey || result.mac && event.metaKey) { return }\n\n  if (view.someProp(\"handleKeyPress\", function (f) { return f(view, event); })) {\n    event.preventDefault();\n    return\n  }\n\n  var sel = view.state.selection;\n  if (!(sel instanceof TextSelection) || !sel.$from.sameParent(sel.$to)) {\n    var text = String.fromCharCode(event.charCode);\n    if (!view.someProp(\"handleTextInput\", function (f) { return f(view, sel.$from.pos, sel.$to.pos, text); }))\n      { view.dispatch(view.state.tr.insertText(text).scrollIntoView()); }\n    event.preventDefault();\n  }\n};\n\nfunction eventCoords(event) { return {left: event.clientX, top: event.clientY} }\n\nfunction isNear(event, click) {\n  var dx = click.x - event.clientX, dy = click.y - event.clientY;\n  return dx * dx + dy * dy < 100\n}\n\nfunction runHandlerOnContext(view, propName, pos, inside, event) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside);\n  var loop = function ( i ) {\n    if (view.someProp(propName, function (f) { return i > $pos.depth ? f(view, pos, $pos.nodeAfter, $pos.before(i), event, true)\n                                                    : f(view, pos, $pos.node(i), $pos.before(i), event, false); }))\n      { return { v: true } }\n  };\n\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var returned = loop( i );\n\n    if ( returned ) return returned.v;\n  }\n  return false\n}\n\nfunction updateSelection(view, selection, origin) {\n  if (!view.focused) { view.focus(); }\n  var tr = view.state.tr.setSelection(selection);\n  if (origin == \"pointer\") { tr.setMeta(\"pointer\", true); }\n  view.dispatch(tr);\n}\n\nfunction selectClickedLeaf(view, inside) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside), node = $pos.nodeAfter;\n  if (node && node.isAtom && NodeSelection.isSelectable(node)) {\n    updateSelection(view, new NodeSelection($pos), \"pointer\");\n    return true\n  }\n  return false\n}\n\nfunction selectClickedNode(view, inside) {\n  if (inside == -1) { return false }\n  var sel = view.state.selection, selectedNode, selectAt;\n  if (sel instanceof NodeSelection) { selectedNode = sel.node; }\n\n  var $pos = view.state.doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    if (NodeSelection.isSelectable(node)) {\n      if (selectedNode && sel.$from.depth > 0 &&\n          i >= sel.$from.depth && $pos.before(sel.$from.depth + 1) == sel.$from.pos)\n        { selectAt = $pos.before(sel.$from.depth); }\n      else\n        { selectAt = $pos.before(i); }\n      break\n    }\n  }\n\n  if (selectAt != null) {\n    updateSelection(view, NodeSelection.create(view.state.doc, selectAt), \"pointer\");\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction handleSingleClick(view, pos, inside, event, selectNode) {\n  return runHandlerOnContext(view, \"handleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleClick\", function (f) { return f(view, pos, event); }) ||\n    (selectNode ? selectClickedNode(view, inside) : selectClickedLeaf(view, inside))\n}\n\nfunction handleDoubleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleDoubleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleDoubleClick\", function (f) { return f(view, pos, event); })\n}\n\nfunction handleTripleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleTripleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleTripleClick\", function (f) { return f(view, pos, event); }) ||\n    defaultTripleClick(view, inside)\n}\n\nfunction defaultTripleClick(view, inside) {\n  var doc = view.state.doc;\n  if (inside == -1) {\n    if (doc.inlineContent) {\n      updateSelection(view, TextSelection.create(doc, 0, doc.content.size), \"pointer\");\n      return true\n    }\n    return false\n  }\n\n  var $pos = doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    var nodePos = $pos.before(i);\n    if (node.inlineContent)\n      { updateSelection(view, TextSelection.create(doc, nodePos + 1, nodePos + 1 + node.content.size), \"pointer\"); }\n    else if (NodeSelection.isSelectable(node))\n      { updateSelection(view, NodeSelection.create(doc, nodePos), \"pointer\"); }\n    else\n      { continue }\n    return true\n  }\n}\n\nfunction forceDOMFlush(view) {\n  return endComposition(view)\n}\n\nvar selectNodeModifier = result.mac ? \"metaKey\" : \"ctrlKey\";\n\nhandlers.mousedown = function (view, event) {\n  view.shiftKey = event.shiftKey;\n  var flushed = forceDOMFlush(view);\n  var now = Date.now(), type = \"singleClick\";\n  if (now - view.lastClick.time < 500 && isNear(event, view.lastClick) && !event[selectNodeModifier]) {\n    if (view.lastClick.type == \"singleClick\") { type = \"doubleClick\"; }\n    else if (view.lastClick.type == \"doubleClick\") { type = \"tripleClick\"; }\n  }\n  view.lastClick = {time: now, x: event.clientX, y: event.clientY, type: type};\n\n  var pos = view.posAtCoords(eventCoords(event));\n  if (!pos) { return }\n\n  if (type == \"singleClick\")\n    { view.mouseDown = new MouseDown(view, pos, event, flushed); }\n  else if ((type == \"doubleClick\" ? handleDoubleClick : handleTripleClick)(view, pos.pos, pos.inside, event))\n    { event.preventDefault(); }\n  else\n    { setSelectionOrigin(view, \"pointer\"); }\n};\n\nvar MouseDown = function MouseDown(view, pos, event, flushed) {\n  var this$1 = this;\n\n  this.view = view;\n  this.startDoc = view.state.doc;\n  this.pos = pos;\n  this.event = event;\n  this.flushed = flushed;\n  this.selectNode = event[selectNodeModifier];\n  this.allowDefault = event.shiftKey;\n\n  var targetNode, targetPos;\n  if (pos.inside > -1) {\n    targetNode = view.state.doc.nodeAt(pos.inside);\n    targetPos = pos.inside;\n  } else {\n    var $pos = view.state.doc.resolve(pos.pos);\n    targetNode = $pos.parent;\n    targetPos = $pos.depth ? $pos.before() : 0;\n  }\n\n  this.mightDrag = null;\n\n  var target = flushed ? null : event.target;\n  var targetDesc = target ? view.docView.nearestDesc(target, true) : null;\n  this.target = targetDesc ? targetDesc.dom : null;\n\n  if (targetNode.type.spec.draggable && targetNode.type.spec.selectable !== false ||\n      view.state.selection instanceof NodeSelection && targetPos == view.state.selection.from)\n    { this.mightDrag = {node: targetNode,\n                      pos: targetPos,\n                      addAttr: this.target && !this.target.draggable,\n                      setUneditable: this.target && result.gecko && !this.target.hasAttribute(\"contentEditable\")}; }\n\n  if (this.target && this.mightDrag && (this.mightDrag.addAttr || this.mightDrag.setUneditable)) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.draggable = true; }\n    if (this.mightDrag.setUneditable)\n      { setTimeout(function () { return this$1.target.setAttribute(\"contentEditable\", \"false\"); }, 20); }\n    this.view.domObserver.start();\n  }\n\n  view.root.addEventListener(\"mouseup\", this.up = this.up.bind(this));\n  view.root.addEventListener(\"mousemove\", this.move = this.move.bind(this));\n  setSelectionOrigin(view, \"pointer\");\n};\n\nMouseDown.prototype.done = function done () {\n  this.view.root.removeEventListener(\"mouseup\", this.up);\n  this.view.root.removeEventListener(\"mousemove\", this.move);\n  if (this.mightDrag && this.target) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.removeAttribute(\"draggable\"); }\n    if (this.mightDrag.setUneditable) { this.target.removeAttribute(\"contentEditable\"); }\n    this.view.domObserver.start();\n  }\n  this.view.mouseDown = null;\n};\n\nMouseDown.prototype.up = function up (event) {\n  this.done();\n\n  if (!this.view.dom.contains(event.target.nodeType == 3 ? event.target.parentNode : event.target))\n    { return }\n\n  var pos = this.pos;\n  if (this.view.state.doc != this.startDoc) { pos = this.view.posAtCoords(eventCoords(event)); }\n\n  if (this.allowDefault || !pos) {\n    setSelectionOrigin(this.view, \"pointer\");\n  } else if (handleSingleClick(this.view, pos.pos, pos.inside, event, this.selectNode)) {\n    event.preventDefault();\n  } else if (this.flushed ||\n             // Safari ignores clicks on draggable elements\n             (result.safari && this.mightDrag && !this.mightDrag.node.isAtom) ||\n             // Chrome will sometimes treat a node selection as a\n             // cursor, but still report that the node is selected\n             // when asked through getSelection. You'll then get a\n             // situation where clicking at the point where that\n             // (hidden) cursor is doesn't change the selection, and\n             // thus doesn't get a reaction from ProseMirror. This\n             // works around that.\n             (result.chrome && !(this.view.state.selection instanceof TextSelection) &&\n              (pos.pos == this.view.state.selection.from || pos.pos == this.view.state.selection.to))) {\n    updateSelection(this.view, Selection.near(this.view.state.doc.resolve(pos.pos)), \"pointer\");\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(this.view, \"pointer\");\n  }\n};\n\nMouseDown.prototype.move = function move (event) {\n  if (!this.allowDefault && (Math.abs(this.event.x - event.clientX) > 4 ||\n                             Math.abs(this.event.y - event.clientY) > 4))\n    { this.allowDefault = true; }\n  setSelectionOrigin(this.view, \"pointer\");\n};\n\nhandlers.touchdown = function (view) {\n  forceDOMFlush(view);\n  setSelectionOrigin(view, \"pointer\");\n};\n\nhandlers.contextmenu = function (view) { return forceDOMFlush(view); };\n\nfunction inOrNearComposition(view, event) {\n  if (view.composing) { return true }\n  // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n  // On Japanese input method editors (IMEs), the Enter key is used to confirm character\n  // selection. On Safari, when Enter is pressed, compositionend and keydown events are\n  // emitted. The keydown event triggers newline insertion, which we don't want.\n  // This method returns true if the keydown event should be ignored.\n  // We only ignore it once, as pressing Enter a second time *should* insert a newline.\n  // Furthermore, the keydown event timestamp must be close to the compositionEndedAt timestamp.\n  // This guards against the case where compositionend is triggered without the keyboard\n  // (e.g. character confirmation may be done with the mouse), and keydown is triggered\n  // afterwards- we wouldn't want to ignore the keydown event in this case.\n  if (result.safari && Math.abs(event.timeStamp - view.compositionEndedAt) < 500) {\n    view.compositionEndedAt = -2e8;\n    return true\n  }\n  return false\n}\n\n// Drop active composition after 5 seconds of inactivity on Android\nvar timeoutComposition = result.android ? 5000 : -1;\n\neditHandlers.compositionstart = editHandlers.compositionupdate = function (view) {\n  if (!view.composing) {\n    view.domObserver.flush();\n    var state = view.state;\n    var $pos = state.selection.$from;\n    if (state.selection.empty &&\n        (state.storedMarks ||\n         (!$pos.textOffset && $pos.parentOffset && $pos.nodeBefore.marks.some(function (m) { return m.type.spec.inclusive === false; })))) {\n      // Need to wrap the cursor in mark nodes different from the ones in the DOM context\n      view.markCursor = view.state.storedMarks || $pos.marks();\n      endComposition(view, true);\n      view.markCursor = null;\n    } else {\n      endComposition(view);\n      // In firefox, if the cursor is after but outside a marked node,\n      // the inserted text won't inherit the marks. So this moves it\n      // inside if necessary.\n      if (result.gecko && state.selection.empty && $pos.parentOffset && !$pos.textOffset && $pos.nodeBefore.marks.length) {\n        var sel = view.root.getSelection();\n        for (var node = sel.focusNode, offset = sel.focusOffset; node && node.nodeType == 1 && offset != 0;) {\n          var before = offset < 0 ? node.lastChild : node.childNodes[offset - 1];\n          if (!before) { break }\n          if (before.nodeType == 3) {\n            sel.collapse(before, before.nodeValue.length);\n            break\n          } else {\n            node = before;\n            offset = -1;\n          }\n        }\n      }\n    }\n    view.composing = true;\n  }\n  scheduleComposeEnd(view, timeoutComposition);\n};\n\neditHandlers.compositionend = function (view, event) {\n  if (view.composing) {\n    view.composing = false;\n    view.compositionEndedAt = event.timeStamp;\n    scheduleComposeEnd(view, 20);\n  }\n};\n\nfunction scheduleComposeEnd(view, delay) {\n  clearTimeout(view.composingTimeout);\n  if (delay > -1) { view.composingTimeout = setTimeout(function () { return endComposition(view); }, delay); }\n}\n\nfunction clearComposition(view) {\n  view.composing = false;\n  while (view.compositionNodes.length > 0) { view.compositionNodes.pop().markParentsDirty(); }\n}\n\nfunction endComposition(view, forceUpdate) {\n  view.domObserver.forceFlush();\n  clearComposition(view);\n  if (forceUpdate || view.docView.dirty) {\n    var sel = selectionFromDOM(view);\n    if (sel && !sel.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel)); }\n    else { view.updateState(view.state); }\n    return true\n  }\n  return false\n}\n\nfunction captureCopy(view, dom) {\n  // The extra wrapper is somehow necessary on IE/Edge to prevent the\n  // content from being mangled when it is put onto the clipboard\n  if (!view.dom.parentNode) { return }\n  var wrap = view.dom.parentNode.appendChild(document.createElement(\"div\"));\n  wrap.appendChild(dom);\n  wrap.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  var sel = getSelection(), range = document.createRange();\n  range.selectNodeContents(dom);\n  // Done because IE will fire a selectionchange moving the selection\n  // to its start when removeAllRanges is called and the editor still\n  // has focus (which will mess up the editor's selection state).\n  view.dom.blur();\n  sel.removeAllRanges();\n  sel.addRange(range);\n  setTimeout(function () {\n    if (wrap.parentNode) { wrap.parentNode.removeChild(wrap); }\n    view.focus();\n  }, 50);\n}\n\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard APIall the objects and methods are\n// there, they just don't work, and they are hard to test.\nvar brokenClipboardAPI = (result.ie && result.ie_version < 15) ||\n      (result.ios && result.webkit_version < 604);\n\nhandlers.copy = editHandlers.cut = function (view, e) {\n  var sel = view.state.selection, cut = e.type == \"cut\";\n  if (sel.empty) { return }\n\n  // IE and Edge's clipboard interface is completely broken\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  var slice = sel.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  if (data) {\n    e.preventDefault();\n    data.clearData();\n    data.setData(\"text/html\", dom.innerHTML);\n    data.setData(\"text/plain\", text);\n  } else {\n    captureCopy(view, dom);\n  }\n  if (cut) { view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta(\"uiEvent\", \"cut\")); }\n};\n\nfunction sliceSingleNode(slice) {\n  return slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1 ? slice.content.firstChild : null\n}\n\nfunction capturePaste(view, e) {\n  if (!view.dom.parentNode) { return }\n  var plainText = view.shiftKey || view.state.selection.$from.parent.type.spec.code;\n  var target = view.dom.parentNode.appendChild(document.createElement(plainText ? \"textarea\" : \"div\"));\n  if (!plainText) { target.contentEditable = \"true\"; }\n  target.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  target.focus();\n  setTimeout(function () {\n    view.focus();\n    if (target.parentNode) { target.parentNode.removeChild(target); }\n    if (plainText) { doPaste(view, target.value, null, e); }\n    else { doPaste(view, target.textContent, target.innerHTML, e); }\n  }, 50);\n}\n\nfunction doPaste(view, text, html, e) {\n  var slice = parseFromClipboard(view, text, html, view.shiftKey, view.state.selection.$from);\n  if (view.someProp(\"handlePaste\", function (f) { return f(view, e, slice || Slice.empty); })) { return true }\n  if (!slice) { return false }\n\n  var singleNode = sliceSingleNode(slice);\n  var tr = singleNode ? view.state.tr.replaceSelectionWith(singleNode, view.shiftKey) : view.state.tr.replaceSelection(slice);\n  view.dispatch(tr.scrollIntoView().setMeta(\"paste\", true).setMeta(\"uiEvent\", \"paste\"));\n  return true\n}\n\neditHandlers.paste = function (view, e) {\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  if (data && doPaste(view, data.getData(\"text/plain\"), data.getData(\"text/html\"), e)) { e.preventDefault(); }\n  else { capturePaste(view, e); }\n};\n\nvar Dragging = function Dragging(slice, move) {\n  this.slice = slice;\n  this.move = move;\n};\n\nvar dragCopyModifier = result.mac ? \"altKey\" : \"ctrlKey\";\n\nhandlers.dragstart = function (view, e) {\n  var mouseDown = view.mouseDown;\n  if (mouseDown) { mouseDown.done(); }\n  if (!e.dataTransfer) { return }\n\n  var sel = view.state.selection;\n  var pos = sel.empty ? null : view.posAtCoords(eventCoords(e));\n  if (pos && pos.pos >= sel.from && pos.pos <= (sel instanceof NodeSelection ? sel.to - 1: sel.to)) ; else if (mouseDown && mouseDown.mightDrag) {\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, mouseDown.mightDrag.pos)));\n  } else if (e.target && e.target.nodeType == 1) {\n    var desc = view.docView.nearestDesc(e.target, true);\n    if (!desc || !desc.node.type.spec.draggable || desc == view.docView) { return }\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, desc.posBefore)));\n  }\n  var slice = view.state.selection.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  e.dataTransfer.clearData();\n  e.dataTransfer.setData(brokenClipboardAPI ? \"Text\" : \"text/html\", dom.innerHTML);\n  if (!brokenClipboardAPI) { e.dataTransfer.setData(\"text/plain\", text); }\n  view.dragging = new Dragging(slice, !e[dragCopyModifier]);\n};\n\nhandlers.dragend = function (view) {\n  var dragging = view.dragging;\n  window.setTimeout(function () {\n    if (view.dragging == dragging)  { view.dragging = null; }\n  }, 50);\n};\n\neditHandlers.dragover = editHandlers.dragenter = function (_, e) { return e.preventDefault(); };\n\neditHandlers.drop = function (view, e) {\n  var dragging = view.dragging;\n  view.dragging = null;\n\n  if (!e.dataTransfer) { return }\n\n  var eventPos = view.posAtCoords(eventCoords(e));\n  if (!eventPos) { return }\n  var $mouse = view.state.doc.resolve(eventPos.pos);\n  if (!$mouse) { return }\n  var slice = dragging && dragging.slice ||\n      parseFromClipboard(view, e.dataTransfer.getData(brokenClipboardAPI ? \"Text\" : \"text/plain\"),\n                         brokenClipboardAPI ? null : e.dataTransfer.getData(\"text/html\"), false, $mouse);\n  var move = dragging && !e[dragCopyModifier];\n  if (view.someProp(\"handleDrop\", function (f) { return f(view, e, slice || Slice.empty, move); })) {\n    e.preventDefault();\n    return\n  }\n  if (!slice) { return }\n\n  e.preventDefault();\n  var insertPos = slice ? dropPoint(view.state.doc, $mouse.pos, slice) : $mouse.pos;\n  if (insertPos == null) { insertPos = $mouse.pos; }\n\n  var tr = view.state.tr;\n  if (move) { tr.deleteSelection(); }\n\n  var pos = tr.mapping.map(insertPos);\n  var isNode = slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1;\n  var beforeInsert = tr.doc;\n  if (isNode)\n    { tr.replaceRangeWith(pos, pos, slice.content.firstChild); }\n  else\n    { tr.replaceRange(pos, pos, slice); }\n  if (tr.doc.eq(beforeInsert)) { return }\n\n  var $pos = tr.doc.resolve(pos);\n  if (isNode && NodeSelection.isSelectable(slice.content.firstChild) &&\n      $pos.nodeAfter && $pos.nodeAfter.sameMarkup(slice.content.firstChild)) {\n    tr.setSelection(new NodeSelection($pos));\n  } else {\n    var end = tr.mapping.map(insertPos);\n    tr.mapping.maps[tr.mapping.maps.length - 1].forEach(function (_from, _to, _newFrom, newTo) { return end = newTo; });\n    tr.setSelection(selectionBetween(view, $pos, tr.doc.resolve(end)));\n  }\n  view.focus();\n  view.dispatch(tr.setMeta(\"uiEvent\", \"drop\"));\n};\n\nhandlers.focus = function (view) {\n  if (!view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.add(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.focused = true;\n    setTimeout(function () {\n      if (view.docView && view.hasFocus() && !view.domObserver.currentSelection.eq(view.root.getSelection()))\n        { selectionToDOM(view); }\n    }, 20);\n  }\n};\n\nhandlers.blur = function (view) {\n  if (view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.remove(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.domObserver.currentSelection.set({});\n    view.focused = false;\n  }\n};\n\nhandlers.beforeinput = function (view, event) {\n  // We should probably do more with beforeinput events, but support\n  // is so spotty that I'm still waiting to see where they are going.\n\n  // Very specific hack to deal with backspace sometimes failing on\n  // Chrome Android when after an uneditable node.\n  if (result.chrome && result.android && event.inputType == \"deleteContentBackward\") {\n    var domChangeCount = view.domChangeCount;\n    setTimeout(function () {\n      if (view.domChangeCount != domChangeCount) { return } // Event already had some effect\n      // This bug tends to close the virtual keyboard, so we refocus\n      view.dom.blur();\n      view.focus();\n      if (view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) { return }\n      var ref = view.state.selection;\n      var $cursor = ref.$cursor;\n      // Crude approximation of backspace behavior when no command handled it\n      if ($cursor && $cursor.pos > 0) { view.dispatch(view.state.tr.delete($cursor.pos - 1, $cursor.pos).scrollIntoView()); }\n    }, 50);\n  }\n};\n\n// Make sure all handlers get registered\nfor (var prop in editHandlers) { handlers[prop] = editHandlers[prop]; }\n\nfunction compareObjs(a, b) {\n  if (a == b) { return true }\n  for (var p in a) { if (a[p] !== b[p]) { return false } }\n  for (var p$1 in b) { if (!(p$1 in a)) { return false } }\n  return true\n}\n\nvar WidgetType = function WidgetType(toDOM, spec) {\n  this.spec = spec || noSpec;\n  this.side = this.spec.side || 0;\n  this.toDOM = toDOM;\n};\n\nWidgetType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var ref = mapping.mapResult(span.from + oldOffset, this.side < 0 ? -1 : 1);\n    var pos = ref.pos;\n    var deleted = ref.deleted;\n  return deleted ? null : new Decoration(pos - offset, pos - offset, this)\n};\n\nWidgetType.prototype.valid = function valid () { return true };\n\nWidgetType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof WidgetType &&\n     (this.spec.key && this.spec.key == other.spec.key ||\n      this.toDOM == other.toDOM && compareObjs(this.spec, other.spec)))\n};\n\nvar InlineType = function InlineType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nInlineType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.map(span.from + oldOffset, this.spec.inclusiveStart ? -1 : 1) - offset;\n  var to = mapping.map(span.to + oldOffset, this.spec.inclusiveEnd ? 1 : -1) - offset;\n  return from >= to ? null : new Decoration(from, to, this)\n};\n\nInlineType.prototype.valid = function valid (_, span) { return span.from < span.to };\n\nInlineType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof InlineType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\nInlineType.is = function is (span) { return span.type instanceof InlineType };\n\nvar NodeType = function NodeType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nNodeType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.mapResult(span.from + oldOffset, 1);\n  if (from.deleted) { return null }\n  var to = mapping.mapResult(span.to + oldOffset, -1);\n  if (to.deleted || to.pos <= from.pos) { return null }\n  return new Decoration(from.pos - offset, to.pos - offset, this)\n};\n\nNodeType.prototype.valid = function valid (node, span) {\n  var ref = node.content.findIndex(span.from);\n    var index = ref.index;\n    var offset = ref.offset;\n  return offset == span.from && offset + node.child(index).nodeSize == span.to\n};\n\nNodeType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof NodeType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\n// ::- Decoration objects can be provided to the view through the\n// [`decorations` prop](#view.EditorProps.decorations). They come in\n// several variantssee the static members of this class for details.\nvar Decoration = function Decoration(from, to, type) {\n  // :: number\n  // The start position of the decoration.\n  this.from = from;\n  // :: number\n  // The end position. Will be the same as `from` for [widget\n  // decorations](#view.Decoration^widget).\n  this.to = to;\n  this.type = type;\n};\n\nvar prototypeAccessors$1 = { spec: { configurable: true },inline: { configurable: true } };\n\nDecoration.prototype.copy = function copy (from, to) {\n  return new Decoration(from, to, this.type)\n};\n\nDecoration.prototype.eq = function eq (other, offset) {\n    if ( offset === void 0 ) offset = 0;\n\n  return this.type.eq(other.type) && this.from + offset == other.from && this.to + offset == other.to\n};\n\nDecoration.prototype.map = function map (mapping, offset, oldOffset) {\n  return this.type.map(mapping, this, offset, oldOffset)\n};\n\n// :: (number, union<(view: EditorView, getPos: ()  number)  dom.Node, dom.Node>, ?Object)  Decoration\n// Creates a widget decoration, which is a DOM node that's shown in\n// the document at the given position. It is recommended that you\n// delay rendering the widget by passing a function that will be\n// called when the widget is actually drawn in a view, but you can\n// also directly pass a DOM node. `getPos` can be used to find the\n// widget's current document position.\n//\n// spec::- These options are supported:\n//\n//   side:: ?number\n//   Controls which side of the document position this widget is\n//   associated with. When negative, it is drawn before a cursor\n//   at its position, and content inserted at that position ends\n//   up after the widget. When zero (the default) or positive, the\n//   widget is drawn after the cursor and content inserted there\n//   ends up before the widget.\n//\n//   When there are multiple widgets at a given position, their\n//   `side` values determine the order in which they appear. Those\n//   with lower values appear first. The ordering of widgets with\n//   the same `side` value is unspecified.\n//\n//   When `marks` is null, `side` also determines the marks that\n//   the widget is wrapped inthose of the node before when\n//   negative, those of the node after when positive.\n//\n//   marks:: ?[Mark]\n//   The precise set of marks to draw around the widget.\n//\n//   stopEvent:: ?(event: dom.Event)  bool\n//   Can be used to control which DOM events, when they bubble out\n//   of this widget, the editor view should ignore.\n//\n//   ignoreSelection:: ?bool\n//   When set (defaults to false), selection changes inside the\n//   widget are ignored, and don't cause ProseMirror to try and\n//   re-sync the selection with its selection state.\n//\n//   key:: ?string\n//   When comparing decorations of this type (in order to decide\n//   whether it needs to be redrawn), ProseMirror will by default\n//   compare the widget DOM node by identity. If you pass a key,\n//   that key will be compared instead, which can be useful when\n//   you generate decorations on the fly and don't want to store\n//   and reuse DOM nodes. Make sure that any widgets with the same\n//   key are interchangeableif widgets differ in, for example,\n//   the behavior of some event handler, they should get\n//   different keys.\nDecoration.widget = function widget (pos, toDOM, spec) {\n  return new Decoration(pos, pos, new WidgetType(toDOM, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object)  Decoration\n// Creates an inline decoration, which adds the given attributes to\n// each inline node between `from` and `to`.\n//\n// spec::- These options are recognized:\n//\n//   inclusiveStart:: ?bool\n//   Determines how the left side of the decoration is\n//   [mapped](#transform.Position_Mapping) when content is\n//   inserted directly at that position. By default, the decoration\n//   won't include the new content, but you can set this to `true`\n//   to make it inclusive.\n//\n//   inclusiveEnd:: ?bool\n//   Determines how the right side of the decoration is mapped.\n//   See\n//   [`inclusiveStart`](#view.Decoration^inline^spec.inclusiveStart).\nDecoration.inline = function inline (from, to, attrs, spec) {\n  return new Decoration(from, to, new InlineType(attrs, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object)  Decoration\n// Creates a node decoration. `from` and `to` should point precisely\n// before and after a node in the document. That node, and only that\n// node, will receive the given attributes.\n//\n// spec::-\n//\n// Optional information to store with the decoration. It\n// is also used when comparing decorators for equality.\nDecoration.node = function node (from, to, attrs, spec) {\n  return new Decoration(from, to, new NodeType(attrs, spec))\n};\n\n// :: Object\n// The spec provided when creating this decoration. Can be useful\n// if you've stored extra information in that object.\nprototypeAccessors$1.spec.get = function () { return this.type.spec };\n\nprototypeAccessors$1.inline.get = function () { return this.type instanceof InlineType };\n\nObject.defineProperties( Decoration.prototype, prototypeAccessors$1 );\n\n// DecorationAttrs:: interface\n// A set of attributes to add to a decorated node. Most properties\n// simply directly correspond to DOM attributes of the same name,\n// which will be set to the property's value. These are exceptions:\n//\n//   class:: ?string\n//   A CSS class name or a space-separated set of class names to be\n//   _added_ to the classes that the node already had.\n//\n//   style:: ?string\n//   A string of CSS to be _added_ to the node's existing `style` property.\n//\n//   nodeName:: ?string\n//   When non-null, the target node is wrapped in a DOM element of\n//   this type (and the other attributes are applied to this element).\n\nvar none = [], noSpec = {};\n\n// ::- A collection of [decorations](#view.Decoration), organized in\n// such a way that the drawing algorithm can efficiently use and\n// compare them. This is a persistent data structureit is not\n// modified, updates create a new value.\nvar DecorationSet = function DecorationSet(local, children) {\n  this.local = local && local.length ? local : none;\n  this.children = children && children.length ? children : none;\n};\n\n// :: (Node, [Decoration])  DecorationSet\n// Create a set of decorations, using the structure of the given\n// document.\nDecorationSet.create = function create (doc, decorations) {\n  return decorations.length ? buildTree(decorations, doc, 0, noSpec) : empty\n};\n\n// :: (?number, ?number, ?(spec: Object)  bool)  [Decoration]\n// Find all decorations in this set which touch the given range\n// (including decorations that start or end directly at the\n// boundaries) and match the given predicate on their spec. When\n// `start` and `end` are omitted, all decorations in the set are\n// considered. When `predicate` isn't given, all decorations are\n// assumed to match.\nDecorationSet.prototype.find = function find (start, end, predicate) {\n  var result = [];\n  this.findInner(start == null ? 0 : start, end == null ? 1e9 : end, result, 0, predicate);\n  return result\n};\n\nDecorationSet.prototype.findInner = function findInner (start, end, result, offset, predicate) {\n  for (var i = 0; i < this.local.length; i++) {\n    var span = this.local[i];\n    if (span.from <= end && span.to >= start && (!predicate || predicate(span.spec)))\n      { result.push(span.copy(span.from + offset, span.to + offset)); }\n  }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3) {\n    if (this.children[i$1] < end && this.children[i$1 + 1] > start) {\n      var childOff = this.children[i$1] + 1;\n      this.children[i$1 + 2].findInner(start - childOff, end - childOff, result, offset + childOff, predicate);\n    }\n  }\n};\n\n// :: (Mapping, Node, ?Object)  DecorationSet\n// Map the set of decorations in response to a change in the\n// document.\n//\n// options::- An optional set of options.\n//\n//   onRemove:: ?(decorationSpec: Object)\n//   When given, this function will be called for each decoration\n//   that gets dropped as a result of the mapping, passing the\n//   spec of that decoration.\nDecorationSet.prototype.map = function map (mapping, doc, options) {\n  if (this == empty || mapping.maps.length == 0) { return this }\n  return this.mapInner(mapping, doc, 0, 0, options || noSpec)\n};\n\nDecorationSet.prototype.mapInner = function mapInner (mapping, node, offset, oldOffset, options) {\n  var newLocal;\n  for (var i = 0; i < this.local.length; i++) {\n    var mapped = this.local[i].map(mapping, offset, oldOffset);\n    if (mapped && mapped.type.valid(node, mapped)) { (newLocal || (newLocal = [])).push(mapped); }\n    else if (options.onRemove) { options.onRemove(this.local[i].spec); }\n  }\n\n  if (this.children.length)\n    { return mapChildren(this.children, newLocal, mapping, node, offset, oldOffset, options) }\n  else\n    { return newLocal ? new DecorationSet(newLocal.sort(byPos)) : empty }\n};\n\n// :: (Node, [Decoration])  DecorationSet\n// Add the given array of decorations to the ones in the set,\n// producing a new set. Needs access to the current document to\n// create the appropriate tree structure.\nDecorationSet.prototype.add = function add (doc, decorations) {\n  if (!decorations.length) { return this }\n  if (this == empty) { return DecorationSet.create(doc, decorations) }\n  return this.addInner(doc, decorations, 0)\n};\n\nDecorationSet.prototype.addInner = function addInner (doc, decorations, offset) {\n    var this$1 = this;\n\n  var children, childIndex = 0;\n  doc.forEach(function (childNode, childOffset) {\n    var baseOffset = childOffset + offset, found;\n    if (!(found = takeSpansForNode(decorations, childNode, baseOffset))) { return }\n\n    if (!children) { children = this$1.children.slice(); }\n    while (childIndex < children.length && children[childIndex] < childOffset) { childIndex += 3; }\n    if (children[childIndex] == childOffset)\n      { children[childIndex + 2] = children[childIndex + 2].addInner(childNode, found, baseOffset + 1); }\n    else\n      { children.splice(childIndex, 0, childOffset, childOffset + childNode.nodeSize, buildTree(found, childNode, baseOffset + 1, noSpec)); }\n    childIndex += 3;\n  });\n\n  var local = moveSpans(childIndex ? withoutNulls(decorations) : decorations, -offset);\n  return new DecorationSet(local.length ? this.local.concat(local).sort(byPos) : this.local,\n                           children || this.children)\n};\n\n// :: ([Decoration])  DecorationSet\n// Create a new set that contains the decorations in this set, minus\n// the ones in the given array.\nDecorationSet.prototype.remove = function remove (decorations) {\n  if (decorations.length == 0 || this == empty) { return this }\n  return this.removeInner(decorations, 0)\n};\n\nDecorationSet.prototype.removeInner = function removeInner (decorations, offset) {\n  var children = this.children, local = this.local;\n  for (var i = 0; i < children.length; i += 3) {\n    var found = (void 0), from = children[i] + offset, to = children[i + 1] + offset;\n    for (var j = 0, span = (void 0); j < decorations.length; j++) { if (span = decorations[j]) {\n      if (span.from > from && span.to < to) {\n        decorations[j] = null\n        ;(found || (found = [])).push(span);\n      }\n    } }\n    if (!found) { continue }\n    if (children == this.children) { children = this.children.slice(); }\n    var removed = children[i + 2].removeInner(found, from + 1);\n    if (removed != empty) {\n      children[i + 2] = removed;\n    } else {\n      children.splice(i, 3);\n      i -= 3;\n    }\n  }\n  if (local.length) { for (var i$1 = 0, span$1 = (void 0); i$1 < decorations.length; i$1++) { if (span$1 = decorations[i$1]) {\n    for (var j$1 = 0; j$1 < local.length; j$1++) { if (local[j$1].eq(span$1, offset)) {\n      if (local == this.local) { local = this.local.slice(); }\n      local.splice(j$1--, 1);\n    } }\n  } } }\n  if (children == this.children && local == this.local) { return this }\n  return local.length || children.length ? new DecorationSet(local, children) : empty\n};\n\nDecorationSet.prototype.forChild = function forChild (offset, node) {\n  if (this == empty) { return this }\n  if (node.isLeaf) { return DecorationSet.empty }\n\n  var child, local;\n  for (var i = 0; i < this.children.length; i += 3) { if (this.children[i] >= offset) {\n    if (this.children[i] == offset) { child = this.children[i + 2]; }\n    break\n  } }\n  var start = offset + 1, end = start + node.content.size;\n  for (var i$1 = 0; i$1 < this.local.length; i$1++) {\n    var dec = this.local[i$1];\n    if (dec.from < end && dec.to > start && (dec.type instanceof InlineType)) {\n      var from = Math.max(start, dec.from) - start, to = Math.min(end, dec.to) - start;\n      if (from < to) { (local || (local = [])).push(dec.copy(from, to)); }\n    }\n  }\n  if (local) {\n    var localSet = new DecorationSet(local.sort(byPos));\n    return child ? new DecorationGroup([localSet, child]) : localSet\n  }\n  return child || empty\n};\n\nDecorationSet.prototype.eq = function eq (other) {\n  if (this == other) { return true }\n  if (!(other instanceof DecorationSet) ||\n      this.local.length != other.local.length ||\n      this.children.length != other.children.length) { return false }\n  for (var i = 0; i < this.local.length; i++)\n    { if (!this.local[i].eq(other.local[i])) { return false } }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3)\n    { if (this.children[i$1] != other.children[i$1] ||\n        this.children[i$1 + 1] != other.children[i$1 + 1] ||\n        !this.children[i$1 + 2].eq(other.children[i$1 + 2])) { return false } }\n  return true\n};\n\nDecorationSet.prototype.locals = function locals (node) {\n  return removeOverlap(this.localsInner(node))\n};\n\nDecorationSet.prototype.localsInner = function localsInner (node) {\n  if (this == empty) { return none }\n  if (node.inlineContent || !this.local.some(InlineType.is)) { return this.local }\n  var result = [];\n  for (var i = 0; i < this.local.length; i++) {\n    if (!(this.local[i].type instanceof InlineType))\n      { result.push(this.local[i]); }\n  }\n  return result\n};\n\nvar empty = new DecorationSet();\n\n// :: DecorationSet\n// The empty set of decorations.\nDecorationSet.empty = empty;\n\nDecorationSet.removeOverlap = removeOverlap;\n\n// :- An abstraction that allows the code dealing with decorations to\n// treat multiple DecorationSet objects as if it were a single object\n// with (a subset of) the same interface.\nvar DecorationGroup = function DecorationGroup(members) {\n  this.members = members;\n};\n\nDecorationGroup.prototype.forChild = function forChild (offset, child) {\n  if (child.isLeaf) { return DecorationSet.empty }\n  var found = [];\n  for (var i = 0; i < this.members.length; i++) {\n    var result = this.members[i].forChild(offset, child);\n    if (result == empty) { continue }\n    if (result instanceof DecorationGroup) { found = found.concat(result.members); }\n    else { found.push(result); }\n  }\n  return DecorationGroup.from(found)\n};\n\nDecorationGroup.prototype.eq = function eq (other) {\n  if (!(other instanceof DecorationGroup) ||\n      other.members.length != this.members.length) { return false }\n  for (var i = 0; i < this.members.length; i++)\n    { if (!this.members[i].eq(other.members[i])) { return false } }\n  return true\n};\n\nDecorationGroup.prototype.locals = function locals (node) {\n  var result, sorted = true;\n  for (var i = 0; i < this.members.length; i++) {\n    var locals = this.members[i].localsInner(node);\n    if (!locals.length) { continue }\n    if (!result) {\n      result = locals;\n    } else {\n      if (sorted) {\n        result = result.slice();\n        sorted = false;\n      }\n      for (var j = 0; j < locals.length; j++) { result.push(locals[j]); }\n    }\n  }\n  return result ? removeOverlap(sorted ? result : result.sort(byPos)) : none\n};\n\n// : ([DecorationSet])  union<DecorationSet, DecorationGroup>\n// Create a group for the given array of decoration sets, or return\n// a single set when possible.\nDecorationGroup.from = function from (members) {\n  switch (members.length) {\n    case 0: return empty\n    case 1: return members[0]\n    default: return new DecorationGroup(members)\n  }\n};\n\nfunction mapChildren(oldChildren, newLocal, mapping, node, offset, oldOffset, options) {\n  var children = oldChildren.slice();\n\n  // Mark the children that are directly touched by changes, and\n  // move those that are after the changes.\n  var shift = function (oldStart, oldEnd, newStart, newEnd) {\n    for (var i = 0; i < children.length; i += 3) {\n      var end = children[i + 1], dSize = (void 0);\n      if (end == -1 || oldStart > end + oldOffset) { continue }\n      if (oldEnd >= children[i] + oldOffset) {\n        children[i + 1] = -1;\n      } else if (newStart >= offset && (dSize = (newEnd - newStart) - (oldEnd - oldStart))) {\n        children[i] += dSize;\n        children[i + 1] += dSize;\n      }\n    }\n  };\n  for (var i = 0; i < mapping.maps.length; i++) { mapping.maps[i].forEach(shift); }\n\n  // Find the child nodes that still correspond to a single node,\n  // recursively call mapInner on them and update their positions.\n  var mustRebuild = false;\n  for (var i$1 = 0; i$1 < children.length; i$1 += 3) { if (children[i$1 + 1] == -1) { // Touched nodes\n    var from = mapping.map(oldChildren[i$1] + oldOffset), fromLocal = from - offset;\n    if (fromLocal < 0 || fromLocal >= node.content.size) {\n      mustRebuild = true;\n      continue\n    }\n    // Must read oldChildren because children was tagged with -1\n    var to = mapping.map(oldChildren[i$1 + 1] + oldOffset, -1), toLocal = to - offset;\n    var ref = node.content.findIndex(fromLocal);\n    var index = ref.index;\n    var childOffset = ref.offset;\n    var childNode = node.maybeChild(index);\n    if (childNode && childOffset == fromLocal && childOffset + childNode.nodeSize == toLocal) {\n      var mapped = children[i$1 + 2].mapInner(mapping, childNode, from + 1, oldChildren[i$1] + oldOffset + 1, options);\n      if (mapped != empty) {\n        children[i$1] = fromLocal;\n        children[i$1 + 1] = toLocal;\n        children[i$1 + 2] = mapped;\n      } else {\n        children[i$1 + 1] = -2;\n        mustRebuild = true;\n      }\n    } else {\n      mustRebuild = true;\n    }\n  } }\n\n  // Remaining children must be collected and rebuilt into the appropriate structure\n  if (mustRebuild) {\n    var decorations = mapAndGatherRemainingDecorations(children, oldChildren, newLocal || [], mapping,\n                                                       offset, oldOffset, options);\n    var built = buildTree(decorations, node, 0, options);\n    newLocal = built.local;\n    for (var i$2 = 0; i$2 < children.length; i$2 += 3) { if (children[i$2 + 1] < 0) {\n      children.splice(i$2, 3);\n      i$2 -= 3;\n    } }\n    for (var i$3 = 0, j = 0; i$3 < built.children.length; i$3 += 3) {\n      var from$1 = built.children[i$3];\n      while (j < children.length && children[j] < from$1) { j += 3; }\n      children.splice(j, 0, built.children[i$3], built.children[i$3 + 1], built.children[i$3 + 2]);\n    }\n  }\n\n  return new DecorationSet(newLocal && newLocal.sort(byPos), children)\n}\n\nfunction moveSpans(spans, offset) {\n  if (!offset || !spans.length) { return spans }\n  var result = [];\n  for (var i = 0; i < spans.length; i++) {\n    var span = spans[i];\n    result.push(new Decoration(span.from + offset, span.to + offset, span.type));\n  }\n  return result\n}\n\nfunction mapAndGatherRemainingDecorations(children, oldChildren, decorations, mapping, offset, oldOffset, options) {\n  // Gather all decorations from the remaining marked children\n  function gather(set, oldOffset) {\n    for (var i = 0; i < set.local.length; i++) {\n      var mapped = set.local[i].map(mapping, offset, oldOffset);\n      if (mapped) { decorations.push(mapped); }\n      else if (options.onRemove) { options.onRemove(set.local[i].spec); }\n    }\n    for (var i$1 = 0; i$1 < set.children.length; i$1 += 3)\n      { gather(set.children[i$1 + 2], set.children[i$1] + oldOffset + 1); }\n  }\n  for (var i = 0; i < children.length; i += 3) { if (children[i + 1] == -1)\n    { gather(children[i + 2], oldChildren[i] + oldOffset + 1); } }\n\n  return decorations\n}\n\nfunction takeSpansForNode(spans, node, offset) {\n  if (node.isLeaf) { return null }\n  var end = offset + node.nodeSize, found = null;\n  for (var i = 0, span = (void 0); i < spans.length; i++) {\n    if ((span = spans[i]) && span.from > offset && span.to < end) {\n(found || (found = [])).push(span);\n      spans[i] = null;\n    }\n  }\n  return found\n}\n\nfunction withoutNulls(array) {\n  var result = [];\n  for (var i = 0; i < array.length; i++)\n    { if (array[i] != null) { result.push(array[i]); } }\n  return result\n}\n\n// : ([Decoration], Node, number)  DecorationSet\n// Build up a tree that corresponds to a set of decorations. `offset`\n// is a base offset that should be subtractet from the `from` and `to`\n// positions in the spans (so that we don't have to allocate new spans\n// for recursive calls).\nfunction buildTree(spans, node, offset, options) {\n  var children = [], hasNulls = false;\n  node.forEach(function (childNode, localStart) {\n    var found = takeSpansForNode(spans, childNode, localStart + offset);\n    if (found) {\n      hasNulls = true;\n      var subtree = buildTree(found, childNode, offset + localStart + 1, options);\n      if (subtree != empty)\n        { children.push(localStart, localStart + childNode.nodeSize, subtree); }\n    }\n  });\n  var locals = moveSpans(hasNulls ? withoutNulls(spans) : spans, -offset).sort(byPos);\n  for (var i = 0; i < locals.length; i++) { if (!locals[i].type.valid(node, locals[i])) {\n    if (options.onRemove) { options.onRemove(locals[i].spec); }\n    locals.splice(i--, 1);\n  } }\n  return locals.length || children.length ? new DecorationSet(locals, children) : empty\n}\n\n// : (Decoration, Decoration)  number\n// Used to sort decorations so that ones with a low start position\n// come first, and within a set with the same start position, those\n// with an smaller end position come first.\nfunction byPos(a, b) {\n  return a.from - b.from || a.to - b.to\n}\n\n// : ([Decoration])  [Decoration]\n// Scan a sorted array of decorations for partially overlapping spans,\n// and split those so that only fully overlapping spans are left (to\n// make subsequent rendering easier). Will return the input array if\n// no partially overlapping spans are found (the common case).\nfunction removeOverlap(spans) {\n  var working = spans;\n  for (var i = 0; i < working.length - 1; i++) {\n    var span = working[i];\n    if (span.from != span.to) { for (var j = i + 1; j < working.length; j++) {\n      var next = working[j];\n      if (next.from == span.from) {\n        if (next.to != span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // Followed by a partially overlapping larger span. Split that\n          // span.\n          working[j] = next.copy(next.from, span.to);\n          insertAhead(working, j + 1, next.copy(span.to, next.to));\n        }\n        continue\n      } else {\n        if (next.from < span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // The end of this one overlaps with a subsequent span. Split\n          // this one.\n          working[i] = span.copy(span.from, next.from);\n          insertAhead(working, j, span.copy(next.from, span.to));\n        }\n        break\n      }\n    } }\n  }\n  return working\n}\n\nfunction insertAhead(array, i, deco) {\n  while (i < array.length && byPos(deco, array[i]) > 0) { i++; }\n  array.splice(i, 0, deco);\n}\n\n// : (EditorView)  union<DecorationSet, DecorationGroup>\n// Get the decorations associated with the current props of a view.\nfunction viewDecorations(view) {\n  var found = [];\n  view.someProp(\"decorations\", function (f) {\n    var result = f(view.state);\n    if (result && result != empty) { found.push(result); }\n  });\n  if (view.cursorWrapper)\n    { found.push(DecorationSet.create(view.state.doc, [view.cursorWrapper.deco])); }\n  return DecorationGroup.from(found)\n}\n\n// ::- An editor view manages the DOM structure that represents an\n// editable document. Its state and behavior are determined by its\n// [props](#view.DirectEditorProps).\nvar EditorView = function EditorView(place, props) {\n  this._props = props;\n  // :: EditorState\n  // The view's current [state](#state.EditorState).\n  this.state = props.state;\n\n  this.dispatch = this.dispatch.bind(this);\n\n  this._root = null;\n  this.focused = false;\n  // Kludge used to work around a Chrome bug\n  this.trackWrites = null;\n\n  // :: dom.Element\n  // An editable DOM node containing the document. (You probably\n  // should not directly interfere with its content.)\n  this.dom = (place && place.mount) || document.createElement(\"div\");\n  if (place) {\n    if (place.appendChild) { place.appendChild(this.dom); }\n    else if (place.apply) { place(this.dom); }\n    else if (place.mount) { this.mounted = true; }\n  }\n\n  // :: bool\n  // Indicates whether the editor is currently [editable](#view.EditorProps.editable).\n  this.editable = getEditable(this);\n  this.markCursor = null;\n  this.cursorWrapper = null;\n  updateCursorWrapper(this);\n  this.nodeViews = buildNodeViews(this);\n  this.docView = docViewDesc(this.state.doc, computeDocDeco(this), viewDecorations(this), this.dom, this);\n\n  this.lastSelectedViewDesc = null;\n  // :: ?{slice: Slice, move: bool}\n  // When editor content is being dragged, this object contains\n  // information about the dragged slice and whether it is being\n  // copied or moved. At any other time, it is null.\n  this.dragging = null;\n\n  initInput(this);\n\n  this.pluginViews = [];\n  this.updatePluginViews();\n};\n\nvar prototypeAccessors$2 = { props: { configurable: true },root: { configurable: true } };\n\n// composing:: boolean\n// Holds `true` when a\n// [composition](https://developer.mozilla.org/en-US/docs/Mozilla/IME_handling_guide)\n// is active.\n\n// :: DirectEditorProps\n// The view's current [props](#view.EditorProps).\nprototypeAccessors$2.props.get = function () {\n  if (this._props.state != this.state) {\n    var prev = this._props;\n    this._props = {};\n    for (var name in prev) { this._props[name] = prev[name]; }\n    this._props.state = this.state;\n  }\n  return this._props\n};\n\n// :: (DirectEditorProps)\n// Update the view's props. Will immediately cause an update to\n// the DOM.\nEditorView.prototype.update = function update (props) {\n  if (props.handleDOMEvents != this._props.handleDOMEvents) { ensureListeners(this); }\n  this._props = props;\n  this.updateStateInner(props.state, true);\n};\n\n// :: (DirectEditorProps)\n// Update the view by updating existing props object with the object\n// given as argument. Equivalent to `view.update(Object.assign({},\n// view.props, props))`.\nEditorView.prototype.setProps = function setProps (props) {\n  var updated = {};\n  for (var name in this._props) { updated[name] = this._props[name]; }\n  updated.state = this.state;\n  for (var name$1 in props) { updated[name$1] = props[name$1]; }\n  this.update(updated);\n};\n\n// :: (EditorState)\n// Update the editor's `state` prop, without touching any of the\n// other props.\nEditorView.prototype.updateState = function updateState (state) {\n  this.updateStateInner(state, this.state.plugins != state.plugins);\n};\n\nEditorView.prototype.updateStateInner = function updateStateInner (state, reconfigured) {\n    var this$1 = this;\n\n  var prev = this.state, redraw = false, updateSel = false;\n  // When stored marks are added, stop composition, so that they can\n  // be displayed.\n  if (state.storedMarks && this.composing) {\n    clearComposition(this);\n    updateSel = true;\n  }\n  this.state = state;\n  if (reconfigured) {\n    var nodeViews = buildNodeViews(this);\n    if (changedNodeViews(nodeViews, this.nodeViews)) {\n      this.nodeViews = nodeViews;\n      redraw = true;\n    }\n    ensureListeners(this);\n  }\n\n  this.editable = getEditable(this);\n  updateCursorWrapper(this);\n  var innerDeco = viewDecorations(this), outerDeco = computeDocDeco(this);\n\n  var scroll = reconfigured ? \"reset\"\n      : state.scrollToSelection > prev.scrollToSelection ? \"to selection\" : \"preserve\";\n  var updateDoc = redraw || !this.docView.matchesNode(state.doc, outerDeco, innerDeco);\n  if (updateDoc || !state.selection.eq(prev.selection)) { updateSel = true; }\n  var oldScrollPos = scroll == \"preserve\" && updateSel && this.dom.style.overflowAnchor == null && storeScrollPos(this);\n\n  if (updateSel) {\n    this.domObserver.stop();\n    // Work around an issue in Chrome, IE, and Edge where changing\n    // the DOM around an active selection puts it into a broken\n    // state where the thing the user sees differs from the\n    // selection reported by the Selection object (#710, #973,\n    // #1011, #1013, #1035).\n    var forceSelUpdate = updateDoc && (result.ie || result.chrome) && !this.composing &&\n        !prev.selection.empty && !state.selection.empty && selectionContextChanged(prev.selection, state.selection);\n    if (updateDoc) {\n      // If the node that the selection points into is written to,\n      // Chrome sometimes starts misreporting the selection, so this\n      // tracks that and forces a selection reset when our update\n      // did write to the node.\n      var chromeKludge = result.chrome ? (this.trackWrites = this.root.getSelection().focusNode) : null;\n      if (redraw || !this.docView.update(state.doc, outerDeco, innerDeco, this)) {\n        this.docView.updateOuterDeco([]);\n        this.docView.destroy();\n        this.docView = docViewDesc(state.doc, outerDeco, innerDeco, this.dom, this);\n      }\n      if (chromeKludge && !this.trackWrites) { forceSelUpdate = true; }\n    }\n    // Work around for an issue where an update arriving right between\n    // a DOM selection change and the \"selectionchange\" event for it\n    // can cause a spurious DOM selection update, disrupting mouse\n    // drag selection.\n    if (forceSelUpdate ||\n        !(this.mouseDown && this.domObserver.currentSelection.eq(this.root.getSelection()) && anchorInRightPlace(this))) {\n      selectionToDOM(this, forceSelUpdate);\n    } else {\n      syncNodeSelection(this, state.selection);\n      this.domObserver.setCurSelection();\n    }\n    this.domObserver.start();\n  }\n\n  this.updatePluginViews(prev);\n\n  if (scroll == \"reset\") {\n    this.dom.scrollTop = 0;\n  } else if (scroll == \"to selection\") {\n    var startDOM = this.root.getSelection().focusNode;\n    if (this.someProp(\"handleScrollToSelection\", function (f) { return f(this$1); }))\n      ; // Handled\n    else if (state.selection instanceof NodeSelection)\n      { scrollRectIntoView(this, this.docView.domAfterPos(state.selection.from).getBoundingClientRect(), startDOM); }\n    else\n      { scrollRectIntoView(this, this.coordsAtPos(state.selection.head, 1), startDOM); }\n  } else if (oldScrollPos) {\n    resetScrollPos(oldScrollPos);\n  }\n};\n\nEditorView.prototype.destroyPluginViews = function destroyPluginViews () {\n  var view;\n  while (view = this.pluginViews.pop()) { if (view.destroy) { view.destroy(); } }\n};\n\nEditorView.prototype.updatePluginViews = function updatePluginViews (prevState) {\n  if (!prevState || prevState.plugins != this.state.plugins) {\n    this.destroyPluginViews();\n    for (var i = 0; i < this.state.plugins.length; i++) {\n      var plugin = this.state.plugins[i];\n      if (plugin.spec.view) { this.pluginViews.push(plugin.spec.view(this)); }\n    }\n  } else {\n    for (var i$1 = 0; i$1 < this.pluginViews.length; i$1++) {\n      var pluginView = this.pluginViews[i$1];\n      if (pluginView.update) { pluginView.update(this, prevState); }\n    }\n  }\n};\n\n// :: (string, ?(prop: *)  *)  *\n// Goes over the values of a prop, first those provided directly,\n// then those from plugins (in order), and calls `f` every time a\n// non-undefined value is found. When `f` returns a truthy value,\n// that is immediately returned. When `f` isn't provided, it is\n// treated as the identity function (the prop value is returned\n// directly).\nEditorView.prototype.someProp = function someProp (propName, f) {\n  var prop = this._props && this._props[propName], value;\n  if (prop != null && (value = f ? f(prop) : prop)) { return value }\n  var plugins = this.state.plugins;\n  if (plugins) { for (var i = 0; i < plugins.length; i++) {\n    var prop$1 = plugins[i].props[propName];\n    if (prop$1 != null && (value = f ? f(prop$1) : prop$1)) { return value }\n  } }\n};\n\n// :: ()  bool\n// Query whether the view has focus.\nEditorView.prototype.hasFocus = function hasFocus () {\n  return this.root.activeElement == this.dom\n};\n\n// :: ()\n// Focus the editor.\nEditorView.prototype.focus = function focus () {\n  this.domObserver.stop();\n  if (this.editable) { focusPreventScroll(this.dom); }\n  selectionToDOM(this);\n  this.domObserver.start();\n};\n\n// :: union<dom.Document, dom.DocumentFragment>\n// Get the document root in which the editor exists. This will\n// usually be the top-level `document`, but might be a [shadow\n// DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM)\n// root if the editor is inside one.\nprototypeAccessors$2.root.get = function () {\n  var cached = this._root;\n  if (cached == null) { for (var search = this.dom.parentNode; search; search = search.parentNode) {\n    if (search.nodeType == 9 || (search.nodeType == 11 && search.host)) {\n      if (!search.getSelection) { Object.getPrototypeOf(search).getSelection = function () { return document.getSelection(); }; }\n      return this._root = search\n    }\n  } }\n  return cached || document\n};\n\n// :: ({left: number, top: number})  ?{pos: number, inside: number}\n// Given a pair of viewport coordinates, return the document\n// position that corresponds to them. May return null if the given\n// coordinates aren't inside of the editor. When an object is\n// returned, its `pos` property is the position nearest to the\n// coordinates, and its `inside` property holds the position of the\n// inner node that the position falls inside of, or -1 if it is at\n// the top level, not in any node.\nEditorView.prototype.posAtCoords = function posAtCoords$1 (coords) {\n  return posAtCoords(this, coords)\n};\n\n// :: (number, number)  {left: number, right: number, top: number, bottom: number}\n// Returns the viewport rectangle at a given document position.\n// `left` and `right` will be the same number, as this returns a\n// flat cursor-ish rectangle. If the position is between two things\n// that aren't directly adjacent, `side` determines which element is\n// used. When < 0, the element before the position is used,\n// otherwise the element after.\nEditorView.prototype.coordsAtPos = function coordsAtPos$1 (pos, side) {\n    if ( side === void 0 ) side = 1;\n\n  return coordsAtPos(this, pos, side)\n};\n\n// :: (number, number)  {node: dom.Node, offset: number}\n// Find the DOM position that corresponds to the given document\n// position. When `side` is negative, find the position as close as\n// possible to the content before the position. When positive,\n// prefer positions close to the content after the position. When\n// zero, prefer as shallow a position as possible.\n//\n// Note that you should **not** mutate the editor's internal DOM,\n// only inspect it (and even that is usually not necessary).\nEditorView.prototype.domAtPos = function domAtPos (pos, side) {\n    if ( side === void 0 ) side = 0;\n\n  return this.docView.domFromPos(pos, side)\n};\n\n// :: (number)  ?dom.Node\n// Find the DOM node that represents the document node after the\n// given position. May return `null` when the position doesn't point\n// in front of a node or if the node is inside an opaque node view.\n//\n// This is intended to be able to call things like\n// `getBoundingClientRect` on that DOM node. Do **not** mutate the\n// editor DOM directly, or add styling this way, since that will be\n// immediately overriden by the editor as it redraws the node.\nEditorView.prototype.nodeDOM = function nodeDOM (pos) {\n  var desc = this.docView.descAt(pos);\n  return desc ? desc.nodeDOM : null\n};\n\n// :: (dom.Node, number, ?number)  number\n// Find the document position that corresponds to a given DOM\n// position. (Whenever possible, it is preferable to inspect the\n// document structure directly, rather than poking around in the\n// DOM, but sometimesfor example when interpreting an event\n// targetyou don't have a choice.)\n//\n// The `bias` parameter can be used to influence which side of a DOM\n// node to use when the position is inside a leaf node.\nEditorView.prototype.posAtDOM = function posAtDOM (node, offset, bias) {\n    if ( bias === void 0 ) bias = -1;\n\n  var pos = this.docView.posFromDOM(node, offset, bias);\n  if (pos == null) { throw new RangeError(\"DOM position not inside the editor\") }\n  return pos\n};\n\n// :: (union<\"up\", \"down\", \"left\", \"right\", \"forward\", \"backward\">, ?EditorState)  bool\n// Find out whether the selection is at the end of a textblock when\n// moving in a given direction. When, for example, given `\"left\"`,\n// it will return true if moving left from the current cursor\n// position would leave that position's parent textblock. Will apply\n// to the view's current state by default, but it is possible to\n// pass a different state.\nEditorView.prototype.endOfTextblock = function endOfTextblock$1 (dir, state) {\n  return endOfTextblock(this, state || this.state, dir)\n};\n\n// :: ()\n// Removes the editor from the DOM and destroys all [node\n// views](#view.NodeView).\nEditorView.prototype.destroy = function destroy () {\n  if (!this.docView) { return }\n  destroyInput(this);\n  this.destroyPluginViews();\n  if (this.mounted) {\n    this.docView.update(this.state.doc, [], viewDecorations(this), this);\n    this.dom.textContent = \"\";\n  } else if (this.dom.parentNode) {\n    this.dom.parentNode.removeChild(this.dom);\n  }\n  this.docView.destroy();\n  this.docView = null;\n};\n\n// Used for testing.\nEditorView.prototype.dispatchEvent = function dispatchEvent$1 (event) {\n  return dispatchEvent(this, event)\n};\n\n// :: (Transaction)\n// Dispatch a transaction. Will call\n// [`dispatchTransaction`](#view.DirectEditorProps.dispatchTransaction)\n// when given, and otherwise defaults to applying the transaction to\n// the current state and calling\n// [`updateState`](#view.EditorView.updateState) with the result.\n// This method is bound to the view instance, so that it can be\n// easily passed around.\nEditorView.prototype.dispatch = function dispatch (tr) {\n  var dispatchTransaction = this._props.dispatchTransaction;\n  if (dispatchTransaction) { dispatchTransaction.call(this, tr); }\n  else { this.updateState(this.state.apply(tr)); }\n};\n\nObject.defineProperties( EditorView.prototype, prototypeAccessors$2 );\n\nfunction computeDocDeco(view) {\n  var attrs = Object.create(null);\n  attrs.class = \"ProseMirror\";\n  attrs.contenteditable = String(view.editable);\n\n  view.someProp(\"attributes\", function (value) {\n    if (typeof value == \"function\") { value = value(view.state); }\n    if (value) { for (var attr in value) {\n      if (attr == \"class\")\n        { attrs.class += \" \" + value[attr]; }\n      else if (!attrs[attr] && attr != \"contenteditable\" && attr != \"nodeName\")\n        { attrs[attr] = String(value[attr]); }\n    } }\n  });\n\n  return [Decoration.node(0, view.state.doc.content.size, attrs)]\n}\n\nfunction updateCursorWrapper(view) {\n  if (view.markCursor) {\n    var dom = document.createElement(\"img\");\n    dom.setAttribute(\"mark-placeholder\", \"true\");\n    view.cursorWrapper = {dom: dom, deco: Decoration.widget(view.state.selection.head, dom, {raw: true, marks: view.markCursor})};\n  } else {\n    view.cursorWrapper = null;\n  }\n}\n\nfunction getEditable(view) {\n  return !view.someProp(\"editable\", function (value) { return value(view.state) === false; })\n}\n\nfunction selectionContextChanged(sel1, sel2) {\n  var depth = Math.min(sel1.$anchor.sharedDepth(sel1.head), sel2.$anchor.sharedDepth(sel2.head));\n  return sel1.$anchor.start(depth) != sel2.$anchor.start(depth)\n}\n\nfunction buildNodeViews(view) {\n  var result = {};\n  view.someProp(\"nodeViews\", function (obj) {\n    for (var prop in obj) { if (!Object.prototype.hasOwnProperty.call(result, prop))\n      { result[prop] = obj[prop]; } }\n  });\n  return result\n}\n\nfunction changedNodeViews(a, b) {\n  var nA = 0, nB = 0;\n  for (var prop in a) {\n    if (a[prop] != b[prop]) { return true }\n    nA++;\n  }\n  for (var _ in b) { nB++; }\n  return nA != nB\n}\n\n// EditorProps:: interface\n//\n// Props are configuration values that can be passed to an editor view\n// or included in a plugin. This interface lists the supported props.\n//\n// The various event-handling functions may all return `true` to\n// indicate that they handled the given event. The view will then take\n// care to call `preventDefault` on the event, except with\n// `handleDOMEvents`, where the handler itself is responsible for that.\n//\n// How a prop is resolved depends on the prop. Handler functions are\n// called one at a time, starting with the base props and then\n// searching through the plugins (in order of appearance) until one of\n// them returns true. For some props, the first plugin that yields a\n// value gets precedence.\n//\n//   handleDOMEvents:: ?Object<(view: EditorView, event: dom.Event)  bool>\n//   Can be an object mapping DOM event type names to functions that\n//   handle them. Such functions will be called before any handling\n//   ProseMirror does of events fired on the editable DOM element.\n//   Contrary to the other event handling props, when returning true\n//   from such a function, you are responsible for calling\n//   `preventDefault` yourself (or not, if you want to allow the\n//   default behavior).\n//\n//   handleKeyDown:: ?(view: EditorView, event: dom.KeyboardEvent)  bool\n//   Called when the editor receives a `keydown` event.\n//\n//   handleKeyPress:: ?(view: EditorView, event: dom.KeyboardEvent)  bool\n//   Handler for `keypress` events.\n//\n//   handleTextInput:: ?(view: EditorView, from: number, to: number, text: string)  bool\n//   Whenever the user directly input text, this handler is called\n//   before the input is applied. If it returns `true`, the default\n//   behavior of actually inserting the text is suppressed.\n//\n//   handleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool)  bool\n//   Called for each node around a click, from the inside out. The\n//   `direct` flag will be true for the inner node.\n//\n//   handleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent)  bool\n//   Called when the editor is clicked, after `handleClickOn` handlers\n//   have been called.\n//\n//   handleDoubleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool)  bool\n//   Called for each node around a double click.\n//\n//   handleDoubleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent)  bool\n//   Called when the editor is double-clicked, after `handleDoubleClickOn`.\n//\n//   handleTripleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool)  bool\n//   Called for each node around a triple click.\n//\n//   handleTripleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent)  bool\n//   Called when the editor is triple-clicked, after `handleTripleClickOn`.\n//\n//   handlePaste:: ?(view: EditorView, event: dom.ClipboardEvent, slice: Slice)  bool\n//   Can be used to override the behavior of pasting. `slice` is the\n//   pasted content parsed by the editor, but you can directly access\n//   the event to get at the raw content.\n//\n//   handleDrop:: ?(view: EditorView, event: dom.Event, slice: Slice, moved: bool)  bool\n//   Called when something is dropped on the editor. `moved` will be\n//   true if this drop moves from the current selection (which should\n//   thus be deleted).\n//\n//   handleScrollToSelection:: ?(view: EditorView)  bool\n//   Called when the view, after updating its state, tries to scroll\n//   the selection into view. A handler function may return false to\n//   indicate that it did not handle the scrolling and further\n//   handlers or the default behavior should be tried.\n//\n//   createSelectionBetween:: ?(view: EditorView, anchor: ResolvedPos, head: ResolvedPos)  ?Selection\n//   Can be used to override the way a selection is created when\n//   reading a DOM selection between the given anchor and head.\n//\n//   domParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading editor changes\n//   from the DOM. Defaults to calling\n//   [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) on the\n//   editor's schema.\n//\n//   transformPastedHTML:: ?(html: string)  string\n//   Can be used to transform pasted HTML text, _before_ it is parsed,\n//   for example to clean it up.\n//\n//   clipboardParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading content from\n//   the clipboard. When not given, the value of the\n//   [`domParser`](#view.EditorProps.domParser) prop is used.\n//\n//   transformPastedText:: ?(text: string, plain: bool)  string\n//   Transform pasted plain text. The `plain` flag will be true when\n//   the text is pasted as plain text.\n//\n//   clipboardTextParser:: ?(text: string, $context: ResolvedPos, plain: bool)  Slice\n//   A function to parse text from the clipboard into a document\n//   slice. Called after\n//   [`transformPastedText`](#view.EditorProps.transformPastedText).\n//   The default behavior is to split the text into lines, wrap them\n//   in `<p>` tags, and call\n//   [`clipboardParser`](#view.EditorProps.clipboardParser) on it.\n//   The `plain` flag will be true when the text is pasted as plain text.\n//\n//   transformPasted:: ?(Slice)  Slice\n//   Can be used to transform pasted content before it is applied to\n//   the document.\n//\n//   nodeViews:: ?Object<(node: Node, view: EditorView, getPos: ()  number, decorations: [Decoration])  NodeView>\n//   Allows you to pass custom rendering and behavior logic for nodes\n//   and marks. Should map node and mark names to constructor\n//   functions that produce a [`NodeView`](#view.NodeView) object\n//   implementing the node's display behavior. For nodes, the third\n//   argument `getPos` is a function that can be called to get the\n//   node's current position, which can be useful when creating\n//   transactions to update it. For marks, the third argument is a\n//   boolean that indicates whether the mark's content is inline.\n//\n//   `decorations` is an array of node or inline decorations that are\n//   active around the node. They are automatically drawn in the\n//   normal way, and you will usually just want to ignore this, but\n//   they can also be used as a way to provide context information to\n//   the node view without adding it to the document itself.\n//\n//   clipboardSerializer:: ?DOMSerializer\n//   The DOM serializer to use when putting content onto the\n//   clipboard. If not given, the result of\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)\n//   will be used.\n//\n//   clipboardTextSerializer:: ?(Slice)  string\n//   A function that will be called to get the text for the current\n//   selection when copying text to the clipboard. By default, the\n//   editor will use [`textBetween`](#model.Node.textBetween) on the\n//   selected range.\n//\n//   decorations:: ?(state: EditorState)  ?DecorationSet\n//   A set of [document decorations](#view.Decoration) to show in the\n//   view.\n//\n//   editable:: ?(state: EditorState)  bool\n//   When this returns false, the content of the view is not directly\n//   editable.\n//\n//   attributes:: ?union<Object<string>, (EditorState)  ?Object<string>>\n//   Control the DOM attributes of the editable element. May be either\n//   an object or a function going from an editor state to an object.\n//   By default, the element will get a class `\"ProseMirror\"`, and\n//   will have its `contentEditable` attribute determined by the\n//   [`editable` prop](#view.EditorProps.editable). Additional classes\n//   provided here will be added to the class. For other attributes,\n//   the value provided first (as in\n//   [`someProp`](#view.EditorView.someProp)) will be used.\n//\n//   scrollThreshold:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the distance (in pixels) between the cursor and the\n//   end of the visible viewport at which point, when scrolling the\n//   cursor into view, scrolling takes place. Defaults to 0.\n//\n//   scrollMargin:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the extra space (in pixels) that is left above or\n//   below the cursor when it is scrolled into view. Defaults to 5.\n\n// DirectEditorProps:: interface extends EditorProps\n//\n// The props object given directly to the editor view supports two\n// fields that can't be used in plugins:\n//\n//   state:: EditorState\n//   The current state of the editor.\n//\n//   dispatchTransaction:: ?(tr: Transaction)\n//   The callback over which to send transactions (state updates)\n//   produced by the view. If you specify this, you probably want to\n//   make sure this ends up calling the view's\n//   [`updateState`](#view.EditorView.updateState) method with a new\n//   state that has the transaction\n//   [applied](#state.EditorState.apply). The callback will be bound to have\n//   the view instance as its `this` binding.\n\nexport { Decoration, DecorationSet, EditorView, endComposition as __endComposition, parseFromClipboard as __parseFromClipboard, serializeForClipboard as __serializeForClipboard };\n//# sourceMappingURL=index.es.js.map\n","import { keydownHandler } from 'prosemirror-keymap';\nimport { NodeSelection, Selection, Plugin, TextSelection } from 'prosemirror-state';\nimport { DecorationSet, Decoration } from 'prosemirror-view';\nimport { Slice } from 'prosemirror-model';\n\n// ::- Gap cursor selections are represented using this class. Its\n// `$anchor` and `$head` properties both point at the cursor position.\nvar GapCursor = /*@__PURE__*/(function (Selection) {\n  function GapCursor($pos) {\n    Selection.call(this, $pos, $pos);\n  }\n\n  if ( Selection ) GapCursor.__proto__ = Selection;\n  GapCursor.prototype = Object.create( Selection && Selection.prototype );\n  GapCursor.prototype.constructor = GapCursor;\n\n  GapCursor.prototype.map = function map (doc, mapping) {\n    var $pos = doc.resolve(mapping.map(this.head));\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  };\n\n  GapCursor.prototype.content = function content () { return Slice.empty };\n\n  GapCursor.prototype.eq = function eq (other) {\n    return other instanceof GapCursor && other.head == this.head\n  };\n\n  GapCursor.prototype.toJSON = function toJSON () {\n    return {type: \"gapcursor\", pos: this.head}\n  };\n\n  GapCursor.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.pos != \"number\") { throw new RangeError(\"Invalid input for GapCursor.fromJSON\") }\n    return new GapCursor(doc.resolve(json.pos))\n  };\n\n  GapCursor.prototype.getBookmark = function getBookmark () { return new GapBookmark(this.anchor) };\n\n  GapCursor.valid = function valid ($pos) {\n    var parent = $pos.parent;\n    if (parent.isTextblock || !closedBefore($pos) || !closedAfter($pos)) { return false }\n    var override = parent.type.spec.allowGapCursor;\n    if (override != null) { return override }\n    var deflt = parent.contentMatchAt($pos.index()).defaultType;\n    return deflt && deflt.isTextblock\n  };\n\n  GapCursor.findFrom = function findFrom ($pos, dir, mustMove) {\n    search: for (;;) {\n      if (!mustMove && GapCursor.valid($pos)) { return $pos }\n      var pos = $pos.pos, next = null;\n      // Scan up from this position\n      for (var d = $pos.depth;; d--) {\n        var parent = $pos.node(d);\n        if (dir > 0 ? $pos.indexAfter(d) < parent.childCount : $pos.index(d) > 0) {\n          next = parent.child(dir > 0 ? $pos.indexAfter(d) : $pos.index(d) - 1);\n          break\n        } else if (d == 0) {\n          return null\n        }\n        pos += dir;\n        var $cur = $pos.doc.resolve(pos);\n        if (GapCursor.valid($cur)) { return $cur }\n      }\n\n      // And then down into the next node\n      for (;;) {\n        var inside = dir > 0 ? next.firstChild : next.lastChild;\n        if (!inside) {\n          if (next.isAtom && !next.isText && !NodeSelection.isSelectable(next)) {\n            $pos = $pos.doc.resolve(pos + next.nodeSize * dir);\n            mustMove = false;\n            continue search\n          }\n          break\n        }\n        next = inside;\n        pos += dir;\n        var $cur$1 = $pos.doc.resolve(pos);\n        if (GapCursor.valid($cur$1)) { return $cur$1 }\n      }\n\n      return null\n    }\n  };\n\n  return GapCursor;\n}(Selection));\n\nGapCursor.prototype.visible = false;\n\nSelection.jsonID(\"gapcursor\", GapCursor);\n\nvar GapBookmark = function GapBookmark(pos) {\n  this.pos = pos;\n};\nGapBookmark.prototype.map = function map (mapping) {\n  return new GapBookmark(mapping.map(this.pos))\n};\nGapBookmark.prototype.resolve = function resolve (doc) {\n  var $pos = doc.resolve(this.pos);\n  return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n};\n\nfunction closedBefore($pos) {\n  for (var d = $pos.depth; d >= 0; d--) {\n    var index = $pos.index(d);\n    // At the start of this parent, look at next one\n    if (index == 0) { continue }\n    // See if the node before (or its first ancestor) is closed\n    for (var before = $pos.node(d).child(index - 1);; before = before.lastChild) {\n      if ((before.childCount == 0 && !before.inlineContent) || before.isAtom || before.type.spec.isolating) { return true }\n      if (before.inlineContent) { return false }\n    }\n  }\n  // Hit start of document\n  return true\n}\n\nfunction closedAfter($pos) {\n  for (var d = $pos.depth; d >= 0; d--) {\n    var index = $pos.indexAfter(d), parent = $pos.node(d);\n    if (index == parent.childCount) { continue }\n    for (var after = parent.child(index);; after = after.firstChild) {\n      if ((after.childCount == 0 && !after.inlineContent) || after.isAtom || after.type.spec.isolating) { return true }\n      if (after.inlineContent) { return false }\n    }\n  }\n  return true\n}\n\n// :: ()  Plugin\n// Create a gap cursor plugin. When enabled, this will capture clicks\n// near and arrow-key-motion past places that don't have a normally\n// selectable position nearby, and create a gap cursor selection for\n// them. The cursor is drawn as an element with class\n// `ProseMirror-gapcursor`. You can either include\n// `style/gapcursor.css` from the package's directory or add your own\n// styles to make it visible.\nvar gapCursor = function() {\n  return new Plugin({\n    props: {\n      decorations: drawGapCursor,\n\n      createSelectionBetween: function createSelectionBetween(_view, $anchor, $head) {\n        if ($anchor.pos == $head.pos && GapCursor.valid($head)) { return new GapCursor($head) }\n      },\n\n      handleClick: handleClick,\n      handleKeyDown: handleKeyDown\n    }\n  })\n};\n\nvar handleKeyDown = keydownHandler({\n  \"ArrowLeft\": arrow(\"horiz\", -1),\n  \"ArrowRight\": arrow(\"horiz\", 1),\n  \"ArrowUp\": arrow(\"vert\", -1),\n  \"ArrowDown\": arrow(\"vert\", 1)\n});\n\nfunction arrow(axis, dir) {\n  var dirStr = axis == \"vert\" ? (dir > 0 ? \"down\" : \"up\") : (dir > 0 ? \"right\" : \"left\");\n  return function(state, dispatch, view) {\n    var sel = state.selection;\n    var $start = dir > 0 ? sel.$to : sel.$from, mustMove = sel.empty;\n    if (sel instanceof TextSelection) {\n      if (!view.endOfTextblock(dirStr) || $start.depth == 0) { return false }\n      mustMove = false;\n      $start = state.doc.resolve(dir > 0 ? $start.after() : $start.before());\n    }\n    var $found = GapCursor.findFrom($start, dir, mustMove);\n    if (!$found) { return false }\n    if (dispatch) { dispatch(state.tr.setSelection(new GapCursor($found))); }\n    return true\n  }\n}\n\nfunction handleClick(view, pos, event) {\n  if (!view.editable) { return false }\n  var $pos = view.state.doc.resolve(pos);\n  if (!GapCursor.valid($pos)) { return false }\n  var ref = view.posAtCoords({left: event.clientX, top: event.clientY});\n  var inside = ref.inside;\n  if (inside > -1 && NodeSelection.isSelectable(view.state.doc.nodeAt(inside))) { return false }\n  view.dispatch(view.state.tr.setSelection(new GapCursor($pos)));\n  return true\n}\n\nfunction drawGapCursor(state) {\n  if (!(state.selection instanceof GapCursor)) { return null }\n  var node = document.createElement(\"div\");\n  node.className = \"ProseMirror-gapcursor\";\n  return DecorationSet.create(state.doc, [Decoration.widget(state.selection.head, node, {key: \"gapcursor\"})])\n}\n\nexport { GapCursor, gapCursor };\n//# sourceMappingURL=index.es.js.map\n","import { keymap } from 'prosemirror-keymap';\nimport { undo, redo, history } from 'prosemirror-history';\nimport { toggleMark, wrapIn, chainCommands, exitCode, setBlockType, joinUp, joinDown, lift, selectParentNode, baseKeymap } from 'prosemirror-commands';\nimport { NodeSelection, Plugin } from 'prosemirror-state';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\nimport { icons, MenuItem, wrapItem, blockTypeItem, Dropdown, DropdownSubmenu, joinUpItem, liftItem, selectParentNodeItem, undoItem, redoItem, menuBar } from 'prosemirror-menu';\nimport { wrapInList, splitListItem, liftListItem, sinkListItem } from 'prosemirror-schema-list';\nimport { undoInputRule, smartQuotes, ellipsis, emDash, wrappingInputRule, textblockTypeInputRule, inputRules } from 'prosemirror-inputrules';\n\nvar prefix = \"ProseMirror-prompt\";\n\nfunction openPrompt(options) {\n  var wrapper = document.body.appendChild(document.createElement(\"div\"));\n  wrapper.className = prefix;\n\n  var mouseOutside = function (e) { if (!wrapper.contains(e.target)) { close(); } };\n  setTimeout(function () { return window.addEventListener(\"mousedown\", mouseOutside); }, 50);\n  var close = function () {\n    window.removeEventListener(\"mousedown\", mouseOutside);\n    if (wrapper.parentNode) { wrapper.parentNode.removeChild(wrapper); }\n  };\n\n  var domFields = [];\n  for (var name in options.fields) { domFields.push(options.fields[name].render()); }\n\n  var submitButton = document.createElement(\"button\");\n  submitButton.type = \"submit\";\n  submitButton.className = prefix + \"-submit\";\n  submitButton.textContent = \"OK\";\n  var cancelButton = document.createElement(\"button\");\n  cancelButton.type = \"button\";\n  cancelButton.className = prefix + \"-cancel\";\n  cancelButton.textContent = \"Cancel\";\n  cancelButton.addEventListener(\"click\", close);\n\n  var form = wrapper.appendChild(document.createElement(\"form\"));\n  if (options.title) { form.appendChild(document.createElement(\"h5\")).textContent = options.title; }\n  domFields.forEach(function (field) {\n    form.appendChild(document.createElement(\"div\")).appendChild(field);\n  });\n  var buttons = form.appendChild(document.createElement(\"div\"));\n  buttons.className = prefix + \"-buttons\";\n  buttons.appendChild(submitButton);\n  buttons.appendChild(document.createTextNode(\" \"));\n  buttons.appendChild(cancelButton);\n\n  var box = wrapper.getBoundingClientRect();\n  wrapper.style.top = ((window.innerHeight - box.height) / 2) + \"px\";\n  wrapper.style.left = ((window.innerWidth - box.width) / 2) + \"px\";\n\n  var submit = function () {\n    var params = getValues(options.fields, domFields);\n    if (params) {\n      close();\n      options.callback(params);\n    }\n  };\n\n  form.addEventListener(\"submit\", function (e) {\n    e.preventDefault();\n    submit();\n  });\n\n  form.addEventListener(\"keydown\", function (e) {\n    if (e.keyCode == 27) {\n      e.preventDefault();\n      close();\n    } else if (e.keyCode == 13 && !(e.ctrlKey || e.metaKey || e.shiftKey)) {\n      e.preventDefault();\n      submit();\n    } else if (e.keyCode == 9) {\n      window.setTimeout(function () {\n        if (!wrapper.contains(document.activeElement)) { close(); }\n      }, 500);\n    }\n  });\n\n  var input = form.elements[0];\n  if (input) { input.focus(); }\n}\n\nfunction getValues(fields, domFields) {\n  var result = Object.create(null), i = 0;\n  for (var name in fields) {\n    var field = fields[name], dom = domFields[i++];\n    var value = field.read(dom), bad = field.validate(value);\n    if (bad) {\n      reportInvalid(dom, bad);\n      return null\n    }\n    result[name] = field.clean(value);\n  }\n  return result\n}\n\nfunction reportInvalid(dom, message) {\n  // FIXME this is awful and needs a lot more work\n  var parent = dom.parentNode;\n  var msg = parent.appendChild(document.createElement(\"div\"));\n  msg.style.left = (dom.offsetLeft + dom.offsetWidth + 2) + \"px\";\n  msg.style.top = (dom.offsetTop - 5) + \"px\";\n  msg.className = \"ProseMirror-invalid\";\n  msg.textContent = message;\n  setTimeout(function () { return parent.removeChild(msg); }, 1500);\n}\n\n// ::- The type of field that `FieldPrompt` expects to be passed to it.\nvar Field = function Field(options) { this.options = options; };\n\n// render:: (state: EditorState, props: Object)  dom.Node\n// Render the field to the DOM. Should be implemented by all subclasses.\n\n// :: (dom.Node)  any\n// Read the field's value from its DOM node.\nField.prototype.read = function read (dom) { return dom.value };\n\n// :: (any)  ?string\n// A field-type-specific validation function.\nField.prototype.validateType = function validateType (_value) {};\n\nField.prototype.validate = function validate (value) {\n  if (!value && this.options.required)\n    { return \"Required field\" }\n  return this.validateType(value) || (this.options.validate && this.options.validate(value))\n};\n\nField.prototype.clean = function clean (value) {\n  return this.options.clean ? this.options.clean(value) : value\n};\n\n// ::- A field class for single-line text fields.\nvar TextField = /*@__PURE__*/(function (Field) {\n  function TextField () {\n    Field.apply(this, arguments);\n  }\n\n  if ( Field ) TextField.__proto__ = Field;\n  TextField.prototype = Object.create( Field && Field.prototype );\n  TextField.prototype.constructor = TextField;\n\n  TextField.prototype.render = function render () {\n    var input = document.createElement(\"input\");\n    input.type = \"text\";\n    input.placeholder = this.options.label;\n    input.value = this.options.value || \"\";\n    input.autocomplete = \"off\";\n    return input\n  };\n\n  return TextField;\n}(Field));\n\n// Helpers to create specific types of items\n\nfunction canInsert(state, nodeType) {\n  var $from = state.selection.$from;\n  for (var d = $from.depth; d >= 0; d--) {\n    var index = $from.index(d);\n    if ($from.node(d).canReplaceWith(index, index, nodeType)) { return true }\n  }\n  return false\n}\n\nfunction insertImageItem(nodeType) {\n  return new MenuItem({\n    title: \"Insert image\",\n    label: \"Image\",\n    enable: function enable(state) { return canInsert(state, nodeType) },\n    run: function run(state, _, view) {\n      var ref = state.selection;\n      var from = ref.from;\n      var to = ref.to;\n      var attrs = null;\n      if (state.selection instanceof NodeSelection && state.selection.node.type == nodeType)\n        { attrs = state.selection.node.attrs; }\n      openPrompt({\n        title: \"Insert image\",\n        fields: {\n          src: new TextField({label: \"Location\", required: true, value: attrs && attrs.src}),\n          title: new TextField({label: \"Title\", value: attrs && attrs.title}),\n          alt: new TextField({label: \"Description\",\n                              value: attrs ? attrs.alt : state.doc.textBetween(from, to, \" \")})\n        },\n        callback: function callback(attrs) {\n          view.dispatch(view.state.tr.replaceSelectionWith(nodeType.createAndFill(attrs)));\n          view.focus();\n        }\n      });\n    }\n  })\n}\n\nfunction cmdItem(cmd, options) {\n  var passedOptions = {\n    label: options.title,\n    run: cmd\n  };\n  for (var prop in options) { passedOptions[prop] = options[prop]; }\n  if ((!options.enable || options.enable === true) && !options.select)\n    { passedOptions[options.enable ? \"enable\" : \"select\"] = function (state) { return cmd(state); }; }\n\n  return new MenuItem(passedOptions)\n}\n\nfunction markActive(state, type) {\n  var ref = state.selection;\n  var from = ref.from;\n  var $from = ref.$from;\n  var to = ref.to;\n  var empty = ref.empty;\n  if (empty) { return type.isInSet(state.storedMarks || $from.marks()) }\n  else { return state.doc.rangeHasMark(from, to, type) }\n}\n\nfunction markItem(markType, options) {\n  var passedOptions = {\n    active: function active(state) { return markActive(state, markType) },\n    enable: true\n  };\n  for (var prop in options) { passedOptions[prop] = options[prop]; }\n  return cmdItem(toggleMark(markType), passedOptions)\n}\n\nfunction linkItem(markType) {\n  return new MenuItem({\n    title: \"Add or remove link\",\n    icon: icons.link,\n    active: function active(state) { return markActive(state, markType) },\n    enable: function enable(state) { return !state.selection.empty },\n    run: function run(state, dispatch, view) {\n      if (markActive(state, markType)) {\n        toggleMark(markType)(state, dispatch);\n        return true\n      }\n      openPrompt({\n        title: \"Create a link\",\n        fields: {\n          href: new TextField({\n            label: \"Link target\",\n            required: true\n          }),\n          title: new TextField({label: \"Title\"})\n        },\n        callback: function callback(attrs) {\n          toggleMark(markType, attrs)(view.state, view.dispatch);\n          view.focus();\n        }\n      });\n    }\n  })\n}\n\nfunction wrapListItem(nodeType, options) {\n  return cmdItem(wrapInList(nodeType, options.attrs), options)\n}\n\n// :: (Schema)  Object\n// Given a schema, look for default mark and node types in it and\n// return an object with relevant menu items relating to those marks:\n//\n// **`toggleStrong`**`: MenuItem`\n//   : A menu item to toggle the [strong mark](#schema-basic.StrongMark).\n//\n// **`toggleEm`**`: MenuItem`\n//   : A menu item to toggle the [emphasis mark](#schema-basic.EmMark).\n//\n// **`toggleCode`**`: MenuItem`\n//   : A menu item to toggle the [code font mark](#schema-basic.CodeMark).\n//\n// **`toggleLink`**`: MenuItem`\n//   : A menu item to toggle the [link mark](#schema-basic.LinkMark).\n//\n// **`insertImage`**`: MenuItem`\n//   : A menu item to insert an [image](#schema-basic.Image).\n//\n// **`wrapBulletList`**`: MenuItem`\n//   : A menu item to wrap the selection in a [bullet list](#schema-list.BulletList).\n//\n// **`wrapOrderedList`**`: MenuItem`\n//   : A menu item to wrap the selection in an [ordered list](#schema-list.OrderedList).\n//\n// **`wrapBlockQuote`**`: MenuItem`\n//   : A menu item to wrap the selection in a [block quote](#schema-basic.BlockQuote).\n//\n// **`makeParagraph`**`: MenuItem`\n//   : A menu item to set the current textblock to be a normal\n//     [paragraph](#schema-basic.Paragraph).\n//\n// **`makeCodeBlock`**`: MenuItem`\n//   : A menu item to set the current textblock to be a\n//     [code block](#schema-basic.CodeBlock).\n//\n// **`makeHead[N]`**`: MenuItem`\n//   : Where _N_ is 1 to 6. Menu items to set the current textblock to\n//     be a [heading](#schema-basic.Heading) of level _N_.\n//\n// **`insertHorizontalRule`**`: MenuItem`\n//   : A menu item to insert a horizontal rule.\n//\n// The return value also contains some prefabricated menu elements and\n// menus, that you can use instead of composing your own menu from\n// scratch:\n//\n// **`insertMenu`**`: Dropdown`\n//   : A dropdown containing the `insertImage` and\n//     `insertHorizontalRule` items.\n//\n// **`typeMenu`**`: Dropdown`\n//   : A dropdown containing the items for making the current\n//     textblock a paragraph, code block, or heading.\n//\n// **`fullMenu`**`: [[MenuElement]]`\n//   : An array of arrays of menu elements for use as the full menu\n//     for, for example the [menu bar](https://github.com/prosemirror/prosemirror-menu#user-content-menubar).\nfunction buildMenuItems(schema) {\n  var r = {}, type;\n  if (type = schema.marks.strong)\n    { r.toggleStrong = markItem(type, {title: \"Toggle strong style\", icon: icons.strong}); }\n  if (type = schema.marks.em)\n    { r.toggleEm = markItem(type, {title: \"Toggle emphasis\", icon: icons.em}); }\n  if (type = schema.marks.code)\n    { r.toggleCode = markItem(type, {title: \"Toggle code font\", icon: icons.code}); }\n  if (type = schema.marks.link)\n    { r.toggleLink = linkItem(type); }\n\n  if (type = schema.nodes.image)\n    { r.insertImage = insertImageItem(type); }\n  if (type = schema.nodes.bullet_list)\n    { r.wrapBulletList = wrapListItem(type, {\n      title: \"Wrap in bullet list\",\n      icon: icons.bulletList\n    }); }\n  if (type = schema.nodes.ordered_list)\n    { r.wrapOrderedList = wrapListItem(type, {\n      title: \"Wrap in ordered list\",\n      icon: icons.orderedList\n    }); }\n  if (type = schema.nodes.blockquote)\n    { r.wrapBlockQuote = wrapItem(type, {\n      title: \"Wrap in block quote\",\n      icon: icons.blockquote\n    }); }\n  if (type = schema.nodes.paragraph)\n    { r.makeParagraph = blockTypeItem(type, {\n      title: \"Change to paragraph\",\n      label: \"Plain\"\n    }); }\n  if (type = schema.nodes.code_block)\n    { r.makeCodeBlock = blockTypeItem(type, {\n      title: \"Change to code block\",\n      label: \"Code\"\n    }); }\n  if (type = schema.nodes.heading)\n    { for (var i = 1; i <= 10; i++)\n      { r[\"makeHead\" + i] = blockTypeItem(type, {\n        title: \"Change to heading \" + i,\n        label: \"Level \" + i,\n        attrs: {level: i}\n      }); } }\n  if (type = schema.nodes.horizontal_rule) {\n    var hr = type;\n    r.insertHorizontalRule = new MenuItem({\n      title: \"Insert horizontal rule\",\n      label: \"Horizontal rule\",\n      enable: function enable(state) { return canInsert(state, hr) },\n      run: function run(state, dispatch) { dispatch(state.tr.replaceSelectionWith(hr.create())); }\n    });\n  }\n\n  var cut = function (arr) { return arr.filter(function (x) { return x; }); };\n  r.insertMenu = new Dropdown(cut([r.insertImage, r.insertHorizontalRule]), {label: \"Insert\"});\n  r.typeMenu = new Dropdown(cut([r.makeParagraph, r.makeCodeBlock, r.makeHead1 && new DropdownSubmenu(cut([\n    r.makeHead1, r.makeHead2, r.makeHead3, r.makeHead4, r.makeHead5, r.makeHead6\n  ]), {label: \"Heading\"})]), {label: \"Type...\"});\n\n  r.inlineMenu = [cut([r.toggleStrong, r.toggleEm, r.toggleCode, r.toggleLink])];\n  r.blockMenu = [cut([r.wrapBulletList, r.wrapOrderedList, r.wrapBlockQuote, joinUpItem,\n                      liftItem, selectParentNodeItem])];\n  r.fullMenu = r.inlineMenu.concat([[r.insertMenu, r.typeMenu]], [[undoItem, redoItem]], r.blockMenu);\n\n  return r\n}\n\nvar mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform) : false;\n\n// :: (Schema, ?Object)  Object\n// Inspect the given schema looking for marks and nodes from the\n// basic schema, and if found, add key bindings related to them.\n// This will add:\n//\n// * **Mod-b** for toggling [strong](#schema-basic.StrongMark)\n// * **Mod-i** for toggling [emphasis](#schema-basic.EmMark)\n// * **Mod-`** for toggling [code font](#schema-basic.CodeMark)\n// * **Ctrl-Shift-0** for making the current textblock a paragraph\n// * **Ctrl-Shift-1** to **Ctrl-Shift-Digit6** for making the current\n//   textblock a heading of the corresponding level\n// * **Ctrl-Shift-Backslash** to make the current textblock a code block\n// * **Ctrl-Shift-8** to wrap the selection in an ordered list\n// * **Ctrl-Shift-9** to wrap the selection in a bullet list\n// * **Ctrl->** to wrap the selection in a block quote\n// * **Enter** to split a non-empty textblock in a list item while at\n//   the same time splitting the list item\n// * **Mod-Enter** to insert a hard break\n// * **Mod-_** to insert a horizontal rule\n// * **Backspace** to undo an input rule\n// * **Alt-ArrowUp** to `joinUp`\n// * **Alt-ArrowDown** to `joinDown`\n// * **Mod-BracketLeft** to `lift`\n// * **Escape** to `selectParentNode`\n//\n// You can suppress or map these bindings by passing a `mapKeys`\n// argument, which maps key names (say `\"Mod-B\"` to either `false`, to\n// remove the binding, or a new key name string.\nfunction buildKeymap(schema, mapKeys) {\n  var keys = {}, type;\n  function bind(key, cmd) {\n    if (mapKeys) {\n      var mapped = mapKeys[key];\n      if (mapped === false) { return }\n      if (mapped) { key = mapped; }\n    }\n    keys[key] = cmd;\n  }\n\n\n  bind(\"Mod-z\", undo);\n  bind(\"Shift-Mod-z\", redo);\n  bind(\"Backspace\", undoInputRule);\n  if (!mac) { bind(\"Mod-y\", redo); }\n\n  bind(\"Alt-ArrowUp\", joinUp);\n  bind(\"Alt-ArrowDown\", joinDown);\n  bind(\"Mod-BracketLeft\", lift);\n  bind(\"Escape\", selectParentNode);\n\n  if (type = schema.marks.strong) {\n    bind(\"Mod-b\", toggleMark(type));\n    bind(\"Mod-B\", toggleMark(type));\n  }\n  if (type = schema.marks.em) {\n    bind(\"Mod-i\", toggleMark(type));\n    bind(\"Mod-I\", toggleMark(type));\n  }\n  if (type = schema.marks.code)\n    { bind(\"Mod-`\", toggleMark(type)); }\n\n  if (type = schema.nodes.bullet_list)\n    { bind(\"Shift-Ctrl-8\", wrapInList(type)); }\n  if (type = schema.nodes.ordered_list)\n    { bind(\"Shift-Ctrl-9\", wrapInList(type)); }\n  if (type = schema.nodes.blockquote)\n    { bind(\"Ctrl->\", wrapIn(type)); }\n  if (type = schema.nodes.hard_break) {\n    var br = type, cmd = chainCommands(exitCode, function (state, dispatch) {\n      dispatch(state.tr.replaceSelectionWith(br.create()).scrollIntoView());\n      return true\n    });\n    bind(\"Mod-Enter\", cmd);\n    bind(\"Shift-Enter\", cmd);\n    if (mac) { bind(\"Ctrl-Enter\", cmd); }\n  }\n  if (type = schema.nodes.list_item) {\n    bind(\"Enter\", splitListItem(type));\n    bind(\"Mod-[\", liftListItem(type));\n    bind(\"Mod-]\", sinkListItem(type));\n  }\n  if (type = schema.nodes.paragraph)\n    { bind(\"Shift-Ctrl-0\", setBlockType(type)); }\n  if (type = schema.nodes.code_block)\n    { bind(\"Shift-Ctrl-\\\\\", setBlockType(type)); }\n  if (type = schema.nodes.heading)\n    { for (var i = 1; i <= 6; i++) { bind(\"Shift-Ctrl-\" + i, setBlockType(type, {level: i})); } }\n  if (type = schema.nodes.horizontal_rule) {\n    var hr = type;\n    bind(\"Mod-_\", function (state, dispatch) {\n      dispatch(state.tr.replaceSelectionWith(hr.create()).scrollIntoView());\n      return true\n    });\n  }\n\n  return keys\n}\n\n// : (NodeType)  InputRule\n// Given a blockquote node type, returns an input rule that turns `\"> \"`\n// at the start of a textblock into a blockquote.\nfunction blockQuoteRule(nodeType) {\n  return wrappingInputRule(/^\\s*>\\s$/, nodeType)\n}\n\n// : (NodeType)  InputRule\n// Given a list node type, returns an input rule that turns a number\n// followed by a dot at the start of a textblock into an ordered list.\nfunction orderedListRule(nodeType) {\n  return wrappingInputRule(/^(\\d+)\\.\\s$/, nodeType, function (match) { return ({order: +match[1]}); },\n                           function (match, node) { return node.childCount + node.attrs.order == +match[1]; })\n}\n\n// : (NodeType)  InputRule\n// Given a list node type, returns an input rule that turns a bullet\n// (dash, plush, or asterisk) at the start of a textblock into a\n// bullet list.\nfunction bulletListRule(nodeType) {\n  return wrappingInputRule(/^\\s*([-+*])\\s$/, nodeType)\n}\n\n// : (NodeType)  InputRule\n// Given a code block node type, returns an input rule that turns a\n// textblock starting with three backticks into a code block.\nfunction codeBlockRule(nodeType) {\n  return textblockTypeInputRule(/^```$/, nodeType)\n}\n\n// : (NodeType, number)  InputRule\n// Given a node type and a maximum level, creates an input rule that\n// turns up to that number of `#` characters followed by a space at\n// the start of a textblock into a heading whose level corresponds to\n// the number of `#` signs.\nfunction headingRule(nodeType, maxLevel) {\n  return textblockTypeInputRule(new RegExp(\"^(#{1,\" + maxLevel + \"})\\\\s$\"),\n                                nodeType, function (match) { return ({level: match[1].length}); })\n}\n\n// : (Schema)  Plugin\n// A set of input rules for creating the basic block quotes, lists,\n// code blocks, and heading.\nfunction buildInputRules(schema) {\n  var rules = smartQuotes.concat(ellipsis, emDash), type;\n  if (type = schema.nodes.blockquote) { rules.push(blockQuoteRule(type)); }\n  if (type = schema.nodes.ordered_list) { rules.push(orderedListRule(type)); }\n  if (type = schema.nodes.bullet_list) { rules.push(bulletListRule(type)); }\n  if (type = schema.nodes.code_block) { rules.push(codeBlockRule(type)); }\n  if (type = schema.nodes.heading) { rules.push(headingRule(type, 6)); }\n  return inputRules({rules: rules})\n}\n\n// !! This module exports helper functions for deriving a set of basic\n// menu items, input rules, or key bindings from a schema. These\n// values need to know about the schema for two reasonsthey need\n// access to specific instances of node and mark types, and they need\n// to know which of the node and mark types that they know about are\n// actually present in the schema.\n//\n// The `exampleSetup` plugin ties these together into a plugin that\n// will automatically enable this basic functionality in an editor.\n\n// :: (Object)  [Plugin]\n// A convenience plugin that bundles together a simple menu with basic\n// key bindings, input rules, and styling for the example schema.\n// Probably only useful for quickly setting up a passable\n// editoryou'll need more control over your settings in most\n// real-world situations.\n//\n//   options::- The following options are recognized:\n//\n//     schema:: Schema\n//     The schema to generate key bindings and menu items for.\n//\n//     mapKeys:: ?Object\n//     Can be used to [adjust](#example-setup.buildKeymap) the key bindings created.\n//\n//     menuBar:: ?bool\n//     Set to false to disable the menu bar.\n//\n//     history:: ?bool\n//     Set to false to disable the history plugin.\n//\n//     floatingMenu:: ?bool\n//     Set to false to make the menu bar non-floating.\n//\n//     menuContent:: [[MenuItem]]\n//     Can be used to override the menu content.\nfunction exampleSetup(options) {\n  var plugins = [\n    buildInputRules(options.schema),\n    keymap(buildKeymap(options.schema, options.mapKeys)),\n    keymap(baseKeymap),\n    dropCursor(),\n    gapCursor()\n  ];\n  if (options.menuBar !== false)\n    { plugins.push(menuBar({floating: options.floatingMenu !== false,\n                          content: options.menuContent || buildMenuItems(options.schema).fullMenu})); }\n  if (options.history !== false)\n    { plugins.push(history()); }\n\n  return plugins.concat(new Plugin({\n    props: {\n      attributes: {class: \"ProseMirror-example-setup-style\"}\n    }\n  }))\n}\n\nexport { buildInputRules, buildKeymap, buildMenuItems, exampleSetup };\n//# sourceMappingURL=index.es.js.map\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","/*!\n * is-extendable <https://github.com/jonschlinkert/is-extendable>\n *\n * Copyright (c) 2015-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isPlainObject = require('is-plain-object');\n\nmodule.exports = function isExtendable(val) {\n  return isPlainObject(val) || typeof val === 'function' || Array.isArray(val);\n};\n","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isObject = require('isobject');\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nmodule.exports = function isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObjectObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n};\n","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nmodule.exports = _isNativeReflectConstruct;","var domWalk = require(\"dom-walk\")\n\nvar Comment = require(\"./dom-comment.js\")\nvar DOMText = require(\"./dom-text.js\")\nvar DOMElement = require(\"./dom-element.js\")\nvar DocumentFragment = require(\"./dom-fragment.js\")\nvar Event = require(\"./event.js\")\nvar dispatchEvent = require(\"./event/dispatch-event.js\")\nvar addEventListener = require(\"./event/add-event-listener.js\")\nvar removeEventListener = require(\"./event/remove-event-listener.js\")\n\nmodule.exports = Document;\n\nfunction Document() {\n    if (!(this instanceof Document)) {\n        return new Document();\n    }\n\n    this.head = this.createElement(\"head\")\n    this.body = this.createElement(\"body\")\n    this.documentElement = this.createElement(\"html\")\n    this.documentElement.appendChild(this.head)\n    this.documentElement.appendChild(this.body)\n    this.childNodes = [this.documentElement]\n    this.nodeType = 9\n}\n\nvar proto = Document.prototype;\nproto.createTextNode = function createTextNode(value) {\n    return new DOMText(value, this)\n}\n\nproto.createElementNS = function createElementNS(namespace, tagName) {\n    var ns = namespace === null ? null : String(namespace)\n    return new DOMElement(tagName, this, ns)\n}\n\nproto.createElement = function createElement(tagName) {\n    return new DOMElement(tagName, this)\n}\n\nproto.createDocumentFragment = function createDocumentFragment() {\n    return new DocumentFragment(this)\n}\n\nproto.createEvent = function createEvent(family) {\n    return new Event(family)\n}\n\nproto.createComment = function createComment(data) {\n    return new Comment(data, this)\n}\n\nproto.getElementById = function getElementById(id) {\n    id = String(id)\n\n    var result = domWalk(this.childNodes, function (node) {\n        if (String(node.id) === id) {\n            return node\n        }\n    })\n\n    return result || null\n}\n\nproto.getElementsByClassName = DOMElement.prototype.getElementsByClassName\nproto.getElementsByTagName = DOMElement.prototype.getElementsByTagName\nproto.contains = DOMElement.prototype.contains\n\nproto.removeEventListener = removeEventListener\nproto.addEventListener = addEventListener\nproto.dispatchEvent = dispatchEvent\n","module.exports = Comment\n\nfunction Comment(data, owner) {\n    if (!(this instanceof Comment)) {\n        return new Comment(data, owner)\n    }\n\n    this.data = data\n    this.nodeValue = data\n    this.length = data.length\n    this.ownerDocument = owner || null\n}\n\nComment.prototype.nodeType = 8\nComment.prototype.nodeName = \"#comment\"\n\nComment.prototype.toString = function _Comment_toString() {\n    return \"[object Comment]\"\n}\n","module.exports = DOMText\n\nfunction DOMText(value, owner) {\n    if (!(this instanceof DOMText)) {\n        return new DOMText(value)\n    }\n\n    this.data = value || \"\"\n    this.length = this.data.length\n    this.ownerDocument = owner || null\n}\n\nDOMText.prototype.type = \"DOMTextNode\"\nDOMText.prototype.nodeType = 3\nDOMText.prototype.nodeName = \"#text\"\n\nDOMText.prototype.toString = function _Text_toString() {\n    return this.data\n}\n\nDOMText.prototype.replaceData = function replaceData(index, length, value) {\n    var current = this.data\n    var left = current.substring(0, index)\n    var right = current.substring(index + length, current.length)\n    this.data = left + value + right\n    this.length = this.data.length\n}\n","module.exports = serializeNode\n\nvar voidElements = [\"area\",\"base\",\"br\",\"col\",\"embed\",\"hr\",\"img\",\"input\",\"keygen\",\"link\",\"menuitem\",\"meta\",\"param\",\"source\",\"track\",\"wbr\"];\n\nfunction serializeNode(node) {\n    switch (node.nodeType) {\n        case 3:\n            return escapeText(node.data)\n        case 8:\n            return \"<!--\" + node.data + \"-->\"\n        default:\n            return serializeElement(node)\n    }\n}\n\nfunction serializeElement(elem) {\n    var strings = []\n\n    var tagname = elem.tagName\n\n    if (elem.namespaceURI === \"http://www.w3.org/1999/xhtml\") {\n        tagname = tagname.toLowerCase()\n    }\n\n    strings.push(\"<\" + tagname + properties(elem) + datasetify(elem))\n\n    if (voidElements.indexOf(tagname) > -1) {\n        strings.push(\" />\")\n    } else {\n        strings.push(\">\")\n\n        if (elem.childNodes.length) {\n            strings.push.apply(strings, elem.childNodes.map(serializeNode))\n        } else if (elem.textContent || elem.innerText) {\n            strings.push(escapeText(elem.textContent || elem.innerText))\n        } else if (elem.innerHTML) {\n            strings.push(elem.innerHTML)\n        }\n\n        strings.push(\"</\" + tagname + \">\")\n    }\n\n    return strings.join(\"\")\n}\n\nfunction isProperty(elem, key) {\n    var type = typeof elem[key]\n\n    if (key === \"style\" && Object.keys(elem.style).length > 0) {\n      return true\n    }\n\n    return elem.hasOwnProperty(key) &&\n        (type === \"string\" || type === \"boolean\" || type === \"number\") &&\n        key !== \"nodeName\" && key !== \"className\" && key !== \"tagName\" &&\n        key !== \"textContent\" && key !== \"innerText\" && key !== \"namespaceURI\" &&  key !== \"innerHTML\"\n}\n\nfunction stylify(styles) {\n    if (typeof styles === 'string') return styles\n    var attr = \"\"\n    Object.keys(styles).forEach(function (key) {\n        var value = styles[key]\n        key = key.replace(/[A-Z]/g, function(c) {\n            return \"-\" + c.toLowerCase();\n        })\n        attr += key + \":\" + value + \";\"\n    })\n    return attr\n}\n\nfunction datasetify(elem) {\n    var ds = elem.dataset\n    var props = []\n\n    for (var key in ds) {\n        props.push({ name: \"data-\" + key, value: ds[key] })\n    }\n\n    return props.length ? stringify(props) : \"\"\n}\n\nfunction stringify(list) {\n    var attributes = []\n    list.forEach(function (tuple) {\n        var name = tuple.name\n        var value = tuple.value\n\n        if (name === \"style\") {\n            value = stylify(value)\n        }\n\n        attributes.push(name + \"=\" + \"\\\"\" + escapeAttributeValue(value) + \"\\\"\")\n    })\n\n    return attributes.length ? \" \" + attributes.join(\" \") : \"\"\n}\n\nfunction properties(elem) {\n    var props = []\n    for (var key in elem) {\n        if (isProperty(elem, key)) {\n            props.push({ name: key, value: elem[key] })\n        }\n    }\n\n    for (var ns in elem._attributes) {\n      for (var attribute in elem._attributes[ns]) {\n        var prop = elem._attributes[ns][attribute]\n        var name = (prop.prefix ? prop.prefix + \":\" : \"\") + attribute\n        props.push({ name: name, value: prop.value })\n      }\n    }\n\n    if (elem.className) {\n        props.push({ name: \"class\", value: elem.className })\n    }\n\n    return props.length ? stringify(props) : \"\"\n}\n\nfunction escapeText(s) {\n    var str = '';\n\n    if (typeof(s) === 'string') { \n        str = s; \n    } else if (s) {\n        str = s.toString();\n    }\n\n    return str\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n}\n\nfunction escapeAttributeValue(str) {\n    return escapeText(str).replace(/\"/g, \"&quot;\")\n}\n","var DOMElement = require(\"./dom-element.js\")\n\nmodule.exports = DocumentFragment\n\nfunction DocumentFragment(owner) {\n    if (!(this instanceof DocumentFragment)) {\n        return new DocumentFragment()\n    }\n\n    this.childNodes = []\n    this.parentNode = null\n    this.ownerDocument = owner || null\n}\n\nDocumentFragment.prototype.type = \"DocumentFragment\"\nDocumentFragment.prototype.nodeType = 11\nDocumentFragment.prototype.nodeName = \"#document-fragment\"\n\nDocumentFragment.prototype.appendChild  = DOMElement.prototype.appendChild\nDocumentFragment.prototype.replaceChild = DOMElement.prototype.replaceChild\nDocumentFragment.prototype.removeChild  = DOMElement.prototype.removeChild\n\nDocumentFragment.prototype.toString =\n    function _DocumentFragment_toString() {\n        return this.childNodes.map(function (node) {\n            return String(node)\n        }).join(\"\")\n    }\n","module.exports = Event\n\nfunction Event(family) {}\n\nEvent.prototype.initEvent = function _Event_initEvent(type, bubbles, cancelable) {\n    this.type = type\n    this.bubbles = bubbles\n    this.cancelable = cancelable\n}\n\nEvent.prototype.preventDefault = function _Event_preventDefault() {\n    \n}\n","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n"],"sourceRoot":""}