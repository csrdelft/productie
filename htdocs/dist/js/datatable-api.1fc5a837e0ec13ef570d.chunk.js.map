{"version":3,"sources":["webpack:///./js/datatable/api.ts","webpack:///./js/datatable/render.ts","webpack:////home/travis/build/csrdelft/csrdelft.nl/.yarn/cache/moment-npm-2.27.0-0e670d438d-72d9a7d8db.zip/node_modules/moment/locale sync [/\\\\](nl(\\.js)"],"names":["async","initDataTable","el","$el","settingsJson","data","search","ajax","lastUpdate","fnGetLastUpdate","dataSrc","fnAjaxUpdateCallback","columns","forEach","col","render","table","DataTable","dataTable","api","on","rows","selected","deselect","event","container","get","initOfflineDataTable","fnUpdateDataTable","tableId","response","row","$tr","UUID","length","remove","add","alert","draw","fnGetSelection","selection","each","push","this","attr","getApiFromSettings","settings","fn","Api","$table","Number","fnSetLastUpdate","json","tableConfig","autoUpdate","timeout","parseInt","isNaN","setTimeout","post","url","$scroll","parent","hasClass","scrollTop","innerHeight","scrollHeight","window","animate","fnAutoScroll","replacePlaceholders","action","replacements","exec","i","replace","type","sort","export","display","bedrag","check","aanmeldFilter","aanmeldingen","aantal_aanmeldingen","aanmeld_limiet","totaalPrijs","prijs","datetime","date","format","substr","meta","cell","node","firstChild","dateTime","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports"],"mappings":"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","file":"js/datatable-api.1fc5a837e0ec13ef570d.chunk.js","sourcesContent":["import $ from 'jquery';\nimport { init } from '../ctx';\nimport { parseData } from '../lib/util';\nimport render from './render';\nexport async function initDataTable(el) {\n    await import(/*webpackChunkName: \"bootstrap\"*/ './bootstrap');\n    const $el = $(el);\n    const settingsJson = $el.data('settings');\n    const search = $el.data('search');\n    // Zet de callback voor ajax\n    if (settingsJson.ajax) {\n        settingsJson.ajax.data.lastUpdate = fnGetLastUpdate($el);\n        settingsJson.ajax.dataSrc = fnAjaxUpdateCallback($el);\n    }\n    // Zet de render method op de columns\n    settingsJson.columns.forEach((col) => col.render = render[col.render]);\n    // Init DataTable\n    const table = $el.DataTable(settingsJson);\n    $el.dataTable().api().search(search);\n    table.on('page', () => table.rows({ selected: true }).deselect());\n    table.on('childRow.dt', (event, data) => init(data.container.get(0)));\n}\nexport async function initOfflineDataTable(el) {\n    await import(/*webpackChunkName: \"bootstrap\"*/ './bootstrap');\n    $(el).DataTable(parseData(el));\n}\n/****************************\n * Een paar functies om met datatables te\n * praten, laadt datatables zelf niet in.\n */\nexport function fnUpdateDataTable(tableId, response) {\n    const $table = $(tableId);\n    const table = $table.DataTable();\n    // update or remove existing rows or add new rows\n    response.data.forEach((row) => {\n        const $tr = $('tr[data-uuid=\"' + row.UUID + '\"]');\n        if ($tr.length === 1) {\n            if ('remove' in row) {\n                table.row($tr).remove();\n            }\n            else {\n                table.row($tr).data(row);\n                init($tr.get(0));\n            }\n        }\n        else if ($tr.length === 0) {\n            table.row.add(row);\n        }\n        else {\n            alert($tr.length);\n        }\n    });\n    table.draw(false);\n}\nexport function fnGetSelection(tableId) {\n    const selection = [];\n    $(tableId + ' tbody tr.selected').each(function () {\n        selection.push($(this).attr('data-uuid'));\n    });\n    return selection;\n}\n// new Api(selector: Settings) is valide, maar wordt als type niet geaccepteerd, type lijkt niet uit te breiden.\n// https://datatables.net/reference/type/DataTables.Settings\nexport function getApiFromSettings(settings) {\n    return new $.fn.dataTable.Api(settings);\n}\n/**\n * Wordt gebruikt in gesprekken.\n *\n * @param {jQuery} $table\n */\nfunction fnAutoScroll($table) {\n    const $scroll = $table.parent();\n    if ($scroll.hasClass('dataTables_scrollBody')) {\n        // autoscroll if already on bottom\n        if ($scroll.scrollTop() + $scroll.innerHeight() >= $scroll[0].scrollHeight - 20) {\n            // check before draw and scroll after\n            window.setTimeout(() => {\n                $scroll.animate({\n                    scrollTop: $scroll[0].scrollHeight,\n                }, 800);\n            }, 200);\n        }\n    }\n}\nexport const fnGetLastUpdate = ($table) => () => Number($table.data('lastupdate'));\nexport const fnSetLastUpdate = ($table) => (lastUpdate) => $table.data('lastupdate', lastUpdate);\n/**\n * Called after ajax load complete.\n *\n * @returns object\n * @param {jQuery} $table\n */\nexport const fnAjaxUpdateCallback = ($table) => (json) => {\n    fnSetLastUpdate($table)(json.lastUpdate);\n    const tableConfig = $table.DataTable();\n    if (json.autoUpdate) {\n        const timeout = parseInt(json.autoUpdate, 10);\n        if (!isNaN(timeout) && timeout < 600000) { // max 10 min\n            setTimeout(() => {\n                $.post(tableConfig.ajax.url(), {\n                    lastUpdate: fnGetLastUpdate($table),\n                }, (data) => {\n                    fnUpdateDataTable($table.attr('id'), data);\n                    fnAjaxUpdateCallback($table)(data);\n                });\n            }, timeout);\n        }\n    }\n    fnAutoScroll($table);\n    return json.data;\n};\nexport function replacePlaceholders(action, row) {\n    const replacements = /:(\\w+)/g.exec(action);\n    if (!replacements) {\n        return action;\n    }\n    for (let i = 1; i < replacements.length; i++) {\n        action = action.replace(':' + replacements[i], row[replacements[i]]);\n    }\n    return action;\n}\n","import moment from 'moment';\nimport { formatBedrag, formatFilesize } from '../lib/util';\nimport { getApiFromSettings } from './api';\n/**\n * Standaard gedefinieerde render functies.\n */\nexport default {\n    default(data, type) {\n        if (data === null || typeof data !== 'object') {\n            return data;\n        }\n        switch (type) {\n            case 'sort':\n                return data.sort;\n            case 'export':\n                return data.export;\n            default:\n                return data.display;\n        }\n    },\n    bedrag(data) {\n        return formatBedrag(data);\n    },\n    check(data) {\n        return '<span class=\"ico ' + (data ? 'tick' : 'cross') + '\"></span>';\n    },\n    aanmeldFilter(data) {\n        return data ? `<span class=\"ico group_key\" title=\"Aanmeld filter actief: '${data}'\"></span>` : '';\n    },\n    aanmeldingen(data, type, row) {\n        return row.aantal_aanmeldingen + ' (' + row.aanmeld_limiet + ')';\n    },\n    totaalPrijs(data, type, row) {\n        return formatBedrag(row.aantal_aanmeldingen * parseInt(row.prijs, 10));\n    },\n    datetime(date, type, row) {\n        // tslint:disable-next-line:triple-equals\n        if (Number(date) == date) {\n            return moment(date * 1000).format('YYYY-MM-DD HH:mm');\n        }\n        if (!date) {\n            return '';\n        }\n        if (date.substr(0, 5) === '<time') {\n            return date;\n        }\n        return moment(date).format('YYYY-MM-DD HH:mm');\n    },\n    timeago(data, type, row, meta) {\n        const api = getApiFromSettings(meta.settings);\n        const cell = api.cell(meta.row, meta.col).node().firstChild;\n        switch (type) {\n            case 'sort':\n            case 'export':\n                return cell.dateTime;\n            default:\n                return data;\n        }\n    },\n    filesize(data, type) {\n        switch (type) {\n            case 'sort':\n                return Number(data);\n            default:\n                return formatFilesize(data);\n        }\n    },\n};\n","var map = {\n\t\"./nl\": 74,\n\t\"./nl.js\": 74\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 89;"],"sourceRoot":""}