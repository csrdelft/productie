{"version":3,"sources":["webpack:///./js/lib/domUpdate.ts","webpack:///./js/lib/modal.ts","webpack:///./js/lib/fotoalbum/with-admin-buttons.ts","webpack:///./js/lib/reload.ts"],"names":["domUpdate","htmlString","trim","substring","alert","Error","elements","each","index","element","Element","$element","id","attr","parentId","target","targetParent","length","hasClass","effect","remove","replaceWith","show","get","append","HTMLScriptElement","parentid","this","prependTo","modalOpen","modal","modalBackdrop","html","find","trigger","document","body","modalClose","constructor","albums","params","super","root","container","style","color","backgroundColor","background","textColor","transform","content","addEventListener","dropdown","display","rotateClockwiseButton","padding","url","getUrl","a","post","foto","rotation","then","rotateCounterClockwiseButton","setCoverButton","resp","data","deleteButton","confirm","decodeURI","flexDirection","left","position","top","whiteSpace","children","appendChild","appendControlsElements","item","currentItem","goToItem","fullUrl","replace","reload","location","redirect","window","href"],"mappings":"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","file":"js/fotoalbum-with-admin-buttons.9320244f3310670812a5.chunk.js","sourcesContent":["import $ from 'jquery';\nimport { init } from '../ctx';\nimport { modalClose, modalOpen } from './modal';\nimport { htmlParse } from './util';\nexport function domUpdate(htmlString) {\n    if (typeof htmlString !== 'string') {\n        return;\n    }\n    htmlString = $.trim(htmlString);\n    if (htmlString.substring(0, 9) === '<!DOCTYPE') {\n        alert('response error');\n        throw new Error(htmlString);\n    }\n    const elements = htmlParse(htmlString);\n    $(elements).each(function (index, element) {\n        if (!(element instanceof Element)) {\n            // element kan ook een stuk tekst zijn, hier kunnen we niets mee.\n            return;\n        }\n        const $element = $(element);\n        const id = $(element).attr('id');\n        const parentId = $(element).attr('parentid');\n        const target = $('#' + id);\n        const targetParent = $('#' + parentId);\n        if (target.length === 1) {\n            if ($element.hasClass('remove')) {\n                target.effect('fade', {}, 400, () => {\n                    target.remove();\n                });\n            }\n            else {\n                target.replaceWith($element.show().get()).effect('highlight');\n            }\n        }\n        else if (targetParent.length === 1) {\n            targetParent.append($element.show());\n        }\n        else if (element instanceof HTMLScriptElement) {\n            $('head').append($element);\n        }\n        else {\n            const parentid = $(this).attr('parentid');\n            if (parentid) {\n                $(this).prependTo(`#${parentid}`).show().effect('highlight');\n            }\n            else {\n                $(this).prependTo('#maalcie-tabel tbody:visible:first').show().effect('highlight'); // FIXME: make generic\n            }\n        }\n        init(element);\n        if (id === 'modal') {\n            modalOpen();\n        }\n        else {\n            modalClose();\n        }\n    });\n}\n","import $ from 'jquery';\nexport function modalOpen(htmlString = '') {\n    const modal = $('#modal');\n    const modalBackdrop = $('.modal-backdrop');\n    if (modal.html() === '' && htmlString === '') {\n        return false;\n    }\n    if (modalBackdrop.length) {\n        modalBackdrop.remove();\n    }\n    if (htmlString !== '') {\n        modal.replaceWith(htmlString);\n        modal.find('input:visible:first').trigger('focus');\n    }\n    modal.modal('show');\n    $(document.body).trigger('modalOpen');\n    return true;\n}\nexport function modalClose() {\n    $('#modal').modal('hide');\n    $(document.body).trigger('modalClose');\n}\n","import axios from 'axios';\nimport createElement from 'jgallery/src/utils/create-element';\nimport withTooltip from 'jgallery/src/utils/with-tooltip';\nimport { redirect, reload } from '../reload';\nimport { basename, dirname } from '../util';\nconst withAdminButtons = (constructor) => class extends constructor {\n    constructor(albums, params) {\n        super(albums, params);\n        this.root = params.root || '';\n        const container = withTooltip(createElement('<span class=\"j-gallery-icon\"><i class=\"fa fa-wrench\"></i></span>'), {\n            style: {\n                color: params.backgroundColor,\n                background: params.textColor,\n                transform: 'translateY(-8px)',\n            },\n            content: 'Beheer',\n        });\n        container.addEventListener('click', () => {\n            dropdown.style.display = 'flex';\n        });\n        container.addEventListener('mouseleave', () => {\n            dropdown.style.display = 'none';\n        });\n        const rotateClockwiseButton = createElement(`<div><i class=\"fa fa-redo\"></i>&nbsp;Draai met de klok mee</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        rotateClockwiseButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/roteren' + dirname(url), {\n                foto: basename(url),\n                rotation: 90,\n            }).then(reload);\n        });\n        const rotateCounterClockwiseButton = createElement(`<div><i class=\"fa fa-undo\"></i>&nbsp;Draai tegen de klok in</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        rotateCounterClockwiseButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/roteren' + dirname(url), {\n                foto: basename(url),\n                rotation: -90,\n            }).then(reload);\n        });\n        const setCoverButton = createElement(`<div><i class=\"fa fa-folder\"></i>&nbsp;Instellen als albumcover</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        setCoverButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/albumcover' + dirname(url), {\n                foto: basename(url),\n            }).then((resp) => redirect(resp.data));\n        });\n        const deleteButton = createElement(`<div><i class=\"fa fa-times\"></i>&nbsp;Verwijderen</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        deleteButton.addEventListener('click', () => {\n            if (!confirm('Foto definitief verwijderen. Weet u het zeker?')) {\n                return false;\n            }\n            const url = this.getUrl();\n            axios.post('/fotoalbum/verwijderen' + dirname(url), {\n                foto: decodeURI(basename(url)),\n            }).then(reload);\n        });\n        const dropdown = createElement('<div class=\"j-gallery-dropdown\"></div>', {\n            style: {\n                background: params.backgroundColor,\n                display: 'none',\n                flexDirection: 'column',\n                left: '0',\n                position: 'absolute',\n                top: '0',\n                whiteSpace: 'nowrap',\n            },\n            children: [rotateClockwiseButton, rotateCounterClockwiseButton, setCoverButton, deleteButton],\n        });\n        container.appendChild(dropdown);\n        this.appendControlsElements([container]);\n    }\n    goToItem(item) {\n        this.currentItem = item;\n        return super.goToItem(item);\n    }\n    getUrl() {\n        return this.currentItem.fullUrl.replace(this.root, '');\n    }\n};\nexport default withAdminButtons;\n","import { domUpdate } from './domUpdate';\nexport function reload(htmlString) {\n    if (typeof htmlString === 'string' && htmlString.substring(0, 16) === '<div id=\"modal\" ') {\n        domUpdate(htmlString);\n        return;\n    }\n    location.reload();\n}\nexport function redirect(htmlString) {\n    if (htmlString.substring(0, 16) === '<div id=\"modal\" ') {\n        domUpdate(htmlString);\n        return;\n    }\n    window.location.href = htmlString;\n}\n"],"sourceRoot":""}