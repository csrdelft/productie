{"version":3,"sources":["webpack:///./js/ajax.ts","webpack:///./js/datatable/api.ts","webpack:///./js/extern-defer.ts","webpack:///./js/fotoalbum/FotoAlbum.ts","webpack:///./js/bbcode-set.ts","webpack:///./js/formulier.ts","webpack:///./js/datatable/render.ts","webpack:///./js/bbcode.ts","webpack:///./js/lib/jquery.markitup.js"],"names":["ajaxRequest","type","url","data","source","onsuccess","onerror","onfinish","hasClass","find","css","addClass","replaceWith","attr","contentType","processData","FormData","ajax","cache","done","response","hide","removeClass","fail","textStatus","errorThrown","responseText","startsWith","status","always","ketzerAjax","ketzer","jqXHR","alert","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","this","n","v","op","TypeError","call","pop","length","push","fnUpdateDataTable","tableId","table","DataTable","forEach","row","$tr","UUID","remove","get","add","draw","fnGetSelection","selection","each","getApiFromSettings","settings","fn","dataTable","Api","addHandler","el","$el","settingsJson","search","_a","lastUpdate","fnGetLastUpdate","dataSrc","fnAjaxUpdateCallback","columns","col","render","api","on","rows","selected","deselect","event","container","$table","Number","json","fnSetLastUpdate","tableConfig","autoUpdate","timeout","parseInt","isNaN","setTimeout","post","$scroll","parent","scrollTop","innerHeight","scrollHeight","window","animate","fnAutoScroll","replacePlaceholders","action","replacements","exec","i","replace","bbcode","bbvideoDisplay","$window","$header","$banner","content","document","createElement","html","toString","foto","indexOf","video","hasAnchor","closest","wrap","hasLoaded","lazyLoad","textContent","pageYOffset","outerHeight","trigger","contactForm","querySelector","errorContainer_1","submitButton_1","submitButton","addEventListener","preventDefault","innerHTML","disabled","formData","a","reset","catch","error","extendStatics","__extends","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","FotoAlbum","_super","wrapper","_this","isLoggedIn","magAanpassen","slideshowInterval","root","itemsJson","jGallery","updateContextMenu","showFullRes","emit","fullscreenEnabled","off","getUrl","fullscreen","location","href","prependTo","appendTo","toggleFullScreen","contextMenu","menuSelected","menuSelector","requestFullscreen","docelem","exitFullScreen","exitFullscreen","getFullUrl","decodeURI","img","zoom","fotoElem","src","naturalHeight","naturalWidth","createCMBtn","id","text","icon","class","tabindex","append","cm","empty","addCMI","item","divider","btnDown","btnTag","click","btnFS","btn","btnZoom","btnRight","rotation","btnLeft","btnCover","btnDel","confirm","fotoalbum","FotoAlbumTags","bbCodeSet","markupSet","className","name","key","openWith","closeWith","separator","placeHolder","markitup","prompt","pos","decodeURIComponent","trim","substring","nameSpace","previewParserPath","formIsChanged","form","changed","not","elmnt","is","val","formInlineToggle","prev","toggle","children","formReset","target","orig","formSubmit","$target","q","formData_1","modal","tableId_1","getElementById","formCancel","ctx","addHandlers","formToggle","markItUp","timeago","default","sort","export","display","bedrag","check","aanmeldFilter","aanmeldingen","aantal_aanmeldingen","aanmeld_limiet","totaalPrijs","prijs","meta","cell","node","firstChild","dateTime","filesize","__makeTemplateObject","cooked","raw","defineProperty","__assign","assign","s","arguments","previewId","dataset","bbpreviewBtn","Error","CsrBBPreviewEl","bbpreview","templateObject_1","templateObject_2","params","style","encodeURIComponent","elem","$previewdiv","iframe","width","height","$","extraSettings","method","options","ctrlKey","shiftKey","altKey","previewHandler","previewInWindow","previewInElement","previewAutoRefresh","previewPosition","previewTemplatePath","previewParser","previewParserVar","resizeHandle","beforeInsert","afterInsert","onEnter","onShiftEnter","onCtrlEnter","onTab","extend","tag","miuScript","match","uaMatch","ua","toLowerCase","browser","version","matched","navigator","userAgent","chrome","webkit","safari","$$","textarea","levels","scrollPosition","caretPosition","caretOffset","clicked","hash","header","footer","previewWindow","template","iFrame","abort","localize","markup","init","inText","substr","toUpperCase","insertBefore","dropMenus","insertAfter","bind","mouseMove","mouseUp","h","clientY","Math","max","unbind","keyPressed","focused","refreshPreview","ul","li","button","title","j","focus","eval","show","one","dropMenu","magicMarkups","string","x","split","undefined","prepare","isFunction","build","block","openBlockWith","closeBlockWith","multiline","lines","blocks","l","trailingSpaces","line","join","len","start","beforeMultiInsert","opera","fixIeBug","fixOperaBug","insert","set","afterMultiInsert","msie","createRange","createTextRange","range","collapse","moveStart","moveEnd","select","setSelectionRange","rangeCopy","duplicate","moveToElementText","inRange","selectionStart","selectionEnd","preview","closed","open","unload","close","contentWindow","frame","renderPreview","writeInPreview","dataType","global","success","sp","documentElement","write","metaKey","keyCode","String","fromCharCode","triggerHandler","keepDefault","markItUpRemove","jQuery"],"mappings":"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","file":"js/30.56b124d2d573b6488df2.js","sourcesContent":["import $ from 'jquery';\nimport { modalClose } from './modal';\nexport function ajaxRequest(type, url, data, source, onsuccess, onerror, onfinish) {\n    if (source) {\n        if (!source.hasClass('noanim')) {\n            $(source).replaceWith(\"<img alt=\\\"Laden\\\" id=\\\"\" + source.attr('id') + \"\\\" title=\\\"\" + url + \"\\\" src=\\\"/images/loading-arrows.gif\\\" />\");\n            source = $(\"img[title=\\\"\" + url + \"\\\"]\");\n        }\n        else if (source.hasClass('InlineForm')) {\n            $(source).find('.FormElement:first').css({\n                'background-image': 'url(\"/images/loading-fb.gif\")',\n                'background-position': 'center right',\n                'background-repeat': 'no-repeat',\n            });\n        }\n        else {\n            source.addClass('loading');\n        }\n    }\n    var contentType = 'application/x-www-form-urlencoded; charset=UTF-8';\n    var processData = true;\n    if (data instanceof FormData) {\n        contentType = false;\n        processData = false;\n    }\n    $.ajax({\n        cache: false,\n        contentType: contentType,\n        data: data,\n        processData: processData,\n        type: type,\n        url: url,\n    }).done(function (response) {\n        if (source) {\n            if (!$(source).hasClass('noanim')) {\n                $(source).hide();\n            }\n            else if ($(source).hasClass('InlineForm')) {\n                $(source).find('.FormElement:first').css({\n                    'background-image': '',\n                    'background-position': '',\n                    'background-repeat': '',\n                });\n            }\n            source.removeClass('loading');\n        }\n        onsuccess(response);\n    }).fail(function (response, textStatus, errorThrown) {\n        if (errorThrown === '') {\n            errorThrown = 'Nog bezig met laden!';\n        }\n        if (source) {\n            $(source).replaceWith('<img alt=\"Mislukt\" title=\"' + errorThrown + '\" src=\"/plaetjes/famfamfam/cancel.png\" />');\n        }\n        else {\n            modalClose();\n        }\n        if (onerror) {\n            if (response.responseText.startsWith('<!DOC')) {\n                onerror('Er ging iets fout, code is: ' + response.status);\n            }\n            onerror(response.responseText);\n        }\n    }).always(function () {\n        if (onfinish) {\n            onfinish();\n        }\n    });\n}\nexport function ketzerAjax(url, ketzer) {\n    $(ketzer + ' .aanmeldbtn').addClass('loading');\n    $.ajax({\n        cache: false,\n        data: '',\n        type: 'GET',\n        url: url,\n    }).done(function (data) {\n        $(ketzer).replaceWith(data);\n    }).fail(function (jqXHR, textStatus, errorThrown) {\n        $(ketzer + ' .aanmeldbtn')\n            .replaceWith($(\"<div class=\\\"alert alert-danger\\\"><strong>Actie mislukt!</strong> \" + errorThrown + \"</div>\"));\n        alert(jqXHR.responseText);\n    });\n    return true;\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport $ from 'jquery';\nimport ctx, { init } from '../ctx';\nimport { parseData } from '../util';\nimport render from './render';\nctx.addHandler('.ctx-datatable', initDataTable);\nctx.addHandler('.ctx-offline-datatable', initOfflineDataTable);\nfunction initDataTable(el) {\n    return __awaiter(this, void 0, void 0, function () {\n        var $el, settingsJson, search, table;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, import('./bootstrap')];\n                case 1:\n                    _a.sent();\n                    $el = $(el);\n                    settingsJson = $el.data('settings');\n                    search = $el.data('search');\n                    if (settingsJson.ajax) {\n                        settingsJson.ajax.data.lastUpdate = fnGetLastUpdate($el);\n                        settingsJson.ajax.dataSrc = fnAjaxUpdateCallback($el);\n                    }\n                    settingsJson.columns.forEach(function (col) { return col.render = render[col.render]; });\n                    table = $el.DataTable(settingsJson);\n                    $el.dataTable().api().search(search);\n                    table.on('page', function () { return table.rows({ selected: true }).deselect(); });\n                    table.on('childRow.dt', function (event, data) { return init(data.container.get(0)); });\n                    return [2];\n            }\n        });\n    });\n}\nfunction initOfflineDataTable(el) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, import('./bootstrap')];\n                case 1:\n                    _a.sent();\n                    $(el).DataTable(parseData(el));\n                    return [2];\n            }\n        });\n    });\n}\nexport function fnUpdateDataTable(tableId, response) {\n    var $table = $(tableId);\n    var table = $table.DataTable();\n    response.data.forEach(function (row) {\n        var $tr = $('tr[data-uuid=\"' + row.UUID + '\"]');\n        if ($tr.length === 1) {\n            if ('remove' in row) {\n                table.row($tr).remove();\n            }\n            else {\n                table.row($tr).data(row);\n                init($tr.get(0));\n            }\n        }\n        else if ($tr.length === 0) {\n            table.row.add(row);\n        }\n        else {\n            alert($tr.length);\n        }\n    });\n    table.draw(false);\n}\nexport function fnGetSelection(tableId) {\n    var selection = [];\n    $(tableId + ' tbody tr.selected').each(function () {\n        selection.push($(this).attr('data-uuid'));\n    });\n    return selection;\n}\nexport function getApiFromSettings(settings) {\n    return new $.fn.dataTable.Api(settings);\n}\nfunction fnAutoScroll($table) {\n    var $scroll = $table.parent();\n    if ($scroll.hasClass('dataTables_scrollBody')) {\n        if ($scroll.scrollTop() + $scroll.innerHeight() >= $scroll[0].scrollHeight - 20) {\n            window.setTimeout(function () {\n                $scroll.animate({\n                    scrollTop: $scroll[0].scrollHeight,\n                }, 800);\n            }, 200);\n        }\n    }\n}\nexport var fnGetLastUpdate = function ($table) { return function () { return Number($table.data('lastupdate')); }; };\nexport var fnSetLastUpdate = function ($table) { return function (lastUpdate) { return $table.data('lastupdate', lastUpdate); }; };\nexport var fnAjaxUpdateCallback = function ($table) { return function (json) {\n    fnSetLastUpdate($table)(json.lastUpdate);\n    var tableConfig = $table.DataTable();\n    if (json.autoUpdate) {\n        var timeout = parseInt(json.autoUpdate, 10);\n        if (!isNaN(timeout) && timeout < 600000) {\n            setTimeout(function () {\n                $.post(tableConfig.ajax.url(), {\n                    lastUpdate: fnGetLastUpdate($table),\n                }, function (data) {\n                    fnUpdateDataTable($table.attr('id'), data);\n                    fnAjaxUpdateCallback($table)(data);\n                });\n            }, timeout);\n        }\n    }\n    fnAutoScroll($table);\n    return json.data;\n}; };\nexport function replacePlaceholders(action, row) {\n    var replacements = /:(\\w+)/g.exec(action);\n    if (!replacements) {\n        return action;\n    }\n    for (var i = 1; i < replacements.length; i++) {\n        action = action.replace(':' + replacements[i], row[replacements[i]]);\n    }\n    return action;\n}\n","import axios from 'axios';\nimport $ from 'jquery';\nimport { bbvideoDisplay } from './bbcode';\nimport { init } from './ctx';\nimport './formulier';\nimport './fotoalbum/FotoAlbum';\nrequire('lightbox2');\nrequire('./lib/jquery.markitup');\nrequire('jquery-ui/ui/widgets/tooltip');\nrequire('jquery-hoverintent');\nrequire('timeago');\nwindow.bbcode = {\n    bbvideoDisplay: bbvideoDisplay,\n};\nvar $window = $(window);\nvar $header = $('#header');\nvar $banner = $('#banner');\nif (typeof $banner[0] === 'undefined') {\n    $banner = $('#banner-small');\n}\n$window.on('load', function () {\n    setTimeout(function () {\n        $('div.bb-img-loading').each(function () {\n            var content = $(document.createElement('img'));\n            content.on('error', function () {\n                $(this).attr('title', 'Afbeelding bestaat niet of is niet toegankelijk!');\n                $(this).attr('src', '/plaetjes/famfamfam/picture_error.png');\n                $(this).css('width', '16px');\n                $(this).css('height', '16px');\n                $(this).removeClass('bb-img-loading').addClass('bb-img');\n            });\n            content.addClass('bb-img');\n            content.attr('alt', $(this).attr('title'));\n            content.attr('style', $(this).attr('style'));\n            content.attr('src', $(this).attr('src'));\n            $(this).html(content.toString());\n            content.on('load', function () {\n                var foto = content.attr('src').indexOf('/plaetjes/fotoalbum/') >= 0;\n                var video = $(this).parent().parent().hasClass('bb-video-preview');\n                var hasAnchor = $(this).closest('a').length !== 0;\n                $(this).parent().replaceWith($(this));\n                if (!foto && !video && !hasAnchor) {\n                    $(this).wrap(\"<a class=\\\"lightbox-link\\\" href=\\\"\" + $(this).attr('src') + \"\\\" data-lightbox=\\\"page-lightbox\\\"></a>\");\n                }\n            });\n        });\n    });\n});\nvar lazyLoad = (function () {\n    var hasLoaded = false;\n    return function () {\n        if (hasLoaded) {\n            return;\n        }\n        hasLoaded = true;\n        setTimeout(function () {\n            $('.lazy-load').each(function () {\n                $(this).replaceWith(this.textContent);\n            });\n        });\n    };\n})();\n$window.on('scroll', function () {\n    if ($(window).scrollTop() > 0) {\n        lazyLoad();\n    }\n    if (window.pageYOffset > $banner.outerHeight()) {\n        $header.removeClass('alt');\n    }\n    else {\n        $header.addClass('alt');\n    }\n});\n$window.on('resize', function () { return $window.trigger('scroll'); });\n$window.trigger('scroll');\ninit(document.body);\nvar contactForm = document.querySelector('#contact-form');\nif (contactForm) {\n    var errorContainer_1 = document.querySelector('#melding');\n    var submitButton_1 = contactForm.submitButton;\n    contactForm.addEventListener('submit', function (event) {\n        event.preventDefault();\n        errorContainer_1.innerHTML = '';\n        submitButton_1.disabled = true;\n        var formData = new FormData(contactForm);\n        axios.post('/contactformulier/interesse', formData)\n            .then(function (response) {\n            contactForm.reset();\n            submitButton_1.disabled = false;\n            errorContainer_1.innerHTML = '<div class=\"alert alert-success\">' +\n                '<span class=\"ico accept\"></span>' + response.data +\n                '</div>';\n        })\n            .catch(function (error) {\n            submitButton_1.disabled = false;\n            errorContainer_1.innerHTML = '<div class=\"alert alert-danger\">' +\n                '<span class=\"ico exclamation\"></span>' + error.response.data +\n                '</div>';\n        });\n        return false;\n    });\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { EventEmitter } from 'events';\nrequire('jgallery/dist/js/jgallery');\nimport $ from 'jquery';\nimport { basename, dirname, redirect, reload, selectText } from '../util';\nvar FotoAlbum = (function (_super) {\n    __extends(FotoAlbum, _super);\n    function FotoAlbum(wrapper) {\n        var _this = _super.call(this) || this;\n        _this.wrapper = wrapper;\n        _this.isLoggedIn = wrapper.data('isLoggedIn');\n        _this.magAanpassen = wrapper.data('magAanpassen');\n        _this.slideshowInterval = wrapper.data('slideshowInterval');\n        _this.root = wrapper.data('root');\n        _this.itemsJson = wrapper.data('fotos');\n        var afterLoadPhoto = function () {\n            _this.container = $('div.jgallery');\n            if (_this.isLoggedIn) {\n                _this.updateContextMenu();\n            }\n            var zoom = _this.container.find('div.zoom-container');\n            if (zoom.attr('data-size') !== 'fit') {\n                _this.showFullRes();\n            }\n            _this.emit('afterLoadPhoto');\n        };\n        wrapper.find('.gallery').jGallery({\n            'afterLoadPhoto': afterLoadPhoto,\n            'autostart': true,\n            'autostartAtAlbum': 1,\n            'backgroundColor': 'fff',\n            'browserHistory': true,\n            'canChangeMode': true,\n            'canClose': false,\n            'canMinimalizeThumbnails': true,\n            'canZoom': true,\n            'disabledOnIE8AndOlder': true,\n            'draggableZoom': true,\n            'draggableZoomHideNavigationOnMobile': true,\n            'height': '897px',\n            'hideThumbnailsOnInit': false,\n            'items': _this.itemsJson,\n            'maxMobileWidth': 767,\n            'mode': 'standard',\n            'preloadAll': false,\n            'slideshow': true,\n            'slideshowAutostart': false,\n            'slideshowCanRandom': true,\n            'slideshowInterval': _this.slideshowInterval,\n            'slideshowRandom': false,\n            'swipeEvents': false,\n            'textColor': '193b61',\n            'thumbHeight': 150,\n            'thumbHeightOnFullScreen': 150,\n            'thumbType': 'image',\n            'thumbWidth': 150,\n            'thumbWidthOnFullScreen': 150,\n            'thumbnails': true,\n            'thumbnailsHideOnMobile': false,\n            'thumbnailsPosition': 'bottom',\n            'title': _this.isLoggedIn,\n            'titleExpanded': false,\n            'tooltipClose': 'Close',\n            'tooltipFullScreen': 'Full screen',\n            'tooltipRandom': 'Random',\n            'tooltipSeeAllPhotos': 'Grid',\n            'tooltipSeeOtherAlbums': 'Toon sub-albums',\n            'tooltipSlideshow': 'Slideshow',\n            'tooltipToggleThumbnails': 'Toggle thumbnails',\n            'tooltipZoom': 'Zoom',\n            'tooltips': true,\n            'transition': 'moveToLeft_scaleUp',\n            'transitionBackward': 'moveToRight_scaleUp',\n            'transitionCols': '1',\n            'transitionDuration': '0.7s',\n            'transitionRows': '1',\n            'transitionTimingFunction': 'cubic-bezier(0,1,1,1)',\n            'width': '100%',\n            'zoomSize': 'fit',\n            'zoomSize:': 'original',\n        });\n        _this.container = $('div.jgallery');\n        _this.container.addClass('noselect');\n        $(document).on('webkitfullscreenchange mozfullscreenchange fullscreenchange', function () {\n            if (document.fullscreenEnabled) {\n            }\n            else if (_this.container.hasClass('jgallery-full-screen')) {\n                $('span.change-mode').trigger('click');\n            }\n        });\n        if (_this.isLoggedIn) {\n            _this.container.find('div.title').off().on('click', function () {\n                selectText(this);\n            }).addClass('select-text');\n            $('<span class=\"fa fa-level-up jgallery-btn jgallery-btn-small\" tooltip=\"Open parent album\"></span>')\n                .on('click', function () {\n                var url = _this.getUrl();\n                var fullscreen = '';\n                if (_this.container.hasClass('jgallery-full-screen')) {\n                    fullscreen = '?fullscreen';\n                }\n                window.location.href = dirname(dirname(url)).replace('plaetjes/', '') + fullscreen;\n            }).prependTo(_this.container.find('div.icons'));\n        }\n        _this.container.find('.fa-list-ul').removeClass('fa-list-ul').addClass('fa-folder-open-o');\n        $('span.resize.jgallery-btn').on('click', function () {\n            var zoom = _this.container.find('div.zoom-container');\n            if (zoom.attr('data-size') !== 'fit') {\n                _this.showFullRes();\n                $('div.fototag').addClass('verborgen');\n            }\n            else {\n                $('div.fototag').removeClass('verborgen');\n            }\n        }).appendTo(_this.container.find('div.icons'));\n        _this.container.find('span.change-mode')\n            .on('click', function () { return _this.toggleFullScreen(); }).appendTo(_this.container.find('div.icons'));\n        if (window.location.href.indexOf('?fullscreen') > 0 && !_this.container.hasClass('jgallery-full-screen')) {\n            $('span.change-mode').trigger('click');\n        }\n        if (_this.isLoggedIn) {\n            _this.container.find('div.zoom').contextMenu({\n                menuSelected: function () { return true; },\n                menuSelector: '#contextMenu',\n            });\n        }\n        _this.container.find('div.icons .jgallery-btn.change-album').appendTo(_this.container.find('div.icons'));\n        return _this;\n    }\n    FotoAlbum.requestFullscreen = function () {\n        var docelem = document.querySelector('.jgallery');\n        if (docelem && typeof docelem.requestFullscreen === 'function') {\n            docelem.requestFullscreen();\n        }\n    };\n    FotoAlbum.exitFullScreen = function () {\n        if (typeof document.exitFullscreen === 'function') {\n            document.exitFullscreen();\n        }\n    };\n    FotoAlbum.prototype.getFullUrl = function () {\n        return decodeURI(this.container.find('div.nav-bottom div.title').html());\n    };\n    FotoAlbum.prototype.getUrl = function () {\n        return this.getFullUrl().replace(this.root, '');\n    };\n    FotoAlbum.prototype.toggleFullScreen = function () {\n        if (this.container.hasClass('jgallery-full-screen')) {\n            FotoAlbum.requestFullscreen();\n        }\n        else {\n            FotoAlbum.exitFullScreen();\n        }\n    };\n    FotoAlbum.prototype.showFullRes = function () {\n        var zoom = this.container.find('div.zoom-container');\n        var foto = zoom.find('img.active');\n        var fotoElem = foto.get(0);\n        var setDimensions = function (img) {\n            if (zoom.attr('data-size') === 'original') {\n                foto.css({\n                    'height': img.naturalHeight,\n                    'margin-left': -img.naturalWidth / 2,\n                    'margin-top': -img.naturalHeight / 2,\n                    'max-height': '',\n                    'max-width': '',\n                    'width': img.naturalWidth,\n                });\n                foto.attr('data-width', img.naturalWidth);\n                foto.attr('data-height', img.naturalHeight);\n                $(window).trigger('resize');\n            }\n        };\n        if (fotoElem.src !== this.getFullUrl()) {\n            fotoElem.src = this.getFullUrl();\n        }\n        if (zoom.attr('data-size') === 'original') {\n            setDimensions(fotoElem);\n        }\n        if (zoom.attr('data-size') === 'fill') {\n            $('span.resize.jgallery-btn').removeClass('fa-search-minus').addClass('fa-search-plus');\n        }\n    };\n    FotoAlbum.prototype.createCMBtn = function (id, text, icon) {\n        return $('<a>')\n            .attr({\n            class: 'dropdown-item',\n            id: id,\n            tabindex: '-1',\n        })\n            .append($('<span>').attr('class', \"fa fa-\" + icon))\n            .append(\"&nbsp; \" + text);\n    };\n    FotoAlbum.prototype.updateContextMenu = function () {\n        var _this = this;\n        var cm = $('#contextMenu').empty();\n        var addCMI = function (item, divider) {\n            if (divider) {\n                $('<div class=\"dropdown-divider\"></div>').appendTo(cm);\n            }\n            $(item).appendTo(cm);\n            if (item.hasClass('disabled')) {\n                item.parent().addClass('disabled');\n            }\n        };\n        var btnDown = this.createCMBtn('btnDown', 'Downloaden', 'download');\n        btnDown.on('click', function () { return window.location.href = _this.getFullUrl() + \"?download\"; });\n        addCMI(btnDown);\n        var btnTag = this.createCMBtn('btnTag', 'Leden etiketteren', 'smile-o');\n        btnTag.on('click', function () { return _this.container.find('span.fa-smile-o.jgallery-btn').click(); });\n        addCMI(btnTag);\n        var btnFS = this.createCMBtn('btnFS', 'Volledig scherm', '');\n        btnFS.on('click', function () {\n            var btn = _this.container.find('span.change-mode');\n            btn.click();\n            if (btn.hasClass('fa-expand')) {\n                btnFS.find('span.fa').removeClass('fa-compress').addClass('fa-expand');\n            }\n            else {\n                btnFS.find('span.fa').addClass('fa-compress').removeClass('fa-expand');\n            }\n        });\n        addCMI(btnFS);\n        if (this.container.find('span.change-mode').hasClass('fa-expand')) {\n            btnFS.find('span.fa').addClass('fa-expand');\n        }\n        else {\n            btnFS.find('span.fa').addClass('fa-compress');\n        }\n        var btnZoom = $('<a id=\"btnZoom\" class=\"dropdown-item\" tabindex=\"-1\"><span class=\"fa\"></span> &nbsp; Zoomen</a>');\n        btnZoom.on('click', function () {\n            var btn = _this.container.find('span.resize.jgallery-btn');\n            btn.click();\n            if (btn.hasClass('fa-search-minus')) {\n                btnZoom.find('span.fa').removeClass('fa-search-minus').addClass('fa-search-plus');\n            }\n            else {\n                btnZoom.find('span.fa').addClass('fa-search-minus').removeClass('fa-search-plus');\n            }\n        });\n        addCMI(btnZoom);\n        if (this.container.find('span.resize.jgallery-btn').hasClass('fa-search-plus')) {\n            btnZoom.find('span.fa').addClass('fa-search-plus');\n        }\n        else {\n            btnZoom.find('span.fa').addClass('fa-search-minus');\n        }\n        if (this.magAanpassen) {\n            var btnRight = this.createCMBtn('btnRight', 'Draai met de klok mee', 'repeat');\n            btnRight.on('click', function () {\n                var url = _this.getUrl();\n                $.post('/fotoalbum/roteren' + dirname(url), {\n                    foto: basename(url),\n                    rotation: 90,\n                }, reload);\n            });\n            addCMI(btnRight, true);\n            var btnLeft = this.createCMBtn('btnLeft', 'Draai tegen de klok in', 'undo');\n            btnLeft.on('click', function () {\n                var url = _this.getUrl();\n                $.post('/fotoalbum/roteren' + dirname(url), {\n                    foto: basename(url),\n                    rotation: -90,\n                }, reload);\n            });\n            addCMI(btnLeft);\n            var btnCover = this.createCMBtn('btnCover', 'Instellen als albumcover', 'folder');\n            btnCover.on('click', function () {\n                var url = _this.getUrl();\n                $.post('/fotoalbum/albumcover' + dirname(url), {\n                    foto: basename(url),\n                }, redirect);\n            });\n            addCMI(btnCover);\n            var btnDel = this.createCMBtn('btnDel', 'Verwijderen', 'times');\n            btnDel.on('click', function () {\n                if (!confirm('Foto definitief verwijderen. Weet u het zeker?')) {\n                    return false;\n                }\n                var url = _this.getUrl();\n                $.post('/fotoalbum/verwijderen' + dirname(url), {\n                    foto: decodeURI(basename(url)),\n                }, reload);\n            });\n            addCMI(btnDel, true);\n        }\n    };\n    return FotoAlbum;\n}(EventEmitter));\nexport { FotoAlbum };\n$('.fotoalbum').each(function (i, el) {\n    var wrapper = $(el);\n    var fotoalbum = new FotoAlbum(wrapper);\n    if (wrapper.data('isLoggedIn')) {\n        import('./FotoAlbumTags')\n            .then(function (_a) {\n            var FotoAlbumTags = _a.FotoAlbumTags;\n            return new FotoAlbumTags(fotoalbum);\n        });\n    }\n});\n","export var bbCodeSet = {\n    markupSet: [\n        { className: 'ico text_bold', name: 'Dikgedrukt', key: 'B', openWith: '[b]', closeWith: '[/b]' },\n        { className: 'ico text_italic', name: 'Cursief', key: 'I', openWith: '[i]', closeWith: '[/i]' },\n        { className: 'ico text_underline', name: 'Onderstreept', key: 'U', openWith: '[u]', closeWith: '[/u]' },\n        { className: 'ico text_strikethrough', name: 'Doorgestreept', key: 'S', openWith: '[s]', closeWith: '[/s]' },\n        { separator: '|' },\n        { className: 'ico text_smallcaps', name: 'Offtopic', key: 'O', openWith: '[offtopic]', closeWith: '[/offtopic]' },\n        {\n            className: 'ico comments',\n            closeWith: '[/citaat]',\n            key: 'Q',\n            name: 'Citaat',\n            openWith: '[citaat=Naam_of_lidnummer]',\n        },\n        { separator: '|' },\n        {\n            className: 'ico link',\n            closeWith: '[/url]',\n            key: 'L',\n            name: 'Link',\n            openWith: '[url=[![Url]!]]',\n            placeHolder: 'Link tekst',\n        },\n        {\n            className: 'ico email_link',\n            closeWith: '[/email]',\n            key: 'E',\n            name: 'Email',\n            openWith: '[email=[![Email adres]!]]',\n            placeHolder: 'Link tekst',\n        },\n        { separator: '|' },\n        {\n            className: 'ico photos', name: 'Fotoalbum', replaceWith: function (markitup) {\n                var url = window.prompt('Url', '');\n                if (url) {\n                    url = decodeURIComponent(url.trim());\n                    var pos = url.indexOf('/fotoalbum/');\n                    if (pos > 0) {\n                        url = url.substring(pos + 10);\n                        return '[fotoalbum]' + url + '[/fotoalbum]';\n                    }\n                    alert('Ongeldige url!');\n                }\n                return markitup.selection;\n            },\n        },\n        {\n            className: 'ico photo', name: 'Poster of foto uit album', replaceWith: function (markitup) {\n                var url = window.prompt('Url', '');\n                if (url) {\n                    url = decodeURIComponent(url.trim());\n                    var pos = url.indexOf('/fotoalbum/');\n                    if (pos > 0) {\n                        url = url.substring(pos + 10).replace('_resized/', '').replace('_thumbs/', '').replace('#', '');\n                        return '[foto]' + url + '[/foto]';\n                    }\n                    alert('Ongeldige url!');\n                }\n                return markitup.selection;\n            },\n        },\n        { className: 'ico picture', name: 'Afbeelding', replaceWith: '[img][![Url]!][/img]' },\n        { className: 'ico film', name: 'Video', replaceWith: '[video][![Url]!][/video]' },\n        { separator: '|' },\n        { className: 'ico map', name: 'Kaart', openWith: '[locatie]', closeWith: '[/locatie]', placeHolder: 'C.S.R. Delft' },\n        { className: 'ico sound_mute', name: 'Verklapper', openWith: '[verklapper]', closeWith: '[/verklapper]' },\n        {\n            className: 'ico shield',\n            closeWith: '[/prive]',\n            name: 'Privé',\n            openWith: '[prive]',\n            placeHolder: 'Afgeschermde gegevens',\n        },\n        { separator: '|' },\n        { className: 'ico script_code_red', name: 'Code', openWith: '[code]', closeWith: '[/code]' },\n        { className: 'ico tag', name: 'Opmaakcode tonen', openWith: '[tekst]', closeWith: '[/tekst]' },\n    ],\n    nameSpace: 'CsrBB',\n    previewParserPath: '/tools/bbcode',\n};\n","import axios from 'axios';\nimport $ from 'jquery';\nimport { ajaxRequest } from './ajax';\nimport { bbCodeSet } from './bbcode-set';\nimport { domUpdate } from './context';\nimport ctx, { init } from './ctx';\nimport { fnGetSelection, fnUpdateDataTable } from './datatable/api';\nimport { modalClose, modalOpen } from './modal';\nimport { redirect, reload } from './util';\nctx.addHandlers({\n    '.InlineFormToggle': function (el) { return el.addEventListener('click', function (event) { return formToggle(el, event); }); },\n    '.SubmitChange': function (el) { return el.addEventListener('change', formSubmit); },\n    '.cancel': function (el) { return el.addEventListener('click', formCancel); },\n    '.reset': function (el) { return el.addEventListener('click', formReset); },\n    '.submit': function (el) { return el.addEventListener('click', formSubmit); },\n    'form.Formulier': function (el) { return $(el).on('submit', formSubmit); },\n    'textarea.BBCodeField': function (el) { return $(el).markItUp(bbCodeSet); },\n    'time.timeago': function (el) { return $(el).timeago(); },\n});\nexport function formIsChanged(form) {\n    var changed = false;\n    $(form).find('.FormElement').not('.tt-hint').each(function () {\n        var elmnt = $(this);\n        if (elmnt.is('input:radio')) {\n            if (elmnt.is(':checked') && elmnt.attr('origvalue') !== elmnt.val()) {\n                changed = true;\n                return false;\n            }\n        }\n        else if (elmnt.is('input:checkbox')) {\n            if (elmnt.is(':checked') !== (elmnt.attr('origvalue') === '1')) {\n                changed = true;\n                return false;\n            }\n        }\n        else if (elmnt.val() !== elmnt.attr('origvalue')) {\n            changed = true;\n            return false;\n        }\n    });\n    return changed;\n}\nexport function formInlineToggle(form) {\n    form.prev('.InlineFormToggle').toggle();\n    form.toggle();\n    form.children(':first').trigger('focus');\n}\nexport function formToggle(target, event) {\n    event.preventDefault();\n    var form = $(target).next('form');\n    formInlineToggle(form);\n    return false;\n}\nexport function formReset(event, form) {\n    if (!form) {\n        form = $(event.target).closest('form');\n        event.preventDefault();\n    }\n    if ($(event.target).hasClass('confirm') && !confirm($(event.target).attr('title') + '.\\n\\nWeet u het zeker?')) {\n        return false;\n    }\n    form.find('.FormElement').each(function () {\n        var orig = $(event.target).attr('origvalue');\n        if (typeof orig === 'string') {\n            $(this).val(orig);\n        }\n    });\n    return false;\n}\nexport function formSubmit(event) {\n    var target = event.target;\n    var $target = $(target);\n    if ($target.hasClass('confirm')) {\n        var q = $target.attr('title');\n        if (q) {\n            q += '.\\n\\n';\n        }\n        else {\n            q = 'Weet u het zeker?';\n        }\n        if (!confirm(q)) {\n            event.preventDefault();\n            return false;\n        }\n    }\n    var form = $target.closest('form');\n    if (!form.hasClass('Formulier')) {\n        return false;\n    }\n    if (form.hasClass('PreventUnchanged') && !formIsChanged(form)) {\n        event.preventDefault();\n        alert('Geen wijzigingen');\n        return false;\n    }\n    if ($target.attr('href')) {\n        form.attr('action', $target.attr('href'));\n    }\n    if (!(form.hasClass('ModalForm') || form.hasClass('InlineForm'))) {\n        form.off('submit');\n        form.trigger('submit');\n        return true;\n    }\n    else {\n        event.preventDefault();\n        var formData_1 = new FormData(form.get(0));\n        var done = domUpdate;\n        var source = false;\n        if (form.hasClass('InlineForm')) {\n            source = form;\n            formData_1.append('InlineFormId', form.attr('id'));\n            if (form.data('submitCallback')) {\n                done = form.data('submitCallback');\n            }\n        }\n        if (form.hasClass('ModalForm')) {\n            done = function (response) {\n                if (typeof response === 'string') {\n                    domUpdate(response);\n                }\n                else {\n                    modalClose();\n                }\n            };\n        }\n        if (form.hasClass('DataTableResponse')) {\n            var tableId_1 = form.attr('data-tableid');\n            if (!document.getElementById(tableId_1)) {\n                alert('DataTable not found');\n            }\n            formData_1.append('DataTableId', tableId_1);\n            var selection = fnGetSelection('#' + tableId_1);\n            $.each(selection, function (key, value) {\n                formData_1.append('DataTableSelection[]', value);\n            });\n            done = function (response) {\n                if (typeof response === 'object') {\n                    fnUpdateDataTable('#' + tableId_1, response);\n                    if (response.modal) {\n                        modalOpen(response.modal);\n                        init(document.querySelector('#modal'));\n                    }\n                    else {\n                        modalClose();\n                    }\n                }\n                else {\n                    domUpdate(response);\n                }\n            };\n            if (!form.hasClass('noanim')) {\n                source = false;\n            }\n        }\n        if (form.hasClass('ReloadPage')) {\n            done = reload;\n        }\n        else if (form.hasClass('redirect')) {\n            done = redirect;\n        }\n        ajaxRequest('POST', form.attr('action'), formData_1, source, done, alert, function () {\n            if (form.hasClass('SubmitReset')) {\n                formReset(event, form);\n            }\n        });\n        return false;\n    }\n}\nexport function formCancel(event) {\n    var source = $(event.target);\n    if (source.hasClass('confirm') && !confirm(source.attr('title') + '.\\n\\nWeet u het zeker?')) {\n        event.preventDefault();\n        return false;\n    }\n    var form = source.closest('form');\n    if (form.hasClass('InlineForm')) {\n        event.preventDefault();\n        formInlineToggle(form);\n        return false;\n    }\n    if (form.hasClass('ModalForm')) {\n        event.preventDefault();\n        var href = source.attr('href');\n        if (href) {\n            axios.get(href);\n        }\n        if (!formIsChanged(form) || confirm('Sluiten zonder wijzigingen op te slaan?')) {\n            modalClose();\n        }\n        return false;\n    }\n    return true;\n}\n","import { formatBedrag, formatFilesize } from '../util';\nimport { getApiFromSettings } from './api';\nexport default {\n    default: function (data, type) {\n        if (data === null || typeof data !== 'object') {\n            return data;\n        }\n        switch (type) {\n            case 'sort':\n                return data.sort;\n            case 'export':\n                return data.export;\n            default:\n                return data.display;\n        }\n    },\n    bedrag: function (data) {\n        return formatBedrag(data);\n    },\n    check: function (data) {\n        return '<span class=\"ico ' + (data ? 'tick' : 'cross') + '\"></span>';\n    },\n    aanmeldFilter: function (data) {\n        return data ? \"<span class=\\\"ico group_key\\\" title=\\\"Aanmeld filter actief: '\" + data + \"'\\\"></span>\" : '';\n    },\n    aanmeldingen: function (data, type, row) {\n        return row.aantal_aanmeldingen + ' (' + row.aanmeld_limiet + ')';\n    },\n    totaalPrijs: function (data, type, row) {\n        return formatBedrag(row.aantal_aanmeldingen * parseInt(row.prijs, 10));\n    },\n    timeago: function (data, type, row, meta) {\n        var api = getApiFromSettings(meta.settings);\n        var cell = api.cell(meta.row, meta.col).node().firstChild;\n        switch (type) {\n            case 'sort':\n            case 'export':\n                return cell.dateTime;\n            default:\n                return data;\n        }\n    },\n    filesize: function (data, type) {\n        switch (type) {\n            case 'sort':\n                return Number(data);\n            default:\n                return formatFilesize(data);\n        }\n    },\n};\n","var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport axios from 'axios';\nimport $ from 'jquery';\nimport ctx, { init } from './ctx';\nimport { singleLineString } from './util';\nctx.addHandler('[data-bbpreview-btn]', function (el) {\n    var previewId = el.dataset.bbpreviewBtn;\n    var source = document.querySelector('#' + previewId);\n    var target = document.querySelector('#preview_' + previewId);\n    if (!source || !target) {\n        throw new Error('Bbpreview van niet bestaande elementen');\n    }\n    el.addEventListener('click', function () { return CsrBBPreviewEl(source, target); });\n});\nctx.addHandler('[data-bbpreview]', function (el) {\n    var previewId = el.dataset.bbpreview;\n    var target = document.querySelector('#preview_' + previewId);\n    if (!target) {\n        throw new Error('Geen target gevonden voor bbpreview');\n    }\n    el.addEventListener('keyup', function (event) {\n        if (event.key === 'Enter') {\n            CsrBBPreviewEl(el, target);\n        }\n    });\n});\nexport var CsrBBPreviewEl = function (source, target, params) {\n    if (params === void 0) { params = {}; }\n    var bbcode = source.value;\n    if (bbcode.trim() === '') {\n        target.innerHTML = '';\n        target.style.display = 'none';\n        return;\n    }\n    axios.post('/tools/bbcode', __assign({ data: encodeURIComponent(bbcode) }, params)).then(function (response) {\n        target.innerHTML = response.data;\n        init(target);\n        target.style.display = 'block';\n    }).catch(function (error) {\n        alert(error);\n    });\n};\nexport var bbvideoDisplay = function (elem) {\n    var $previewdiv = $(elem);\n    var params = $previewdiv.data('params');\n    if (params.iframe) {\n        $previewdiv\n            .parent()\n            .html(singleLineString(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n<iframe\\n\\tframeborder=\\\"0\\\"\\n\\twidth=\\\"\", \"\\\"\\n\\theight=\\\"\", \"\\\"\\n\\tsrc=\\\"\", \"\\\"\\n\\tallowfullscreen></iframe>\"], [\"\\n<iframe\\n\\tframeborder=\\\"0\\\"\\n\\twidth=\\\"\", \"\\\"\\n\\theight=\\\"\", \"\\\"\\n\\tsrc=\\\"\", \"\\\"\\n\\tallowfullscreen></iframe>\"])), params.width, params.height, params.src));\n    }\n    else {\n        $previewdiv.parent().html(singleLineString(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n<object\\n\\ttype=\\\"application/x-shockwave-flash\\\"\\n\\tdata=\\\"http://www.godtube.com/resource/mediaplayer/5.3/player.swf\\\"\\n\\twidth=\\\"\", \"\\\"\\n\\theight=\\\"\", \"\\\">\\n\\t\\t<param name=\\\"allowfullscreen\\\" value=\\\"true\\\" />\\n\\t\\t<param name=\\\"allowscriptaccess\\\" value=\\\"always\\\" />\\n\\t\\t<param name=\\\"wmode\\\" value=\\\"opaque\\\" />\\n\\t\\t<param name=\\\"movie\\\" value=\\\"http://www.godtube.com/resource/mediaplayer/5.3/player.swf\\\" />\\n\\t\\t<param name=\\\"autostart\\\" value=\\\"true\\\" />\\n\\t\\t<param name=\\\"flashvars\\\" value=\\\"file=http://www.godtube.com/resource/mediaplayer/\", \".file\\n\\t\\t\\t\\t\\t\\t&image=http://www.godtube.com/resource/mediaplayer/\", \".jpg\\n\\t\\t\\t\\t\\t\\t&screencolor=000000\\n\\t\\t\\t\\t\\t\\t&type=video\\n\\t\\t\\t\\t\\t\\t&autostart=true\\n\\t\\t\\t\\t\\t\\t&playonce=true\\n\\t\\t\\t\\t\\t\\t&skin=http://www.godtube.com//resource/mediaplayer/skin/carbon/carbon.zip\\n\\t\\t\\t\\t\\t\\t&logo.file=http://media.salemwebnetwork.com/godtube/theme/default/media/embed-logo.png\\n\\t\\t\\t\\t\\t\\t&logo.link=http://www.godtube.com/watch/?v=\", \"\\n\\t\\t\\t\\t\\t\\t&logo.position=top-left\\n\\t\\t\\t\\t\\t\\t&logo.hide=false\\n\\t\\t\\t\\t\\t\\t&controlbar.position=over\\\"></object>\"], [\"\\n<object\\n\\ttype=\\\"application/x-shockwave-flash\\\"\\n\\tdata=\\\"http://www.godtube.com/resource/mediaplayer/5.3/player.swf\\\"\\n\\twidth=\\\"\", \"\\\"\\n\\theight=\\\"\", \"\\\">\\n\\t\\t<param name=\\\"allowfullscreen\\\" value=\\\"true\\\" />\\n\\t\\t<param name=\\\"allowscriptaccess\\\" value=\\\"always\\\" />\\n\\t\\t<param name=\\\"wmode\\\" value=\\\"opaque\\\" />\\n\\t\\t<param name=\\\"movie\\\" value=\\\"http://www.godtube.com/resource/mediaplayer/5.3/player.swf\\\" />\\n\\t\\t<param name=\\\"autostart\\\" value=\\\"true\\\" />\\n\\t\\t<param name=\\\"flashvars\\\" value=\\\"file=http://www.godtube.com/resource/mediaplayer/\", \".file\\n\\t\\t\\t\\t\\t\\t&image=http://www.godtube.com/resource/mediaplayer/\", \".jpg\\n\\t\\t\\t\\t\\t\\t&screencolor=000000\\n\\t\\t\\t\\t\\t\\t&type=video\\n\\t\\t\\t\\t\\t\\t&autostart=true\\n\\t\\t\\t\\t\\t\\t&playonce=true\\n\\t\\t\\t\\t\\t\\t&skin=http://www.godtube.com//resource/mediaplayer/skin/carbon/carbon.zip\\n\\t\\t\\t\\t\\t\\t&logo.file=http://media.salemwebnetwork.com/godtube/theme/default/media/embed-logo.png\\n\\t\\t\\t\\t\\t\\t&logo.link=http://www.godtube.com/watch/?v=\", \"\\n\\t\\t\\t\\t\\t\\t&logo.position=top-left\\n\\t\\t\\t\\t\\t\\t&logo.hide=false\\n\\t\\t\\t\\t\\t\\t&controlbar.position=over\\\"></object>\"])), params.width, params.height, params.id, params.id, params.id));\n    }\n    return false;\n};\nvar templateObject_1, templateObject_2;\n","// ----------------------------------------------------------------------------\n// markItUp! Universal MarkUp Engine, JQuery plugin\n// v 1.1.x\n// Dual licensed under the MIT and GPL licenses.\n// ----------------------------------------------------------------------------\n// Copyright (C) 2007-2012 Jay Salvat\n// http://markitup.jaysalvat.com/\n// ----------------------------------------------------------------------------\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n// ----------------------------------------------------------------------------\n(function($) {\n\t$.fn.markItUp = function(settings, extraSettings) {\n\t\tvar method, params, options, selection, ctrlKey, shiftKey, altKey; ctrlKey = shiftKey = altKey = false;\n\n\t\tif (typeof settings == 'string') {\n\t\t\tmethod = settings;\n\t\t\tparams = extraSettings;\n\t\t}\n\n\t\toptions = {\tid:\t\t\t\t\t\t'',\n\t\t\t\t\tnameSpace:\t\t\t\t'',\n\t\t\t\t\troot:\t\t\t\t\t'',\n\t\t\t\t\tpreviewHandler:\t\t\tfalse,\n\t\t\t\t\tpreviewInWindow:\t\t'', // 'width=800, height=600, resizable=yes, scrollbars=yes'\n\t\t\t\t\tpreviewInElement:\t\t'',\n\t\t\t\t\tpreviewAutoRefresh:\t\ttrue,\n\t\t\t\t\tpreviewPosition:\t\t'after',\n\t\t\t\t\tpreviewTemplatePath:\t'~/templates/preview.html',\n\t\t\t\t\tpreviewParser:\t\t\tfalse,\n\t\t\t\t\tpreviewParserPath:\t\t'',\n\t\t\t\t\tpreviewParserVar:\t\t'data',\n\t\t\t\t\tresizeHandle:\t\t\ttrue,\n\t\t\t\t\tbeforeInsert:\t\t\t'',\n\t\t\t\t\tafterInsert:\t\t\t'',\n\t\t\t\t\tonEnter:\t\t\t\t{},\n\t\t\t\t\tonShiftEnter:\t\t\t{},\n\t\t\t\t\tonCtrlEnter:\t\t\t{},\n\t\t\t\t\tonTab:\t\t\t\t\t{},\n\t\t\t\t\tmarkupSet:\t\t\t[\t{ /* set */ } ]\n\t\t\t\t};\n\t\t$.extend(options, settings, extraSettings);\n\n\t\t// compute markItUp! path\n\t\tif (!options.root) {\n\t\t\t$('script').each(function(a, tag) {\n\t\t\t\tvar miuScript;\n\t\t\t\tmiuScript = $(tag).get(0).src.match(/(.*)jquery\\.markitup(\\.pack)?\\.js$/);\n\t\t\t\tif (miuScript !== null) {\n\t\t\t\t\toptions.root = miuScript[1];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Quick patch to keep compatibility with jQuery 1.9\n\t\tvar uaMatch = function(ua) {\n\t\t\tua = ua.toLowerCase();\n\n\t\t\tvar match = /(chrome)[ \\/]([\\w.]+)/.exec(ua) ||\n\t\t\t\t/(webkit)[ \\/]([\\w.]+)/.exec(ua) ||\n\t\t\t\t/(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(ua) ||\n\t\t\t\t/(msie) ([\\w.]+)/.exec(ua) ||\n\t\t\t\tua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec(ua) ||\n\t\t\t\t[];\n\n\t\t\treturn {\n\t\t\t\tbrowser: match[ 1 ] || \"\",\n\t\t\t\tversion: match[ 2 ] || \"0\"\n\t\t\t};\n\t\t};\n\t\tvar matched = uaMatch( navigator.userAgent );\n\t\tvar browser = {};\n\n\t\tif (matched.browser) {\n\t\t\tbrowser[matched.browser] = true;\n\t\t\tbrowser.version = matched.version;\n\t\t}\n\t\tif (browser.chrome) {\n\t\t\tbrowser.webkit = true;\n\t\t} else if (browser.webkit) {\n\t\t\tbrowser.safari = true;\n\t\t}\n\n\t\treturn this.each(function() {\n\t\t\tvar $$, textarea, levels, scrollPosition, caretPosition, caretOffset,\n\t\t\t\tclicked, hash, header, footer, previewWindow, template, iFrame, abort;\n\t\t\t$$ = $(this);\n\t\t\ttextarea = this;\n\t\t\tlevels = [];\n\t\t\tabort = false;\n\t\t\tscrollPosition = caretPosition = 0;\n\t\t\tcaretOffset = -1;\n\n\t\t\toptions.previewParserPath = localize(options.previewParserPath);\n\t\t\toptions.previewTemplatePath = localize(options.previewTemplatePath);\n\n\t\t\tif (method) {\n\t\t\t\tswitch(method) {\n\t\t\t\t\tcase 'remove':\n\t\t\t\t\t\tremove();\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'insert':\n\t\t\t\t\t\tmarkup(params);\n\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t$.error('Method ' +  method + ' does not exist on jQuery.markItUp');\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// apply the computed path to ~/\n\t\t\tfunction localize(data, inText) {\n\t\t\t\tif (inText) {\n\t\t\t\t\treturn \tdata.replace(/(\"|')~\\//g, \"$1\"+options.root);\n\t\t\t\t}\n\t\t\t\treturn \tdata.replace(/^~\\//, options.root);\n\t\t\t}\n\n\t\t\t// init and build editor\n\t\t\tfunction init() {\n\t\t\t\tvar id = '', nameSpace = '', resizeHandle;\n\t\t\t\tif (options.id) {\n\t\t\t\t\tid = 'id=\"'+options.id+'\"';\n\t\t\t\t} else if ($$.attr(\"id\")) {\n\t\t\t\t\tid = 'id=\"markItUp'+($$.attr(\"id\").substr(0, 1).toUpperCase())+($$.attr(\"id\").substr(1))+'\"';\n\n\t\t\t\t}\n\t\t\t\tif (options.nameSpace) {\n\t\t\t\t\tnameSpace = 'class=\"'+options.nameSpace+'\"';\n\t\t\t\t}\n\t\t\t\t$$.wrap('<div '+nameSpace+'></div>');\n\t\t\t\t$$.wrap('<div '+id+' class=\"markItUp\"></div>');\n\t\t\t\t$$.wrap('<div class=\"markItUpContainer\"></div>');\n\t\t\t\t$$.addClass(\"markItUpEditor\");\n\n\t\t\t\t// add the header before the textarea\n\t\t\t\theader = $('<div class=\"markItUpHeader\"></div>').insertBefore($$);\n\t\t\t\t$(dropMenus(options.markupSet)).appendTo(header);\n\n\t\t\t\t// add the footer after the textarea\n\t\t\t\tfooter = $('<div class=\"markItUpFooter\"></div>').insertAfter($$);\n\n\t\t\t\t// add the resize handle after textarea\n\t\t\t\tif (options.resizeHandle === true && browser.safari !== true) {\n\t\t\t\t\tresizeHandle = $('<div class=\"markItUpResizeHandle\"></div>')\n\t\t\t\t\t\t.insertAfter($$)\n\t\t\t\t\t\t.bind(\"mousedown.markItUp\", function(e) {\n\t\t\t\t\t\t\tvar h = $$.height(), y = e.clientY, mouseMove, mouseUp;\n\t\t\t\t\t\t\tmouseMove = function(e) {\n\t\t\t\t\t\t\t\t$$.css(\"height\", Math.max(20, e.clientY+h-y)+\"px\");\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tmouseUp = function(e) {\n\t\t\t\t\t\t\t\t$(\"html\").unbind(\"mousemove.markItUp\", mouseMove).unbind(\"mouseup.markItUp\", mouseUp);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t$(\"html\").bind(\"mousemove.markItUp\", mouseMove).bind(\"mouseup.markItUp\", mouseUp);\n\t\t\t\t\t});\n\t\t\t\t\tfooter.append(resizeHandle);\n\t\t\t\t}\n\n\t\t\t\t// listen key events\n\t\t\t\t$$.bind('keydown.markItUp', keyPressed).bind('keyup', keyPressed);\n\n\t\t\t\t// bind an event to catch external calls\n\t\t\t\t$$.bind(\"insertion.markItUp\", function(e, settings) {\n\t\t\t\t\tif (settings.target !== false) {\n\t\t\t\t\t\tget();\n\t\t\t\t\t}\n\t\t\t\t\tif (textarea === $.markItUp.focused) {\n\t\t\t\t\t\tmarkup(settings);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// remember the last focus\n\t\t\t\t$$.bind('focus.markItUp', function() {\n\t\t\t\t\t$.markItUp.focused = this;\n\t\t\t\t});\n\n\t\t\t\tif (options.previewInElement) {\n\t\t\t\t\trefreshPreview();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// recursively build header with dropMenus from markupset\n\t\t\tfunction dropMenus(markupSet) {\n\t\t\t\tvar ul = $('<ul></ul>'), i = 0, li;\n\t\t\t\t$('li:hover > ul', ul).css('display', 'block');\n\t\t\t\t$.each(markupSet, function() {\n\t\t\t\t\tvar button = this, t = '', title, li, j;\n\t\t\t\t\ttitle = (button.key) ? (button.name||'')+' [Ctrl+'+button.key+']' : (button.name||'');\n\t\t\t\t\tvar key   = (button.key) ? 'accesskey=\"'+button.key+'\"' : '';\n\t\t\t\t\tif (button.separator) {\n\t\t\t\t\t\tli = $('<li class=\"markItUpSeparator\">'+(button.separator||'')+'</li>').appendTo(ul);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\tfor (j = levels.length -1; j >= 0; j--) {\n\t\t\t\t\t\t\tt += levels[j]+\"-\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tli = $('<li class=\"markItUpButton markItUpButton'+t+(i)+' '+(button.className||'')+'\"><a href=\"\" '+key+' title=\"'+title+'\">'+(button.name||'')+'</a></li>')\n\t\t\t\t\t\t.bind(\"contextmenu.markItUp\", function() { // prevent contextmenu on mac and allow ctrl+click\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}).bind('click.markItUp', function(e) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}).bind(\"focusin.markItUp\", function(){\n                            $$.focus();\n\t\t\t\t\t\t}).bind('mouseup', function() {\n\t\t\t\t\t\t\tif (button.call) {\n\t\t\t\t\t\t\t\teval(button.call)();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetTimeout(function() { markup(button) },1);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}).bind('mouseenter.markItUp', function() {\n\t\t\t\t\t\t\t\t$('> ul', this).show();\n\t\t\t\t\t\t\t\t$(document).one('click', function() { // close dropmenu if click outside\n\t\t\t\t\t\t\t\t\t\t$('ul ul', header).hide();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}).bind('mouseleave.markItUp', function() {\n\t\t\t\t\t\t\t\t$('> ul', this).hide();\n\t\t\t\t\t\t}).appendTo(ul);\n\t\t\t\t\t\tif (button.dropMenu) {\n\t\t\t\t\t\t\tlevels.push(i);\n\t\t\t\t\t\t\t$(li).addClass('markItUpDropMenu').append(dropMenus(button.dropMenu));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlevels.pop();\n\t\t\t\treturn ul;\n\t\t\t}\n\n\t\t\t// markItUp! markups\n\t\t\tfunction magicMarkups(string) {\n\t\t\t\tif (string) {\n\t\t\t\t\tstring = string.toString();\n\t\t\t\t\tstring = string.replace(/\\(\\!\\(([\\s\\S]*?)\\)\\!\\)/g,\n\t\t\t\t\t\tfunction(x, a) {\n\t\t\t\t\t\t\tvar b = a.split('|!|');\n\t\t\t\t\t\t\tif (altKey === true) {\n\t\t\t\t\t\t\t\treturn (b[1] !== undefined) ? b[1] : b[0];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn (b[1] === undefined) ? \"\" : b[0];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\t// [![prompt]!], [![prompt:!:value]!]\n\t\t\t\t\tstring = string.replace(/\\[\\!\\[([\\s\\S]*?)\\]\\!\\]/g,\n\t\t\t\t\t\tfunction(x, a) {\n\t\t\t\t\t\t\tvar b = a.split(':!:');\n\t\t\t\t\t\t\tif (abort === true) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar value = prompt(b[0], (b[1]) ? b[1] : '');\n\t\t\t\t\t\t\tif (value === null) {\n\t\t\t\t\t\t\t\tabort = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\treturn string;\n\t\t\t\t}\n\t\t\t\treturn \"\";\n\t\t\t}\n\n\t\t\t// prepare action\n\t\t\tfunction prepare(action) {\n\t\t\t\tif ($.isFunction(action)) {\n\t\t\t\t\taction = action(hash);\n\t\t\t\t}\n\t\t\t\treturn magicMarkups(action);\n\t\t\t}\n\n\t\t\t// build block to insert\n\t\t\tfunction build(string) {\n\t\t\t\tvar openWith \t\t\t= prepare(clicked.openWith);\n\t\t\t\tvar placeHolder \t\t= prepare(clicked.placeHolder);\n\t\t\t\tvar replaceWith \t\t= prepare(clicked.replaceWith);\n\t\t\t\tvar closeWith \t\t\t= prepare(clicked.closeWith);\n\t\t\t\tvar openBlockWith \t\t= prepare(clicked.openBlockWith);\n\t\t\t\tvar closeBlockWith \t\t= prepare(clicked.closeBlockWith);\n\t\t\t\tvar multiline \t\t\t= clicked.multiline;\n\t\t\t\tvar block;\n\n\t\t\t\tif (replaceWith !== \"\") {\n\t\t\t\t\tblock = openWith + replaceWith + closeWith;\n\t\t\t\t} else if (selection === '' && placeHolder !== '') {\n\t\t\t\t\tblock = openWith + placeHolder + closeWith;\n\t\t\t\t} else {\n\t\t\t\t\tstring = string || selection;\n\n\t\t\t\t\tvar lines = [string], blocks = [];\n\n\t\t\t\t\tif (multiline === true) {\n\t\t\t\t\t\tlines = string.split(/\\r?\\n/);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (var l = 0; l < lines.length; l++) {\n\t\t\t\t\t\tvar line = lines[l];\n\t\t\t\t\t\tvar trailingSpaces;\n\t\t\t\t\t\tif (trailingSpaces = line.match(/ *$/)) {\n\t\t\t\t\t\t\tblocks.push(openWith + line.replace(/ *$/g, '') + closeWith + trailingSpaces);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tblocks.push(openWith + line + closeWith);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tblock = blocks.join(\"\\n\");\n\t\t\t\t}\n\n\t\t\t\tblock = openBlockWith + block + closeBlockWith;\n\n\t\t\t\treturn {\tblock:block,\n\t\t\t\t\t\t\topenBlockWith:openBlockWith,\n\t\t\t\t\t\t\topenWith:openWith,\n\t\t\t\t\t\t\treplaceWith:replaceWith,\n\t\t\t\t\t\t\tplaceHolder:placeHolder,\n\t\t\t\t\t\t\tcloseWith:closeWith,\n\t\t\t\t\t\t\tcloseBlockWith:closeBlockWith\n\t\t\t\t\t};\n\t\t\t}\n\n\t\t\t// define markup to insert\n\t\t\tfunction markup(button) {\n\t\t\t\tvar len, j, n, i, lines, string, start;\n\t\t\t\thash = clicked = button;\n\t\t\t\tget();\n\t\t\t\t$.extend(hash, {\tline:\"\",\n\t\t\t\t\t\t \t\t\troot:options.root,\n\t\t\t\t\t\t\t\t\ttextarea:textarea,\n\t\t\t\t\t\t\t\t\tselection:(selection||''),\n\t\t\t\t\t\t\t\t\tcaretPosition:caretPosition,\n\t\t\t\t\t\t\t\t\tctrlKey:ctrlKey,\n\t\t\t\t\t\t\t\t\tshiftKey:shiftKey,\n\t\t\t\t\t\t\t\t\taltKey:altKey\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t// callbacks before insertion\n\t\t\t\tprepare(options.beforeInsert);\n\t\t\t\tprepare(clicked.beforeInsert);\n\t\t\t\tif ((ctrlKey === true && shiftKey === true) || button.multiline === true) {\n\t\t\t\t\tprepare(clicked.beforeMultiInsert);\n\t\t\t\t}\n\t\t\t\t$.extend(hash, { line:1 });\n\n\t\t\t\tif ((ctrlKey === true && shiftKey === true)) {\n\t\t\t\t\tlines = selection.split(/\\r?\\n/);\n\t\t\t\t\tfor (j = 0, n = lines.length, i = 0; i < n; i++) {\n\t\t\t\t\t\tif ($.trim(lines[i]) !== '') {\n\t\t\t\t\t\t\t$.extend(hash, { line:++j, selection:lines[i] } );\n\t\t\t\t\t\t\tlines[i] = build(lines[i]).block;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlines[i] = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tstring = { block:lines.join('\\n')};\n\t\t\t\t\tstart = caretPosition;\n\t\t\t\t\tlen = string.block.length + ((browser.opera) ? n-1 : 0);\n\t\t\t\t} else if (ctrlKey === true) {\n\t\t\t\t\tstring = build(selection);\n\t\t\t\t\tstart = caretPosition + string.openWith.length;\n\t\t\t\t\tlen = string.block.length - string.openWith.length - string.closeWith.length;\n\t\t\t\t\tlen = len - (string.block.match(/ $/) ? 1 : 0);\n\t\t\t\t\tlen -= fixIeBug(string.block);\n\t\t\t\t} else if (shiftKey === true) {\n\t\t\t\t\tstring = build(selection);\n\t\t\t\t\tstart = caretPosition;\n\t\t\t\t\tlen = string.block.length;\n\t\t\t\t\tlen -= fixIeBug(string.block);\n\t\t\t\t} else {\n\t\t\t\t\tstring = build(selection);\n\t\t\t\t\tstart = caretPosition + string.block.length ;\n\t\t\t\t\tlen = 0;\n\t\t\t\t\tstart -= fixIeBug(string.block);\n\t\t\t\t}\n\t\t\t\tif ((selection === '' && string.replaceWith === '')) {\n\t\t\t\t\tcaretOffset += fixOperaBug(string.block);\n\n\t\t\t\t\tstart = caretPosition + string.openBlockWith.length + string.openWith.length;\n\t\t\t\t\tlen = string.block.length - string.openBlockWith.length - string.openWith.length - string.closeWith.length - string.closeBlockWith.length;\n\n\t\t\t\t\tcaretOffset = $$.val().substring(caretPosition,  $$.val().length).length;\n\t\t\t\t\tcaretOffset -= fixOperaBug($$.val().substring(0, caretPosition));\n\t\t\t\t}\n\t\t\t\t$.extend(hash, { caretPosition:caretPosition, scrollPosition:scrollPosition } );\n\n\t\t\t\tif (string.block !== selection && abort === false) {\n\t\t\t\t\tinsert(string.block);\n\t\t\t\t\tset(start, len);\n\t\t\t\t} else {\n\t\t\t\t\tcaretOffset = -1;\n\t\t\t\t}\n\t\t\t\tget();\n\n\t\t\t\t$.extend(hash, { line:'', selection:selection });\n\n\t\t\t\t// callbacks after insertion\n\t\t\t\tif ((ctrlKey === true && shiftKey === true) || button.multiline === true) {\n\t\t\t\t\tprepare(clicked.afterMultiInsert);\n\t\t\t\t}\n\t\t\t\tprepare(clicked.afterInsert);\n\t\t\t\tprepare(options.afterInsert);\n\n\t\t\t\t// refresh preview if opened\n\t\t\t\tif (previewWindow && options.previewAutoRefresh) {\n\t\t\t\t\trefreshPreview();\n\t\t\t\t}\n\n\t\t\t\t// reinit keyevent\n\t\t\t\tshiftKey = altKey = ctrlKey = abort = false;\n\t\t\t}\n\n\t\t\t// Substract linefeed in Opera\n\t\t\tfunction fixOperaBug(string) {\n\t\t\t\tif (browser.opera) {\n\t\t\t\t\treturn string.length - string.replace(/\\n*/g, '').length;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t// Substract linefeed in IE\n\t\t\tfunction fixIeBug(string) {\n\t\t\t\tif (browser.msie) {\n\t\t\t\t\treturn string.length - string.replace(/\\r*/g, '').length;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\t// add markup\n\t\t\tfunction insert(block) {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\tvar newSelection = document.selection.createRange();\n\t\t\t\t\tnewSelection.text = block;\n\t\t\t\t} else {\n\t\t\t\t\ttextarea.value =  textarea.value.substring(0, caretPosition)  + block + textarea.value.substring(caretPosition + selection.length, textarea.value.length);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// set a selection\n\t\t\tfunction set(start, len) {\n\t\t\t\tif (textarea.createTextRange){\n\t\t\t\t\t// quick fix to make it work on Opera 9.5\n\t\t\t\t\tif (browser.opera && browser.version >= 9.5 && len == 0) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\trange = textarea.createTextRange();\n\t\t\t\t\trange.collapse(true);\n\t\t\t\t\trange.moveStart('character', start);\n\t\t\t\t\trange.moveEnd('character', len);\n\t\t\t\t\trange.select();\n\t\t\t\t} else if (textarea.setSelectionRange ){\n\t\t\t\t\ttextarea.setSelectionRange(start, start + len);\n\t\t\t\t}\n\t\t\t\ttextarea.scrollTop = scrollPosition;\n\t\t\t\ttextarea.focus();\n\t\t\t}\n\n\t\t\t// get the selection\n\t\t\tfunction get() {\n\t\t\t\ttextarea.focus();\n\n\t\t\t\tscrollPosition = textarea.scrollTop;\n\t\t\t\tif (document.selection) {\n\t\t\t\t\tselection = document.selection.createRange().text;\n\t\t\t\t\tif (browser.msie) { // ie\n\t\t\t\t\t\tvar range = document.selection.createRange(), rangeCopy = range.duplicate();\n\t\t\t\t\t\trangeCopy.moveToElementText(textarea);\n\t\t\t\t\t\tcaretPosition = -1;\n\t\t\t\t\t\twhile(rangeCopy.inRange(range)) {\n\t\t\t\t\t\t\trangeCopy.moveStart('character');\n\t\t\t\t\t\t\tcaretPosition ++;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else { // opera\n\t\t\t\t\t\tcaretPosition = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t} else { // gecko & webkit\n\t\t\t\t\tcaretPosition = textarea.selectionStart;\n\n\t\t\t\t\tselection = textarea.value.substring(caretPosition, textarea.selectionEnd);\n\t\t\t\t}\n\t\t\t\treturn selection;\n\t\t\t}\n\n\t\t\t// open preview window\n\t\t\tfunction preview() {\n\t\t\t\tif (typeof options.previewHandler === 'function') {\n\t\t\t\t\tpreviewWindow = true;\n\t\t\t\t} else if (options.previewInElement) {\n\t\t\t\t\tpreviewWindow = $(options.previewInElement);\n\t\t\t\t} else if (!previewWindow || previewWindow.closed) {\n\t\t\t\t\tif (options.previewInWindow) {\n\t\t\t\t\t\tpreviewWindow = window.open('', 'preview', options.previewInWindow);\n\t\t\t\t\t\t$(window).unload(function() {\n\t\t\t\t\t\t\tpreviewWindow.close();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tiFrame = $('<iframe class=\"markItUpPreviewFrame\"></iframe>');\n\t\t\t\t\t\tif (options.previewPosition == 'after') {\n\t\t\t\t\t\t\tiFrame.insertAfter(footer);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tiFrame.insertBefore(header);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpreviewWindow = iFrame[iFrame.length - 1].contentWindow || frame[iFrame.length - 1];\n\t\t\t\t\t}\n\t\t\t\t} else if (altKey === true) {\n\t\t\t\t\tif (iFrame) {\n\t\t\t\t\t\tiFrame.remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpreviewWindow.close();\n\t\t\t\t\t}\n\t\t\t\t\tpreviewWindow = iFrame = false;\n\t\t\t\t}\n\t\t\t\tif (!options.previewAutoRefresh) {\n\t\t\t\t\trefreshPreview();\n\t\t\t\t}\n\t\t\t\tif (options.previewInWindow) {\n\t\t\t\t\tpreviewWindow.focus();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// refresh Preview window\n\t\t\tfunction refreshPreview() {\n \t\t\t\trenderPreview();\n\t\t\t}\n\n\t\t\tfunction renderPreview() {\n\t\t\t\tvar phtml;\n\t\t\t\tif (options.previewHandler && typeof options.previewHandler === 'function') {\n\t\t\t\t\toptions.previewHandler( $$.val() );\n\t\t\t\t} else if (options.previewParser && typeof options.previewParser === 'function') {\n\t\t\t\t\tvar data = options.previewParser( $$.val() );\n\t\t\t\t\twriteInPreview(localize(data, 1) );\n\t\t\t\t} else if (options.previewParserPath !== '') {\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\tdataType: 'text',\n\t\t\t\t\t\tglobal: false,\n\t\t\t\t\t\turl: options.previewParserPath,\n\t\t\t\t\t\tdata: options.previewParserVar+'='+encodeURIComponent($$.val()),\n\t\t\t\t\t\tsuccess: function(data) {\n\t\t\t\t\t\t\twriteInPreview( localize(data, 1) );\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tif (!template) {\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: options.previewTemplatePath,\n\t\t\t\t\t\t\tdataType: 'text',\n\t\t\t\t\t\t\tglobal: false,\n\t\t\t\t\t\t\tsuccess: function(data) {\n\t\t\t\t\t\t\t\twriteInPreview( localize(data, 1).replace(/<!-- content -->/g, $$.val()) );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfunction writeInPreview(data) {\n\t\t\t\tif (options.previewInElement) {\n\t\t\t\t\t$(options.previewInElement).html(data);\n\t\t\t\t} else if (previewWindow && previewWindow.document) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tsp = previewWindow.document.documentElement.scrollTop\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tsp = 0;\n\t\t\t\t\t}\n\t\t\t\t\tpreviewWindow.document.open();\n\t\t\t\t\tpreviewWindow.document.write(data);\n\t\t\t\t\tpreviewWindow.document.close();\n\t\t\t\t\tpreviewWindow.document.documentElement.scrollTop = sp;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// set keys pressed\n\t\t\tfunction keyPressed(e) {\n\t\t\t\tshiftKey = e.shiftKey;\n\t\t\t\taltKey = e.altKey;\n\t\t\t\tctrlKey = (!(e.altKey && e.ctrlKey)) ? (e.ctrlKey || e.metaKey) : false;\n\n\t\t\t\tif (e.type === 'keydown') {\n\t\t\t\t\tif (ctrlKey === true) {\n\t\t\t\t\t\tli = $('a[accesskey=\"'+((e.keyCode == 13) ? '\\\\n' : String.fromCharCode(e.keyCode))+'\"]', header).parent('li');\n\t\t\t\t\t\tif (li.length !== 0) {\n\t\t\t\t\t\t\tctrlKey = false;\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tli.triggerHandler('mouseup');\n\t\t\t\t\t\t\t},1);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (e.keyCode === 13 || e.keyCode === 10) { // Enter key\n\t\t\t\t\t\tif (ctrlKey === true) {  // Enter + Ctrl\n\t\t\t\t\t\t\tctrlKey = false;\n\t\t\t\t\t\t\tmarkup(options.onCtrlEnter);\n\t\t\t\t\t\t\treturn options.onCtrlEnter.keepDefault;\n\t\t\t\t\t\t} else if (shiftKey === true) { // Enter + Shift\n\t\t\t\t\t\t\tshiftKey = false;\n\t\t\t\t\t\t\tmarkup(options.onShiftEnter);\n\t\t\t\t\t\t\treturn options.onShiftEnter.keepDefault;\n\t\t\t\t\t\t} else { // only Enter\n\t\t\t\t\t\t\tmarkup(options.onEnter);\n\t\t\t\t\t\t\treturn options.onEnter.keepDefault;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (e.keyCode === 9) { // Tab key\n\t\t\t\t\t\tif (shiftKey == true || ctrlKey == true || altKey == true) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (caretOffset !== -1) {\n\t\t\t\t\t\t\tget();\n\t\t\t\t\t\t\tcaretOffset = $$.val().length - caretOffset;\n\t\t\t\t\t\t\tset(caretOffset, 0);\n\t\t\t\t\t\t\tcaretOffset = -1;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmarkup(options.onTab);\n\t\t\t\t\t\t\treturn options.onTab.keepDefault;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction remove() {\n\t\t\t\t$$.unbind(\".markItUp\").removeClass('markItUpEditor');\n\t\t\t\t$$.parent('div').parent('div.markItUp').parent('div').replaceWith($$);\n\t\t\t\t$$.data('markItUp', null);\n\t\t\t}\n\n\t\t\tinit();\n\t\t});\n\t};\n\n\t$.fn.markItUpRemove = function() {\n\t\treturn this.each(function() {\n\t\t\t\t$(this).markItUp('remove');\n\t\t\t}\n\t\t);\n\t};\n\n\t$.markItUp = function(settings) {\n\t\tvar options = { target:false };\n\t\t$.extend(options, settings);\n\t\tif (options.target) {\n\t\t\treturn $(options.target).each(function() {\n\t\t\t\t$(this).focus();\n\t\t\t\t$(this).trigger('insertion', [options]);\n\t\t\t});\n\t\t} else {\n\t\t\t$('textarea').trigger('insertion', [options]);\n\t\t}\n\t};\n})(jQuery);\n"],"sourceRoot":""}