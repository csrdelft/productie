"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3099],{3099:(e,n,i)=>{i.r(n);var s=i(1339),t=i.n(s),a=i(1518),r=i(5946),o=i(5303);const c=document.getElementsByTagName("meta")["vapid-public-key"].content;let l,d=!1;const u=async e=>{switch(e){case"ja":return await(async()=>{if(!d)return;const e=await Notification.requestPermission();if("denied"===e)throw new Error("The user explicitly denied the permission request.");if("granted"===e&&console.info("The user accepted the permission request."),l=await navigator.serviceWorker.ready,await(null==l?void 0:l.pushManager.getSubscription()))return void console.info("User is already subscribed.");const n={userVisibleOnly:!0,applicationServerKey:(0,r.Mp)(c)},i=await l.pushManager.subscribe(n);if(i)try{const e=await fetch("/push-abonnement",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!e.ok)throw new Error("Bad status code from server.");const n=await e.json();if(!n||!n.success)throw new Error("Bad response from server.");console.info("Successfully subscribed to push notifications.")}catch(e){throw await(null==i?void 0:i.unsubscribe()),e}})();case"nee":return await(async()=>{var e;if(!d)return;l=await navigator.serviceWorker.ready;const n=null!==(e=await(null==l?void 0:l.pushManager.getSubscription()))&&void 0!==e?e:null;if(!n)throw new Error("No existing subscription");const i=await fetch("/push-abonnement",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:n.endpoint})});if(!i.ok)throw new Error("Bad status code from server.");const s=await i.json();if(!s||!s.success)throw new Error("Bad response from server.");await(null==n?void 0:n.unsubscribe())&&console.info("Successfully unsubscribed from push notifications.")})()}};(async()=>{if(!c)return void(d=!1);const e=(0,a.Ys)("#inst_forum_meldingPush_ja"),n=(0,a.Ys)("#inst_forum_meldingPush_nee");if("serviceWorker"in navigator&&"PushManager"in window){l=await navigator.serviceWorker.ready;if(void 0!==l&&"pushManager"in l){if(navigator.userAgent.includes("iPhone")||navigator.userAgent.includes("Macintosh")&&"ontouchend"in document){const e=window.matchMedia("(display-mode: fullscreen)").matches||window.matchMedia("(display-mode: standalone)").matches;d=e}else d=!0}}if(d){await(null==l?void 0:l.pushManager.getSubscription())?e.checked=!0:n.checked=!0}else{(0,a.Ys)("#instelling-forum-meldingPush > div > div.btn-group").setAttribute("title","Push is niet beschikbaar op dit apparaat"),e.disabled=!0,n.disabled=!0,n.checked=!0}})();const h=async e=>{e.preventDefault();const n=e.target;let i=null,s=null;if(n.classList.add("loading"),n instanceof HTMLInputElement||n instanceof HTMLSelectElement){if(!n.checkValidity())return!1;i=n.dataset.href,s=n.value}else n instanceof HTMLAnchorElement&&(i=n.href);if(!i)throw new Error("Geen url gevonden voor instelling");try{if(i.includes("meldingPush")){const e=/meldingPush\/(\w+)/g.exec(i);await u(e[1])}else await t().post(i,{waarde:s}),document.querySelectorAll(".instellingen-bericht").forEach((e=>e.classList.remove("d-none")));n.classList.remove("loading")}catch(e){console.error(e),alert("WP Error: "+e.message)}};o.Z.addHandler(".instellingKnop",(e=>e.addEventListener("click",h))),o.Z.addHandler(".change-opslaan",(e=>e.addEventListener("change",h)))}}]);
//# sourceMappingURL=3099.424b2e22cee58e1f8a30.chunk.js.map