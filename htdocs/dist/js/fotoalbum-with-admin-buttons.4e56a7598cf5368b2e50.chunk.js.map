{"version":3,"sources":["webpack:///./js/lib/domUpdate.ts","webpack:///./js/lib/modal.ts","webpack:///./js/lib/fotoalbum/with-admin-buttons.ts","webpack:///./js/lib/reload.ts"],"names":["domUpdate","htmlString","trim","substring","alert","Error","elements","element","HTMLElement","id","parentId","getAttribute","HTMLScriptElement","eval","innerText","target","document","querySelector","targetParent","classList","contains","replaceWith","append","head","modalOpen","modal","modalBackdrop","html","length","remove","find","trigger","body","modalClose","constructor","albums","params","super","this","root","container","style","color","backgroundColor","background","textColor","transform","content","addEventListener","dropdown","display","rotateClockwiseButton","padding","url","getUrl","a","post","foto","rotation","then","rotateCounterClockwiseButton","setCoverButton","resp","data","deleteButton","confirm","decodeURI","flexDirection","left","position","top","whiteSpace","children","appendChild","appendControlsElements","item","currentItem","goToItem","fullUrl","replace","reload","location","redirect","window","href"],"mappings":"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","file":"js/fotoalbum-with-admin-buttons.4e56a7598cf5368b2e50.chunk.js","sourcesContent":["import $ from 'jquery';\nimport { init } from '../ctx';\nimport { modalClose, modalOpen } from './modal';\nimport { fadeAway, htmlParse } from './util';\nimport { select } from \"./dom\";\nexport function domUpdate(htmlString) {\n    if (typeof htmlString !== 'string') {\n        return;\n    }\n    htmlString = htmlString.trim();\n    if (htmlString.substring(0, 9) === '<!DOCTYPE') {\n        alert('response error');\n        throw new Error(htmlString);\n    }\n    const elements = htmlParse(htmlString);\n    for (const element of elements) {\n        if (!(element instanceof HTMLElement)) {\n            // element kan ook een stuk tekst zijn, hier kunnen we niets mee.\n            continue;\n        }\n        const id = element.id;\n        const parentId = element.getAttribute('parentid');\n        if (!id && element instanceof HTMLScriptElement) {\n            eval(element.innerText);\n            modalClose();\n            return;\n        }\n        // Probeer niet een lege id te laden.\n        const target = id ? document.querySelector(`#${id}`) : null;\n        const targetParent = parentId ? document.querySelector(`#${parentId}`) : null;\n        if (target) {\n            if (element.classList.contains('remove')) {\n                fadeAway(target, 400);\n            }\n            else {\n                // Jquery voert ook js uit, dat is nodig op dit moment voor forms\n                $(target).replaceWith($(element));\n            }\n        }\n        else if (targetParent) {\n            targetParent.append(element);\n        }\n        else if (element instanceof HTMLScriptElement) {\n            document.head.append(element);\n        }\n        else {\n            select('#maalcie-tabel tbody:visible:first').append(element); // FIXME: make generic\n        }\n        init(element);\n        if (id === 'modal') {\n            modalOpen();\n        }\n        else {\n            modalClose();\n        }\n    }\n}\n","import $ from 'jquery';\nexport function modalOpen(htmlString = '') {\n    const modal = $('#modal');\n    const modalBackdrop = $('.modal-backdrop');\n    if (modal.html() === '' && htmlString === '') {\n        return false;\n    }\n    if (modalBackdrop.length) {\n        modalBackdrop.remove();\n    }\n    if (htmlString !== '') {\n        modal.replaceWith(htmlString);\n        modal.find('input:visible:first').trigger('focus');\n    }\n    modal.modal('show');\n    $(document.body).trigger('modalOpen');\n    return true;\n}\nexport function modalClose() {\n    $('#modal').modal('hide');\n    $(document.body).trigger('modalClose');\n}\n","import axios from 'axios';\nimport createElement from 'jgallery/src/utils/create-element';\nimport withTooltip from 'jgallery/src/utils/with-tooltip';\nimport { redirect, reload } from '../reload';\nimport { basename, dirname } from '../util';\nconst withAdminButtons = (constructor) => class extends constructor {\n    constructor(albums, params) {\n        super(albums, params);\n        this.root = params.root || '';\n        const container = withTooltip(createElement('<span class=\"j-gallery-icon\"><i class=\"fa fa-wrench\"></i></span>'), {\n            style: {\n                color: params.backgroundColor,\n                background: params.textColor,\n                transform: 'translateY(-8px)',\n            },\n            content: 'Beheer',\n        });\n        container.addEventListener('click', () => {\n            dropdown.style.display = 'flex';\n        });\n        container.addEventListener('mouseleave', () => {\n            dropdown.style.display = 'none';\n        });\n        const rotateClockwiseButton = createElement(`<div><i class=\"fa fa-redo\"></i>&nbsp;Draai met de klok mee</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        rotateClockwiseButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/roteren' + dirname(url), {\n                foto: basename(url),\n                rotation: 90,\n            }).then(reload);\n        });\n        const rotateCounterClockwiseButton = createElement(`<div><i class=\"fa fa-undo\"></i>&nbsp;Draai tegen de klok in</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        rotateCounterClockwiseButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/roteren' + dirname(url), {\n                foto: basename(url),\n                rotation: -90,\n            }).then(reload);\n        });\n        const setCoverButton = createElement(`<div><i class=\"fa fa-folder\"></i>&nbsp;Instellen als albumcover</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        setCoverButton.addEventListener('click', () => {\n            const url = this.getUrl();\n            axios.post('/fotoalbum/albumcover' + dirname(url), {\n                foto: basename(url),\n            }).then((resp) => redirect(resp.data));\n        });\n        const deleteButton = createElement(`<div><i class=\"fa fa-times\"></i>&nbsp;Verwijderen</div>`, {\n            style: {\n                padding: '0.2em',\n            },\n        });\n        deleteButton.addEventListener('click', () => {\n            if (!confirm('Foto definitief verwijderen. Weet u het zeker?')) {\n                return false;\n            }\n            const url = this.getUrl();\n            axios.post('/fotoalbum/verwijderen' + dirname(url), {\n                foto: decodeURI(basename(url)),\n            }).then(reload);\n        });\n        const dropdown = createElement('<div class=\"j-gallery-dropdown\"></div>', {\n            style: {\n                background: params.backgroundColor,\n                display: 'none',\n                flexDirection: 'column',\n                left: '0',\n                position: 'absolute',\n                top: '0',\n                whiteSpace: 'nowrap',\n            },\n            children: [rotateClockwiseButton, rotateCounterClockwiseButton, setCoverButton, deleteButton],\n        });\n        container.appendChild(dropdown);\n        this.appendControlsElements([container]);\n    }\n    goToItem(item) {\n        this.currentItem = item;\n        return super.goToItem(item);\n    }\n    getUrl() {\n        return this.currentItem.fullUrl.replace(this.root, '');\n    }\n};\nexport default withAdminButtons;\n","import { domUpdate } from './domUpdate';\nexport function reload(htmlString) {\n    if (typeof htmlString === 'string' && htmlString.substring(0, 16) === '<div id=\"modal\" ') {\n        domUpdate(htmlString);\n        return;\n    }\n    location.reload();\n}\nexport function redirect(htmlString) {\n    if (htmlString.substring(0, 16) === '<div id=\"modal\" ') {\n        domUpdate(htmlString);\n        return;\n    }\n    window.location.href = htmlString;\n}\n"],"sourceRoot":""}