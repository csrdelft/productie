{"version":3,"sources":["webpack:///./js/lib/dropzone.ts"],"names":["initDropzone","el","naam","accept","deleteUrl","maxsize","coverUrl","existingUrl","dataset","thisDropzone","paramName","url","action","acceptedFiles","addRemoveLinks","removedfile","async","file","a","post","name","previewElement","remove","e","Error","maxFilesize","Number","maxFiles","dictDefaultMessage","dictFallbackMessage","dictFallbackText","dictFileTooBig","dictInvalidFileType","dictResponseError","dictCancelUpload","dictCancelUploadConfirmation","dictRemoveFile","dictRemoveFileConfirmation","dictMaxFilesExceeded","init","this","on","coverBtn","createElement","appendChild","addEventListener","preventDefault","stopPropagation","replaceWith","forEach","className","showExisting","response","value","Object","values","data","mockFile","size","type","emit","thumbnail"],"mappings":"2FAAA,yGAIO,MAAMA,EAAgBC,IACzB,MAAM,KAAEC,EAAI,OAAEC,EAAM,UAAEC,EAAS,QAAEC,EAAO,SAAEC,EAAQ,YAAEC,GAAgBN,EAAGO,QACjEC,EAAe,IAAI,IAASR,EAAI,CAClCS,UAAWR,EACXS,IAAKV,EAAGW,OACRC,cAAeV,EACfW,gBAAgB,EAChBC,YAAaC,eAAgBC,GACzB,UACU,EAAAC,EAAMC,KAAKf,EAAW,QAAUa,EAAKG,MAC3CH,EAAKI,eAAeC,SAExB,MAAOC,GACH,MAAM,IAAIC,MAAMD,KAGxBE,YAAaC,OAAOrB,GACpBsB,SAAU,IACVC,mBAAoB,sCACpBC,oBAAqB,wDACrBC,iBAAkB,kFAClBC,eAAgB,oEAChBC,oBAAqB,+CACrBC,kBAAmB,6CACnBC,iBAAkB,YAClBC,6BAA8B,yCAC9BC,eAAgB,IAChBC,2BAA4B,yCAC5BC,qBAAsB,qCACtBC,KAAM,WACFC,KAAKC,GAAG,aAAa,SAAUxB,GAC3B,MAAMyB,EAAW,IAASC,cAAc,iFACxC1B,EAAKI,eAAeuB,YAAYF,GAChCA,EAASG,iBAAiB,SAAS7B,eAAgBO,GAE/CA,EAAEuB,iBACFvB,EAAEwB,kBACF,UACU,EAAA7B,EAAMC,KAAKb,EAAU,QAAUW,EAAKG,MAC1CsB,EAASM,YAAY,GAAK,yDAE9B,MAAOzB,GACH,MAAM,IAAIC,MAAMD,OAGxB,YAAU,cAAc0B,QAAQhD,GAAMA,EAAGiD,UAAY,aAI3DC,EAAe,GAAK,sFAC1BlD,EAAG2C,YAAYO,GACfA,EAAaN,iBAAiB,SAAS7B,eAAgBO,GACnDA,EAAEuB,iBACFK,EAAa7B,SACb,MAAM8B,QAAiB,EAAAlC,EAAMC,KAAKZ,GAClC,IAAK,MAAM8C,KAASC,OAAOC,OAAOH,EAASI,MAAO,CAC9C,MAAMC,EAAW,CAAErC,KAAMiC,EAAMjC,KAAMsC,KAAML,EAAMK,KAAMC,KAAMN,EAAMM,MACnElD,EAAamD,KAAK,YAAaH,QACA,IAApBJ,EAAMQ,WACbpD,EAAamD,KAAK,YAAaH,EAAUJ,EAAMQ,WAEnDpD,EAAamD,KAAK,WAAYH","file":"js/dropzone.2b2790a37b8006c14a81.chunk.js","sourcesContent":["import axios from 'axios';\nimport Dropzone from \"dropzone\";\nimport { selectAll } from \"./dom\";\nimport { html } from \"./util\";\nexport const initDropzone = (el) => {\n    const { naam, accept, deleteUrl, maxsize, coverUrl, existingUrl } = el.dataset;\n    const thisDropzone = new Dropzone(el, {\n        paramName: naam,\n        url: el.action,\n        acceptedFiles: accept,\n        addRemoveLinks: true,\n        removedfile: async function (file) {\n            try {\n                await axios.post(deleteUrl, \"foto=\" + file.name);\n                file.previewElement.remove();\n            }\n            catch (e) {\n                throw new Error(e);\n            }\n        },\n        maxFilesize: Number(maxsize),\n        maxFiles: 500,\n        dictDefaultMessage: \"Sleep hier bestanden om te uploaden\",\n        dictFallbackMessage: \"Je browser ondersteund niet het slepen van bestanden.\",\n        dictFallbackText: \"Please use the fallback form below to upload your files like in the olden days.\",\n        dictFileTooBig: \"Te groot bestand: ({{filesize}}MiB). Maximum: {{maxFilesize}}MiB.\",\n        dictInvalidFileType: \"Bestanden van dit type zijn niet toegestaan.\",\n        dictResponseError: \"Server responded with {{statusCode}} code.\",\n        dictCancelUpload: \"Annuleren\",\n        dictCancelUploadConfirmation: \"Toevoegen annuleren. Weet u het zeker?\",\n        dictRemoveFile: \"X\",\n        dictRemoveFileConfirmation: \"Bestand verwijderen. Weet u het zeker?\",\n        dictMaxFilesExceeded: \"You can not upload any more files.\",\n        init: function () {\n            this.on('addedfile', function (file) {\n                const coverBtn = Dropzone.createElement('<a class=\"btn\" title=\"Stel deze foto in als omslag voor het album\">Omslag</a>');\n                file.previewElement.appendChild(coverBtn);\n                coverBtn.addEventListener('click', async function (e) {\n                    // Make sure the button click doesn't submit the form\n                    e.preventDefault();\n                    e.stopPropagation();\n                    try {\n                        await axios.post(coverUrl, 'foto=' + file.name);\n                        coverBtn.replaceWith(html `<span><span class=\"fa fa-check\"></span> Omslag</span>`);\n                    }\n                    catch (e) {\n                        throw new Error(e);\n                    }\n                });\n                selectAll('.dz-remove').forEach(el => el.className = 'btn');\n            });\n        }\n    });\n    const showExisting = html `<a href=\"#\"><span class=\"ico photos\"></span> Toon bestaande foto's in dit album</a>`;\n    el.appendChild(showExisting);\n    showExisting.addEventListener('click', async function (e) {\n        e.preventDefault();\n        showExisting.remove();\n        const response = await axios.post(existingUrl);\n        for (const value of Object.values(response.data)) {\n            const mockFile = { name: value.name, size: value.size, type: value.type };\n            thisDropzone.emit('addedfile', mockFile);\n            if (typeof value.thumbnail !== 'undefined') {\n                thisDropzone.emit('thumbnail', mockFile, value.thumbnail);\n            }\n            thisDropzone.emit('complete', mockFile);\n        }\n    });\n};\n"],"sourceRoot":""}