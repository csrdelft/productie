{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////home/travis/build/csrdelft/csrdelft.nl/node_modules/clippyjs/dist/clippy.esm.js","webpack:///./js/entry/fxclippy.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","28","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Queue","onEmptyCallback","this","_queue","_onEmptyCallback","queue","func","_active","_progressQueue","f","proxy","next","clear","el","path","sounds","_el","_data","_path","_currentFrameIndex","_currentFrame","undefined","_exiting","_currentAnimation","_endCallback","_started","_sounds","currentAnimationName","preloadSounds","_overlays","curr","_setupElement","overlayCount","inner","append","frameSize","framesize","css","width","height","animations","snd","uri","Audio","hasAnimation","exitAnimation","showAnimation","animationName","stateChangeCallback","_step","_draw","images","xy","bg","_getNextAnimationFrame","currentFrame","branching","exitBranch","rnd","Math","random","branches","branch","weight","frameIndex","_playSound","sound","audio","play","_atLastFrame","frames","newFrameIndex","min","frameChanged","useExitBranching","_loop","setTimeout","duration","States","WAITING","EXITED","pause","clearTimeout","resume","Balloon","targetEl","_targetEl","_hidden","_setup","WORD_SPEAK_TIME","CLOSE_BALLOON_DELAY","_BALLOON_MARGIN","_balloon","hide","_content","find","document","body","reposition","sides","_position","_isOut","side","offset","h","w","top","scrollTop","left","scrollLeft","bH","outerHeight","bW","outerWidth","removeClass","addClass","wW","wH","sT","sL","speak","complete","text","hold","show","_complete","_sayWords","fast","_hiding","_finishHideBalloon","_hold","words","split","time","idx","_addWord","join","close","_onQueueEmpty","_animator","_setupEvents","gestureAt","x","y","_getDirection","gAnim","lookAnim","animation","callback","stop","_playInternal","moveTo","anim","_addToQueue","state","animate","_isIdleAnimation","_idleDfd","done","timeout","cb","completed","closeBalloon","delay","stopCurrent","floor","indexOf","centerX","a","b","round","atan2","PI","idleAnim","_getIdleAnimation","Deferred","_onIdleComplete","resolve","on","_onMouseDown","_onDoubleClick","is","e","preventDefault","_startDrag","_offset","_calculateClickOffset","_moveHandle","_dragMove","_upHandle","_finishDrag","_dragUpdateLoop","_updateLocation","mouseX","pageX","mouseY","pageY","_targetY","_targetX","clientX","clientY","off","scope","load","successCb","failCb","base_path","CLIPPY_CDN","mapDfd","_loadMap","agentDfd","_loadAgent","soundsDfd","_loadSounds","when","fail","dfd","_maps","src","img","Image","onload","onerror","reject","setAttribute","promise","createElement","canPlayMp3","canPlayType","canPlayOgg","_loadScript","_getAgentDfd","script","head","appendChild","clippy","Agent","Animator","ready","soundsReady","sleep","ms","Promise","rect","centerY","randomElement","array","rules","addRule","options","assign","$","assistant","ASSISTENT","geenGeluiden","ASSISTENT_GELUIDEN","welcomeMessages","async","agent","viewPort","documentElement","clientHeight","clientWidth","message","sessionStorage","getItem","setItem","foundOne","forEach","rule","noOther","messageCondition","location","pathname","startsWith","probability","setInterval","pasfoto","pasfotoLoaded","box","then","event","target","getBoundingClientRect","bottom","one","right","max","wolkenKnop","evaluate","XPathResult","ORDERED_NODE_SNAPSHOT_TYPE","snapshotItem","$wolkenKnop","element","elOffset","viewportTop","viewportBottom","isInViewport","loc","writing","availableAnimations","filter","laatsteWoord","toLowerCase","ketzerLinkLoc","direction","gestureAnim","times","amount","parseInt","extensie","extOffset","scrollIntoView","behavior","block","toString"],"mappings":"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","file":"js/fxclippy.40eb4d59a94b859a020a.bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t28: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([156,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import $ from 'jquery';\n\nvar Queue = function Queue (onEmptyCallback) {\n    this._queue = [];\n    this._onEmptyCallback = onEmptyCallback;\n};\n\n/***\n *\n * @param {function(Function)} func\n * @returns {jQuery.Deferred}\n */\nQueue.prototype.queue = function queue (func) {\n    this._queue.push(func);\n\n    if (this._queue.length === 1 && !this._active) {\n        this._progressQueue();\n    }\n};\n\nQueue.prototype._progressQueue = function _progressQueue () {\n\n    // stop if nothing left in queue\n    if (!this._queue.length) {\n        this._onEmptyCallback();\n        return;\n    }\n\n    var f = this._queue.shift();\n    this._active = true;\n\n    // execute function\n    var completeFunction = $.proxy(this.next, this);\n    f(completeFunction);\n};\n\nQueue.prototype.clear = function clear () {\n    this._queue = [];\n};\n\nQueue.prototype.next = function next () {\n    this._active = false;\n    this._progressQueue();\n};\n\nvar Animator = function Animator (el, path, data, sounds) {\n    var this$1 = this;\n\n    this._el = el;\n    this._data = data;\n    this._path = path;\n    this._currentFrameIndex = 0;\n    this._currentFrame = undefined;\n    this._exiting = false;\n    this._currentAnimation = undefined;\n    this._endCallback = undefined;\n    this._started = false;\n    this._sounds = {};\n    this.currentAnimationName = undefined;\n    this.preloadSounds(sounds);\n    this._overlays = [this._el];\n    var curr = this._el;\n\n    this._setupElement(this._el);\n    for (var i = 1; i < this._data.overlayCount; i++) {\n        var inner = this$1._setupElement($('<div></div>'));\n        curr.append(inner);\n        this$1._overlays.push(inner);\n        curr = inner;\n    }\n};\n\nAnimator.prototype._setupElement = function _setupElement (el) {\n    var frameSize = this._data.framesize;\n    el.css('display', \"none\");\n    el.css({ width: frameSize[0], height: frameSize[1] });\n    el.css('background', \"url('\" + this._path + \"/map.png') no-repeat\");\n\n    return el;\n};\n\nAnimator.prototype.animations = function animations () {\n    var r = [];\n    var d = this._data.animations;\n    for (var n in d) {\n        r.push(n);\n    }\n    return r;\n};\n\nAnimator.prototype.preloadSounds = function preloadSounds (sounds) {\n        var this$1 = this;\n\n\n    for (var i = 0; i < this._data.sounds.length; i++) {\n        var snd = this$1._data.sounds[i];\n        var uri = sounds[snd];\n        if (!uri) { continue; }\n        this$1._sounds[snd] = new Audio(uri);\n\n    }\n};\n\nAnimator.prototype.hasAnimation = function hasAnimation (name) {\n    return !!this._data.animations[name];\n};\n\nAnimator.prototype.exitAnimation = function exitAnimation () {\n    this._exiting = true;\n};\n\nAnimator.prototype.showAnimation = function showAnimation (animationName, stateChangeCallback) {\n    this._exiting = false;\n\n    if (!this.hasAnimation(animationName)) {\n        return false;\n    }\n\n    this._currentAnimation = this._data.animations[animationName];\n    this.currentAnimationName = animationName;\n\n\n    if (!this._started) {\n        this._step();\n        this._started = true;\n    }\n\n    this._currentFrameIndex = 0;\n    this._currentFrame = undefined;\n    this._endCallback = stateChangeCallback;\n\n    return true;\n};\n\nAnimator.prototype._draw = function _draw () {\n        var this$1 = this;\n\n    var images = [];\n    if (this._currentFrame) { images = this._currentFrame.images || []; }\n\n    for (var i = 0; i < this._overlays.length; i++) {\n        if (i < images.length) {\n            var xy = images[i];\n            var bg = -xy[0] + 'px ' + -xy[1] + 'px';\n            this$1._overlays[i].css({ 'background-position': bg, 'display': 'block' });\n        }\n        else {\n            this$1._overlays[i].css('display', 'none');\n        }\n\n    }\n};\n\nAnimator.prototype._getNextAnimationFrame = function _getNextAnimationFrame () {\n    if (!this._currentAnimation) { return undefined; }\n    // No current frame. start animation.\n    if (!this._currentFrame) { return 0; }\n    var currentFrame = this._currentFrame;\n    var branching = this._currentFrame.branching;\n\n\n    if (this._exiting && currentFrame.exitBranch !== undefined) {\n        return currentFrame.exitBranch;\n    }\n    else if (branching) {\n        var rnd = Math.random() * 100;\n        for (var i = 0; i < branching.branches.length; i++) {\n            var branch = branching.branches[i];\n            if (rnd <= branch.weight) {\n                return branch.frameIndex;\n            }\n\n            rnd -= branch.weight;\n        }\n    }\n\n    return this._currentFrameIndex + 1;\n};\n\n\nAnimator.prototype._playSound = function _playSound () {\n    var s = this._currentFrame.sound;\n    if (!s) { return; }\n    var audio = this._sounds[s];\n    if (audio) { audio.play(); }\n};\n\nAnimator.prototype._atLastFrame = function _atLastFrame () {\n    return this._currentFrameIndex >= this._currentAnimation.frames.length - 1;\n};\n\n\nAnimator.prototype._step = function _step () {\n    if (!this._currentAnimation) { return; }\n    var newFrameIndex = Math.min(this._getNextAnimationFrame(), this._currentAnimation.frames.length - 1);\n    var frameChanged = !this._currentFrame || this._currentFrameIndex !== newFrameIndex;\n    this._currentFrameIndex = newFrameIndex;\n\n    // always switch frame data, unless we're at the last frame of an animation with a useExitBranching flag.\n    if (!(this._atLastFrame() && this._currentAnimation.useExitBranching)) {\n        this._currentFrame = this._currentAnimation.frames[this._currentFrameIndex];\n    }\n\n    this._draw();\n    this._playSound();\n\n    this._loop = window.setTimeout($.proxy(this._step, this), this._currentFrame.duration);\n\n\n    // fire events if the frames changed and we reached an end\n    if (this._endCallback && frameChanged && this._atLastFrame()) {\n        if (this._currentAnimation.useExitBranching && !this._exiting) {\n            this._endCallback(this.currentAnimationName, Animator.States.WAITING);\n        }\n        else {\n            this._endCallback(this.currentAnimationName, Animator.States.EXITED);\n        }\n    }\n};\n\n/***\n * Pause animation execution\n */\nAnimator.prototype.pause = function pause () {\n    window.clearTimeout(this._loop);\n};\n\n/***\n * Resume animation\n */\nAnimator.prototype.resume = function resume () {\n    this._step();\n};\n\nAnimator.States = { WAITING: 1, EXITED: 0 };\n\nvar Balloon = function Balloon (targetEl) {\n    this._targetEl = targetEl;\n\n    this._hidden = true;\n    this._setup();\n    this.WORD_SPEAK_TIME = 200;\n    this.CLOSE_BALLOON_DELAY = 2000;\n    this._BALLOON_MARGIN = 15;\n};\n\nBalloon.prototype._setup = function _setup () {\n\n    this._balloon = $('<div class=\"clippy-balloon\"><div class=\"clippy-tip\"></div><div class=\"clippy-content\"></div></div> ').hide();\n    this._content = this._balloon.find('.clippy-content');\n\n    $(document.body).append(this._balloon);\n};\n\nBalloon.prototype.reposition = function reposition () {\n        var this$1 = this;\n\n    var sides = ['top-left', 'top-right', 'bottom-left', 'bottom-right'];\n\n    for (var i = 0; i < sides.length; i++) {\n        var s = sides[i];\n        this$1._position(s);\n        if (!this$1._isOut()) { break; }\n    }\n};\n\n/***\n *\n * @param side\n * @private\n */\nBalloon.prototype._position = function _position (side) {\n    var o = this._targetEl.offset();\n    var h = this._targetEl.height();\n    var w = this._targetEl.width();\n    o.top -= $(window).scrollTop();\n    o.left -= $(window).scrollLeft();\n\n    var bH = this._balloon.outerHeight();\n    var bW = this._balloon.outerWidth();\n\n    this._balloon.removeClass('clippy-top-left');\n    this._balloon.removeClass('clippy-top-right');\n    this._balloon.removeClass('clippy-bottom-right');\n    this._balloon.removeClass('clippy-bottom-left');\n\n    var left, top;\n    switch (side) {\n        case 'top-left':\n            // right side of the balloon next to the right side of the agent\n            left = o.left + w - bW;\n            top = o.top - bH - this._BALLOON_MARGIN;\n            break;\n        case 'top-right':\n            // left side of the balloon next to the left side of the agent\n            left = o.left;\n            top = o.top - bH - this._BALLOON_MARGIN;\n            break;\n        case 'bottom-right':\n            // right side of the balloon next to the right side of the agent\n            left = o.left;\n            top = o.top + h + this._BALLOON_MARGIN;\n            break;\n        case 'bottom-left':\n            // left side of the balloon next to the left side of the agent\n            left = o.left + w - bW;\n            top = o.top + h + this._BALLOON_MARGIN;\n            break;\n    }\n\n    this._balloon.css({ top: top, left: left });\n    this._balloon.addClass('clippy-' + side);\n};\n\nBalloon.prototype._isOut = function _isOut () {\n    var o = this._balloon.offset();\n    var bH = this._balloon.outerHeight();\n    var bW = this._balloon.outerWidth();\n\n    var wW = $(window).width();\n    var wH = $(window).height();\n    var sT = $(document).scrollTop();\n    var sL = $(document).scrollLeft();\n\n    var top = o.top - sT;\n    var left = o.left - sL;\n    var m = 5;\n    if (top - m < 0 || left - m < 0) { return true; }\n    return (top + bH + m) > wH || (left + bW + m) > wW;\n};\n\nBalloon.prototype.speak = function speak (complete, text, hold) {\n    this._hidden = false;\n    this.show();\n    var c = this._content;\n    // set height to auto\n    c.height('auto');\n    c.width('auto');\n    // add the text\n    c.text(text);\n    // set height\n    c.height(c.height());\n    c.width(c.width());\n    c.text('');\n    this.reposition();\n\n    this._complete = complete;\n    this._sayWords(text, hold, complete);\n};\n\nBalloon.prototype.show = function show () {\n    if (this._hidden) { return; }\n    this._balloon.show();\n};\n\nBalloon.prototype.hide = function hide (fast) {\n    if (fast) {\n        this._balloon.hide();\n        return;\n    }\n\n    this._hiding = window.setTimeout($.proxy(this._finishHideBalloon, this), this.CLOSE_BALLOON_DELAY);\n};\n\nBalloon.prototype._finishHideBalloon = function _finishHideBalloon () {\n    if (this._active) { return; }\n    this._balloon.hide();\n    this._hidden = true;\n    this._hiding = null;\n};\n\nBalloon.prototype._sayWords = function _sayWords (text, hold, complete) {\n    this._active = true;\n    this._hold = hold;\n    var words = text.split(/[^\\S-]/);\n    var time = this.WORD_SPEAK_TIME;\n    var el = this._content;\n    var idx = 1;\n\n\n    this._addWord = $.proxy(function () {\n        if (!this._active) { return; }\n        if (idx > words.length) {\n            delete this._addWord;\n            this._active = false;\n            if (!this._hold) {\n                complete();\n                this.hide();\n            }\n        } else {\n            el.text(words.slice(0, idx).join(' '));\n            idx++;\n            this._loop = window.setTimeout($.proxy(this._addWord, this), time);\n        }\n    }, this);\n\n    this._addWord();\n\n};\n\nBalloon.prototype.close = function close () {\n    if (this._active) {\n        this._hold = false;\n    } else if (this._hold) {\n        this._complete();\n    }\n};\n\nBalloon.prototype.pause = function pause () {\n    window.clearTimeout(this._loop);\n    if (this._hiding) {\n        window.clearTimeout(this._hiding);\n        this._hiding = null;\n    }\n};\n\nBalloon.prototype.resume = function resume () {\n    if (this._addWord) {\n        this._addWord();\n    } else if (!this._hold && !this._hidden) {\n        this._hiding = window.setTimeout($.proxy(this._finishHideBalloon, this), this.CLOSE_BALLOON_DELAY);\n    }\n};\n\nvar Agent = function Agent (path,data,sounds) {\n    this.path = path;\n\n    this._queue = new Queue($.proxy(this._onQueueEmpty, this));\n\n    this._el = $('<div class=\"clippy\"></div>').hide();\n\n    $(document.body).append(this._el);\n\n    this._animator = new Animator(this._el, path, data, sounds);\n\n    this._balloon = new Balloon(this._el);\n\n    this._setupEvents();\n};\n\n/***\n *\n * @param {Number} x\n * @param {Number} y\n */\nAgent.prototype.gestureAt = function gestureAt (x, y) {\n    var d = this._getDirection(x, y);\n    var gAnim = 'Gesture' + d;\n    var lookAnim = 'Look' + d;\n\n    var animation = this.hasAnimation(gAnim) ? gAnim : lookAnim;\n    return this.play(animation);\n};\n\n/***\n *\n * @param {Boolean=} fast\n *\n */\nAgent.prototype.hide = function hide (fast, callback) {\n    this._hidden = true;\n    var el = this._el;\n    this.stop();\n    if (fast) {\n        this._el.hide();\n        this.stop();\n        this.pause();\n        if (callback) { callback(); }\n        return;\n    }\n\n    return this._playInternal('Hide', function () {\n        el.hide();\n        this.pause();\n        if (callback) { callback(); }\n    })\n};\n\n\nAgent.prototype.moveTo = function moveTo (x, y, duration) {\n    var dir = this._getDirection(x, y);\n    var anim = 'Move' + dir;\n    if (duration === undefined) { duration = 1000; }\n\n    this._addToQueue(function (complete) {\n        // the simple case\n        if (duration === 0) {\n            this._el.css({ top: y, left: x });\n            this.reposition();\n            complete();\n            return;\n        }\n\n        // no animations\n        if (!this.hasAnimation(anim)) {\n            this._el.animate({ top: y, left: x }, duration, complete);\n            return;\n        }\n\n        var callback = $.proxy(function (name, state) {\n            // when exited, complete\n            if (state === Animator.States.EXITED) {\n                complete();\n            }\n            // if waiting,\n            if (state === Animator.States.WAITING) {\n                this._el.animate({ top: y, left: x }, duration, $.proxy(function () {\n                    // after we're done with the movement, do the exit animation\n                    this._animator.exitAnimation();\n                }, this));\n            }\n\n        }, this);\n\n        this._playInternal(anim, callback);\n    }, this);\n};\n\nAgent.prototype._playInternal = function _playInternal (animation, callback) {\n\n    // if we're inside an idle animation,\n    if (this._isIdleAnimation() && this._idleDfd && this._idleDfd.state() === 'pending') {\n        this._idleDfd.done($.proxy(function () {\n            this._playInternal(animation, callback);\n        }, this));\n    }\n\n    this._animator.showAnimation(animation, callback);\n};\n\nAgent.prototype.play = function play (animation, timeout, cb) {\n    if (!this.hasAnimation(animation)) { return false; }\n\n    if (timeout === undefined) { timeout = 5000; }\n\n\n    this._addToQueue(function (complete) {\n        var completed = false;\n        // handle callback\n        var callback = function (name, state) {\n            if (state === Animator.States.EXITED) {\n                completed = true;\n                if (cb) { cb(); }\n                complete();\n            }\n        };\n\n        // if has timeout, register a timeout function\n        if (timeout) {\n            window.setTimeout($.proxy(function () {\n                if (completed) { return; }\n                // exit after timeout\n                this._animator.exitAnimation();\n            }, this), timeout);\n        }\n\n        this._playInternal(animation, callback);\n    }, this);\n\n    return true;\n};\n\n/***\n *\n * @param {Boolean=} fast\n */\nAgent.prototype.show = function show (fast) {\n\n    this._hidden = false;\n    if (fast) {\n        this._el.show();\n        this.resume();\n        this._onQueueEmpty();\n        return;\n    }\n\n    if (this._el.css('top') === 'auto' || !this._el.css('left') === 'auto') {\n        var left = $(window).width() * 0.8;\n        var top = ($(window).height() + $(document).scrollTop()) * 0.8;\n        this._el.css({ top: top, left: left });\n    }\n\n    this.resume();\n    return this.play('Show');\n};\n\n/***\n *\n * @param {String} text\n */\nAgent.prototype.speak = function speak (text, hold) {\n    this._addToQueue(function (complete) {\n        this._balloon.speak(complete, text, hold);\n    }, this);\n};\n\n\n/***\n * Close the current balloon\n */\nAgent.prototype.closeBalloon = function closeBalloon () {\n    this._balloon.hide();\n};\n\nAgent.prototype.delay = function delay (time) {\n    time = time || 250;\n\n    this._addToQueue(function (complete) {\n        this._onQueueEmpty();\n        window.setTimeout(complete, time);\n    });\n};\n\n/***\n * Skips the current animation\n */\nAgent.prototype.stopCurrent = function stopCurrent () {\n    this._animator.exitAnimation();\n    this._balloon.close();\n};\n\n\nAgent.prototype.stop = function stop () {\n    // clear the queue\n    this._queue.clear();\n    this._animator.exitAnimation();\n    this._balloon.hide();\n};\n\n/***\n *\n * @param {String} name\n * @returns {Boolean}\n */\nAgent.prototype.hasAnimation = function hasAnimation (name) {\n    return this._animator.hasAnimation(name);\n};\n\n/***\n * Gets a list of animation names\n *\n * @return {Array.<string>}\n */\nAgent.prototype.animations = function animations () {\n    return this._animator.animations();\n};\n\n/***\n * Play a random animation\n * @return {jQuery.Deferred}\n */\nAgent.prototype.animate = function animate () {\n    var animations = this.animations();\n    var anim = animations[Math.floor(Math.random() * animations.length)];\n    // skip idle animations\n    if (anim.indexOf('Idle') === 0) {\n        return this.animate();\n    }\n    return this.play(anim);\n};\n\n/**************************** Utils ************************************/\n\n/***\n *\n * @param {Number} x\n * @param {Number} y\n * @return {String}\n * @private\n */\nAgent.prototype._getDirection = function _getDirection (x, y) {\n    var offset = this._el.offset();\n    var h = this._el.height();\n    var w = this._el.width();\n\n    var centerX = (offset.left + w / 2);\n    var centerY = (offset.top + h / 2);\n\n\n    var a = centerY - y;\n    var b = centerX - x;\n\n    var r = Math.round((180 * Math.atan2(a, b)) / Math.PI);\n\n    // Left and Right are for the character, not the screen :-/\n    if (-45 <= r && r < 45) { return 'Right'; }\n    if (45 <= r && r < 135) { return 'Up'; }\n    if (135 <= r && r <= 180 || -180 <= r && r < -135) { return 'Left'; }\n    if (-135 <= r && r < -45) { return 'Down'; }\n\n    // sanity check\n    return 'Top';\n};\n\n/**************************** Queue and Idle handling ************************************/\n\n/***\n * Handle empty queue.\n * We need to transition the animation to an idle state\n * @private\n */\nAgent.prototype._onQueueEmpty = function _onQueueEmpty () {\n    if (this._hidden || this._isIdleAnimation()) { return; }\n    var idleAnim = this._getIdleAnimation();\n    this._idleDfd = $.Deferred();\n\n    this._animator.showAnimation(idleAnim, $.proxy(this._onIdleComplete, this));\n};\n\nAgent.prototype._onIdleComplete = function _onIdleComplete (name, state) {\n    if (state === Animator.States.EXITED) {\n        this._idleDfd.resolve();\n    }\n};\n\n/***\n * Is the current animation is Idle?\n * @return {Boolean}\n * @private\n */\nAgent.prototype._isIdleAnimation = function _isIdleAnimation () {\n    var c = this._animator.currentAnimationName;\n    return c && c.indexOf('Idle') === 0;\n};\n\n\n/**\n * Gets a random Idle animation\n * @return {String}\n * @private\n */\nAgent.prototype._getIdleAnimation = function _getIdleAnimation () {\n    var animations = this.animations();\n    var r = [];\n    for (var i = 0; i < animations.length; i++) {\n        var a = animations[i];\n        if (a.indexOf('Idle') === 0) {\n            r.push(a);\n        }\n    }\n\n    // pick one\n    var idx = Math.floor(Math.random() * r.length);\n    return r[idx];\n};\n\n/**************************** Events ************************************/\n\nAgent.prototype._setupEvents = function _setupEvents () {\n    $(window).on('resize', $.proxy(this.reposition, this));\n\n    this._el.on('mousedown', $.proxy(this._onMouseDown, this));\n\n    this._el.on('dblclick', $.proxy(this._onDoubleClick, this));\n};\n\nAgent.prototype._onDoubleClick = function _onDoubleClick () {\n    if (!this.play('ClickedOn')) {\n        this.animate();\n    }\n};\n\nAgent.prototype.reposition = function reposition () {\n    if (!this._el.is(':visible')) { return; }\n    var o = this._el.offset();\n    var bH = this._el.outerHeight();\n    var bW = this._el.outerWidth();\n\n    var wW = $(window).width();\n    var wH = $(window).height();\n    var sT = $(window).scrollTop();\n    var sL = $(window).scrollLeft();\n\n    var top = o.top - sT;\n    var left = o.left - sL;\n    var m = 5;\n    if (top - m < 0) {\n        top = m;\n    } else if ((top + bH + m) > wH) {\n        top = wH - bH - m;\n    }\n\n    if (left - m < 0) {\n        left = m;\n    } else if (left + bW + m > wW) {\n        left = wW - bW - m;\n    }\n\n    this._el.css({ left: left, top: top });\n    // reposition balloon\n    this._balloon.reposition();\n};\n\nAgent.prototype._onMouseDown = function _onMouseDown (e) {\n    e.preventDefault();\n    this._startDrag(e);\n};\n\n\n/**************************** Drag ************************************/\n\nAgent.prototype._startDrag = function _startDrag (e) {\n    // pause animations\n    this.pause();\n    this._balloon.hide(true);\n    this._offset = this._calculateClickOffset(e);\n\n    this._moveHandle = $.proxy(this._dragMove, this);\n    this._upHandle = $.proxy(this._finishDrag, this);\n\n    $(window).on('mousemove', this._moveHandle);\n    $(window).on('mouseup', this._upHandle);\n\n    this._dragUpdateLoop = window.setTimeout($.proxy(this._updateLocation, this), 10);\n};\n\nAgent.prototype._calculateClickOffset = function _calculateClickOffset (e) {\n    var mouseX = e.pageX;\n    var mouseY = e.pageY;\n    var o = this._el.offset();\n    return {\n        top: mouseY - o.top,\n        left: mouseX - o.left\n    }\n\n};\n\nAgent.prototype._updateLocation = function _updateLocation () {\n    this._el.css({ top: this._targetY, left: this._targetX });\n    this._dragUpdateLoop = window.setTimeout($.proxy(this._updateLocation, this), 10);\n};\n\nAgent.prototype._dragMove = function _dragMove (e) {\n    e.preventDefault();\n    var x = e.clientX - this._offset.left;\n    var y = e.clientY - this._offset.top;\n    this._targetX = x;\n    this._targetY = y;\n};\n\nAgent.prototype._finishDrag = function _finishDrag () {\n    window.clearTimeout(this._dragUpdateLoop);\n    // remove handles\n    $(window).off('mousemove', this._moveHandle);\n    $(window).off('mouseup', this._upHandle);\n    // resume animations\n    this._balloon.show();\n    this.reposition();\n    this.resume();\n\n};\n\nAgent.prototype._addToQueue = function _addToQueue (func, scope) {\n    if (scope) { func = $.proxy(func, scope); }\n    this._queue.queue(func);\n};\n\n/**************************** Pause and Resume ************************************/\n\nAgent.prototype.pause = function pause () {\n    this._animator.pause();\n    this._balloon.pause();\n\n};\n\nAgent.prototype.resume = function resume () {\n    this._animator.resume();\n    this._balloon.resume();\n};\n\nvar load = function load (name, successCb, failCb, base_path) {\r\n    base_path = base_path || window.CLIPPY_CDN || 'https://gitcdn.xyz/repo/pi0/clippyjs/master/assets/agents/';\r\n\r\n    var path = base_path + name;\r\n    var mapDfd = load._loadMap(path);\r\n    var agentDfd = load._loadAgent(name, path);\r\n    var soundsDfd = load._loadSounds(name, path);\r\n\r\n    var data;\r\n    agentDfd.done(function (d) {\r\n        data = d;\r\n    });\r\n\r\n    var sounds;\r\n\r\n    soundsDfd.done(function (d) {\r\n        sounds = d;\r\n    });\r\n\r\n    // wrapper to the success callback\r\n    var cb = function () {\r\n        var a = new Agent(path, data, sounds);\r\n        successCb(a);\r\n    };\r\n\r\n    $.when(mapDfd, agentDfd, soundsDfd).done(cb).fail(failCb);\r\n};\r\n\r\nload._loadMap = function _loadMap (path) {\r\n    var dfd = load._maps[path];\r\n    if (dfd) { return dfd; }\r\n\r\n    // set dfd if not defined\r\n    dfd = load._maps[path] = $.Deferred();\r\n\r\n    var src = path + '/map.png';\r\n    var img = new Image();\r\n\r\n    img.onload = dfd.resolve;\r\n    img.onerror = dfd.reject;\r\n\r\n    // start loading the map;\r\n    img.setAttribute('src', src);\r\n\r\n    return dfd.promise();\r\n};\r\n\r\nload._loadSounds = function _loadSounds (name, path) {\r\n    var dfd = load._sounds[name];\r\n    if (dfd) { return dfd; }\r\n\r\n    // set dfd if not defined\r\n    dfd = load._sounds[name] = $.Deferred();\r\n\r\n    var audio = document.createElement('audio');\r\n    var canPlayMp3 = !!audio.canPlayType && \"\" !== audio.canPlayType('audio/mpeg');\r\n    var canPlayOgg = !!audio.canPlayType && \"\" !== audio.canPlayType('audio/ogg; codecs=\"vorbis\"');\r\n\r\n    if (!canPlayMp3 && !canPlayOgg) {\r\n        dfd.resolve({});\r\n    } else {\r\n        var src = path + (canPlayMp3 ? '/sounds-mp3.js' : '/sounds-ogg.js');\r\n        // load\r\n        load._loadScript(src);\r\n    }\r\n\r\n    return dfd.promise()\r\n};\r\n\r\nload._loadAgent = function _loadAgent (name, path) {\r\n    var dfd = load._data[name];\r\n    if (dfd) { return dfd; }\r\n\r\n    dfd = load._getAgentDfd(name);\r\n\r\n    var src = path + '/agent.js';\r\n\r\n    load._loadScript(src);\r\n\r\n    return dfd.promise();\r\n};\r\n\r\nload._loadScript = function _loadScript (src) {\r\n    var script = document.createElement('script');\r\n    script.setAttribute('src', src);\r\n    script.setAttribute('async', 'async');\r\n    script.setAttribute('type', 'text/javascript');\r\n\r\n    document.head.appendChild(script);\r\n};\r\n\r\nload._getAgentDfd = function _getAgentDfd (name) {\r\n    var dfd = load._data[name];\r\n    if (!dfd) {\r\n        dfd = load._data[name] = $.Deferred();\r\n    }\r\n    return dfd;\r\n};\r\n\r\nload._maps = {};\r\nload._sounds = {};\r\nload._data = {};\r\n\r\nfunction ready (name, data) {\r\n    var dfd = load._getAgentDfd(name);\r\n    dfd.resolve(data);\r\n}\r\n\r\nfunction soundsReady (name, data) {\r\n    var dfd = load._sounds[name];\r\n    if (!dfd) {\r\n        dfd = load._sounds[name] = $.Deferred();\r\n    }\r\n\r\n    dfd.resolve(data);\r\n}\n\nvar clippy = {\r\n    Agent: Agent,\r\n    Animator: Animator,\r\n    Queue: Queue,\r\n    Balloon: Balloon,\r\n    load: load,\r\n    ready: ready,\r\n    soundsReady: soundsReady\r\n};\r\n\r\nif (typeof window !== 'undefined') {\r\n    window.clippy = clippy;\r\n}\n\nexport default clippy;\n//# sourceMappingURL=clippy.esm.js.map\n","import clippy from 'clippyjs';\nfunction sleep(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n}\nfunction offset(el) {\n    // Can probably be better, but this is what ClippyJS uses for determining direction,\n    // so this way we guarantee the expected result\n    const rect = el.offset() || { top: 0, left: 0 };\n    const width = el.width() || 0;\n    const height = el.height() || 0;\n    return {\n        top: rect.top,\n        left: rect.left,\n        width,\n        height,\n        x: rect.left,\n        y: rect.top,\n        centerX: rect.left + width / 2,\n        centerY: rect.top + height / 2,\n    };\n}\nfunction currentViewPort() {\n    return {\n        height: document.documentElement.clientHeight,\n        width: document.documentElement.clientWidth,\n    };\n}\nfunction isInViewport(element) {\n    const elOffset = offset(element);\n    const viewportTop = $(window).scrollTop() || 0;\n    const viewportBottom = viewportTop + ($(window).height() || 0);\n    return elOffset.top + elOffset.height > viewportTop && elOffset.top < viewportBottom;\n}\nfunction randomElement(array) {\n    return array[Math.floor(Math.random() * array.length)];\n}\nfunction gestureAt(agent, x, y, cb) {\n    const direction = agent._getDirection(x, y);\n    const gestureAnim = 'Gesture' + direction;\n    const lookAnim = 'Look' + direction;\n    return agent.play(agent.hasAnimation(gestureAnim) ? gestureAnim : lookAnim, 10000, cb);\n}\nconst rules = [];\nfunction addRule(options, cb) {\n    rules.push(Object.assign(Object.assign({}, options), { cb }));\n}\n$(() => {\n    // @ts-ignore\n    const assistant = ASSISTENT || 'Clippy';\n    // @ts-ignore\n    const geenGeluiden = (ASSISTENT_GELUIDEN || 'nee') === 'nee';\n    const welcomeMessages = [\n        'Hallo, welkom op de stek! Hoe kan ik je vandaag helpen?',\n        'Hoe kan ik je stek ervaring vandaag weer verrijken?',\n        'Weet je zeker dat je niet eigenlijk moet studeren nu?',\n        'Welke stek functie wil je vandaag weer gebruiken?',\n        'Wist je dat er ook een C.S.R. Sponsorextensie is?',\n        'Heb je de C.S.R. Sponsorextensie al geïnstalleerd?',\n        'Weet je eigenlijk al hoe je ketzers kunt maken?',\n        'Wist je dat je uit meerdere assistenten kunt kiezen in instellingen?',\n        'Heb je de stek in het roze thema wel eens geprobeerd?',\n        'Heb je de PubCie al eens bedankt voor al hun werk?',\n    ];\n    clippy.load(assistant, async (agent) => {\n        if (geenGeluiden) {\n            agent._animator._sounds = [];\n        }\n        const viewPort = currentViewPort();\n        let message = '';\n        agent.moveTo(viewPort.width - 250, viewPort.height - 250);\n        agent.show();\n        if (!sessionStorage.getItem('clippy-first')) {\n            message = 'Hallo, welkom op de stek! Hoe kan ik je vandaag helpen?';\n            sessionStorage.setItem('clippy-first', 'true');\n        }\n        else {\n            message = randomElement(welcomeMessages);\n        }\n        agent.speak(message);\n        agent.play('Wave', 5000, () => {\n            agent.closeBalloon();\n            let foundOne = false;\n            rules.forEach((rule) => {\n                if (!rule.cb || (rule.noOther && foundOne)) {\n                    return;\n                }\n                if (rule.messageCondition && !rule.messageCondition(message)) {\n                    return;\n                }\n                if (rule.location && window.location.pathname.startsWith(rule.location)) {\n                    rule.cb(agent);\n                    if (rule.location !== '/') {\n                        foundOne = true;\n                    }\n                }\n                if (rule.probability && rule.probability > Math.random()) {\n                    rule.cb(agent);\n                    foundOne = true;\n                }\n            });\n            setInterval(() => agent.animate(), 14000);\n        });\n    });\n});\naddRule({ location: '/profiel' }, async (agent) => {\n    const pasfoto = $('.naam .pasfoto img');\n    const foto = pasfoto[0];\n    if (foto.complete) {\n        pasfotoLoaded().then();\n    }\n    else {\n        pasfoto.on('load', pasfotoLoaded);\n    }\n    async function pasfotoLoaded() {\n        const box = offset(pasfoto);\n        await sleep(2000);\n        agent.stop();\n        agent.moveTo(box.left - 200, box.centerY, 750);\n        await sleep(1000);\n        agent.play('GestureLeft', 5000, () => {\n            agent.moveTo(box.left + (box.width / 2), box.top + box.height + 100, 500);\n            sleep(1000).then(() => agent.play('GestureUp'));\n        });\n    }\n});\naddRule({ location: '/' }, (agent) => {\n    // @ts-ignore\n    $('#search input.ZoekField').on('focusin', (event) => {\n        const box = event.target.getBoundingClientRect();\n        agent.stopCurrent();\n        agent.moveTo(box.left, box.bottom);\n        agent.play('Searching');\n    });\n    $('.bb-maaltijd').one('mouseenter', (event) => {\n        const box = event.target.getBoundingClientRect();\n        agent.stopCurrent();\n        agent.moveTo(box.right + 50, Math.max(50, box.top - 100));\n        agent.speak('Eet smakelijk!');\n    });\n});\naddRule({ location: '/ledenlijst' }, async (agent) => {\n    agent.moveTo(100, 100);\n    agent.speak('Het lijkt erop dat je iemand wilt vinden.\\nHeb je het zoekveld al geprobeerd?');\n    agent.play('Searching');\n});\naddRule({ location: '/instellingen' }, async (agent) => {\n    const wolkenKnop = document.evaluate('//div[contains(@class,\\'block\\')]//a[text()=\\'Wolken\\']', document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null).snapshotItem(1);\n    const $wolkenKnop = $(wolkenKnop);\n    if (isInViewport($wolkenKnop)) {\n        const loc = offset($wolkenKnop);\n        agent.moveTo(loc.left, loc.top);\n        agent.speak('Kijk, hier kun je een mooi effect kiezen');\n    }\n});\naddRule({ location: '/forum' }, async (agent) => {\n    let writing = false;\n    const animations = ['Writing', 'CheckingSomething'];\n    const availableAnimations = agent.animations().filter((el) => animations.indexOf(el) > -1);\n    let laatsteWoord = '';\n    $('textarea#forumBericht').on('keyup', (event) => {\n        switch (event.key.toLowerCase()) {\n            case 'r':\n                if (laatsteWoord === 'ketze') {\n                    laatsteWoord = '';\n                    const ketzerLinkLoc = offset($('.butn a[href=\"/groepen/activiteiten/nieuw\"]'));\n                    writing = true;\n                    agent.stop();\n                    agent.play('GetAttention');\n                    gestureAt(agent, ketzerLinkLoc.centerX, ketzerLinkLoc.centerY, () => {\n                        writing = false;\n                    });\n                    return;\n                }\n                break;\n            case ' ':\n                laatsteWoord = '';\n                break;\n            case 'backspace':\n                laatsteWoord = laatsteWoord.slice(0, -1);\n                break;\n            default:\n                // Avoid adding special character descriptions to the word\n                if (event.key.length === 1) {\n                    laatsteWoord += event.key.toLowerCase();\n                }\n        }\n        const box = event.target.getBoundingClientRect();\n        if (!writing) {\n            writing = true;\n            agent.moveTo(box.right - 150, box.bottom - 130, 500);\n            agent.play(randomElement(availableAnimations), 5000, () => writing = false);\n        }\n    });\n});\naddRule({\n    probability: 0.3,\n    noOther: true,\n    messageCondition: (message) => message.indexOf('Sponsorextensie') === -1,\n}, async (agent) => {\n    const times = sessionStorage.getItem('clippy-extensie');\n    const amount = times ? parseInt(times, 10) : 0;\n    if (amount < 3 && sessionStorage.getItem('clippy-first')) {\n        const extensie = $('a[title=\"Sponsorkliks extensie (Chrome)\"]');\n        const extOffset = offset(extensie);\n        if (extensie) {\n            extensie[0].scrollIntoView({\n                behavior: 'smooth',\n                block: 'center',\n            });\n            await sleep(500);\n            agent.stopCurrent();\n            agent.moveTo(200, extOffset.top - 20);\n            await sleep(1500);\n            agent.speak('Heb je de sponsorkliks extensie al geïnstalleerd?');\n            agent.play('GestureRight', 5000, () => {\n                agent.closeBalloon();\n                sessionStorage.setItem('clippy-extensie', (amount + 1).toString());\n            });\n        }\n    }\n});\n"],"sourceRoot":""}