{"version":3,"sources":["webpack:///./js/agenda.ts"],"names":["fmt","date","format","calendarEl","document","getElementById","Error","_a","dataset","jaar","maand","weergave","creator","defaultView","week","dag","agenda","editable","options","plugins","height","nowIndicator","locale","customButtons","nieuw","text","click","datum","calendar","getDate","begin_moment","eind_moment","bewerken","setOption","refetchEvents","setTimeout","button","querySelector","classList","add","remove","eventDataTransform","event","header","left","center","right","defaultDate","Date","Number","firstDay","events","selectable","select","selectionInfo","start","end","eventClick","info","a","get","id","getFullYear","then","response","card","data","style","zIndex","position","addEventListener","body","append","init","el","placement","clickListener","e","contains","target","removeEventListener","eventDrop","dropInfo","post","eventResize","resizeInfo","render","addHandler","on"],"mappings":"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","file":"js/33.6b1032268f163e35b0a6.js","sourcesContent":["import { Calendar } from '@fullcalendar/core';\nimport nlLocale from '@fullcalendar/core/locales/nl';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport interaction from '@fullcalendar/interaction';\nimport listPlugin from '@fullcalendar/list';\nimport timeGridPlugin from '@fullcalendar/timegrid';\nimport axios from 'axios';\nimport $ from 'jquery';\nimport moment from 'moment';\nimport Popper from 'popper.js';\nimport { ajaxRequest } from './ajax';\nimport { domUpdate } from './context';\nimport ctx from './ctx';\nimport { htmlParse } from './util';\nvar dateTimeFormat = 'YYYY-MM-DD HH:mm:ss';\nvar fmt = function (date) { return moment(date).format(dateTimeFormat); };\nvar calendarEl = document.getElementById('agenda');\nif (calendarEl == null) {\n    throw new Error('Agenda element niet gevonden');\n}\nvar _a = calendarEl.dataset, jaar = _a.jaar, maand = _a.maand, weergave = _a.weergave, creator = _a.creator;\nif (jaar == null || maand == null || weergave == null || creator == null) {\n    throw new Error('Agenda opties niet gezet');\n}\nvar defaultView = {\n    maand: 'dayGridMonth',\n    week: 'timeGridWeek',\n    dag: 'timeGridDay',\n    agenda: 'listMonth',\n}[weergave];\nvar editable = false;\nvar options = {\n    plugins: [dayGridPlugin, timeGridPlugin, listPlugin, interaction],\n    height: 'auto',\n    nowIndicator: true,\n    defaultView: defaultView,\n    locale: nlLocale,\n    customButtons: {\n        nieuw: {\n            text: 'Nieuw',\n            click: function () {\n                var datum = fmt(calendar.getDate());\n                ajaxRequest('POST', '/agenda/toevoegen', {\n                    begin_moment: datum,\n                    eind_moment: datum,\n                }, false, domUpdate);\n            },\n        },\n        bewerken: {\n            text: 'Bewerken',\n            click: function () {\n                editable = !editable;\n                calendar.setOption('editable', editable);\n                calendar.setOption('selectable', editable);\n                calendar.refetchEvents();\n                setTimeout(function () {\n                    var button = calendarEl.querySelector('.fc-bewerken-button');\n                    if (editable) {\n                        button.classList.add('fc-button-active');\n                    }\n                    else {\n                        button.classList.remove('fc-button-active');\n                    }\n                });\n            },\n        },\n    },\n    eventDataTransform: function (event) {\n        if (event.editable === true) {\n            event.editable = editable;\n        }\n        return event;\n    },\n    header: {\n        left: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth',\n        center: 'title',\n        right: 'today prevYear,prev,next,nextYear',\n    },\n    defaultDate: new Date(Number(jaar), Number(maand) - 1),\n    firstDay: 0,\n    events: '/agenda/feed',\n    selectable: editable && creator === 'true',\n    select: function (selectionInfo) {\n        ajaxRequest('POST', '/agenda/toevoegen', {\n            begin_moment: fmt(selectionInfo.start),\n            eind_moment: fmt(selectionInfo.end),\n        }, false, domUpdate);\n    },\n    eventClick: function (info) {\n        axios.get(\"/agenda/details/\" + info.event.id + \"?jaar=\" + (info.event.start.getFullYear())).then(function (response) {\n            var card = htmlParse(response.data)[0];\n            card.style.zIndex = '100';\n            card.style.position = 'absolute';\n            card.querySelector('.close').addEventListener('click', function () {\n                card.remove();\n                return false;\n            });\n            document.body.append(card);\n            ctx.init(card);\n            new Popper(info.el, card, { placement: 'bottom' });\n            setTimeout(function () {\n                var clickListener = function (e) {\n                    if (!card.contains(e.target)) {\n                        card.remove();\n                        document.body.removeEventListener('click', clickListener);\n                    }\n                };\n                document.body.addEventListener('click', clickListener);\n            });\n        });\n    },\n    eventDrop: function (dropInfo) {\n        axios.post(\"/agenda/verplaatsen/\" + dropInfo.event.id, {\n            begin_moment: fmt(dropInfo.event.start),\n            eind_moment: fmt(dropInfo.event.end),\n        }).then(function () { return calendar.refetchEvents(); });\n    },\n    eventResize: function (resizeInfo) {\n        axios.post(\"/agenda/verplaatsen/\" + resizeInfo.event.id, {\n            begin_moment: fmt(resizeInfo.event.start),\n            eind_moment: fmt(resizeInfo.event.end),\n        }).then(function () { return calendar.refetchEvents(); });\n    },\n};\nif (creator === 'true') {\n    var header = options.header;\n    header.right = 'bewerken,nieuw ' + header.right;\n}\nvar calendar = new Calendar(calendarEl, options);\ncalendar.render();\nctx.addHandler('.ReloadAgenda', function (el) { return el.addEventListener('click', function () { return setTimeout(function () { return calendar.refetchEvents(); }); }); });\n$(document.body).on('modalClose', function () { return calendar.refetchEvents(); });\n"],"sourceRoot":""}